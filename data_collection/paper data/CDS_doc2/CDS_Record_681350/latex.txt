August 22, 2003

**MobiDICK: a mobile test bench**

**for the TileCal super-drawers**

**Romeo Bonnefoy, David Calvet1, Robert Chadelas, Michel Crouau,**

Footnote 1: calvet@in2p3.fr, corresponding author

**Franck Martin2**

Footnote 2: now at CERN

LPC Clermont-Ferrand

CNRS/IN2P3 - Universite Blaise Pascal

24 avenue des Landais

F-63177 Aubiere cedex

This note describes the MobiDICK system, a mobile test bench for the TileCal super-drawers. This system is used during the insertion of the super-drawers in the calorimeter modules at CERN to check their integrity after transport and insertion. It will also be used during the LHC shutdowns to debug failures of the super-drawers during the Atlas lifetime.

Introduction

The _Mobile Drawer Integrity Checking system_ (or MobiDICK) is a mobile test bench for the TileCal super-drawers [1], which contain the control and read-out electronics of the calorimeter. These super-drawers are assembled at LPC Clermont-Ferrand, and then fully qualified using a dedicated test bench. But, because these super-drawers have to be split into two drawers for transport, the final assembly step must be done at CERN, at the very time of their insertion in the TileCal modules. At this time, the integrity of the super-drawers and also the connections between the two drawers have to be checked again. This is the purpose of the MobiDICK system. Therefore, this system is a smaller version of the qualifying test bench. But, because this system will also be used in case of later problems, down in the Atlas cavern, it must be mobile.

The MobiDICK system is made of a cooling circuit test box, an electronics test box and a laptop (see figure 1).

## 2 The MobiDICK software

The MobiDICK software is divided in two parts: one is running in the electronics test box, the other one on the laptop. These two parts communicate using the Internet Protocol and a Client/Server architecture.

Figure 1: _Schematic of the MobiDICK system hardware. The low voltage power supplies for the super-drawer are not part of the system._

### The Server software

The Server software is a C program running under LynxOS[2]. This program performs all the electronics tests under the requests of the Client and sends back the results of the tests to the Client. The electronics tests are performed with the help of electronic boards controlled via a VME bus.

### The Client software

The Client software is a C++ program running under Linux, using the ROOT[3] libraries. This program is the interface between the operator and the system. It sends requests to the Server to perform the electronics tests and gets results from it. The Client controls also the cooling circuit test box, through the parallel port of the laptop. The results of the tests are then analyzed by the Client program to help the operator finding the problems.

## 3 The MobiDICK hardware

The MobiDICK hardware has two independent parts: the cooling circuit test box and the electronics test box.

### The cooling circuit test box

The cooling circuit test box is a custom box housing:

* a vacuum pump,
* a small plastic tank to receive the water which could still be inside the super-drawer cooling circuit,
* a pressure meter which measures the difference between the atmospheric pressure and the pressure of the air inside the cooling circuit,
* an ADC to digitize the measured pressure difference.

The cooling circuit test box electronics is connected to the laptop parallel port via a flat cable.

### The electronics test box

The electronics test box is a custom aluminum box which has a width of 36 cm, a depth of 33 cm and a height of 50 cm. It contains three fans and a custom VME crate (see figure 2). The total weight of the box including the crate and the cards is about 20 kg. The box is connected to the laptop via an ethernet cable and to the super-drawer via a single custom multi-connector cable.

The VME crate contains five sets of VME cards (see figure 1):

* the **Server**,
* the **CANbus interface**,* the **TTC system**,
* the **Trigger ADC**,
* and the **Low HV input**.

#### 3.2.1 The Server

The Server is hosted on a RIO 2 [4] VME processor. This card is the master of the VME bus and controls all the other VME cards. Since the Server program is running on it, it is the central part of the system.

On the PCI bus of the RIO2 processor is plugged a _Simple S-LINK to PMC interface_ (or SSP [5]). Then, on this SSP card is plugged an _Optical Dual G-LINK S-LINK Interface_ (or ODIN [6]). Then, the ODIN card is connected to the super-drawer using an optical fiber. The purpose of the ODIN card is to receive the data sent out by the super-drawer readout electronics. The data words are then stored in a FIFO on the SSP card until the Server program reads them out.

It is planned to replace the RIO 2 processor by the VME processor which has been chosen as the Atlas ROD Crate Controller, in order to have full support of the card during the Atlas lifetime.

#### 3.2.2 The CANbus interface

The CANbus interface is made of two parts. The first part is a TVME200 [7] VME card holding two TIP816 [7] modules. Each of these modules is an independent CANbus interface. These two modules are then connected to an LPC-made card called PP, which is mainly used to provide the +12 V power supply of the VME backplane to the super-drawer CANbus interfaces and to dispatch the signals from the two TIP816 modules to a single non standard cable going to the super-drawer.

Figure 2: _Left: the electronics test box, with the laptop on top of it and the cable going to the super-drawer. Right: view of the VME crate inside the electronics test box._

#### 3.2.3 The TTC system

The TTC system is made of two parts. The first part is a TTCvi [8] VME card, which generates the commands to the super-drawer readout electronics -- configuration as well as trigger --, on request of the Server. This TTCvi card is then connected to the TTCvx [9] card, which converts these command electrical signals into optical signals, which are sent to the super-drawer readout electronics using an optical fiber.

#### 3.2.4 The Trigger ADC

The Trigger ADC is made of three parts. The first part is a V792 [10] VME ADC, which digitizes the signals coming out of the super-drawer adders. Because these signals are differential, they are first processed by two LPC-made cards called DIFF2ADC, one for the muon trigger cable, one for the hadron trigger cable.

#### 3.2.5 The Low HV input

The Low HV input is made of two parts. The first part is an LPC-made card called "Low HV" which provides a low (-24 V) "high voltage" input to the super-drawer, converted from the -12 V power supply of the VME backplane by a DC/DC converter. This card is controlled by the DIFF2ADC card, which has basic I/O capabilities, accessible through the VME bus.

## 4 Tests performed by MobiDICK

The tests performed by the MobiDICK system on the super-drawers are divided into six sets. The first set is the cooling circuit test. The next three sets test the readout electronics whereas the last two sets test the high voltage distribution electronics.

### Cooling circuit test

The purpose of the cooling circuit test is to check the tightness of the super-drawer cooling circuit:

1. the vacuum pump is started until the pressure difference (atmospheric minus air in circuit) in the cooling circuit is sufficient (500 mb).
2. the pressure difference is measured every second for at least six minutes and a maximum of fifteen minutes. The loss of pressure difference since the beginning of the test and the average rate of loss over one hour are computed and checked.

### Test #1

The purpose of this test is to check the communication with the ADC-I card, the 3in1 cards and the motherboard TTCrx:

1. the communication with the ADC-I card is established, through CANbus, using the IDALLOC DEFID command. In case of success, the serial number of this card is read back. Otherwise, a REQUEST SERIALNUM command is sent, with a scan of all possible identifiers, until communication is established.
2. the communication with every single 3in1 card through the ADC-I card is checked. All control bits of these cards are flipped and the status register is read back to check the commands were successful. All operations are done with the CANbus.
3. the communication with every single 3in1 card through the motherboard TTCrx is checked. All control bits of these cards are flipped, sending commands through the TTC system. The status register is read back by CANbus to check the commands were successful. In this test, a null value is used instead of the motherboard TTCrx address.
4. the motherboard TTCrx address is checked: the first working 3in1 card is selected and checked three times with the previous sub-test, using the expected motherboard TTCrx address, the expected address minus one and the expected address plus one. In the last two tests, the communication with the 3in1 card should fail.

### Test #2

The purpose of this test is to check the digitizers functionalities and the data readout, using the charge injection circuit. The motherboard and all digitizers are first configured using their TTCrx addresses. The 3in1 cards are then configured to enable the charge injection input. Finally, the data are read out and analyzed, including a fit of the digitized pulse shape. Two steps are performed:

1. the injected charge is a small one (10 pC), in order to test the high gain circuits. This charge is injected on all 3in1 cards at the same time, allowing to detect faulty digitizers very quickly. This test is done twice to test the two TTC/ROD channels (the user must change the connection of the fibers between the two tests).
2. the injected charge is a big one (800 pC), in order to test the low gain circuits. This charge is injected on a single 3in1 card, and no charge is injected on the others, to check the connectivity with the digitizers, in order to find 3in1 cards which would have been connected to a wrong digitizer channel.

All commands are sent through the TTC system.

### Test #3

The purpose of this test is to check the adders functionalities, using the charge injection circuit:

1. the 3in1 cards are configured to disable the charge injection input. Then, the signals coming out of the trigger cables are digitized using the "Trigger ADC" set of cards: these values are the "baselines".
2. the charge injection input is then enabled on one 3in1 card (with a charge of 10 pC).
3. the trigger signals are digitized: the differences to the baselines are computed and compared to what is expected (channels and levels). These digitized signals become the new baselines.
4. the charge injection input is then enabled on one more 3in1 card and the test goes back to the previous step. This loop is performed until charge injection is enabled on all 3in1 cards.

All commands are sent through the TTC system with a null value instead of the motherboard TTCrx address.

### Test #4

The purpose of this test is to check the communication with the high voltage distribution electronics:

1. the communication with the HV micro card is established, through CANbus. In case of success, the global status register of this card is read back and checked. Otherwise a loop over all possible node numbers is performed until communication is established.
2. the software version of the HV micro card is checked.
3. the values of the low voltages and temperatures monitored by the HV micro card are checked.

### Test #5

The purpose of this test is to check the functionalities of the high voltage distribution electronics:

1. the initial state of the four HV switches (odd/even internal/external) is saved and they are all switched off. The low HV input (-24 V) is switched on and the four switches are switched on one by one and checked.
2. for each channel, the applied voltage is read out. The order is then changed to be half the low HV input value. The new applied voltage is read out and checked.
3. the low HV input is switched off. The four switches are put back in their initial state and the default orders are restored for all channels.

Conclusion

A prototype of the MobiDICK system has been successfully tested during the super-drawers insertions for the 2002 and 2003 beam tests. The system has been finalized and is now being used for the final insertion of the super-drawers in the calorimeter modules. An upgrade of the software is foreseen in the near future with an expert system being under development. On the longer term, an upgrade of the hardware is also planned with the replacement of the VME processor. More information is available on the web [11].

## Acknowledgments

We would like to thank Georges Blanchot, Dominique Pallin and Richard Teuscher for their help and/or fruitful discussions.

## References

* [1] ATLAS / Tile Calorimeter Collaboration, Tile Calorimeter Technical Design Report, CERN/LHCC 96-42.
* [2] LynxOS is a product of LynuxWorks, [http://www.lynx.com/](http://www.lynx.com/).
* [3] ROOT, R. Brun et al, see [http://root.cern.ch/root/](http://root.cern.ch/root/).
* [4] The RIO2 is a product of Creative Electronics System, [http://www.ces.ch/](http://www.ces.ch/).
* [5] The Simple S-LINK to PMC interface (SSP) is a product of INCAA Computers, [http://www.incaaccomputers.com/](http://www.incaaccomputers.com/).
* [6] The ODIN card is a CERN product, [http://hsi.web.cern.ch/HSI/s-link/devices/odin/](http://hsi.web.cern.ch/HSI/s-link/devices/odin/).
* [7] The TVME200 and TIP 816 are products of TEWS Technologies, [http://www.tews.com/](http://www.tews.com/).

* [9] P. Galino, "TTCvx Technical description and users manual".
* [10] The V792 is a product of CAEN SpA, [http://www.caen.it/](http://www.caen.it/).
* [11][http://www.cern.ch/atlas-proj-mobidick/](http://www.cern.ch/atlas-proj-mobidick/).