This document reports on a first analysis of a common dataset recorded by the ATLAS and the LHCf detectors during the proton-lead collisions at \(\sqrt{s_{{}_{\mathrm{NN}}}}=5.02\) TeV in 2013. The LHCf trigger signal was incorporated in the ATLAS Level-1 trigger system and it is shown that the common events recorded by ATLAS and LHCf can be matched off-line. Preliminary analysis of the combined dataset is carried out, forming an important precedent for the future ATLAS-LHCf collaboration that will allow to further improve our understanding of cosmic-ray air showers and modelling of inelastic processes at the LHC. The discrimination power of using information from ATLAS to classify the events with reconstructed particles in LHCf is demonstrated.

(c) Copyright 2015 CERN for the benefit of the ATLAS and LHCf Collaborations.

Reproduction of this article or parts of it is allowed as specified in the CC-BY-3.0 license.

Introduction

The LHCf detectors are installed on both sides of the ATLAS detector along the beam pipe and aim to study the production of neutral particles, such as pions, photons and neutrons in the very forward region. Such measurements give important information for understanding cosmic-ray air showers induced by high energy particles hitting the Earth's atmosphere [1]. The ATLAS and the LHCf detectors deliver information on very different phase space regions and ultimately a joint analysis will help to understand particle production in \(pp\) or \(p\)+Pb collisions in a more complete way. For example, information on the activity in the central region can help to distinguish different particle production mechanisms: non-diffractive inelastic interactions, diffractive inelastic interactions [2] and photonuclear ultra-peripheral collisions (UPC) [3]. This note describes the successful first attempt to record and analyze a common dataset by the ATLAS and the LHCf collaborations and motivates future collaboration with the main physics goal to further constrain cosmic-ray air shower simulations and modeling of inelastic processes at LHC energies.

During the 2013 LHC operation with \(p\)+Pb collisions at nucleon-nucleon centre-of-mass energy \(\sqrt{s_{\mathrm{NN}}}=5.02\) - a common dataset of the events triggered by LHCf was recorded by both the ATLAS and the LHCf collaborations. Data used in this analysis were obtained during the LHC fill 3510 on February 1, 2013, with less than 0.01 interactions per bunch crossing on average. The beams were configured with 296 colliding bunches spaced at 200 ns. Approximately 127000 common events, triggered by LHCf, were recorded. Simulations suggest that the recorded data is dominated by the UPC background processes that can be efficiently suppressed by utilizing the information on the charged particle track multiplicity reconstructed in the ATLAS detector.

This note is organized as follows. Section 2 gives a brief overview of the ATLAS and the LHCf detectors in the context of this measurement. The combined event triggering procedure is described in Section 3, followed by Section 4 where the off-line matching of the recorded events is discussed. Section 5 explains the analysis tecniques together with the classification of the common events and Section 6 lists the Monte Carlo simulations used to aid the description of data. Preliminary results of the combined analysis are given in Section 7.

## 2 The LHCf and the ATLAS detectors

The LHCf and the ATLAS detectors are described in Ref. [4] and [5], respectively. Only the detector subsystems relevant for the analysis presented here are described below.

The ATLAS inner detector (ID) is submersed in a 2 T solenoidal magnetic field and allows to reconstruct tracks within the pseudorapidity1 range \(|\eta|<2.5\), using its subsystems. In increasing radial distance from the interaction point (IP), the pixel detector is surrounded by the semiconductor tracker (SCT), followed by the transition radiation tracker. The minimum bias trigger scintillators (MBTS) are dedicated detectors covering the pseudorapidity range \(2.1<|\eta|<3.8\), designed to trigger on minimum bias events during the low luminosity runs. They consist of 16 scintillator plates on each side, divided into 8 segments in azimuth.

Footnote 1: ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point in the centre of the detector and the \(z\)-axis along the beam pipe. Cylindrical coordinates (\(r\), \(\phi\)) are used in the transverse plane, \(\phi\) being the azimuthal angle around the beam pipe. The pseudorapidity \(\eta\) is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan(\theta/2)\).

During the 2013 operation only the LHCf Arm2 detector was installed in the neutral absorber (TAN) located at \(z=-140\) m from the ATLAS IP, downstream of the proton beam. Only neutral particles can be detected by the detector. Energetic charged particles are swept out by the magnetic field of dipoles installed between the ATLAS detector and TAN. The detector contains two sampling and imaging calorimeters which consist of tungsten plates, 16 shower sampling layers of plastic scintillators and four silicon strip layers for measuring the transverse profile of the showers. The transverse sizes of the towers are \(25\,\mathrm{mm}\times 25\,\mathrm{mm}\) for the small tower (TS) and \(32\,\mathrm{mm}\times 32\,\mathrm{mm}\) for the large tower (TL), covering the pseudorapidity ranges of \(-\infty<\eta<-9.6\) and \(-9.5<\eta<-8.4\), respectively. The longitudinal dimension of the towers correspond to 44 radiation lengths and 1.55 hadronic interaction lengths.

## 3 Common data acquisition

To combine data from the two detectors, a joint LHCf-ATLAS trigger was setup as follows. The handshake at trigger level between the two experiments starts with the LHCf trigger system identifying an event containing a high-energy particle candidate. This sets the LHCf data acquisition system to an enabled mode. Within the LHCf fiducial volume its trigger system is 100% efficient to an incident photon with energy above \(100\,\mathrm{GeV}\)[6] and about 70% efficient to an incident neutron with energy above \(500\,\mathrm{GeV}\)[7]. The standalone rate of this LHCf trigger during the data taking was \(700\,\mathrm{Hz}\). While the LHCf data acquisition system remained enabled, a trigger signal is sent to ATLAS, arriving at the ATLAS Level-1 Central Trigger Processor within \(\sim\)\(1.5\,\mu\mathrm{s}\) after the collision. The LHCf trigger signal was then without further conditions accepted as an ATLAS Level-1 trigger, initiating the ATLAS event recording chain to readout the same event that generated the LHCf trigger. The ATLAS Level-1 accept (L1A) trigger signal is a single trigger pulse that is generated by the ATLAS Central Trigger Processor for every event passing the Level-1 trigger. The L1A pulses are counted in ATLAS for every event and stored as part of the event record. This L1A pulse was also sent back to LHCf, counted there, and similarly recorded in the LHCf event stream, thereby providing a single unique counter identifying every event that can be used to synchronise ATLAS and LHCf events offline.

The ATLAS Level-2 trigger and Event Filter (EF) are higher level software trigger algorithms which allow a further processing of information and selection of events to save. ATLAS recorded data triggered by LHCf triggers using the EF triggers EF_L1LHCF_NoAlg that utilizes no further information at Level-2 and thus it is purely based on the signals provided by LHCf. This trigger rate of \(700\,\mathrm{Hz}\) at Level-1 was prescaled down to \(10\,\mathrm{Hz}\) in order to fit into the allocated bandwidth. Minimum bias events can be identified in the dataset acquired by EF_L1LHCF_NoAlg by requiring the Level-1 trigger L1_MBTS_1_1, firing on the events with at least one hit in the MBTS stations on both sides.

## 4 Off-line event matching

Due to the fact that ATLAS records only certain fraction of events firing each trigger, not all events recorded by LHCf are also available in the ATLAS dataset. The accumulated L1A counts were recorded in order to have a common quantity stored in both ATLAS and LHCf datasets that would allow easy one-to-one event matching. However, due to recording problems on the LHCf side, the L1A signal was not available and an alternative procedure based on time stamps is used, as described below. This problem has been solved for the 2015 data taking.

The ATLAS Central Trigger Processor calculates a UTC time stamp derived from a GPS-based time-stamping system with a stability of \(5\,\mathrm{ns}\) and high absolute time precision of \(20\,\mathrm{ns}\)[8]. LHCf uses the accumulated count of the LHC \(40\,\mathrm{MHz}\) bunch crossing signal as a time stamp in units of \(25\,\mathrm{ns}\). This counter is reset at the beginning of each LHCf run, which is typically a few minutes long. Therefore, it does not provide an absolute time measurement and cannot be directly used for the event matching between ATLAS and LHCf. On the other hand, it precisely determines the relative time difference between the recorded events. In addition to this time stamp, an absolute time stamp from the readout system is provided with a \(10\,\mu\mathrm{s}\) precision due to CPU availability. The following procedure to find common events in the LHCf and ATLAS datasets was repeated for each LHCf run. At the beginning, a number of randomly chosen events from the LHCf dataset was sought in the ATLAS event list, based on the agreement of ATLAS and LHCf absolute time stamps and the relative time difference between the events recorded on either side. These reference events were used to match subsequent and previous event pairs utilizing the relative time difference.

Figure 1 (left) shows the difference of the time stamps from ATLAS and LHCf. The observed agreement at the level of \(\pm 3\,\mathrm{ns}\) proves the time stamp can be safely used to match the events recorded by ATLAS and LHCf, given the average data acquisition rate of \(\mathcal{O}\)(10 Hz). In 2013 data taking the LHCf data acquisition system recorded approximately 99.7% of all triggered events. The lost events correspond to the end of LHCf runs and the problem is fixed in 2015 data taking. All events simultaneously recorded by the LHCf and the ATLAS experiments are matched.

The matching based on the time stamp is confirmed by comparing the bunch crossing identifiers (BCIDs) of the matched events. Figure 1 (right) shows an exact agreement of the BCIDs recorded by ATLAS and that by LHCf in the matched events, demonstrating perfect synchronization of both data acquisition systems. Two examples of matched events are illustrated in the event displays shown in Fig. 2, with a reconstructed particle in TS and TL calorimeters of LHCf.

## 5 Analysis

The reconstruction of the LHCf data follows the standard LHCf analysis procedure to identify incident particles and to determine their point of impact and energy [6]. The particle identification classifies the showers as photon-like and hadron-like based on the longitudinal profiles of showers measured by the 16 sampling layers. The energy deposited in the 2nd up to and including the 13th sampling layer of the towers is used to measure the total energy of the incident photon, and the energy deposited in the 3rd up to the 16th sampling layer is used for to measure the incident neutron energy. The measured energies are corrected for leaked shower particles and the position dependence of light collection efficiency. The absolute energy scale was calibrated by using the 100-200 GeV electron beams and the 350 GeV proton beams from the Super Proton Synchrotron at CERN and was determined to a precision of 3.5% and 6.5%, respectively [7, 9]. The events with a particle entering within 2 mm from the edge of the calorimeters

Figure 1: Left: The difference between the event time stamps recorded by ATLAS and LHCf detectors. Right: Relation between the event BCIDs assigned by the two detectors, based on the information from the event time stamp.

Figure 2: Event displays of common events recorded by LHCf and ATLAS, with a particle reconstructed in TS (top) and TL (bottom) in the LHCf Arm2 detector covering negative pseudorapidity. The LHCf display shows hit position measured by the silicon strip sensors (top) and the deposited energy in the sampling calorimeters (bottom). The ATLAS display shows the reconstructed tracks of charged particles (blue lines) in the inner detector and the energy deposited in the calorimeters (yellow squares).

are removed from the analysis. The multi-shower events corresponding to the events with more than one incident particle in one tower are identified by the lateral profile of the showers measured by the silicon strip layers and they are removed from the analysis. The LHCf has energy resolutions of \(<\)5% and \(\sim\)40% for electromagnetic and hadronic showers, respectively. The effects of the finite energy resolution and non-uniformity of acceptance in pseudorapidity are not corrected for in these results. Only the events with energy deposits above 100 GeV for photons or 500 GeV for hadrons are analysed here in order to suppress background due to charged particles.

The events are classified based on the number of charged particle tracks reconstructed by ATLAS, \(n_{\mathrm{sel}}\). The standard charged particle track selection in the inner detector developed for \(pp\) collisions [10] is adopted. Tracks with \(p_{\mathrm{T}}>100\) MeV matched to a primary vertex, defined as the vertex with the highest \(\Sigma p_{\mathrm{T}}^{2}\) from tracks associated to it, are selected in the tracker acceptance range \(|\eta|<2.5\). All tracks are required to have at least one hit in the Pixel detector and, if expected by the tracking model, also a hit in the first Pixel layer. Further cuts on the hit multiplicity in SCT are imposed depending on the reconstructed track \(p_{\mathrm{T}}\) such that at least 2, 4 and 6 hits are required in the ranges 100 MeV \(<p_{\mathrm{T}}<\) 200 MeV, 200 MeV \(<p_{\mathrm{T}}<\) 300 MeV and \(p_{\mathrm{T}}>\) 300 MeV, respectively. To ensure the tracks originate from the primary vertex, the transverse impact parameter, \(d_{0}\), and the longitudinal impact parameter, \(z_{0}\sin\theta\), have to be smaller than 1.5 mm in absolute value. The significances \(|d_{0}/\sigma_{d_{0}}|\) and \(|z_{0}\sin\theta/\sigma_{z_{0}\sin\theta}|\) are required to be smaller than 3, where \(\sigma_{d_{0}}\) and \(\sigma_{z_{0}\sin\theta}\) denote the uncertainties on the determination of the \(d_{0}\) and \(z_{0}\sin\theta\) parameters from the covariance matrix provided by the ATLAS tracking model. The efficiency of the low \(p_{\mathrm{T}}\) track reconstruction is around 20% for 0.1 GeV \(<p_{\mathrm{T}}<\) 0.2 GeV and reaches a plateau around 80% at \(p_{\mathrm{T}}\sim\) 1 GeV [11].

## 6 Simulations

Monte Carlo simulations for the QCD inelastic and UPC processes are used to study the properties of the analysed events in terms of produced central charged particles and forward particle scattering angles. The QCD prediction is obtained with the DPMJET3.04 event generator [12]. The UPC processes are simulated using the Weizsacker-Williams method [13] for calculating the flux of virtual photons around a Pb nucleus and the SOPHIA model [14] for the event generation of \(\gamma\mathrm{p}\) collisions. The results of the event simulation are used at generator level in this study without any resolution effects or efficiency losses simulated in either LHCf or ATLAS.

## 7 Results

The energy spectra of the photon-like and hadron-like events from the LHCf standard analysis are shown in Fig. 3. The number of charged particle tracks reconstructed by ATLAS is used to categorize the events into those with \(n_{\mathrm{sel}}=0\) and those with \(n_{\mathrm{sel}}>0\). Clear difference between the two selections is observed in the TS, which covers pseudorapidity range \(\eta<-9.6\), especially in the hadron-like spectra. The hadron-like spectrum in TS has a characteristic shape with a peak around 3.5 TeV and a long tail up to 10 TeV. The tail is due to the energy resolution of 40%. The events with \(n_{\mathrm{sel}}=0\) dominate and are responsible for the observed shape. Figure 4 shows the forward particle scattering angle of the particles measured by LHCf, converted from the reconstructed position of the impact point assuming the LHCf detector position at 140 m from IP1, for the hadron-like events with energy deposits higher than 500 GeV. The angles below and above 140 \(\mu\)rad correspond to the acceptances of TS and TL, respectively. The enhancement of the events with no charged particle tracks reconstructed by ATLAS is clearly visible in the TS pseudorapidity coverage range as well.

The peaked spectrum around 3.5 TeV for hadron-like events in TS and the strong enhancement of hadron-like events around 0 \(\mu\)rad with \(n_{\mathrm{sel}}=0\) are caused by UPC. Photons created in the strong electro Figure 3: The energy spectra of the photon-like (top) and hadron-like (bottom) events measured by LHCf in TS (left) and TL (right) are shown as black circles. The effects of the finite energy resolution and non-uniformity of acceptance in pseudorapidity are not corrected for in these results. A classification based on the number of charged particle tracks in the central region reconstructed by ATLAS is done. The events with (without) reconstructed charged particles are shown as red triangles (blue squares).

magnetic field of the moving Pb nucleus may interact with the colliding protons with high probability, leading to UPC processes where states such as \(\Delta^{+}\) are created, subsequently decaying into a neutron and a \(\pi^{+}\) (\(p+\gamma\rightarrow\Delta^{+}\to n+\pi^{+}\)). In such interactions, produced neutrons have mean energy of about 3.5 TeV and mean \(p_{\mathrm{T}}\) of about 0.1 GeV, thus reaching the TS acceptance of the LHCf detector. Such process are expected to leave no activity at central rapidity. The measurement of \(\pi^{0}\) production in decays of the excited state into a proton and \(\pi^{0}\)[15] also indicates background due to UPC processes.

Figure 4 also shows a Monte Carlo simulation of UPC and QCD processes. The simulated distribution, which is the sum of the two processes, is normalized to the data without \(n_{\mathrm{sel}}\) selection in the range from 0 \(\mu\)rad to 120 \(\mu\)rad. The shapes of the distributions from data and Monte Carlo simulation are similar. The region at higher angles is dominated by low energy neutrons as shown in Fig. 3 and therefore the energy requirement of at least 500 GeV has bigger impact here. The description of data in this region depends on precise simulation of detector response which is missing for this study.

The simulation predicts that the dominant contribution from UPC can be suppressed by rejecting events without any reconstructed charged particle tracks in ATLAS as no central activity is expected for UPC. There are approximately twice as many events with observed charged particle tracks in ATLAS than the QCD simulation indicates. The discrepancy is not completely unexpected since DPMJET3.04 is known to predict the QCD component within factor 2 [16]. However, it should be noted that no track requirement in the ATLAS detector acceptance is imposed on the Monte Carlo sample. This requirement would potentially increase the difference between data and simulation due to the track reconstruction

Figure 4: Scattering angle of the hadron-like events with energy deposits higher than 500 GeV. The effects of the finite energy resolution and non-uniformity of acceptance in pseudorapidity are not corrected for in these results. All events from the common ATLAS and LHCf dataset are shown as black circles, and the subset of those with charged particle tracks reconstructed in ATLAS are indicated by blue triangles. The data is compared to the Monte Carlo simulation of the processes corresponding to UPC and QCD (black) and QCD only (blue). No simulation of the particle interactions with the detector material is performed. The sum of UPC and QCD simulations is normalized to all data in the range from 0 \(\mu\)rad to 120 \(\mu\)rad.

inefficiency. These results indicate that while the simple requirement on the presence of reconstructed charged particle tracks in the central rapidity region provide a powerful tool to significantly reduce the UPC background, it may not be enough to fully suppress all UPC events. Reference [17] suggests that a rapidity gap selection combining calorimeter and tracking information provides higher discrimination power.

This is further demonstrated in Fig. 5 that shows the charged particle track multiplicity in the events triggered by EF_L1LHF_NoAlg. The additional requirement of L1_MBTS_1_1 allows for identification of the non-diffractive QCD events, since the UPC and diffractive processes are missed by this trigger due to the presence of rapidity gaps. The non-diffractive component shows a turn-on at \(n_{\mathrm{ch}}\sim 10\) and dominates at higher charged particle track multiplicities. The L1_MBTS_1_1 trigger fires on all events with more than approximately 30 tracks. The dominant contribution in the recorded dataset comes from the photonuclear and diffractive processes that lead to the peak at \(n_{\mathrm{ch}}=0\) and low track multiplicities. Simulation studies show that UPC processes are dominant over diffractive ones for \(p\)+Pb collisions at \(\sqrt{s_{{}_{\mathrm{NN}}}}=5.02\) TeV. The excess at \(n_{\mathrm{ch}}=0\) in the events selected by L1_MBTS_1_1 is likely due to diffractive processes where the rapidity gap coincides with the acceptance of the ATLAS inner detector.

## 8 Conclusion

This note presents an analysis of a combined \(p\)+Pb dataset taken by the ATLAS and LHCf experiments in 2013, demonstrating the ability to match common events by comparing time stamps. The observed shape in the energy spectrum measured by LHCf suggests that the events where neutral particles are scattered at low angles are dominated by the UPC processes. Since no central activity is expected for UPC, contrary to non-diffractive inelastic processes, the information from the central rapidity region covered

Figure 5: Multiplicity of the charged particle tracks, reconstructed in the ATLAS inner detector, in the events triggered by EF_L1LHF_NoAlg. The fraction of events where L1_MBTS_1_1 fired is indicated.

by the ATLAS detector can be used distinguish between the two classes of events. Such classification of events in a data-driven way is done utilizing the number of reconstructed charged particle tracks and thus demonstrates the potential of a joint analysis. The observations are supported by Monte Carlo simulations.

Further developments of the analysis methods and new constraints on cosmic-ray air shower simulations will be possible with the new common data taken during the 2015 \(pp\) operation. Contrary to the situation in \(p\)+Pb collisions, simulations predict negligible UPC contributions for \(pp\) collisions. Therefore, the main analysis goal will be to separate inelastic and diffractive collisions based on the counting of charged particle tracks in ATLAS. Since the two processes are treated differently in interaction models, such event separation will allow to further develop cosmic-ray air shower simulations.

## References

* [1] LHCf Collaboration, _Technical Design Report of the LHCf Experiment: Measurement of Photons and Neutral Pions in the Very Forward Region of LHC_, Tech. Rep. CERN-LHCC-2006-004 LHCF-TDR-001, Feb, 2006. [https://cds.cern.ch/record/926196](https://cds.cern.ch/record/926196).
* [2] S. Ostapchenko, _LHC data on inelastic diffraction and uncertainties in the predictions for longitudinal extensive air shower development_, Phys. Rev. D **89** (2014) 074009.
* [3] C. A. Bertulani, S. R. Klein, and J. Nystrand, _Physics of ultra-peripheral nuclear collisions_, Ann.Rev.Nucl.Part.Sci. **55** (2005) 271-310, arXiv:nucl-ex/0502005 [nucl-ex].
* [4] LHCf Collaboration, _The LHCf detector at the CERN Large Hadron Collider_, JINST **3** (2008) S08006.
* [5] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003.
* [6] LHCf Collaboration, _LHCf detector performance during the 2009-2010 LHC run_, Int. J. Mod. Phys. A **28** no. CERN-PH-EP-2013-142. 25, (2013) 1330036. 26 p. [https://cds.cern.ch/record/1563536](https://cds.cern.ch/record/1563536).
* [7] LHCf Collaboration, _The performance of the LHCf detector for hadronic shower_, JINST **9** (2014) P03016. 15 p.
* [8] S. Ask, D. Berge, P. Borrego-Amaral, D. Caracinha, N. Ellis, P. Farthouat, P. Gelln, S. Haas, J. Haller, P. Klofver, A. Krasznahorkay, A. Messina, C. Ohm, T. Pauly, M. Perantoni, H. P. L. Junior, G. Schuler, D. Sherman, R. Spiwoks, T. Wengler, J. M. de Seixas, and R. T. Teixeira, _The ATLAS central level-1 trigger logic and TTC system_, Journal of Instrumentation **3** no. 08, (2008) P08002. [http://stacks.iop.org/1748-0221/3/i=08/a=P08002](http://stacks.iop.org/1748-0221/3/i=08/a=P08002).
* [9] LHCf Collaboration, _Calibration of LHCf calorimeters for photon measurement by CERN SPS test beam_, Nuclear Instruments and Methods in Physics Research A **671** (2012) 129-136.
* [10] ATLAS Collaboration, _Charged-particle multiplicities in pp interactions measured with the ATLAS detector at the LHC_, New J.Phys. **13** (2011) 053033, arXiv:1012.5104 [hep-ex].
* [11] ATLAS Collaboration, _Transverse momentum, rapidity, and centrality dependence of Charged Particle Production in \(p\)+\(Pb\)\(\sqrt{s_{\rm NN}}=5.02\) TeV collisions measured by ATLAS experiment at the LHC_, Tech. Rep. ATLAS-CONF-2013-107, CERN, Geneva, Nov, 2013. [https://cds.cern.ch/record/1624333](https://cds.cern.ch/record/1624333).