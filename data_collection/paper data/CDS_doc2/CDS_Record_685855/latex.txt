# The alignment procedure of the chambers

of the ATLAS muon spectrometer

C. Guyot (Saclay)

June 13th 1994

###### Abstract

This report presents a mathematical study of the alignment procedure of a tower of chambers in the ATLAS muon spectrometer. The measured sagitta of a muon crossing a chamber triplet is corrected, using the apparent sagittas of a network of light rays traversing photosensitive detectors mechanically linked to the muon chambers. Advantage is taken of projectivity constraints in the barrel region; these are impractical in the forward region, where a non-projective alignment scheme is proposed. A computer model, that simulates initial misalignments of chambers arranged in the ATLAS geometry, is developed to study the sensitivity of the algorithms to optical sensor resolution, chamber placement tolerances, relative angular alignment within a tower, and longitudinal pp vertex spread.

## 1 Local, in-plane and global alignments

In each layer the chambers are segmented to form projective towers which contain the trajectory of high energy muons. The internal alignment of a tower (so-called local alignment) makes use of a set of straightness monitors based on light rays connecting the corners or the edges of the chambers. The fake sagittas observed along the light rays are combined into a correction function to the measured sagitta of a muon track, which depends on the track position inside the tower. We aim at a precision on this correction of better than 30 \(\mu\)m. A example of chamber segmentation and the light rays layout is shown on Fig. 1 for the barrel and end cap regions.

The optical elements are attached to the stiff combs of the MDT chambers which define the wires positions. Unavoidable (small) deformations of individual chambers are controlled by a set of 4 in-plane straightness monitors (e.g. 3 point RASNIK system) which relate the positions of the 2 or 3 combs to a reference plane that would be defined by the optical elements for the local tower alignment if the chamber was not deformed (Fig. 2).

Applied after the in-plane alignment corrections, the local alignment algorithm described in the next sections assumes the chambers to be perfectly planar rigid bodies (except for a possible global and homogenous thermal expansion), the absolute position of which is described by 6 parameters (3 translations and 3 rotations).

Finally, tower-to-tower (or global) alignment is needed for the reconstruction of low energy tracks overlapping adjacent towers or for the determination of the invariant masses of multimuons states. In the first case, a precision of a few hundred \(\mu m\) canbe achieved by using tracks overlapping 2 adjacent chambers. The initial mechanical precision of a few mm, eventually crossed-checked by the reconstruction of \(Z\rightarrow\mu\mu\) events is sufficient for the second case.

## 2 The local alignment scheme in the barrel towers

In the special case of a projective geometry, it can be shown (See Appendix for mathematical developments and more detailed results) that, to first order in the displacements (translation and rotations) of the chambers, the apparent sagittas in the longitudinal and transverse planes of a straight strictly projective trajectory depends only on 6 parameters expressed as linear combinations of the displacements of the chambers. Homogenous thermal dilations can also be taken into account in the model without increasing this number of free parameters. The mathematical model and the corresponding computer simulations show that 4 projective light rays with 2D optical sensors (i.e. which provide a precise measurement both in the bending plane (along the beam axis \(z\)) and in the \(R\phi\) transverse plane provide enough information (8 measured fake sagittas) to properly correct apparent sagittas of projective muon tracks. In contrast with the GEM approach, the correction does not rely on a simple quadratic interpolation between the fake sagittas measured in the bending plane with the 6 light rays of a tower. Instead, our procedure uses all the available information in 2 dimensions (or even 3 with the 3D RASNIK) to calculate, to first order, the 6 free parameters and the resulting correction to the apparent sagitta of a muon crossing the chambers.

Figure 1: _Layout of the chambers in the r-z plane. It shows the segmentation of the large chambers in the barrel and the trajectories of the light rays: projective in the barrel and non-projective in the end caps._

The accuracy of this correction depends on several factors:

* The precision of the optical sensors. Simulations show that given the contributions from the other parameters, precisions of the order of \(10\mu m\) in the z direction and \(100\mu m\) in the transverse direction are acceptable. This level of accuracy can be easily achieved by the RASNIK system [1] or the transparent silicon strips sensors [2] provided that the light beams are kept away from spurious temperature gradient sources.
* The range of initial chamber displacements from the ideally aligned geometry. For large displacements (several cm in translation or mrad in rotation) non-linear effects become too large as mathematically the projective model rests on a linear approximation.
* The deviation from a perfectly projective geometry. The main effect comes from the longitudinal spread of the \(pp\) vertex (\(\sigma_{*}=5.5\ cm\)) which leads to non-projective muon trajectories. Unfortunately the knowledge of the vertex position would not help to improve the correction as shown by Fig. 3 which exhibits a c

Figure 2: _Sketch of a tower of 3 barrel chambers. The vertical rays correspond to the projective beam for the local alignment. The dash lines correspond to the optionnal and non-necessary \(5^{th}\) and \(6^{th}\) rays. Each chamber consists of 3 wire-positioning combs, with 4 straightness monitors measuring their relative alignment._

configuration of misalignment which is not seen by the projective light rays but creates a apparent sagitta for a non-projective straight track.
* The uncertainty on the knowledge of the absolute tower position and orientation. This effect, qualitatively similar to the previous one in its impact on the sagitta correction, is less important in practice as the tower position is known to better than a few cm.
* The limited knowledge of the track position across the chamber in particular in the non-bending direction.

Detailed simulations of the correction procedure were carried out assuming random initial displacements of the chambers with respect to their ideally aligned positions inside a projective tower. It is assumed that perfect sensor positioning on the chambers and no chamber misalignment correspond to the "zero" of the alignment system (no observed fake sagitta, within the intrinsic accuracy of the sensors). In practice, the sensors are positioned with a limited precision (of the order of 10 to 20 \(\mu m\) in z and y, may be 50 to 100\(\mu m\) in x) and the chambers may undergo complex deformations, not entirely corrected by the in-plane alignment system, which induce additional departures from the ideal position, especially in y and x. In this section, we do not separate the intrinsic sensor accuracy from the (dominant) contribution from the bad positioning and the uncontrolled deformati ons. In particular, we neglect the error along y, the

Figure 3: _Example of an misalignment configuration which is not seen by the projective light rays (to first order in the small rotation angle \(\delta\theta\)), but creates an apparent sagitta for a non-projective straight \(\mu\) track. In this example, \(y_{MO}=2y_{MI}\)._

contribution of which is \(\sim 2.5\) smaller than the contribution from the error along z, when averaged over the barrel. The calibration of the "zero" by mean of straight muon tracks of possible wrong sensor positionings and chamber deformations is addressed in section 4.

For a given range in the chambers displacements (uniformly distributed between \(\pm 0.5\ cm\) in translation and \(\pm 2.5\ mrad\) in rotation), Fig. 4 shows the RMS of the corrected sagitta, for muons spread over the whole barrel region, as a function of the precision on the transverse muon track position in the middle layer. This variation is given for different hypotheses on optical sensor precision, knowledge on the tower position and orientation and pp vertex spread. It shows that an acceptable sagitta correction can be achieved with this alignment scheme provided the precision on the muon track coordinate in the transverse plane is better than \(\sigma\sim 2\ cm\).

Simple chamber deformations can be incorporated in the model by adding one free parameters. As examples of such deformations, we have considered different dilation factors along the x and z directions, a torsion (or twist) of the chambers around the x axis or a sagitta induced by gravity. The first two effects can be separately corrected for by the 4 rays model whereas the correction for the gravitational sag would require the addition of at least one ray in the non-bending plane. The fact that large expansion factors along the x direction can be corrected for without loss of accuracy is of great importance, as such an effect may result from variations of the distance between the 2 extreme combs induced by drift tube pressure and temperature effects. As the last two effects are already handled and corrected for by the in-plane alignment system, the addition of the corresponding degree of freedom in the local alignment procedure, would serve only as a cross-check.

## 3 Requirements on the initial chamber positioning in the barrel region

The departure from an ideal projective geometry increases the sensitivity of the projective scheme to the size of the initial displacements. Fig. 5 shows the effect of the chamber placement tolerances on the sagitta correction. Magnet cryostat displacements of the order of 1 cm within a given tower give rise to relative rotations of the chambers smaller than 2 or 3 mrad. Such displacements which appear compatible with the expected reproducibility of the cryostat position, still lead to an acceptable precision on the sagitta correction (below the level of \(30\mu m\)).

This study also shows that a wider range of translational placement errors (up to 2 cm) could be accepted if the rotations can be controlled down to the 1 mrad level. This could be achieved by the of 2 axial light beams (per sector and per layer) traversing very transparent optical sensors connecting all the chambers of a barrel layer (Fig. 6). The directions of these 3 sets of light beams would be constrained to be identical by means of non-deformable beams supporting the laser sources and optical sensors. Although not absolutely needed if the reproducibility of cryostat positions during magnet operations proves to be better than 1 cm within a given tower, the addition of such a Figure 4: _RMS of the distribution of corrected sagittas, for infinite momentum tracks, averaged over the whole barrel region, shown as a function of the precision on the transverse track coordinate in the middle layer MM. The sensor precision is \(5\mu m\) along z and \(50\mu m\) along the transverse direction. The triangles correspond to an ideal projective geometry with no pp vertex spread. The circles show the effect of including the uncertainty on the tower position (\(\pm 1\) cm) and orientation (\(\pm 5mrad\)). The squares reflect the impact of the vertex spread._

Figure 5: _RMS of the distribution of corrected sagittas, for infinite momentum tracks, averaged over the whole barrel region, as a function of the chamber positioning tolerance (expressed as the half width of a uniform distribution). The sensor precision is \(5\mu m\) along \(z\) and \(50\mu m\) along the transverse direction. The simulation was carried out for different assumptions on the rotational tolerance: 1 mrad (triangles), 2.5 mrad (squares) and 5 mrad (circles). Open symbols correspond to a perfect projective geometry. Dark symbols include effect of tower displacements and vertex spread._

system would add redundancy to the general alignment scheme.

## 4 Calibration of the straightness monitors with muons

In practice, we may have to face unexpectedly large positioning errors of optical elements and chamber deformations not corrected by the in-plane alignment system. In this section, we investigate the possibility of using muon tracks to work out a correction to the fake sagitta of a light ray induced by these effects.

When the magnetic field is turned off, multiple scattering in the MM chamber is the dominant contribution to the apparent sagitta of muon tracks from minimum bias events, at the level of \(\sigma=400\mu m\) for \(P_{i}=20GeV\) at \(\eta=0\). By comparing the average sagitta of tracks, extrapolated at the theoretical position of the optical elements, with the observed fake sagitta of the corresponding light rays, the difference can be used as corrections to be applied to all further measurements of fake light ray sagittas. At a luminosity L=\(10^{38}cm^{-2}s^{-1}\), we expect \(\sim 3\) muons with \(P_{i}\) above 15 GeV per second and per tower. In a 5 hours run, we can accumulate \(5.10^{4}\) muons per tower. Using the simple geometrical model which calculates the measured sagitta for any trajectory across the tower from the values of the chamber displacements (the longitudinal fake sagitta of a projective straight trajectory depends only on 5 parameters), an accuracy better than \(15\mu m\) on the sagittas extrapolated at the sensor locations can easily be achieved.

This calibration procedure has been implemented in the simulation. For one so-called "alignment event", the sequence of operations proceeds as follows:

Figure 6: _Top view of a possible arrangement of axial rays with their transparent optical sensors for the control of the relative rotations of the layers within a triplet, and of the chambers within each layer._

* Displacements of the optical elements on the chambers are generated in the 3 directions z, y and x.
* A set of chamber displacements (translations, rotations and dilations) is generated. This set would correspond to the situation "field off".
* The difference between the apparent sagitta of a light ray and the corresponding average sagitta of the tracks is stored. In the simulation, the latter sagitta is obtained from a single projective track, the position of which is measured on the chambers with an accuracy of \(10\mu m\) in the bending plane and \(100\mu m\) in the non-bending plane. These zero calibration values will serve to correct the fake sagittas observed with "field on".
* A second set of chamber misalignments is generated. It corresponds to the "field on" situation which is used for the muon momentum measurements.
* The fake sagittas of the light rays are corrected with the zero calibration values before they are used to work out the corrections to muon track sagittas.

The chamber displacement ranges are taken identical to those of Fig. 4. The intrinsic sensor precision is \(5\mu m\) in both z and x directions. With sensor displacements as large as \(50\mu m\) in z, \(100\mu m\) in y and \(1\ mm\) in x (\(\sigma\) of gaussian distributions), the RMS of the corrected sagitta distribution for muon tracks is \(26\mu m\). This value is to be compared with \(16\mu m\) obtained without wrong positioning and without the calibration procedure with tracks. With wrong positioning and without zero calibration, RMS values as large as \(110\mu m\) are obtained. This calibration procedure can deal with even larger( by factor 2 to 3) sensor displacements without significant loss of accuracy.

The same procedure could be applicable using "field on" tracks, provided the track momenta are measured with an independent spectrometer. This could be achieved with the proposed Muon Silicon Spectrometer (MUST). Given its limited cross-section (\(\frac{1}{16}m^{2}\)) and length (\(\sim 1.2m\)), it measures the momentum of \(P_{t}=20GeV\) muons with an accuracy of 1% at a rate of \(\frac{1}{50}Hz\) for a luminosity L=\(10^{33}cm^{-2}s^{-1}\). With this accuracy, multiple scattering in MM is still the dominant contribution to the uncertainty on the sagitta measured with the chambers. Pointing MUST in the direction of a light ray trajectory, it would require about 6 hours to reach an accuracy of \(20\mu m\) on the average sagitta of muons. As MUST does not require special runs to operate, this time laps appears acceptable.

## 5 Strategy for chamber alignment in the end cap region

Due to the presence of the end cap toroid cryostat, the projective scheme cannot be applied to the end cap chambers. Instead a procedure involving at least 6, and preferably 8, non-projective light rays is considered (Fig. 1). The detailed arrangement of the rays is shown in Fig. 7.

The goal is a full reconstruction of the positions of 2 layers (e.g. MI and MO) with respect to a reference one (e.g. MM). This involves 12 parameters ( 14 when an hypothetical homogenous thermal expansion is taken into account). An elegant solution is Figure 7: _9D view of the 9 end cap chamber layers (MI,MM,MO) showing the intersections of the 8 light rays at the positions of the optical sensors._

supplied by recent progress on the 3D RASNIK system, which provides information on the longitudinal position of the optical elements. Making use of the size of the mask image measured by the CCDs, recent experimental results show that precisions better than \(100\mu m\) can be achieved on the lens position along its optical axis for distances between the mask and the CCD planes of the order of 5 m. With this additional information, 8 rays provides 24 independent measurements. A \(\chi^{2}\) fit leads to a precise determination of the 14 parameters which describe the tower geometry.

A complete simulation of the chamber displacements, realignment procedure and sagitta correction to muon tracks shows that the accuracy of this scheme is satisfactory (below \(20\mu m\) for the RMS of the corrected sagitta distribution of infinite momentum tracks) with the available sensor precision, and is now independent of the vertex position and the range of initial chamber displacements.

In this scheme, a complete end cap layer has to be considered as a single rigid planar body even though it consists physically of several individual chambers. Therefore these chambers have to be connected by radial light rays and transparent optical sensors (with a limited intrinsic accuracy above \(100\mu m\)) for the control of their relative rotations around the x and y axis, translations along the x and z axis, and high precision (\(\sim 10\mu m\)) proximity sensors for the measurement of their relative translation along the radial y axis and rotation around the z axis (Fig. 8).

Figure 8: _Transverse view of a possible arrangement of radial rays with their transparent optical sensors for the control of the relative rotations and translation of the chamber within an end cap layer._

Non-projective alignment schemes in the barrel

A strategy with non-projective rays can also be applied to the barrel towers. The simulation shows that, with the 6 light rays arrangement proposed in Fig. 9 and the same sensor resolutions as for the projective scheme studies (but adding a \(0.5\mu m\) resolution on the image size measurement), the accuracy on the sagitta correction is of the order of \(10\mu m\), independent of the vertex spread and the range of the chamber displacements (which is anyway limited by the finite size of the optical elements). Such a scheme, still applied to individual projective towers, is an attractive alternative to the projective approach, provided that the arrangement with 6 rays is compatible with the magnet geometry and the chamber technology ( more paths have to be provided to let the light go through the strut plane and the chamber layers).

Another strategy, following even more closely the end-cap scheme, could be applied to the barrel if a successful technical design is worked out for the procedure, based on

Figure 9: _The non-projective arrangement of 6 light rays in a projective barrel tower used in the simulation._

axial beams (Fig. 6) and proximity sensors (Fig. 8), which allows to consider a complete layer of physically separated chambers as a single rigid body. In this scheme, the parallelism of the 3 chamber layers would be ensured by either a set of non-deformable beams which positions the axial rays or a set of radial 3D RASNIK connecting the 3 layers. It would offer the advantage of releasing many constraints on the chamber construction (regular segmentation, identical for the large and the small chambers, radial light paths easier to incorporate). This strategy, which follows rather closely the SDC approach, has not been studied so far within ATLAS.

## 7 Conclusions

In the barrel region, the projective alignment method with 4 light rays and 2D sensors provides acceptable corrections to the sagitta of tracks in the bending plane for all possible misalignment of non-deformable chambers including homogenous thermal expansion. The factors limiting the accuracy of the correction are the vertex spread which breaks the projectivity of the scheme, and the limited accuracy in the determination of the track position in the transverse plane. With these limitations taken into account, the alignment scheme provides acceptable corrections for relative movements of the chambers inside of a tower as large as 1 cm in translation and 2.5 mrad in rotation. An advantage of the projective scheme comes from the possibility of using muons tracks to provide an easy calibration of the straightness monitors. In the end cap region, due to the progress made with the 3D RASNIK system, the feasibility of a non-projective scheme has been established, provided one achieves a proper control of the relative displacements of the different chambers in a given layer to the level of \(10\mu m\). A similar approach with 6 non-projective rays connecting the chambers of a projective barrel tower appears to be a possible alternative to the projective scheme.

## References

* [1] H. Dekker et.al.: The RASNIK/CCD 3-D alignment system. Proceedings of the 3\({}^{rd}\) International Workshop on Accelerator Alignment, CERN/Annecy, Oct. 1993, page 147.
* [2] ATLAS Internal note, MUON-NO-030, Nov. 1993.

## Appendix A Principle of the method

A sketch of a tower of 3 chambers used to measure the momentum of tracks is shown on Fig. 10. The reference frame is defined by the origin being the \(pp\) interaction point, source of the particles to be analysed, the \(z\) axis along one of the proton beam direction (the axis of the ATLAS toroid) and the \(y\) axis which goes along the radial direction perpendicular to a reference chamber, itself parallel to the \(z\) axis and to the magnetic field vector at x=0. The sagittas used to determine the tracks momenta are measured in the (\(y\),\(z\)) plane, the so-called bending plane.

In the general case, the position of a misaligned chamber considered in a first step as a solid non-deformable planar body, can be characterized by 6 parameters,

Figure 10: _Sketch of a tower of 3 chambers showing the possible locations of the light rays._\(\delta x,\delta y,\delta z,\delta\psi_{z},\delta\psi_{y},\delta\psi_{z}\), which give the small deviations in translation and rotation with respect to the nominal position. Without loosing generality, one can consider only the displacement of 2 chambers with respect to a reference chamber taken as a basis. Throughout this note, we will choose the middle chamber as the reference chamber.

The problem would be solved by the knowledge of 12 parameters \(\delta z_{i}^{k}\) where i=1 and 3 runs over the misaligned chambers and k=1,6 runs over the 6 parameters:

\(\delta z^{1}=\delta z,\delta z^{2}=\delta y,\delta z^{3}=\delta z,\delta z^{4}= \delta\psi_{x},\delta z^{5}=\delta\psi_{y},\delta z^{6}=\delta\psi_{z}\).

In addition the chambers may be subject to thermal expansions coming for instance from a temperature difference between the chambers. In a first stage,we assume homogenous temperature changes and add a priori one more free parameter per chamber \(\delta z^{7}=\delta d\) where \(\delta d\) is the dilation factor.

The chambers are mechanically positioned with accuracy of the order of 1 \(mm\) but due to the movements of the support structures (toroid cryostats) one may have to cope with misalignment parameters values of several \(mm\) or \(mrad\). Typical dilation parameters are of the order of \(10^{-4}\) per degree.

The correction to the measured sagitta of a muon track in the (y,z)plane is derived from the positions of several straightness monitors which connect the chambers edges or corners. In ATLAS these devices would be based on light rays and optical elements precisely positioned on the chambers with respect to the sense wires. For example, in the RASNIK system, these sensors are the object source (a lighted coded mask) on one of the extreme chamber, a lens in the middle chamber and a CCD plane to reconstruct the image of the mask on the other extreme chamber. Another type of system would consist of a set a transparent Si photosensors with strips readout to reconstruct the light profile of a thin laser beam.

These devices have a intrinsic precision of a few micrometers, but the effective precision, of the order of 20 \(\mu\)m, will come from the mechanical accuracy of implementation of these sensors on the chambers with respect to the sense wires. They are intrinsically 2D monitors which can give the light rays positions in both z and x directions. Nevertheless, the accuracy of the positioning in the transverse x direction may be not so easy to achieve for some chamber technologies. In general, the use of 2D sensors requires a very good control of the angle between the wires direction and the z axis of the chamber, typically better than 0.1 mrad.

Each light ray with 2D sensors provides 2 constraints (alignment of 3 points in space) under the form of two measured so-called fake sagittas \(\delta s_{L}\) and \(\delta s_{T}\) in the longitudinal (y,z) and transverse (x,y) planes. The RASNIK system can in addition provide information on the sensors position along the direction of the light beam through the knowledge of the magnification of the image size. With parallel chambers, the alignment conditions would require all the images to be equal in size, the absolute size being a free parameter for a projective geometry. The present accuracy on the reconstruction of the image size on the CCD plane is of the order of 0.5\(\mu\)m provided that mask and CCD planes are exactly conjugated with respect to the lens plane. This accuracy translates into a \(\sim 100\mu m\) precision on the middle chamber position along the light ray for a distance of 5m between extreme chambers.

The correction \(\Delta S\) to the measured sagitta in the bending plane of a track with polar angles (\(\theta\), \(\phi\)) is a function of the \(2N_{R}\) fake sagittas obtained from the \(N_{R}\) light rays, of the \(N_{R}\) deviations from the nominal image sizes \(\delta I^{j}\) for the RASNIK system, of the track polar angles and the parameters describing the tower geometry :\[\delta s_{real}=\delta s_{meas}-\Delta S(\textit{tower geometry};\theta,\phi; \delta s_{L}^{i},\delta s_{T}^{j},\delta I^{j},j=1,N_{R}) \tag{1}\]

The analytic derivation (to first order in the chamber displacement parameters) of this correction function is presented in the next sections. A test of the validity of the realignment procedure with a Monte Carlo simulation is presented.

## Appendix B The alignment of solid non-deformable chambers

The 3 planar chambers are supposed to be organized in a projective tower pointing to the vertex. For simplicity, we shall assume that they are parallel to the (z,x) plane, but the conclusions will be qualitatively valid for non-parallel chambers. The centers of the chambers, origin of the local frame in which the (z,x) plane defines the nominal position of the chamber, are also supposed to be projective. In the general case, the light rays have some arbitrary direction i.e. not necessarily pointing to the origin. In the particular case of the projective align method (see e.g. the GEM technical note TN-92-150), all the light rays are supposed to point to the pp vertex.

To first order in the \(N_{P}\)=7 chamber displacement parameters, the fake sagitta induced on the light ray \(j\) by a shift of chamber \(i\) can be expressed as follows:

\[\delta s_{i}^{i}=f_{i}^{i}\sum_{k=1,N_{P}}a_{ki}^{i}\delta x_{i}^{k} \tag{2}\]

A similar expression holds for \(\delta I_{j}^{i}\), the image size deviation for ray \(j\) induced by a displacement of chamber \(i\).

Fig. 11 shows the effect on the measured sagitta of a translation \(\delta y\) of chamber 3. The coefficients \(a_{ki}^{i}\) are given in table 1 for the 7 types of displacement and for the 3 different measured quantities associated with a light ray. The angles \(\theta_{j}\) and \(\phi_{j}\) are the angles of the light ray \(j\) with respect to the axis y in the (y,z) and (x,y) planes. \(\Delta x_{i}^{i}\)

Figure 11: _Sagitta \(\delta s_{L}\) induced by a translation \(\delta y\) of chamber 3_.

and \(\Delta x_{i}^{j}\) are the coordinates of the intersection of ray \(j\) with chamber \(i\) in the local frame of this chamber (origin at the center of the chamber). For the RASNIK system, \(\delta I_{j}^{i}\) is proportional to a displacement \(\delta y_{i}\) of chamber \(i\) with a coefficient

\[F_{Ij}=\frac{4S_{m}}{y_{3}^{j}-y_{1}^{j}}\frac{y_{3}^{j}-y_{2}^{j}}{y_{2}^{j}- y_{1}^{j}} \tag{3}\]

where \(S_{m}\) is size of the mask (or more precisely the size of part of the mask which is optically conjugated with the CCD area through the lens as in practice the mask is much larger than the CCD area) and \(y_{i}^{j}\) is the coordinate of the intersection of the ray \(j\) with chamber \(i\).

The coefficient \(f_{i}^{j}\) weights the impact of chamber i on the sagitta of ray j. It is equal to 0.5 for parallel equidistant chambers. In general:

\[f_{i}^{j}=\frac{y_{3}^{j}-y_{1}^{j}}{4\|y_{i}^{j}-y_{2}^{j}\|} \tag{4}\]

To first order, the contributions from the chambers add up which leads to the following expression for the measured fake sagittas (and/or image size):

\[\delta s^{l}=\sum_{i=1,3}\delta s_{i}^{l}=\sum_{i,k}a_{ki}^{l}f_{i}^{j}\delta x _{i}^{k} \tag{5}\]

where l=1,\(N_{R}\) refers to the longitudinal fake sagittas \(\delta s_{L}^{j}\), l=\(N_{R}+1\),2\(N_{R}\) refers to the transverse sagittas \(\delta s_{T}^{j}\). In the RASNIK case one may consider in addition the image size deviations \(dIij\) corresponding to l=2\(N_{R}+1\),3\(N_{R}\).

For parallel chambers, the \(f_{i}^{j}\) and \(F_{I}\) are independent of the rays and the coefficients \(a_{ki}^{j}\) are independent of the chamber i for k=1,3. In the general case, there are 2\(N_{P}\)=14 free parameters, so that at least \(N_{R}\)=7 rays with 2D sensors would be required without the longitudinal information, while in principle 2\(N_{R}\)=6 RASNIK would be sufficient with the longitudinal information. Nevertheless, in order to overconstrain the problem, it is certainly desirable to work with 8 rays if the longitudinal information is not available. In this general case, we have to solve a system of 2(or 3)\(N_{R}\) linear equations of the type equation 5 for the 2\(N_{P}\) misalignment parameters \(\delta zik\). For such a overconstrained system, this is achieved by a \(\chi^{2}\) minimization as shown in section C. Then the correction

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline parameter & \(\delta x\) & \(\delta y\) & \(\delta z\) & \(\delta\psi_{x}\) & \(\delta\psi_{y}\) & \(\delta\psi_{z}\) & \(\delta d\) \\ k = & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\ \hline \(\delta s_{L}\) & 0. & \(\sin\theta\) & \(-\cos\theta\) & \(-\Delta z\sin\theta\) & \(\Delta x\cos\theta\) & \(\Delta x\sin\theta\) & \(-\Delta z\cos\theta\) \\ \(\delta s_{T}\) & \(-\cos\phi\) & \(\sin\phi\) & 0. & \(-\Delta z\sin\phi\) & \(-\Delta z\cos\phi\) & \(\Delta x\sin\phi\) & \(-\Delta z\cos\phi\) \\ \(\delta I\) & 0. & \(F_{I}\) & 0. & \(-F_{I}\Delta z\) & 0. & \(F_{I}\Delta z\) & 0. \\ \hline \end{tabular}
\end{table}
Table 1: _The Coefficients \(a_{ki}^{j}\). The index \(i\) and \(j\) have been omitted. The constant \(F_{I}\) is given in the text._to the measured sagitta in the longitudinal (bending) plane of a track passing through the triplet of chambers is given by:

\[\Delta S_{L}^{cor}=\sum_{i,k}(a_{ki}^{L}f_{i}^{L})\delta x_{i}^{k} \tag{6}\]

where the coefficients \(a_{ki}^{L}\) and \(f_{i}^{L}\) are derived from table 1 by replacing the light ray coordinates by the track coordinates at chamber \(i\). As shown in section C, this correction can also be expressed as a linear combination of the fake sagittas and image sizes for the \(N_{R}\) light rays systems.

## Appendix C The special case of the projective alignment

When the light rays and the infinite momentum tracks ideally point to the origin, the model simplifies significantly. From table 1, it is easy to check that the coefficients \(a_{ki}^{L}\) are independent of the chamber \(i\) for a given ray \(j\) (same \(\theta\) and \(\phi\)) and the coefficients \(f_{i}^{L}\) are the same for all rays \(j\) pointing to the same origin. Thus instead of depending on \(N_{P}=12\) parameters (neglecting dilations), the problem now involves only \(N_{P}=6\) parameters:

\[\delta x^{k}=\sum_{i}f_{i}\delta x_{i}^{k},(translations:k=1,3) \tag{7}\]

\[\delta x^{k}=\sum_{i}f_{i}\frac{\tau_{i}}{\tau_{2}}\delta x_{i}^{k},(rotations:k =4,6) \tag{8}\]

In addition, to first order, a dilation is indistinguishable from a translation of a chamber along the projective axis of the chambers centers. As this translation can be expressed as a combination of two translations along \(y\) and \(z\), the parameter \(\delta d\) can be hidden rated inside effective translation parameters \(\delta y\) and \(\delta z\). The fake sagittas of the ray \(j\) are linear combinations of the \(N_{p}\) effective parameters \(\delta x^{k}\):

\[\delta s^{j}=\sum_{k=1,N_{P}}a_{ki}^{j}\delta x^{k} \tag{9}\]

The same equation applies for the correction to the measured sagitta of a track passing through the triplet of chambers (then the index \(j\) refers to the position of the track inside the triplet). The coefficients \(a_{ki}^{j}\) are given in table 2. When the image size is used, only the differences \(\delta I^{j}\) between the image sizes for the different rays and the nominal absolute size (identical for all the rays in a projective geometry) are relevant. This absolute size becomes an additional free parameter (\(N_{P}=7\) in this case).

With \(N_{P}=6\) free parameters, in principle \(N_{R}=4\) rays with 2D sensors which bring 8 constraints (2 per ray) or 6 rays with 1D sensors (6 constraints) would be sufficient to determine all the misalignment parameters \(\delta x^{k}\). The use of the image size adds additional constraints and are of particular interest when a non-projective scheme is used (see the section on the alignment of the end cap chambers).

In such an overconstrained system, the free parameters are derived from the minimization of the following \(\chi^{2}\):

\[\chi^{2}=\sum_{l=1,2N_{R}}(\delta s_{l}^{m}-\sum_{k=1,N_{P}}a_{ki}^{l}(\theta _{j},\phi_{j})\delta x_{k})^{2}/\sigma_{l}^{2} \tag{10}\]where \(\delta s_{l}^{m}\) are the \(2N_{R}\) measured fake sagittas of the \(N_{R}\) light rays measured with the precision \(\sigma_{l}\) (\(l\)runs up to \(3N_{R}\) when the image size is used).

After the minimization with respect to the parameters \(\delta z_{k}\), the correction to the measured sagitta of a track in the bending plane can be expressed as a linear combination of the measured fake sagitta of the light rays:

\[\Delta S_{L}^{ee}=\sum_{k=1,N_{R}}a_{k}^{L}(\theta,\phi)\sum_{l=1,2N_{R}}(A^{- 1}B)_{k}^{l}\delta s_{l}^{m} \tag{11}\]

where the matrices A and B are simple functions of the 2(or 3)\(N_{R}\) coefficients \(a_{k}^{l}\) and the corresponding sensors precisions \(\sigma_{l}\):

\[A_{km}=\sum_{l=1,2N_{R}}\frac{a_{k}^{l}a_{m}^{l}}{\delta s_{l}^{2}} \tag{12}\]

\[B_{ml}=\frac{a_{m}^{l}}{\delta s_{l}^{2}} \tag{13}\]

As the correction depends on the polar angles of the track, the precision of this correction depends upon the measurement accuracy of the track position on the chambers. In particular, the precision in the non-bending plane, typically of the order of 1 cm is not negligible. In addition this correction is valid only for tracks originating from the nominal \(pp\) vertex. In practice, the \(pp\) vertex spread of the order of \(\sigma_{z}=\)5.5 cm introduces a departure from the perfect projective geometry. The effect of these limiting factors will be studied in the simulation described in the next section.

## Appendix D Monte Carlo simulation of the sagitta correction

The misalignment of chambers 1 and 3 of the projective towers has been simulated in a Monte-Carlo program. To each tower corresponds a set of coefficients \((A^{-1}B)_{k}^{l}\). For each set of misalignment parameters of the chambers one simulates the observed fake sagittas of the light rays. When a perfect projective geometry is assumed, the reference chamber ch2 (MM) is fixed and only ch1 (MI) and ch3 (MO) are moved. to account for the imperfect knowledge of the tower position and orientation, the MM reference

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|} \hline parameter & \(\delta z\) & \(\delta y\) & \(\delta z\) & \(\delta\psi_{x}\) & \(\delta\psi_{y}\) & \(\delta\psi_{z}\) & \(\delta I\) \\ k = & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\ \hline \(\delta s_{L}\) & 0. & z/r & -\((z/r)\Delta z\) & \((y/r)\Delta z\) & \((z/r)\Delta z\) & 0. \\ \(\delta s_{T}\) & -y/R & x/R & 0. & \(-(x/R)\Delta z\) & \(-(y/R)\Delta z\) & \((z/R)\Delta z\) & 0. \\ \(\delta I\) & 0. & \(F_{I}\) & 0. & \(-F_{I}\Delta z\) & 0. & \(F_{I}\Delta z\) & 1. \\ \hline \end{tabular}
\end{table}
Table 2: _The coefficients \(a_{k}^{l}\) for a projective geometry. All the coordinates x,y,z,r,\(\Delta x\)... refer to the intersection with the reference chamber. \(R\) and \(r\) are the distances to the origin in the (y,z) plane and in space respectively._chamber will also be randomly displaced which will induce the displacement of the whole tower. Then straight tracks coming from the _pp_ vertex are generated. From their simulated measured positions on the chambers, the sagitta correction is derived from equation 11. In the following, the misalignment parameters are supposed to be independent random parameters, uniformly distributed in a 2x7 dimensions phase space (3 translation, 3 rotation and 1 dilation parameters) per chamber. For each alignment event, corresponding to one point in this space, 100 tracks are generated which cross uniformly the chamber areas. The quality factor of the alignment scheme is given by the RMS or the gaussian width \(\sigma_{e.s.}\) of the corrected sagittas distribution.

The tower geometry of this simulation is given in Fig. 12. In the following results, the distribution of corrected sagittas are integrated over the 6 towers which cover the barrel pseudo-rapidity range [0..,1.2]. These results are given for the RASNIK option (with or without the use of the image size) which assumes that a light ray is defined by the center of the mask on chamber MI and the center of the lens on chamber MM. The apparent sagitta is derived from the image position measured with the CCD on chamber MO. Almost identical results are obtained when the rays are assumed to be laser beams positioned independently from the displaced chambers. Actually, the simulation reproduces the fact that the laser beams are positioned by adjusting their spots on the Si sensors of chambers MI and MO (with limited precision of the order of 1 mm) before the random displacements of the chambers.

Figure 12: _The projective geometry of a barrel chamber tower used in the simulation._

[MISSING_PAGE_FAIL:21]

Then one obtains \(\sigma_{e.s.}=18\mu m\). The result of the alignment procedure is shown on Fig. 13 (right column).
* _Account for the limited accuracy of the sensors._ With \(\sigma_{sz}=20\mu m\), \(\sigma_{sz}=200\mu m\) and the same input misalignment assumptions as above, one obtains \(\sigma_{e.s.}=22\mu m\). Fig. 14 shows the dependence of \(\sigma_{e.s.}\) with the sensor accuracy in the non-bending plane both for the perfect and non perfect projective geometry. When all the imperfections are taken into account, the requirement for this accuracy (and therefore on its positioning) is rather weak, as figures as loose as \(\sigma_{sz}=0.5\ mm\) are still acceptable.

The use of 3D RASNIK systems instead of 2D systems does not afford a significant improvement on the correction procedure accuracy. Although 3D systems add some redundancy, the image size and transverse sagitta bring correlated informations. Therefore the correction accuracies with RASNIK systems and laser/strip based systems are similar for the projective scheme.

The value of the correction depends on the track position inside the tower. For example, a rotation of a chamber around its z axis leads to a sagitta correction proportionnal to the distance x'between the crossing point of the track with the chamber and the z axis. As a consequence, the finite resolution on the track position in the transverse plane introduces an error on the correction. This effect is shown on Fig. 4.

## Appendix E Effect of chamber deformations

In principle, the in-plane alignment system takes care of the simple chamber deformations which lead to a departure from the perfectly planar body. Given the accuracy of the corresponding sensors (better than \(10\mu m\) plus the positioning error), this correction translates in our model into an error on the positioning of the sensors along the y axis which has been ignored so far. At high rapidity in the barrel, this y-error leads to effects on the measured sagitta of the same order of magnitude as the error along z. Averaged over the barrel, the contribution from the y-errors is a factor \(\sim 2.5\) less important than the contribution from the z-errors. Given the fact that such contributions are not dominant in the projective scheme, it was legitimate to ignore the contribution from the errors along y.

In addition to the corrections provided by the in-plane alignment procedure, the projective model can be updated to deal with simple departures from the perfectly planar rigid body assumption, some of them being ignored by the in-plane system. Mathematically, in the case of the projective alignment, only the relative differences of the parameters describing the deformations of each chamber have an impact on the observed sagitta, so that each new effect can be described by adding only one free parameter to the model. With 4 light rays, only one such additional effect can be incorporated in order to keep an overconstrained system (7 free parameters and 8 measured sagittas). The addition of the third dimension provided by the 3D RASNIK system helps by overconstraining the problem. Examples of such effects are the following:

* _Different expansion factors along the x and z axis._ The in-plane alignment system based on 4 straightness monitors (Fig. 2), is not sensitive to this effect. The simulation shows that additional dilation factors along Figure 13: _Results of the simulation of the projective scheme in the barrel. The top figure shows the input distribution of fake sagittas for straight tracks. The sagitta distribution after the correction is shown in the middle figure. The bottom lego-plot gives the dependence of the average corrected sagitta (in \(\mu\)m) with the location of the track on the reference layer. The left column corresponds to a perfect projective geometry. The right column refers to the realistic situation which takes into account the imperfect knowledge of the tower position and orientation and the vertex spread._

Figure 14: _The dependence of the corrected sagitta with the sensor accuracy in the non-bending plane. The dashed curve corresponds to a perfect projective geometry. The solid line refers to the realistic situation which takes into account the imperfect knowledge of the tower position and orientation and the vertex spread. The precision along the beam direction is \(\sigma_{z}=5\mu m\)._

the transverse x axis as large as \(210^{-3}\) (i.e. 1.2 cm over 6 m!) can be corrected for without any loss of accuracy on the sagitta correction compared to the standard scheme discussed in the previous sections. The use of 3D RASNIK leads to an slight improvement of the correction ( \(\sigma_{cor.seq}=18\mu m\) instead of \(20\mu m\)).
* _Chamber torsion (twist around the z axis)._ It can be described by one additional parameter which is the angle \(\psi_{t}\) of the z edge with respect to the line at x=0 (Fig. 15). With the same assumptions as in line 6 of table 3, one gets the same result for the RMS of the corrected sagitta distribution for a range of torsion angle \(\psi_{t}\) equal to \(\pm 2.5mrad\).
* _The gravitational sag in the non-bending plane._ In a simple model which assumes the chamber deformation to be well described by a parabola, this effect can be incorporated by adding one free parameter, e.g. the sagitta at x=0. The sag being in the transverse plane, it is of course necessary to add at least one ray in the non-bending plane. The simulations have been worked out with 6 light rays (2 in the non-bending plane), showing that the accuracy on the corrected sagitta remains at the same level as the one obtained without the sag effect and with 4 rays. The gravitational sag effect in the bending plane, although expected to be of less importance due to the smaller size of the chambers in this direction, are corrected in the scheme with \(N_{R}=6\) rays and 1D sensors (see Fig. 2 and GEM paper).

## Appendix F The non projective scheme

The projective scheme has shown weaknesses linked to the fact that perfect projectivity cannot be achieved in practice. In addition, it cannot be applied in the end cap with the present design of the end cap cryostat. At the expense of using more light beams and making full use of the 3D RASNIK system, it is possible to fully reconstruct the

Figure 15: _The model of chamber torsion used in the calculation and the simulation. The torsion angle varies linearly with z._

position of 2 layers (e.g. MI and MO) with respect to a reference layer (e.g. MM). In general, there are 14 free parameters (including homogenous thermal expansions) to describe these relative positions. In principle, 6 rays provide 18 constraints with the 3D RASNIK system (6 longitudinal and 6 transverse sagittas, 6 image sizes) and should be appropriate to solve the problem. In this case, sagittas and image sizes can be calculated completely (not a first order approximation) for a given set of values of the 14 free parameters. These parameters are then derived from a \(\chi^{2}\) minimization by comparing the measured fake sagittas and image sizes with the theoretical ones. A simulation of this procedure has been worked out for both the barrel and the end cap chambers.

In the barrel, the same projective geometry of the chambers has been used, but the 6 rays now avoid the projective arrangement. In the simulation of the correction procedure, the arrangement shown in Fig. 9 has been chosen.

In this simulation, the precisions of the optical sensors are \(20\mu m\) in the longitudinal direction, \(100\mu m\) in the transverse direction and \(0.5\mu m\) on the image size measurement (assuming \(\frac{1}{4}\) inch CCDs). The displacement parameters are randomly distributed between \(\pm 1\)\(cm\) in translation, \(\pm 4mrad\) in rotation and \(\pm 2.10^{-4}\) in dilation. The RMS of the resulting distribution of uncorrected sagittas is 0.45 cm when averaged over the rapidity range of the barrel. After the correction procedure, the RMS of the corrected sagittas distribution is \(10\mu m\) almost independent of the tower position.

It should be underlined that this result remains true even when the vertex spread is taken into account or when the misalignment ranges are increased by a factor 2. Therefore this scheme appear to be an attractive alternative to the projective scheme although it requires a priori more light rays and sensors. Given the presence of the toroid struts, the proposed arrangement may not be applicable with the present projective geometry of the towers. As an alternative, such a scheme could be applied to triplets of chambers which are not projective (e.g. with the same segmentation in \(z\) in all 3 layers). In addition to radial light rays, this scheme would require 2 axial light rays per layer and 2 proximity sensors between 2 adjacent chambers to control precisely the relative movements of the different chambers inside a given layer.

In the end cap, the arrangement of the light rays is shown in Fig. 1 and Fig. 7. In this case, the whole layer, although it physically consists of several chambers, has to be considered as a single planar and rigid body. The ranges of misalignments in the simulation are the same as above. The results are given in term of the RMS of the sagittas distribution after correction for a sample of infinite momentum tracks uniformly spread over the MO layer. These results are given in table 4 for different assumptions on the sensor precisions and the number of light rays.

It shows that the additional constraints provided by the use of 8 rays instead of 6 (rays number 1 to 6 in Fig. 7) lead to a significant improvement of the correction. The simulation shows that this procedure rests heavily on the precision on image size reconstruction as illustrated by the degradation which occurs when this precision is worsened by a factor 2. So far the simulation has assumed that this resolution does not degrade when the planes containing the mask and the CCDs are no longer conjugate with respect to the lens. Actually, when the CCD plane is displaced by e.g.

10 mm along the lens axis, a degradation by a factor \(\sim\) 2 is expected, which depends on the exact opening of the lens. A more complete simulation, including this effect, will certainly show a degradation of the sagitta correction, but at a still acceptable level.

Fig. 16 shows the distributions of uncorrected and corrected sagittas averaged over the whole end cap region. For this figure, rather large initial misalignments have been assumed: The half widths of the flat distributions are 1cm (translations MI w.r.t. MM), 2cm (translations MO w.r.t. MM), 1cm (translations of the tower w.r.t. pp vertex), 0.5 mrad (rotations MI and MO w.r.t. MM), 0.4 mrad (rotations of the tower w.r.t. the absolute frame) and \(2.10^{-4}\) for the dilations of MI and MO. The sensor precisions are 10/100/0.5\(\mu m\).

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline Number of rays & Sensors resolution (\(\mu m\)) & Vertex spread in z & RMS(corrected sagitta) \\  & \(\sigma_{s}/\sigma_{R\theta}/\sigma(imagsize)\) & \(\sigma_{s}\) (cm) & (\(\mu m\)) \\ \hline
6 & 20 / 100 / 0.5 & 5.5 & 31. \\
8 & 20 / 100 / 0.5 & 5.5 & 20. \\
8 & 20 / 100 / 1 & 5.5 & 29. \\
8 & 20 / 100 / 0.5 & 0. & 19. \\
8 & 5 / 50 / 0.5 & 5.5 & 15. \\ \hline \end{tabular}
\end{table}
Table 4: _RMS of the distribution of the corrected sagittas for the end cap chambers. The RMS of the initial distribution of uncorrected sagittas is 0.45 cm._Figure 16: _Results of the non projective scheme in the end cap region. The top figure shows the input distribution of fake sagittas for straight tracks. The sagitta distribution after the correction is shown in the middle figure. The bottom lego-plot gives the dependence of the average corrected sagitta with the location of the track on the reference chamber._