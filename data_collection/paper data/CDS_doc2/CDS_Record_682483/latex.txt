**ATLAS Internal Note**

**PHYS-NO-100**

**12 March 1997**

**Comparison between full simulation**

**and fast simulation of ATLAS detector**

**Donatella Cavalli and Silvia Resconi**

Physics Department, Milano University and INFN

I-20133 Milano, via Celoria 16, Italy

## Abstract

This note documents the comparison done between full simulation and fast simulation of ATLAS detector for complete physics events with Higgs bosons production. The full simulation and reconstruction is performed with the _official_ program chain SLUG-DICE-ATRECON, the fast simulation is performed with the package ATLFAST [1].

Events with production of supersymmetric A/H boson in the \(\tau\tau\) decay channel and events with production of h boson in the \(b\overline{b}\) decay channel have been studied.

Good agreement between the two simulations is found in the jets reconstruction, kinematic cuts acceptance, \(p_{T}^{miss\,s}\) reconstruction and resolution and Higgs mass reconstruction.

Introduction

Large samples of full simulated events were produced for the preparation of the ATLAS Technical Propos al (TP) [2] and the ATLAS Calorimeter Performance Technical Design Report (TDR) [3], with the aim of studying in a realistic way the performances of the ATLAS detector in the reconstruction of quantities used in the physics events analysis.

However full simulation is largely time consuming, so a fast simulation of the detector is very useful.

Fast simulation takes into account the detector effects in a parametric way (generated particles quantities are reconstructed and then smeared according to the expected experimental resolutions and electrons, jets and missing transverse momentum are then reconstructed) so it is really _fast_ and it can be used to produce a large events statistics.

In any case full simulation is always needed to study effects due to noise, calibration and intercalibration of calorimeters, detailed showers development (used for example in \(\tau\)-identification criteria), pile-up, cracks, and to provide parametrisation for fast simulation.

This note contains a first section that briefly describes and compares the algorithms used for the reconstruction of physical quantities in full simulation and in ATLFAST. It is then divided in two parts, one dedicated to the A/H\(\rightarrow\tau\tau\) channel, the other one dedicated to the h\(\rightarrow\)\(b\overline{b}\) channel: full simulation and ATLFAST events are compared in the case of low luminosity performance (\(10^{33}\) cm\({}^{-2}\)s\({}^{-1}\)).

Comparison of the algorithms used in full and fast simulation
* - Jets reconstruction. In ATLFAST a cone algorithm is used: the transverse energies of all undecayed particles, except neutrinos, muons and SUSY LSP, are summed up in calorimeter cells of granularity (0.1X0.1 for \(\left|\eta\right|<3\), 0.2X0.2 for \(3<\left|\eta\right|<5\)). All calorimeter cells with transverse energy greater than the chosen seed energy (1.5 GeV) are taken as possible initiators of clusters, in order of decreasing \(E_{T}\), to verify if the total \(E_{T}\) summed over all cells in a cone of a chosen radius (0.4) exceeds the minimum required threshold for a reconstructed cluster (10 GeV). The energy smearing is applied only after cluster identification (see [1] for more details) according to the expected experimental resolution. Only after that, clusters with transverse energy above threshold (15 GeV) are accepted as jets. In full simulation a cone algorithm is also used for the A/H\(\rightarrow\tau\tau\) events (st arting from the combined calorimeter matrix, where the energies of calorimeters towers with granularity 01X0.1 are stored) with a seed=1 GeV and a cone radius of 0.6. For the h\(\to b\overline{b}\) channel a sliding-window algorithm is used, that looks for local energy maxima in a 3X3 cell window, by scanning the whole combined calorimeter matrix. If a window contains a local maximum and its total energy is above a threshold of 2 GeV, then such 3X3 cell cluster is used to define a jet candidate. For each candidate kinematic variables are calculated using information from a 9X9 cell window with the same center as the selected cluster (for more details see [3] section 3.1.2).
* - Missing transverse momentum reconstruction. In ATLFAST the x and y components of \(p_{T}^{miss}\) are calculated from the transverse energies of identified isolated photons, electrons and muons (all smeared according to the expected experimental resolution), of all jets, of clusters not accepted as jets and of non-isolated muons not added to any jet cluster. Finally, the transverse energies deposited in cells not used for cluster reconstruction are also summed up (smeared with the same resolution function as for jets). In full simulation the x and y components of \(p_{T}^{miss}\) are calculated from the transverse energies deposited in the calorimeter cells calibrated using calibration constants different for each calorimeter and also different for cells contained in an electromagnetic cluster, in a hadronic cluster and outside clusters. The contribution of muons is taken into account using the generated muon energy smeared according to the experimental expectations.
* - Electronic noise. In ATLFAST electronic noise is taken into account in respective parametrisations for smearing functions. In full simulation an electronic noise with a \(\sigma\) parametrised as in [4] is added in calorimeters cells. Only those cells with energy \(>1.5\)\(\sigma_{noise}\) are considered; the requirement used in the optimisation of this cut is the minimisation of both the difference between the reconstructed jet energies and the deterioration of the \(p_{T}^{miss}\) resolution with and without the noise added [5].
* - magnetic field effect. In ATLFAST the effect of the solenoidal 2T magnetic field on the \(\phi\) position of charged particles with \(p_{T}>0.5\) GeV is parametrized and the contribution to the energy deposition from charged particles with \(p_{T}\) below this threshold is neglected. In full simulation charged particles are traced using a detailed magnetic field map.

## 3 A/H\(\rightarrow\tau\tau\) events

Signal events of the type:

\[pp\to A(H)+X\]

\[A(H)\rightarrow\tau^{+}\tau^{-}\]

\[\tau^{+}\to had\ \vec{\nu_{\tau}},\ \ \tau^{-}\rightarrow\mu^{-}\vec{\nu_{ \mu}}\nu_{\tau}\]

were generated with PYTHIA 5.7 and fully simulated for TP with DICE 2.02 in 1994; for details about the full simulation see [6].

The comparison between full simulation and ATLFAST has been done on two mass points: \(m_{\rm A}=150\ GeV\) and \(m_{\rm A}=200\ GeV\).

The statistics used for full simulation consists in the same samples of signal events used for TP (10800 and 5665 generated events respectively for \(m_{\rm A}=150\ GeV\) and \(m_{\rm A}=200\ GeV\)), while for fast simulation two new samples of 10000 and 4000 signal events respectively were generated with PYTHIA using the same data cards as used in full simulation.

It must be noted that the events fully simulated and fast simulated are here not exactly the same events; a comparison of the two simulations on the same generated event samples has been done only in section 3.4 using \(\sim 500\) events with \(m_{\rm A}=150\ GeV\) full simulated for TDR in the DICE95 framework.

In both cases events are simulated only if they pass the particle level filter cuts:

\(\bullet\ p_{T}{}^{\mu}\ >24\) GeV and \(|\eta|^{\mu}\ <2.5\);

\(\bullet\ E_{T}{}^{h\tau}\ >30\) GeV, \(|\eta|^{h\tau}\ <2.5\);

After these _filter cuts_ the statistics reduces to : 2170 full simulated events and 1905 fast simulated events for \(m_{\rm A}=150\ GeV\) (1855 and 1262 respectively for \(m_{\rm A}=200\ GeV\)).

### Comparison of quantities involved in kinematic cuts

In addition to the _filter cuts_ mentioned above, the kinematic cuts applied here are:

\(\bullet\ {\rm m}_{T}(\mu-p_{T}^{miss})\ <\ 25\ GeV\);

\(\bullet\ E_{T}{}^{jet}\ >40\) GeV, \(|\eta|^{jet}\ <2.5\);

\(\bullet\ 1.8<\ \Delta\phi^{jet-\mu}\ <2.8\) or \(3.5<\ \Delta\phi^{jet-\mu}\ <4.5\);

\(\bullet\ p_{T}^{miss}>18\) GeV;

\(\bullet\ {\rm m}_{\tau\tau}=m_{\rm A}\ \pm\Delta{\rm M}\), where \(\Delta{\rm M}=1.5\sigma\) of the reconstructed distribution \({\rm mass}\); in the particular cases under study \(\Delta\)M = 30 \(GeV\).

These are the standard kinematic cuts used for the \(A(H)\rightarrow\tau^{+}\tau^{-}\) analysis, whose results appeared in [2].

In Figs. 1 and 2 the main quantities involved in kinematic cuts from full and fast simulation are shown for \(m_{\rm A}=150\ GeV\). Mean values and RMS values of the distributions are in good agreement between the two simulations, except in the case of jet transverse momentum distribution which presents a higher mean value in the case of full simulation. This is due to the fact that in full simulation the reconstructed momenta of the jets are slightly overestimated for calibration problems and also because of the addition of the electronic noise ([6] and section 2 of this note); in ATLFAST jets were not recalibrated at all.

Fig. 3 and Fig. 4 show the comparison of the acceptances after kinematic cuts applied sequentially between full simulation and ATLFAST for the two mass points. The effects of each cut are in general comparable between the two kinds of simulation, only the cut on tranverse momentum of the jet is more effective in fast simulation for the reasons already mentioned. The final acceptances after all cuts are in agreement within \(2\sigma\).

### \(p_{T}^{miss}\) reconstruction and resolution

In Fig. 5 the \(p_{x}^{miss}\), \(p_{y}^{miss}\) resolution from full simulation and ATLFAST is shown. The resolution on each \(p_{T}^{miss}\)component is computed as difference between \(p_{x}^{miss}\)or \(p_{y}^{miss}\)calculated at particle level without \(\eta\) cut and \(p_{x}^{miss}\)or \(p_{y}^{miss}\)calculated from calorimeter energies with a coverage \(|\eta|<5\) in the detector simulations.

The reconstructed \(p_{T}^{miss}\)distribution are very similar in full simulation and ATLFAST (see Fig. 1 and 2); the values for \(p_{x}^{miss}\), \(p_{y}^{miss}\)resolution, obtained from a gaussian fit of the distributions of Fig. 5, are quite compatible (7 GeV and 6.2 GeV respectively).

As expected, the resolution from ATLFAST is slightly better: this is due to the fact that in full simulation the effect of electronic noise is more realistically taken into account (see section 2), that gives a contribution of \(\sim 3\) GeV to the \(p_{T}^{miss}\)resolution, and moreover in full simulation problems of intercalibrations between calorimeters [5] may be present which of course do not affect fast simulation.

Note that the \(p_{T}^{miss}\)resolution given by ATLFAST comes out from the parametrisation of the calorimeters performance for jets, leptons etc. according to the calorimeter expected experimental resolutions, so our results demonstrate that the \(p_{T}^{miss}\)resolution from the full simulated data is near to the value expected on the basis of the calorimeter requirements.

### A/H mass reconstruction

The invariant mass of the \(\tau\)-pair can then be reconstructed as:

\[m_{\tau\tau}\ =\ 2(E_{1}+E_{\nu_{1}})(E_{2}+E_{\nu_{2}})(1-cos\theta),\]

where \(\theta\) is the angle between the directions of the measured \(\tau\)-decay products.

If \(E_{1}\), \(E_{2}\) are the energies and \(\overline{u_{1}}\), \(\overline{u_{2}}\) the directions of the measured \(\tau\)-decay products (muons or jets), and if \(p_{x}^{miss}\), \(p_{y}^{miss}\) are the projections onto the x, y axes of the measured \(p_{T}^{miss}\), then the energies \(E_{\nu_{1}}\) and \(E_{\nu_{2}}\) of the two neutrino systems from \(\tau\)-decay can be obtained by resolving the system:

\[p_{x}^{miss}(p_{y}^{miss})=(E_{\nu_{1}}*\overline{u_{1}})_{x,(y)}+(E_{\nu_{2}}* \overline{u_{2}})_{x,(y)}.\]

The measurement accuracy of \(p_{x}^{miss}\) and \(p_{y}^{miss}\) and the assumptions used (decay products have same direction as \(\tau\) parents) result in many cases in unphysical negative solutions for \(E_{\nu_{1}}\) and \(E_{\nu_{2}}\), for which the A-mass cannot be reconstructed.

Fig. 6 and Fig. 7 show the different effects contributing to the width of the reconstructed \(m_{\tau\tau}\) for \(m_{A}\)=150 GeV in full simulation and ATLFAST respectively. In each figure (all the simulated events are here used without any cut) the first plot is the distribution of the \(m_{A}\) as generated by PYTHIA, the second plot gives the \(m_{\tau\tau}\) reconstructed using in the above expression the quantities at particle level (here the \(p_{T}^{miss}\)components are calculated without \(\eta\) cut), the third plot is obtained in the same way of plot 2 using a cut \(|\eta|<5\) for the \(p_{T}^{miss}\)calculation, in the fourth plot the \(p_{x}^{miss}\) and \(p_{y}^{miss}\) obtained from the simulation are used, finally in the fifth plot the reconstructed quantities also for the \(\tau\)-jet are used.

The first three steps are purely at particle level, so they must be very similar for the two simulations, good agreement between full and fast simulation is found also in the two last steps in the reconstructed mass widths and also in the fraction of events lost when the mass system is not solved (in that case the mass value is set negative, so this fraction is calculated as the _underflows_ over the _entries_ of each plot). The reconstructed mass widths and the fraction of lost events at each step are shown in Tab. 1 for \(m_{A}=150\ GeV\).

Fig. 8 and Fig. 9 give the reconstructed masses in full and fast simulation after the cuts on the transverse momentum of \(\tau\)-jets and the cut on \(\Delta\phi^{jet-\mu}\) reported in section 3.1 (with these cuts tails are reduced and the best mass resolution is obtained [6]). The widths of the reconstructed mass are in good agreement even if the distribution of the reconstructed mass from fast simulation seems slightly worse. If the effect is real, it is not understood because the \(p_{T}^{miss}\)resolution is slightly better in fast simulation and the \(\tau\)-jet energy seems also better reconstructed in ATLFAST than in full simulation (the energy of \(\tau\)-jet is reconstructed in the same way as the energy of all other jets, so, due to the large electromagnetic component in the \(\tau\)-jet, its energy is overestimated of \(\sim 5\%\)), as it can be seen in Fig. 10, where the ratio \(p_{T}^{rec\ \tau-jet}/p_{T}^{h\tau}\) is plotted for the two simulations.

### Transverse energy in calorimeters

The total transverse energy \(\Sigma E_{T}\) measured in the calorimeters is an interesting quantity because the \(p_{x}^{miss}\), \(p_{y}^{miss}\) resolution in ATLAS has been parametrised as a function of it. This resolution is well described by the simple formula \(0.46\times\sqrt{\Sigma E_{T}}\) at a luminosity of \(10^{33}\) cm\({}^{-2}\)s\({}^{-1}\)[6].

In full simulation \(\Sigma E_{T}\) is calculated summing up the energies of all calorimeter cells calibrated as said in section 2, in ATLFAST it is calculated from the transverse energies of all particles seen in the calorimeters, that is all particles said in section 2, except muons.

The comparison of the \(\Sigma E_{T}\) reconstructed in calorimeters has been done on a reduced event sample (500 events with \(m_{A}=150\) GeV); the same events generated by PYTHIA have been simulated using DICE 96-11 (TDR version) and ATLFAST.

Fig. 11 shows the distribution of this quantity for the two simulations and also the distribution done at pure particle level. The average value of the distribution is \(\sim 8\%\) lower in ATLFAST: a possible explanation is the loss of low energy particles due to the magnetic field effect (see section 2); in full simulation this loss is recuperated with the calibration factors. A difference of \(\sim 5\%\) is also found in the sum of the transverse reconstructed jets energy (\(p_{Tjet}>\)15 GeV, \(|\eta|<3\)), whose distribution for the two simulations is also shown in Fig. 11.

## 4 \(h\to b\bar{b}\) events

The decay channel \(H\to b\bar{b}\) may be the best way to probe the region 80-100 GeV for the standard Higgs search [7], and also the \(h\to b\bar{b}\) decay channel for the light Higgs boson is very interesting in the framework of SUSY models.

In fact for the SUGRA points 1,2 and 5 studied for the SUSY LHC workshop [8], the \(\chi^{2}_{0}\) neutralino decays to \(\chi^{1}_{0}\) neutralino, followed by \(h\to b\bar{b}\) with a branching ratio of 80%. The observation of the \(h\to b\bar{b}\) peak could be a signature for SUSY \(\chi^{2}_{0}\) decays and the reconstruction of \(m_{b\bar{b}}\) is crucial to reduce the SM background and also to suppress events from other SUSY channels.

The mass resolution given by ATLFAST has been checked in full simulation.

Two samples of 300 events each (GENZ generated) of \(h\to b\bar{b}\), selected to have respectively:

\(\bullet\)\(p_{T}^{b,\bar{b}}>\) 15 GeV, \(|\eta|^{b,\bar{b}}<\) 0.3 (sample 1)

\(\bullet\)\(p_{T}^{b,\bar{b}}>\) 15 GeV, \(|\eta|^{b,\bar{b}}<\) 2.5 (sample 2)

(initial state radiation-ISR-, final state radiation-FSR- and hadronisation-HD- are included in the generation) have been used as input both for ATLFAST and full simulation chain (DICE \(96-5\)).

In this case the two simulations can be compared on event-by-event bases.

### Analysis of events

Full simulated events were reconstructed using ATRECON \(96-6\). The sliding window algorithm gives sometimes jets duplication: a simple algorithm to discard duplicated jets has been implemented here, based on the comparison of energy and position of the reconstructed jets (a more refined method to avoid duplication is described in [3] section 3.1.2). No special calibration for jets, no electronic noise in calorimeters is added here.

Fig. 12 and Fig. 13 compare the jets reconstruction in full simulation and ATLFAST for sample 2. Only jets with \(p_{T}>15\) GeV are considered in the two simulations: the agreement between the numbers of reconstructed jets is good.

The calibration for jets was not yet tuned in full simulation in DICE95 at the time of this work, but that is not crucial for the h mass reconstruction because, as it will be seen in the following, a recalibration is in any case requested to bring the h mass peak to the expected position.

A reconstructed jet is considered associated to a b quark from h decay if \(\Delta R<0.2\) from a b quark with \(p_{T}>5\) GeV after FSR. The efficiency for the reconstruction of both b's from h is \(\sim 73\%\) (\(\sim 67\%\)) and \(\sim 67\%\) (\(\sim 60\%\)) for full simulation and ATLFAST respectively for sample 1 (sample 2). The corresponding efficiencies for the reconstruction of a single b are shown in Tab. 2.

Comparing one to one the full simulated and ATLFAST events, it is found that in the \(80-85\%\) of events the reconstructed number of jets associated to b's from h is the same; in both the simulations the b-jet reconstruction efficiency is slightly lower for b-jets with \(p_{T}<50\)\(GeV\)

### h mass reconstruction

In Fig. 14, Fig. 15 and Fig. 16, Fig. 17 the reconstructed invariant masses of the two b-jets (when two b-jets are reconstructed with \(p_{T}>15\) GeV) are shown. In plot (a), a large shift in the peak position of the reconstructed mass \(m_{bb}\) of the two b-jets is observed: this is due to FSR and HD, that are responsible of the degradation of the mass resolution and asymmetric tails. The data could be corrected for the mass shift by calibrating the b-jets scale (see [3] section 4.2). Here the peak position has been calibrated with the same procedure described in [1]: the jet momenta are recalibrated by a correction factor \(K_{jet}=p_{T}^{parton}/p_{T}^{jet}\), where \(p_{T}^{parton}\) is the transverse momentum of the parton which initiated the jet (before FSR). Plot (b) shows this correction factor as a function of \(p_{T}^{jet}\). Applying this correction factor to \(p_{T}^{jet}\) plot (c) is obtained.

Tab. 2 gives a comparison between the b-jets reconstruction efficiency and energy, the values for reconstructed mass peak position without and with correction and the acceptance for events inside \(\pm\) 20 \(GeV\) mass bin for full and fast simulations for the two event samples.

A comparison between ATLFAST and full simulation has been performed in the same way described above also for 300 events with production of \(h\to u\,\overline{u}\,\) in \(|\eta|<0.3\). The reconstructed mass corrected has a width of 11.05 GeV in full simulation to be compared with a width of \(\sim 10\) GeV in ATLFAST.

## 5 Conclusions

The conclusion of the present study is that the agreement between full and fast simulation is good.

The two simulations can be used in a complementary way to study physics channels: full simulation has to be used to check in detail the detector performances (and to provide parametrisation for fast simulation); fast simulation can be used as cross-check for full simulation reconstruction code and the algorithms used there and also to produce large statistics samples of events for the physics analysis.

## Acknowledgements

We thank Elzbieta Richter-Was for helping us in using the ATLFAST program and for many useful discussions and comments.

## References

* ATLAS Internal Note PHYS-079 (1996)

* ATLAS Internal Note LARG-035 (1996)
* ATLAS Internal Note PHYS-080 (1996)
* ATLAS Internal Note PHYS-051 (1994)
* ATLAS Internal Note PHYS-043 (1994)
* LHCC SUSY workshop
- CERN 30.10.96