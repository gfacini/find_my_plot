ATLAS Level 1 Calorimeter Trigger

**February 14, 2000**

**Simulation of the backplane for Common Merger Module**

M. K. Jayananda\({}^{*}\)

School of Physics and Astronomy, University of Birmingham, United Kingdom.

1. Introduction

According to the architecture described in the first level trigger TDR [1], identification and counting of the number of electron/photon clusters and isolated hadron clusters is to be carried out by the Cluster Merger Modules (CMMs) using the sub-sums provided by the Cluster Processing Modules (CPM). Similarly, the number of jets is to be counted by the Jet Merger Modules (JMMs) using the sub-sums provided by Jet/Energy Modules (JEMs).

Figure 1: **Configuration of the backplane in the common architecture. Each colour represents a single layer and each line represents 24 bits. Connections to the merger module at the left end, which is a mirror image of the connections to the right end module, are not shown. In the case of JEM modules, the merger module at the left hand end would be a Sum Merger Module (SMM).**

According to this design, the three-bit counts generated by each of the CPMs are sent via 40 MHz parallel cable links to the CMMs in a separate crate. However, the three-bit counts generated by JEMs are sent via a 40MHz parallel crate backplane to a JMM in each of the four JEM crates. Three of the JMMs send merged data into the fourth JMM via 40MHz parallel cable links for final summation. It was later proposed [2] to adapt the architecture of the JMMs for the CMMs as well, eliminating a large number of cable connections from CPMs to CMMs. In addition, this would enable the designing of a single backplane architecture and single common merger module called Hit Counting Module (HCM) to replace JMM and CMM. As shown in figure 1.1, there will be two merger modules, one at each end of the crate. Using a backplane with four signal layers each of the cluster processor or jet/energy modules will be able to send data to the two merger modules. One of the major concerns expressed regarding this new architecture was the feasibility of sending single-ended 40 MHz (or possibly 80 MHz) data across up to 16 slots in a 9U crate. Therefore it was decided to carry out the simulation described below.

## 2 Backplane Architecture and Crosstalk

As mentioned above, it is envisaged to implement the backplane using four signal layers. The best suited geometry for this application is a strip-line architecture. As shown in figure 2.1, a strip-line consists of copper strips centered in a dielectric medium between two conducting planes.

In situations where signal rise time is much smaller than propagation delay, signal paths in a printed circuit board should be treated as transmission lines. Therefore attention should be paid to issues of line termination. The lines in the backplane are expected to be series-terminated at the transmitter end and to be left un-terminated at the receiver end, as shown in figure 2.2. The drivers to be used (Texas Instruments ALVC162721) contain internal series resistors at their outputs. Line impedance can be designed to match the total output impedance of the drivers, eliminating the need for any external resistors. Figure 2.3 shows the waveforms at the transmitter and the receiver when a pulse is propagating along the line. Because the line impedance and the output impedance of the transmitter act as a voltage divider, the amplitude of the pulse travelling in the forward direction is only half the original value. As the receiver end is high impedance, the pulse is reflected with the same sign. The original pulse and its reflection combine at the receiver end

Figure 2.1: A strip-line (copper tracks centered in a dielectric medium between two conducting plates).

creating a pulse with full amplitude. However, when the reflection arrives back at the transmitter end, it is delayed by twice the propagation delay (2t\({}_{d}\)). Therefore the overlap between the original and reflected pulses at the transmitter end is limited to a time t\({}_{w}\)-2t\({}_{d}\) (assuming t\({}_{w}\)\(>\)2t\({}_{d}\)).

In this configuration, undistorted full amplitude pulses are only available at the receiver end. But it does not cause any problems because the signal transmission is from point to point. A termination at receiver end is not acceptable because that reduces the amplitude at the receiver by half.

One of the major problems in high density backplanes is crosstalk [3, 4]. Crosstalk in transmission lines is due to capacitive and inductive coupling among parallel lines, as shown in figure 2.4. When a pulse propagating from C to D is at any arbitrary point Y, the capacitive coupling produces currents I\({}_{C}\) that flow in the YXA and YXB directions. The current produced by inductive coupling I\({}_{L}\) is in the BA direction.

Figure 2.4: **Inductive and capacitive coupling between two adjacent lines. Crosstalk current in the forward direction is I\({}_{C}\) â€“ I\({}_{L}\) while the current in the backward direction is I\({}_{C}\) + I\({}_{L}\).**

Figure 2.3: **Waveforms in the line shown in figure 2.2. The propagation delay and the pulse width are denoted by t\({}_{d}\) and t\({}_{w}\) respectively.**

[MISSING_PAGE_FAIL:4]

Cadence version PE13 under SunOS 5.5.1 was used for the simulation. After creating the original design using SpecctraQuest, routing of the nets was performed by Allegro Expert. The simulation tool Signoise was invoked, mainly under SpecctraQuest and in some cases in batch mode (standalone version), for performing the crosstalk and reflection analysis.

Connectors used in the simulation were AMP Z-pack HM 2mm pitch connectors with 5+2 rows of 25 pin columns. The outer two rows were dedicated ground pins. Pin parasities provided by AMP were included in the simulation. The pins were driven by Texas Instruments SN74ALVCH162721, 3.3-V 20-bit flip-flop with 3-state outputs. The relevant IBIS model was obtained from Texas Instruments web site. Internal 25 \(\Omega\) series resistors are provided in the outputs of this chip.

In the simulation, the effective value of the output impedance was determined by simulating the waveforms in a line with a variable series resistor at the transmitting end. The value of the resistor was varied until the reflected signal seen at the receiver end was minimized. The matching impedance was found to be 36.6 \(\Omega\). The track final impedance was made as close as possible to this value by the track width.

The layer structure used in the simulation is shown in figure 3.2 and table 3.1. The tracks used for the simulation were in the middle conductor layer. Suitable values for layer thickness were selected from a backplane manufacturer's table. As shown in figure 3.3, track separation varied from point to point and was between 1.4 mm and 2.0 mm.

Figure 3.1: The back plane design used for the simulation. Seven traces starting from the leftmost connector run through many other connectors to the rightmost connectors. Connectors which are not neighbours to the tracks were not drawn.

Figure 3.2: Structure of the board used for the simulation.

\begin{table}
\begin{tabular}{p{56.9pt}|p{56.9pt}|p{56.9pt}|p{56.9pt}|p{56.9pt}|p{56.9pt}} \hline Type & Material & Dielectric Constant & Thickness (mm) & Line width (mm) & Impedance (ohm) \\ \hline surface & air & 1.000000 & 0.0000 & - & - \\ \hline conductor & plated copper foil & - & 0.05334 & 0.150 & 73.526 \\ \hline dielectric & FR-4 & 4.500000 & 0.1475 & - & - \\ \hline plane & copper & - & 0.0350 & - & - \\ \hline dielectric & FR-4 & 4.500000 & 0.1475 & - & - \\ \hline conductor & copper & - & 0.0350 & 0.188 & 36.734 \\ \hline dielectric & FR-4 & 4.500000 & 0.1475 & - & - \\ \hline plane & copper & - & 0.0350 & - & - \\ \hline dielectric & FR-4 & 4.500000 & 0.1475 & - & - \\ \hline conductor & plated copper foil & - & 0.05334 & 0.150 & 73.526 \\ \hline surface & air & 1.000000 & 0.0000 & - & - \\ \hline \end{tabular}
\end{table}
Table 3.1: Layer structure of the backplane used for the simulation.

Figure 3.3: A part of the backplane design enlarged. In the simulation, crosstalk seen by the middle track (victim net) due to the signals in the six neighbours (aggressor nets) was examined.

Figure 3.2: Structure of the board used for the simulation.

A close up of a part of the backplane is shown in figure 3.3. In the simulation described in this report, the middle track shown in figure 3.3 was treated as the victim and the other six tracks were aggressors. The signals applied to aggressors were either falling edges or square pulses. When falling edges were applied to aggressors the victim net was held low. When pulses were applied, the victim was held high. (It was not possible to hold it low in this case due to a limitation in Signoise). An equivalent circuit for a victim net with one aggressor is shown in figure 3.4.

## 4 Results

Figures 4.1 shows the results of reflection analysis performed by driving the victim net with a 40 MHz square wave. The waveforms agree with those shown in figure 2.3. The propagation delay is approximately 3 ns. The small glitch that starts just before 10 ns at receiver end D is a reflection at C due to a slight impedance mismatch.

Figure 4.1: Waveforms at the transmitting end (C) and receiving end (D) of the victim net when driven by 40 MHz square waves.

Figure 3.4: An equivalent circuit for a victim net with one aggressor net.

Figure 4.2 compares the waveforms at transmitter and receiver ends when the transmitter is driven by 40 MHz and 80 MHz signals. At 80 MHz the difference t\({}_{\rm w}\)-2t\({}_{\rm d}\) (see figure 2.3) becomes very small. The overlap between the original pulse and its reflection during this short period causes sharp spikes above 1.65 V at transmitter end C. The difference between the pulse repetition time (2t\({}_{\rm w}\) in this case) and width of the combination of original pulse at C and its reflection which has the same value t\({}_{\rm w}\)-2t\({}_{\rm d}\). This is the cause of sharp spikes below 1.65 V. The signals at receiver end D have no distortions at both frequencies.

Figure 4.3 shows the waveforms of the victim and one of its aggressors when falling edges were applied to all six aggressors simultaneously, keeping the victim low. The falling edge at C at t=0 appears as a drop from 3.3 V to 1.65 V because of the voltage division between the output impedance of the transmitter and the impedance of the line. The drop from 1.65 V to 0 V at \(\sim\)6 ns is due to its reflection at D. The combination of the original signal and its reflection at D appears as a falling edge from 3.3 V to 0 V.

Figure 4.2: Waveforms at the transmitting end (C) and receiving end (D) of the victim net when driven by 40 MHz square waves.

Backward crosstalk at A and forward crosstalk at B have complex waveforms. The reason for the sharp features was found to be the sharp bends of the traces (as seen in figure 2.3). A version of the backplane with straight tracks produced crosstalk pulses with similar amplitude but without the spikes (similar to those shown in next section).

Forward crosstalk seen at B was greater in both amplitude and duration than what is expected from the discussion in section 2 (figure 2.5). The reason for this will be explained in section 5(b). According to the result shown in figure 4.3, the amplitude of crosstalk seen by the receiver connected to the victim net is only about 0.0001% of the signal.

Crosstalk simulated by Signoise does not include the contribution from the large number of pins in other connectors through which the traces are routed (as seen in figures 2.1 and 2.3). However, because the pins are perpendicular to the tracks and because their radii are small, crosstalk from them is expected to be quite small.

Figure 4.3: Waveforms in the victim net and one of its neighbours when falling edges were applied on its all six aggressors simultaneously.

5. Additional Tests

Several additional tests were carried out, using a simple design consisting of two parallel tracks as shown in figure 5.1, to gain confidence in the simulation and for better understanding the above results.

The lower of the two tracks in figure 5.1 was chosen as the victim and the other as the aggressor. Line separation was 0.5 mm. The drivers and receivers used in this test were the same as the ones used in the main simulation.

**(a) Simple backplane with lines terminated at both ends**

In this case the transmitter end was series terminated in the same way as before. In addition the receiver end was terminated with a parallel resistor to ground, as shown in figure 5.2, for making it easy to understand the waveforms.

The waveforms in aggressor and victim, when a falling edge was applied to aggressor line, are shown in figure 5.3. Because the receiver end is terminated, there are no reflections in either of the lines. The input at C appears as a drop from 3.3V to 0V. However, due to the termination at D, signal at D is has halved.

Forward crosstalk at B is quite small. This must be due to near cancellation of capacitive and inductive crosstalk components. The duration of the backward crosstalk pulse is approximately twice the propagation delay plus rise time, in agreement with the discussion in section 2.

Figure 5.1: A simple configuration for understanding crosstalk.

Figure 5.2: Lines terminated at both ends.

### (b) Simple backplane with receiver end un-terminated

In this test, lines were left un-terminated at receiver ends, as shown in figure 5.4, making it similar to the main backplane simulation.

Figure 5.5 shows the waveforms in aggressor and victim when a falling edge was applied to the aggressor net. Waveforms at C and D are similar to those shown in figure 4.3 and can be understood the same way.

Figure 5.3: Crosstalk when receiver ends are terminated. The upper two plots show the signal in the aggressor and the lower two plots show crosstalk in the victim when line separation is 0.5 mm.

Crosstalk waveforms are quite different from case 5(a). In particular, forward crosstalk is much larger than that in figure 5.3. In fact, what is seen at B is not forward crosstalk, but backward crosstalk produced by the reflected signal at D travelling in direction DC in the aggressor. Duration of this pulse agrees with what is expected in the case of backward crosstalk.

Figure 5.4:

Figure 5.5: Crosstalk when receiver ends are un-terminated. The upper two plots show the signal in the aggressor and the lower two plots show crosstalk in the victim when line separation is 0.5mm

crosstalk. Its amplitude is approximately twice the backward crosstalk because it combines with its own reflection at B.

Backward crosstalk at A is a combination of three components. One is the same backward crosstalk seen in figure 5.3. The second component is the reflection of the crosstalk seen at A. Because backward crosstalk has a duration 2t4, the second component should arrive at the end of the first one. However they are slightly separated due to the degradation of the rise time of the second component during its own and its parent's transit along the line. The third component is the forward crosstalk from the reflected signal traveling in DC direction. This is very small and coincides with the beginning of the second component.

### (c) Comparison of simulation results with a calculation

A simple-minded calculation of crosstalk for the two line system shown in figure 5.1, when terminated at both ends as shown in figure 5.2, was made using the model shown in figure 5.6. Backward crosstalk in this model is given by

\[\frac{v_{t}}{v_{s}}\,=\,\frac{j\omega C-j\omega L/Z_{0}}{2+j\omega CZ_{0}}\]

where C and L are respectively total capacitance and total mutual inductance between the two lines. Capacitance per unit length and mutual inductance per unit length between two parallel lines in strip-line architecture (figure 2.1) are given [5] by

\[\frac{C}{l}=2.\,\,\,1\epsilon_{r}(K_{c2})^{2}\left(\frac{w}{d}\right)^{2}pF/m \,\,\,\,\text{and}\]

\[\frac{L}{l}=0.1\left(\frac{h}{d}\right)^{2}\mu H/m\]

where \(l\,\,\) is the length of the two lines, \(\varepsilon\), is the dielectric constant of the medium and \(K_{c2}\) is the fringing factor. \(K_{c2}\) depends approximately linearly on 2_h/w_ and the values are available in reference 5.

The magnitude of backward crosstalk generated by a falling edge similar to the one shown in figure 5.3 was calculated using this model. A comparison of these results with simulations as a function of track separation d is shown in figure 5.7. According to this comparison, the calculated crosstalk is slightly above the simulated value for track separations relevant for the current backplane (between 1.4 mm and 2.0 mm). But both methods indicate very small crosstalk.

Figure 5.6: A simple model for calculating crosstalk

## 6 Conclusions

From the results shown in figures 4.1 and 4.2, the backplane described in this report appears to be quite satisfactory at both 40MHz and 80 MHz. The level of crosstalk is very small as shown in figure 4.3.

The reason for small crosstalk level is mainly due to the strip-line architecture with very thin dielectric layers. Because the signal transmission is from point to point, signal distortion at any place other than the receiver end does not cause any problems. As understood by the tests described in section 5(a) and 5(b), forward crosstalk at the receiver end B is very small because of the cancellation of inductive and capacitive components. Total crosstalk at B is mainly due to the backward crosstalk generated by the reflected signal at D. Although forward crosstalk directly depends on the parallel length of the tracks, backward crosstalk does have a direct dependence on the length [4]. Therefore the length of the tracks carrying signal from almost from one end of the crate to the other end diagonally is not a cause for concern from a crosstalk point of view, as originally feared.

According to the comparison of calculated and simulated results shown in figure 5.7, simulated crosstalk at track separations greater than 0.5mm is much smaller than predicted by the calculation. The track separation in the backplane is expected to be between 1.5 mm and 2.0 mm. Although there is a discrepancy between them, both calculated and simulated results are very small at these distances.

Figure 5.7: A comparison of calculated and simulated backward crosstalk in case (a), as a function of line separation.

The discrepancy between the two results may be due to the distributed nature of capacitance and inductance between tracks, which is not taken into account in the calculation. The main contribution to the capacitance and inductance seen by a signal at a given point on a track should be mainly due to the sections of the other tracks closest to that point. Therefore, the actual coupling seen by a pulse travelling along a track at a given time should be much smaller than that expected based on the total values of L and C calculated in section 5(c). Therefore the calculated crosstalk shown in figure 5.7 can be considered as an overestimation. The reason for smaller crosstalk predicted by the calculation at track separations smaller than 0.5 mm may be due to the breakdown of the assumptions used for the expressions for L and C at very short distances.

7. Acknowledgements

Support from the Commonwealth Scholarships Commission, U.K., in the form of a Commonwealth fellowship, and the kind hospitality of University of Birmingham, U.K. and Rutherford Appleton Laboratory, U.K., during the period in which this work was carried out, is gratefully acknowledged.

8. References

1. ATLAS First Level Trigger Technical Design Report (1998).

2. Proposal for a Common Jet/Cluster Merger Module, C.N.P. Gee, M. K. Jayananda, U. Schafer, S. Silverstein (April 1999).

3. MECL System Design Handbook, William R. Blood Jr., _Motorola Semiconductor Products Inc._ (1972).

4. Controlling Crosstalk in High-Speed Digital Systems, Steve Kaufer, Electronic Systems, May 1999, p31.

5. Capacitance, Inductance and Crosstalk Analysis, Charles S. Walker, _Artech House, London_ (1990).