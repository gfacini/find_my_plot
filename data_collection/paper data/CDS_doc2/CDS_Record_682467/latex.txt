**ATLAS Internal Note**

**PHYS-No-086**

**6 June 1996**

**GEANT Hadronic Event Generators:**

**a comparison at the single interaction level**

A. Ferrari and P.R. Sala

INFN, Sezione di Milano, Via Celoria 16, 20133 Milano, ItalyIntroduction

Three hadronic packages are available in the current GEANT version [1] (GEANT 3.21). They give different results on hadronic resolutions and \(\frac{\epsilon}{\pi}\) non-compensation factors. Since ATLAS and many other experiments are making, or planning, big computational efforts in calorimetric simulations, an investigation about the origin of the differences appeared to be essential.

The GEANT program includes a common structure for particle transport, atomic interactions (\(\frac{dE}{dx}\), multiple Coulomb scattering etc.), geometry handling, electromagnetic showers, and so on. The three versions, named g-gheisha, g-fluka and g-calor, differ _only_ in the way hadronic nuclear interactions are modelled. It is then obvious that possible differences among the results of the three versions can only come from the different ways of simulating such elementary hadron-nucleus interactions. Therefore, the present note is an attempt to investigate the behaviour of the three packages _at the single interaction level_, switching off all transport and showering businesses.

## 2 Short description of the three GEANT packages

Details about the codes can be found in corresponding manuals or literature [2, 3, 4, 5, 6, 7, 8, 9]. A schematic description is useful in order to identify possible weak/strong points, and to understand the results.

### g-gheisha

Developed by H. Fesefeldt, and described in [2], gheisha is a non-microscopic code, that is, it does not try to simulate the physical processes that determine the hadron-nucleon or hadron-nucleus reaction dynamics, trying instead to reproduce directly the outcome of the reaction. It generates secondary particles from hadron-nucleus interactions so as to satisfy scaling laws, symmetry requirements, and to reproduce experimental inclusive distributions and calorimetric data.

### g-fluka

The hadronic interaction routines of the 1992 version of fluka (roughly corresponding to the models described in [7, 8]) have been implemented into geant. They use different models, depending on the energy of the primary particles. An improved version of the Dual Parton Model code described in [10, 11] is used for primary interactions above 5 GeV/c. A model based on resonance production and decay [14] is used for the same purposes at lower energies, down to 300 MeV for nucleons and 50 MeV for other particles. Reinteraction of secondaries produced in primary interactions are treated according to an intranuclear cascade, where reinteraction rates are parameterized, while nuclear effect s like Fermi motion, potential well and binding energies are properly taken into account. This approach is an extended and improved version of those described in [12, 13]. Evaporation and gamma deexcitation stages are included, which were missing in the original models. A generator for nucleon-induced interactions in the energy range 20-300 MeV, based on a detailed description of the intranuclear cascade, pre-equilibrium emission and evaporation [9] is also included.

### g-calor

The g-calor options activates the same routines of g-fluka for projectile energies larger than 10 GeV or anyway for incident projectiles other than pions and nucleons. Below this energy, and down to a threshold set at 2.5 GeV for pions or 3.5 GeV for nucleons, a hybrid treatment starts, in which a fraction \(\alpha\) of the interactions is performed as in g-fluka and a fraction \(1-\alpha\) is simulated by the so called _scaling model_, shortly described below. The value of \(\alpha\) varies linearly with energy, going from 0 at threshold to 1 at 10 GeV. Below the aforementioned threshold, the Bertini[3, 4, 5] IntraNuclear Cascade (INC) code is used.

#### 2.3.1 The scaling model

The scaling model has been initially developed for hetc[6]. It was aimed to extend the use of the Bertini INC to higher energies in applications where average quantities (average energy deposition, for instance) were required. In this model, if an interaction with a projectile energy \(E\) has to be simulated, a "parent" interaction is generated at the maximum allowable energy in the Bertini model (2.5 GeV for pions, 3.5 GeV for nucleons). An appropriate weight is then assigned to each secondary particle to "scale" the reaction to the actual energy \(E\). Particles must afterwards be scored according to their weight. This ensures energy conservation, and a reasonable behaviour of average quantities.

This procedure has been translated into g-calor with some additional recipe to get back an analogue code:

* each pion coming from the parent interaction is cloned into a number of pions equal to its scaling weight, each carrying the same sign, energy, and direction.
* each nucleon coming from the parent interaction is boosted, that is, its kinetic energy is multiplied by its scaling weight.

The procedure used for nucleons is inconsistent with that of pions and does not conserve inclusive spectra as obtained with the original scaling model.

## 3 Standalone FLUKA

The standalone version of fluka, 1996 status, has been included in the comparison, both to clarify again that g-fluka _is not fluka_, and to show that there is the possibility to work on the known problems/bugs of hadronic interaction codes, getting substantial improvements, although with a certain effort. Work on hadronic codes, expecially in the very complicated intermediate energy range, is being performed by many teams[21, 22, 23].

The fluka history and the program structure have been described in several publications and conferences during the last years [18, 9, 15, 7, 8, 16, 17, 19, 23, 20]. Development of the code is still in continuous progress, concerning both the user interface and the physical models. In the hadronic part, most of the efforts have been devoted to improve the behaviour in the intermediate energy range, where the old nucrin, despite many improvements in the kinematics and in the treatment of nuclear effects [8, 7], becomes increasingly inaccurate at energies lower than about 1 GeV. Therefore, in the last years it has been gradually substituted in fluka by the model called peanut. Presently, peanut handles interactions of nucleons, pions and \(\gamma\) rays with nuclei from about 2 GeV down to reaction threshold (or 20 MeV for neutrons). In the years following g-fluka release, the modelling of pion interactions, the effects of nuclear and Coulomb potentials (also on pions), Fermi break-up of light nuclei, nuclear fission, neutron halo in nuclear densities, quantal effects, anisotropy of particle emission following pion absorption, isobar model description of pion production, have been included [9, 16, 17, 23, 20, 24].

The present DPM based generator is now substantially different and improved with respect to previous fluka versions. Major changes include for instance the introduction of reggeon mediated interactions, a complete revision of the chain hadronization process and of diffractive events, use of smeared mass distribution for resonances[20].

Comparisons with experimental data have clearly shown that the resonance model which covered the few-GeV range, quickly becomes inaccurate for energies above 2-3 GeV, therefore it was felt preferable to stretch in a reasonable way the DPM model towards lower energies.

fluka contains, of course, a very detailed description of charged particle transport and of electromagnetic showers. The old interface with EGS4 has been completely replaced with a new code with extended performances which is able to treat accurately photon and electron interactions from few keV to several TeV. The improvements have concerned most of the physical models used[15, 20] and the whole charged particle tracking algorithm [18].

## 4 Method of the Comparison

Unique steering and scoring routines have been used for the three geant versions. The steering routine calls the event generators, performing a given number of single hadron-nucleon or hadron-nucleus reactions. Secondaries are extracted event by event from thegeant stack and scored. Different tests have been done, and many others can be made. We looked at energy-momentum conservation, azimuthal distributions, particle spectra, multiplicities, transverse momentum and Feynman \(x\) distributions, comparing with experimental data whenever possible. About 20000 interactions for each event generator have been performed for single-differential distributions, and about 100000 for double differential ones.

Whenever testing g-calor in the scaling energy range, the mixing of g-fluka + scaling has been removed, and all interactions have been performed within the scaling model, to better enlighten its characteristics.

Of course, g-calor has not been tested above 10 GeV, where it is the same as g-fluka.

### Energy balance

Since geant does not stack the residual nucleus after a hadron-nucleus interaction, some procedures have been devised to identify it and assign its energy and momentum, in order to check the global energy/momentum conservation:

* \(Z_{res}\)) of the residual nucleus are determined from the initial \(h+A\) system and from the stacked secondaries.
* The reaction Q value is determined from mass tables.
* The total momentum \(\vec{P}_{s}\) and total energy \(E_{s}\) of stacked secondaries are calculated.
* Now all the ingredients are defined, and we can assign to the residual nucleus either a

Figure 1: Mass and atomic number of the residual nucleus, derived as described in the text

[MISSING_PAGE_EMPTY:6]

## 5 Results

### Charge and Baryon number conservation

On light nuclei, even at low energies (2 GeV in fig. 1) g-gheisha can produce more protons/neutrons than available, and even nuclei with negative mass number. This does not happen with g-fluka and g-calor.

### Energy conservation

Energy-momentum conservation has been tested for the three packages with 2 GeV/c \(\pi^{-}\) on Carbon, and for g-gheisha and g-fluka with 200 GeV/c protons on Xenon.

Figure 3:As can be easily seen from figs. 2 and 5 g-gheisha fails badly in the conservation. The missing energy after momentum balance goes up to 3 GeV in the 2 GeV/c interactions, and can exceed 30 GeV, with an rms of 4.7 GeV, in the interactions at 200 GeV/c. The missing momentum after energy balance at 200 GeV/c incident energy can exceed 50 GeV/c, with an 11 GeV/c r.m.s. (the negative values in the \(E_{res}\) and \(P_{res}\) histograms correspond to residual nuclei below mass). The non conservation of energy and momentum in gheisha was already known to the authors1.

Footnote 1: from [2], sec. 2.6.17: “Various effects...are responsible for that nonconservation of total energy and momentum”.

g-calor exhibits a small non-conservation (fig 3), probably due to the fact that in the Bertini INC, a constant binding energy of 8 MeV/nucleon is assumed throughout all the periodic table, leading to wrong Q-values.

The conservations in g-fluka are within the rounding errors (figs. 4,6): a single

Figure 4:

precision rounding error of \(10^{-6}\) on a 300 GeV total energy makes an error of \(3\cdot 10^{-4}\) GeV on energy, that becomes \(0.250\) GeV /c in momentum for an A=100 recoiling nucleus.

### Azimuthal distributions

There must be some trivial error in g-gheisha causing non-symmetric azimuthal (\(\phi\)) distributions of pions and nucleons. As shown in fig. 7 these distributions present funny peaks, not due to the scoring algorithm as demonstrated in fig. 8, where the phi distributions from g-fluka and g-calor are flat, as expected.

Figure 5:

### The few-GeV range

This is the hardest for all MonteCarlo programs, due to its complexity and the strong interconnection of particle and nuclear physics. Here g-calor uses the scaling model, and g-fluka the resonance decay model, that shows some limitations, both because it includes at most two resonances in the starting configuration, and because the intranuclear cascade as described by nucrin (although much improved from the very old version, that did not even conserve energy) is not satisfactory.

#### 5.4.1 Particle distributions

We started the comparison from the simple hadron-nucleon case: fig. 9 shows the Feynman-\(x\) distributions of pions from the \(\pi^{+}p\) reaction at 7 GeV/c. Data for outgoing \(\pi^{-}\) are available.

Figure 6:(In this and the following figures, experimental data are plotted as points connected by lines, MonteCarlo data as symbols with errors or as dashed histograms). The first striking evidence is that g-calor produces no \(\pi^{-}\) ( for this reason the experimental data for \(\pi^{-}\) are not reported on the g-calor plot )! The reason is that the Bertini INC simulates only single pion production (\(\pi+N\to\pi+\pi+N\) ) in pion-induced reactions, and only single and double pion production in nucleon-induced reactions. This prevents \(\pi^{-}\) production from \(\pi^{+}\) on protons due to charge conservation. Just to give an idea, double pion production opens already at about 350 MeV in pion-nucleon reactions, and three-pion production has its threshold at about 1 GeV in nucleon-induced reactions.

The second evidence in fig. 9 is the completely wrong shape of the distributions in the g-calor case.

To a much lesser extent, also the g-fluka behaviour in this test is not in complete agreement with data. This is a known problem, and has been cured in the present fluka

Figure 7: Azimuthal angle distributions of pions and nucleons. Top line is in \(\pi^{-}\)C at 2 GeV, bottom line in 200 GeV p on Xe

version, as shown again in fig. 9, where the comparison is made with experimental data on outgoing \(\pi^{-}\) at three different energies.

Going from nucleons to nuclei, in fig.10 the \(x_{f}\) distributions of pions from \(\pi^{+}\) C at 7 GeV/c are shown. No exp. data was available, but while the g-fluka and g-gheisha distribution have the shape one expects, the g-calor distributions have a really crazy hole at \(x_{f}\)=0.

#### 5.4.2 Multiplicities

The number of secondary particles has been scored and compared also with some data. Fast charged particle multiplicities are collected in tab. 1 and pions-nucleons in tab 2. The scaling model underestimates the multiplicities of fast particles by a factor of two, and those of pions even of a factor of three. g-gheisha behaves well, and g-fluka is quite low at 5 GeV, while

Figure 8: Azimuthal angle distributions of pions and nucleons in \(\pi^{-}\)C at 2 GeV. Top line is g-fluka bottom line is g-calor.

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline  & \multicolumn{2}{|c|}{Exp.} & g-gheisha & g-calor & g-fluka & fluka \\ \hline \hline n. of \(\pi^{0}\) & 1.77(5) & 2.35 & 0.6 & 2.0 & 2.1 \\ \(<E_{\pi^{0}}>\) total, GeV & & 1.24 & 1.90 & 1.38 & 1.26 \\ n. of \(\pi^{+}\) & 1.37(2) & 1.63 & 0.52 & 1.30 & 1.31 \\ \(<E_{\pi^{+}}>\)total, GeV & & 0.85 & 2.25 & 1.26 & 1.15 \\ n. of \(\pi^{-}\) & 2.05(2) & 2.64 & 1.25 & 2.19 & 2.24 \\ \(<E_{\pi^{-}}>\)total, GeV & & 1.77 & 3.45 & 1.69 & 1.77 \\ n. of protons & & 1.62 & 2.0 & 2.82 & 2.92 \\ \(<E_{p}>\)kinetic, GeV & & 0.31 & 0.59 & 0.25 & 0.18 \\ n. of neutrons & & 1.75 & 2.7 & 3.1 & 3.2 \\ \(<E_{n}>\)kinetic, GeV & & 0.320 & 0.75 & 0.29 & 0.21 \\ \hline \end{tabular}
\end{table}
Table 2: Particle multiplicities and average energies following \(\pi^{-}\) interactions on Neon at 10.5 GeV/c. Experimental data are from [34]. Errors on MonteCarlo data are of the % order, errors on exp. data are written in parenthesis and refer to the last digit. g-calor data have been calculated at 9.99 GeV/c.

it is in agreement with data at 7 and 10 GeV. Also the shape of the fast particle multiplicity distribution from g-calor is different from what expected, as shown in fig. 11.

Figure 9: Feynman \(x\) distributions of \(\pi^{+},\pi^{-}\) and \(\pi^{0}\) after \(\pi^{+}\)p interactions at 7 GeV/c. Dots connected by a line: Exp. data on outgoing \(\pi^{-}\) from [31]; dashed histograms: MonteCarlo results with errors. Top-left:g-calor : only \(\pi^{+}\) and \(\pi^{0}\) are produced; Top-right: g-gheisha with \(\pi^{+}\),\(\pi^{0}\) and \(\pi^{-}\) in decreasing order; Bottom-left:g-fluka, as in g-gheisha ; Bottom-right:fluka, only outgoing \(\pi^{-}\), but at three energies: 3.7, 7 and 18 GeV, all compared with exp. data (dots).

An intercomparison of the fraction of electromagnetic energy ( mainly from \(\pi^{0}\) ) produced in the \(\pi^{+}\) C reaction at 7.5 GeV/c gives the following numbers: g-gheisha : 30%; g-fluka : 28%; g-calor : 11%. Given the previous comparison with experimental multiplicities, the most likely conclusion is that g-gheisha and g-fluka are reasonable, and g-calor underestimates the electromagnetic component by a factor of three.

Figure 10: Feynman \(x\) distributions of pions after \(\pi^{+}\) C interaction at 7 GeV/c. Top-left:g-color, Top-right: g-gheisha, Bottom-left:g-fluka

### Pion interactions below \(\approx\) 500 MeV

Pion reactions in this range are dominated by the \(\Delta\) resonance. The pion absorption reaction on nuclei accounts for a large fraction, even one half, of the reaction cross section. This channel is not implemented in g-fluka and g-gheisha. g-gheisha does not even include charge exchange reactions for for pion momenta lower than 0.277 GeV/c. g-calor is in agreement with data for \(\pi^{+}\)-induced reactions, while it predicts absorption cross sections for \(\pi^{-}\) that are about one half of the exp. ones on heavy nuclei, and reaction cross sections that are \(\approx 30\%\) too low, probably because it does not take into account Coulomb deflection and nuclear potential effects. The present version of peanut, as used now in fluka, gives very nice results, as seen in fig. 12.

### The high energy range

Inclusive particle distributions in the multi-GeV range are experimentally well known. Rapidity distributions are characterized by a plateau in the region around the center of mass rapidity, as seen in fig. 13. The peaks at near-zero rapidity correspond to secondary particle emission from the intranuclear cascade in the target nucleus. Experimental data are

Figure 11: Fast charged particle distributions in the three geant versionsapplied to MonteCarlo data for this comparison: a cut at low energies, due to the chamber sensitivity, and the approximation that at momenta larger than 600 GeV/c all particles are supposed to be pions. The g-fluka predictions are very satisfactory, while g-gheisha fails in reproducing the plateau, predicting more peaked distributions.

Transverse momentum distributions of positive and negative pions in \(\pi^{-}\)p at 16 GeV/c

Figure 14: Transverse momentum distributions from \(\pi^{-}\) on protons at 16 GeV/c. Dots=exp.data, symbols=MC. top-right: g-gheisha, bottom-left:g-fluka, bottom-right:fluka

are shown in fig. 14. To be noticed the completely wrong slope of g-fleisha at low \(p_{t}\)'s, with a gross overestimation at values close to zero. g-fluka is much better, although not perfect, at low \(p_{t}\)'s, and gives too low tails at high \(p_{t}\)'s, where however the cross section has already decreased by a factor ten. The fluka distributions show a very nice agreement with data, demonstrating again that some problems can be cured.

### The low energy range

In the energy range below the scaling model threshold, the full Bertini INC is used for g-calor. g-fluka is in the resonance model zone down to 300 MeV where the peanut-(1992 version) low energy model takes over for nucleon induced reactions.

Double differential distributions of neutrons at 3 and 1.5 GeV are shown in figs.15 and 16. Both examples show that g-gheisha makes nonsense spectra, being low of a factor 10 in the low energy part of the emitted neutron spectra; this is not surprising since g-gheisha has no evaporation built in. g-calor, on the contrary, is high of about a factor two a low energies, probably because of an excess of reinteraction probability in its INC. g-fluka is better in the low energy part, but shows a bad stepwise structure in the spectra, due to the not good matching among the primary interaction, intranuclear cascade and evaporation parts of the model. This, again, has been solved in the present fluka version. Decreasing again the projectile energy, at 256 MeV (fig 17) both g-calor and g-fluka give good results. g-calor, and to a much lesser extent g-fluka, start underestimating the backward emission at 80 MeV. (figs. 18,19).

At still lower energies, there exist published results from the Bertini INC [26] showing that the model has problems both in double differential distributions and in inclusive spectra, expecially on medium-heavy nuclei. Results of g-fluka can be extracted for instance from ref.[9], and are much better.

### The GEANT environment

It has been stated in the introduction that the geant environment is exactly the same for the three hadronic packages. This is true, but it does not mean that the geant environment it self has no influence on the overall results. Already at the beginning of the geant-fluka business, some evidence of "environmental" influence showed up. In tab. 3 a comparison of different _programs_, namely g-fluka, g-gheisha, (geanf and geanh in the table) fluka and calor, is presented. This table has been filled up at the end of 1992 [8], thus the treatment of hadronic interactions in this table's fluka was _exactly_ the same of g-fluka one. Of course, it is not representative of results of the present versions of fluka and calor.

The most interesting part of this table is the \(\frac{\epsilon}{\pi}\) section, where g-fluka results are overcompensating, with values below 1, while fluka, using the same hadronic interaction routines, predicts values around 1.05, that are in agreement with experimental ones within the error bars. This difference must lie somewhere in the hadronic transport or/and in the electromagnetic parts. A discussion on electromagnetic showers simulations is outside the aim of this note, but we would just like to mention that geant is the only "official" code that still uses the old Fermi-Eyges-Yang algorithm [35] for the path length correction in multiple scattering: its severe limitations and inconsistencies have already been pointed out in the literature.

Figure 15: Dots+lines=exp.data, symbols=MC. Top-left:g-calor, Top-right: g-gheisha, Bottom-left:g-fluka, Bottom-right:fluka

more than ten years ago[36, 18].

Figure 16: Double differential spectra of neutrons produced in Pb(p,xn) at 1.5 GeV. Dots+lines=exp.data, symbols=MC. Top-left:g-calor, Top-right: g-gheisha, Bottom-left: g-fluka, Bottom-right: fluka

## 6 Summary

It appears evident that each one of the three packages has some major and a few minor problems, that we summarize here.

Figure 17: Double differential spectra of neutrons produced in Fe(p,xn) at 256 MeV. Dots+lines=exp.data, symbols=MC. Top-left: g-calor, Top-right: g-gheisha, Bottom-left:g-fluka, Bottom-right:fluka

### g-Gheisha

Big problems: non conservation of energy and energy, and phi-asymmetry. The former surely broaden resolutions, since it can give a finite energy resolution even to an "ideal"

Figure 18: Double differential spectra of neutrons produced in \({}^{90}\)Zr(p,xn) at 80.5 MeV. Dots+lines=exp.data, symbols=MC. Top-left: g-calor, Top-right: g-gheisha, Bottom-left: g-fluka, Bottom-right: flukacalorimeter. It also broadens any transverse momentum distribution. The phi asymmetry can give biased lateral distributions. The whole low energy range is not reliable (lack of pion absorption and of evaporation-like products).

Other problems: the rapidity distributions show a peak instead of the usual plateau,

Figure 19: Double differential spectra of protons produced in \({}^{90}\)Zr(p,xp) at 80.5 MeV. Dots+lines=exp.data, symbols=MC. Top-left: g-calor, Top-right: g-gheisha, Bottom-left: g-fluka, Bottom-right: fluka

and the transverse momentum distributions have a slope that is quite different from the experimental ones, with an overestimation of the very low \(p_{T}\) region.

### G-Fluka

Big problem: the absence of pion absorption at low energy (\(\Delta\) region). This leads to an overestimation of the charge exchange reaction, with a consequent overestimation of the number of \(\pi^{0}\), and underestimation of the number of secondary nucleons. This can be very important in some specific applications (i.e. the NOMAD Cerenkov calorimeter or the ICARUS event imaging) and may bring a narrowing effect in the resolutions.

Other problems: the few-GeV range has never been very satisfactory, it produces quite high tails in the \(x<0\) zone in Feynman-\(x\) distributions, and its intranuclear cascade model produces some discontinuities in the emitted particle spectra. The high energy part contains

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline  & \multicolumn{3}{|c|}{Energy (GeV)} \\ \cline{2-4}  & 10 & 30 & 75 \\ \hline \hline res. \(\pi^{-}\) : & & & \\ Exp. [29, 30] & 13.8 \(\pm\) 0.4 & \(7.92\pm 0.2\) & \(4.95\pm 0.2\) \\ FLUKA\({}^{a}\) & 12.8 \(\pm\) 0.5 & \(8.50\pm 0.4\) & \(5.50\pm 0.3\) \\ FLUKA & 13.2 \(\pm\) 0.5 & \(7.83\pm 0.3\) & \(5.18\pm 0.3\) \\ GEANF [28] & 12.4 \(\pm\) 0.5 & \(8.1\ \pm 0.5\) & \(5.6\ \pm 0.2\) \\ GEANH [28] & 18.0 \(\pm\) 0.8 & \(10.2\pm 0.4\) & \(8.5\ \pm 0.5\) \\ CALOR [27] & 12.4 \(\pm\) 0.8 & \(8.4\ \pm 0.7\) & \(5.9\ \pm 0.5\) \\ \hline res. \(e^{-}\) : & & & \\ Exp. [29, 30] & 7.15 \(\pm\) 0.1 & \(4.13\pm 0.1\) & \(2.61\ \pm 0.1\) \\ FLUKA\({}^{a}\) & 6.87 \(\pm\) 0.4 & \(4.01\pm 0.2\) & \(2.74\ \pm 0.2\) \\ FLUKA & 7.15 \(\pm\) 0.2 & \(4.25\pm 0.3\) & \(2.71\ \pm 0.2\) \\ GEANT [28] & 7.60 \(\pm\) 0.1 & \(4.46\pm 0.1\) & \(2.74\ \pm 0.1\) \\ CALOR [27] & 7.4 \(\pm\) 0.7 & \(4.4\ \pm 0.3\) & \(3.1\ \pm 0.3\) \\ \hline \(e/\pi\) : & & & \\ Exp. [29, 30] & 1.09 \(\pm\).04 & 1.08 \(\pm\).04 & \(1.08\pm\).04 \\ FLUKA\({}^{a}\) & 1.03 \(\pm\).01 & 1.03 \(\pm\).01 & \(1.04\ \pm\).01 \\ FLUKA & 1.05 \(\pm\).01 & 1.04 \(\pm\).01 & \(1.05\pm\).01 \\ GEANF [28] & 0.97 \(\pm\).01 & 0.96 \(\pm\).01 & \(0.97\pm\).01 \\ GEANH [28] & 1.23 \(\pm\).01 & 1.19 \(\pm\).01 & \(1.17\pm\).01 \\ CALOR [27] & 0.94 \(\pm\).02 & 0.97 \(\pm\).02 & \(1.06\pm\).02 \\ \hline \end{tabular}
\end{table}
Table 3: _Resolution (%) and \(e/\pi\) ratios for the TEST36 lead= scintillator prototype; FLUKA\({}^{a}\) figures have been calculated without the inclusion of spin-relativistic corrections in the multiple scattering algorithm_some inaccuracies in the chain hadronization that bring to a slight defect of high \(p_{T}\) events.

### g-Calor

Big problems: in the "scaling" energy range, the predicted particle multiplicity is two or three times smaller than the experimental one, and the fraction of produced \(\pi^{0}\), or of electromagnetic energy after an hadronic interaction, is strongly underestimated. The correlations among reaction products are lost. All reaction are forward-and-backward peaked, with crazy \(x_{f}\) distributions.

The bad "sampling" of the interaction, due to the small multiplicity, and the low electromagnetic component both contribute to broaden the resolutions, however in an unphysical way. The wrong \(x_{f}\) distribution, can bias the longitudinal developments.

The weighting (averaging) procedure prevents in our opinion any attempt to make studies where the correlation among various shower components/characteristics are important, like resolutions for instance.

Small problems: in the Bertini validity range, the code suffers its age, although proudly. It underestimates by a significant factor the \(\pi^{-}\) inelastic cross sections, fails in describing backward angle emission at low energy, and often underestimates secondary nucleon spectra, expecially on heavy nuclei.

## 7 Conclusion

It is evident from what has been explained before, that none of the three GEANT hadronic packages is perfect, and that some part of them are completely unphysical. Moreover, the old fluka vs. g-fluka comparison of table 3 suggests that there might be some problems even in the transport/em part, plus perhaps some technical bug. It has often been reported that g-fluka gives resolutions too narrow when compared with calorimetric data, and \(\frac{\epsilon}{\pi}\) that are too small, while g-calor and g-gheisha can be brought in agreement with experimental resolutions and noncompensations. Again, tab. 3 gives the hint that the hadronic part is not the only responsible, and that perhaps the large resolutions obtained with g-calor and g-gheisha are obtained compensating a mistake with other mistakes.

In our opinion, the only way to get a better agreement of calorimetric simulations with experiment, and to have a code with some degree of predictivity is to improve its physical models2. Results from the present fluka version show that many of the known problems of the old hadronic packages can be solved, with the implementation of new and better physical models. Work is still going on, mainly stimulated by new applications/benchmarks.

## References

* [1] GEANT Users' guide.
* Physics and applications", Report PITHA 85/02 (1985).
* [3] H.W. Bertini, Phys. Rev. 131 (1963) 1801.
* [4] H.W. Bertini, Phys. Rev., **C1(2)** (1970), 1801
* [5] H.W. Bertini, Phys. Rev., **6(2)** (1972), 631
* [6] T.A. Gabriel et al., Oak Ridge National Laboratory report ORNL-4542
* [7] P. A. Aarnio et al., _Proc. of the MC93 Int. Conf. on Monte Carlo Simulation in High-Energy and Nuclear Physics_, Feb. 22-26, 1993. Ed. P. Dragovitsch, S.L. Linn, M. Burbank, World Scientific, Singapore, 1994 (p. 88).
* [8] A. Fasso et al, proceedings of the _Workshop on "Simulating Accelerator Radiation Environment_, Santa Fe, January 1993, A. Palounek ed., Los Alamos LA-12835-C, p. 1 34 (1994).
* [9] P. R. Sala and A. Ferrari, _Proc. of the MC93 Int. Conf. on Monte Carlo Simulation in High-Energy and Nuclear Physics_, Feb. 22-26, 1993. Ed. P. Dragovitsch, S.L. Linn, M. Burbank, World Scientific, Singapore, 1994 (p. 277).
* [10] J. Ranft and S. Ritter, Z. Phys. **C27** (1985) 413
* [11] S. Ritter, Comp. Phys. Comm. **31** (1984) 393
* [12] K. Hanssgen, H.-J. Mohring and J. Ranft, Nucl. Sci. Eng. **88** (1984), 551.
* [13] J. Ranft and S. Ritter, Z. Phys. **C20** (1983), 347
* [14] K. Hanssgen, and J. Ranft, Nucl. Sci. Eng. 88 (1984) 537.
* [15] P. A. Aarnio et al., in _Proc. of the MC93 Int. Conf. on Monte Carlo Simulation in High-Energy and Nuclear Physics_, Feb. 22-26, 1993. Ed. P. Dragovitsch, S.L. Linn, M. Burbank, World Scientific, Singapore, 1994 (p. 100).
* [16] A. Fasso, A. Ferrari, J. Ranft, and P.R. Sala,,proceedings of the _IV Int. Conf. on Calorimetry in High Energy Physics_, La Biodola, (Elba), A. Menzione and A. Scribano eds., World Scientific, p. 493 (1994).