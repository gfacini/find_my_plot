**ATLAS Internal Note MUON-NO-67 DAQ--NO-38 20 December 1994**

**Level-1 Muon Trigger Simulation**

**in the Barrel Region**

**Andrea Dell'Acqua 1**

**Adele Rimoldi 2**

Footnote 1: University of Wisconsin, Madison, Wisconsin, USA and CERN, Geneva, Switzerland

Footnote 2: Nuclear Physics and Theory Department, Pavia University and I.N.F.N. Pavia, Italy

**Valerio Vercesi 2**

Footnote 3: University of Wisconsin, Madison, Wisconsin, USA and CERN, Geneva, Switzerland

Footnote 2: Nuclear Physics and Theory Department, Pavia University and I.N.F.N. Pavia, Italy

**Abstract**

In this note we describe the simulation of the proposed Level-1 muon trigger algorithms using the Atlas Montecarlo program (DICE) and their implementation in the framework of the Atlas reconstruction program (ATRECON). Results are presented for the barrel region of the Atlas detector, separately for low- and high- and details are given on the uniformity of response of the trigger scheme.

Introduction

The proposed Dedicated Trigger System for the ATLAS Muon Spectrometer uses a combination of two types of detectors, the Resistive Plate Chambers (RPC) in the barrel region (\(|\eta|\leq\)1.05) and the Thin Gap Chambers (TGC) in the endcap regions (1.05\(\leq|\eta|\leq\)2.2) [1]. Both detectors satisfy the requirements which are set by the challenging operational environment at the Large Hadron Collider (LHC), in particular for what concerns the time resolution.

We have investigated how a suitable muon trigger algorithm could be implemented at the first level of the trigger scheme, using the technology adopted for the barrel region. This algorithm should be able to trigger on muons coming from very different sources and with transverse momentum ranging from a few GeV to some tens of GeV. This is mandatory in order to identify particles coming for example from B mesons decays, as well as those from Higgs bosons decays. The trigger should also be simple, to be easily implemented in the hardware, and fast, to allow for a basic identification of the particle, leaving more refined measurement (such as sharper momentum reconstruction) to the second level processors and algorithms. Moreover, it must have the ability to reduce to a reasonable value the accepted rate, maintaining the excellent time resolution property of the trigger detectors themselves.

The discrete read-out structure of the RPCs provides in a natural way the ideas on which the proposed algorithm is based. In the following we will explain how the simulation program has been set-up, in order to extract information to be fed into the reconstruction program. The "simulation\(\Leftrightarrow\)reconstruction" chain has been iterated several times, both to follow the evolution of the spectrometer geometrical description and to validate the performances of each stage. Only the final results are summarized here, together with a first look to an application of the trigger algorithm to B mesons physics.

## 2 Geometry and Simulation

The Atlas muon spectrometer is based on a 8-coil air core toroidal magnet, with a field integral of 2.7 Tm in the barrel region. In the same \(\eta\) interval, the muon detector consists of a set of high-precision chambers made of pressurized drift tubes and a set of trigger chambers based on the RPC technology. The precision chamber concept adopted is the Monitored Drift Tube (MDT) [2]. The momentum determination in the barrel region rests on a sagitta measurement, obtained through information coming from three layers of chambers, called MI, MM, and MO for the inner, middle, and outer stations respectively. A transverse view of the design of the spectrometer (as used in this study) can be seen in Fig. 1. It can be seen that each "type" of station comes in two different sizes, to be called "large" and "small" in the following, each covering different regions in azimuthal angle. It must be also stressed that the small MM chambers interlock through the holes in the coil cryostat. Hence the measurements in these regions can be particularly affected by the inhomogeneities of the magnetic field, due to big field gradients in proximity of the coil windings.

The RPC is a gaseous detector, built by a pair of parallel plates, usually made by bakelite, and filled with a gas mixture of Argon/Butane in the ratio 60/40. In Atlas, to cope with the high trigger rate, this will be replaced by a mixture Ar/Butane/SF\({}_{6}\) (74/8/18). The outer surfaces are coated with graphite paint layers connected to the high voltage supplier. The pick-up strips are fixed to the detector surface and two sets of orthogonal strips allow a two-dimensional read-out of the particle position (see Fig. 2 for a sketch of the detector). In the following the granularity of the read-out will be assumed to be 3 cm.

The trigger chambers are located as illustrated in Fig. 3. Two sets, each made

Figure 1: _Transverse view of the Muon Spectrometer_

by two RPC layers, embed the middle muon station, while a triplet of layers is positioned just below the outer station. As it will be better explained in the following, the purpose of the middle setup is to act as a low-\(p_{T}\)trigger, and a combination of the middle and outer information will provide the high-\(p_{T}\)trigger.

This spectrometer set-up has been simulated using the development version of the ATLAS Montecarlo program (SLUG version 1.09/03, DICE version 2.03/15). Lacking a complete implementation in the program of the new MDT layout, the precision chambers have not been simulated correctly: instead, an approximate description has been used ("phantom chambers") which is assumed to be adequate for this work. Given the importance attached to them in the present study, the RPCs have been on the contrary simulated with all the details previously described. The rest of the ATLAS detector has been simulated accordingly to the version quoted above. Only the inner tracker has been excluded from the GEANT processing, since we do not aim at any matching of the muon track. We have used a homogeneous solenoidal field for the inner part and the 3-dimensional parametrization for the toroidal part.

Positive and negative muons have been generated at transverse momenta of 4,5,6,7,8,9 and 10 GeV/c for the low-\(p_{T}\) studies and at 20,25,30,35 and 40 GeV/c

Figure 2: _Sketch of a Resistive Plate Chamber_

for the high-\(p_{T}\) ones. For each value, \(p_{T}\) was kept constant over \(0\leq|\eta|\leq\)1 and over the \(\phi\) coverage of the small and/or the large chambers; in this solid angle typically 30,000 events have been generated for each value of the transverse momentum. The standard gaussian spread, with \(\sigma_{z}\sim 6\) cm, has been applied to the \(z\) vertex position. Characteristic computational times are 0.7 sec per event, almost independent of the \(p_{T}\), on an HP9000/735 (99 MHz).

## 3 Trigger Algorithms

As discussed above, the wide spectrum of physics to be investigated at the LHC, requires that a muon trigger performs equally well at low- and high-\(p_{T}\). The first level trigger concept adopted is very simple. The muon spectrometer is divided in "trigger towers", or Regions Of Interest (ROI): in \(\phi\) each large chamber is split in two (no subdivision for the small), and in \(\eta\) the full length of the barrel is divided in 11 sections. In this way each ROI has a size of \(\approx\Delta\eta\times\Delta\phi=0.2\times 0.2\) to keep the signal propagation along the strips below 10 ns.

Figure 3 illustrates the setup of a trigger tower. It is organized in two stations: S1 is placed inside the field region at a radius of \(\approx 700\) cm, whereas S2 is placed outside the magnet at \(\approx 1000\) cm. Moreover S1 is split in two substations S1\({}_{in}\) and S1\({}_{out}\), each of them containing two layers of RPCs. The bending plane in the toroidal spectrometer is defined by the beam axis and the line of flight of the particle.

For the low-\(p_{T}\) trigger only S1 is used: each strip in S1\({}_{in}\) opens a coincidence

Figure 3: _Concept of the Level-1 Muon Trigger_

Figure 4: _Differences in number of strips in the bending (a) and non-bending (b) planes between the extrapolated and hit strips. Data are for 6 GeV muons, around \(\eta\)=0 in the large chambers_

Figure 5: _Differences in number of strips in the bending (a) and non-bending (b) planes between the extrapolated and hit strips. Data are for 20 GeV muons, around \(\eta\)=0 in the small chambers_

window in S1\({}_{out}\). The centre of this window is the extrapolation of the line defined by the geometrical centre of the apparatus and the point on S1\({}_{in}\). This extrapolation is equivalent to the line of flight of an infinite momentum muon. The size of this window is defined by the transverse momentum threshold, the magnetic field intensity and the geometry. Muons with momentum higher than the trigger threshold will hit S1\({}_{out}\) inside the trigger window and then give a trigger. On the contrary, lower momentum muons will bend more and they will miss the trigger window. The lever arm for the low-\(p_{T}\) trigger is 37.5 cm. The high-\(p_{T}\) trigger is built in a similar way, using S1\({}_{out}\) and the geometrical centre to define the extrapolation line, and opening a coincidence window on the external station S2. The lever arm is in this case \(\sim\) 297 cm.

Figure 4a shows the difference in number of strips between the extrapolated strip and the hit one, in the bending plane. Data refer to 6 GeV \(p_{T}\) muons, around \(\eta\)=0, in the large chambers. From this distribution one can get a rough estimate of the momentum resolution (\(\sigma(1/p_{T})\)) of the algorithm, which is in this case of the order of 25-30%. The limitations on this resolution come mainly from the multiple Coulomb scattering and the fluctuations in the energy loss in

Figure 6: _Level 1 muon trigger efficiency vs. \(p_{T}\) in the large chambers around \(\eta\)=0 for fixed window sizes_

the calorimeters. In some regions of the small chambers also contributions from strong inhomogeneities of the magnetic field should be considered. In fig. 4b the non-bending plane corresponding distribution is shown. Its symmetry reflects the accuracy in the simulation of the magnetic flux return (from the central solenoid). As a comparison, in fig. 5 the same distributions are shown for the high-\(p_{T}\) trigger and muons of 20 GeV transverse momentum.

The resulting efficiencies in the bending plane (for large chambers around \(\eta\)=0) are shown in Fig. 6, for three fixed-size windows, assuming a 3 cm strip width. Since the window size is roughly proportional to \(1/\sin^{2}\theta\), one can expect that to achieve the same efficiency (say 90%) at increasing \(\eta\) values, the window size has to become bigger. This is illustrated in fig. 7, where the same window size is used over the range \(0\leq\eta\leq 1\) with efficiencies decreasing in the higher \(\eta\) bins.

Muons of opposite charge bend in opposite directions in the toroidal field. To achieve the same acceptance for both charges in the chosen geometry, the windows must be made asymmetric (as shown in fig. 3), and the degree of asymmetry depends directly on \(\eta\) and inversely on the \(p_{T}\). The final results are summarized in fig. 8(a) where the efficiency versus \(\eta\) is shown. Each bin corresponds to a trigger tower in the bending plane. The efficiency values have been determined using the correct asymmetric window for each bin, maintaining the acceptance ratio for the two charges as constant as possible (8(b)). The values of the asymmetric window sizes are shown as a function of the rapidity in fig. 9 for the large chambers, separately for the low- and high-\(p_{T}\) trigger.

For completeness we show in fig. 10 the trigger efficiency in the non bending plane as a function of the total window size, for the low-\(p_{T}\) trigger. In this case

Figure 7: _Efficiency versus \(\eta\) for a fixed window size_

Figure 8: _Efficiency versus \(\eta\) for asymmetric window sizes (a) and ratio of acceptances for positive and negative muons (b). Data are for 6 GeV muons._

Figure 9: _Window sizes versus \(\eta\) for low- and high-p\({}_{T}\)_

there is no motivation for asymmetric windows, and of course the size of the window is much smaller than in the bending plane.

## 4 Implementation in Atrecon

The results presented in the previous section have allowed the implementation of the discussed trigger scheme in the Atlas reconstruction program ATRECON. The block diagram of the corresponding routines is shown in fig. 11. We remind that a simplest implementation of a Level-1 Muon Trigger, known as the "fake" muon trigger, exists inside ATRECON. This structure has also been left in the code, to enhance the compatibility with previous studies.

The implemented algorithm allows also the identification of three thresholds for the low-\(p_{T}\) trigger (respectively at 6,8 and 10 GeV), and two thresholds for the high-\(p_{T}\) trigger (at 25 and 40 GeV). This makes possible a rough evaluation of the transverse momentum of the muon which triggered the system, to be passed to the Level-2 processor whose goal is to refine this information.

Particular care has been taken to achieve the smallest efficiency loss across the boundaries of adjacent trigger regions in \(\eta\). Although the trigger towers are normally treated independently in the algorithm, we have considered the possibility of spanning the trigger over two chambers, due to the envisaged hardware overlaps in the read-out near the boundary. In this way also particles crossing two towers could be taken into account.

Other refinements of the algorithm are foreseen, in particular the clustering of neighbouring strips and time of flight corrections have to be taken into account.

Figure 10: _Efficiency versus window size in the non-bending plane_

Figure 11: _Block diagram of the Level-1 Muon trigger code in ATRECON_

Figure 12: \(\phi\) _and \(\eta\) distributions for the generated and reconstructed Higgs muons_

Figure 14: Level-1 muon trigger efficiency

Figure 13: Trigger results for muons in H \(\rightarrow\) 4\(\mu\) events

At the present stage we are able to contain the inefficiency of the algorithm below 5%.

The final implementation has been tested on three different event samples: single muons, \(b\overline{b}\) events and Higgs decaying into 4 muons. As an example, fig. 12 shows the generated (a) and reconstructed (b) \(\eta\) and \(\phi\) distributions for a sample of \(\approx 1300\) Higgs bosons, with mass of 150 GeV, decaying into four muons, in \(|\eta|<1.4\). The binning corresponds to the chosen granularity of the trigger towers: inefficiencies in \(\phi\) are due to the regions of the small chambers near the coils.

Figure 13 finally shows the distribution of the average number of triggers versus the number of muons in the event, in the barrel acceptance. Since we trigger independently in the bending and in the non-bending directions, two triggers are on average expected for each muon in the event.

## 5 Conclusions

Several caveats should be considered in analysing the results of this work. In particular we wish to mention that, on the technical side of the simulation, issues like the jitter of the signals inside the RPC have not been addressed, nor chamber inefficiencies have been considered, nor the clustering of neighbouring strips. Even more important, the huge flux of neutrons, photons and charged particles, which could be the most severe problem for a muon trigger at the LHC, has not been included in the simulation.

Lacking these information, we have tried to be as conservative as possible on the side of the window sizes, still keeping the efficiency as high as possible. Bearing this in mind, fig. 14 shows the final results on the trigger efficiency versus the muon transverse momentum. Threshold for 90% efficiency are set at 6 GeV for the low-\(p_{T}\) trigger, and at 20 GeV for the high-\(p_{T}\)trigger. We remind that the sharpness of these cuts are limited by factors like the stability of the _pp_ interaction point and the multiple scattering in the calorimeters. A more refined work is needed to evaluate the influence of the background on these results.

## References

* [1] An integrated RPC and TGC Detector for the ATLAS Muon Trigger, ATLAS Internal Note MUON-NO-042, 3 June 1994
* [2] Monitored Drift Tubes Chambers for Muon Spectroscopy in ATLAS, ATLAS Internal Note MUON-NO-044, 28 June 1994