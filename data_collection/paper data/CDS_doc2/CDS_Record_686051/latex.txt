# Electron/photon separation

D. Rousseau

###### Abstract

Electron/photon separation at high p\({}_{\rm T}\) (-40 GeV/\(c\)) is essential for the Higgs-\(>\)\(\gamma\gamma\) search around the Z mass. This subject was first studied two years ago in [1] at \(\eta\)=0.3 with the Inner Detector "Panel" layout. The present study is done over the full pseudorapidity range with the 96_12 layout and makes use of improvements of the Inner detector software over the past two years. Two complementary pattern recognition algorithms and a photon conversion tagger are used to achieve an electron veto efficiency above 99.8% while retaining an efficiency above 96% for photons (not including calorimeter identification requirements), even at high luminosity. These performances are not significantly affected if the silicon layer efficiency is decreased from its default value of 97% to 90%.

## 1 Introduction

### Physics motivation

The Higgs-\(>\)\(\gamma\gamma\) channel is the best mode for Higgs discovery in the mass range 80 to 130 GeV. If the Higgs boson (Standard Model or MSSM) mass is close to the Z mass, then the decay Z-\(>\)e\({}^{+}\)e\({}^{-}\) is a potentially severe background. Since the cross section for that decay is 25000 times higher than that of Higgs-\(>\)\(\gamma\gamma\) (in the Standard Model), the misidentification of electrons as photons should be as low as 1/500, to ensure that the resonant peak of Z-\(>\)\(\gamma^{\prime\prime\prime}\gamma^{\prime}\) be less than 10% of the signal. The loss in photon efficiency should obviously be as low as possible.

### The problem

The main criterion that allows electron/photon separation is of course the presence or absence of a track pointing to the calorimeter. In practice, several cases are possible, depending on the number of tracks reconstructed in the Inner Detector, as displayed in Figure 1-1:

[MISSING_PAGE_EMPTY:2]

* No track: this is either a normal photon, or an electron which has undergone a severe bremsstrahlung in the first layers of the Inner Detector, so that it could not be reconstructed. As shown in Figure 1-2, about 0.15% of 40 GeV \(\mathrm{p_{T}}\) electrons have less than 0.5 GeV when leaving the third pixel layer1. This fraction rises to 0.8% when entering the TRT. Footnote 1: These curves are obtained from the KINE bank for events generated with the card DETP ‘TRAC’ 12=BREM’ 13=110. 14=340. 15=0.0 16=0.01, so that all the bremsstrahlung photons down to \(\mathrm{p_{T}}\)=10 MeV are saved on the KINE stack.
* 1 track: this is either a normal electron, a photon with an unrelated fake track or pile-up track, or a converted photon where the second track could not be reconstructed.
* 2 tracks or more: this is either a normal converted photon, an electron accompanied by a fake track or pile-up track, or an electron which has undergone a hard bremsstrahlung followed by conversion of the radiated photon.

### Strategy

The problem of electron/photon separation was already studied in [1]. The study was done with the so-called Panel layout (no B layer) at \(\eta\)=0.3. The method used was to look for a TRT track near a calorimeter cluster and for a 3-hit track candidate in the first layers of silicon. An electron rejection of 500 was reached for a photon efficiency of 88%. The degradation of the silicon layer efficiency from the nominal 97% to 90% caused a drop of the photon efficiency to 84%.

Since the time of [1], three complete pattern recognition programs2 have been made available or improved, and tools like photon conversion identification have been developed. In this work, the following tools have been used and adapted whenever necessary:

Footnote 2: Like PIXLREC, IPATREC[2] performs a combinatorial search for tracks in the silicon tracker but starting with hits at the inner and outer radii of the silicon tracker. An initial study, in April 1997, showed that it had a similar efficiency for electrons as that of PIXLREC, before the bremsstrahlung search was implemented in PIXLREC. It was arbitrarily decided to continue with XKALMAN and PIXLREC, simply because both algorithms run conveniently in the ATLASIM framework.

* the calorimeter reconstruction[3][4] is used to get the primary electron direction in \(\eta\) and in \(\phi\) and its \(\mathrm{p_{T}}\)
* XKALMAN[2][6] finds a track in the TRT and extrapolates it into the silicon layers. It has the possibility of taking into account bremsstrahlung losses. It is not very sensitive to inefficiencies in the silicon layers, but it cannot reconstruct tracks which reach the TRT with \(\mathrm{p_{T}}\) less than 0.5 GeV,

Figure 1-2: Fraction of electrons with \(\mathrm{p_{T}}\)=40 GeV keeping more than a given \(\mathrm{p_{T}}\) at various positions in the Inner Detector.

* PIXLREC[2] finds track starting from the B layer and is well suited to find electrons which have undergone a very hard bremsstrahlung, once the allowance for bremsstrahlung was implemented in its track fitting. It is more sensitive than XKALMAN to inefficiencies in the silicon layers.
* XCONVER[2][3][5] finds conversions by matching pairs of previously reconstructed XKALMAN tracks.

The basic idea in favour of combining these two pattern recognition algorithms is that their weaknesses do not overlap. The possible problems affecting the association of a track to a calorimeter cluster (namely tails in the cluster direction reconstruction, missing hits, high local density of hits due to pile-up and hard bremsstrahlung) are not correlated. The final combination of algorithms does not have to be robust against all these problems at the same time, provided that each problem can be coped with by at least one algorithm.

### Data samples used

All the data used was fully simulated in the Inner Detector and the Liquid Argon Calorimeter with the 96_12 layout. A typical \(\mathrm{p_{T}}\) of 40 GeV was chosen for single electrons and photons and the full pseudorapidity range -2.5\(<\)\(\eta\)\(<\)2.5 was used uniformly. The numbers of simulated events are the following:

* 16730 single electrons
* 4000 single electrons from the previous sample with pile-up added
* 3958 single electrons, with a \(\mathrm{p_{T}}\) less than 10 GeV when leaving the Inner Detector, corresponding to 24000 unbiased electrons
* 2000 single photons
* 2000 single photons from the previous sample with pile-up added

A fraction of 10% of these events are dropped at the preselection stage described in Section 2.1. The noise in the calorimeter was not simulated. It should not affect the results since, as it will be clear from the next section, what matters is not the gaussian core of the calorimeter pointing resolution but the tails above 10\(\sigma\) or more..

## 2 Calorimeter information

The calorimeter is used to select photons candidates (not described here), and to provide \(\mathrm{E_{T}}\) measurements and pointing information in \(\eta\) and in \(\phi\). Clusters of size \(\Delta\eta\times\Delta\phi=3\times 7\) are used throughout this note, as they are less sensitive to bremsstrahlung than smaller clusters.

### Preselection

This study makes sense only for photons identified in the calorimeter for the Higgs-\(>\)\(\gamma\gamma\) search. For this reason, the overlap region (1.37\(<\) 1 \(\eta\) \(<\)1.52) where the energy resolution is poor and the region not covered by the strips (1 \(\eta\) \(|\) \(>\)2.4) where the pointing is poor were excluded (corresponding to 10% of the full pseudorapidity range). The pseudorapidity resolution is poor in both these regions, which would have necessitated to open up the track to calorimeter pointing window, hence degrading the performance. Results on the full rapidity range will nevertheless be given in Section 8.2.

Only clusters with \(\mathrm{E_{T}>}10\) GeV are considered and in the presence of multiple clusters only the one with the highest energy is considered. The calorimeter photon identification cuts such as the energy in the hadron calorimeter or shower shape variables[3] were found to have no effect on the performance of the algorithm and were hence not applied.

Photon identification cuts using reconstructed tracks are being studied but are not well settled yet, so no attempt to use them was made. However, if applied as a preselection, they can only improve the photon efficiency of the electron/photon separation algorithm.

All the results in reconstruction efficiencies quoted in the following Sections will be normalised to the numbers of preselected electrons and photons.

### Pointing in \(\eta\)

A calorimeter cluster will be labelled as an electron if a track is found pointing to it. This Section and the next describe how, for a given track, the matching in \(\eta\) and in \(\phi\) is done.

The pseudorapidity measured by the calorimeter assumes the particle is coming from the origin. To take into account the spread of the primary vertex along the z axis, it is necessary to use the following formulae:

\[\eta_{\mathrm{corr}}\;=\;\mathrm{arc}\sinh\biggl{(}\sinh(\eta_{\mathrm{calo} })-\frac{\mathrm{Z}}{\mathrm{r}_{\mathrm{shower}}}\biggr{)}\]

for the barrel, and:

\[\eta_{\mathrm{corr}}\;=\;\mathrm{arc}\sinh\biggl{(}\sinh(\eta_{\mathrm{calo} })\times\biggl{(}1-\frac{\mathrm{Z}}{\mathrm{z}_{\mathrm{shower}}}\biggr{)} \biggr{)}\]

for the end-caps.

\(\eta_{\mathrm{calo}}\) is the pseudorapidity measured in the first sampling of the calorimeter (quantity ETA1 in bank EMCL), using the fine granularity given by the strips. Z is the z of the track at closest approach to the beam line. The calorimeter also provides an estimate of the z of the vertex, but it is much less precise than that from the Inner Detector (2 cm resolution compared to 100 \(\mathrm{\SIUnitSymbolMicro m}\)). \(\mathrm{r}_{\mathrm{shower}}\) and \(\mathrm{z}_{\mathrm{shower}}\) are the effective shower depths (quantity DEPTH in bank EMCL, reduced by 10 cm to take into account the fact that DEPTH is given for the whole shower, whereas only the first sampling is used here; the resolution obtained on \(\eta_{\mathrm{corr}}\) is thus slightly improved with respect to using a fixed shower depth.)The difference between the pseudorapidity measured in the calorimeter and the one of the reconstructed track (XKALMAN here) is shown on Figure 2-1. The resolution is 0.0007 units of pseudorapidity and is approximately evenly shared between the track resolution and the calorimeter resolution. To recover all possible electrons, a track is considered as pointing to the calorimeter in pseudorapidity, if the pseudorapidity difference is within \(\pm 0.01\).

### Pointing in \(\phi\)

The \(\phi\) angle measured by the calorimeter has to be corrected for the curvature of the track. The \(\mathrm{p_{T}}\) of the track is best measured by the calorimeter (\(\mathrm{p_{Tcalo}}\)), except for its sign (s) which is taken from the curvature of the reconstructed track. The following formulae are used (distances are in centimetres and momenta in \(\mathrm{GeV}\)):

\[\mathrm{\varphi_{corr}}\ =\ \mathrm{\varphi_{calo}+0.003s\frac{\mathrm{r_{ shower}}}{\mathrm{P_{Tcalo}}}}\]

for the barrel, and:

\[\mathrm{\varphi_{corr}}\ =\ \mathrm{\varphi_{calo}+0.003s\frac{\mathrm{z_{ shower}}}{\mathrm{P_{Tcalo}}\mathrm{sinh}(\mathrm{\eta_{calo}})}}\]

for the end-caps.

Figure 2-1: \(\mathrm{\eta_{corr}}\)-\(\mathrm{\eta_{track}}\) at low luminosity for electrons. The arrows indicate the position of the window.

The difference between the \(\phi\) angle measured in the calorimeter and the one of the reconstructed track (XKALMAN here) is shown in Figure 2-2. The resolution is 1 mrad and is approximately evenly shared between the track resolution and the calorimeter resolution, but the tails are dominated by bremsstrahlung degrading the track parameters. To recover all possible electrons, a track is considered as pointing to the calorimeter in \(\phi\), if the angle difference is within \(\pm 0.02\) rad. To set the scale, the number of primary tracks at high luminosity in a region \(\Delta\eta\times\Delta\phi=\pm 0.01\times\pm 0.02\) is 0.022 and is reduced to 0.002 with p\({}_{\rm T}\)\(>\)1 GeV.

## 3 TRT based tracking (XKALMAN)

XKALMAN is the TRT based pattern recognition[2][6]. The version used here is the future 97_12 one without modification, except in the steering cards (see Appendix for details), this version is close to the one used for the Inner Detector TDR, but with slightly better efficiency, in particular at high luminosity. It starts by finding a track in the TRT using a histograming method, based on the hit straws (no drift-time information is used at this stage). The track is then extrapolated to the silicon layers with a Kalman filter-smoother algorithm. Then it is extrapolated back to the TRT where the drift-time information is now included. Several iterations may be necessary before a track is stable. Bremsstrahlung is treated in the "brem-fit" option as an additional noise contribution in each layer: this works well for average bremsstrahlung but not in extreme cases where a track loses more than 90% of its energy in one layer. The "brem-fit" is kept as a valid fit if it allowed more hits to be associated to the track. In this note, the "brem-fit" was attempted for all tracks (BREMFIT=2 in the INRO bank), not only for tracks with a certain number of transition radiation hits associated. The calorimeter information is not used at the track-fitting level.

A track may not be reconstructed by XKALMAN for several reasons, not all related to bremsstrahlung:

* Hit inefficiency: a track candidate is dropped in the first extrapolation if two consecutive holes are found. In the SCT layers, a hole corresponds to two missing hits (one for each view) while in the Pixel layer, a hole corresponds to one missing hit (neglecting overlap regions).
* High occupancy: at high luminosity, the occupancy is sometimes so high in the TRT (loopers...) that the initial track cannot be found, or it is found but with parameters so wrong that the extrapolation to the silicon layers misses the hits. The occupancy in the silicon layers can also be high, so that most of the hits of the tracks are spoilt by other tracks, in which case the hit association cannot be done. All in all, this happens in less than 0.5% of the cases.

* Hard bremsstrahlung: it may happen that the initial electron has lost so much energy that:
* It leaves the TRT with a remaining \(\rm p_{T}\) less than 0.5 GeV, which is the threshold below which XKALMAN does not search for tracks.
* It does leave the TRT with sufficient \(\rm p_{T}\) but the extrapolation of the TRT track would miss by far the beam-line (which is likely if the bremsstrahlung happened in the last layers of silicon), in which case it cannot be reconstructed because the histograming method for track finding in the TRT assumes that the track comes from the beam-line with some margin.
* The track is well reconstructed in the TRT, but the "kink" at the bremsstrahlung point is too hard to be coped with.

## 4 Pixel based tracking (PIXLREC)

PIXLREC is the Pixel based pattern recognition[2]. It starts from the innermost layers and steps outwards, \(\chi^{2}\)-fitting each combination with a trajectory model. Once a "skeleton" track is found, the final hit association and track fitting is performed by the Kalman filter of XKALMAN. If the Kalman filter fails, as it is often the case with very hard bremsstrahlung, the skeleton fit is retained. The version used here is the future 97_12 version, which incorporates improvements made for this study. Electromagnetic calorimeter seeds can be used, and most important, the trajectory model in the skeleton fit is extended from a simple helix with 5 parameters, to a helix with 7 parameters, the two additional parameters corresponding to a possible reduction of the curvature at a given point (see Appendix for details).

The possible causes of inefficiency of PIXLREC are the following:

* Hit inefficiency: PIXLREC is more sensitive than XKALMAN to inefficiency because it cannot reconstruct a track if there are more than two holes in total.
* High occupancy: PIXLREC is also more sensitive than XKALMAN to high occupancy in the silicon, because it does not have a good prior estimation of the track parameters. On the other hand, PIXLREC is not sensitive to occupancy in the TRT.
* Hard bremsstrahlung: by design, the Brem-fit in PIXLREC can cope with arbitrarily severe bremsstrahlung, provided the electron reaches the penultimate silicon layer (which is always the case if the electron final \(\rm p_{T}\) is more than 140 MeV), and provided most of the energy loss occurred at one point.

## 5 Photon conversion identification (XCONVER)

To remove tracks coming from photon conversions, all pairs of opposite charge tracks are tested for the photon conversion hypothesis. This is done by fitting the tracks to a single point where they should be parallel. Since only tracks with at least one pixel hit associated are considered, only early conversions need to be searched for. The typical efficiency is 85%[2]. Tracks which originate from a conversion are no longer considered.

In practice, XCONVER works only for XKALMAN tracks. To be able to remove PIXLREC tracks originating from photon conversions, it has been chosen to match each XKALMAN track identified as belonging to a conversion to a PIXLREC track, by requiring the z, cotan(\(\theta\)), and \(\phi\) param eters of both tracks to be close. It would have been better to match the tracks according to their shared hits, but this information is not easily available at the output of both packages. This method is however sufficient to remove most of the identified conversions.

When a conversion is identified, care should be taken that the conversion is a real conversion from a high \(\mathrm{p_{T}}\) photon and not a fake conversion nor a conversion of an unrelated photon (\(\chi^{2}\) and \(\mathrm{E_{T}}\) matching to the calorimeter cluster), nor a combination of the original electron with a particle from the conversion of a bremsstrahlung photon (absence of hits below the conversion radius, balance of \(\mathrm{p_{T}}\) between the tracks). These effects are quantified in the next Section.

## 6 Overall tuning

The details of the three algorithms described in the previous Sections were tuned in order to achieve overall the best possible electron rejection at low luminosity1 and the highest photon efficiency at high luminosity. Since the ultimate electron rejection is provided by PIXLREC, tighter cuts can be in general applied to XKALMAN tracks.

Footnote 1: The electron rejection at high luminosity has been measured as a cross-check (see next Section), but the statistics available do not allow any tuning there (only 5 events pass all cuts).

XKALMAN tracks should fulfil:

* \(|\mathrm{p_{T}}|\)\(>\)1 GeV, with \(\mathrm{p_{T}}\) constrained to the vertex. At the pattern recognition level, all tracks with \(|\mathrm{p_{T}}|\)\(>\)0.5 GeV are searched for.
* \(\mathrm{N_{pixel}}\)\(>\)0.
* \(2\,\mathrm{N_{pixel}}\)\(+\)\(\mathrm{N_{SCT}}\)\(>\)7. This variable, taking into account that one Pixel hit is 3D, while one SCT hit is only 2D, is a slightly better discriminant against fake tracks than the usual variable \(\mathrm{N_{pixel}}\)\(+\)\(\mathrm{N_{SCT}}\)
* The final track should contain at least one TRT hit.
* The fraction of holes in the TRT should be less than 50%.
* The impact parameter in the xy plane, I, signed so that a negative impact parameter means that the beam-line is on the same side of the track as the centre of curvature, should be in the range: -15\(<\)I/\(\sigma_{\mathrm{I}}\)\(<\)5.
* The track should not belong to a conversion with \(\chi^{2}\) per d.o.f. below 40 and \(\mathrm{p_{T}}\) above 70% of the \(\mathrm{p_{T}}\) measured in the calorimeter.

PIXLREC tracks should fulfil:

* \(|\mathrm{p_{T}}|\)\(>\)1 GeV, with \(\mathrm{p_{T}}\) constrained to the vertex. At the pattern recognition level, all tracks with \(|\mathrm{p_{T}}|\)\(>\)0.5 GeV are searched for.
* \(\mathrm{N_{pixel}}\)\(>\)1.
* \(2\,\mathrm{N_{pixel}}\)\(+\)\(\mathrm{N_{SCT}}\)\(>\)7.
* The track should not correspond to an XKALMAN track which belongs to a conversion with
* \(\chi^{2}\) per d.o.f. below 10
* \(\rm p_{T}\) above 70% and below 120% of the \(\rm p_{T}\) measured in the calorimeter
* both tracks contributing to more than 10% of the \(\rm p_{T}\) of the converted photon
* no track with a B layer Pixel hit if the radius of conversion is above 6 cm

Finally, a candidate photon is accepted if there is no such XKALMAN track in a region \(\rm\Delta\eta\times\Delta\phi=\pm 0.005\times\pm 0.01\) around the calorimeter point and no such PIXLREC track in a region \(\rm\Delta\eta\times\Delta\phi=\pm 0.01\times\pm 0.02\). Figure 6-1  illustrates the optimisation of these windows.

Figure 6-1 Scatter plot of \(\Delta\phi\) versus \(\rm\Delta\eta\). The boxes indicate the selection windows. The XKALMAN tracks are shown only for events with no PIXLREC track selected and vice-versa, to illustrate the choice of the windows. The electron events are at low luminosity while the photon events are at high luminosity. The cluster at (0,0) for high luminosity photons corresponds to converted photons which were not fully reconstructed.

## 7 Results

The event flow is shown on Figure 7-1 for low luminosity electrons and high luminosity photons. The final performance is not very sensitive to the precise overall tuning since most of the electrons are rejected by both XKALMAN and PIXLREC, but the detail of the event flow is. The final efficiencies are shown in Figure 7-2 as a function of \(\mid\)n\(\mid\). The electron efficiency and photon inefficiency are rather flat, with a tendency to be higher in the end-caps.

The efficiency of the photon selection for the hard bremsstrahlung biased electron sample (properly normalised) is 0.15+/-0.03%, in good agreement with the efficiency for the unbiased sample 0.18+/-0.03%. This proves that hard bremsstrahlung is indeed the major cause for electron inefficiency. These numbers have been averaged in Figure 7-2 to 0.16+/-0.02%. For PIXLREC alone, the efficiencies are 0.19+/-0.03% and 0.26+/-0.04%, and for XKALMAN alone 3.5+/-0.1% and 4.2+/-0.1%, showing that each algorithm has its weaknesses, but the combination of both is more robust.

The efficiency for electrons is not affected by pile-up at high luminosity (10\({}^{34}\) cm\({}^{-2}\)s\({}^{-1}\)). At high luminosity, 5 events out of the 3600 preselected electrons are retained as photon candidates. In the corresponding 3600 single track events, 5 events are also retained, 4 of which are in common with the high-luminosity sample. One event fails at high luminosity because the calorimeter cluster moves out of the window. One event fails at low luminosity because it lacks SCT hits, but is accepted at high luminosity by picking an additional wrong hit.

The photon efficiency is 98.2+/-0.3% at low luminosity. The inefficiency is entirely due to conversions where only one track was reconstructed, or both tracks were reconstructed but not with sufficient quality to make a good conversion. At high luminosity, the photon efficiency drops to 96.5+/-0.5%, due to pile-up or fake tracks approximately pointing to the calorimeter cluster, and to poorer photon conversion finding efficiency. The high luminosity efficiency will be quoted in the following as the reference photon efficiency.

## 8 Robustness

### Electron energy

Electrons from \(Z\) decay have a p\({}_{\rm T}\) spectrum with an average around 50 GeV but reaching up to 100 GeV. On the low p\({}_{\rm T}\) side, it is usual for m\({}_{\rm H}\)=100 GeV to require one calorimeter cluster with p\({}_{\rm T}\)\(>\)25 GeV and one cluster with p\({}_{\rm T}\)\(>\)40 GeV [3]. To get an idea of the evolution of the performance of the electron/photon algorithm, the analysis was repeated with 20000 electrons with p\({}_{\rm T}\)=20 GeV and 3000 electrons with p\({}_{\rm T}\)=100 GeV.

At 20 GeV, the electron efficiency increases to 0.27+/-0.04%, provided the algorithm is retuned by increasing the size of the \(\phi\) window by a factor of two (corresponding to the increase of the curvature), and by lowering to 0.5 GeV the minimum p\({}_{\rm T}\) of XKALMAN tracks. The photon efficiency, estimated from high luminosity 40 GeV photons, drops to 95.3+/-0.5%.

At 100 GeV, the electron efficiency drops as low as 0.04+/-0.04%, for a photon efficiency which should be unaffected.

Figure 7-1: Event flow: XKALMAN is run first. If one track which does not belong to a conversion is found pointing to the calorimeter cluster, the particle is labelled as electron. If not, PIXLREC is run and again, if one track which does not belong to a conversion is found pointing to the calorimeter cluster, the particle is labelled as electron. If no track or a conversion is found the particle is labelled as photon.

The performance quoted for single particles at 40 GeV is believed to give a good approximation of the expected performance for inclusive Z-\(>\)e\({}^{+}\)e\({}^{-}\) decays with p\({}_{\rm T}\)\({}^{1}\)\(>\)40 GeV and p\({}_{\rm T}\)\({}^{2}\)\(>\)25 GeV. This will be verified in the future as soon as a high-statistics fully simulated Z sample is available.

### Acceptance

If no \(\rm{|\eta|}\) acceptance cuts are made the electron efficiency is 0.33% for a photon efficiency at high luminosity of 96.2% (not including the 10% relative gain of efficiency due to the enlarged acceptance). If the \(\eta\) width of the window is enlarged to 0.05 for PIXLREC and XKALMAN for the additional \(\eta\) acceptance regions only, the electron efficiency drops to 0.19% for a photon efficiency of 96.2%.

Figure 7: \(\eta\) distribution of efficiencies of the photon selection for electrons (top) and photons (bottom) at low (left) and high (right) luminosity.

### Silicon efficiency

The performance of the algorithm was also studied when degrading the efficiency of the silicon layers from 97% to 90%. Without any retuning, the electron efficiency increases to 0.24+/-0.04% for the unbiased sample and 0.18+/-0.03% for the biased sample. This small discrepancy indicates that the increase of the efficiency is due to normal electrons with several missing hits, but not to hard bremsstrahlung electrons with few missing hits. Although the individual efficiencies of PIXLREC and XKALMAN increase by 0.4%, the increase of the overall efficiency is limited because the two algorithms do not have the same sensitivity to missing hits. The high-luminosity photon efficiency is unchanged.

An electron efficiency of 0.17+/-0.04% can be recovered in this case by removing the \(\mathrm{p_{T}}\)\(>\)1 GeV cut, by lowering the minimum signed impact parameter to -30 for XKALMAN tracks, and by enlarging the \(\phi\) window to 0.03 for PIXLREC and XKALMAN tracks. With these looser cuts, the photon efficiency at high luminosity drops to 95.3+/-0.5% (the electron efficiency for standard 97% silicon efficiency would be 0.13+/-0.02%).

## 9 Energy resolution and implications for Higgs search

It is essential to study the resolution of the electrons identified as photons, since the rejection factor of 500 is needed only if the remaining Z peak has the same width as the Higgs peak. Figure 9-1 shows the energy resolution for all electrons and electrons identified as photons. Although the statistics are poor, it is clear that the energy resolution of the misidentified electrons is a bit worse than that of identified electrons. The resolution histograms were used in a toy Monte-Carlo to estimate the resolution on the gamma-gamma mass peak. The mass resolution obtained is 1% for photons, 1.2% for all electrons, and 1.5% for electrons identified as photons. Since electronic noise, pile-up and the electron \(\mathrm{E_{T}}\) spectrum have not been taken into account, the 50% worse resolution for misidentified photons compared to real photons should be taken as an upper limit. This indicates that the Z\(>\)\(\gamma\)\(\gamma\)\(\gamma\)\(\gamma\)\(\gamma\) background does indeed peak in the \(\gamma\gamma\) mass spectrum, but at a level which is harmless for the Higgs\(>\)\(\gamma\)\(\gamma\) search.

## 10 Conclusion

Using an electron/photon separation algorithm based on two complementary pattern recognition programs and a photon conversion finder, it is shown that photon identification could reach an efficiency as low as 0.16% for electrons, for a photon efficiency of 96.5% at high luminosity. This corresponds to a reduction of the Z\(>\)e\({}^{+}\)e- background by a factor 350000, producing a peak in the \(\gamma\gamma\) mass spectrum of slightly larger width and a level well below 10% of the expected Standard Model Higgs\(>\)\(\gamma\)\(\gamma\) peak, at a cost of 7% in the overall Higgs\(>\)\(\gamma\)\(\gamma\) reconstruction efficiency. This performance is only slightly degraded by a silicon layer efficiency decreased from the default 97% to 90%.

The relevant points which should be addressed by the future OO pattern recognition software to provide at least as good performances are: (i) the general possibility to accommodate very hard bremsstrahlung, which probably necessitates a 7-parameter track fit, (ii) a tunable robustness against silicon layer inefficiencies (no hard-coded cuts on numbers of holes), (iii) photon conversion finding which allows to go back to the track-fitting stage, if the two tracks share a hit or if a track has a hit upstream of the radius of conversion.

## Acknowledgement

I wish to thank for their help in this analysis and for useful discussions Dario Barberis, Ulrik Egede, Daniel Froidevaux, Igor Gavrilenko, Fabiola Gianotti, Stephen Haywood, Pavel Nevski, Sasha Rozanov, Jerome Schwindling and Laurent Vacavant.

Figure 9.1: The top plots show the energy resolution for all electrons (left) and electrons identified as photon (right). The bottom plots show the corresponding mass resolutions expected for Z\(\cdot\)\(>\)e\({}^{+}\)e\({}^{-}\) decays (left) and Z\(\cdot\)\(>\)”\(\gamma\)” decays (right).

## References

* [1] "e/\(\gamma\) separation with the Inner Detector Panel Layout", S. Schuh _et al._, ATLAS Internal Note, PHYS-070, 1 August 1995.
* [2] "ATLAS Inner Detector TDR", Vol. I, CERN/LHCC/97-16, 30 April 1997.
* [3] "ATLAS Calorimeter Performance TDR', CERN/LHCC/96-40, 15 December 1996.
* [4] "The reconstruction code for the electromagnetic calorimeter in ATRECON", J.Schwindling, 22 March 1997, [http://atlasinfo.cern.ch/Atlas/GROUPS/SOFTWARE/DOCUMENTS/notes/emreco97](http://atlasinfo.cern.ch/Atlas/GROUPS/SOFTWARE/DOCUMENTS/notes/emreco97) 3.ps.
* [5] "A short documentation of the Xonver module for reconstructing conversions", U. Egede, LUNDF6/(NFFL-714X)1997, 13 September 1997, [http://atlasinfo.cern.ch/Atlas/GROUPS/INNER_DETECTOR/LAYOUT/DOC/xconve](http://atlasinfo.cern.ch/Atlas/GROUPS/INNER_DETECTOR/LAYOUT/DOC/xconve) r.ps
* [6] "Description of Global Pattern Recognition Program (XKalman)", I. Gavrilenko, 25 April 1997,ATLAS Internal Note, INDET-NO-165.

## Appendix: Technical implementation

XKALMAN was run with the following cards:

DETP XKAL INRO= 4. ONOFF= 0.0 INRO= l. ONOFF= l.0 PTMIN= 0.5 BREMOPT= 2.0 HWETSE= 0.2 HWFISE= 0.1 PTSEED= 10.

The window (HWETSExHWFISE) is kept as small as possible to save CPU time at high luminosity without losing any genuine electrons. BREMOPT=2 forces XKALMAN to attempt a "brem-fit" for all tracks.

PIXLREC was run with the following cards:

DETP PIXL invo= 0.0 ONOFF= 0.0 inro= 1.0 onoff= 1.0 PTSEED= 10. MINE-TA= -2.6 MAXETA= 2.6 MINPHI= -0.1 MAXPHI= 6.29 PTMIN= 1. ETAMAX= 2.5 VXYMAX= 3.9 HWETSE= 0.04 HWFISE= 0.06 HWXYVT= 0.01 HWRZVT= 20. MFIELD= 2. CLUST= -3 CHI3= 50. CHI4= 50. CHI5= 50. CHI6= 30. CHI7= 30. XI5CUT= 300. REFIT= 1. NBHMINI= 5 BNPMINI= 1 NFSH= 4 NFSHP= 2 NFSHS= 2 MASK= 0 DFH(1)= 0.1 DPH(2)= 0.1 DPH(3)= 0.1 DPH(4)= 0. DZH(1)= 10. DZH(2)= 1. DZH(3)= 1. DZH(4)= 0. DFS(1)= 1. DFS(2)= 2. DFS(3)= 5. DFS(4)= 1.2 DZS(1)= 1.02 DZS(2)= 1.02 DZS(3)= 1.02 DZS(4)= 1.02 GEOSCAN= 0 COMBI-CUT= 500 BREMSEARCH= 1 BREMFIT= 1

Compared to the default values, the \(\chi^{2}\) cuts at each hyperplane(CHI2,3,4,5) have been made tighter (50 instead of 100), except the final one (CHIF) which is looser (30 instead of 20). The tolerances on helix parameters before hit association (DFH,DZH) are now tighter. The tolerances on hit selection at each hyperplane (DFS,DZS) are tighter for the first hyperplane and looser in \(\phi\) for the last hyperplane. Tighter cuts in the first hyperplanes are meant to reduce the CPU time of the combinatorial track search. Looser cuts in the last hyperplanes are necessary, especially in \(\phi\), to improve the efficiency for electrons undergoing very hard bremsstrahlung.

The implementation of the 7 parameter helix model (triggered by the keyword BREMFIT=1) is done as follows. Two additional parameters are added to the usual 5 parameters of the helix. RBREM is the radius at which the bremsstrahlung occurs and XBREM is related to the pT of the bremsstrahlung photon. These new parameters render the track fit very non-linear, so that it is absolutely necessary to guide it, according to the number of points available in the xy plane (the beam-line is always used as the first point):

* 3 points or less: the usual circle or straight line fit is done.
* 4 points: RBREM is fixed to the radius of the 3rd point, XBREM is free. Note that there are no degrees of freedom in the xy plane, only the rz view (unaffected by bremsstrahlung) defines the track quality.
* 5 points or more: RBREM is free, but should be between the radius of the 3rd point and the radius of the penultimate outermost point. XBREM is free.
* Whenever XBREM is fitted, RBREM is first fixed to the middle of its allowed range, and XBREM is fitted three times with three different initial values corresponding to a final radius of curvature of 20cm, 1m and 10m. The initial value giving the best \(\chi^{2}\) is chosen, and the final fit is done with all 7 parameters free. This procedure allows the recovery of the rare cases (a few per mill) where the fit would not converge unaided.

Finally, to avoid divergence of the CPU time at high luminosity, the hits in the first and second pixel layers are required to be consistent with a line joining the centre of the detector and the calorimeter cluster (BREMSEARCH=1).

The CPU time needed (on HP-8000) per single photon or electron for the calorimeter reconstruction, XKALMAN, PIXLREC and XCONVER is detailed in Table 0-1. As PIXLREC is rather time consuming, it is preferable to call it only if no good track (or a conversion) is found by XKALMAN (4% of the cases for electron, \(\sim\)100% for photon).

\begin{table}
\begin{tabular}{l l l l l} \hline
**CPU time (s)** & **e low lumi** & \(\gamma\)**low lumi** & **e high lumi** & \(\gamma\)**high lumi** \\ \hline Calorimeter & 0.96 & 0.96 & 14 & 14 \\ AXXXREC & \textless{}0.01 & \textless{}0.01 & 4 & 4 \\ XKALMAN & 0.02 & 0.01 & 8 & 8 \\ PIXLREC & 0.12 & 0.09 & 6 & 13 \\ \hline \end{tabular}
\end{table}
Table 0-1: CPU time (s) for single electron and photon with pT=40GeV at low and high luminosity. The first row includes loading the event and running the calorimeter reconstruction. The second row shows the additional time to prepare the Inner Detector hits, the third row to run XKALMAN and XCONVER, and the fourth row to run PIXLREC when no XKALMAN track or a conversion is found. These two last contributions would scale with the number of high ET electromagnetic clusters in the event.