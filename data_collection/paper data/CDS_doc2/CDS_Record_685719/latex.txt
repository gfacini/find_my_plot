**ATLAS Internal Note DAQ-NO-005**

**14 September 1992**

**Level-1 trigger system**

N. Ellis, S. Hellman, A. Nisati, E. Petrolo and A. Watson

**Introduction**

This note covers many aspects of the level-1 system including its interaction with other parts of the trigger, DAQ and front-end system. It is divided into sections as follows:

* this identifies physics signatures which must be selected in the level-1 trigger.
* this presents the rates that are estimated for some of triggers that we expect to implement at level-1.
* this is a general discussion of constraints that are imposed on the level-1 system, for example by the LHC machine parameters.
* this presents trigger algorithms and implementation ideas for the level-1 calorimeter trigger.
* this presents trigger algorithms and implementation ideas for the level-1 muon trigger.
* this discusses problems of building the overall level-1 system in which the subtriggers are combined together in a larger framework. The need for dialogue between the level-1 trigger, the front-end electronics and the level-2 system is also addressed. Some general issues such as synchronization are described in this section.

The sections on physics requirements and trigger rates address these topics from the point of view of implementing the level-1 trigger. The reader should refer to the separate note [1] on trigger rates for a more general and detailed discussion. Many of the issues discussed in this report will be addressed in R&D project CERN-DRDC-RD27.

**Physics Requirements**

The level-1 trigger must select a superset of the events required for physics analyses, with more refined selections being made at level 2 and above. The level-1 trigger will, in addition, have to select events for calibration and alignment purposes such as \(\rm Z\to e^{+}e^{-}\) and \(\rm Z\to\mu^{+}\mu^{-}\). Excellent efficiency for selecting rare physics processes must be combined with very good rejection against high-rate processes, principally hadronic jet production, in order to reduce the input rate to the level-2 system to a manageable level.

The essential signatures on which we plan to base the level-1 trigger are high-\(p_{\rm T}\) electrons, muons, photons and jets. An additional signature which we consider to be very important is large missing transverse-energy (\(E_{\rm T}\)) (as a signature for non-interacting particles such as neutrinos, SUSY particles or other new physics). Triggers to select high-\(p_{\rm T}\) tracks could also be of interest, perhaps as a means to trigger on tau leptons, but this possibility is not discussed here. In general, the thresholds will be applied as cuts on \(p_{\rm T}\), giving an approximately flat distribution of particles in rapidity.

The acceptance in pseudorapidity should extend to \(\eta|\gtrsim 2.5\) for electron/photon and muon triggers in order to have good acceptance for rare processes such as Higgs decays. A missing-\(E_{\rm T}\) trigger will require even larger acceptance if the resolution is not to be compromised by jets falling outside the trigger region.

Inclusive triggers based on the above signatures will not combine adequate efficiency for all the physics channels of interest together with adequate rate reduction at level 1. The first level trigger must therefore include compound triggers with lower \(p_{\rm T}\) thresholds than for the inclusive triggers. We should provide dimuon, dielectron and muon-electron triggers. A two-photon trigger with the lowest possible threshold will be very important in the search for \(\rm H\to\gamma\gamma\). Here we must be able to study the shape of the two-photon mass spectrum below any resonance, so it is important to keep the thresholds low. A trigger on high-mass lepton or photon pairs might be an interesting additional requirement.

Compound triggers involving jets and missing-\(E_{\rm T}\) should also be foreseen. The bulk of jet events contain only two or three high-\(p_{\rm T}\) jets. A trigger on high jet multiplicity should therefore be considered in addition to the inclusive jet trigger, for which the \(p_{\rm T}\) threshold will have to be very high. The missing-\(E_{\rm T}\) signature is important but is prone to non-physics backgrounds such as beam halo. While an inclusive missing-\(E_{\rm T}\) trigger would be of considerable interest, it may be necessary to combine the missing-\(E_{\rm T}\) signature with another requirement such as a lepton, photon or jet.

The LHC is an exploratory facility and we should be ready to respond to new physics. We should also keep in mind that background estimates are very uncertain and rely on a large extrapolation from existing measurements. These two considerations make a very flexible and powerful level-1 trigger system a necessity.

**Trigger Rates**

We assume a maximum luminosity of 1.7\(\times 10^{34}\) cm\({}^{-2}\)s\({}^{-1}\) and the estimated background rates presented in Refs. [1; 2; 3]. The simulation for the e/\(\gamma\) trigger is described in the appendix.

The rate reduction needed from the first level trigger processor depends on the capabilities of the level-2 system which we assume can handle an input rate of up to \(10^{5}\) Hz. To leave ourselves a safety margin (rate predictions are very approximate at this stage), we aim for a level-1 trigger rate not exceeding a few \(\times\)\(10^{4}\) Hz. This means a reduction of \(\sim 10^{4}\) over the bunch-crossing rate or \(\sim 10^{5}\) over the interaction rate.

A possible trigger scenario, appropriate for running at the highest luminosity, is given below:

* estimated rate 8 kHz.
* estimated rate 67 Hz.
* estimated rate 32 kHz.
* estimated rate 5 kHz.
* At least one jet with \(p_{\rm T}\)? 300 GeV.
* Three or more jets with \(p_{\rm T}\)? 250 GeV.

The quoted rates are for a pseudorapidity coverage \(|\eta|\)! 2.5 for muons and electrons and \(|\eta|\)! 3 for jets.

A W \(\rightarrow\) ev trigger could be made demanding a high-\(p_{\rm T}\) electron in association with large missing-\(E_{\rm T}\). However, note that an inclusive W \(\rightarrow\) ev selection with full event readout would exceed the capabilities of the data acquisition system at the full LHC luminosity, although partial readout for calibration analysis might be possible. Similarly, a jet-plus-missing-\(E_{\rm T}\) trigger could be implemented for SUSY studies.

Even at level 1, there is essentially no background to the muon trigger (dominated by charm and beauty decays [2]) and the jet trigger (jets are the dominant high-\(p_{\rm T}\) process). In contrast, the electromagnetic cluster (electron/photon) trigger will be dominated by the background from \(\pi^{0}\)s from jets [1, 3]. An inclusive missing-\(E_{\rm T}\) trigger is likely to be dominated by non-physics backgrounds and by jets falling outside the detector acceptance.

The level-2 trigger will have to reduce the trigger rate by a further factor of \(\sim 10^{2}\) compared to level 1. In the case of the electromagnetic cluster trigger, this factor can be achieved by making use of the full calorimeter information (fine granularity and depth information) and including information from other detectors (tracking, electron identification detectors, etc). However, for the muon and jet triggers all that can be done is to make a cut at higher \(p_{\rm T}\) with improved resolution (in the case of the muon trigger isolation can also be applied). If sufficient resolution is available at level 1 it would be better to apply the higher threshold earlier, reducing the contribution to the total level-1 rate from muons and jets, and leaving more room for electron/photon triggers. This consideration is reflected in the trigger scenario described above.

Further reduction in rate may be achieved at level 2 or above by making requirements on event topology and by requiring additional signatures (e.g. extra low-\(p_{\mathrm{T}}\) or large-\(\eta\) leptons not detected at level-1).

### General Considerations

A number of constraints are imposed on the level-1 system by the design of the LHC machine, the size of the experimental apparatus, the front-end electronics and the performance of the level-2 system.

The bunch-crossing period which we assume will be 15 ns corresponds to an event rate into the level-1 system of 67 MHz (each event may contain up to = 20 inelastic proton-proton collisions). Given the large physical size of the apparatus and the consequent signal propagation delays, a level-1 trigger latency (decision time) far in excess of the bunch crossing interval is inevitable. Furthermore, complex electronic systems will be needed in order to achieve the required background rejection power, and the processing time will certainly be very long compared to 15 ns. In consequence, the trigger processing will have to be pipelined in 15 ns steps, with a large number of events being processed concurrently. During the level-1 trigger processing time, which we estimate will be 1 - 2 us as discussed below, the data from all channels in the detector will have to be stored in pipeline memories which may be analogue or digital.

The short bunch crossing period of 15 ns has another important implication. In the time it takes for muons to reach the farthest parts of the apparatus, three bunch crossings will have taken place; time-of-flight corrections will be essential!

We assume that the level-1 system will be coordinated by a single central processor which will make the overall level-1 trigger decision. This processor will take information from a number of different sources (calorimeter trigger, muon trigger, etc) and distribute the trigger decision to the front-end electronics of all detectors. The need for a single central processor is illustrated by the case of an event containing an electron and a muon, perhaps from a t pair. In such an event, the trigger comes from different detectors, and the two leptons may be widely separated in the apparatus.

The level-1 central processor is likely to be closely linked with the level-2 system. First level triggers must be inhibited if the level-2 buffers become full (hopefully this happens only rarely). The level-2 trigger will also require information from the level-1 trigger if it is to be efficient.

While the level-1 central processor will be fairly compact, probably located somewhere near the detector, it will draw information from a number of trigger processors(subtriggers) associated with different detectors. Some of the processing, for example searching for tracks in muon detectors or clusters in the electromagnetic calorimeters, could be done locally. The best location for the trigger electronics is a complicated question which requires further study. Some important considerations are given below:

* Accessibility of electronics (commissioning, repairs, modifications).
* Cooling and maximum permitted power dissipation. For electronics mounted on the detector, the cooling system may introduce dead material or cracks.
* Radiation environment for electronics.
* Number and length of connections from the detector to remote electronics. This may introduce dead material or cracks.
* Integration in overall detector design.

A rough estimate of the level-1 latency has been made by considering cable delays and estimated trigger processing times [4]. The total level-1 latency is the interval from the bunch-crossing time to the time when the trigger decision gets back to the front-end electronics. The calculation for each subtrigger must include the time-of-flight to the detector, the response time of the detector, delays for signal shaping, digitization, digital (or analogue) processing, and propagation delays along electrical or optical cables (= 5 ns/m). The calculation of the total latency is determined from the delay of the slowest subtrigger, the processing time (in the level-1 central processor) to form compound triggers, cable delays back to the front-end electronics which in many cases will be mounted on the detector, and the delay through the system which fans the trigger decision out to the front-end electronics (up to \(\sim\)10\({}^{8}\) channels!). Assuming the level-1 central processor is mounted adjacent to the detector, a minimum level-1 latency of about 1.4 \(\upmu\)s is estimated. This assumes a processing time for the calorimeter trigger plus central trigger of about 0.9 \(\upmu\)s as discussed below; the muon trigger processor is likely to be faster than this. The remaining delay is due to the length of cable between the detectors and the central trigger processor, about 40-50 m in each direction, and the time needed to fan the decision out to all front-end electronic channels. Additional constraints are likely to become apparent in the detailed design of the level-1 system which will probably increase the latency compared to this simple calculation. However, we believe that the level-1 latency can be kept below 2 \(\upmu\)s. Note that any increase in the level-1 latency implies bigger pipelines for _all_ readout channels in the experiment. It is perhaps worth adding the cautionary note that many experiments have had difficulty meeting their design latency.

The above estimate of the level-1 latency assumes that the electronics is mounted very close to the detector. Such electronics might be inaccessible during LHC running,although the possibility of providing a shielded area for electronics adjacent to the detector is under investigation. From the point of view of maintaining the trigger, a more comfortable situation would be to have the electronics fully accessible at all times. The choice of location is therefore a compromise between minimizing the latency (cost of readout pipelines) and ease of maintenance of the trigger.

The problem of keeping the level-1 system and the front end readout in synchronization should not be underestimated. The electronics will be distributed over the detector, a huge area, and yet it must all be kept in step to better than 15 ns. The need for time-of-flight corrections is an added complication.

The level-1 trigger should be synchronous, the decision appearing a fixed time (fixed number of bunch crossings) after the interaction took place. The problem of giving a unique identification of the bunch crossing which contained the interaction of interest should be noted. Some of the detectors, especially calorimeters, have a response time which is long compared to the 15 ns bunch crossing period. Special processing will have to be included in the trigger system to do this (e.g. by constant fraction discrimination). An alternative would be for the level-1 trigger to identify a time frame containing the crossing of interest. However, this would put a large burden on the level-2 system which would have to handle more data and perform the bunch crossing identification analysis.

At the highest luminosity of LHC, every bunch crossing will give rise to \(\sim\) 20 inelastic proton-proton collisions each containing \(\sim\) 100 particles. To make matters worse, many detectors are slow compared to the 15 ns bunch-crossing period so that activity is integrated over several crossings. With the exception of the external muon system which is well shielded from the interaction region, detectors will experience pile-up.

### Calorimeter Trigger

The calorimeter trigger system will include electromagnetic cluster finding (electron/photon), jet finding and missing-\(E_{\mathrm{T}}\) triggers. The first of these is the most critical and will probably dominate the level-1 trigger rate.

#### Electron/photon Trigger

For the electromagnetic cluster trigger, calorimeter cells are grouped into trigger cells, probably with reduced granularity and only one depth sampling. In order to retain good efficiency when electromagnetic showers are shared between cells, it is necessary to use overlapping windows. The window size should be small compared to the size of the core of jets which dominate the background. Various algorithms have been simulated [3] to find a suitable compromise between efficiency for electrons/photons and background rejection power. The result of these studies, which build on experience 

[MISSING_PAGE_FAIL:7]

Figure 2a: Threshold plots for different cluster algorithms for \(\ln\)I = 0 - 0.5: \(1\times 1\) (top), \(2\times 1\) / \(1\times 2\) (middle), \(2\times 2\) (bottom).

Figure 2b: Threshold plots for different cluster algorithms for \(|\eta|=1-1.5\): \(1\times 1\) (top), \(2\times 1\) / \(1\times 2\) (middle), \(2\times 2\) (bottom).

Figure 2c: Threshold plots for different cluster algorithms for \(|\eta|\) = 2 - 2.5:

\(1\times 1\) (top), \(2\times 1\) / \(1\times 2\) (middle), \(2\times 2\) (bottom).

Figure 3: Background rates versus \(E_{\rm T}\) threshold for different cluster algorithms at \(L\)=1.7\(\times 10^{34}\) cm\({}^{\mbox{-}2}\)s\({}^{\mbox{-}1}\) (integrated for \(\eta|<2.5\)).

The resolution of the trigger (sharpness of the threshold) depends on the intrinsic resolution of the detector and associated electronics, and the calibration from trigger cell to trigger cell. It also depends on the relative calibration of different calorimeter channels which are grouped together within trigger cells. Simulation suggests that a 5% cell-to-cell calibration uniformity at the trigger level gives satisfactory performance.

Much of the new physics which is sought at LHC results in isolated leptons or photons, i.e. particles that are not contained in jets. In contrast, the dominant background to the electron/photon trigger comes from high-\(p_{\mathrm{T}}\)\(\pi^{0}\)s which result from jet fragmentation. An isolation requirement can therefore significantly reduce the background rate while keeping good efficiency for the physics of interest. The effectiveness of this technique is reduced in the presence of pile-up, as discussed below, but simulation studies [3] indicate that it is still useful at luminosities well in excess of 10\({}^{34}\) cm\({}^{-2}\)s\({}^{-1}\). Various algorithms have been considered. Good performance is obtained by combining information from the electromagnetic and hadronic calorimeters using the algorithm illustrated in Figure 6. The transverse energy in a ring of 12 electromagnetic trigger cells around the cluster and in the 16 hadronic trigger cells behind the cluster is summed. The summed transverse energy is then required to be less than a threshold, typically = 5 GeV. Sensitivity to pile up is reduced by excluding cells from the isolation sum if they have \(E_{\mathrm{T}}\) < 1 GeV as discussed below. A less powerful isolation criterion is to use the summed transverse energy in the ring of electromagnetic cells alone; this would be easier to implement. However, the use of hadronic cells helps in vetoing hadrons, notably charged pions.

Figure 4: Trigger rate at \(L\)=1.7\(\times\)10\({}^{34}\) cm\({}^{-2}\)s\({}^{-1}\) versus cell size (\(\Delta\eta\) = \(\Delta\phi\)) and versus number of EM trigger channels using the cluster algorithm described in the text for \(E_{\mathrm{T}}\) > 40 GeV without requiring isolation.

Figure 5: Trigger rate versus \(E_{\rm T}\) threshold for single cluster and for pairs of clusters, with (lower curves) and without (upper curves) isolation.

The effects of pile-up cannot be ignored in the level-1 trigger, especially in relation to isolation. There are three sources of pile-up: (i) several particles from the same interaction entering a given cell, (ii) particles from different interactions in the same bunch-crossing entering the cell, (iii) for slow calorimeters, energy deposited in a cell from one bunch crossing affecting the measurement in a subsequent bunch crossing. In principle the effect of the latter can be reduced by analyzing the pulse shape. In fact, some form of pulse shape analysis will be required in order to uniquely identify the bunch crossing that caused the trigger.

The pile-up can affect the trigger measurements in two ways: (a) the average energy in the cells due to pile-up shifts the effective trigger threshold (as a function of luminosity), (b) fluctuations in the energy in the cells due to pile-up smears out the trigger threshold. The first of these effects can be minimized by using bipolar shaping; the latter is equivalent to pedestal noise (but is non-Gaussian).

The typical \(E_{\rm T}\) in a trigger cell from pile-up is quite small compared to the \(p_{\rm T}\) of particles in a jet. It is therefore possible to reduce the effect of pile-up on the isolation requirement by only including in the isolation sum those cells which have a significant \(E_{\rm T}\), for example > 1 GeV. Simulation studies of isolation in the presence of pile-up have been performed. The efficiency for retaining isolated electrons is plotted in Figure 7 versus the isolation threshold. The results are for the algorithm described above, including both the EM and hadronic calorimeters, but only summing cells with \(E_{\rm T}\) > 1 GeV. A trigger cell granularity of 0.1 \(\times\) 0.1 was used. The efficiency curves are presented without pile-up, for a luminosity \(L\)=1.7\(\times 10^{34}\) cm\({}^{-2}\)s\({}^{-1}\) (fast calorimeter) and for an effective luminosity of \(L\)=5.1\(\times 10^{34}\) cm\({}^{-2}\)s\({}^{-1}\) (slow calorimeter integrating over 3 bunch crossings). A cut of \(E_{\rm T}\) < 5 GeV on the energy sum has high efficiency for isolated electrons, even at very high luminosity.

Figure 6: Isolation criteria

The isolation requirement gives a very useful background rejection factor. This is demonstrated in Figure 8 which shows the rate of EM clusters, plotted versus \(E_{\rm T}\), with and without a cut on the isolation sum at 5 GeV. There is an order-of-magnitude reduction in the rate - this would allow the trigger to be operated with a much lower single-cluster threshold of about 40 GeV.

It is unlikely that one would feel confident enough to require isolation for all electron/photon triggers. A possible scenario would be to have an inclusive electromagnetic cluster trigger with a rather high-\(E_{\rm T}\) threshold (e.g. 60 GeV), plus an isolated electromagnetic cluster trigger with a somewhat lower threshold (e.g. 40 GeV). This would be in addition to multi-lepton triggers for which the thresholds could be significantly lower.

_Jet Trigger_

A possible algorithm for the jet trigger is to use a two dimensional overlapping square window (in \(\eta-\phi\) space). The size of the window will have to be chosen on the basis of simulation studies. It should be big enough to contain a large fraction of the jet energy. However, the level of the pile-up "noise" also increases with the size of the window. Studies [6] suggest that a jet cone of \(\Delta R<0.4\) is appropriate for LHC, suggesting a window size of \(\Delta\phi\times\Delta\eta=0.6\times 0.6\) for the trigger.

Unlike the electron/photon trigger, the jet trigger must include energy from both the electromagnetic and the hadronic calorimeters. The sharpness of the jet threshold will depend on controlling the relative calibration of the different calorimeters in the level-1 trigger.

The jet rate is shown in Figure 9 as a function of the jet threshold. It is apparent that a very high threshold (= 200 - 300 GeV) will be needed, even at level 1.

Figure 7: Efficiency of isolation requirement in the presence of pile-up:

(a) no pile-up, (b) \(L=1.7\times 10^{34}\) cm\({}^{-2}\)s-1, (c) \(L=5.1\times 10^{34}\) cm\({}^{-2}\)s-1.

Figure 8: Rate versus \(E_{\rm T}\) for single EM clusters with and without an isolation requirement for \(L\) = \(1.7\times 10^{34}\) cm\({}^{\mbox{-}2}\)s\({}^{\mbox{-}1}\).

Figure 9: Inclusive jet rate versus \(E_{\rm T}\) threshold \(L\) = \(1.7\times 10^{34}\) cm-2s-1.

An effective missing transverse energy trigger will require signals from calorimetry covering the widest possible range of pseudorapidity. Studies [7] show that the resolution (and hence the rate) deteriorates rapidly if the level-1 coverage is less than \(\mathrm{\SIUnitSymbolMicro\SIUnitSymbolMicro\SIUnitSymbolMicro\SIUnitSymbolMicro 1}\) < 3.5 - 4.0.

The rate is likely to be dominated by jets falling outside the geometrical acceptance of the trigger (or in cracks in the calorimeters) and, possibly, by machine backgrounds such as beam halo.

The implementation of the missing transverse energy trigger will require a vector sum of transverse energy over the whole detector, including both the electromagnetic and hadronic calorimeters, as discussed below. In this respect it is different to the local electromagnetic cluster and jet triggers in which most of the processing maps onto regions of the detector. Hence, while one could mount local electronics for the electron and jet triggers on the detector, much of the electronics for the missing transverse energy trigger is global. (Of course, the first stages of the vector sum could be done near the detector).

_Calorimeter Trigger Implementation_

A calorimeter trigger with the above ingredients could in principle be implemented in a number of ways: (i) weighted analogue summing plus discriminators, (ii) digitization followed by digital processing, (iii) a hybrid of analogue and digital techniques. Whichever technique is adopted, the processing will have to be pipelined since the decision time will inevitably be much longer than 15 ns.

Studies are in progress [8, 9] for a digital level-1 calorimeter trigger which appears to be feasible. In this scheme a custom digital processor, pipelined in 15 ns (or shorter) steps, would act on digital \(E_{\mathrm{T}}\) values from the trigger cells. This system would implement the full set of trigger algorithms described above. Several thresholds would be provided for electron/photon and jet triggers, with the additional possibility of multiplicity requirements (e.g. \(\geq\) 2 electrons or \(\geq\) 3 jets). For the electromagnetic cluster trigger, isolation would be provided as an option, to be used with some threshold values but not with others. A full missing-\(E_{\mathrm{T}}\) calculation would be included with several thresholds.

The trigger processor would be implemented as a compact system by making extensive use of custom chips. These devices offer high speed with relatively low power dissipation. Because of the large number of trigger channels (\(\approx\) 4000), the custom chips would be needed in large production volume with corresponding economies of scale.

Where appropriate, full use would be made of other technological developments such as multi-chip modules.

Two possibilities exist for the calorimeter front-end electronics. The level-1 readout pipeline for the calorimeters could be implemented using analogue memories [10] - this is the approach being pursued for SDC. Alternatively, fast digitization could be performed at 67 MHz for all calorimeter channels [11], with the data being stored in digital pipelines. Both solutions are compatible with a digital level-1 processor of the type described above. In the former case, an analogue sum would be made over calorimeter channels corresponding to each trigger cell. A fast ADC would then be used to digitize the analogue sum and a look-up memory would be used to apply calibration constants and to convert to transverse energy, as shown in Figure 10. In this solution, care must be taken to ensure that the gains of all calorimeter channels entering each trigger sum are equal within the required resolution. The dynamic range and resolution required from the ADC system has been studied by simulation [3]. A linear 8-bit ADC with \(E_{\mathrm{T}}\) = 1 GeV per count appears to be adequate from preliminary simulation studies. This allows thresholds to be adjusted in steps of \(E_{\mathrm{T}}\) = 1 GeV and gives adequate resolution. A full-scale value of 255 GeV in a single trigger channel should be adequate at level 1 since any event exceeding this could safely be kept for level-2 processing.

In the case of a digital front-end system for the calorimeter readout, the trigger \(E_{\mathrm{T}}\) values could be provided by digital summation over the appropriate calorimeter channels. Here, provision would be made for calibration at the level of individual calorimeter channels. More than 8-bits could be passed to the level-1 processor,

Figure 10: Fast ADC and look-up memory to provide digital input to trigger.

although it is not thought that this would give a significant improvement in the performance of the trigger.

For a digital calorimeter front-end system, some additional trigger functions might be added in the front-end electronics using the full granularity of the detector. In principle one could include measures of the lateral and depth profile of electromagnetic clusters, and analyse the (temporal) shape of pulses to identify the bunch crossing.

Whether the calorimeter front-end electronics is digital or analogue, we expect the trigger processor to include logic to uniquely identify the bunch crossing responsible for the trigger. This is not trivial for calorimeters in which the response time is slow compared to the 15 ns bunch-crossing period. While this topic requires further study, there are a number of ideas as to how bunch-crossing identification might be done.

An advantage of a digital trigger system is that it is easy to control the calibration (applied via look-up memories). The trigger ADC system (if separate) can be cross-calibrated against the main calorimeter readout; this also provides monitoring of the trigger ADC system. The monitoring of the digital trigger processor is facilitated by the fact that, given the input data (which would be read out), intermediate results (which would also be read out) are calculable and can be checked. Finally, maintaining pipeline synchronization in a digital system is relatively straightforward - latches are used between pipelines steps.

In the detailed studies for the design of a digital level-1 calorimeter trigger mentioned above, two possibilities are being followed at present in RD27. In the first of these [8], 8-bit \(E_{\mathrm{T}}\) values are sent in bit-parallel form to a single pipelined processor. Operations such as addition and comparison are then performed in 15 ns pipeline steps. Tests with a prototype electron/photon trigger of this type are planned. A disadvantage of such a system is the large number of interconnections between the (\(=4000\times 8\)-bit) ADCs and the digital logic. This problem becomes particularly severe when the implementation of the isolated electromagnetic cluster-finding logic is considered in detail - here each 8-bit \(E_{\mathrm{T}}\) value is used in 16 cluster-finding windows. A possible solution which is being studied in detail is to use zero suppression and data compression techniques, and to send the data asynchronously between the ADCs and the processor.

An alternative approach [9] is to send the 8-bit \(E_{\mathrm{T}}\) values in bit-serial form. This reduces the number of interconnections by a factor of about 8 and, consequently, allows the logic to be much more densely packed. The subsequent processing, for example operations such as addition and comparison, is then performed serially. Such pipelined serial processing is relatively simple to implement and would allow an increase in the number of functions performed per unit area of silicon compared to the former approach. Such a processor would therefore occupy a much smaller area of circuit board. However, it will not be feasible to send and process 8 bits in serial form in the 15 ns bunch crossing period. The solution is to provide a farm of 8 such processors and to transmit the data at a rate of 1 bit per 15 ns. The different processors then act on 8 different events. There is a small increase (= 100 ns) in latency compared to the bit-parallel method, corresponding to the serialisation time. However, it may be possible to increase the transmission and processing speed which would reduce the latency. In this case fewer processors would be required.

The study of an analogue level-1 calorimeter trigger has not been pursued in detail. However, we believe that it would be difficult make an analogue trigger system as comprehensive and flexible as the digital one described above. In particular, the missing transverse energy trigger, which requires summation over the whole detector, looks very difficult. The jet trigger (and perhaps the isolation requirement), which requires summation over many channels between the electromagnetic and hadronic calorimeters, might also be rather difficult. One possible advantage of an analogue system would be lower power dissipation, which could be important for electronics mounted on the detector.

**Muon trigger**

The level-1 muon trigger for ATLAS will be based on the external muon system, requiring tracks after the toroid that point back to the interaction region within limits determined by multiple scattering and deflection in the toroid.

The muon rate from various sources has been calculated [1, 2] and it is found that semi-muonic beauty and charm decays dominate for \(p_{\mathrm{T}}\) above \(\sim\) 5 GeV. At lower \(p_{\mathrm{T}}\), decays of pions and kaons in flight are the largest source of muons. However, given the large amount of material in front of the outer muon detectors most of these low momentum muons will range out. Muons of \(p_{\mathrm{T}}\) = 5 GeV which do penetrate the iron will be strongly deflected in the field of the toroid and will not point back towards the interaction region.

Detectors for muon triggering

The choice of detector to be used in the level-1 trigger is still under study. This could either be the same detector as used for the precision tracking measurement, or it could be a separate detector. Resistive plate chambers (RPCs) have been suggested for the latter case [12] because they have excellent time resolution.

In principle, one can use a slower detector such as a drift chamber in the level-1 trigger. However, in this case it would be necessary to use more sophisticated and complicated electronics in order to uniquely determine the bunch crossing responsible for the muon. Such a muon trigger system is being constructed for the H1 experiment at HERA [13].

### Trigger Implementation

The basic trigger design, already used in many experiments, is based on muon detector layers separated by a gap which gives a lever arm for angle measurement, as shown in Figure 12. We assume, for simplicity, that the efficiency of each layer is close to 100% so that we do not have to provide for missing hits in the trigger system. This could be achieved by combining signals from several detector layers located close to each other (master points).

Candidate tracks are accepted if there are hits in the inner and outer layers which lie in a cone of half-angle \(\alpha\). If the separation between the planes is \(S\) and the pitch of the detectors is \(\delta\), there will be \(n=2\ \alpha\ S/\ \delta\) elements in the outer layer which can form a valid coincidence with a given hit in the inner layer. By using programmable logic the cone size can be varied, corresponding to changing the muon \(p_{\mathrm{T}}\) threshold.

A trigger of this kind [12] using RPCs has been implemented in an existing fixed-target experiment (WA92). It is also planned to make tests of a similar muon trigger processor in a test beam with RD-5. At present the logic is implemented using PLA devices which already have the speed needed for LHC. A similar algorithm is being implemented in the H1 experiment using custom chips [13] which currently operate at 48 ns. Custom chips have the advantage of much increased density of logic, performing the same algorithm in many fewer packages.

Figure 12: Muon triggerGiven that different thresholds will be required for single muon triggers and for multi-muon triggers (also muon-electron triggers), it will be necessary to implement several sets of electronics having different cone widths. These could be identical sets of electronics, programmed with different cones to achieve different \(p_{\mathrm{T}}\) cuts, or the electronics could be constructed using different detector granularities, for example using the OR of several strips.

Trigger rates have been calculated [2] using a GEANT simulation. The detector in the barrel uses RPC strips perpendicular to the beam direction. In the forward region, the geometry of the RPCs is concentric rings and the total pseudorapidity coverage was \(\eta\)! < 2.5. Rates were calculated using two sets of cones, designed to be efficient for muons with \(p_{\mathrm{T}}\) above 20 GeV and 40 GeV respectively. The results are shown in Table 2 for single and dimuon triggers, where the rate is broken down by physics process. Also shown in Table 2 are the corresponding rates for a sharp cut at \(p_{\mathrm{T}}\)! > 20 GeV and \(p_{\mathrm{T}}\)! > 40 GeV.

The result of the algorithm described above is a pattern of hits showing the positions of muon chamber tracks which point back to the interaction region. Further pipelined digital processing will be required to form the overall muon trigger, for example counting the number of tracks to provide multi-muon triggers. This muon trigger information will then have to be combined with information from other subtriggers in the level-1 central trigger processor.

A muon trigger system, whether based on RPCs or other detectors, will be very large. As with other trigger systems, the timing of signals from different parts of the detector must be equalized, including corrections for the muon time of flight. Related to this is the problem of maintaining synchronization within the pipelined digital system which, for example, calculates the muon multiplicity for each bunch crossing. In addition, the muon trigger system will have to be synchronized with the level-1 central processor and, in consequence, with all other level-1 trigger systems.

The muon trigger system described above is likely to be faster than the calorimeter triggers under study. More sophisticated algorithms could be envisaged without slowing down the overall level-1 system. For example a sharper threshold could be obtained by measuring the angle of deflection of the muon in the toroid using two layers of chambers before the toroid and two layers after it - this could be implemented using programmable coincidence logic. However, given the low rates from the muon trigger compared to the calorimeter triggers this is unlikely to be necessary.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline  & \multicolumn{4}{|c|}{“20 GeV” cones} & \multicolumn{4}{|c|}{Sharp cut at 20 GeV} \\ \hline  & b, c \(\rightarrow\)\(\mu\) & Z \(\rightarrow\)\(\mu\mu\) & Total & b, c \(\rightarrow\)\(\mu\) & Z \(\rightarrow\)\(\mu\mu\) & Total \\ \hline single \(\mu\) & 7.7 kHz & 38 Hz & 7.7 kHz & 2.3 kHz & 36 Hz & 2.3 kHz \\ \hline dimuon & 40 Hz & 27 Hz & 67 Hz & 13 Hz & 24 Hz & 37 Hz \\ \hline  & \multicolumn{4}{|c|}{“40 GeV” cones} & \multicolumn{4}{|c|}{Sharp cut at 40 GeV} \\ \hline  & b, c \(\rightarrow\)\(\mu\) & Z \(\rightarrow\)\(\mu\mu\) & Total & b, c \(\rightarrow\)\(\mu\) & Z \(\rightarrow\)\(\mu\mu\) & Total \\ \hline single \(\mu\) & 1.7 kHz & 32 Hz & 1.7 kHz & 172 Hz & 19 Hz & 191 Hz \\ \hline dimuon & 6 Hz & 19 Hz & 25 Hz & 1 Hz & 10 Hz & 11 Hz \\ \hline \end{tabular}
\end{table}
Table 2: Level-1 trigger rates for \(\mu\)\(|\)\(<2.5\) for a luminosity of \(1.7\times 10^{34}\) cm\({}^{-2}\)s\({}^{-1}\) Systems Aspects Systems aspects of the level-1 system, some of which have already been mentioned, will be very important.

For pipelined digital systems, synchronization is maintained using a system of clocked latches which give some margin for jitter and for spread in device performance (e.g. differences in propagation delay from chip to chip). Nevertheless, detailed circuit simulation will be required in order to check that the system will work reliably. A similar issue is the synchronization of the time of arrival of the level-1 "Trigger Accept" signal at the front-end electronics. Even within a single detector, one has to allow for different cable delays from the central trigger system (depending on the location of the front-end electronics) and, in some cases, different flight times of particles from the interaction point to the electronics. Between detectors the situation is even more complicated, especially if there are several different pipeline architectures. Note that experiments at HERA already face most of these problems, albeit with a bunch crossing period of 96 ns and with an interaction rate much lower than the bunch-crossing frequency. _Location of level-1 electronics_ Much of the level-1 electronics will be inaccessible, at least during LHC running. Electronics mounted directly on the detector will be impossible to access for very long periods of time, perhaps years. It will be essential to build excellent facilities for testing and monitoring the whole trigger system. Remote fault diagnosis will be indispensable and we may even have to envisage fault-tolerant electronics. These considerations and others impact strongly on the choice of location for the level-1 electronics. _Control and monitoring_ Control of the level-1 system will also have to be considered, for example to set up trigger conditions. This may have to be integrated with a larger, experiment-wide, slow control system. It should be kept in mind that trigger systems often act as sources of readout data, needed for efficiency studies and for monitoring. The combination of pipelined trigger processors and pipelined readout introduces special problems. The depth of the readout pipeline has to be reduced to compensate for the length of the processor pipeline. _Overall design_ Many of the above considerations point to the need for a rigorous approach to system design. Full use will have to be made of CAD systems and simulation, both at the system level and in detailed circuit design. Quality assurance techniques will also have to be used to avoid errors. An important area which needs to be considered is the interface between level-1 and level-2 systems. The level-2 trigger will not be able to reduce the rate by \(\sim\) 100 beyond 

[MISSING_PAGE_FAIL:27]

In order to reduce the time needed to simulate the detector response to each event several techniques were used. Firstly the calorimeters were simulated in a model with homogeneous media, having average properties very similar to those of the calorimeters used in the full detector simulation for the physics studies for the LOI. In particular the dimensions of the calorimeters (and hence the spaces between them) and the longitudinal shower profiles were in good agreement with those obtained from the more detailed simulation, at the cost of a small reduction of the transverse shower width. The energies deposited in the calorimeter volumes were stored in pseudo-towers of size 0.02\(\times\)0.02, with the energies from electromagnetic and hadronic showers stored separately to enable us to study the effect of varying e/\(\pi\) response on the trigger rate. The full DICE simulation was used for other detectors and preshower material, so that energy losses in the material in front of the calorimeters would be properly simulated. This simplification of the calorimeter description produces about a factor of 4 reduction in the time required to simulate a single shower in the calorimeters, which leads to a factor of two saving in the time needed to simulate a jet event.

Three other techniques were used to further speed up the simulation. The most important of these was that jet events were generated only in the central rapidity region (\(\eta\)I(jet)<0.5). In addition, the SLUG track filter was used to remove particles at \(\eta\)I<1. These low-\(p_{\rm T}\) (forward going) particles from the underlying event still carry large momenta, and thus a lot of time is required to simulate their showers. Finally the energies below which GEANT stops tracking particles were increased from 100 keV to 200 keV.

The studies of the jet background to the level-1 e/\(\gamma\) trigger are based on samples of 8945 simulated events of \(p_{\rm T}\) > 35 GeV and 6301 of \(p_{\rm T}\) > 15 GeV, selected from samples of 27,000 and 24,000 Pythia events respectively.

## References

* [1] Eagle note DAQ-NO-004 (Sten Hellman et al.)
* [2] Eagle note MUO-NO-002 (A. Nisati et al.). Eagle note MUON-NO-006 (A. Cheplakov et al.).
* [3] Transparencies PHY-TR-080 (A. Watson).
* [4] Technical note in preparation (N. Ellis).
* [5] N. Bains et al., Nucl. Instrum. Methods A292 (1990) 401.
* [6] J. Colas et al, Proc. LHC workshop, Aachen, Vol. 1, p. 370.
* [7] Transparencies DAQ-TR-040 (N. Ellis).
* [8] N. Ellis and J. Garvey, Proc. LHC workshop, Aachen, Vol. 3, p. 80. J. Garvey et al, talk given at CHEP92 conference, Annecy, September 1992.
* [9] Transparencies DAQ-TR-073 and DAQ-TR-086 (C. Bohm).
* [10] P. Jarron et al, Proc. LHC workshop, Aachen, Vol. 3, p. 84. M. Levi et al, Status report on SSC calorimeter front-end electronics R&D.
* [11] CERN-DRDC 90-74 and 92-26 (FERMI collaboration).
* [12] C. Bacci et al, Proc. LHC workshop, Aachen, Vol. 3, p. 467. E. Gennari et al, submitted to IEEE Trans. Nucl. Science.
* [13] E. Eisenhandler et al, talk given at CHEP92 conference, Annecy, September 1992.
* [14] S. Hellman et al, Proc. LHC workshop, Aachen, Vol. 3, p. 72.