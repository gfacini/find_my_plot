ATLAS Physics Communication

ATL-COM-PHYS-2001-014

1 July 2001

(revised version 10 November 2001)

The \(gg,q\bar{q}\to Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) processes:

matrix element implementation to PYTHIA 6.1

**Borut Paul Kersevan**

_CERN, EP Division, 1211 Geneva 23, Switzerland._

**Elzbieta Richter-Was1**

Footnote 1: Supported in part by Polish Government grant KBN 2P03B11819, by the European Commission 5-th framework contract HPRN-CT-2000-00149 and by Polish-French Collaboration with IN2P3.

_Institute of Computer Science, Jagellonian University;_

_Institute of Nuclear Physics_

_30-055 Krakow, ul. Kawiory 26a, Poland._

The \(Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) production at LHC is a potentially severe background for the observability of different Standard Model (SM) and Minimal Supersymmetric Standard Model (MSSM) Higgs boson(s) decay channels. Here we describe implementation2 of the massive matrix elements for the \(gg,q\bar{q}\to Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) processes into PYTHIA 6.1 Monte Carlo.

Footnote 2: Code available from Atlas cvs repository; supported by Borut.Kenevan@cern.chIntroduction

Over last several years the \(Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) production at LHC has been recognised as one of the most substantial irreducible or reducible background for the several Standard Model (SM) and Minimal Supersymmetric Standard Model (MSSM) Higgs boson decay modes as well as for SUSY particles observability.

There is a rather wide spectrum of _regions of interest_ for this background. In all cases the leptonic \(Z/\gamma^{*}\) decay is asked for, but events with di-lepton mass around Z-boson mass or with the masses above or below the resonance peak could be of interest. The presented process enters an analysis either by the accompanying b-quarks being tagged as b-jets, or by the presence of leptons from the b-quark semileptonic decays in these events, in both cases thus contributing to the respective backgrounds.

The good understanding of that background and having available a credible Monte Carlo generator which allows studying expected acceptances for different final states topologies, is crucial. Despite very large effort taken in time of the preparation of the Aachen Workshop [1] such well established Monte Carlo generator was missing for several years.

The matrix element for the \(gg\to Zb\bar{b}\to b\bar{b}\ell\ell\) production has been published already in [2] and in time of Aachen Workshop implemented into EUROJET Monte Carlo [4]. Since this generator was not giving the possibility for having fully generated hadronic event with modeled initial and final state radiation and hadronisation, for analyses presented in [5] it was interfaced to PYTHIA 5.6[6] Monte Carlo. This generator is no longer supported and is not available today.

The same matrix element has been directly implemented into PYTHIA 5.7[6]. However, with this implementation the algorithm for the phase space generation was never working credibly and finally it has been removed from the version PYTHIA 6.1[7].

Recently the massless matrix elements for \(gg,q\bar{q}\to Zb\bar{b}\) processes has been implemented in the general purpose Monte Carlo program MCFM [8]. In that implementation also radiative corrections to this process are addressed. Massive matrix element implementation is also foreseen for the new release of HERWIG Monte Carlo [9] version HERWIG 6.3[10].

In this paper we present results from the yet another implementation, this time the \(gg,q\bar{q}\to Z/\gamma^{*}b\bar{b}\to\ell\ell b\bar{b}\) massive matrix elements into PYTHIA 6.1 generator. These processes have been implemented as an _external processes_. Massive elements have been coded using MADGRAPH package [11]. The phase space generation approach, as developed in the NEXTCALIBUR[12], has been adopted instead of the PYTHIA original one. In addition, as a benchmark, the original matrix element from [2] for \(gg\to Zb\bar{b}\to\ell\ell b\bar{b}\) has also been implemented (code extracted from PYTHIA 5.7) and completed by including full \(Z/\gamma^{*}\) exchange. Correctness of these new implementations have been verified by reproducing total cross-section and the key differential distributions from [2].

This paper is organised as follows: In Section 2 we summarise results for the 14 TeV pp collision, obtained with \(gg,q\bar{q}\to Z/\gamma^{*}b\bar{b}\) matrix element implemented to PYTHIA 6.1. In Section 3 numerical comparisons for several differential distributions as published in [2] are presented. Section 4 is devoted to the description of the phase-space generation, and Section 5 gives technical details how to use this implementation. In appendices the discussion on the comparison with results published in [5] is presented.

## 2 The \(gg,q\bar{q}\to Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) processes

The process \(gg,q\bar{q}\to Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) has been simulated for pp collision with 14 TeV centre-of-mass energy using massive matrix elements implemented to PYTHIA 6.1 (see Section 4 and 5).

For the dominant \(gg\to Z/\gamma^{*}b\bar{b}\) subprocess two implementations are available. The original matrix element from [2] has been completed by the full \(Z/\gamma^{*}\) exchange, following formulas developed in [3]. Independently, the MADGRAPH package has been also used to derive formulas for the \(gg\to Z/\gamma^{*}b\bar{b}\) and \(q\bar{q}\to Z/\gamma^{*}b\bar{b}\) subprocesses. These matrix elements take into account spin correlations in the Z-boson decay and angular correlations between leptons and quarks. Thanks to keeping non-zero b-quark masses the amplitude has no singularities; the total cross-section is well defined.

The full \(Z/\gamma^{*}\) exchange is important. For events well below the Z-boson resonance the contribution from \(\gamma^{*}\) becomes dominant; the \(\gamma^{*}\) contribution is also sizeable in the high mass tail and increases with increasing the effective mass of the di-lepton system. The total cross-sections, including the branching ratio for \(Z/\gamma^{*}\to\ell\ell\) (single flavour) are given in Table 1 for different di-lepton mass windows. The relative contribution from \(\gamma^{*}\) exchange (pure \(\gamma^{*}\) and \(Z/\gamma^{*}\) interference) is of 20% for \(m_{\,\ell\ell}\ =\ 150\ \pm\ 10\) GeV and 40% for \(m_{\,\ell\ell}\ =\ 300\ \pm\ 10\) GeV. These two last mass points were chosen as representative ones for the MSSM Higgs boson search in the \(bbH/bbA\) production with \(H/A\to\tau\tau,\mu\mu\) decay modes. The contribution from the \(q\bar{q}\to Z/\gamma^{*}b\bar{b}\) subprocess is 17% of the \(gg\to Z/\gamma^{*}b\bar{b}\) one for events on the Z-boson peak. This proportion increases above the peak and is almost 120% for the \(m_{\,\ell\ell}\ =\ 300\ \pm\ 10\) GeV. The total \(\sigma\times BR\) with pure Z-boson exchange with single flavour leptonic decay is 22.1 pb \(gg\) fusion and 3.8 pb for \(q\bar{q}\) annihilation.

For further comparisons full hadronic activity in the event generation, the initial and final state radiation and hadronisation, was switched on, with \(e^{+}e^{-}\) pair being chosen as the final state leptons originating in \(Z/\gamma^{*}\) decay. The \(gg\to Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) and \(q\bar{q}\to Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) are generated with a correct mixture. The distributions are shown for three different values of the invariant mass of the di-lepton system \(90\pm 10\) GeV, \(150\pm 10\) GeV and \(300\pm 10\) GeV.

The transverse momenta distribution of the di-lepton pair and of the single lepton are shown in Figure 2. Jacobian peak in the transverse momenta distribution of individual leptons is, as expected, at around half of the invariant mass of the di-lepton system. The transverse momenta of the di-lepton system is peaked above kinematic threshold of the massive b-quark pair production, around 20 GeV, roughly independent of the invariant mass of the di-lepton system.

Figure 3 shows respectively the distributions of the opening angle between leptons and the lepton pseudorapidity. The effect of the Z - polarisation, induced by the coupling to quarks, recently quantified in [13], is included in the matrix element calculations. It leads to the angular distribution being enhanced in the small opening angle configuration. For higher masses of the di-lepton system, the dominant contribution comes from configurations where \(Z/\gamma^{*}\) is produced prevalently at rest, hence outgoing leptons are produced in a back-to-back topology. Suppression of configurations with small opening angle is originating from the effect of the mass of the di-lepton system being high as compared to the available centre-of-mass energy. This is also an effect of the obvious correlations between boost and density distributions of the convoluted structure functions. One canalso realise, that at higher masses contribution with small opening angle is dominated by the \(q\bar{q}\) annihilation process.

Fig. 4 shows these distributions for b-quarks originating from the hard process. The transverse momenta and invariant mass distribution of the b-quark system are shown in Fig. 5. For higher values of the invariant mass of the di-lepton system, distribution of the transverse momenta of individual b-quarks has harder tail, but the peak position is still close to the value of two b-quark masses.

\begin{table}
\begin{tabular}{|c|c|c|} \hline \hline Process & \(\sigma\times BR\) & \(\sigma\times BR\) \\  & with \(\gamma^{*}\) exchange & no \(\gamma^{*}\) exchange \\ \hline \hline  & \multicolumn{2}{|c|}{\(gg\to Z/\gamma^{*}\,bb\)} \\ \hline \(m_{\,\ell\!l}\ \geq\ 60\) GeV & 22.3 pb & 22.1 pb \\ \hline \(m_{\,\ell\!l}\ =\ 90\ \pm\ 10\) GeV & 18.4 pb & 18.4 pb \\ \hline \(m_{\,\ell\!l}\ =\ 150\ \pm\ 10\) GeV & 30.6 fb & 23.9 fb \\ \hline \(m_{\,\ell\!l}\ =\ 300\ \pm\ 10\) GeV & 0.8 fb & 0.5 fb \\ \hline \hline  & \multicolumn{2}{|c|}{\(q\bar{q}\to Z/\gamma^{*}\,bb\)} \\ \hline \(m_{\,\ell\!l}\ \geq\ 60\) GeV & 3.8 pb & 3.8 pb \\ \hline \(m_{\,\ell\!l}\ =\ 90\ \pm\ 10\) GeV & 3.1 pb & 3.1 pb \\ \hline \(m_{\,\ell\!l}\ =\ 150\ \pm\ 10\) GeV & 13.4 fb & 7.4 fb \\ \hline \(m_{\,\ell\!l}\ =\ 300\ \pm\ 10\) GeV & 0.9 fb & 0.5 fb \\ \hline \hline \end{tabular}
\end{table}
Table 1: _Production cross-sections for the \(gg\), \(q\bar{q}\to Z/\gamma^{*}\,b\bar{b}\) with \(Z/\gamma^{*}\to e^{+}\ e^{-}\) decay (single flavour). The 14 TeV centre-of-mass energy and CTEQ5L structure functions were used for the simulation, the initial and final state radiation was modeled by PYTHIA 6.1._Figure 1: _The transverse momenta distribution of the leptonic pair (left-side), and of individual leptons (right-side) for the mass of the leptonic system being respectively \(90\pm 10\) GeV (top), \(150\pm 10\) (middle) and \(300\pm 10\) GeV (bottom)._

Figure 2: _The opening angle for the lepton system (left-side) and pseudorapidity of the individual leptons (right-side) distributions for the mass of the leptonic system being respectively \(90\pm 10\) GeV (top), \(150\pm 10\) (middle) and \(300\pm 10\) GeV (bottom)._

Figure 3: _The transverse momenta (left-side) and pseudorapidity (right-side) distributions of the individual b-quarks for the mass of the leptonic system being respectively \(90\pm 10\) GeV (top), \(150\pm 10\) (middle) and \(300\pm 10\) GeV (bottom)._

Figure 4: _The invariant mass (left-side) and transverse momenta (right-side) distributions of the b-quark system, for the mass of the leptonic system being respectively \(90\pm 10\) GeV (top), \(150\pm 10\) (middle) and \(300\pm 10\) GeV (bottom)._

An important point to notice here is the difference in the differential distributions between \(gg\to Z/\gamma^{*}b\bar{b}\) and \(q\bar{q}\to Z/\gamma^{*}b\bar{b}\) events, the most outstanding ones being the \(m_{bb}\) distribution and \(R_{bb}\) cone separation between two b-quarks. As the contribution from the \(q\bar{q}\) initial state is small at LHC at the \(Z\)-boson peak and is only rising gradually at higher invariant masses of the di-lepton system, shape of these distributions is dominated by the topology of the \(gg\to Z/\gamma^{*}b\bar{b}\) events. Quite different situation could be expected for the case of the proton-antiproton collision at Tevatron, where contribution from the \(q\bar{q}\) initial state is strongly enhanced.

Figure 5: _The invariant mass (left-side) and cone separation (right-side) distributions of the b-quark system, for the \(gg\to Z/\gamma^{*}b\bar{b}\) (top) and \(q\bar{q}\to Z/\gamma^{*}b\bar{b}\) events with the on-shell \(Z\)-boson._

Table 2 summarises cross-sections and acceptances for leptons and b-quarks being within standard trigger/fiducial cuts of the ATLAS detector at LHC. Only in 10-20% of events both leptons and both b-quarks fall within the acceptance reach. This number is further reduced by the lepton an jets reconstruction as well as identification efficiencies. Consequently, only a few percent of \(gg,q\bar{q}\to Z/\gamma^{*}(\to\ell\ell)b\bar{b}\) events will be reconstructed as \(\ell\ell b\bar{b}\) events. This acceptance is rather low, eg. almost factor four smaller than for the \(ZH,H\to b\bar{b}\) events with \(m_{\,H}~{}=~{}100\) GeV, see [14].

## 3 Comparison with results published in [2]

The matrix element for the \(gg\to Zb\bar{b}\) process [2], as available in PYTHIA 5.7 Monte Carlo [6], has been extracted and interfaced to the dedicated phase space generator based on the algorithms developed in NEXTCALIBUR[12]. The available code of the matrix element is calculated for massive b-quarks and \(Z\)-boson decay into pair of (massless) leptons. The contribution from the exchange of the virtual photon and \(Z/\gamma^{*}\) interference has originally not been included.

Below, a few distributions, as originally published in [2] using \(gg\to Zb\bar{b}\) matrix element interfaced with EUROJET Monte Carlo [4], are compared with the ones obtained by using the present implementation of the same matrix element. For this comparison the EHQL1 structure functions have been used and simulation was performed for 16 TeV proton-proton collision, as in [2]. The most relevant kinematic quantities: transverse momenta of the \(Z\) boson (Fig. 6), leptons from \(Z\)-boson decay (Fig. 7) and b-quarks (Fig. 8) and an opening angle between leptons from \(Z\)-boson decay (Fig. 9) are presented. A very good agreement in the shape is observed between old results and this implementation. Also full consistency with previous results [2] is obtained for the total integrated cross-section estimated as 29 pb for \(gg\to Zb\bar{b}\) with \(Z\to\ell\ell\) decay (single flavour), 16 TeV centre-of-mass energy and EHQL1 structure functions.

Figure 6: _The transverse momentum distribution of the \(Z^{0}\): left plot as published in [2] (plot scanned); right plot as obtained from this implementation._

Figure 7: _The transverse momentum distribution of the lepton from \(Z^{0}\) boson decay: left plot as published in [2] (plot scanned); right plot as obtained from this implementation._

Figure 8: _The lepton from Z-boson decay opening angle, left plot as published in [2] (plot scanned); right plot as obtained from this implementation._

Figure 9: _The b-quark transverse momentum distribution, left plot as published in [2] (plot scanned); right plot as obtained from this implementation._

## 4 Phase-space generation

The Feynman diagrams contributing to the \(gg,q\bar{q}\to Z/\gamma^{\ast}b\bar{b}\) production are shown in Figure 10. The dominant contribution comes from the (2) and (6) configurations for the processes with \(gg\) initial state and the double conversion configuration (2),(4) for the ones with \(q\bar{q}\) initial state.

The phase space generation was modeled using the importance sampling technique, whereby the implemented algorithms were inspired by the approach used in the \(e^{+}e^{-}\) event generators FERMISV[15], EXCALIBUR[16] and NEXICALIBUR[12]. In the given implementation, the phase space for the two processes was generated using altogether ten different kinematic diagrams (_channels_), each channel attempting to mimic a specific topology of a separate set of Feynman diagrams. The relative weight between contributions of each sampling channel was then obtained using multi-channel self-optimising approach [17].

The applied procedure can briefly be outlined on the example of the \(gg\to Z/\gamma^{\ast}b\bar{b}\)process: Writing down the differential of the total cross-section, one obtains:

\[d\sigma=f(x_{1},Q^{2})f(x_{2},Q^{2})\frac{|{\cal M}|^{2}}{(2\pi)^{8}(2\hat{s})} dx_{1}dx_{2}d\bar{\Phi}, \tag{1}\]

where \(f(x,Q^{2})\) represent the gluon structure functions, \(|{\cal M}|^{2}\) the squared matrix element divided by the flux factor \(2\hat{s}\) with \(\hat{s}=x_{1}\,x_{2}\)\(s\), as the effective centre-of-mass energy and \(d\bar{\Phi}\) denoting the phase space differential of the four final-state particles:

\[d\bar{\Phi}=\left(\prod_{i=1}^{4}d^{4}p_{i}\delta(p_{i}^{2}-m_{i}^{2})\theta(p_ {i}^{0})\right)\,\delta^{4}(q_{1}+q_{2}-\sum_{i=1}^{4}p_{i}). \tag{2}\]

In the given equation the \(p_{i}\) and \(m_{i}\) represent the four-momenta and masses of the final state particles and \(q_{1},q_{2}\) the four-momenta of the incident gluons. The matrix element used in the calculation depends explicitly on the four-momenta of the incoming gluons and outgoing fermions,

\[{\cal M}={\cal M}(q_{1},q_{2},p_{1},p_{2},p_{3},p_{4}) \tag{3}\]

therefore all the four-momenta have to be explicitly generated. The matrix element exhibits strong peaking structures in various collinear configurations of momenta3, thus isotropic generation of the four-momenta using e.g. the RAMBO ([18]) would prove to be very inefficient. Instead, one rather resorts to importance sampling, i.e. one introduces an analytically integrable function \(g(\bar{\Phi})\), which aims to approximate the peaking behaviour of the differential term of Eq.2:

Footnote 3: There are no actual collinear singularities present due to the massive treatment of the final state b-quarks, c.f. \(|2|\)

\[d\sigma=s(\bar{\Phi})d\bar{\Phi}=\frac{s(\bar{\Phi})}{g(\bar{\Phi})}\cdot g( \bar{\Phi})d\bar{\Phi}=w(\bar{\Phi})d\bar{\Phi}, \tag{4}\]

Figure 11: _Channel_\({\bf I}\), _used for generation of the four momenta according to the event topology introduced by the Feynman diagrams (4), (8), (10) and (12) in Fig. 10_.

whereby the function \(g(\vec{\Phi})\) has to be unitary, i.e. a normalised probability density:

\[\int g(\vec{\Phi})d\vec{\Phi}=1. \tag{5}\]

In order to better describe the peaking behaviour of \(s(\vec{\Phi})\), the function \(g(\vec{\Phi})\) is composed as a weighted sum of several channels \(g_{i}(\vec{\Phi})\). each adapted to a certain event topology:

\[\int g(\vec{\Phi})=\sum_{i}\,\alpha_{i}\cdot g_{i}(\vec{\Phi}), \tag{6}\]

and the values of relative weights \(\alpha_{i}\) are determined from multi-channel self-optimisation procedure in order to minimise the variance of the weights \(w(\vec{\Phi})\)[17]. The phase space points are than sampled from the function \(g(\vec{\Phi})\), first by randomly choosing a channel \(i\) according to the relative frequencies \(\alpha_{i}\) and then deriving the required four momenta from the chosen \(g_{i}(\vec{\Phi})\) using unitary algorithms.

Turning back to the specific issue at hand, the procedure goes as follows: First a channel \({\bf I}\) is chosen using the set of \(\alpha_{i}\). In order to use the Pythia built-in structure functions \(xf(x,Q^{2})\), one has to rewrite the cross-section differential to the form:

\[d\sigma=x_{1}f(x_{1},Q^{2})\,x_{2}f(x_{2},Q^{2})\frac{|{\cal M}|^{2}}{(2\pi)^{ 8}(2s)}dy\frac{d\tau}{\tau^{2}}d\vec{\Phi}, \tag{7}\]

with the two new variables given by \(\tau=x_{1}\cdot x_{2}\) and \(y=0.5\log(x_{1}/x_{2})\). The event generation procedure then starts by sampling the values of \(\tau\) from a distribution:

\[\frac{1}{(\tau)^{\mu}}\hskip 28.452756pt\mu=1.5, \tag{8}\]

and \(y\) from:

\[\frac{1}{\cosh(\nu y)}\hskip 28.452756pt\nu=0.8, \tag{9}\]

much in the spirit of PYTHIA[6]. From the two values \(x_{1}\) and \(x_{2}\) and the momenta \(q_{1},q_{2}\) of incoming gluons are derived. Next, let one assume that the chosen channel \({\bf I}\) aims to approximate the event topology introduced by the Feynman diagrams (4), (8), (10) and (12) in Fig. 10.

Consequently, the event from the channel \({\bf I}\) is constructed using the following eight independent kinematic variables (c.f. Fig. 11):

* \(s^{*}_{Z}\), the square of the mass of the off-shell \(Z\) boson,
* \((\theta^{*}_{Z},\phi^{*}_{Z})\), the polar angles of the produced \(Z\) boson in the centre-of-mass frame of the off-shell \(b^{*}\) quark,
* \((\theta^{*}_{l},\phi^{*}_{l})\), the decay angles of the leptons in the centre-of-mass frame of the decaying \(Z\) boson,
* \(s^{*}_{b}\), the square of the mass of the off-shell \(b\) quark,
* \((\theta^{*}_{b},\phi^{*}_{b})\), the production angles of the \(b\) and \(b^{*}\) quarks in the centre-of-mass frame of the incoming gluons.

Only some of the listed variables are expected to exhibit a peaking structure in the values of the matrix element, namely the \(s_{Z}^{*}\) and \(s_{b}^{*}\), because of appearing in the propagators of the matrix element and the \(\theta_{b}^{*}\), since the subprocess \(gg\to bb^{*}\) has the intrinsic topology of a t-channel exchange. Accordingly, in the channel algorithm, the \(s_{Z}^{*}\) is generated according to a Breit-Wigner function:

\[\frac{1}{(s_{Z}^{*}-M_{Z})^{2}+M_{Z}^{2}\Gamma_{Z}^{2}} \tag{10}\]

the \(s_{b}^{*}\) is assumed to have an

\[\frac{1}{(s_{b}^{*})^{\mu}}\hskip 28.452756pt\mu=1.3 \tag{11}\]

distribution and the cosine of the \(\theta_{b}^{*}\) is sampled from the distribution:

\[\frac{1}{(A-\cos\theta_{b}^{*})^{\nu}}\hskip 28.452756pt\nu\sim 1, \tag{12}\]

where \(A\) is a function of the invariant masses of the sub-system and the particles involved in the scattering. All the other quantities are sampled from flat distribution in the kinematically allowed phase space limits. Subsequently, the four-momenta constructed from the obtained set of quantities are used in the matrix element calculation. Each event is further weighted by the appropriate phase space weight corresponding to the importance sampling procedure and calculated using the unitary algorithms; for further details on the applied method and unitary algorithms the reader is referred to the literature (e.g. [15, 12]). A description of an additional (double conversion) kinematic channel, used for modeling the \(q\bar{q}\to Z/\gamma^{*}b\bar{b}\) process is given in [20]. Some comparisons between the sampling distributions and the calculated differential cross-section distributions for the channel **I** are shown in Figure 12.

At this point one can also mention that the channels corresponding to the \(\gamma^{*}\) exchange are identical to the ones used for \(Z\)-boson radiation except that the square of invariant mass \(s_{\gamma}^{*}\) is in this case sampled from a distribution:

\[\frac{1}{(s_{\gamma}^{*})^{\mu}}\hskip 28.452756pt\mu=1.4 \tag{13}\]

and the (expected) predominantly forward direction of the radiated photon is taken into account by sampling the \(\gamma^{*}\) production angle \(\theta_{\gamma}^{*}\) from a distribution analogous to the one of Equation 12.

In simulation of the \(q\bar{q}\to Z/\gamma^{*}b\bar{b}\) process there is an additional complication, since one has to pick the flavour of the incoming quark-antiquark pair. The selection is again done using importance sampling, using as sampling weights:

\[\lambda_{i}=|Mq_{i},q_{i}|^{2}\cdot x_{1}f_{q_{i}}(x_{1},Q^{2})\cdot x_{2}f_{ \overline{q}_{i}}(x_{2},Q^{2}), \tag{14}\]

where the index \(i\) runs over all possible quark-antiquark combinations. The Matrix element \(|Mq_{i},q_{i}|^{2}\) of the hard scattering process has to be included in the weights since the boson-quark couplings depend on the weak isospin of the quark. Due to the fact that the incoming quarks are treated as massless one has to compute only the up-like and down-like matrix element values which helps reducing the computation time. Only four flavours \((u,d,s,c)\) of the incoming quarks are considered at the moment, the contributions of the incoming \(b\) quark pair are excluded from calculation thanks to very high suppression of the structure functions.

The generated events are then passed to PYTHIA 6.1 event generator, where the fragmentation and hadronisation procedures, as well as the ISR and FSR are added and unweighted events are produced. The efficiency for generating unweighted events, using the implementation of the phase-space generation presented above, amounts to about 10%. The energy scale used for this process is equal to \(m_{Z}^{2}\).

Figure 12: _Comparison of the (normalised) distributions of differential cross-section for the process \(gg\to Zb\bar{b}\) (dashdash) and sampling distributions in channel \(\mathbf{I}\) (solid line) with respect to the variables that are supposed to exhibit the strongest peaking behaviour._

Technical details on implementation in PYTHIA 6.1

The described implementation of the library for calculating the \(gg,q\bar{q}\to Z/\gamma^{*}b\bar{b}\) matrix elements and generating phase space is interfaced with PYTHIA 6.1 in the manner prescribed in [6] for _external processes_ implementation. Most of the procedure is identical to the implementation of the process \(gg\to Zb\bar{b}\) in PYTHIA 5.7 (e.g. colour flow..) with a couple of additional features:

* The \(Z/\gamma^{*}\) exchange can be set with switches as for the Drell-Yan process.
* All \(Z\) leptonic decay modes are allowed, please take note that when using the ME calculation of [2], denoted as (KL) (see 1SUB=431) the massless formulas are used for \(Z\)-boson decay, whereas the on-shell four-momenta of the final leptons are obtained by rescaling of the lepton momenta while keeping the \(Z\)-boson four-momentum and the directions of the leptons in the \(Z\)-boson frame constant. This limitation is not present when using the ME computed by MADGRAPH, denoted as (MG) (see 1SUB=432); the implementation of ME from [2] is kept primarily for consistency checks.
* Only the total cross-section of the process is output by PYTHIA, in case specific decay modes of the b-quarks are required the resulting \(\sigma\times BR\) has to be calculated manually, i.e the cross-section has to be calculated consistently by multiplying the total cross-section with the branching ratios of the allowed decay modes as provided in PYTHIA.

The use of the process implementation in one's own program is basically trivial, there are only a couple of extra switches. The general procedure to put the process in one's own script is as follows:

* One has to include the commons: \[\mbox{C zbbar commons}\] DOUBLE PRECISION CMS,XWC \[\mbox{INTEGER VLINIT,NOPTIM,NMAXSTEP,KFL}\] \[\mbox{COMMON/VLTRANS/CMS,ICH,VLINIT,NOPTIM,NMAXSTEP,KFL,XWC}\] \[\mbox{SAVE /VLTRANS/}\] DOUBLE PRECISION VLCMs,VLPHMASS \[\mbox{INTEGER VLHBOOK,VLCOD,VLPHOT}\] \[\mbox{COMMON/VLSETS/VLHBOOK,VLCOD,VLCMS,VLPHOT,VLPHMASS}\] \[\mbox{SAVE /VLSETS/}\]

- c.m.s energy in GeV (DOUBLE PRECISION)}\]
- PYTHIA code of the leptons the \(Z\)-boson is supposed to decay to (11
- electron, 13 muon, 15 tau) (INTEGER)
* the switch that chooses the matrix element with either only the \(Z\) propagator or the full \(Z/\gamma^{*}\) propagator (0
- \(Z\) propagator, 1
- full \(Z/\gamma^{*}\) propagator) (INTEGER)
* the cutoff mass of the off-shell photon in GeV for the full \(Z/\gamma^{*}\) propagator (not relevant in case VLPHOT = 0)

If parameter VLPHOT is set to zero, parameter VLPHMASS is dummy.
* initialisation, =-1
- normal mode =-2 finalisation).

C initialisation call VLINIT = 0  CALL PYUPEV(1SUB,SIGMAX)  VLINIT =-1

C ISUB code 431 for external process g + g to Z b bbar (KL)  CALL PYUPIN(431,'g + g - Z0 b bbar (KL)',SIGMAX)  C ISUB code 432 for external process g + g to Z b bbar (MG)  CALL PYUPIN(432,'g + g - Z0 b bbar (MG)',SIGMAX)  C ISUB code 433 for external process q + qbar to Z b bbar (MG)  CALL PYUPIN(433,'q + qbar - Z0 b bbar (MG)',SIGMAX)  C ISUB code 440 for the correct mixture of external processes  G + g - Z0 b bbar (MG) and q + qbar to Z b bbar (MG)  CALL PYUPIN(432,'g + g - Z0 b bbar (MG)',SIGMAX)  CALL PYUPIN(433,'q + qbar - Z0 b bbar (MG)',SIGMAX)

C... your code, generate events by calling CALL PYEVNT as usual...

C finalisation call VLINIT =-2  CALL PYUPEV(1SUB,SIGMAX)
* Compiling & linking: The external process itself with its routines is compiled in a library libzbbwbb.a with the additional object file vlpyupev.o that has to be linked explicitly to the main program. The other required libraries are the libythia6.a with object files pydat.o and pyr.o and _cernlib_ libraries. An example implementation can be found at ATLAS CVS repository, under offline/atfast/demo/demo-xbb.

* The process is already implemented in the./demo.f, which reads the input card./prod run.dat: 61111 -- RANDOM NUMBER 440 -- KEYPRO 3 -- KEYHAD 7 -- KEYSTR 100000 -- NEVENT 11 -- LEPTON CODE 0 -- FULL Z/GAMMA PROP 10 -- MIN. PHOTON MASS (GeV) The last three switches set the values of VLCOD,VLPHOT and VLPHMASS as described above (note that the cutoff mass has to be given as an **INTEGER** in the script). For the description of other parameters see the provided./README.
* Present features & limitations:
* Only a limited set of the possible thresholds on the invariant mass of the \(Z/\gamma^{*}\) propagator is prepared. Available values4 are: **2, 5, 10, 15, 30, 60, 120, 270, 300*
* and 500 GeV, the cross-sections are specified in Table 3. Note that the values represent a hard-wired option for the event generator; they are _not_ intended to replace the selection cutoffs used in the analyses.
* The standard PYTHIA kinematics settings, CKIN cuts are _not_ implemented.
* The external process is verified to work correctly with the PYTHIA version 6.157.

Footnote 4: In case additional values are needed please contact _Borut.Kersevan@cern.ch_ as it required dedicated optimisation of the generation of the importance sampling.

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline \hline Threshold & \(\sigma\times BR\) & \(\sigma\times BR\) & \(\sigma\times BR\) \\  & \(gg\to Z/\gamma^{*}b\bar{b}\) & \(q\bar{q}\to Z/\gamma^{*}b\bar{b}\) & Total \\ \hline \hline
2 GeV & 36.6 pb & 5.2 pb & 41.8 pb \\ \hline
5 GeV & 29.7 pb & 4.7 pb & 34.4 pb \\ \hline
10 GeV & 26.2 pb & 2.7 pb & 30.5 pb \\ \hline
15 GeV & 25.0 pb & 4.2 pb & 29.2 pb \\ \hline
30 GeV & 23.9 pb & 4.1 pb & 27.9 pb \\ \hline
60 GeV & 22.3 pb & 3.8 pb & 26.0 pb \\ \hline
120 GeV & 170 fb & 80 fb & 250 fb \\ \hline
270 GeV & 4.7 fb & 8.0 fb & 12.7 fb \\ \hline
500 GeV & 0.3 fb & 1.6 fb & 1.9 fb \\ \hline \hline \end{tabular}
\end{table}
Table 3: _The benchmark cross-sections for different thresholds on the invariant mass of the \(Z/\gamma^{*}\) propagator. The 14 TeV centre-of-mass energy, CTEQ5L structure functions and \(Z\to ee\) decay were used for the simulation_.

[MISSING_PAGE_EMPTY:21]

[MISSING_PAGE_EMPTY:22]

* [5] M. Della Negra et al., in [1], page 509.
* [6] T. Sjostrand, Comp. Phys Comm. **82** (1994) 74.
* [7] T. Sjostrand et al.,_High energy physics generation with PYTHIA 6.1_, eprint hep-ph/0010017, LU-TP 00-30, October 2000.
* [8] J. Campbell and R. K. Ellis, Phys. Rev. **D62** (2000) 114012.
* [9] G. Corcella et all. _Herwig 6.2_, preprint hep-ph/0011363.
* [10] B. R. Webber, Presentation during Les Houches Workshop _Physics at TeV Colliders_, Les Houches, May 2001.
* [11] T. Stelzer and W. F. Long, Comput.Phys.Commun. **81** (1994) 357.
* [12] F. A. Berends, C. G. Papadopoulos and R. Pittau, _NEXT CALIBUR: a four fermion generator for electron-positron collision_, hep-ph/0011031.
* [13] T. Pierzchala et all. Acta Phys. Polon. **32** (2001) 1277.
* [14] E. Richter-Was, Acta Phys. Polon. **31** (2000) 1931.
* [15] J. Hilgart, R. Kleiss, F. Le Dibider, Comp. Phys. Comm. **75** (1993) 191.
* [16] F.A. Berends, R. Kleiss, Comput. Phys. Commun. **85** (1996) 11.
* [17] R. Kleiss and R. Pittau, Comput. Phys. Commun. **83** (1994) 141.
* [18] R. Kleiss and W.J. Stirling, Comput. Phys. Commun. **40** (1986) 359.
* [19] ATLAS Collaboration, ATLAS Detector and Physics Performance TDR, ATLAS TDR 15, CERN/LHCC/99-15, 25 May 1999.
* [20] B. Kersevan and E. Richter-Was, _The \(q\bar{q}\to W(\to\ell\nu)g^{*}(\to b\bar{b})\) process: matrix element implementation to PYTHIA 6.1_, ATLAS Physics Communication, ATL-COM-PHYS-2001-013 (2001).

More on differences between PYTHIA57 and PYTHIA61

Before starting to compare present predictions for the \(gg\to Zb\overline{b}\to\ell\ell b\overline{b}\) background to the \(H\to ZZ^{*}\to 4\ell\) observability we investigated to which extend results from [5] can be reproduced with present version of PYTHIA generator.

We start by comparing PYTHIA 5.7 and PYTHIA 6.1 predictions for the same set of the structure functions, EHQL1, and for two different processes \(gb\to Zb\) and \(bb\to Z\). This comparison is summarised in Tables 6 and 7. \(Z\) boson is forced to decay to leptons while semileptonic decay from the hadronic cascade is not forced. In numbers below the \(\sigma\times BR\) represents cross-section after including \(Z\to\ell\ell\) branching ratio (single flavour), and the branching ratio BR=(10.5%)\({}^{2}\) for the double-semileptonic production in the cascade decay. Acceptances are estimated with respect to that value, but absolute value given in bracket are calculated starting from the \(\sigma\times BR\) which includes \(Z\to\ell\ell\) branching ratio (single flavour).

Both, default and modified initialisation of PYTHIA 6.1 has been investigated. This modification is mean to revert back from the improved hadronisation/radiation models of PYTHIA 6.1 to the models used by PYTHIA 5.7. Introduced changes are specified below.

* A modification in the initial-state radiation algorithm to allow a matching to first-order matrix elements for single \(Z\) or \(W\) production, _MSTP(68)= 1_. To revert back to the PYTHIA 5.7 model, value _MSTP(68)= -1_ is used.
* A reduction in the scale of maximum virtuality for initial state radiation based on the scale of the hard process _PARP(67)= 1_. To revert back to the PYTHIA 5.7 model, value _PARP(67)= 4_ is used (set I). As this parameter seems to have significant impact, also value _PARP(67)= 2_ was used (set II). The _PARP(67)_ option is active for \(2\to 2\) type processes, like \(q\bar{q}\to Zg\) and \(gq\to Zq\) production.

With implemented modifications to the default PYTHIA 6.1 setting, agreement on the transverse momenta spectrum for b-quarks with PYTHIA 5.7 is almost recovered, see Figs. 13 and 14. Indeed, the modification in the scale of maximum virtuality, value for _MSTP(68)_, was verified by matching of the inclusive \(W\) spectrum with the Tevatron data. That is why results from default tuning of PYTHIA 6.1 for \(b\overline{b}\to Z\) process should be considered as more correct. In case of the \(g\,b\to Zb\) production, the dependence on the choice of the virtuality scale could be very well attributed as an overall uncertainity of the parton shower approach.

The effect from the structure functions parametrisation themselves on the transverse momenta distribution, shown on Fig. 15 for \(b\overline{b}\to Z\) and \(g\,b\to Zb\) processes, is much smaller.

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline \hline \(Zb\overline{b}\to eeeee\) & PYTHIA 5.7 & PYTHIA 6.1 & PYTHIA 6.1 \\ \(b\overline{b}\to Z\) & (EHQL1 ) & (EHQL1 ) & (EHQL1 ) \\  & default & default & set I \\ \hline \(\sigma\times BR\) [pb] & 0.42 & 0.42 & 0.42 \\ \hline Acceptance & & & \\ \(p_{T}^{e}\ >\) 10 GeV & 1\% & 2.6\% & 1\% \\ and \(|\eta^{e}|\ <\ 3.0\) & (=0.0040 pb) & (=0.0110 pb) & (=0.0044 pb) \\ \hline Acceptance & & & \\ \(p_{T}^{e_{1},e_{2}}>\)20 GeV & 80\% & 72\% & 75\% \\ \(|m_{Z}-m_{12}|\ <\) 10 GeV & (=0.0032 pb) & (=0.0090 pb) & (=0.0033 pb) \\ \hline Acceptance & & & \\ \(m_{34}\ >\) 12 GeV & 53\% & 38\% & 57\% \\  & (=0.0016 pb) & (=0.0034 pb) & (=0.0019 pb) \\ \hline \hline \end{tabular}
\end{table}
Table 4: _Production cross-sections for the \(b\overline{b}\to Z\) with \(Z\to\ell\ell\) decay (single flavour). The 16 TeV centre-of-mass energy and effective BR=10.5% was assumed for \(b\to\)cev decay. The EHQL1 structure functions were used for this comparison. The following parameters were reset: (default) MSTP(68)= 1; (set I) MSTP(68)=-1;_

Figure 13: _The hardest and the softest b-quark in the partonic cascade from \(b\overline{b}\to Z\) production. Solid line is for PYTHIA57 (EHQL1), dots for PYTHIA 6.1 (EHQL1) (default setting). Dashed line is for tuned version of PYTHIA 6.1 (EHQL1), (set I)._

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline \hline \(Z\,bb\to eeee\) & PYTHIA 5.7 & PYTHIA 6.1 & PYTHIA 6.1 & PYTHIA 6.1 \\ \(g\,b\to Zb\) & (default) & (default) & (set I) & (set II) \\ \(p_{T}^{Z}\ >\ 10\ GeV\) & & & & \\ \hline \(\sigma\times BR\) [pb] & 0.45 & 0.45 & 0.45 & 0.45 \\ \hline Acceptance & & & & \\ \(p_{T}^{e}\ >\ 10\ GeV\) & 5\% & 3\% & 7.5\% & 4.4\% \\ and \(|\eta^{e}|\ <\ 3.0\) & (=0.028 pb) & (=0.013 pb) & (=0.034 pb) & (=0.024 pb) \\ \hline Acceptance & & & & \\ \(p_{T}^{e_{1},e_{2}}>\)20 GeV & 72\% & 77\% & 80\% & 75\% \\ \(|m_{Z}-m_{\,12}|\ <\ 10\ GeV\) & (=0.022 pb ) & (=0.010 pb) & (=0.027 pb) & (=0.018 pb) \\ \hline Acceptance & & & & \\ \(m_{34}\ >\ 12\ GeV\) & 50\% & 30\% & 48\% & 44\% \\  & (=0.012 pb ) & (=0.003 pb) & (=0.013 pb) & (=0.008 pb) \\ \hline \hline \end{tabular}
\end{table}
Table 5: _Production cross-sections for the \(gb\to Zb\) with \(Z\to\ell\ell\) decay (single flavour). The 16 TeV centre-of-mass energy and effective BR=10.5% was assumed per \(b\to ce\nu\) decay. The EHQLI structure functions were used for this comparison. The following parameters were reset: (default) PARP(67)=1; (set I) PARP(67)=4; (set II) PARP(67)=2;_Figure 14: _The hardest and the softest b-quark in the partonic cascade for the \(g\,b\to Zb\) production. Solid line is for PYTHIA 5.7 (EHQL1), dots for PYTHIA 6.1 (EHQL1) (default setting). Dashed line is for tuned version of PYTHIA 6.1 (EHQL1). Top plot for (set I), bottom plot for (set II)._

Figure 15: _The hardest and the softest b-quark in the partonic cascade for the \(gb\to Zb\) (top) and \(b\overline{b}\to Z\) (bottom) production. Solid line is for PYTHIA 5.7 (EHQL1), dashed for PYTHIA 6.1 (EHQL1) and dots for PYTHIA 6.1 (CTEQ5L)._

Comparison with results published in [5]

For the comparison discussed here implementation of the ME for \(gg\to Zb\overline{b}\) (KL) into PYTHIA 6.1. The Peterson fragmentation function for b-quarks and specified structure functions and 16 TeV centre-of-mass energy are used. As the implemented matrix element is calculated for massive b-quarks there is no singular behavior for the small transfer in the t-channel, just there is no need to set any threshold here. As it could be deduced from Table 3 of [5] eg. the threshold \(p_{T}^{b\overline{b}}\ >\ 10\)_GeV_ applied at generation for \(g\,b\to Zb\) would significantly bias final results of expected background events.

Table 6 shows comparison between acceptances and cross-section obtained with this implementation and that published in [5]. The very basic selection, as it has been foreseen for the \(H\to ZZ^{*}\to 4\ell\) channel is applied. The very similar selection criteria are in fact used presently, eg. see respective analysis discussed in [19]. The total cross-section with EHQL1 structure functions is 29 pb. For the present analysis, branching ratio 10.5% for \(b\to e\nu c\) is used for calculating \(\sigma\times BR\) = 0.32 pb.

Discussed in previous section different settings for PYTHIA 6.1 are not having in fact effect on the b-quark and leptonic spectra from the \(gg\to Zb\overline{b}\) process, as both b-quarks are directly originating from hard scattering. In fact, the results from [5] are not reproduced better than within factor 2 - 3 (see Table 6.

\begin{table}
\begin{tabular}{|c|c|c|} \hline \hline \(gg\to Zbb\to eeee\) & PYTHIA 5.4 & PYTHIA 6.1 \\ ME & (EHQL1) & (EHQL1) \\  & from Table 3 of [5] & default \\ \hline \(\sigma\times BR\) [pb] & 0.39 & 0.32 \\ \hline Acceptance & & \\ \(p_{T}^{e}\ >\ 10\) GeV & 10\% & 4.3\% \\ \(|\eta^{e}|\ <\ 3.0\) & (=0.039 pb) & (=0.014 pb) \\ \hline Acceptance & & \\ \(p_{T}^{e_{1},e_{2}}>\)20 GeV & 80\% & 77\% \\ \(|m_{Z}-m_{12}|\ <\ 10\) GeV & (=0.031 pb) & (=0.011 pb) \\ \hline Acceptance & & \\ \(m_{34}\ >\ 12\) GeV & 60\% & 45\% \\  & (=0.019 pb) & (=0.005 pb) \\ \hline \hline \end{tabular}
\end{table}
Table 6: _Production cross-sections for the \(gg\to Zb\overline{b}\) with \(Z\to\ell\ell\) decay (single flavour). The 16 TeV centre-of-mass energy and specified structure functions were used for the simulation. Branching ratio 10.5% for \(b\to e\nu c\) is used for calculating \(\sigma\times BR\) for Pythia 6.1. Acceptances for Pythia 6.1 results are calculated with respect to \(\sigma\times BR\) while absolute cross-sections are derived from total cross-section of \(\sigma\ =\ 29\) pb._Fig. 16 show the transverse momenta distribution of the b-quarks as obtained with implementation discussed here. For comparison the scanned plots of the distributions published in [5] are also included.

For completeness, comparison with results published in [5] for the \(bb\to Z\) and \(gb\to Zb\) processes and the consistent with PYTHIA 5.7 choice of the PYTHIA 6.1 tuning, is summarised in Tables 7 and 8. Here reproductability of the results from [5] is much better and origin of remaining discrepancies are much better understood.

One of the remaining discrepancy, in fact not traceable after that many years since [5] was published, is systematicaly lower acceptance of the \(m_{34}\) selection.

Figure 16: The transverse momentum distribution of the b-quarks and the corresponding spectra of the leptons of the first-generation decay of the considered b-quark: left plot as published in [5]; right plot as obtained from this implementation with default PYTHIA 6.1.

\begin{table}
\begin{tabular}{|c|c|c|} \hline \hline \(Zbb\to eeee\) & PYTHIA 5.4 & PYTHIA 6.1 \\ \(gb\to Zb\) & (EHQL1) & (EHQL1) \\ \(p_{T}^{Z}~{}>~{}10~{}GeV\) & from Table 3 of [5] & set II \\ \hline \(\sigma\times BR\) [pb] & 0.48 & 0.45 \\ \hline Acceptance & & \\ \(p_{T}^{e}~{}>10\) GeV & 5\% & 4.4\% \\ and \(|\eta^{e}|~{}<~{}3.0\) & (=0.024 pb) & (=0.024 pb) \\ \hline Acceptance & & \\ \(p_{T}^{e_{1},e_{2}}>\)20 GeV & 77\% & 75\% \\ \(|m_{Z}-m_{12}|~{}<10\) GeV & (=0.018 pb) & (=0.018 pb) \\ \hline Acceptance & & \\ \(m_{34}~{}>12\) GeV & 72\% & 44\% \\  & (=0.013 pb) & (=0.008 pb) \\ \hline \hline \end{tabular}
\end{table}
Table 7: _Production cross-sections for the \(gb\to Zb\) with \(Z\to\ell\ell\) decay (single flavour). The 16 TeV centre-of-mass energy and effective BR=10.5% was assumed for \(b\to cev\) decay._

\begin{table}
\begin{tabular}{|c|c|c|} \hline \hline \(Zbb\to eeee\) & PYTHIA 5.4 & PYTHIA 6.1 \\ \(b\overline{b}\to Z\) & (EHQL1) & (EHQL1) \\  & from Table 3 of [5] & set I \\ \hline \(\sigma\times BR\) [pb] & 0.43 & 0.42 \\ \hline Acceptance & & \\ \(p_{T}^{e}~{}>10\) GeV & 1\% & 1\% \\ and \(|\eta^{e}|~{}<~{}3.0\) & (=0.0043 pb) & (=0.0044 pb) \\ \hline Acceptance & & \\ \(p_{T}^{e_{1},e_{2}}>\)20 GeV & 78\% & 75\% \\ \(|m_{Z}-m_{12}|~{}<10\) GeV & (=0.0033 pb) & (=0.0033 pb) \\ \hline Acceptance & & \\ \(m_{34}~{}>12\) GeV & 81\% & 57\% \\  & (=0.0027 pb) & (=0.0019 pb) \\ \hline \hline \end{tabular}
\end{table}
Table 8: _Production cross-sections for the \(b\overline{b}\to Z\) with \(Z\to\ell\ell\) decay (single flavour). The 16 TeV centre-of-mass energy and effective BR=10.5% was assumed for \(b\to cev\) decay._