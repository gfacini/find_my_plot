# A CMOS Current Preamplifier and Shaper With 50\(\Omega\) Line Driver for Liquid Argon Preshower

D. Dzahini, B. Guerre-Chaley, J. Pouxe, O. Rossetto

Presented at the " IEEE 1994 Nuclear Science Symposium and Medical Imaging Conference" Norfolk, Virginia, October 30 - November 5, 1994. Published in EEE Transactions on Nuclear Science" vol.42,No.4 August 95

# A CMOS Current Preamplifier and Shaper with 50\(\Omega\) Line Driver for Liquid Argon Preshower

D. Dzahini, B. Guerre-Chaley, J. Pouxe, O. Rossetto

Institut des Sciences Nucleaires, IN2P3-CNRS, UJF Grenoble France

###### Abstract

In the field of liquid argon calorimetry for the LHC detector program, a CMOS "current conveyor" preamplifier was developed for a cold preshower. It is an improved version of the ICON circuit which had been formerly designed by the RD2 collaboration. This paper also presents a CMOS linear output buffer, featuring a dynamic range close to \(\pm\)2V on a 50\(\Omega\) load, for a 21 mW power dissipation at 77K. Futhermore a biquadratic 7 MHz bandpass filter was developed, based on a high speed rail to rail CMOS operational amplifier. It is meant to be the filter placed at the output of the ICON preamplifier.

## I Introduction

A CMOS current conveyor has several benefits for a liquid Argon preshower : the power dissipation (1mW), the peaking time (10 ns) and the possibility to integrate this preamplifier with analog multiplexer or pipeline to minimize the cable lenght [1][2].

The circuits have to be placed near the detector and then at cryogenic temperature. This is a challenge for CMOS circuit design, but it offers some advantages due to improved device performance. Low field mobilities are increased by a factor four, providing a corresponding increase in the transistor transconductance and circuit speed or a reduction in the power dissipation. Since the parasitic bipolar transistor current gain decreases at low temperature, the latch-up effect is reduced. Regarding the noise : the channel thermal noise decreases ; but 1/f noise dependence on temperature is different for N and P devices. It decreases with temperature for NMOST while the opposite behaviour is observed for PMOST [3].

However, we point out that the influence of this 1/f noise is limited to low frequencies [4]. For the total integrated noise in the preamplifier bandwidth, the 1/f noise is less important than the channel thermal one.

In this paper, we present the performance obtained with CMOS technology at cryogenic temperature for analog front end circuits : this includes a preamplifier, a 50 \(\Omega\) driver and a filter based on a fully differential operational amplifier.

## II The Preamplifier Principle

The schematic diagram of the preamplifier is shown in figure1. The parallel noise is the main problem as it has been published before [1], it is dominated by the channel noise of both mirror transistors (QP2, QP3) and (QN2, QN3).

To decrease the noise we added some degeneration transistors to the current mirrors to reduce respectively the equivalent transconductance Gm for each transistor. Gm could be related to gm as Gm = \(\frac{\text{gm}}{\text{(1+\frac{\text{gm}}{\text{gmd}})}}\)[5] where gm\({}_{\text{d}}\) is the transconductance of the diode connected degeneration transistor. If we consider the PMOS mirror, its noise contribution can be written :

\(\text{i}_{\text{n}}\)= 4 k T \(\xi\)(n Gm\({}_{\text{2}}\)) + \(\frac{\text{Gm}_{\text{2}}}{\text{Gm}_{\text{3}}}\) 2 4 k T \(\xi\) Gm\({}_{\text{3}}\)

Where \(\xi\) is the noise factor situated between 0.67\(<\xi<\)1 [4] and n a slope factor related to the body effect transconductance GmbH as : Gm + Gmb = n Gm [6]. Simulation results give n=1.1 and make negligible the bulk noise contribution.

In the same way the mirror ratio Gm\({}_{\text{3}}\)/Gm\({}_{\text{2}}\) was increased following the channel width ratio. Notice that these modifications reduce the speed of the preamplifier due to the total parasitic capacitance at the current mirror node.

The series noise is not the major problem in our application because the typical detector capacitance is only 20pF. However, by ac ground connecting the gate of the input transistors with CN and CP, the bias stage noise contribution is reduced and series noise slope decreases from 65e'rms/pF to 47e'rms/pF according to the simulations.

## III CMOS 50\(\Omega\) Line Driver

Along with fast preamplifier development, high performance analog interface blocks are required, which can operate with the same low supply voltage as the preamplifier.

High linearity at high frequencies is the main difficulty of this design. For large swing applications one has no choice than to use common source transistors at the output. A complementary class AB large swing CMOS output buffer has been developed, intented for preamplifier interface with the measurement room. It employs the pseudo source follower principle shown in figure 2.

Fig 1: Schematic diagram of the preamplifierIt is composed of a pair of common source transistors and a pair of complementary error amplifiers. The output transistors are included in a negative feedback loop and driven by the error amplifiers [7][8][9].

One major drawback of this structure is the sensitivity of the quiescent current and consequently the power dissipation to the offset voltage of the error amplifiers.

Suppose the output transistor QP in the saturation range :

ID(QP) = \(\beta\) (Vgs- Vt)\({}^{2}\) where \(\beta\) depends on the technology and the channel size.

\(\frac{\Delta\mathrm{ID}}{\mathrm{ID}}=\frac{2\,\mathrm{AEP}\,\mathrm{Voffset}}{ \mathrm{(Vgs-Vt)}}\)AEP is the error amplifier open loop gain.

To keep the quiescent current variation reasonably low we must choose a low value for the gain AEP. But a limit for deacreasing this gain is the closed loop nonlinearity due to the output device distortion. The compromise value used in our design is \(\mathrm{AEP}=\mathrm{AEN}=18\) dB. In order to maintain a large linearity range wemake use of large size for the output devices, especially for the PMOST : W = 800 \(\mathrm{\SIUnitSymbolMicro m}\).

The figure 3 shows the complete line driver schematic. Transistors Q56, Q56, Q65 and Q66 have long channels intented to decrease the open loop gain.

This design was implemented in DMILL technology (Durci Mixte sur Isolant Logico-Lineaire) [10] and its transient response measured with a 50 \(\Omega\) load is shown in figure 4. Figure 5 shows the nonlinearity curve.

Other performances of this driver in the cold (77K) are as follows :

power supply = \(\pm\)3V

power dissipation = 10 mW

bandwidth = 30 MHz

output resistance = 4 \(\Omega\)

slew rate = 330 V / \(\mathrm{\SIUnitSymbolMicro s}\)

Fig 4: Driver transient response to a step at 77K

Fig 3: Complete line driver schematic

Fig 2: Principle of the line driver Compensation capacitors C1 and C2 create dominant poles with the error amplifiers output resistances in order to improve the phase margin.

## IV CMOS preamplifier with a 50 \(\Omega\) line driver testing results

The current preamplifier shown in part 2 was integrated with the line driver in two different CMOS technologies from METEC and AMS. 512 channels of the MIAETEC version were utilized to equip 4 preshower modules. Their outputs were integrated by 40 ns gated integrators and digitized by 12-bits ADC's. The muon signal obtained is plotted on figure 6 and compared with the noise fitted as a gaussian. It was reconstructed by adding the contributions of two adjacent cells. The active liquid argon gap was 10 mm [11]. One can see a good performance with respect to the signal to noise ratio (4.3), however the peaking time measured for the impulse response was only 40ns.

The speed was the main performance we tried to improve when designing another version of the circuit in AMS technology. A great care was taken about parasitic capacitors. Figure 7 shows the impulse response obtained with the AMS version at 77K, one can see that the rise time is 10 ns.The equivalent noise charge measured without any shaping was \(2400+30\) electrons rms / pF.

The noise can be computed as an equivalent input noise calibrated with the triangular input current amplitude ; this is called ENI (Equivalent Noise Current), and is shown in figure 8 according to the shaping time of a CR-RC2 filter.

The gain calibrated with a triangular current pulse was 67mV/\(\mu\)A.

The power dissipation depends on the bias voltage of the buffer, the linearity range required and above all on the offset. These parameters explain the following results difference from those indicated at part III for only the driver in DMILL technology. The typical value was 23 mW for a linearity range better than 3% from -1.7V to +1.5V, and \(\pm\)3V bias voltage. But we measured only 8mW for a -1.1V to +1.3V linearity range with -1.5V to 4.5V bias voltage.

## V CMOS integrated biquad shape

The shaper is an important element in the readout electronics for two major reasons. It is necessary to improve the signal to noise ratio, but also due to the high counting rates with the LHC, pulse pileup is another important problem. The current signal produced in a LAr preshower detector by a charged particle traversing the gap has a characteristic triangular shape with a drift time typically about 260 ns [12].

It has been shown that the energy deposited information can be obtained in a shorter time by observing a fraction of the induced charge. The shaper is used for this signal clipping. An important point for this pulse shaping is that its impulse response has zero area [13].

During the previous tests of a RD3 preshower prototype discrete component gated integrator and CR RC2 shapers have been used. But a RC time constant filter integration is very difficult in CMOS technology because of the important process parameter deviation [14]. We use the so called biquadratic structure because it has low component sensitivity [15]. Figure 9 shows the generalized form for the circuit architecture.

The transfer function is :

Figure 6: Muon signal and noise in two preshower layers

Figure 7: Impulse response at 77K on a 50 \(\Omega\) load

\[\begin{array}{l}\mbox{H(s)}=\frac{\mbox{K}\,\frac{\omega\mbox{p}}{\mbox{Qp}}\, \mbox{s}}{\mbox{s}^{2}+\frac{\omega\mbox{p}}{\mbox{Qp}}\mbox{s}+\omega\mbox{p}^{2}} \mbox{where s=j\omega}\\ \\ \mbox{\omega p=}\frac{1}{\sqrt{\mbox{R1R2C1C2}}}\qquad\frac{\omega\mbox{p}}{ \mbox{Qp}}=\frac{\mbox{C1}+\mbox{C2}}{\mbox{R2C1C2}}\\ \mbox{and}\ \ \mbox{K}=\mbox{-}\ \frac{\mbox{R2C1}}{\mbox{R1(C1+C2)}}\end{array}\]

The integration of this shaper requires a high performance amplifier [16]. We used a fully differential folded cascode architecture, which is one of the best ways to improve the gain and the speed [17][18][19][20][21].

The overall schematic of the amplifier is shown in fig. 10.

The input stage has a complementary architecture. In the linear range, both N and P transistor pairs are active and give a push pull response to the stage which increases the gain.

Transistors M49, M51, M54 and M55 form the folded cascode stage.

Transistors M90 - M98 constitute a common mode feedback (CMF) to set the dc voltage of the two differential outputs Vo1 and Vo2.

The output stage is another important point for this amplifier. It uses the benefits of the complementary and differential nature of the input stage. When one of the intermediate output nodes is close to VDD, the other is close to VSS. As a result, when one of the output transistors is heavily conducting, the other is off. Since the output transistors can have rail to rail Vgs voltage, for a given output current they can have smaller sizes (400 \(\upmu\)m for channel width). According to the simulation, this output stage is capable to drive a 50 \(\Omega\) load, but it increases the power dissipation.

The simulation results for this operational amplifier are as follows :

supply voltage \(\pm\)4V load capacitor 1 pF dc gain 83 dB unity gain bandwidth 60 MHz slew rate 28 V/\(\upmu\)s phase margin 76\({}^{\circ}\) gain margin 22 dB dc power dissipation 27 mW.

The circuit has been designed in AMS 1.2\(\upmu\) CMOS. The typical dc gain measured for the operational amplifier is 64db. The filter's magnitude response measured in the cold has a center frequency of 7 MHz (figure 11); this is equivalent to a fast shaping time of about 23 ns.

Figure 10: Overall schematic of the operational amplifier

Figure 9: Single amplifier bandpass biquad filter.

## VII Conclusion

The results presented show that CMOS is a promissing technology for analog front-end electronics at cryogenic temperature. The noise and speed performances make the current conveyor preamplifier suitable for the liquid argon preshower. The linearity range measured for the 50\(\Omega\) line driver is close to \(\pm\)2V, with a 11ns typical step response rise time. The biquadratic architecture shaper results show a 23ns equivalent shaping time ; it will be necessary to optimise this value with an external resistor or capacitor. A DMILL rad-hard technology version will be soon available, for testing in gamma-rays low dose rate environment.

## VII Acknowledgment

We wish to acknowledge E. Delagnes, from CEA-Saclay for our collaboration in buffer design and test in DMILL technology.

## VIII. References

[1] P Jarron et al "ICON a current mode preamplifier in CMOS technology for use with high rate particle detectors" IEEE transactions on nuclear science, vol 40, N\({}^{\circ}\)3, june 1993 pp 271-274.

[2] R&D for a liquid argon preshower. RD3 Colaboration, CERN/DRDC 92-40.

[3] Randall K. Kirschman "Low-Temperature Electronics" pp 11, 62, 137, 269, 272, 323 IEEE press 1986.

[4] Y. Chang, C. Sansen "Low-noise wide band amplifiers in bipolar and CMOS technologies"pp 12, 43, 176-195. Kluwer Academic Publishers 1991.

[5] C. Ioumazou, F.J. Lidgey, D.G. Haigh, "Analog IC design : the current mode approach", p 260 1990.

[6] E. Beuville, P. Jarron "AMPLEX, a low-noise, low-power analog CMOS signal processing for multielement silicon particle detectors", Nuclear Instruments and Methods in Physics research A288(1990) 157-167.

[7] A. Fisher, R. Koch "A highly linear CMOS buffer amplifier" IEEE J. Solid-State Circuits, vol. sc-22 june 1987 pp 330-334.

[8] Hans-Jurgen Schumacher, J. Dikken, E. Seevinck "CMOS Subnanosecond true-ECL output buffer" IEEE J. Solid-State Circuits, vol. 25 N\({}^{\circ}\)1 Feb 1990 pp 150-154.

[9] H. Khorramabadi "A CMOS line driver with 80-db linearity for ISDN applications", IEEE J. Solid-State Circuits, vol. 27 N\({}^{\circ}\)4 April 1992.

[10] M. Dentan et al "Status of a CMOS - JFET - Bipolar radiation hard analog-digital technology suitable for high energy physics electronics", IEEE transactions on nuclear science, vol 40, N\({}^{\circ}\)6, Dec. 93 p 155.

[11] J. Collot et al."Construction and test of a fine-grained liquid argon preshower prototype". Fifth International Conference on Calorimetry in High Energy Physics, Brookhaven National Laboratory, Oct. 94.

[12] B. Aubert et al "liquid argon calorimetry with LHC-performance specifications" Nuclear Instruments and Methods in Physics research A265 (1988) 228-242.

[13] V. Radeka, S. Rescia "Speed and noise limits in ionization chamber calorimeters" Nuclear Instruments and Methods in Physics research A315 (1992) 285-293.

[14] W. Buttler, J. Hosticka, G. Lutz "Noise filtering for readout electronics" Nuclear Instruments and Methods in Physics Research A288 (1990) 187-190.

[15] Sergio Franco, Design with operational amplifiers and analog integrated circuits, p. 177, Mac Graw Hill 1988.

[16] A. Grebene, Bipolar and MOS analog integrated circuit design, pp 690-692 Wiley Interscience 1983.

[17] R. Gregorian, C. Temes, Analog MOS integrated circuits for signal processing, John Wiley & Sons 1986.

[18] N. Babanezhad, "A rail-to-rail CMOS Op Amp" IEEE J. Solid-State Circuits, vol. 23 N\({}^{\circ}\) 6 pp 1414-1417 Dec 1989.

[19] K.D. Dzahini, thesis Ecole Centrale de Lyon N\({}^{\circ}\)91-09

[20] M. Mallya, H. Nevin "Design procedure for a fully differential folded-cascode CMOSoperational amplifier" IEEE J. Solid-State Circuits, vol. 24 N\({}^{\circ}\) 6 pp 1737-1740 Dec 1988.

[21] E. Vallee, I. El-Masry "A very high-frequency CMOS complementary folded cascode amplifier" IEEE J. Solid-State Circuits, vol. 29 N\({}^{\circ}\) 2 Feb.1994 pp 130-133.

Fig 11 : Transfer function mesured at 77K.

Fig 12: Response to a triangular shape signal at 77K