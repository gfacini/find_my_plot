# Impact of Alternative Inputs and Grooming Methods on Large-R Jet Reconstruction in ATLAS

The ATLAS Collaboration

###### Abstract

During Run 1 of the LHC, the optimal reconstruction algorithm for large-\(R\) jets in ATLAS, characterized in terms of the ability to discriminate signal from background and robust reconstruction in the presence of pileup, was found to be anti-\(k_{t}\) jets with a radius parameter of 1.0, formed from locally calibrated topological calorimeter cell clusters and groomed with the trimming algorithm to remove contributions from pileup and underlying event. Since that time, much theoretical, phenomenological, and experimental work has been performed to improve both the reconstruction of the jet inputs as well as the grooming techniques applied to reconstructed jets. In this work, an inclusive survey of both pileup mitigation algorithms applied to calorimeter cell clusters and grooming algorithms is done to study their pileup stability and ability to identify hadronically decaying W bosons within the ATLAS experiment. It is found that compared to the conventional reconstruction algorithm of large-\(R\) trimmed jets formed from calorimeter cell clusters, these methods can improve both the pileup stability and mass-based background rejection.

2017

ATLAS PUB Note ATL-PHYS-PUB-2017-020 ATL-PHYS-PUB-2017-020

## 1 Introduction

At the Large Hadron Collider (LHC), high energy \(pp\) collisions can result in the production of massive particles (e.g. \(W/Z/h\) bosons and top quarks) with transverse momenta \(p_{\mathrm{T}}\) much larger than their mass. When these particles decay hadronically, the typical angular separation between their decay products is inversely proportional to the \(p_{\mathrm{T}}\) of the initial particle and they can be reconstructed in a single large-radius (large-\(R\)) jet. These massive-particle jets have a significantly different radiation pattern than light-quark-initiated or gluon-initiated jets with the same \(p_{\mathrm{T}}\). Hadronically decaying \(W\) bosons, which are used as a benchmark signal jet type in this work, have a characteristic 2-body decay, resulting in a 2-prong structure within the jet. Exploiting these features of Lorentz-boosted objects is a useful way to search for physics beyond the Standard Model [1, 2, 3], as well as for measuring Standard Model observables [4]. Throughout the operation of the LHC, the ability to cleanly reconstruct hadronic systems from the hard-scatter (HS) collision of interest has become increasingly challenging due to the presence of additional proton-proton collisions. This energy flow from additional proton-proton collisions, occurring both during and adjacent to the HS collision, is collectively called pileup (PU). Moreover, the larger the radius of a jet, the more soft radiation from both pileup and the underlying event is included within the catchment area of the jet. This leads to a degradation in the ability to reconstruct observables of the jet relevant to jet tagging, many of which not only depend on the scale of the radiation but also its spatial distribution. Several algorithms exist that are designed to "groom" jets, or remove this soft radiation, making it easier to resolve the hard prongs of a boosted object decay and to discriminate between light-quark-initiated or gluon-initiated jets and boosted objects. In previous studies performed in Run 1 of the LHC [5] and in preparation for Run 2 [6], the performance of trimming [7], pruning [8], and mass drop filtering [9] on large-\(R\) jets was studied in detail. Trimming, with \(R_{\mathrm{sub}}=0.2\) and \(f_{\mathrm{cut}}=5\%\), was found to be the optimal algorithm in terms of the ability to discriminate jets initiated by massive particles from jets initiated by light-quarks and gluons, and also optimal in its resilience in the presence of pileup. Several grooming algorithms have been developed which have not been studied on ATLAS, such as modified mass drop [10] and soft drop [11], motivating a revaluation of this optimization.

With current luminosity conditions at the LHC, multiple proton-proton collisions take place during each bunch crossing. For the data taken by the ATLAS experiment in Run 1 and early Run 2, the average number of PU interactions per bunch crossing was around 20. This number is expected to peak anywhere between 50 and 80 for the end of Run 2 and Run 3. Energy deposited by pileup interactions contaminates hard-scatter events, making reconstruction difficult and degrading the resolution of jets. To minimize these effects, several algorithms have been developed for constituent-level pileup mitigation, including Constituent Subtraction [12], Voronoi Subtraction, and SoftKiller [13]. These algorithms have been tested and optimized for small-radius jets on ATLAS [14], but can serve a complementary purpose to grooming algorithms.

This note presents a comprehensive scan over jet inputs and grooming algorithms using Monte Carlo simulated data to evaluate the performance as compared to the standard trimmed jet reconstruction algorithm used by ATLAS. This comparison is benchmarked primarily in terms of the background rejection in the selection of reconstructed hadronic \(W\) boson decays and the pileup dependence of the reconstruction algorithm implemented. Several constituent-level pileup mitigation algorithms are considered with only their respective optimal configuration, as determined using small-radius jets by Reference [14]. A simultaneous scan over grooming algorithms and their configurations is also performed for trimming, pruning, modified mass drop, soft drop, and jet reclustering [15], meaning that all combinations of input collections and grooming parameters are studied.

Due to the large number of jet collections, a two-stage optimization is performed to determine the optimal input and grooming algorithms. In the first stage, all inputs and grooming parameters are compared, focusing on the background rejection and stability against pileup. These results are used to determine several of the most optimal configurations. This restricted set of jet collections is then calibrated, and a more detailed comparison of these calibrated jet algorithms is performed.

In Section 2, the ATLAS detector is described, and details of the Monte Carlo simulation are given in Section 3. The inputs to the pileup mitigation algorithms are described in Section 4, while an overview of pileup mitigation algorithms are given in Section 5. The jet reconstruction, selection, and grooming methods are described in Section 6, and relevant jet substructure observables are described in Section 7. Section 8 describes the first stage of optimization and shows the results from all input collections. These results are used to choose a few optimal jet collections, which are then calibrated, and examined in a second stage of optimization, as described in Section 9. In addition to this optimization study, a new tool has been developed within ATLAS to separate and study the contribution of pileup and hard scatter energy to the fully simulated calorimeter energy. A limited number of studies of the truth-level information are presented in Section 10, highlighting several features of grooming algorithms and to point the way for future studies. In Section 11, the conclusions of these studies are presented.

## 2 ATLAS Detector

ATLAS is a multi-purpose particle detector [16], covering a solid angle of nearly \(4\pi\) around the collision point. It is built in concentric layers around the beamline. The innermost region is the inner tracking detector, which is surrounded by the electromagnetic and hadronic calorimeters, and the outermost layer is the muon spectrometer, which also incorporates the three large superconducting toroid magnets.

Tracking is done in the inner tracking detector using the high granularity pixel detector, followed by the silicon strip detector (SCT) and the transition radiation tracker (TRT). These detectors are immersed in a 2 \(T\) axial magnetic field, and provide tracking information up to pseudorapidity1 of \(|\eta|<2.5\).

Footnote 1: ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point (IP) in the centre of the detector and the \(z\)-axis along the beam pipe. The \(x\)-axis points from the IP to the centre of the LHC ring, and the \(y\)-axis points upwards. Cylindrical coordinates \((r,\phi)\) are used in the transverse plane, \(\phi\) being the azimuth’s angle around the \(z\)-axis. The pseudo-rapidity is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan(\theta/2)\). Angular distance is measured in units of \(\Delta R\equiv\sqrt{(\Delta\eta)^{2}+(\Delta\phi)^{2}}\).

The electromagnetic calorimeter covers a range of \(|\eta|<4.9\). The barrel region of the calorimeter covers \(|\eta|<1.5\), while the endcap covers the region \(1.375<|\eta|<3.2\), and both are composed of lead/liquid-argon detectors.. The barrel region of the hadronic calorimeter is a steel/scintillating-tile calorimeter, spanning the region \(|\eta|<1.7\), and the endcap hadronic calorimeter is a copper/liquid-argon detector covering \(1.5<|\eta|<3.2\). For the forward region, \(3.1<|\eta|<4.9\), the calorimeter is a liquid-argon calorimeter with a copper absorber in the electromagnetic region, and a W absorber in the hadronic section.

## 3 Monte Carlo Samples

These studies are performed using samples of jets originating from light quarks and gluons ("QCD jets") as well as jets originating from \(W\) bosons ("\(W\) jets"). Both samples are generated with the Pythia 8.186 generator [17] using the A14 tune [18] with the NNPDF2.3LO PDF set [19]. After simulation of the parton shower and hadronization, events are passed through the full Geant4[20] simulation of the ATLAS detector [21]. Hadronic showers are simulated using the FTFP BERT model [22].

The background sample consists of high-\(p_{\mathrm{T}}\) multijet events initiated by gluons and (non-top) quarks. These events are generated in slices of jet \(p_{\mathrm{T}}\) in order to have sufficient statistics at higher \(p_{\mathrm{T}}\), and event-by-event weights are used to produce the smoothly falling \(p_{\mathrm{T}}\) distribution predicted by Pythia8.

Signal \(W\) jets are taken from the beyond the Standard Model spin-1 \(W^{\prime}\to WZ\to qqqq\) process, selecting a maximum of one jet per event matched to the truth \(W\) particle. An array of signal samples were generated with \(W^{\prime}\) masses ranging from 400-5000 GeV to fully populate a broad kinematic range. These samples are then combined and jet-by-jet weights are applied based on the anti-\(k_{t}\) truth jet, as described in Section 6, such that the \(p_{\mathrm{T}}\) spectrum of the ensemble of signal \(W\) jets matches that of the QCD jets, to remove the dependence on the \(W^{\prime}\) signal model.

Pileup is simulated by overlaying additional minimum-bias events, also generated with Pythia8. The minimum-bias events are overlaid onto the hard scattering events according to the measured distribution of the average number \(\langle\mu\rangle\) of \(pp\) interactions per bunch crossing. In this study, the levels of pileup correspond to those present in early Run 2 of the LHC with an average number of interactions per bunch crossing of approximately 20. This overlay is performed in such a way that each sub-detector considers the effect of adjacent bunch crossings as well as the current hard scatter, thereby accounting for both in-time time and out-of-time pileup as described in Reference [23].

## 4 Jet Inputs

For these studies, jets are reconstructed from topoclusters [24], which are three-dimensional groupings of calorimeter cells formed using the noise-suppressing 4-2-0 algorithm. This algorithm is seeded by cells with at least 4 times the \(\sigma_{\mathrm{Noise}}\)2. For each of these cluster seeds, any neighbouring cell with at least \(2\sigma_{\mathrm{Noise}}\) above the noise threshold are added to the cluster. This step is repeated, iteratively, until there are no longer any adjacent cells with an energy of greater than \(2\sigma_{\mathrm{Noise}}\). All cells neighboring the cluster are then added into the cluster. In the case that this process results in a cluster with two distinct local maxima of energy, it is preferable to separate these showers and a splitting algorithm is run to achieve this. The resulting set of clusters are calibrated at the electromagnetic scale and taken to be massless. An additional calibration using the Local Cluster Weighting (LCW, or LC) scheme is applied to form clusters whose energy is calibrated at the hadronic scale. This weighting scheme classifies energy depositions as being electromagnetic- or hadronic-like, and accounts for the non-compensation of the calorimeter, out-of-cluster energy, and also energy falling in the dead material within the detector. Finally, the angular coordinates (\(\eta\) and \(\phi\)) of the cluster are corrected for the selected primary vertex. A more detailed description of topocluster formation and calibration is provided in Reference [24].

Footnote 2: The noise is estimated using the same method as described in Reference [25] taking into account both the electronic and pileup noise based on the average noise for the expected pileup conditions during the 2015 and 2016 data taking.

Truth jets are reconstructed using all detector-stable particles from the HS process with a lifetime of over 10 ps, excluding muons and neutrinos which are not expected to make a sizeable energy deposition in the calorimeter.

## 5 Constituent-Level Pileup Mitigation Techniques

Pileup mitigation algorithms are designed to either remove or modify energy depositions in the calorimeter to account for the presence of pileup energy flow. As described in Section 4, topological clustering already achieves this to some extent with noise suppression. While this lessens the effects of pileup, other techniques exist to further suppress pileup contamination and minimize pileup fluctuations. These techniques typically use either event-level observables, such as the median \(p_{\mathrm{T}}\) density \(\rho\), or the local topology of the event, such as the density of clusters. Several different constituent-level pileup mitigation techniques are compared, Constituent Subtraction [12], Voronoi Subtraction, and SoftKiller [13]. These algorithms have been studied and optimized for small-radius jets on ATLAS [14], and the optimal configurations from this will be used for these studies as well. In all cases, the corrections described here are applied to the _topocluster_ constituents, described in Section 4, calibrated to the hadronic scale with the local cluster weighting method. The full set of pileup-suppressed constituent types are summarized in Table 1 and described in this section.

### Voronoi Subtraction

Voronoi subtraction extends the \(\rho\)-area subtraction method [23] for jets used in ATLAS to the constituent level. The Voronoi area of the \(i\)-th constituent is defined as the area of all points in \(\eta\)-\(\phi\) space that are closer to the \(i\)-th constituent than any other constituent. The median \(p_{\mathrm{T}}\) density \(\rho\) is estimated as the median of the \(p_{\mathrm{T}}/A\) distribution of \(k_{t}\)[26] jets with \(R=0.4\) in the event and \(\rho\times A_{\mathrm{Voronoi}}\) is subtracted from the \(p_{\mathrm{T}}\) of each constituent, giving

\[p_{\mathrm{T}}^{\mathrm{corr}}=p_{\mathrm{T}}-\rho\times A_{\mathrm{Voronoi}} \tag{1}\]

Applying this subtraction produces many constituents with negative \(p_{\mathrm{T}}\). Two approaches have been considered for how to account for the negative energy constituents.

\begin{table}
\begin{tabular}{|l|c|c|} \hline
**Input Type** & **Name** & **Parameter Values** \\ \hline Uncorrected LC topoclusters & LCTopo & - \\ \hline Voronoi subtraction with negative suppression & VorSupp & - \\ \hline Voronoi subtraction with negative spreading & VorSpread & - \\ \hline Constituent Subtraction & CS & \(\Delta R_{\mathrm{max}}=0.25\) \\ \hline SoftKiller & SK & \(\ell=0.6\) \\ \hline Constituent Subtraction + SoftKiller & CS+SK & \(\Delta R_{\mathrm{max}}=0.25\), \(\ell=0.6\) \\ \hline Voronoi Suppression + SoftKiller & VorSupp+SK & \(\ell=0.6\) \\ \hline \end{tabular}
\end{table}
Table 1: Summary of input jet constituent types along with the relevant parameter choices and the terminology used throughout this note by which they are referred.

In the first technique, "negative suppression", negative \(p_{\rm T}^{\rm corr}\) clusters are removed from the event, and jet clustering is performed on the remaining (positive energy) clusters. In this case, the \(p_{\rm T}\) of \(\rho\times A_{\rm Voronoi}\) is treated as a threshold below which energy depositions are considered to be dominated by pileup. Therefore, only the energy above this cut is used as an estimate of the hard scatter event.

The second technique, Voronoi Spreading, attempts to rectify the problem of only suppressing negative fluctuations in pileup density. Instead of completely removing negative \(p_{\rm T}\) clusters, in this approach, the negative transverse momentum is "spread" to nearby clusters. This is achieved by performing the following algorithm for each cluster \(i\) with \(p_{\rm T}^{\rm corr}<0\) :

1. Find the set of clusters \(S\) such that each cluster \(j\) in \(S\) has positive \(p_{\rm T}\), and \(\Delta R_{ij}<0.4\). For each cluster \(j\) in \(S\), perform the following two steps: 1. Calculate a weight for the nearby cluster \(j\) with respect to the target cluster \(i\) using the formula \[w_{ij}=\frac{1}{\Delta R_{ij}^{2}}\ \times\frac{1}{\sum_{k\in S}\frac{1}{ \Delta R_{ik}^{2}}}.\] (2) This weighting is meant to represent the relative effect of a cluster on its neighbors and is constructed such that for each target cluster \(i\) the sum of weights \(\sum_{j\in S}w_{ij}=1\). 2. Spread the negative transverse momentum of the target cluster \(i\), \(p_{\rm T,i}^{\rm corr}\) to each of the clusters \(j\in S\), as \[p_{\rm T,j}^{\rm corr}\rightarrow\max(0,p_{\rm T,j}^{\rm corr}+w_{ij}\times p _{\rm T,i}^{\rm corr}).\] (3)
2. Set the transverse momentum of the target cluster \(i\) to zero, \(p_{\rm T,i}^{\rm corr}\to 0\), since the negative \(p_{\rm T}\) of this target cluster has now been distributed among the nearby clusters which initially had positive energy.

### Constituent Subtraction

Constituent Subtraction [12] is a second way of defining area subtraction for constituents. However, unlike the Voronoi area method, where the area depends solely on the geometry of the event, the Constituent Subtraction area is defined with ghosts, and spreading is already built into the algorithm. For each event, the median energy density \(\rho\) is computed in the same way as for Voronoi subtraction3. Massless low \(p_{\rm T}\) virtual particles called "ghosts" are then added to the event with \(p_{\rm T}\) satisfying Footnote 3: In this case, a single value of \(\rho\) is calculated inclusively in the region \(|\eta^{\rm true}|\)\(<\)2.5

\[p_{\rm T}^{\rm g}=A_{\rm g}\times\rho, \tag{4}\]

where \(A_{g}\), the area of the ghosts, is set to 0.01 and \(p_{\rm T}^{\rm g}\) corresponds to the expected pileup in a small \(\Delta\eta\)-\(\Delta\phi\) area of 0.1\(\times\)0.1. After the ghosts have been added, the distance, \(\Delta R_{i,k}\) between each cluster \(i\) and ghost \(k\) is calculated as 4\[\Delta R_{i,k}=\sqrt{(\eta_{i}-\eta_{k}^{g})^{2}+(\phi_{i}-\phi_{k}^{g})^{2}}.\]

The cluster-ghost pairs are then sorted in order of ascending \(\Delta R_{i,k}\), and the algorithm proceeds iteratively through each \((i,k)\) pair, modifying the \(p_{\mathrm{T}}\) of each cluster [5] and ghost by

\[\begin{array}{ll}\text{If }p_{\mathrm{T},i}\geq p_{T_{k}}^{g}:&p_{\mathrm{T},i} \longrightarrow p_{\mathrm{T},i}-p_{\mathrm{T},k}^{g},\\ &p_{\mathrm{T},k}^{g}\longrightarrow 0;\\ \text{otherwise:}&p_{\mathrm{T},k}^{g}\longrightarrow p_{\mathrm{T},k}^{g}-p_{ \mathrm{T},i},\\ &p_{\mathrm{T},i}\longrightarrow 0.\end{array}\]

until \(\Delta R_{i,k}>\Delta R_{\mathrm{max}}\), where \(\Delta R_{\mathrm{max}}\) is a free parameter of the algorithm taken to be 0.25 in this study. Any ghosts remaining after the subtraction are eliminated. Unlike Voronoi subtraction, no spreading algorithm is considered, as the Constituent Subtraction algorithm implicitly does this.

### SoftKiller

While some constituent-level pileup mitigation methods rely on modifying the constituent 4-momentum, the SoftKiller (SK) [13] algorithm makes a hard \(p_{\mathrm{T}}\) cut to remove constituents. This cut is chosen on an event-by-event basis such that the \(p_{\mathrm{T}}\) flow density (\(\rho\)) after the selection is approximately zero. To achieve this, the detector is divided into an \(\eta\)-\(\phi\) grid of side length \(\ell\), and the \(p_{\mathrm{T}}\) cut is chosen such that half of the grid spaces are empty after the cut, giving it the name "SoftKiller", since it kills the soft constituents from the event.

To account for detector-level effects, where constituents are not purely HS or PU, area subtraction is applied to constituents before applying SK. In this note, both Voronoi suppression and Constituent Subtraction are considered. Voronoi spreading is not paired with SK, as it is already an aggressive algorithm which does not leave a high enough particle density for SK to be effective. For each type of area subtraction, a SK grid size \(\ell\) of 0.6\(\times\)0.6 is used, computed within \(|\eta|<2.4\).

## 6 Jet Reconstruction and Selection

After the constituent construction and correction procedures, as described in Sections 4 and 5, the constituents are clustered into large-\(R\) jets in order to capture the boosted decays of massive particles. With the exception of reclustering, which is described in Section 6.5, the constituents are clustered into jets using the anti-\(k_{t}\) jet algorithm [26] with a distance parameter of \(R\)=1.0. In this case, the jet is susceptible to containing energy flow from the underlying event and pileup contamination not suppressed by the building or construction of the jet constituents themselves. These effects are addressed using grooming procedures, which remove constituents from the jet which are are likely to originate from these sources. Five jet reconstruction and grooming procedures are studied here; trimming [7], pruning [8], modified mass drop [10], soft drop declustering [11], and reclustering [15]. The full set of jet reconstruction or grooming procedures, along with the choices of relevant parameters that are tested, are summarized in Table 2 and described in this section.

With the full set of inputs, summarized in Table 1, and grooming algorithms, summarized in Table 2, there are approximately 500 jet types being tested. In order to perform a fair comparison of uncalibrated jets, truth jets are reconstructed with the anti-\(k_{t}\) algorithm with \(R\)=1.0, and an exclusive \(\Delta R\) matching in (\(\eta\),\(\phi\)) is performed between the truth jet and reconstructed jets for each type of input. The kinematics of this ungroomed truth jet are used to characterize the \(p_{\mathrm{T}}\) scale of the hadronic energy flow entering the detector, which ensures that in a given kinematic region, the comparison between reconstruction algorithms is performed using the same set of jets. As the truth jet does not contain pileup particles we are also testing the ability of these inputs and algorithms to mitigate the effects of pileup.

In the case of the QCD jet background sample, the leading truth jet is always kept assuming that it has \(p_{\mathrm{T}}\) greater than 300 GeV. The ungroomed reconstructed jet closest to the leading truth jet, within \(\Delta R<0.75\), is kept, where this \(\Delta R\) matching requirement is performed independently for jets reconstructed from each type of input. Grooming is then applied to these truth and reconstructed jets, ensuring that the same population of jets studied for each type of grooming algorithm. In the case of the signal \(W\)-jet sample, rather than keeping the leading truth jet, the truth jet originating from the \(W\) boson is kept. The truth jet originating from the \(W\) boson is identified via the criteria \(\Delta R(J_{\mathrm{truth}},W)<0.75\), where \(J_{\mathrm{truth}}\) is the truth jet nearest to the \(W\) boson. After determining which truth jet to keep, the procedure for deciding which ungroomed reconstructed jets to keep for each input type proceeds in the same way as for the QCD jet background sample.

To remove the dependency of the different metrics on the different \(p_{\mathrm{T}}\) spectra of the QCD samples and samples of \(W\)-jets, the \(p_{\mathrm{T}}^{\mathrm{true}}\) spectrum for \(W\) jets and QCD jets is used to determine a jet-by-jet weight for the samples of \(W\)-jets such that the \(p_{\mathrm{T}}\) spectra match after the weighting. In order to ensure full containment of the hadronic \(W\) boson decay, jets are only studied if they are matched to a truth jet with \(p_{\mathrm{T}}^{\mathrm{true}}\) greater than 300 GeV. Additionally, to ensure that the catchment area of the jet is largely contained within the region of the detector where charged-particle tracks may be reconstructed, an additional cut of \(|\eta^{\mathrm{true}}|\)<1.2 is applied.

### Trimming

Trimming [7] was originally designed to remove contamination from light partons in the jet by excluding regions of the jet where the energy flow originates predominantly from underlying event or initial-state

\begin{table}
\begin{tabular}{|c|c|c|} \hline
**Grooming Algorithm** & **Name** & **Parameters Tested** \\ \hline Modified Mass Drop & mMDT & (\(z_{\mathrm{cut}}\),\(\eta_{\mathrm{fill}}\)) \(\in\) [0.05, 0.1, 0.15, 0.2] \(\times\) [3] \\ Soft Drop & SD & (\(z_{\mathrm{cut}}\),\(\beta\)) \(\in\) [0.05, 0.1, 0.15, 0.2, 0.25] \(\times\) [0, 0.5, 1, 1.5, 2] \\ Pruning & Pruned & (\(z_{\mathrm{cut}}\), \(R_{\mathrm{cut}}\)) \(\in\) [0.10, 0.15, 0.20] \(\times\) [0.12, 0.25, 0.5] \\ Trimming & Trimmed & (\(f_{\mathrm{cut}}\), \(R_{\mathrm{sub}}\)) \(\in\) [5, 7, 9, 11, 13, 15]\% \(\times\) [0.1, 0.2, 0.3] \\ Reclustering & RC & (\(R_{\mathrm{small}}\),\(f_{\mathrm{cut}}\)) \(\in\) [0.2, 0.3, 0.4] \(\times\) [5%] \\ \hline \end{tabular}
\end{table}
Table 2: Summary of grooming algorithms, the abbreviated names used throughout this work, and the relevant parameters tested for each algorithm.

radiation (ISR), improving the overall resolution of the jet energy measurement. In Run 1 [27], it was also found to be quite effective in improving the reconstruction of energy flow in large-\(R\) jets and minimizing the effects of pileup on the reconstructed jets. In this algorithm, the constituents of the large-\(R\) jet are reclustered into subjets of radius \(R_{\text{sub}}\) using the \(k_{t}\) algorithm. Any of these subjets with \(p_{\text{T}}\) less than a fraction \(f_{\text{cut}}\) of the original ungroomed jet are discarded. Since large fractions of the HS event is contained within individual subjets, and since pileup contamination and initial-state radiation is typically much softer than the HS event, this is an effective way of eliminating large amounts of PU and the UE while retaining most of the HS event. While the remaining subjets still have some contamination from ISR or PU, this effect is lessened due to the smaller area of the subjet.

### Pruning

Pruning [8] was initially proposed as a modification of the clustering sequence, where splittings that pull in PU and UE radiation are discarded. This is achieved by determining a "pruning" radius such that hard prongs fall into separate subjets, while discarding softer radiation not in these prongs. The constituents of the large-\(R\) jet are reclustered using the Cambridge-Aachen algorithm [28] to form a cluster sequence that represents the intuitive parton shower branching model. At each step of the clustering, if the clustering is either soft or wide-angled, the cluster with the smaller \(p_{\text{T}}\) is discarded. The soft and wide-angle conditions are defined as follows:

\[\text{(i - Wide Angle)}:\Delta R_{12}\geq R_{\text{cut}}\times 2\frac{M_{12}}{p_{ \text{T},12}} \tag{5}\]

\[\text{(ii - Soft)}:z\leq z_{\text{cut}}\]

where \(\Delta R_{12}\), \(M_{12}\), and \(p_{\text{T},12}\) are the angular distance, the mass, and the transverse momentum of the potential cluster combination, respectively, and \(z=\frac{min(p_{\text{T}1},p_{\text{T}2})}{p_{\text{T},12}}\).

### Modified Mass Drop Tagger

One of the earliest proposed grooming algorithms was the "BDRS" algorithm [9], which relied on declustering a Cambridge-Aachen jet and removing branches which have a significant imbalance in \(p_{\text{T}}\) but no significant mass drop. This relies on the intuition that a background jet will have more soft and collinear splittings and therefore be largely removed by this procedure whereas a jet formed by a hard splitting early on in the declustering will truncate this procedure. A modification of this procedure called modified mass-drop tagger (mMDT) was proposed in Reference [10], which revisits this algorithm and modifies the choice of which branch is removed in the case of an imbalanced and soft splitting. In this algorithm, the last stage of clustering for a jet \(j\) is undone, providing two subjets \(j_{1}\) and \(j_{2}\), where \(p_{\text{T}}^{1}>p_{\text{T}}^{2}\). If the two conditions

\[\text{(i - Mass Drop)}:m(j_{1})<\mu\times m(j_{2}) \tag{6}\] \[\text{(ii - Balanced Splitting)}:\frac{min(p_{\text{T},1},p_{ \text{T},2})}{p_{\text{T},1}+p_{\text{T},2}}>z_{\text{cut}}\]

are passed, then the algorithm stops, and the original jet is kept. If either condition is failed, then the softer subjet is discarded and the process is repeated with the harder subjet. In these studies, \(\mu\) is taken to be infinitely large, such that the mass drop condition is always satisfied.

After running this declustering procedure, a filtering is applied in which the constituents are reclustered using the Cambridge-Aachen algorithm with a subjet radius \(R_{\text{filt}}=\min[0.3,\frac{\Delta R_{j_{1},j_{2}}}{2}]\). Any constituentsoutside of the \(n_{\rm filt}\) highest \(p_{\rm T}\) subjets are discarded, where for these studies, \(n_{\rm filt}=3\). One of the additional benefits of this grooming algorithm, in addition to the removal of soft and wide-angle radiation, i is that the resulting jet forms a radiation pattern whose properties are calculable in a manner that is free of non-global logarithms, thereby making it more tractable to theoretical understanding and with potentially smaller associated theoretical uncertainties.

### Soft Drop

Soft Drop declustering [11] is a technique for removing soft- and wide-angle radiation from a jet which extends the idea of mMDT to different distance parameters. This algorithm proceeds by reclustering the large-\(R\) jet using the Cambridge-Aachen algorithm. Next, the algorithm steps backwards through the clustering, starting from the final combination that gave the jet. At each splitting, if the condition

\[\frac{min(p_{\rm T,1},p_{\rm T,2})}{p_{\rm T,1}+p_{\rm T,2}}<z_{\rm cut}\Big{(} \frac{\Delta R_{12}}{R_{0}}\Big{)}^{\beta} \tag{7}\]

holds, the lower \(p_{\rm T}\) branch is removed, and the process is repeated. Otherwise, the process terminates and the remaining constituents form the jet. If \(\beta=0\), this is purely a cut on soft radiation, while larger values of \(\beta\) allow increasing amounts of soft and wide-angle radiation into the jet. Soft Drop, like mMDT, removes non-global logarithms from the jet. It is noted that Soft Drop with \(\beta=0\) reduces to the mMDT algorithm (without filtering). In these studies, mMDT always has filtering applied, so the results differ from Soft Drop with \(\beta=0\).

### Jet Reclustering

Jet reclustering [15; 29] is a technique which constructs large-\(R\) jets from calibrated input jets which are built with a smaller radius parameter value. Typically, anti-\(k_{t}\) jets with \(R=0.4\), which are already widely used within ATLAS, are used as inputs for this procedure as the kinematics of these jets are well-understood via a complex calibration procedure [30]. Propagation of the calibration and uncertainties on the input jets eliminates the necessity for dedicated large-\(R\) jet energy and mass calibrations and uncertainties to be derived. An additional major advantage of this approach is that the large-\(R\) jet radius parameter may be optimized at the analysis level, providing an additional level of flexibility for the optimisation of analyses searching for complex hadronic final states [31; 32; 33]. In this jet reconstruction procedure, there are two ways in which the algorithm itself eliminates contributions from the UE and PU. The first is by relying on the calibration procedure of the small-\(R\) jet inputs, which itself implements an area subtraction procedure to remove the average pileup contributions. The second is by using a modified trimming procedure in which small-\(R\) jets that have been clustered into a large-\(R\) jet are removed if the \(p_{\rm T}\) of the small-\(R\) jet is below a fractional \(p_{\rm T}\)-threshold of the original large-\(R\) jet. In this work, the former area correction is only applied in the case of anti-\(k_{t}\)\(R=0.4\) input small-\(R\) jets as this jet collection has been fully calibrated. However, large-\(R\) jets built from small-\(R\) jets of smaller input jet radii, namely 0.2 and 0.3, are examined for comparison at the uncalibrated scale. For these studies, the reclustered jets are always formed with the anti-\(k_{t}\) algorithm with a radius parameter of \(R\)=1.0, and the reclustered trimming procedure is performed with a relative \(p_{\rm T}\)-threshold of 5%.

## 7 Jet Observables and Substructure Variables

Since QCD jets and jets from boosted heavy objects have different energy patterns, various definitions of substructure are useful for tagging jets. Unlike the transverse momentum, these variables typically involve the angular spread of the constituents in a jet. While using large-\(R\) jets is important for capturing the full decay of heavy bosons, their large catchment area also increases their sensitivity to unwanted radiation when calculating these substructure variables. For these studies, which are focused on the identification of \(W\) jets, the two observables that were used to benchmark the performance of the various jet algorithms described in Section 6, are the jet mass \(m^{\text{jet}}\) and the \(D_{2}\) observable [34; 35; 36].

In this study, the mass is defined as

\[m^{\text{jet}}=\sqrt{(\sum_{i\in\text{jet}}E_{i})^{2}-(\sum_{i\in\text{jet}} \vec{p_{i}})^{2}} \tag{8}\]

where the sums run over the full set of constituents that result from the reconstruction and grooming algorithm. The jet mass alone is one of the most discriminating and widely used substructure observables, both in searches and measurements. Therefore, it is important to study the extent to which the constituent corrections and jet grooming algorithms modify its behaviour, and whether they achieve the desired result of removing the pileup-dependence of jet observables.

In addition to the jet mass, another useful observable in discriminating between QCD and \(W\) jets is the \(D_{2}\) observable [34; 35; 36], which characterizes the hard substructure of a jet. This observable is defined in terms of the \(n\)-point energy correlation functions 6\(e_{2}\) and \(e_{3}\)

Footnote 6: It was found [37] that the choice of \(\beta\)=1 is most performant in ATLAS and is used throughout this work.

\[\begin{split}\ell_{2}^{\beta}&=\frac{1}{p_{\text{ T},j}^{2}}\sum_{1\leq i<j\leq n_{j}}p_{\text{T},i}p_{\text{T},j}R_{ij}^{\beta}, \\ \ell_{3}^{\beta}&=\frac{1}{p_{\text{T},j}^{3}}\sum_{1 \leq i<j<k\leq n_{j}}p_{\text{T},i}p_{\text{T},j}p_{\text{T},k}R_{ij}^{\beta }R_{ik}^{\beta}R_{jk}^{\beta},\end{split} \tag{9}\]

with \(D_{2}=e_{3}/e_{2}^{3}\). There are several characteristics of the \(n\)-point correlation function which make it theoretically useful for discriminating between different radiation patterns within jets. The observable \(\epsilon_{n}^{\beta}\) is infrared and collinear safe, which is sensitive to the \(n\)-prong structure in a jet. For any value of \(n\), \(\epsilon_{n}^{\beta}\) is insensitive to recoil, meaning that it does not depend on the angular distance between the hard jet core and the jet momentum axis, which can occur with soft, wide-angle radiation. Additionally, in the soft or collinear limit, \(\epsilon_{n}^{\beta}\to 0\) for all configurations and for any number of particles within the jet. Unlike the \(n\)-subjettiness [38] observable, this \(D_{2}\) observable does not rely on hard subjet axes to derive its discrimination power. For this reason, it can achieve a higher level of discrimination power. However, this further means that it may be susceptible to unwanted radiation which has been clustered into the jet. Therefore, by studying its behaviour under varying pileup conditions, it is possible to gauge the extent to which the constituent correction and grooming techniques successfully remove the contributions to the jet from pileup.

## 8 Performance of Pileup Mitigation and Grooming Algorithms

This study is intended to understand the effects of a broad class of algorithms for both _constituent correction_ and _jet grooming algorithms_, the convolution of which results in approximately 500 unique jet collections. However, many metrics such as the jet energy resolution, as in Reference [14], require a jet calibration. Because of this, a two-stage optimization strategy is used. The first stage compares all jet reconstruction techniques prior to any MC-based calibration for either the large-\(R\) jets or the reclustered jets, and uses three main metrics which are meaningful without a calibration, and which gauge the ability of a jet algorithm to distinguish signal \(W\) jets from QCD jets, as well as the degree to which pileup affects its observables. These criteria are used to determine a subset of jet collections, which are then calibrated to the full hadronic scale using a MC based jet energy scale and mass scale correction. This subset of algorithms is also compared to the standard trimmed jet reconstruction technique using a more detailed comparison of the resolution of the reconstruction algorithm and the performance of a \(W\) boson jet tagger, similar to that described in [5].

### Mass-Based Jet Identification

The jet mass \(m^{\rm jet}\) is itself an interesting observable which, when calculated for a jet initiated by a massive hadronically-decaying particle, is related to the intrinsic mass of the initiating particle. For light-quark and gluon initiated jets, the jet mass arises from both gluon emissions and splittings of the parton shower. As such, measurements of the jet mass [39, 40, 41] can provide insight into the modelling of QCD processes. Additionally, it provides a good handle to discriminate signal jets coming from massive particles from QCD jets, which is exploited by many searches.

Without any grooming or pileup mitigation, the jet mass is dominated by pileup [40]. Applying some form of pileup mitigation does reduce the background efficiency, but there are small differences between the individual constituent level pileup mitigation algorithms tested. However, significant differences are seen for different choices of grooming algorithms and parameters. Because of this, the extent to which the jet mass discriminates signal jets from background jets strongly depends on the choice of the particular grooming algorithm, as seen in Figures 1- 5. Particularly striking is the extent to which the Soft Drop grooming algorithm with \(\beta=0\) (Figure 1- 2) and mMDT (Figure 3) shifts the majority of QCD jets to significantly lower masses on average than the trimming algorithm (Figure 4) while leaving the mass distribution of signal \(W\) boson jets fairly similar. This indicates that in general, when operating on a QCD jet, the Soft Drop algorithm with \(\beta\)=0 and mMDT aggressively remove soft portions of the jet while not affecting signal \(W\) boson jets which have multiple hard prongs. While the signal jet mass distribution is not strongly affected by the changing value of \(\beta\), lower values of \(\beta\) groom the background distribution much more strongly, thereby increasing the separation between signal and background. Very small values of \(z_{\rm cut}\) also lead to high values of the background efficiency, as seen in Figures 1 and 3. This is expected since smaller \(z_{\rm cut}\) means that less grooming is being applied, resulting in similar performance to the ungroomed jets. For trimming, the behavior of the \(R_{\rm sub}\) and \(f_{\rm cut}\) parameters are highly correlated as the relative amount of \(p_{\rm T}\) contained within any given subjet increases with its size. In particular Figure 4 show that larger values of \(R_{\rm sub}\) shift both the background and signal distribution to higher mass values. This effect is present in both distributions but affects the background distribution more strongly, thereby resulting in worse separation of signal and background for larger values of \(R_{\rm sub}\). Increasing \(f_{\rm cut}\) creates a more aggressive grooming algorithm which effectively acts as a dynamic \(p_{\rm T}\) threshold on the constituents of the ungroomed jet. In the case of pruning, small values of \(z_{\rm cut}\) mean that more wide-angle radiationis kept thereby resulting in a larger average mass for QCD jets while the signal distribution is affected much less, as seen in Figure 5. One more feature is noted for Soft Drop with \(\beta=0\), mMDT, and pruning (Figures 1, 3, 5), which all have to large spikes at zero in the QCD mass distribution, demonstrating that they aggressively remove radiation not associated with a hard prong.

The ability of the jet mass, reconstructed with a particular algorithm, to separate signal and background provides one measure of the overall performance of the reconstruction algorithm and takes into consideration how the full reconstruction techniques affect signal jets and background jets differently. To quantify this measure, for each algorithm, the smallest window around the reconstructed \(W\) jet peak that contains 68% of the signal jets is determined and used to calculate the background efficiency (\(\epsilon_{\text{QCD}}^{68\%}\)) as the fraction of QCD jets within the same window. The background efficiency is taken as a representative measure of the separation power of the reconstructed mass for a particular algorithm, as shown in Figure 6. This quantity is presented in Figure 7 for both a low- and high-\(p_{\text{T}}\) region of phase space.

Figure 1: For the Soft Drop jet grooming algorithm using LCTopo calorimeter cell clusters as inputs to the anti-\(k_{t}\) jet reconstruction algorithm with \(R=1.0\), a comparison of the jet mass distribution for QCD background jets (a),(c) and signal \(W\) boson jets (b),(d) in low-\(p_{\rm T}\) (a),(b) and high-\(p_{\rm T}\) (c),(d) kinematic regions, as determined by the ungroomed truth jet \(p_{\rm T}\), for a variety of Soft Drop grooming parameter choices. The Soft Drop parameter choices shown here are \(\beta=0,1\), and \(2\) for a fixed \(z_{\rm cut}=0.1\).

Figure 2: For the Soft Drop jet grooming algorithm using LCTopo calorimeter cell clusters as inputs to the anti-\(k_{t}\) jet reconstruction algorithm with \(R=1.0\), a comparison of the jet mass distribution for QCD background jets (a),(c) and signal \(W\) boson jets (b),(d) in low-\(p_{\rm T}\) (a),(b) and high-\(p_{\rm T}\) (c),(d) kinematic regions, as determined by the ungroomed truth jet \(p_{\rm T}\), for a variety of Soft Drop grooming parameter choices. The Soft Drop parameter choices shown here are \(z_{\rm cut}\) = 0.05, 0.1, 0.15, and 0.2.for a fixed \(\beta=0\).

Figure 3: For the modified mass drop jet grooming algorithm using LCTopo calorimeter cell clusters as inputs to the anti-\(k_{t}\) jet reconstruction algorithm with \(R=1.0\), a comparison of the jet mass distribution for QCD background jets (a),(c) and signal \(W\) boson jets (b),(d) in low-\(p_{\rm T}\) (a),(b) and high-\(p_{\rm T}\) (c),(d) kinematic regions,as determined by the ungroomed truth jet \(p_{\rm T}\), for a variety of mMDT grooming parameter choices. The mMDT parameter choices shown here are \(z_{\rm cut}=0.05\), \(0.1\), \(0.15\), and \(0.2\).

Figure 4: For the trimming jet grooming algorithm using LCTopo calorimeter cell clusters as inputs to the anti-\(k_{t}\) jet reconstruction algorithm with \(R=1.0\), a comparison of the jet mass distribution for QCD background jets (a),(c) and signal \(W\) boson jets (b),(d) in low-\(p_{\mathrm{T}}\) (a),(b) and high-\(p_{\mathrm{T}}\) (c),(d) kinematic regions, as determined by the ungroomed truth jet \(p_{\mathrm{T}}\), for a variety of trimming parameter choices. The trimming parameter choices shown here are \(R_{\mathrm{sub}}=0.1\), \(0.2\), and \(0.3\) for a fixed \(f_{\mathrm{cut}}=5\%\).

Figure 5: For the pruning jet grooming algorithm using LCTopo calorimeter cell clusters as inputs to the anti-\(k_{t}\) jet reconstruction algorithm with \(R=1.0\), a comparison of the jet mass distribution for QCD background jets (a),(c) and signal \(W\) boson jets (b),(d) in low-\(p_{\rm T}\) (a),(b) and high-\(p_{\rm T}\) (c),(d) kinematic regions, as determined by the ungroomed truth jet \(p_{\rm T}\), for a variety of pruning parameter choices. The pruning parameter choices shown here are \(z_{\rm cut}=0.125\), \(0.25\), and \(0.5\) for a fixed \(R_{\rm cut}=0.1\).

Figure 6: A representative comparison of signal \(W\) boson and background QCD jets in the low-\(p_{\rm T}\) kinematic regions, as determined by the ungroomed truth jet \(p_{\rm T}\),. Additionally, for the \(W\) jet spectra, the “68% window”, constructed as described in Section 8.1, is shown for illustration as well as a Gaussian fit to the same distribution and the corresponding “\(1\sigma\) window” from this fit. The mean and width from this fit are used in the quantification of the mass pileup dependence as described in Section 8.2.

Figure 7: Heat map showing the efficiency for the QCD background jets within the 68% window for the signal \(W\) boson jets in the low \(p_{\mathrm{T}}\) (a) and high \(p_{\mathrm{T}}\) (b) kinematic regions, as determined by the ungroomed truth jet \(p_{\mathrm{T}}\).

### Pileup Dependence of the Mass

As discussed in Section 8.1, there are significant differences in the relative ability of the reconstructed jet mass to discriminate between signal \(W\) boson jets and QCD jets. However, because the jet mass itself takes into account both the energy scale of the jet as well as the angular spread of this energy, the effects from wide-angle pileup contributions are even more apparent than for the jet energy, resulting in large changes in the mass distribution as the pileup changes. This may be seen in Figure 8, where the mass distribution is shown in two different bins of the number of reconstructed primary vertices (\(N_{\mathrm{PV}}\)).

While understanding the pileup-dependence of the jet mass scale and resolution is important, the pileup dependence of the uncalibrated mass resolution are mixed with scale shifts, making a comparison difficult. Additionally, the jet mass scale and resolution depend on their truth jet counterparts to define the mass response \(m_{\mathrm{reco}}/m_{\mathrm{truth}}\), which relies on the assumption that the truth jet energy flow is affected in a comparable way to the reconstructed energy flow when performing grooming on the jet. For these reasons, the reconstructed \(W\) boson peak central value and width are used instead. These values are much less affected by the calibration, and may also be used to gauge the relative dependence of the mass scale and resolution as a function of pileup.

To quantify these effects, the \(W\) boson peak reconstructed mass spectrum is iteratively fit with a Gaussian in exclusive bins of \(N_{\mathrm{PV}}\) to extract the central value, and the size of the full 68% window is used as a measure of the width of the peak. These measures are then examined as a function of \(N_{\mathrm{PV}}\). Figures 9- 10 and 11- 12 respectively show the dependence of the central value and width of the mass peak on pileup for several of the grooming algorithms with the best background rejection, as determined in Section 8.1 as well as how they vary with different pileup mitigation algorithms. As expected, most grooming algorithms using LCTopo inputs observe a jet mass which tends to increase as \(N_{\mathrm{PV}}\) increases, since more uncorrelated energy is included within the jet. The standard trimming configuration (\(R_{\mathrm{sub}}=0.2\),\(f_{\mathrm{cut}}=5\%\)) performs better than either pruning or Soft Drop, which is unsurprising given that it was initially chosen because of its pileup independence. In all cases, applying a constituent correction procedure noticeably reduces this pileup dependency, though some more aggressive trimming configurations such as (\(R_{\mathrm{sub}}=0.1\),\(f_{\mathrm{cut}}=9\%\)) are stable even without pileup mitigation. Similar observations hold for the width of the reconstructed \(W\) boson peak.

A linear fit of the central value and width of the mass peak as a function of \(N_{\mathrm{PV}}\) is used to quantify the pileup dependence. These are also used as proxies for the pileup dependence of the jet mass scale and resolution respectively. The values of the slopes for both the central value and the width may be seen for all constituent and grooming configurations in Figures 13 and 14. Especially at low \(p_{\mathrm{T}}\), any of the constituent-level pileup mitigation techniques significantly outperform uncorrected LCTopo inputs. In particular, two constituent correction algorithms stand out as being particularly robust against pileup: CS+SK and VorSupp+SK. Between these two, the CS+SK combination is more stable against pileup in the low \(p_{\mathrm{T}}\) kinematic region as seen in Figure 13. While the variations in grooming algorithms are less drastic, a few trends may be observed. For Soft Drop grooming, smaller values of \(\beta\) are more stable under pileup, since they remove soft radiation more aggressively. With the exception of \(z_{\mathrm{cut}}=0.05\) which applies minimal grooming, the pileup dependence of Soft Drop is fairly robust. With pruning, high values of \(R_{\mathrm{cut}}\) and low values of \(z_{\mathrm{cut}}\) worsen the pileup dependence. Compared to the other grooming algorithms, trimming without pileup mitigation is more robust against pileup effects at low \(p_{\mathrm{T}}\), though these differences are greatly reduced after applying pileup mitigation on the inputs.

Figure 8: A representative comparison of reconstructed \(W\) boson jet mass in exclusive bins of the number of primary vertices (\(N_{\rm PV}\)), illustrating the shift to higher masses for increased pileup.

Figure 9: In the low \(p_{\rm T}\) (\(300<p_{\rm T}<500\) GeV) kinematic region, as determined by the ungroomed truth jet \(p_{\rm T}\), the mean value of a Gaussian fit to the reconstructed \(W\) boson mass peak as a function of the number of reconstructed primary vertices (\(N_{\rm PV}\)), presented here for the LCTopo, CS, and CS+SK jet constituent inputs are the Soft Drop (a), pruning (b), as well as the standard (c) and more aggressive (d) trimming configurations. For each combination of constituent correction and grooming algorithm, the dependence is parameterized by a linear fit to the respective spectrum.

Figure 10: In the high \(p_{\rm T}\) (\(1000<p_{\rm T}<1500\) GeV) kinematic region, as determined by the ungroomed truth jet \(p_{\rm T}\), the mean value of a Gaussian fit to the reconstructed \(W\) boson mass peak as a function of the number of reconstructed primary vertices (\(N_{\rm PV}\)), presented here for the LCTopo, CS, and CS+SK jet constituent inputs are the Soft Drop (a), pruning (b), as well as the standard (c) and more aggressive (d) trimming configurations. For each combination of constituent correction and grooming algorithm, the dependence is parameterized by a linear fit to the respective spectrum.

Figure 11: In the low \(p_{\rm T}\) (\(300<p_{\rm T}<500\) GeV) kinematic region, as determined by the ungroomed truth jet \(p_{\rm T}\), the width of a Gaussian fit to the reconstructed \(W\) boson mass peak as a function of the number of reconstructed primary vertices (\(N_{\rm PV}\)), presented here for the LCTopo, CS, and CS+SK jet constituent inputs are the Soft Drop (a), pruning (b), as well as the standard (c) and more aggressive (d) trimming configurations. For each combination of constituent correction and grooming algorithm, the dependence is parameterized by a linear fit to the respective spectrum.

Figure 12: In the high \(p_{\rm T}\) (\(1000<p_{\rm T}<1500\) GeV) kinematic region, as determined by the ungroomed truth jet \(p_{\rm T}\), the width of a Gaussian fit to the reconstructed \(W\) boson mass peak as a function of the number of reconstructed primary vertices (\(N_{\rm PV}\)), presented here for the LCTopo, CS, and CS+SK jet constituent inputs are the Soft Drop (a), pruning (b), as well as the standard (c) and more aggressive (d) trimming configurations. For each combination of constituent correction and grooming algorithm, the dependence is parameterized by a linear fit to the respective spectrum.

Figure 13: The dependence of the mean of the \(W\) boson mass on the number of reconstructed primary vertices (\(N_{\text{PV}}\)) is shown for all combinations of constituent types (x-axis) and grooming algorithms (y-axis) used during jet reconstruction using the anti-\(k_{t}\) jet algorithm with \(R=1.0\). This is shown for both low-\(p_{\text{T}}\) (a) and high-\(p_{\text{T}}\) (b) kinematic regions, as determined by the ungroomed truth jet \(p_{\text{T}}\).

Figure 14: The dependence of the width of the \(W\) boson mass on the number of reconstructed primary vertices (\(N_{\text{PV}}\)) is shown for all combinations of constituent types (x-axis) and grooming algorithms (y-axis) used during jet reconstruction using the anti-\(k_{t}\) jet algorithm with \(R=1.0\). This is shown for both low-\(p_{\text{T}}\) (a) and high-\(p_{\text{T}}\) (b) kinematic regions, as determined by the ungroomed truth jet \(p_{\text{T}}\).

### Pileup Dependence of the \(D_{2}\) Jet Substructure Tagging Observable

Many applications of large-\(R\) jets make use of jet substructure observables in addition to the mass. In particular, the \(D_{2}\) observable characterizes the hard structure of the radiation within a jet in a way that exploits the correlations between _all_ pairs and triplets of jet constituents in a way that more heavily relies on the spatial distribution of the energy flow. However, since \(D_{2}\) is dependent on the fine structure of the jet, this also leads to an increased pileup dependence. As seen in Figure 15, the degree to which pileup affects the shape of the \(D_{2}\) distribution depends significantly on the choice of both grooming algorithm and input type. The \(D_{2}\) distribution for a few choices of jet inputs and grooming algorithms may be seen in Figures 15- 17. While the pileup dependence decreases at higher \(p_{\mathrm{T}}\) and is not always as extreme as the examples shown here, it is generally more noticeable without constituent-based pileup mitigation, i.e. with LCTopo clusters as inputs.

To quantify the effects of pileup on the behaviour of \(D_{2}\), the variation of the signal efficiency for \(W\) jets to fulfil a \(D_{2}\) only tagging criteria is studied. For each jet reconstruction technique, the 50% signal efficiency cut is determined for jets with mass greater than 50 GeV in the low pileup region of \(0<N_{\mathrm{PV}}<15\), where the mass cut focuses on more signal-like jets. This cut is then applied for a range of \(N_{\mathrm{PV}}\) bins, and the efficiency of this cut is calculated in each bin, as shown in Figure 18. The behaviour of the efficiency is parametrized with a linear fit and the slope of this line is used to characterize the pileup dependence. Figure 19 shows a summary of the slope of the \(D_{2}\) tagging efficiency as a function of pileup, for all different input and grooming combinations. The conclusions from the \(D_{2}\) efficiency metric are consistent with those drawn from the \(W\) boson mass peak presented in Section 8.2. In particular, CS+SK and VorSupp+SK constituent correction algorithms are the most robust against pileup with CS+SK performing slightly better. The trimming algorithm is the exception, since its pileup dependence is stable even without constituent-based pileup mitigation. While the differences between grooming algorithms are decreased after pileup mitigation, but some observations about the trends the pileup dependence in grooming algorithms may be made. Soft Drop with \(z_{\mathrm{cut}}=0.05\) is highly pileup dependent before pileup mitigation, since it applies very little grooming to the jets. For trimming, smaller values of \(R_{\mathrm{sub}}\) are more robust against pileup than higher values. Large values of \(R_{\mathrm{cut}}\) are more pileup dependent for pruning, as are smaller values of \(z_{\mathrm{cut}}\).

For completeness, and to complement these studies of the signal behaviour, Figure 20 shows the dependence of the background efficiency, characterized in the same manner, for the selection defined by the signal. In this case, the effects of pileup on the background \(D_{2}\) efficiency are less significant for both the low- and high-\(p_{\mathrm{T}}\) kinematic regions.

Figure 15: For a low-\(p_{\rm T}\) kinematic region, as determined by the ungroomed truth jet \(p_{\rm T}\), the \(D_{2}\) distribution of \(W\) boson jets in events with low and high pileup for jets formed from LCTopo clusters ((a), (c)) and LCTopo+CS+SK corrected clusters ((b), (d)) and groomed with the Soft Drop algorithm with \(z_{\rm cut}=0.05\) and \(\beta=0\) ((a), (b)) and \(z_{\rm cut}=0.1\) and \(\beta=0\) ((c), (d)).

Figure 16: For a low-\(p_{\rm T}\) kinematic region, as determined by the ungroomed truth jet \(p_{\rm T}\), the \(D_{2}\) distribution of \(W\) boson jets in events with low and high pileup for jets formed from LCTopo clusters (a) and LCTopo+CS+SK corrected clusters (b) and groomed with the pruning algorithm with \(z_{\rm cut}=0.15\) and \(R_{\rm cut}=0.25\).

Figure 17: For a low-\(p_{\rm T}\) kinematic region, as determined by the ungroomed truth jet \(p_{\rm T}\), the \(D_{2}\) distribution of \(W\) boson jets in events with low and high pileup for jets formed from LCTopo clusters ((a), (c)) and LCTopo+CS+SK corrected clusters ((b), (d)) and groomed with the trimming algorithm with \(R_{\rm sub}=0.02\) and \(f_{\rm cut}=5\%\) ((a), (b)) and \(R_{\rm sub}=0.1\) and \(f_{\rm cut}=9\%\) ((c), (d)).

Figure 18: The dependence of the signal \(W\) jet identification efficiency for a \(D_{2}\) selection, chosen at low \(N_{\text{PV}}\) to provide 50% signal efficiency for \(W\) boson jets, as a function of the number of reconstructed primary vertices for a low-\(p_{\text{T}}\) kinematic selection of jets, as determined by the ungroomed truth jet \(p_{\text{T}}\). Presented here for the LCTopo, CS, and CS+SK jet constituent inputs are the Soft Drops (a), pruning (b), as well as the standard (c) and more aggressive trimming (d) configurations. For each combination of constituent correction and grooming algorithm, the dependence is parameterized by a linear fit.

Figure 19: The dependence of the \(D_{2}\) selection efficiency on the number of reconstructed primary vertices (\(N_{\text{PV}}\)) for \(W\) boson jets is shown for all combinations of constituent types (x-axis) and grooming algorithms (y-axis) used during jet reconstruction using the anti-\(k_{t}\) jet algorithm with \(R=1.0\). This is shown for both low-\(p_{\text{T}}\) (a) and high-\(p_{\text{T}}\) (b) kinematic regions, as determined by the ungroomed truth jet \(p_{\text{T}}\).

Figure 20: The dependence of the \(D_{2}\) selection efficiency on the number of reconstructed primary vertices (\(N_{\mathrm{PV}}\)) for QCD jets is shown for all combinations of constituent types (\(x\)-axis) and grooming algorithms (y-axis) used during jet reconstruction using the anti-\(k_{t}\) jet algorithm with \(R=1.0\). This is shown for both low-\(p_{\mathrm{T}}\) (a) and high-\(p_{\mathrm{T}}\) (b) kinematic regions, as determined by the ungroomed truth jet \(p_{\mathrm{T}}\).

### Summary

Based on the studies presented in Section 8, no single combination of constituent type and grooming algorithm is clearly superior. However, these studies do illustrate general tendencies that give insight into the interplay of the two jet correction methods and allow for the reduction of the scope of large-\(R\) jet reconstruction optimization. These observations, summarized here, lead to a reduced list of jet reconstruction techniques, shown in Table 3, that are calibrated and compared in Section 9.

The pileup dependence studies in Sections 8.2 and 8.3 clearly show that CS+SK and VorSupp+SK are consistently the most robust against pileup, independent of the grooming method applied. Since CS outperforms VorSupp by a slight amount when considering the pileup dependence and it is found in Section 9.1 that the calibration of the jet mass scale is robust against the exact jet reconstruction algorithm used, only jets formed from CS+SK clusters are studied in the second stage of optimization, with the exception of the standard trimmed jet collection which are formed from LCTopo clusters, and reclustered jets which are formed from EMTopo clusters.

For grooming algorithms, the largest effects are seen in the discrimination of signal and background in Section 8.1. Particularly in the high-\(p_{\mathrm{T}}\) region, it can be seen that the Soft Drop algorithm performs significantly better at separating signal \(W\) jets from QCD jets based on a selection on the jet mass alone. However, to ensure a fair comparison of different grooming algorithms in the second stage of optimization, at least one configuration is chosen from each broad class of jet grooming methods. For these studies, we consider Soft Drop and mMDT to be in the same class, since Soft Drop with \(\beta=0\) reduces to mMDT without filtering. Since Soft Drop with \(\beta=0\) is optimal among the Soft Drop algorithms, and since it also performs better than mMDT with filtering, we only consider Soft Drop with \(\beta=0\), or equivalently mMDT without filtering. For \(z_{\mathrm{cut}}\), there are similar results for all choices except \(z_{\mathrm{cut}}=0.05\), which clearly has worse performance. A choice of \(z_{\mathrm{cut}}=0.10\) performs comparably to the other best configurations and is the same as the CMS configuration [42], so Soft Drop with \(\beta=0\), \(z_{\mathrm{cut}}=0.10\) was chosen as the one of the final jet collections. For pruning, a large value of \(R_{\mathrm{cut}}\) worsens the background rejection, so \(R_{\mathrm{cut}}=0.15\) was chosen as the optimal value with \(z_{\mathrm{cut}}=0.25\). For the optimal configuration, \(z_{\mathrm{cut}}=0.15\), \(R_{\mathrm{cut}}=0.25\) was chosen. For trimming, there is difference between low- and high-\(p_{\mathrm{T}}\) performance. At high \(p_{\mathrm{T}}\), a smaller \(R_{\mathrm{sub}}\) value is optimal, while a moderate choice is better for lower \(p_{\mathrm{T}}\). An aggressive choice of \(f_{\mathrm{cut}}\) for trimming degrades the background rejection. Although \(R_{\mathrm{sub}}=0.2\) is marginally better for low \(p_{\mathrm{T}}\), \(R_{\mathrm{sub}}=0.1\) is significantly better at high \(p_{\mathrm{T}}\), so the optimal configuration is chosen to be \(R_{\mathrm{sub}}=0.1\), and \(f_{\mathrm{cut}}=0.09\) which is more aggressive than the standard trimming configuration of \(R_{\mathrm{sub}}=0.2\) and \(f_{\mathrm{cut}}=0.05\). The standard trimming configuration with LCTopo inputs is also retained as a benchmark for relative comparisons. In addition to these large-\(R\) grooming algorithms, the conventional reclustering algorithm, using small-\(R\) jets built from EMTopo clusters as inputs with a large-\(R\) radius parameter of

\begin{table}
\begin{tabular}{|c|c|c|} \hline Constituent Type & Grooming Algorithm & Parameter Choice \\ \hline CS+SK & Soft Drop & \(z_{\mathrm{cut}}=0.1\), \(\beta=0\) \\ CS+SK & Pruning & \(z_{\mathrm{cut}}=0.15\), \(R_{\mathrm{cut}}=0.25\) \\ CS+SK & Trimming & \(R_{\mathrm{sub}}=0.1\), \(f_{\mathrm{cut}}=9\%\) \\ LCTopo & Trimming & \(R_{\mathrm{sub}}=0.2\), \(f_{\mathrm{cut}}=5\%\) \\ EMTopo & Reclustering & \(R(small\mathrm{-R})=0.4\), \(f_{\mathrm{cut}}=5\%\) \\ \hline \end{tabular}
\end{table}
Table 3: Summary of the jet reconstruction algorithms, constituent corrections and grooming algorithm, determined to be optimal as well as the the default trimming algorithm already used on ATLAS (LCTopo, \(R_{\mathrm{sub}}=0.2\), \(f_{\mathrm{cut}}=5\%\)). These are the jet collections whose calibrated performance is compared.

\(R=1.0\) and a trimming fraction of \(f_{\text{cut}}=5\%\) is retained as this is the choice used by most analyses in ATLAS that use reclustered jets.

## 9 Performance of Optimal Algorithms

After reducing the set of jet reconstruction algorithms to a concise list, summarized in Table 3, a more detailed comparison of the performance of the algorithms is done following a calibration of the jet energy scale (JES) and jet mass scale (JMS). This calibration is necessary to restore the jet to the full hadronic scale, consistent with a jet formed from truth particles with the same grooming procedure as the reconstructed jet, thereby allowing for a more meaningful comparison of the performance of the various constituent types and grooming procedures

### Jet Calibration Procedure

The large-\(R\) jet calibration chain used in this study is similar to the standard calibration procedure used in ATLAS [43]. These calibrations are required in order to correct the jet reconstruction and energy measurements for calorimeter non-uniformity and non-compensation, resolution effects from fluctuations in particle showers, dead material, and other effects. In the case of the large-\(R\) jet reconstruction techniques studied here, constituent corrections and grooming techniques have been applied to correct for the effects of pileup. As such, large-\(R\) jets are not corrected using area subtraction and residual pileup correction [23] techniques7. For the JES, a correction is applied to both the jet energy and \(\eta\). This is followed by a JMS calibration, as described in Reference [44], in which the multiplicative correction to the reconstructed jet mass is parametrized as a function of the jet \(p_{\text{T}}\), \(\eta\), and mass and applied such that the energy of the jet is left unchanged. When performing these calibrations, and subsequently examining the response distributions in Figures 21 and 22, jets that are composed of a single constituent and thereby have a mass of 0 GeV are not considered. The fraction of jets that are removed by this requirement will vary on an algorithm-by-algorithm basis and are shown in Table 4. The differences between the algorithms are noteable, with pruning and soft drop removing greater than 10% of jets in certain cases, indicating that the set of jets for which the resolution is being compared in Figure 23 is not identical.

Footnote 7: The exception is the reclustered jet collection, built from small-\(R\) jets which themselves have had an area subtraction and residual correction applied. Additionally, the JMS is applied to the small-\(R\) jets before reclustering

The results from this calibration procedure are shown in Figures 21 and 22, for a set of jets whose truth jet counterpart lies in the vicinity of the \(W\) boson mass (i.e. [70,90] GeV), demonstrating that the application of the standard JMS calibration procedure successfully restores the full hadronic scale response of the bulk of jets to unity independent of the reconstruction algorithm. However, there are marked differences in the low response tail of these jets, largely due to the differences in the application of the various grooming algorithms. These differences, along with the differences in the core of the response, are quantified using the inter-quantile range (IQRnR), as defined in Reference [44], and used to quantify the resolution of the jet reconstruction algorithm. This resolution is presented as a function of the jet \(p_{\text{T}}\) in Figure 23 showing that of the algorithms found to be most optimal in Section 8, there are clear differences in the performance after calibration. First, a retuning of the trimming algorithm to use more aggressive parameter choices (\(R_{\text{sub}}=0.1\) and \(f_{\text{cut}}=9\%\)) as well as the use of the optimal pruning configuration are found to produce a calibrated jet collection with a resolution that is up to 30% worse than either the standard trimmed jet collection built from LCTopo clusters or the optimal Soft Drop configuration (\(z_{\text{cut}}=0.1\) and \(\beta=0\)) built 

[MISSING_PAGE_FAIL:38]

Figure 22: The jet mass response (\(m_{\rm reco}/m_{\rm truth}\)) distribution for QCD jets (a),(b) and \(W\) boson jets (c),(d), for the jet collections listed in Table 3 both before (a),(c) and after (b),(d) the MC-based JMS calibration for the low-\(p_{\rm T}\) kinematic region with \(m_{\rm truth}=\in[70,90]\) GeV.

## 6 Conclusions

Figure 23: For the region of \(m_{\rm truth}\in[70,90]\) GeV for QCD jets (a) and \(W\) boson jets (b), the jet mass resolution, parameterized in terms of one half of the 68% inter-quantile range divided by the median of the jet mass response distribution for the jet collections listed in Table 3.

### Calibrated Performance Comparison

Two additional comparisons are done in order to emulate the performance of a simple tagger. First, the performance of a mass-only tagging criteria is quantified by scanning a selection on the mass. As seen in Figure 24, the mass distribution varies significantly for both signal and background between the four selected jet algorithms. For a given target signal efficiency, the location and width of this window is determined using the signal \(W\) jets only as the window of minimum width that encapsulates the desired fraction of the signal jets. This is the same procedure as is used in the comparison of the background rejection as implemented in Section 8.1, but is now used to characterize the full performance capability using only mass as a discriminating observable. This simple tagging criteria is used as a means to compare the large-\(R\) jets that use clusters as inputs directly to jet reconstruction with reclustered jets which are typically used by analyses for which a selection on jet mass alone is sufficient. The result of this selection is shown in Figure 25. At low \(p_{\mathrm{T}}\), the differences between algorithms is relatively small, since the QCD jets tend to have lower mass, and reclustering stands out as the optimal tagger for nearly the entire range of signal efficiency. The exception to this is at very high tagging efficiency, where the background rejection drops for i pruning and trimming with \(f_{\mathrm{cut}}=0.09\) and \(R_{\mathrm{sub}}=0.01\). This is due to the low-mass peak in the \(W\) jet mass distributions for these two algorithms, seen in Figure 24(a), which happen when the jet has been over-groomed. At high-\(p_{\mathrm{T}}\), the three new optimized algorithms perform better than the standard trimming algorithm and reclustering. Similarly to at low \(p_{\mathrm{T}}\), pruning worsens its performance at high tagging efficiency, because of the long low-mass tail seen in Figure 24(b). Since the optimal jet collections were determined based on their pileup stability and background rejection, this behavior is as expected.

As a second comparison, for the non-reclustered large-\(R\) reconstruction algorithms, the performance for a both mass and \(D_{2}\) is evaluated for a tagger similar to that described in Reference [5]. First, a selection on the jet mass is determined using the same algorithm described in Section 8.1 that selects the smallest mass window which contains 68% of the signal. The distribution of \(D_{2}\) for the different jet collections may be seen in Figure 26. The selection on the \(D_{2}\) observable is then varied to create the full ROC curves shown in Figure 27. The overall performance after applying a selection on \(D_{2}\) changes dramatically. The standard trimmed jet reconstruction algorithm using LCTopo constituents gives the optimal performance for this metric, at both low and high \(p_{\mathrm{T}}\). At low \(p_{\mathrm{T}}\), Soft Drop performs nearly as well as the standard trimming algorithm, but its performance drops substantially at high \(p_{\mathrm{T}}\). Pruning and trimming with \(R_{\mathrm{sub}}=0.1\) both perform worse than Soft Drop and standard trimming.

Some understanding of this behavior may be seen in Figure 26. Particularly at high \(p_{\mathrm{T}}\), the new algorithms leave the \(W\) jet \(D_{2}\) distribution fairly similar to the standard trimming algorithm, while the QCD \(D_{2}\) distribution is affected much more. Since the mass distributions of all of these keep the \(W\) jet mass peak, most of the two-prong structure is preserved in the signal jets, leaving all of the algorithms with similar \(D_{2}\) distributions for the \(W\) jets. For QCD jets, the new algorithms cut away radiation more aggressively than the standard trimming algorithm. This results in fewer clusters in the jet, resulting in less discrimination between \(W\) and QCD jets.

Figure 24: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, a comparison of reconstructed jet mass between signal \(W\) boson jets and background QCD jets for the most performant reconstruction algorithms.

Figure 25: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, ROC curves benchmarking the signal \(W\) boson jet efficiency versus QCD jet rejection for a selection on jet mass alone.

Figure 26: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, a comparison of \(D_{2}\) observable between signal \(W\) boson jets and background QCD jets for the most performant reconstruction algorithms after performing a selection on the jet mass that retains 68% of the signal \(W\) boson jets using a mass window selection that is the minimum width window possible.

Figure 27: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, ROC curves benchmarking the signal \(W\) boson jet efficiency versus QCD jet rejection for a simplified \(W\) boson tagger defined by a fixed selection on jet mass and a variable selection on \(D_{2}\).

To better understand the tagging behavior, the performance of 4 different jet collections were compared: ungroomed jets with both LCTopo and CS+SK inputs, as well as the standard trimming algorithm with both LCTopo and CS+SK inputs. As seen in Figures 28 and 31, the input type has little effect on the trimmed jet collection, while on the ungroomed collection, constituent-level pileup mitigation substantially improves the performance. Before grooming is applied, cutting away the soft radiation in a jet through constituent-level pileup mitigation helps restore the expected mass peak, as seen in Figure 28, though to a lesser degree than grooming. For trimming, most of this soft radiation is cut away even without constituent-level pileup mitigation, so there is not a significant effect on the tagging performance. Despite the fact that constituent-level pileup mitigation is cutting away some of the soft radiation in the jet, this does not have a significant effect on the \(D_{2}\) distribution after trimming, as seen in Figure 30. This means that the drop in performance for the new grooming algorithms seen in Figure 27 is due to the choices in grooming, not the input cluster collection. While the tagging performance of groomed jets is left unchanged by constituent-level pileup mitigation, the behavior of the \(D_{2}\) and mass distributions is more stable after constituent-level pileup mitigation is applied. This leads to the conclusion that constituent-level pileup mitigation is beneficial in improving the pileup stability, while not cutting away radiation critical in discriminating between \(W\) and QCD jets.

Figure 28: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, a comparison of reconstructed jet mass between signal \(W\) boson jets and background QCD jets for two types of jet inputs (LCTopo and CSSK), for both groomed and ungroomed jets.

Figure 29: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, ROC curves benchmarking the signal \(W\) boson jet efficiency versus QCD jet rejection for a selection on jet mass alone.

Figure 30: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, a comparison of \(D_{2}\) observable between signal \(W\) boson jets and background QCD jets for two types of jet inputs (LCTopo and CSSK), for both groomed and ungroomed jets. These are made after performing a selection on the jet mass that retains 68% of the signal \(W\) boson jets using a mass window selection that is the minimum width window possible.

Figure 31: For low-\(p_{\rm T}\) (a) and high-\(p_{\rm T}\) (b) kinematic regions, ROC curves benchmarking the signal \(W\) boson jet efficiency versus QCD jet rejection for a simplified \(W\) boson tagger defined by a fixed selection on jet mass and a variable selection on \(D_{2}\).

## 10 Truth-Level Studies

While much may be learned about the constituent correction and jet grooming algorithms through the types of studies shown in Sections 8 and 9, a more basic understanding of their performance has previously been limited due to the nature of the digitization procedure applied during the ATLAS simulation [21]. Typically, the energy contributions to a single calorimeter cell from both the hard-scattering event and pileup interactions are combined during digitization prior to event reconstruction - only the total amount of reconstructed energy per-calorimeter-cell would be present in reconstructed data. A new procedure which propagates the fraction of pileup energy deposited in a given cell forward through the digitization and reconstruction procedures has been developed. This technique provides new opportunities to study the effect of various grooming and pileup mitigation algorithms on jets reconstructed by ATLAS.

The result of this propagation are digitized and reconstructed energies for each calorimeter cell which are attributable to the hard scatter8 and pileup interactions. In the studies presented here, the amount of the total reconstructed energy within each topological cluster that originates from the hard-scatter energy flow is determined, following the application of the constituent-level pileup-mitigation and jet grooming procedures studied earlier in this document. Using this information, it is possible to determine the extent to which constituent-level corrections and jet grooming techniques remove pileup contamination from jets. These studies are performed with a limited set of signal (high-\(p_{\mathrm{T}}\)\(W\) bosons originating from the decay of massive, exotic \(W^{\prime}\) particles) and background (dijet) samples described in Section 3 which were augmented to contain this additional digitisation-related information for each calorimeter cell. For dijet events, the anti-\(k_{t}\)\(R=1.0\) jet with the highest \(p_{\mathrm{T}}\) is studied, while for the \(W^{\prime}\) sample, jets are only selected if they have the highest \(p_{\mathrm{T}}\) in the event and are also matched to a \(W\) boson particle at generator-level.

Footnote 8: Contributions from initial- and final- state radiation, as well as from the underlying event, are included in this component of the cell energy.

Shown in Figure 32 is the the fraction of the total topological cluster energy deposited by the hard scatter as a function of the total energy, for clusters within the leading large-\(R\) jet in signal \(W\) boson jets. Several different cluster input types are shown, including locally-calibrated topological clusters, as well as clusters to which the Constituent Subtraction and SoftKiller algorithms have been applied. Two populations of clusters are observed in each case, in which the dominant energy contribution is either from the hard-scatter or pileup energy. Furthermore, it can be seen that in a non-negligible fraction of clusters, the fraction of hard scatter energy is greater than one. This is due to the contribution of out of time pileup which can have the effect of producing a negative energy contribution due to the pulse shaping of the electromagnetic calorimeter. The application of advanced pileup mitigation techniques preferentially removes pileup dominated topological clusters from the selected jets, though a population of pileup dominated clusters is still observed even following the sequential application of both algorithms. While many hard-scatter dominated clusters are removed, these tend to be low-\(p_{\mathrm{T}}\) clusters, which will have a small impact on the jet reconstruction. These observations are quantified in Table 5, which lists the fraction of hard-scatter dominated (where \(>50\%\) of the cluster energy does not originate from pileup) and pileup dominated (where \(>50\%\) of the cluster energy is deposited by pileup interactions) topological clusters which remain following the application of each constituent-level pileup mitigation technique.

To gain more insight into the behavior of the subset of algorithms outlined in Table 3, similar studies are performed on groomed jets. Figure 33 shows the impact of each grooming algorithm on signal \(W\) boson jets. All grooming procedures greatly reduce the amount of pileup dominated topological clusters which are present in the groomed jet, though both the more aggressive trimming configuration(\(f_{\mathrm{cut}}=9\%\)\(R_{\text{sub}}=0.1\)) and pruning configuration(\(R_{\text{cut}}=0.25\), \(z_{\text{cut}}=0.15\)) also have a significant impact on the hard-scatter dominated cluster population. The fraction of hard-scatter and pileup dominated clusters for signal and background jets are also listed in Table 6. The shortlisted trimming and pruning procedures are noted to be significantly more aggressive than the current trimming and shortlisted Soft Drop procedures. This reinforces the conclusions drawn in Section 9, where the tagging performance of the pruning and trimming (\(f_{\text{cut}}=9\%\), \(R_{\text{sub}}=0.1\)) is degraded because of how aggressively they cut away the soft parts of the jet. The Soft Drop (\(\beta=0.0\), \(z_{\text{cut}}=0.1\)) configuration leaves the largest population of pileup dominated clusters following grooming in this population of signal \(W\) boson jets. This is also consistent with the tagging results from Section 9, where it performed fairly well at low \(p_{\text{T}}\), since it left more of the HS event to allow differentiation between QCD and \(W\) jets. While the standard trimming configuration does leave slightly more pileup clusters than the more aggressive trimming configuration and pruning, it is not clear that the soft-scatter dominated cluster population is more aggressive than the soft-scatter dominated cluster population.

Figure 32: The fraction of the total topological cluster energy deposited by the hard-scatter as a function of the cluster energy for the leading large-\(R\) jet matched to a \(W\) boson in exotic \(W^{\prime}\to WZ\to qqqq\) events which produce high-\(p_{\text{T}}\)\(W\) bosons. These jets are reconstructed using the anti-\(k_{t}\) algorithm with \(R=1.0\), from (a) locally-calibrated topological clusters, as well as from clusters which have been treated with the (b) constituent-subtraction and (c) SoftKiller algorithms. The sequential application of both Constituent Subtraction and SoftKiller to the same set of clusters is shown in (d).

also leaves significantly more of the HS event, explaining why its tagging performance was so much better than the other algorithms. This demonstrates that both pileup suppression and retention of HS clusters necessary for good tagging performance.

## 11 Conclusions

pThe performance of large-\(R\) jet reconstruction, with the aim of improving the ability to resolve differences between jets with hard substructure (e.g. \(W\) boson jets) from background jets (e.g. QCD jets), has been evaluated based on several metrics quantifying tagging performance and pileup stability for a wide range of input constituent types and and grooming algorithms.

These studies demonstrate that applying constituent-level pileup mitigation techniques can minimize pileup dependence, even for jets which have already been groomed, based on the pileup stability of the \(W\) jet mass peak and width as well as the stability of the \(D_{2}\) distribution. Constituent-level pileup mitigation allows for the consideration of a broader class of jet grooming algorithms while not significantly altering the mass and \(D_{2}\) distributions of the jet algorithm. Specifically, the combination of constituent subtraction and SoftKiller provides the most pileup stability of the pileup mitigation algorithms considered in these results.

Based on the performance of the uncalibrated pileup dependence and mass-based background rejection, several jet collections were chosen to compare in detail to the standard trimming and reclustering algorithms which are currently used by ATLAS. Based on the pileup dependence, CS+SK was found to be the optimal constituent-level pileup mitigation technique for all grooming algorithms. For mass-based background

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline Grooming Algorithm & Input Type & \multicolumn{2}{c|}{\(W^{\prime}\to WZ\)} & \multicolumn{2}{c|}{Dijets} \\ \hline  & & Hard-Scatter & Pile-Up & Hard-Scatter & Pile-Up \\ \hline \hline Trimming (\(f_{\text{cut}}=5\%\), \(R_{\text{sub}}=0.2\)) & LCTopo & 0.63 & 0.08 & 0.50 & 0.03 \\ Trimming (\(f_{\text{cut}}=9\%\), \(R_{\text{sub}}=0.1\)) & CS+SK & 0.34 & 0.01 & 0.27 & 0.00 \\ Pruning (\(R_{\text{cut}}=0.25\), \(z_{\text{cut}}=0.15\)) & CS+SK & 0.42 & 0.03 & 0.30 & 0.00 \\ Soft Drop (\(\beta=0.0\), \(z_{\text{cut}}=0.1\)) & CS+SK & 0.80 & 0.30 & 0.47 & 0.13 \\ \hline \end{tabular}
\end{table}
Table 6: The fraction of hard-scatter dominated (where \(>50\%\) of the cluster energy does not originate from pileup) and pileup dominated (where \(>50\%\) of the cluster energy is deposited by pileup interactions) topological clusters which remain in groomed \(W^{\prime}\to WZ\) and dijet events following the application of the short-listed grooming procedures, listed earlier in Table 3.

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline Input Type & \multicolumn{2}{c|}{\(W^{\prime}\to WZ\)} & \multicolumn{2}{c|}{Dijets} \\ \hline  & Hard-Scatter & Pile-Up & Hard-Scatter & Pile-Up \\ \hline \hline Constituent Subtraction & 0.94 & 0.47 & 0.85 & 0.55 \\ SoftKiller & 0.74 & 0.46 & 0.78 & 0.48 \\ CS+SK & 0.84 & 0.56 & 0.85 & 0.55 \\ \hline \end{tabular}
\end{table}
Table 5: The fraction of hard-scatter dominated (where \(>50\%\) of the cluster energy does not originate from pileup) and pileup dominated (where \(>50\%\) of the cluster energy is deposited by pileup interactions) topological clusters which remain in ungroomed \(W\) boson jets and QCD jets following the application of several constituent-level pileup mitigation techniques.

rejection, grooming configurations which aggressively cut away clusters in the background QCD jets are found to provide the best background rejection. From these results, one configuration was chosen from each class of grooming algorithm to do a more detailed study. The grooming algorithms and configurations chosen were soft drop with \(\beta=0\) and \(z_{\rm cut}=0.1\), trimming with \(R_{\rm sub}=0.1\) and \(f_{\rm cut}=9\%\), and pruning with \(z_{\rm cut}=0.15\) and \(R_{\rm cut}=0.25\). Additionally, these were compared with two standard large-\(R\) jet collections used in ATLAS, trimming with \(R_{\rm sub}=0.2\) and \(f_{\rm cut}=5\%\) and reclustering with R\(=0.4\) jets formed from uncalibrated topoclusters.

It is found that in comparison to the canonical ATLAS large-\(R\) jet reconstruction and grooming procedure (anti-\(k_{t}\)\(R=1.0\) jets, trimmed with \(R_{\rm sub}=0.2\) and \(f_{\rm cut}=5\%\)), the mass-based \(W\) boson identification may

Figure 33: The fraction of the total topological cluster energy deposited by the hard-scatter as a function of the cluster energy for the leading large-\(R\) jet matched to a \(W\) boson in exotic \(W^{\prime}\to WZ\to qqqq\) events which produce high-\(p_{\rm T}\)\(W\) bosons. These jets are reconstructed using the anti-\(k_{t}\) algorithm with \(R=1.0\), from locally-calibrated topological clusters which have been treated sequentially with the constituent-subtraction and SoftKiller algorithms, then trimmed with the grooming algorithms listed in Table 3. The application of each grooming algorithm greatly reduces the population of pileup dominated clusters, though both retuned trimming (b) and pruning (c) also have a severe impact on the number of hard-scatter dominated clusters.

be improved by around a factor of two, with the largest gains seen at high-\(p_{\rm T}\). However, when considering the tagging performance of \(D_{2}\) in combination with the jet mass, it is shown that these same grooming algorithms may degrade the tagging performance. Based on a comparison of the standard trimming algorithm with LCTopo inputs and CS+SK inputs, it is shown that the degradation of performance is due to the aggressiveness of the grooming algorithm, rather than the pileup mitigation technique.

A new technique which propagates the fraction of energy contributed to each calorimeter cell from the hard-scatter and pileup interactions during event digitisation has been presented in the context of these studies. A comparision of several constituent-level pileup mitigation techniques and jet grooming algorithms confirms that these procedures tend to preferentially remove pileup energy from reconstructed jets. This technique also demonstrates its usefulness in showing the \(D_{2}\) sensitivity to over-grooming and allows for a more in-depth understanding of the effects of grooming and pileup-mitigation on fully simulated events.

## References

* [1] ATLAS Collaboration, _Search for heavy particles decaying to pairs of highly-boosted top quarks using lepton-plus-jets events in proton-proton collisions at \(\sqrt{s}=13\) TeV with the ATLAS detector_, ATLAS-CONF-2016-014, 2016, url: [https://cds.cern.ch/record/2141001](https://cds.cern.ch/record/2141001).
* [2] ATLAS Collaboration, _Search for Dark Matter Produced in Association with a Higgs Boson Decaying to \(b\bar{b}\) using \(36\) fb\({}^{-1}\) of pp collisions at \(\sqrt{s}=13\) TeV with the ATLAS Detector_, (2017), arXiv: 1707.01302 [hep-ex].
* [3] ATLAS Collaboration, _Search for heavy resonances decaying to a \(W\) or \(Z\) boson and a Higgs boson in the \(q\bar{q}^{(\prime)}b\bar{b}\) final state in pp collisions at \(\sqrt{s}=13\) TeV with the ATLAS detector_, (2017), arXiv: 1707.06958 [hep-ex].
* [4] ATLAS Collaboration, _Measurements of \(t\bar{t}\) differential cross-sections in the all-hadronic channel with the ATLAS detector using highly boosted top quarks in pp collisions at \(\sqrt{s}=13\) TeV_, ATLAS-CONF-2016-100, 2016, url: [https://cds.cern.ch/record/2217231](https://cds.cern.ch/record/2217231).
* [5] ATLAS Collaboration, _Measurement of the \(t\bar{t}\) production cross-section using \(e\mu\) events with b-tagged jets in pp collisions at \(\sqrt{s}=13\) TeV with the ATLAS detector_, Phys. Lett. B **761** (2016) 136, arXiv: 1606.02699 [hep-ex].
* [6] ATLAS Collaboration, _Performance of Boosted \(W\) Boson Identification with the ATLAS Detector_, ATL-PHYS-PUB-2014-004, 2014, url: [https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PUBNOTES/ATL-PHYS-PUB-2014-004/](https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PUBNOTES/ATL-PHYS-PUB-2014-004/).
* [7] D. Krohn, J. Thaler and L.-T. Wang, _Jet Trimming_, JHEP **02** (2010) 084, arXiv: 0912.1342 [hep-ph].
* [8] S. D. Ellis, C. K. Vermilion and J. R. Walsh, _Recombination Algorithms and Jet Substructure: Pruning as a Tool for Heavy Particle Searches_, Phys. Rev. **D81** (2010) 094023, arXiv: 0912.0033 [hep-ph].
* [9] J. M. Butterworth, A. R. Davison, M. Rubin and G. P. Salam, _Jet substructure as a new Higgs search channel at the LHC_, Phys. Rev. Lett. **100** (2008) 242001, arXiv: 0802.2470 [hep-ph].
* [10] M. Dasgupta, A. Fregoso, S. Marzani and G. P. Salam, _Towards an understanding of jet substructure_, JHEP **09** (2013) 029, arXiv: 1307.0007 [hep-ph].
* [11] A. J. Larkoski, S. Marzani, G. Soyez and J. Thaler, _Soft Drop_, JHEP **05** (2014) 146, arXiv: 1402.2657 [hep-ph].
* [12] P. Berta, M. Spousta, D. W. Miller and R. Leitner, _Particle-level pileup subtraction for jets and jet shapes_, JHEP **06** (2014) 092, arXiv: 1403.3108 [hep-ex].
* [13] M. Cacciari, G. P. Salam and G. Soyez, _SoftKiller, a particle-level pileup removal method_, Eur. Phys. J. **C75** (2015) 59, arXiv: 1407.0408 [hep-ph].
* [14] ATLAS Collaboration, _Constituent-level pileup mitigation techniques in ATLAS_, (2017), url: [https://cds.cern.ch/record/2281055](https://cds.cern.ch/record/2281055).
* [15] B. Nachman, P. Nef, A. Schwartzman, M. Swiatlowski and C. Wanotayaroj, _Jets from Jets: Re-clustering as a tool for large radius jet reconstruction and grooming at the LHC_, JHEP **02** (2015) 075, arXiv: 1407.2922 [hep-ph].