# Analysis of the CIS calibration data of the new Tile Calorimeter bi-gain readout system.

I. Efthymiopoulos

CERN, Geneva, Switzerland

T. Kontos

CERN, Geneva, Switzerland

###### Abstract

For the 1997 test beam of the ATLAS/Tile Calorimeter ext. barrel prototypes, seven read-out channels (14 PMTs) were equipped with the new bi-gain read-out electronics. In this note the performance of this read-out is evaluated using mainly the charge injection calibration data. From the results obtained, the performance of the system is rather good, with low noise, good linearity, good internal resolution and stability in time over a period of about three months. Some weak points in the present first version of the system, like the presence of the leakage pulse, which makes it impossible to use the calibration data bellow \(\sim\)17pC are discussed as well. Finally some study on the laser data from the same read-out system is presented as well as the points left for further work.

ATLAS Internal Note

TILECAL -NO-143

January 15, 1998

## 1 General

For the front-end electronics of the Tile Calorimeter two readout schemes have been developed up to now:

1. In the first scheme, the so called **compressor**, the PMT signal after the shaper is passed through a compressor circuit with piecewise linear gain and it is digitized by a sampling ADC with 40MHz sampling frequency. This scheme has been already tested in three previous test beam periods: twice with the prototype modules and finally last year with the barrel module 0 detector, and has showed quite good performance[1]. 2. In the second scheme, the so called **bi-gain**, the PMT signal after the shaper is split in two ways: the first one is feed directly to the input of the ADC (_low gain_), while the second is first amplified and then feed to the same type of ADC (_high gain_). In this year's test beam the amplification factor between the low and high gains is set to about 16, while the top ofthe scale for the low gain channel is set to about 400 pC. A 12 bit ADC is used for both gains, again of 40 MHz sampling frequency.

In 1997 the two extended barrel Tile Calorimeter prototype modules were put on beam test in the H8 line. In order to do a study of the performance of the new bi-gain system and also allow some comparison with the compressor scheme, half of the readout cells of one of the extended barrel modules (7 cells or 14 channels/PMTs) were equipped with the bi-gain readout, while the rest (21 cells or 42 channels/PMTs) were equipped with the compressor readout. In Figure 1 the readout configuration for one of the modules equipped with the two types of readout electronics is shown.

Figure 1: The Extended barrel Module 0 cell geometry. The hatched area is the one equipped with the bi-gain readout for one of the modules (7 readout cells, 14 PMTs/channels in total).

## 2 The data sample

For the analysis presented in this note, two sets of data have been used:

* The _charge injection data_ (CIS) which correspond to the response of a known charge injected at the input of the shaper, and are used for the internal calibration of the complete electronics chain.
* The _laser data_ which correspond to the response of a known light pulse produced by a laser and transmitted to each photomultiplier with plastic fibers. This set of data can be used to monitor the stability in time and the linearity of the whole readout chain, since they include in addition of the charge injection system, the PMT response, provided that an "external" very accurate measurement of the injected light is available. In our case this is done with three photodiodes. It is also assumed that the light pulse generated by the laser is similar to the real particle data for which the shaper is optimized. Most of the analysis presented here is done on the first set of data, while the second is used to verify the results and extract information for the expected performance with the physics data. In the rest of this section a detailed description of the CIS calibration data sample is given.

### The CIS calibration data

Build in the 3in1 cards housed at each PMT block, there is a CIS system which is able to inject a predefined charge pulse into the shaper input. The pulse is generated by the discharge of a known precise capacitor (_Cref_), which is loaded using a DAC and a regulated reference voltage (_Vref_). The output voltage of the DAC which determines the charge of the capacitor, can be set using a pair of 8-bit registers (coarse and fine). The charge injected is given by the following relation:

\[Q=V_{ref}\cdot C_{ref}\cdot\frac{DAC_{coarse}}{255}\cdot\frac{DAC_{fine}}{255} \tag{1}\]

For the 1997 test beam implementation \(V_{ref}\)= 5 V, and \(C_{ref}\)= 128 pF. The timing of the signal which closes the switch for the capacitor discharge is generated by the 3in1 controller1, and can be set using again a pair of 8-bit registers (coarse and fine) with respect to the ADC clock. This same signal is also used as the trigger for the acquisition and the ADC VME modules. The CIS calibration data used in this analysis are taken using a stand-alone program similar to what is done with the general DAQ[2]. Both this standalone program and the general DAQ use the same software library for the 3in1 Controller[3]. The program is steered by a datacards file provided by the user, and it allows to pulse one or more 3in1 cards and also to select the DAC range and the way the pulsing is done. The program produces at the end one output file using a simple format (binary or ascii) and an HBOOK Ntuple for fast analysis and event display. In order to have a complete coverage for the dynamic range of the electronics, the following parameters were set in the program:

Footnote 1: a VME based board which is able to communicate and control all the 3in1 cards in each PMT.

* **DAC Coarse**: Starting value = 10, No of steps = 200, Stepsize = 1
* **DAC Fine**: Starting value = 10, No. of steps = 24, Stepsize = 10

For the first 10 steps in DAC Coarse, the DAC Fine values are scanned, then for the rest

* a VME based board which is able to communicate and control all the 3in1 cards in each PMT.

the DAC Fine value is set to 255 and only the DAC Coarse value changes.
* **Timer Coarse**: 10
* **Timer Fine**: Starting value = 124, No. of steps = 63, Stepsize = 2 For each set of DAC (coarse and fine) the Timer Fine values are scanned.
* **Number of events** per charge point: 5

For each channel, first the ADC connected to the Low gain is read followed with the High gain one. The correspondence between the PMT and the ADC module and channel is defined as well in the cards file. The value for the Timer Coarse depends on the hardware setup (the length of the cables etc.), the value set of the internal delay of the ADC modules, and where in the data window we want the pulse to appear. It is also different between the different ADC modules that we had in the setup. The value used here places the pulse to about the 30\({}^{\rm th}\) sample in a 60 samples window for most of the channels, while for the rest is in the 25\({}^{\rm th}\) sample.

A full set of CIS data for all the bi-gain channels taken at various times spanning a period of more than three months is available, and were used in this analysis. The summary of all the runs taken can be found in [4].

## 3 The CIS data analysis

The analysis performed with the CIS calibration data covers most of the aspects of the system performance. There are three major topics that this analysis is focused on:

* the analysis of the _pedestals_ and the _noise_ evaluation,
* the _pulse shape reconstruction_ and _shape invariance_ as a function of the injected charge,
* the evaluation for the _pC to ADC_ count ratio and the _linearity_ of the system.

### Pedestal and noise analysis

In Figure 2 a typical event is shown. As we discussed above, the Timer Coarse value and the internal delay of the ADC module were chosen such that a large number of samples are available before the real pulse comes, in order to have a good estimation for the pedestals and the noise. The first 10 samples from the pulse are used for the pedestal evaluation, which are rather well separated from the pulse which in this particular channel peaks around the 37\({}^{\rm th}\) sample.

The pedestal values are set somewhere between 80 and 96 ADC counts, and the noise level is about 0.7 ADC counts for the low gain channel and 1.4 for the high gain (Figure 3), without much variation between the channels.

To have a quantitative estimate on the noise of the system which enters in the analysis of the physics data, the same algorithm as in the physics data should be used. In general, all the energy estimator algorithms use a sum of \(N\) samples, where \(N\) can be from 5 up to maximum 10. First for each event the pedestal is calculated for the first 10 samples, and then the different sums are formed from the following samples, subtracting the value of the pedestal, in the same way as it is done for the physics data. In Figure 4 the rms of the distribution when different number of samples are summed together is shown. The data points are fitted with the formula:

\[\sigma^{2}=\ p_{1}+p_{2}\cdot n+p_{3}\cdot n^{2} \tag{2}\]Figure 3: The pedestal (mean and rms from the first 10 samples in the readout window) distribution as a function of the injected charge.

Figure 2: A single event for PMT 23.

The first parameter of the fit is forced to be zero. The second represents the square of the random noise contribution per sample, and the third one the same quantity but for the coherent noise.

From the values of the fitted parameters we see that the contribution of the coherent noise is at least an order of magnitude less than the random noise, which is also rather small, typically of the order or less than a count. What we also can see is that the rms noise between the low and the high gain channels is almost the same, which indicates that there is no noise entering into the system before the shaper. Taking into account the conversion of ADC counts to pC and then the value of pC to GeV found in the data (0.75 pC/GeV), we can estimate the noise contribution of each sample, summarized in the table bellow:

\begin{tabular}{l l l}  & **Random noise (per sample)** & **Coherent noise (per sample)** \\ \hline \hline _Low gain_ & 0.9035 counts or 192 MeV & 0.320 counts or 68 MeV \\ _High gain_ & 1.3251 counts or 17 MeV & compatible with zero \\ \end{tabular} This analysis is rather crude and a more detailed study should be done. In particular points like charge cross-talk between channels during the calibration or physics data, influence of the low gain channel from the saturation of the high gain, presence of coherence noise using the autocorrelation function should be studied in detail.

### Pulse shape reconstruction

For the pulse shape reconstruction similar techniques used in previous analysis are used[1]. For each value of the injected charge all the events taken at different time instants (selected by the

Figure 4: The rms distributions when different ADC samples are summed together as a function of the number of samples added. The samples are taken from the part of the window before the real pulse starts.

time settings) are used. In the calibration data we used, the 25ns interval between each ADC sample it was divided in 63 bins (\(\sim\) 400 ps/bin). Therefore, in the reconstructed pulse we have:

\[P_{j}\ =\ \left<\ ADC_{n}\right>_{it}\ \ \ \ \ \ \ \ j=63\cdot(n-1)+it \tag{3}\]

where \(P_{j}\) is the \(j\)-th element of the reconstructed pulse, \(n\) is the ADC sampling number, \(<\)\(ADC_{n}\)\(>\) is the mean value over all the events for this sample and \(it\) is the timer bin according to the fine timer value of the event. In this analysis the pedestals (calculated as explained before), are subtracted as a first step. In Figures 5 and 6, a set of reconstructed pulses for a complete charge scan is shown.

The analysis presented below is based on these reconstructed pulses.

Figure 5: Reconstructed pulses for different charge values. Columns 1 and 3 are the low gain signals, columns 2 and 4 are the corresponding high gain ones.

#### 3.2.1 The inverse bias and the leakage pulse

For small values of the injected charge there is a clear negative part of the pulse, which goes away as the charge increases and almost disappears at about 17-18 pC of the injected pulse. This big negative signal is due to the biasing of the injector capacitor with a wrong sign voltage. Due to this biasing, one has to set the DAC up to about 16pC to get to a true zero volts on the capacitor. At about this value for the DAC, a bipolar pulse appears which is due to the leakage pulse itself, a current from the solid state switch control line as the switch shorts the capacitor to ground. The switch leaks a little current into the active leads of the switch. The big wrong sign bias was added to the circuit design to be sure that we "see" down to zero charge in the nonlinear compressor case, and it is present here since the same digital cards were used[5]. It has to be clear that this leakage pulse is present only in the CIS calibration data and not in Laser or physics data. In the future versions of the 3in1 cards, an second smaller calibration capacitor will be used for the high gain channel and the negative bias will be remove, which is expected to reduce the effect.

The result of this combined effect of the inverse bias and the leakage current, with the first one being the more important in this case, in the CIS calibration data is in two ways:

1. it makes it impossible to see the pulses for the low values of the injected charge and understand the behavior of the system in this region. With the bi-gain system in particular, its effect is amplified in the high gain channel which makes things worse, since it is this channel that we would like to use and calibrate correctly at low charge values! For example the signals from muons fall in this range.
2. it's effect in the pulse shape stays beyond the 17-18pC where we see the negative part to disappear, since it deteriorates the whole pulse shape. We can see this effect in Figure 7 where the position of the peak from the reconstructed pulses is plotted as a function of the injected charge. If we assume that there is no reason for any time walk in the electronics, then the movement of the peak position we observe, can be due to the leakage pulse. In the case of the high gain channels, there is only a small plateau between 40-50 pC (varying between channels) where the peak is constant in time. These points are used later on for the gain calibration.

Figure 6: The same as in Figure 5 but for higher values of the injected charge.

Using the reconstructed pulses for different values of the injected charge, it is possible to reconstruct the leakage pulse and extract the canonical pulse shape[6]. The basic principle is that if one fits the ADC response as a function of the input charge for a fixed time (phase) value by a linear function (selecting high enough values of the charge not to be affected by the leakage pulse itself), the offset we get is a measurement of the leakage + bias pulse, while the slope is proportional to the canonical pulse shape (Figure 8). The amplitude of the leakage pulse is about 100(1500) ADC counts for the low(high) channel which corresponds to about 16pC, similar to what observed with last year's data. What we see as well is that the peak position for the leakage and the canonical pulse is not the same and also it is not the same between the low and the high gain. This difference although small (\(\sim\)2ns), can have an impact in the comparison of reconstructed pulses after the leakage correction has been applied. Part of this can be due to differences in the electronics for the two channels (low and high gains), and part due to imperfections in the fitting procedure, for example if points which are already affected by the leakage pulse are used.

Having the leakage pulse information, we can correct the previously reconstructed pulses by simply subtracting it bin by bin. The effect of this operation is obviously that the amplitude for the pulse is increased as it should be. In addition, as expected, the position of the peak is affected as well (Figure 9).

In Figure 10 the position of the maximum in time as a function of the input charge for the reconstructed pulse after the leakage+bias pulse correction is shown. This figure is to be compared with Figure 7 which shows the same quantity before the correction. What we see is

Figure 7: The peak position as a function of the injected charge for the low (top) and the high (bottom) gain channel.The strange shape of the bottom left plot after -50pC is due to the saturation of the ADC.

that the time-walk is almost totally removed, \(\sim\)3ns in the low gain and almost nothing in the high gain.

Figure 8: The reconstructed leakage+bias and canonical pulse for low (top) and high (bottom) channels.

Figure 9: The effect of the correction for the leakage pulse in the reconstructed pulses for two PMTs.

#### 3.2.2 Pulse shape invariance

After the correction for the leakage pulse in principle the original pulse shape is recovered, therefore checks for its invariance as a function of the input charge can be made, of course within the linearity region of the shaper and the DAC system. Invariant means that it is only the amplitude which should scale according to the injected charge and no deformation or time walk of the peak position should be observed.

In Figure 11 a set of pulses after the correction is applied are plotted for the low gain channel. In the left, pulses for 23 different charge values over the full DAC range are superimposed, while on the right figure only the ones for the two extreme charge values are shown. The agreement is quite good, and the "fatness" of the left plot can be attributed to the remaining time walk as seen clearly in the right figure. What is also visible is the effect of some "ringing" towards the end of the pulse, present as well in the original reconstructed pulses (Figures 5 and 6) and in the reconstruction of the leakage pulse (Figure 8).

In Figure 12 the same plots in the case of the high gain channel are shown. Here the agreement is rather good over the whole range: from \(\sim\)17pC (above the influence of the leakage pulse) to \(\sim\)50pC (before saturation). In this case what is rather visible is some "knee" in the right end, which should be a characteristic of the electronics since it is present in all the pulses for all the channels2. We believe this has no effect in the quality of the data, as long as enough samples are added for the energy estimator.

Figure 10: The position of the peak as a function of the charge for the low (top) and the high (bottom) channel after the leakage+bias pulse correction.

Finally, in Figure 13 a compilation of different pulses from both the low and the high gain are shown which cover the whole dynamic range, demonstrating the excellent linearity of the system.

#### 3.2.3 Linearity

In Figure 14 the peak of the reconstructed pulses after all the corrections vs. the injected charge is shown. Doing a linear fit in the region where the leakage pulse is not present, the residuals are less than 0.5%.For each channel two set of fits are done: the **free** fit, when two parameters are 

[MISSING_PAGE_EMPTY:13]

The fit range is from 40pC up to the saturation point for the case of the high gain, and from 50 pC up to 400 pC (when the DAC becomes non-linear) for the low gain. The average values from the two tables are summarized bellow:

\begin{tabular}{|l|l|l|l|} \hline  & **Low Gain** & **High Gain** & \\  & **Slope (ADC to pC)**, & **Slope (ADC to pC)** & **Relative gain** \\ \hline \hline
2 par. fit & 0.1594\(+-\) 0.00601 & 0.01012 \(+-\) 0.00039 & 15.74 \(+\) 0.387 \\ \hline constr. fit & 0.1589 \(+\) - 0.00601 & 0.01010 \(+\)0.00038 & 15.73 \(+\) 0.394 \\ \hline \end{tabular}

For the physics data analysis the parameters (slope) from the constrained fits are used.

## 4 The energy estimator

Although the bi-gain system it is linear in its response which makes it rather easy to calibrate, it is also a discrete sampling system, therefore in order to extract the energy, some filter algorithm has to be applied. In general the energy estimator can be given by the formula:

\[E\ =\ \sum_{j=N_{1}}^{N_{2}}W_{j}\cdot ADC_{j} \tag{4}\]

Figure 14: top: The reconstructed peak position versus the injected charge after the leakage correction has been applied. Bottom: the residuals for the straight line fit as a function of the injected charge.

where \(N_{J}\) and \(N_{2}\) are the sampling indices defined according to the algorithm used, \(ADC_{j}\) are the raw data (normally after pedestal subtraction), and \(W_{j}\) are the filter weights. The goal is that the calculated value for the energy will be the best possible in terms of noise suppression, linearity, will use the minimum possible number of samples and will be time (phase) independent.

Given the low level of the noise in the bi-gain system and the good shape invariance, it was estimated that there is no need for special weights and we can set them to 1.0. Then, for the energy estimator three different algorithms are used, similar to what was developed last year for the compressor data:

* the **integral method**, or fixed adder, where N samples in a _signal window_ are summed.
* the **maximal sum method**, where the maximum of the sliding sum of N samples is used. This method gives very good results but it is very sensitive to noise. For example gives always positive energy for the channels with very small or no signals.

In Figure 15 (top) the integral of the reconstructed pulse is shown as a function of time. The pulse characteristics are summarized bellow:

\begin{tabular}{l c c}  & 10\% & 90\% & 100\% \\ \hline Signal Integral & \(\sim\)25ns & \(\sim\)109ns & \(\sim\)190ns \\ \end{tabular}

In the bottom plot of the same figure the 25ns samplings are shown, positioned such that the maximum is sampled. This will be the case for example in ATLAS where things are synchronized with the BXing, but not in the test beam. What is seen is that with 5 samples ([peak-2,peak+2]), we can get a rather good representation of the signal without entering in the "knee" region. With 7 or more samplings we can get the full charge.

Several different estimators of the two algorithms described above were tested, corresponding to different number of the samples used for the sum. The treatment of the data at this stage is identical as in the case of the reconstruction of the pulses: first the pedestals are calculated for each event from the 10 pulses at the beginning of the readout window, then the leakage+bias pulse correction is applied, and finally the energy estimator for the event is calculated.

For each value of the injected charge the **internal resolution** is evaluated, which corresponds to the rms/mean of the distribution of the given energy estimator when all the events from all the time instances are used. The results are shown in Figure 16. What we see is that for all the cases the values obtained are about 1% or even smaller, except of course in the case of the peak evaluation using or not a polynomial fit, which is expected to be rather sensitive to the phase. Also in general, the internal resolution is flat apart from the low charge values where the influence of the leakage pulse and the noise tend to dominate.

The best (lowest) values for the internal resolution are obtained for the case of the maximal adder while the asymmetric fixed adder with a length of 5 or more gives comparable results. This is quite interesting because in the case of ATLAS only few (5-8) digitalization samples will be available per pulse.Although the results obtained look rather promising, one limitation should also be taken into account in the performance of the system, which comes from the slight distortion of the pulse shape at its falling edge. This is clearly visible in Figure 13, it is present only in the CIS and not in the physics or laser data and its origin is understood from the 3in1 card electronics[7].

## 5 Analysis of Laser data

A similar analysis done for the CIS data was performed with the laser data. In Figure 17 the response of the PMT, evaluated using the maximal adder of length 9 as described above, is plotted versus the signal in one of the laser diodes diode 2. Apart from the issues of the laser response linearity and stability, what is interesting is the full pulse reconstruction and comparison with the CIS data, since the later is generated from the PMT itself (like the physics data) while the CIS pulses are generated with an electronic circuit by the closing of a switch. If there are differences, for example due to the shaper not being optimized for both, the calibration that we do with the CIS data might not be correct.

In order to fully reconstruct the pulse we need to have the time and the amplitude information of each event. To measure the amplitude of the laser pulse, the most accurate measurement is the diode signal (Figure 18). Based on the laser diode information, three different regions were

Figure 15: Top: The normalized integral of the reconstructed pulse for both the low and the high gain. Bottom: The reconstructed pulse and lines indicating the 25ns sampling points adjusted wrt the maximum point.

selected for the pulse reconstruction, shown with the hatched bands. Each event is normalized to its "amplitude" taken from its energy estimator, calculated using the maximal adder of length 9 (as described above). For the time information the TDC reading is used. This TDC is cabled such that the start signal is the trigger and the stop signal is taken from a special module and corresponds to the time of the first ADC clock arriving after the trigger; therefore by definition its range is 25 ns.

Having the amplitude and the time information for each event the full pulses can be reconstructed as with the CIS data.The results are shown in Figure 19, while in Figure 20 the three pulses for the highest amplitude in each band (left column) are superimposed.

What we observe is that the two highest amplitude pulses are well matched, while there is a relatively large difference both in amplitude and shape with the third one. One possible explanation is that the normalization based in the energy estimator is not that good and we should use rather the diode information. What is rather interesting is that with the laser pulses we can reach very low charge values which in the CIS data are affected by the leakage+bias pulse, in

Figure 16: The internal resolution versus the injected charge for the case of the maximal and fixed adder methods for both the low (top row) and the high (bottom row) gains. The data used are after the leakage+bias pulse correction is applied as explained in the text.

particular for the high gain channel. Further studies are under way to understand this and do perhaps similar analysis in the physics data.

## 6 Stability

Using the different set of runs taken at the beginning and at the end of the 1997 test beam period, we can check the stability of the calibration. The value which is monitored is the "_gain_" of each channel, taken from the slope of the fitted line in the reconstructed peak vs. injected charge diagram (Figure 15). In Figure 22 the gain in the two parameter for the data taken in August 4th and in November 25th are shown, as well as their relative difference. What we see is that the values agree to less than 0.1% clearly far away from the larger drop seen by the Cs data.

Using the rest of the data and in particular the ones taken every two days starting from the November 25th we can monitor the stability of the gains for each PMT. In total 5 runs were analyzed using the same procedure (as explained above) and the same programs. The value monitored is the fitted slope (gain) of the reconstructed peak vs. the injected charge. In Figure 22 the values for the gain for each PMT are shown. In general the values are quite similar, except of some PMTs that there are large differences for some runs.

This can be seen better in Figure 22 where the gain for each PMT as a function of the data set are shown. The first point corresponds to the run taken in August 4th while the rest are from November 18th onwards. The gains are normalized wrt the first point and are in percent. In the case which some PMT give "strange" results, the points in the plot are set to minimum or maximum of the scale. The most sensitive measurement seems to be the high gain, simply because this is more affected by the leakage\(+\)bias pulse reconstruction. We believe that with a rather detailed analysis of the data, most of these cases can be recovered.

Based on this results several comments can be made:

* In general the gains are stable, to better than 0.5% level over this period of 3 months, but there is a visible although rather small drop from the first run taken in August, typically at about 0.2-0.3%.
* For most of the PMTs, the system is rather reproducible, giving the same results for different calibration runs (almost flat distribution for the last 2-3 runs). As a typical number we can say that the reproducibility is within 0.2%.
* The results obtained for the free and the constrained fit for most of the channels are quite similar, indicating the good linearity of the system. Small differences can be due to the imperfections in the procedure of the leakage+bias pulse corrections which are applied in the data. Of course the gains from the constrained fit is more sensitive in the case of problems in the data, as in the case of PMT 37 for example, in particular the high gain channel.

Figure 19: The laser reconstructed pulses. Each row correspond to one of the bands in Figure 17 and each column to one of the laser intensities. All the pulses are normalized to the highest amplitude pulse of the lowest intensity (bottom left plot).

Figure 21: The fitted slopes for each channel for two data sets taken at the beginning and at the end of the test beam period. The relative difference between the two values is plotted in the inset.

Figure 20: Comparison between the different reconstructed pulses

What is interesting is that in the 6 calibration runs that were taken, some of the PMTs show really "crazy" results but in the next run behave normally. In fact one of the runs has most of its PMTs like this and it is not included in the plots (5 points instead of 6). For example:

1. Data set 1 (August 4\({}^{\text{th}}\)), all PMTs ok,
2. Data set 2 (November 18\({}^{\text{th}}\)), all PMTs ok,
3. Data set 3 (November 25\({}^{\text{th}}\)), PMTs 33, 34, 41, 42 show large offset values,
4. Data set 4 (November 29\({}^{\text{th}}\)), most of the PMTs look different, the points are not included in the plots,
5. Data set 5 (December 2\({}^{\text{nd}}\)), PMT 21 bad,
6. Data set 6 (December 4\({}^{\text{th}}\)), PMT 37 bad.

All the runs are in principle taken with the same conditions, with the same programs, HV and cooling on, and taken from the same person. In some of the cases it seems that although the DAC

Figure 22: Gain stability plots for each PMT. The values are normalized to the data taken on August 4th.

values according to the data are high, the signals that we have in the ADC are as if the DAC is set to zero or a rather small value. This might be a problem in the hardware, something to be investigated for the future. A detailed analysis of each run cane be found in [8].

## 7 Conclusions

From the analysis results presented here it is shown that the performance of the new bi-gain/ bi-adc readout is quite good and meets most of the requirements. The system is quite linear in the full dynamic range, it has low noise (although the non optimized setup of this year with long cables etc.), and almost no time walk. The stability of the calibration is quite good over a period

Figure 23: Gain stability plots for each PMT. The values are normalized to the data taken on August 4th.

of three months. The internal resolution, is close to few% level but when a relatively large number of samples is used. The weak point in the present system is the presence of the large leakage\(+\)bias pulse which makes it difficult to see and calibrate for small signals, something to be fixed in the future. The analysis of the Laser data presented here showed some indications for non-linearities (not seen with the CIS data) which need to be understood further. For the time being more data are collected and are being analyzed in order to study the stability of the system over a long period. The plan is to continue this for at least one month more. In parallel, an analysis of the real physics 1997 test beam data is in progress in order to have an estimate of the performance of the new system in terms of energy resolution and response linearity. This work will be reported as well in a future note.

## 8 Acknowledgments

A substantial part of this work was carried out in Summer 1997 by T.Kontos, during his stay as Summer Student at CERN. The authors would like to express their gratitude to our Univ. of Chicago (K.Anderson, J.Pilcher, H.Sanders) and Univ. of Stockholm (S.Berglund, J.Sjolin, K.Jon-And) colleagues for their collaboration, help and the many fruitful discussions throughout this work.

## References

* [1] J.A.Perlas et.al, _"Evaluation of Fermi Read-out for the ATLAS TileCal Prototype"_, (ATLAS/ TileCal-No 116, 28 April 1997).
* [2] I.Efthymiopoulos, _"Tile Calorimeter On-line Utility Programs, User Manual V1.00"_, September 1997, in preparation.
* [3] K.Anderson, The library with the utility routines for the 3in1 controller (lib3in1.c, lib3in1.h).
* [4] I. Efthymiopoulos, Summary of CIS runs taken for stability studies: [http://wwwcn.cern.ch/~efthymzp/tebam/Stabtests.html](http://wwwcn.cern.ch/~efthymzp/tebam/Stabtests.html)
* [5] K.Anderson, _"Status of the 3in1 card charge injector"_, x-rencies Chicago Electronics meeting, February 96.
* [6] S. Berglund et.al., _"Analysis of CIS calibration data and construction of LUT"_, x-rencies presented by K. Jon-And, 25 November 1996.
* [7] K.Anderson, H.Sanders, Tile Calorimeter electronics meeting, September 1997.
* [8] I.Efthymiopoulos, Stability checks for the CIS calibration system [http://wwwcn.cern.ch/~efthymzp/tebam/Stabcis.html](http://wwwcn.cern.ch/~efthymzp/tebam/Stabcis.html).