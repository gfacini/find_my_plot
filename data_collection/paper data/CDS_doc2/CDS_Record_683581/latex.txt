**ATLAS Internal Note TILECAL-NO-XXX**

**May 14, 1997**

**Study of the charge spectra generated by photomultipliers.**

V. Cavasinni, S.Cologna, N.Del Prete,

B. Di Girolamo,G. Renzoni

_Dipartimento di Fisica, Universita di Pisa and Istituto Nazionale di Fisica Nucleare, Sezione di Pisa, Italy_Introduction

In this note we discuss the measurements of light yield from scintillator and wavelenght-shifting fibres (WLS) performed through the analysis of the charge distribution provided by a photomultiplier. This procedure was used in ref [1]. The analysis procedures were verified by a simple montecarlo program which generates the photomultiplier spectra.

## 2 The Experimental Apparatus

These measurements have been carried out in the optoelectronic laboratory in Pisa with two different setups.

In the first case, as shown in the figure 1, the fibre is placed on proper supports at about 10 cm from the surface of an optical bench. The fibre, coupled to a small scintillator (\(1.3\times 2.8cm^{2}\)), is placed in a groove on a movable brass carriage. The scintillator is housed in the movable carriage, which carries also two scintillators coupled to two fast photomultipliers Hamamatsu R1635-02 which provide the trigger system. The walls of the groove are in teflon so that the fibre is not damaged during the scan. Below the scintillator groove there is a hole of 1. cm in diameter to allow the passage of \(\beta^{-}\) from

Figure 1: Experimental apparatus used for the measurements of charge spectra

In the first case, as shown in the figure 1, the fibre is placed on proper supports at about 10 cm from the surface of an optical bench. The fibre, coupled to a small scintillator (\(1.3\times 2.8cm^{2}\)), is placed in a groove on a movable brass carriage. The scintillator is housed in the movable carriage, which carries also two scintillators coupled to two fast photomultipliers Hamamatsu R1635-02 which provide the trigger system. The walls of the groove are in teflon so that the fibre is not damaged during the scan. Below the scintillator groove there is a hole of 1. cm in diameter to allow the passage of \(\beta^{-}\) from a collimated source of \(Sr^{90}\) placed on the scintillator. This source is housed in a plexiglass cylinder to limit the bremsstrahlung contributions.

The radioactive source and scintillator are placed at a given distance from a photomultiplier Hamamatsu R1635-02 photon counter, which measures the light yield of the fibre at one of the two ends. The signal of the photomultiplier is fed to a multichannel analyser \((qVt)\) Le Croy, after amplification (LRS, model 612M) and an appropriate delay to be simultaneous to the gate signal made by the coincidence of the discriminated signals of the trigger photomultipliers.

The spectrum is registered by an acquisition system OS9 through an interface with the CAMAC crate. The spectrum is then analysed offline to extract the average number of produced photoelectrons.

The second setup was used to measure charge spectra with an average number of photoelectrons largely variable. In this case the light source is a blue LED. It can be placed directly in front of the photomultiplier or on the movable carriage. The light pulse can be changed interposing some filters with different values of the optical density \((OD=-Log_{10}(T)\), where \(T\) is the transmission coefficient).

The signal coming from the photomultiplier is sent first to a fast filter amplifier and then to the input of the multichannel analyser \(qVt\). The \(qVt\) wastriggered by the same pulse generator which drives the LED, opportunely delayed and shaped. Also in this case the charge spectrum is registered through the CAMAC system.

## 3 Fit Procedures

The analysis of the charge spectra requires much care and an adequate fitting procedure was developed. The charge spectrum is dominated by the fluctuation of the photoelectrons production which is Poisson distributed.

The charge spectrum receives contributions from various photoelectrons. We assume that a given number of photoelectrons \(n_{ph}\) produces a signal with a gaussian distribution of charge, whose average is proportional to \(n_{ph}\) and its width to \(\sqrt{n_{ph}}\), as shown in the example of figure 2.

The ratio between the area of n-th gaussian and the total area of the spectrum represents the probability to have \(n\) photoelectrons. The distribution of the areas is a poissonian. The noise peak (pedestal, corresponding to \(n_{ph}=0\) ) is again simulated by a gaussian distribution. The pedestal shape describes the background noise due to the photomultiplier. It includes the probability to have zero photoelectrons and possible random noise. As a first step, for the spectra analysis, it was used the following fit function:

\[f_{1}(\,x)=\frac{w_{\,\texttt{ped}}}{\sqrt{2\pi}\,\sigma_{\texttt{ped}}}\exp \left(-\frac{(\,x-\overline{x}_{\texttt{ped}}\,)^{2}}{2\sigma_{\texttt{ped}}^{ 2}}\right)\,+\sum_{i=1}^{N}\frac{w_{i}}{\sqrt{2\pi}\,\sigma_{i}}\exp\left(- \frac{(\,x-\overline{x}_{i}\,)^{2}}{2\sigma_{i}^{2}}\right) \tag{1}\]

where \(N\) is the number of gaussians that contribute to the spectrum, \(\overline{x}_{\texttt{ped}}\) and \(\sigma_{\texttt{ped}}\) are the position and the sigma of the pedestal respectively, \(\overline{x}_{i}\) and \(\sigma_{i}\) are position and sigma of the peak for \(i\) photoelectrons.

The procedure is subdivided in four steps: the first one consists in fitting the parameters of the pedestal and of the first peak using a charge spectrum obtained in a dedicated measurement to determine the spectrum of the single photoelectron. This result is obtained by bringing the source at a large distance from the photomultiplier (3 m when possible) and putting also some filters in front of the photomultiplier, in these conditions the spectrum is dominated by the single photoelectron. This spectrum is analysed and the obtained parameters retained for the successive steps. The second step fixes the values of the sigma and of the position of the pedestal and of the first peak

Figure 2: Example of charge spectrum

obtained in the first step and, through a fit with (1), it extracts the weights \(w_{i},i=1,...,N\). We assume that: \(\overline{x}_{i+1}-\overline{x}_{i}=\mathit{constant}\) and \(\sigma_{i}=\sqrt{i}\ \sigma_{1}\).

The areas \(w_{i}\) so determined, are finally fitted by a Poisson distribution:

\[P(n,\mu)=A\frac{e^{-\mu}\mu^{n}}{n!} \tag{2}\]

where A is a normalization factor. We notice that we cannot determine directly the poissonian probability to have 0 photoelectrons: it is not possible to obtain it from the spectrum because this information is contained in the pedestal together with other noise effects. It is however possible to extract it from (2).

The quality of the Poisson fit depends on the number of photoelectrons and on the position of the source along the fiber.

It is possible, instead, to use an alternative fit function:

\[f_{2}(x)=\frac{w}{\sqrt{2\pi}\sigma_{ped}}\exp\left(-\frac{(x-\overline{x}_{ped })^{2}}{2\sigma_{ped}^{2}}\right)+\sum_{i=1}^{N}A\frac{e^{-\mu}\mu^{i}}{i!} \frac{1}{\sqrt{2\pi}\sigma_{i}}\exp\left(-\frac{(x-\overline{x}_{i})^{2}}{2 \sigma_{i}^{2}}\right) \tag{3}\]

where we impose in the fit that the \(0\to N\) contribution be Poisson distributed. In practice we usually limit \(N\) to 5. The advantage of this function is to have a limited number of free parameters. The fit procedure which uses the function \(f_{2}(x)\) is based on several steps giving a better and a better estimation of the parameters. In fact the results of each step are used as input to the following step for a faster and better fit. The first step consists in the determination of the pedestal and first peak parameters: the area, position and \(\sigma\) of the pedestal, \(\delta\) (the distance between the pedestal and the first peak) and \(\sigma_{1}\) (the \(\sigma\) of the first peak). Then we fix \(x_{i+1}-x_{i}=\mathit{constant}=\delta\) and \(\sigma_{i}=\sqrt{i}\sigma_{1}\) and we fit with \(f_{2}\). This first step already provide a first approximate estimate of the contribution of the gaussians. In the second step \(\delta\) and \(\sigma_{1}\) are free parameters to be found with the fit \(f_{2}\). We estimates the areas of the first four peaks. We obtain a first estimate of the average number of photoelectrons from a fit of the areas of the five peaks and the area of the pedestal with a poisson distribution. The last step is a fit of the whole charge spectrum. We have six free parameters: the pedestal parameters, \(\delta\) and \(\sigma_{1}\) and the average of the poissonian \(\mu\). We tried to fit with the total number of events both as a free parameter and as a fixed one.

Figure 4: Spectrum obtained with MC simulation to be compared with the corrispondent real spectrum in Fig. 3

Figure 3: Real spectrum obtained with scintillating fiber and PM Hamamatzu.

[MISSING_PAGE_EMPTY:7]

## 4 Montecarlo Simulation

To check the efficiency of the procedure used for the fit \(f_{2}(x)\), we have generated with a simple Montecarlo several charge spectra and we have compared the results given by the fit program with the generated ones. The generation was done accordingly to the formula (3) corrected with the exponential contribution.

The aim of this simulation is to check the capability of reconstruction as a function of the average number of generated photoelectrons \(\mu\), of the gaussian width of single photoelectrons \(\sigma_{1}\) and of the distance between the pedestal and the first photoelectron \(\delta\). \(\sigma_{1}\) and \(\delta\) are expressed in unity of ADC channel. Obviously the greater is \(\delta\) or, equivalently the smaller is \(\sigma_{1}\), the better the reconstruction is expected. Tables 1 - 3 summarize the results of the analysis of the \(MC\) spectra with average 1, 2 and 3 respectively. In figure 6 we show the results for \(\mu=1\).

Looking at tables 1 - 3 and at fig. 6 we see that, for the values of the parameters \(\delta\) and \(\sigma_{1}\) of our interest (similar to the experimental ones), the reconstructed average number of photoelectrons is consistent with the one in

Figure 6: Percentage variations of \(\mu\) average (derived by fit program) with respect to \(\mu_{G}=1\) average (input parameter for spectra generation) for different values of \(\delta\) and \(\sigma_{1}\)generation and no bias is observed. For \(\mu=1\div 3\) the uncertainty in the reconstruction is about 2%.

To evaluate the statistical uncertainty on the value of \(\mu\) obtained with the reconstruction, for a given set of parameters \(\mu=1\)., \(\delta=60\)., and \(\sigma_{1}=30\)., we generated 40 different montecarlo spectra. The results of the fit are shown in figure 7. We can see that the RMS of the distribution of \(\mu\) is consistent with the errors evaluated by the fitting procedures.

As an additional check of the quality of the fitting procedure on the data we studied the relationship between the anode current of the photomultiplier and the corresponding number of reconstructed photoelectrons. We used the blue LED as a light source and we scanned the fibre along its lenght tuning the LED light to give about \(1\div 2\) photoelectrons. We measured the anode

Figure 7: \(\mu\) reconstructed distribution. The input parameter of the monte-carlo generation are: \(\mu=1\), \(\delta=60\), \(\sigma_{1}=30\).

current with the LED in different positions along the fibre, at the same time we recorded the photoelectrons spectra, then we used our fitting procedures to evaluate the average number of photoelectrons \(\mu\). Figure 8 shows the results: there is a good linearity between current and \(\mu\) proving that our procedure to extract photoelectrons is correct.

## 5 Other Methods

The procedure illustrated in the previous paragraphs begin to fail when the number of photoelectrons increases, i.e. for \(\mu\geq 4\). In fact in this case the gaussians are too many and superimposed so that the reconstruction program is no more able to separate them efficiently. In these cases we can use another method, called _the median method_. This method consists in the calculation of the median of the poissonian distribution after pedestal subtraction. To do that we sum the content of all the bins of the hystogram to get the total area and then we find the bin at which we are at the half of the area. This bin is, by definition, the position of the median (\(x_{median}\)). The average number of photoelectrons is therefore:

Figure 8: Linearity between anode current and \(\mu\).

\[p.e.=\frac{x_{median}-\overline{x}_{ped}}{\delta} \tag{4}\]

where \(\overline{x}_{ped}\) is the position of the pedestal and \(\delta\) is always the pedestal-first peak distance obtained with a fit of the spectrum dominated by 1 photoelectron.

As an example we consider an experimental charge spectrum with reconstructed average 2.89 by the \(f_{2}(x)\) method and we compare it with the results of the median method (figure 9). From (4) we get 2.61 which is comparable with the fit \(f_{2}(x)\) with a difference of 9%.

To do a further check on the median method we applied it to two charge spectra generated by \(MC\) with average number of photoelectrons 3 and 5 respectively. At \(\mu=3\) we had \(\delta=25\) we get that the reconstructed photoelectron number is 3.08.

For the spectrum with \(\mu=5\) and \(\delta=30\) we get \(p.e.\simeq 4.83\).

If the photoelectrons number is very high (larger than ten), the poissonian distribution approaches a gaussian one and we can calculate the average

Figure 9: Charge spectrum obtained with a LED and the correspondent median method (see text).

number of photoelectrons with the following formula:

\[\mbox{\it p.e.}=\frac{(\mu-\overline{x}_{ped})^{2}}{\sigma^{2}}\cdot(1+\frac{ \sigma_{1}^{2}}{\mu_{1}^{2}}) \tag{5}\]

where \(\mu\) is the average of the spectrum; \(\overline{x}_{ped}\) is the position of the pedestal and \(\sigma\) is the width of the fitted gaussian. \(\mu_{1},\sigma_{1}\) are the position and the sigma of the first photoelectron peak and they depend on the photomultiplier resolution. The validity of this method and range of application is discussed in detail in ref [2].

Thanks to this expression we could do a further check that the distance between the position of the pedestal and the position of the first peak, that is \(\delta\), is indeed independent of the average number of photoelectrons (as assumed in all the procedures of spectra analysis), and it is determined only by the experimental set-up.

## 6 Conclusions

In this note we have discussed the measurements of light yield performed through the analysis of the charge spectra. In particular we concentrated in the study of a low number of photoelectrons. To check the efficiency of our procedure we have generated with a simple Montecarlo simulation several charge spectra and we have compared the results given by the fit program with the generated ones. As we have shown in the Tables 1 \(\div\) 3 the reconstructed values give a good estimation of the value of \(\mu\). The fit procedure together with the median method and the gaussian method allows to cover the full range of experimental interest for the determination of the number of produced photoelectrons.

## References

* [1] B. Di Girolamo, Atlas internal note, TILECAL-NO-48 (1995)
* [2] E.H. Bellamy et al, NIM A339 (1994) 468-476