[MISSING_PAGE_EMPTY:1]

Introduction

In august 1999, may 2000 and august 2000 test beam periods took place in the H8 line of the North Area to test the full size prototype module of the ATLAS liquid argon barrel calorimeter. The preliminary analysis of the data taken has shown an apparent non uniformity in the energy response along the \(\eta\) direction (see the presentations given at the test beam meetings during the liquid argon weeks in 1999 and 2000). Various efforts in understanding this effect have been made since the first test beam. Summing boards and motherboards were re-designed in order to reduce the inductances and crosstalks; special runs in april 2000 were taken with the summing boards only loaded with known pure capacitances (called toy calorimeter in what follows).

We will show in the work presented here that we are now able to predict the response to an ionisation signal from the calibration one. As a consequence, the apparent non uniformity is assed [1].

In Section 2, we reconstruct the various signals from samples collected at a 40 MHz rate at the output of the analog electronics. The module, its cables and electronics are described in Section 3 and analytic expressions of the calibration and physics pulse shapes are obtained. The analytic expressions of the calibration signals are fitted to the toy calorimeter data in Section 4. The fitted electrical parameters are used in the analytic expression of the ionisation signal, but appears that this electrical model is not sufficient to understand the response of the calorimeter.

Indeed, we must emphasize the fact that the calibration and physics signals flow through the same read out line. This statement has led us to elaborate an original method called FFT method (Section 5) in which the physics pulse shapes are directly predicted from calibration pulse shapes. The comparison of the predicted physics pulses with the data shows better agreement. Optimal filtering coefficients are then computed from pulses reconstructed with this new method (Section 6) and a remarquable improvement on the uniformity of the energy response in \(\eta\) is obtained as demonstrated in [1].

## 2 Reconstruction of waveforms

Since the 1999 test beam the calibration and physics pulse shapes have been studied. In 1999 and 2000, improvements have been made in the hardware of the prototype module (electrodes, summing and mother boards), and also in the running of the test beam allowing better quality data. Only data taken during the 2000 test beam periods are used in the present study. The description of the module in terms of electrodes and cells can be found in [2].

The first task of this work consists in extracting from the raw data the calibration and physics pulse shapes for each channel of the calorimeter.

### Calibration pulse shapes

The so called "delay runs" are calibration runs taken with a few fixed DAC values while varying the values loaded in the delay chips of the calibration board [3] from 0 to 24 ns. The read out signal is sampled with a time step of 25 ns, and seven samples have been recorded in august 2000. This allows us to reconstruct a signal sampled with a time step of 1 ns over a time interval of 175 ns.

Runs with DAC=7000 (resp. DAC=500) are selected to reconstuct the medium (resp. high) gain pulse shapes. At DAC=0 the observed calibration pulse shape is not zero (Fig. 1). This is due to several effects. First, the DAC voltage is not exactly 0 when the DAC register contains 0x0. Second, the command sent to the calibration board causes a small signal called clock feedthrough and there is the so-called injected charge signal (see [3] for details). To cancel this effect, the corresponding DAC=0 pulse shape is substracted from each calibration pulse shape. The obtained pulses show discontinuities every 25 ns. This can be studied by plotting the derivative of the signal (Fig. 2) and can be explained by the behaviour of the delay chip on the calibration board. This chip should shift the command signal by \(k\) ns when the value \(k\) is loaded in its register. The observed discontinuities can be corrected assuming that the delay shift is not \(k\) but \(\alpha k\) with \(\alpha<1\). The optimal value for \(\alpha\) is found to be \(0.99\pm 0.01\) (this value minimizes the amplitudes of the second time derivatives). This effect has been cross-checked by measurements performed on the calibration board test bench in LAPP (Annecy). Measuring the response of the delay chip, \(\alpha\) is found to be also smaller than 1. The effect of the property of the delay chip on the pulse shapes is discussed later.

### Physics pulse shapes

The physics pulse shapes are reconstructed using asynchronous runs at 250 GeV. The arrival time of the particle in the beam is asynchronous with the 40 MHz clock which determines the sampling times. This time difference is measured by a precision TDC [4] with a step of \(\Delta t=50\)ps.

Runs used here (208945 to 209314) contain data where the electron beam hits the cells with \(\phi\) number \(n_{\phi}=9,10,11\) (see [2] for geometry description). These runs have been taken in free gain mode (medium and high). The pulse shape for a given cell is obtained by taking the profile histogram of the ADC distribution of a given gain versus the time measured with the TDC : \(t_{reco}=25\times i_{sample}-t_{tdc}\) where \(t_{tdc}\in[0,25]\) ns and \(i_{sample}\in\{0,..,6\}\).

This allows to reconstruct pulses over a range of 175ns with a 1ns bin width.

Pulse shapes are affected by cross-talk, depending on the layer (the nature of the cross-talk is different for the strips, middle and back layers) and is non-uniform in a same layer [5]. Figure 4 shows how the pulse is distorted by the cross-talk of a nearby cell. The cross-talk is minimized by selecting events with a sufficient amount of energy deposited in the cell. This reduces the statistics, and hence increases the energy fluctuations for each bin. The cell with the maximum amount of energy deposited is chosen (for the presampler, middle,and back layers), as well as those with greater than 40% of the maximum (for the front layer).

As for the calibration delay curves the physics pulse shapes show discontinuities every 25 ns. The clock step of the TDC has been measured in the test beam setup using the 40 MHz clock as reference and was found to be compatible with 50 ps at a 1% level. A cut is then performed on the \(t_{tdc}\) distribution: two time boundaries are defined by the width at half height of the TDC distribution (Fig. 3). Only events within the limits are considered in the analysis.

During the august 2000 test beam period, we had enough statistics to make strong cuts (about 60 000 events recorded for each cell of the middle layer). It might not be the case for the next test beams (limited run period). More data are needed to understand the cross-talk in physics in order to reconstruct physics pulse shapes with less statistics.

### The toy calorimeter test

A series of tests has been preformed in H8 in may 2000, in order to understand and validate the new summing board and mother boards, and also to track the origin of the non uniformity in \(\eta\). A schematic view of these tests is shown in figure 5. It consists in replacing the calorimeter itself by precision capacitances at the level of the summing boards. Pure capacitances of 1.36 nF have been soldered to a summing board. The mother boards are pulsed and read out by the same cables and electronics as the module in a usual test beam period. The inductance of the boards is estimated to be \(\simeq\)20 nH. An ionisation signal is simulated by direct injection of a calibration pulse through a 500 k\(\,\Omega\) resistance on the summing board, where the signal is usually collected from the electrode. One of the interests of this test for the pulse shape study is to provide "physics" pulse shapes caused by a known signal and without bias due to energy fluctuations. They are used later to understand the shapes obtained from the electrical model described below.

## 3 Electrical model of the system

The calorimeter can be considered as a passive electrical object connected to read out electronics. This system receives signals, either calibration pulses from the calibration board or electrical pulses caused by the ionization of the showers. In this section the system is modelled, starting from a basic description and progressively introducing various sophistications.

In particular, in the basic model, the read out coaxial cables are considered as perfect (without distortion and reflection). However, the analysis of the pulses clearly shows reflections. The shapes for signal and calibration will be modified in order to take into account these reflections.

### Basic description

The electrical model for one channel is shown in figure 6. The detector cell is represented as a capacitance of value \(C_{d}\). The cell is read out by a cable connected to the mother board. Between the cell and the connector, the circuit has an impedance \(L_{d}\). We assume for the time being that the coaxial cable is perfect (no distortion and no reflection), that the preamplifier is linear with an input impedance \(R_{pa}\), and that the shaper has a transfer function

\[H_{sh}(s)=\frac{s\tau_{s}}{(1+s\tau_{s})^{3}} \tag{1}\]

where \(\tau_{s}\) is the shaping time (\(CR-RC^{2}\) shaper [6]).

The signal caused by ionization in the detector is equivalent to a triangular current source at the input of the capacitor

\[I_{phy}(t)=I_{phy}^{0}\,Y(t)Y(\tau_{d}-t)(1-t/\tau_{d}) \tag{2}\]

where \(Y\) is the Heavyside function. The drift time \(\tau_{d}\) in a 2mm gap under a voltage of 2000V is close to 400 ns. Its Laplace transform is

\[\mathcal{L}[I_{phy}](s)=I_{phy}^{0}\left(\frac{1}{s}-\frac{1-e^{-s\tau_{d}}}{ \tau_{d}s^{2}}\right) \tag{3}\]

The output signal in the frequency domain can be written as

\[\mathcal{L}[U_{phy}](s)=\mathcal{L}[I_{phy}](s)\;H_{det}^{phy}(s)\;H_{sh}(s) \tag{4}\]

where

\[H_{det}^{phy}(s)=\frac{\omega^{2}}{s^{2}+\omega^{2}\tau\,s+\omega^{2}} \tag{5}\]with \(\omega=\frac{1}{L_{d}C_{d}}\) and \(\tau=R_{pa}\,C_{d}\).

A calibration pulse is injected using the calibration board (Fig. 6). We assume for the time being that this calibration pulse is an exponentially decreasing signal with a characteristic decay time \(\tau_{exp}\). In this case, the output signal in the frequency domain can be written as

\[\mathcal{L}[U_{cal}](s)=\mathcal{L}[I_{cal}](s)\;H_{det}^{cal}(s)\,H_{sh}(s) \tag{6}\]

where

\[H_{det}^{cal}(s)=\frac{s^{2}+\omega^{2}}{s^{2}+\omega^{2}\tau\,s+\omega^{2}} \tag{7}\]

Using MATHEMATICA[7], analytical expressions for the signals \(U_{phy}(t)\) and \(U_{cal}(t)\) are obtained. These functions are drawn in figure 7 with the parameters \(C_{d}=1.5\)nF, \(L_{d}=20\)nH, \(\tau_{s}=15\)ns, \(t_{d}=400\)ns and \(\tau_{exp}=365\)ns. The difference between the two curves is mainly due to the presence of the inductance \(L_{d}\) causing a shoulder at the start of the calibration signal.

### More realistic calibration signal

The exponentially decreasing calibration pulse \(I_{cal}(t)\) is in practice produced by a pulser circuit generating a fast commutation (step function) flowing into an \(L_{0}R_{0}\) circuit (Fig. 8a). The pulser circuit is equivalent to a current source with

\[i_{\mathit{pulser}}(t)=I_{0cal}(1-Y(t)) \tag{8}\]

In a more realistic approach, two effects appear to make this view a little more complex (Fig. 8b).

First, the inductor has a small resistance \(r_{0}\) of about \(3\Omega\). The corresponding decay time is \(\tau_{exp}=\frac{2L_{0}}{R_{0}+2r_{0}}\). With \(R_{0}=50\Omega\) and \(f=\frac{2r_{0}}{R_{0}+2r_{0}}\simeq 5\%\) the current produced by the calibration board terminated by a \(50\Omega\) impedance is now

\[I_{cal}(t)=fI_{0cal}Y(t)+(1-f)I_{0cal}Y(t)e^{-t/\tau_{exp}} \tag{9}\]

Second, the current \(i_{\mathit{pulser}}(t)\) is not a pure step function but has a small decay time of about 1ns. This is small enough to approximate this additional effect by a Dirac function and \(i_{\mathit{pulser}}(t)\) becomes

\[i_{\mathit{pulser}}(t)=I_{0cal}(1-Y(t)+\beta\delta(t)) \tag{10}\]

Studies of the output signal show that, even with \(\beta=0\), the shape shows a component corresponding to the the \(\delta(t)\) term [8]. \(\beta\delta(t)\) is proportional to the decay time described above. It is therefore replaced by an effective \(\alpha\delta(t)\) term summarizing all effects which give a derivative signal. The response to a calibration pulse can finally be written as

\[U_{cal}(t) = (1-f)I_{0cal}Y(t)e^{-t/\tau_{exp}}*\mathcal{L}^{-1}[H_{det}]* \mathcal{L}^{-1}[H_{sh}] \tag{11}\] \[+ fI_{0cal}Y(t)*\mathcal{L}^{-1}[H_{det}]*\mathcal{L}^{-1}[H_{sh}]\] \[+ \alpha\mathcal{L}^{-1}[H_{sh}](t)\]

Equation 11 is written on three lines corresponding to:

* the main exponentially decreasing curve
* the effect due to the resistance \(r_{0}\)
* the effect of the finite decay time of the pulser, plus additional effects summarized in the factor \(\alpha\). In the following studies \(\alpha\) is determined in a fitting procedure.

Using MATHEMATICA, an analytical expression of the calibration pulse seen at the shaper output is obtained. The breakdown of the various components is shown in figure 9.

### Reflections

The transmission line is composed of cold cables, feedthroughs and warm cables (Fig. 10). Here, we model the signal and calibration cold cables as pure resistive lines of impedance \(R_{cal}\) and \(R_{sig}\) and of lengths varying with \(\eta\)[9].

#### 3.3.1 Reflections in the read out line

The transmission line as described in figure 11 is a series of successive quadrupole-like elements. The output signal can be written as a function of the input:

\[{\cal L}[U](s)={\cal L}[U^{0}](s)\frac{1+\sum_{i=0}^{n-1}\sum_{j=i+1}^{n}\rho_ {i}\rho_{j}}{1+\sum_{i=0}^{n-1}\sum_{j=i+1}^{n}\rho_{i}\rho_{j}e^{-s(\tau_{j}- \tau_{i})}} \tag{1.2}\]

The quantity \(U^{0}(t)\) is the output signal without reflections (denoted here by the \({}^{0}\)), e.g. \(U_{phy}(t)\) for physics from (4), or \(U_{cal}(t)\) for calibration from (6). The quantity \(\rho_{i}\) is the reflection coefficient between the \(i^{th}\) and \((i+1)^{th}\) element (of impedances \(Z_{i}\) and \(Z_{i+1}\)), \(\tau_{i}\) is the signal propagation time between the detector and the \(i^{th}\) element. The time \(\tau_{i}\) is related to the length of the element \(i\) through the relation \(l_{i}=\tau_{i}/v_{cable}\) where \(v_{cable}\) is the signal velocity in the cable. The values used for each elements are given in Table 1.

The second order development in \(\rho\) (less than three reflections) gives :

\[U(t) = U^{0}(t)+A(t)+B(t),\ \ \ {\rm with} \tag{1.3}\] \[A(t) = U^{0}(t)\sum_{i=0}^{n-2}\sum_{j=i+1}^{n-1}\rho_{i}\rho_{j}-\sum_ {i=0}^{n-2}\sum_{j=i+1}^{n-1}\rho_{i}\rho_{j}U^{0}\left(t-\left(\tau_{j}-\tau _{i}\right)\right)\] (1.4) \[B(t) = \sum_{i=0}^{n-1}\rho_{i}V(t)+\sum_{i=0}^{n-1}\rho_{i}V\left(t- \left(\tau_{n}-\tau_{i}\right)\right) \tag{1.5}\]

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline Element & \(N^{0}\) & Z \((\Omega)\) & \(\rho_{i}\) & \(\tau_{i}\) (ns) \\ \hline Preamplifier & 0 & 25. & & 0. \\  & & & 0.5 & \\ Baseplane & 1 & 75. & & 0.2 \\  & & & -0.4 & \\ Warm cable & 2 & 33. & & 2 \\  & & & 0.2 & \\ Warm FT & 3 & 50. & & 2.4 \\  & & & -0.2 & \\ Vacuum cable & 4 & 33. & & 4.2 \\  & & & 0.2 & \\ Cold FT & 5 & 50. & & 4.6 \\  & & & -0.33 & \\ Signal cable & 6 & 25. & & 4.6\(+L_{cable}/v_{cable}\) \\ Detector & n & \(Z_{det}\) & & \\ \hline \end{tabular}
\end{table}
Table 1: Characteristics of the successive elements of the read out line (see details in [9, 10])where \(V(t)=\rho_{n}U^{0}(t)\) is the signal reflected on the detector, between the element \(n\) and the inductance \(L_{d}\) in figure 11.

An analytical expression can be obtained using MATHEMATICA and the results are shown in figure 12. The first term of (13), \(U^{0}(t)\), represents the direct signal without reflections. The term \(A(t)\) contains the components with one reflection on the preamplifier followed by a reflection in an element of the chain. The term \(B(t)\) represents the components with one reflection on an element of the chain followed by a reflection on the detector.

#### 3.3.2 Reflections in the calibration line

A similar study is performed for reflections in the calibration line. As shown in figure 13 this contribution is small. Therefore it is neglected in further studies.

Finally, the function used in our study for the calibration signal is written :

\[U_{cal}(t)=U(t)+\alpha{\cal L}^{-1}[H_{sh}](t) \tag{16}\]

where \(U(t)\) is the output signal with reflections as described in (13). \(U(t)\) is computed from a signal without reflection \(U^{0}(t)\) where the current for the pulser is taken from (11) with \(\alpha=0\).

#### 3.3.3 Case of ionisation signals

The same study is performed for the physics waveforms. The different contributions for the signal are represented in figure 14.

## 4 Comparisons with toy calorimeter data

### Description of the model

The goal of our work is to understand the shape of the pulses and to determine a relation between the calibration and the physics waveforms. In this section the data taken with the toy calorimeter (Sect. 2.3) are compared with the model with reflections. For these data, the physics pulse is faked by a calibration pulse which is in principle well known.

The analytical descriptions of the predicted waveforms with reflections given above have a lot of parameters (Tab. 2). All of these cannot be fitted at the same time for technical reasons: first, the fit is not stable enough and second, many parameters in the fit tend to find a minimum where they have no physical meaning, as they try to compensate effects which are not included in the model.

The inductances have not been mesured for the whole calorimeter, so they are free parameters. Even if the capacitances are known, the distortion due to skin effects tends to increase their values, so they are fitted.

For the reflections all the parameters are measured (lengths and impedances which determine the reflections coefficients \(\rho\)). But the tolerance on the signal cables attenuation is about \(\pm 10\%\). The fit with fixed values of the \(\rho\) quantities gives very bad results. For the fit to converge two additional parameters \(R_{1}\) and \(R_{2}\) are added and the signal is now given by

\[U(t)=U^{0}(t)-R_{1}A(t)+R_{2}B(t)+\alpha{\cal L}^{-1}[H_{sh}](t) \tag{17}\]

### Results of the fit

First, a fit is performed on the calibration pulse shapes. The result of the fit for several channels can be found in figure 15.

The residuals are defined as the difference between fit and data divided by the maximal amplitude of the data shape. Residuals for calibration are found to be about 0.3% at the maximum of the pulse height and 1% at most. This is larger than expected from the requirements on the electronic calibration.

The reflection terms found in the fit (Fig. 16) are found to be larger than the expected values (\(R_{1}=-1\) and \(R_{2}=1\)), especially \(R_{1}\). This can be explained by the fact that the impedances of the read out lines are not well known. It is then not satisfactory to try to fit them by global coefficients \(R_{1}\) and \(R_{2}\). All the cells which are studied show the same pattern for the residual shape. So we conclude that there are electrical effects which are not taken into account in this model and we would need an even more complex description.

The values of the capacitances found in the fit are larger than expected (Fig. 17). This is most probably due to the skin effect in the cables which slows down the pulses and forces the fit to find larger capacitance values. An asymmetry between the two half connectors is seen in the inductance values.

We then use the electrical parameters which have been extracted from the previous fit to predict the physics waveform expression (Fig. 18). This gives residuals which are found to be of the level of 4%. The residuals still show the same pattern for all cells, as for the fit to the calibration pulses

In this study the value for the signal velocity in the cables has been fixed to \(v_{c\Delta\mathit{Re}}=(1/6.1)\)m ns\({}^{-1}\). It has to be noted that the toy calorimeter data have been taken at room temperature. The signal velocity measured at the \(\ell\)Ar temperature was found to be \(v_{c\Delta\mathit{ble}}=(1/5.6)\)m ns\({}^{-1}\). However in the fits with reflections, the results are not good enough to be really sensitive to the signal velocity.

\begin{table}
\begin{tabular}{|l|c|l|l|} \hline Parameter name & & Default value & Status in the fit \\ \hline \hline Shaping time & \(\tau_{s}\) & 15.2 ns & fixed \\ Calibration time & \(\tau_{exp}\) & 365 ns & fixed \\ Detector capacitance & \(C_{d}\) & & \\ Drift time & \(\tau_{d}\) & 400 ns & fixed \\ Calibration step & \(f\) & \(\simeq\) 5\% & fixed \\ Detector + Mother-board inductance & \(L_{d}\) & & \\ Preamp impedance & \(R_{\mathit{pn}}\) & 50\(\Omega\) or 25\(\Omega\) & fixed \\ Injection resistance & \(R_{\mathit{inj}}\) & & fixed \\ Reflections Amplitude & \(R_{1},R_{2}\) & & \\ Cable lengths & & & fixed \\ Signal velocity & \(v_{c\mathit{able}}\) & (1/6.1)m ns\({}^{-1}\) & fixed \\ “Dirac” term & \(\alpha\) & & \\ \hline \end{tabular}
\end{table}
Table 2: List of the parameters used in the function to be fitted on data, with their status in the fit (fixed or free).

### Conclusion

In this section, we tried to understand the calibration and physics pulse shapes using a sophisticated electrical model including several effects on the calibration board and multiple reflections on the read out line. It was shown that the read out chain is a complex system and needs many parameters for a complete description. In particular the impedances play a crucial role in the shapes of the pulses. The fit to calibration pulses and the prediction of the physics pulse gives results to within 4% partly due to this effect. As all the parameters characterizing the system are difficult to evaluate, this method doesn't seem to be appropriate to provide a sufficiently efficient electronic calibration. Therefore, it cannot be used for energy reconstruction.

## 5 Physics pulse prediction with the FFT method

### The FFT method

In the previous modelling of the electrical circuit for one channel, it has been shown that it is important to understand correctly the read out cable and the read out electronics (cables, feedthrough, preamplifier and shaper), while calibration line can be ignored.

The assumption made hereafter consists in saying that the read out cable and electronics can be considered as a quadrupole with an unknown transfer function \(H_{ro}(s)\) in the frequency domain. Coming back to the basic description given in Sect. 3.1 the formulae for calibration and physics can now be written in the frequency domain as

\[\mathcal{L}[U_{cal}](s) = \mathcal{L}[I_{cal}](s)\;H_{del}^{cal}(s)\;H_{ro}(s) \tag{18}\] \[\mathcal{L}[U_{phy}](s) = \mathcal{L}[I_{phy}](s)\;H_{del}^{phy}(s)\;H_{ro}(s) \tag{19}\]

Taking the ratio to eliminate the unknown \(H_{ro}(s)\) function gives

\[\mathcal{L}[U_{phy}](s)=\frac{\mathcal{L}[I_{phy}](s)}{\mathcal{L}[I_{cal}](s) }\frac{\omega^{2}}{s^{2}+\omega^{2}}\mathcal{L}[U_{cal}](s) \tag{20}\]

Here, we have assumed that the detector is well modelled by (5) and (7), that the calibration pulse \(U_{cal}(t)\) is known from the data, and \(I_{phy}(t)\) and \(I_{cal}(t)\) are well modelled by (2) and (11). Physics pulses \(U_{phy}(t)\) can then be predicted. However, as \(U_{cal}(t)\) is given by a numerical pulse, \(U_{phy}(t)\) can not be computed through an analytical function, but only numerically. Therefore, as \(FT[g](f)=\mathcal{L}[g](if)\), one has

\[FT[U_{phy}](f)=G(f)FT[U_{cal}](f)\;\;\;\;\;\mbox{with}\;\;\;\;\;\;G(f)=\frac{ FT[I_{phy}](f)}{FT[I_{cal}](f)}\frac{\omega^{2}}{\omega^{2}-f^{2}} \tag{21}\]

In practice the calibration pulse is known as a set of 175 samples spaced by 1ns. Assuming the starting time \(t_{0}^{cal}\) is known, 128 samples are selected corresponding to the values \(U_{cal}(k\Delta t+t_{0}^{cal})\), \(k\in\{0,127\}\) and \(\Delta t=1\)ns. Then \(FT[U_{cal}](k\Delta t+t_{0}^{cal})\) is computed using an FFT algorithm; its module and argument are shown in figure 19a.

The function G(f) is the product of two terms described by the following effects: first, the calibration current is not injected at the same point as the physics current (\(\frac{\omega^{2}}{\omega^{2}-f^{2}}\)); second, the physics and calibration injected currents don't have the same time dependence (\(\frac{FT[I_{phy}](f)}{FT[I_{cal}](f)}\)). The module and the argument of \(G(f)\) are shown in figure 19b. The product of these two functions gives the Fourier transform of the predicted waveform (Fig. 19c). This waveform depends only on the two parameters \(\omega^{2}\) and \(t_{0}^{cal}\).

### Results with the "toy calorimeter" data

The FFT method is applied to the toy calorimeter data. The results are shown in figure 20 and can be compared to those of the reflection model (Fig. 18). The residuals are smaller than those in section 4 while using only one parameter. In particular the main part of the pulse (except the tail) is reproduced much better than with the reflection model.

### Results with the test beam data

In this section, we give the results with august 2000 test beam data. Pulse shapes are reconstructed as explained in section 2.2. The fit is performed by minimizing a \(\chi^{2}\) which takes into account of the strong correlation between the samples for each \(t_{tdc}\) value. Assume the \(N_{s}\) (\(N_{s}\) = 7) sample values are given as

\[y_{i}=E_{a}\,f_{i}+\,b_{i} \tag{22}\]

where \(E_{a}\) is the average energy for the TDC value \(t_{tdc}\in[a,a+1]\), or, with a vectorial notation

\[y=E_{a}f+\,b \tag{23}\]

From now on the dependence of \(y\) and \(f\) on \(a\) is not written explicitely.

One has \(f_{i}=U_{phy}(25\times i-a+t_{0}^{phy})\) and \(b_{i}\) is the noise. The starting times for the predicted physics curve \(U_{phy}(t)\) and for the physics curve measured at the test beam have no reason to be the same. This is due to the presence of time offsets in the test beam system and also to the propagation time in the cables (see later). Therefore, we introduce the time offset \(t_{0}^{phy}\).

The parameters to estimate are the 25 \(E_{a}\) values and the parameters determining the shape of \(U_{phy}(t)\). The following \(\chi^{2}\) is minimized:

\[\chi^{2}=\sum_{a\,=1}^{25}(y-E_{a}\,f)^{t}B^{-1}(y-E_{a}\,f) \tag{24}\]

where B is the noise autocorrelation matrix. The dependence of the \(\chi^{2}\) on the parameters \(E_{a}\) can be eliminated by minimizing the \(\chi^{2}\) with respect to these parameters. This is exactly was is done in the optimal filtering method and it is easy to show that for any \(a\):

\[E_{a}=\frac{y^{t}B^{-1}f}{f^{t}B^{-1}f} \tag{25}\]

The \(\chi^{2}\) then becomes

\[\chi^{2}=\sum_{a\,=1}^{25}\left[y^{t}B^{-1}y-\frac{(y^{t}B^{-1}f)^{2}}{f^{t}B^ {-1}f}\right] \tag{26}\]

It is assumed that there is no noise autocorrelation, which seems reasonnable at the level of precision the fits are made. Finally the \(\chi^{2}\) is given by

\[\chi^{2}=\sum_{a\,=1}^{25}\left(y^{2}-\frac{(f^{t}y)^{2}}{f^{2}}\right) \tag{27}\]

At the level of the data acquisition, the pulses are recorded with \(N_{s}=7\) samples. The ionisation signal \(U_{phy}(t)\) is predicted on the interval [0,128 ns]. Then the \(\chi^{2}\) is computed with only 125 samples.

The \(\chi^{2}\) depends on three parameters :* \(\omega^{2}=\frac{1}{L_{d}C_{d}}\)
* the starting time of the calibration signal \(t_{0}^{cal}\)
* the starting time of the ionisation signal \(t_{0}^{phy}\)

We perform the fit for the core region (i.e. equipped with good electrodes [2]). The following comments can be made:

* The residuals of the fits are shown for some chosen cells of the presampler, front, middle and back layers in figures 21,22,23 and 24 respectively.
* The residuals are now smaller than 2%. In addition the FFT method has only one electrical parameter to be fitted (\(\omega^{2}\)) whereas the model with reflections has many parameters.
* The parameter \(L_{d}C_{d}\) is fitted. Capacitance values \(C_{d}\) have on the other hand been directly measured on the module or estimated by electrical simulation of the detector. The inferred values of \(L_{d}\) can be seen in figure 25 as a function of \(\eta\) for three lines in \(\phi\). One can see that these values follow a pattern every 8 middle cells corresponding to the motherboard periodicity and following also the pattern of non-uniformity in \(\eta\) observed in [1]. For the line \(n_{\phi}=10\) the inductances have been measured (for the regions \(\eta\in[0,0.2]\) and \(\eta\in[0.8,0.9]\)) on the module by a resonance method [11] or simulated elsewhere. One can see in figure 25 that there is good agreement between the fitted and the measured or simulated inductance values. It is now believed that there is an asymmetrical ground return on a back summing board associated with a variation of the inductance. This observation (which has led to the modification of the electrodes) is in good agreement with our model. In conclusion there is good hope that the description of the pulse can be made in the future using the measured values for \(L_{d}\) and \(C_{d}\).
* Some effects can be observed in this FFT method: the predicted physics shape is strongly affected by a boundary effect, that is the choice of the \(t_{0}^{cal}\) parameter. Although the fit can determine this quantity, the determination is not very precise. In particular a trough at the begining of the pulse (Fig. 21,22,23) can be seen. The origin of this phenomenom is not understood yet and could be due to the FFT algorithm and the choice of the time window. More work is needed to investigate this effect.
* On the back layer (Fig. 24) the shape of the physics pulse is found to be distorted and it has been shown that this is due to cross-talk. Our model doesn't take this effect into account yet.
* The value of \(t_{0}^{cal}\) can in principle be predicted if the various time offsets of the test beam system are perfectly known. This predicted value \(T_{0}^{cal}\) is given by: \[T_{0}^{cal}=A+T_{cal}+T_{sig}-T_{cal}^{pdg}\] (28) \(T_{sig}\) (resp. \(T_{cal}\)) are the propagation times in the read out (resp. calibration) cables. The signal velocity is taken to be \(v_{cable}=(1/5.6)\)m ns\({}^{-1}\). The value \(T_{cal}^{pdg}\) is an ajustable time delay (by steps of 50ps) which can be programmed in the TTC system [12]. For calibration pulses, this quantity is chosen such that for each FEB, the fourth sample is, on average, at the maximum of the signal. In the previous equation, \(A\) is a constant global to the system. It is shown in figure 26 that \(t_{0}^{cal}\) and \(T_{0}^{cal}\) agree as a function of \(\eta\) with an accuracy of 2 ns, except for the back layer where the signals are distorted by cross-talk. In the middle layer, even if the stepsin time predicted between the FEBs is well reproduced on average, a slope in each FEB causing a variation of 4ns amplitude is not yet understood.
* Similarly the predicted time for the ionisation signal can be written as \[T_{0}^{phy}=B+T_{OF}+T_{sig}-T_{phy}^{pdg}\] (29) \(T_{OF}\) is the time of flight of the particle in test beam set-up. The length of flight is given by \[L_{OF}=\mathrm{Cst}+1470\mathrm{ch}(\eta)-954\frac{1}{\mathrm{ch}(\eta)}-116 2\mathrm{th}(\eta)\;[\mathrm{mm}]\] (30) It is derived from the movement of the cryostat table with respect to the beam line. \(T_{OF}\) is then given by \(L_{OF}/c\). \(B\) is a global parameter. It can be seen in figure 27 that \(t_{0}^{phy}\) and \(T_{0}^{phy}\) agree with an accuracy of 2 ns in the middle and the front layers. The end of the module (large \(\eta\)) is not so well understood.
* Even if the level of prediction for the physics shapes seem to be satisfactory, some behaviour remains, like discontinuities every 25ns as shown in figure 28, affecting the time determination with the optimal filtering method [1]. This is partly though to be due to the method but this makes us believe that some work is needed to undestand the timings for calibration and physics in the test beam setup.

## 6 Absolute electrical calibration

The energy deposited in a cell is related to the amplitude at the maximum of the response \(ADC_{max}\) by

\[E=\frac{1}{I_{o}/E}\times\alpha AD\,C_{max} \tag{31}\]

The absolute electrical calibration factor \(\alpha\) (\(\mu\)A per ADC count) for an ionization signal can be expressed as

\[\alpha=r\times\frac{V_{0}}{(2^{17}-1)\times R_{in\,j}(\Omega)}\times\frac{M_{ phy}}{Mcal} \tag{32}\]

where :

* \(I_{0}/E\) (\(\mu\)A/GeV) is the conversion factor from deposited energy to current [15].
* \(r=\) DAC count/ADC count, is the factor determined with ramp runs [16]. It is the response in ADC counts to a calibration signal of 1 DAC count.
* The second term (in \(\mu\)A per DAC count) represents the injected current through an injection resistance \(R_{in\,j}\) for a DAC value equal to 1. The range of the signal generated by the calibration board is between 0 and \(V_{0}\)=5V and is divided in 2\({}^{17}\) DAC counts.
* \(\frac{M_{phy}}{Mcal}\) is a the ratio of the amplitude at maximum of a calibration over an ionization signal (Fig. 29). It is calculated by setting in (21) the same amplitude for the currents \(I_{phy}\) and \(I_{cal}\), i.e. \(I_{0phy}\) in (2) equal to \(I_{0cal}\) in (11). Figure 30 represents this ratio versus \(\eta\) for the middle layer computed with august 2000 data. The deviation from 1 is a 5% effect. The cell to cell variation is \(\pm 2\)%. Not taking into account this cell to cell variation would induce a \(\pm 2\)% non uniformity. Comparison of figure 30 and 25 shows that this correction factor is closely linked to the inductance of the cell.

The value of \(ADC_{max}\) is computed with the optimal filtering method [13, 14] by using the predicted physics shapes.

Conclusion and perspectives

This note reports a study of the calibration and physics pulse shapes recorded with the prototype module calorimeter at the H8 test beam in 2000. In a first attempt, we have taken into account the main effects (especially reflections) for the toy calorimeter by introducing many parameters. The agreement between the predicted calibration signals and data is better than 1%. However, the fitted parameters do not compare well measured/estimated one and the agreement for the ionisation signals is much worse (\(\sim 4\%\)). We conclude that the complete electrical system would need a much more elaborate description.

Therefore, we have developped the FFT method which provides a better than 2% agreement for the physics pulses with only 2 free parameters. In addition, the absolute amplitude of the physics pulses are also predicted in \(\mu\)A/ADC allowing an absolute electrical calibration of the detector. Confident in this description, optimal filtering weights have been computed and officially included in the EMTB software for further test beam analyses. In particular the \(\eta\) uniformity using these new coefficients is now below the 0.8% level [1].

A good level of description is now reached, but there is still room for improvements:

* The FFT method, using an FFT algorithm, is very sensitive to the window choice.
* The predicted timing for the physics and the calibration signal is not better than 1-2ns. A better understanding of the TTC system and the calibration board is clearly needed as well as an improved determination of the particle time of arrival (with a more precise photomultiplier system).
* The crosstalk is overlooked in this study. At the level of precision we have reached, it plays an important role. In particular the structural crosstalk between the strips might need a special treatment for the optimal filtering coefficient computation. The crosstalk involving the back layer also needs a special care.
* Some approximations are done in the description of the electrical model e.g. various calibration line imperfections are not considered [17].

## 8 Acknowledgements

The authors express their gratitude to all the Liquid Argon community for the efforts which led to the success of the test beam data taking. They especially want to thank Lucia Di Ciaccio, Remi Lafaye, Christophe De La Taille, Bill Cleland, Jacques Colas and Helenka Przysiezniak.

## References

* [1] L. DiCaccio, L. Neukermans, P. Perrodo, R. Zitoun, _Improvements in the LARG response using a new method based on the electrical description of the calorimeter pulses_, ATL-LARG-2001-xxx, in preparation.
* [2] A. Jeremie, N. Massol, P. Perrodo and G. Sauvage, _Channels of the may EMB2000 prototype module_ can be found on [http://wwwlapp.in2p3.fr/~perrodo/atlas.html](http://wwwlapp.in2p3.fr/~perrodo/atlas.html).
* [3] J. Colas & al., _The LAr calorimeter calibration board_, ATL-LARG-2000-006.
* [4] M. Abouelouafa, B. Cleland, M. Gouanere, P. Perrodo and H. Takai, _Trigger setup in the H8 test-beam area_ can be found on [http://wwwlapp.in2p3.fr/~perrodo/atlas.html](http://wwwlapp.in2p3.fr/~perrodo/atlas.html).
* [5] J. Colas, C. De La Taille, R. Lafaye, N. Massol, P. Pralavorio, D. Sauvage, L. Serin, _Crosstalk in the ATLAS Electromagnetic Calorimeter_ ATL-LARG-2000-004 F. Hubaut,B. Laforge,D. Lacour, F. Orsini, _Test-beam Measurement of the Crosstalk in the EM Barrel Module 0_, ATLAS Internal Note/ ATL-LARG-2000-007, April 2000.
* [6] R.L. Chase & al., _A fast monolithic shaper for the ATLAS electromagnetic calorimeter_, ATLAS Internal Note/LARG-N0-10/ March 1995.
* [7] MATHEMATICA, version 3.0, Wolfram Research, Inc.
* [8] B. Cleland, private communication.
* [9] J. Colas, R. Lafaye, P. Perrodo, _Last Cabling Specifications for the EMB_ Internal Note, October 1998.
* [10] W.E. Cleland, _Pulse Shape_, Talk at EM test-beam meeting, 22/02/2000.
* [11] C. De La Taille, _Inductances and capacitances measurements_, Talk at EM test-beam meeting, 7/12/1999.
* [12]_Fast Signal distribution for module 0_ ATL-AL-CEA-ES-4.0
* [13] W.E. Cleland, E.G. Stern, _Signal processing considerations for liquid ionization calorimeters in a high rate environment_, NIM **A**338(1994)467-497.
* [14] R. Zitoun, _Use of optimal filtering in the 1999 data_ ATL-LARG-2001-003.
* [15] ATLAS Collaboration, _Liquid argon calorimeter technical design report,_ CERN/LHCC/96-41
* [16] D. Nicod, D. Zerwas, R. Zitoun, _EMTB User Guide V.1-4_, can be found on [http://atlasinfo.cern.ch/Atlas/GROUPS/LIQARGON/TESTBEAM/emtb.html](http://atlasinfo.cern.ch/Atlas/GROUPS/LIQARGON/TESTBEAM/emtb.html).
* [17] L. Kurchaninov,_Calibration and Ionization Signals in the ATLAS Hadronic End-Cap Calorimeter_, Talk at CALOR2000.

[MISSING_PAGE_EMPTY:15]

Figure 4: Physics pulse shapes in a cell (\(n_{\eta}=13,\ n_{\phi}=10\)) of the middle layer. The shape with circles corresponds to events with the core of the shower in the cell (selected with the strips). The shape with triangles corresponds to events with the core of the shower located in a neighbour cell. The shape with squares corresponds to all events.

Figure 5: A schematic view of the electrical tests on the toy calorimeter. One can see the two ways of injecting a signal, either through the usual calibration low profile, or directly on the detector capacitance \(C_{d}\).

Figure 6: Basic electrical model for one channel showing where electrical signals are input.

Figure 7: The physics (solid) output signal \(U_{phy}(t)\) and calibration (dashed) signal \(U_{cat}(t)\) corresponding to the circuit in figure 6. The parameters used are: \(C_{d}=1.5\)nF, \(L_{d}=20\)nH, \(\tau_{s}=15\)ns, \(\tau_{d}=400\)ns and \(\tau_{exp}=36\)ns.

Figure 8: Electrical schemes of the calibration circuit loaded with a \(50\,\Omega\) impedance. a: simple circuit, b: more realistic circuit.

Figure 9: Components of the calibration signal after shaping corresponding to (11). The thin solid line is the main exponential, the dashed line (\(\times 10\)) is the “step” component and the dashed-dotted line (\(\times\,\mathbb{O}\)), the “Dirac” component. The bold solid line is the sum of all components.

Figure 11: Sketch of the read out line. \(\tau_{i}\) is the signal propagation time in the section \(i\) and \(\rho_{i}=(Z_{i+1}-Z_{i})(Z_{i}+Z_{i+1})\) is the reflection coefficient between two successive sections.

Figure 10: Final scheme of the calibration and read out chain for one cell (here a 25\(\Omega\) channel). Details of the calibration board circuit, the feedthrough lines, the cold lines, the motherboard and the detector description are shown, as well as the read out preamplifier.

Figure 14: Components of the reflections for the physics waveform. The thin solid line is the waveform without reflections (\(U^{0}(t)\)), the dashed line is the \(A(t)\) component (\(\times 10\)), the dashed-dotted line is the \(B(t)\) component (\(\times 10\)). The bold solid line is the sum of all components (\(U(t)\)).

Figure 12: Components of the different reflection terms in the read out line for the calibration waveform. The thick line is the waveform without reflection \(U^{0}(t)\), the dashed line is the \(A(t)\) component (\(\times 10\)), the dashed-dotted line is the \(B(t)\) component (\(\times 10\)). The bold line is the sum of all components (\(U(t)\)).

Figure 13: Reflection term in the injection line for the calibration waveform. The thin solid line is the calibration waveform without reflection (hidden by the bold line), the dashed line is the reflection component (\(\times 10\)). The bold solid line is the sum of all components.

Figure 15: Fit of the model with reflections on eight calibration pulse shapes from the line \(n_{\phi}=9\) of the toy calorimeter. Each graph shows the data superimposed with the fit (not visible) and the residuals (\((data-fit)/max_{putsc}\)) multiplied by 10.

Figure 18: Fit with the electrical model with reflections on eight physics pulse shapes from the line \(n_{\phi}=9\) of the toy calorimeter. Each plot shows the data (solid line) superimposed with the fit (dot-dashed lines) and the residuals \(((data-fit)/max_{pulse}\) as a dotted line) multiplied by 10. In each fit the parameters are taken from the fit on the corresponding calibration pulse; only the time and the amplitude are fitted.

Figure 19: The Fourier transform of the calibration signal (a1) and a2)). The function G(f) (b1) and b2)). The Fourier transform of the predicted physics waveform (c1) and c2)).

Figure 20: Fit of the FFT model on eight physics pulse shapes from the line \(n_{\phi}=9\) of the toy calorimeter. Each plot shows the data (points) superimposed with the fit (dot-dashed lines) and the residuals (\((data-fit)/max_{pulse}\) as a dotted line) multiplied by 10.

Figure 21: Fit results for presampler cells with the FFT method. Each plot shows the data (crosses) superimposed with the fit (thin line) and the residuals (\(\times 10\)).

Figure 22: Fit results for the front sampling cells with the FFT method. Each plot shows the data (crosses) superimposed with the fit (thin line) and the residuals (\(\times 10\)).

Figure 23: Fit results for the middle sampling cells with the FFT method. Each plot shows the data (crosses) superimposed with the fit (thin line) and the residuals (\(\times 10\)).

Figure 24: Fit results for the back sampling cells with the FFT method. Each plot shows the data (crosses) superimposed with the fit (thin line) and the residuals.

Figure 25: Predicted inductances (black rectangles) versus \(\eta\) for the middle layer cells and for three lines in \(\phi\). Open triangles for \(n_{\phi}=10\) represent the measured inductances (for the regions \(\eta_{nb}\in[0,8]\) and \(\eta_{nb}\in[32,36]\)) and simulation values elsewhere.

[MISSING_PAGE_EMPTY:29]

[MISSING_PAGE_EMPTY:30]

[MISSING_PAGE_EMPTY:31]

Figure 30: Ratio \(M_{phy}\,/M_{cal}\) for the same injected charge versus \(\eta\) in the middle layer with the august 2000 test beam data.