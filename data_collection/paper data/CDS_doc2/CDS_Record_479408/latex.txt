**A study of the barrel presampler in the 1997 testbeam at CERN**

**C. Clement**

KTH Stockholm, Sweden

**A. Ferrari**

ISN Grenoble, France

**Abstract**

In this note, we present the performance of the first final ATLAS barrel presampler module tested in beam at CERN in 1997. The electronic noise is measured in single presampler channels, as well as in various groups of cells. We show that it can be reduced by about 30% by using the optimal filtering. Then, the response of the presampler to a 100 GeV electron beam is studied, with various amounts of upstream material. We show that the presampler allows to compensate for the energy loss in the upstream material and thus maintain the energy resolution of the electromagnetic calorimeter at the level required for ATLAS.

[MISSING_PAGE_EMPTY:2]

Introduction

In October and November 1997, the first final ATLAS barrel presampler module was tested at the H6 beamline at CERN, together with a part of the barrel electromagnetic calorimeter prototype used in 1996. This 1997 test used an electron beam provided by the SPS. The available energies were 20, 50, 100 and 200 GeV. The data acquisition was triggered by two scintillators located about one meter before the cryostat containing the presampler and the calorimeter. The presampler was mounted in front of the calorimeter inside a cryostat filled with liquid argon. The thickness of the cryostat wall was 0.7 radiation length. Furthermore, lead plates could be installed or removed just after the scintillators in order to simulate different amounts of upstream material.

A module 3 of the presampler was tested. It is identical to a real ATLAS presampler module located between \(\eta=0.4\) and \(\eta=0.6\)[1]. The calorimeter was a cut part of the 1996 prototype [2]. It extended from \(\eta=0\) to \(\eta=0.216\) and it covered \(9^{\circ}\) in the \(\phi\) direction (which corresponds to one module). Its cabled part was about 0.11 in \(\eta\) and 0.16 in \(\phi\), which corresponds to \(6\times 4\) cells in the \((\eta;\phi)\) plane. To match the geometry of the end-cap cryostat in which it was installed, the barrel calorimeter prototype had to be rotated by \(90^{\circ}\), leading thus to an inversion of \(\eta\) and \(\phi\): in the calorimeter \(\eta\) was vertical, while it was horizontal in the presampler (see figure 1).

Figure 1: _View of the presampler and the calorimeter before their installation in the liquid argon cryostat._

The front-end electronics boards placed on top of the cryostat contained preamplifiers and bipolar shapers but no analog pipelines or ADCs, as planned for ATLAS. The shapers had two possible output gains (low and high) in order to cover the energy range from 20 to 200 GeV. In this set up, the low gain was about 10 times higher than the low gain which is planned for ATLAS. This unfortunately led to saturation in most of the runs. The front-end boards were read out through a separate analog pipeline and ADC system. During this testbeam, several pieces of new electronic equipment were used. A new reconstruction software written in C, which was adapted to them, has therefore been developed and tested [3].

## 2 Use of the optimal filtering in the 1997 data

### Multiple sampling and computation of optimal weights

The height of a pulse after shaping is proportional to the energy deposited by a passing charged particle in the liquid argon. By sampling the pulse at its peak, one can get a measurement of the energy. But some errors are introduced by the following effects:

* the pulse contains noise,
* the sample assumed to be taken at the top of the pulse can be shifted, because of a jitter between the pulse and the sampling clock as it is the case for a beam which arrives asynchronously with respect to the clock.

These effects can nevertheless be partially compensated by sampling the pulse and by using the optimal filtering technique. Some linear combinations of the samples allow to calculate the amplitude of the digitized pulse or its start time. When the pulse shape and the noise autocorrelation matrix are known, linear coefficients can be optimized in order to maximize the signal to noise ratio. The precision obtained in this way on the amplitude \(A\) and the start time \(\tau\) of the pulse can exceed the accuracy obtained with a single sample [4, 5]. With two sets of linear weights \(a_{i}\) and \(b_{i}\), we form the following linear combinations:

\[A={\sum_{i}}a_{i}S_{i}\mbox{ and }A\tau={\sum_{i}}b_{i}S_{i} \tag{1}\]

where \(S_{i}\) are the signal samples. The computation of \(a_{i}\) and \(b_{i}\) is described in details in [4], so we just give a brief overview of the method. First, the following conditions are imposed on the average of the sums described in equation (1):

\[A=<{\sum_{i}}a_{i}S_{i}>\mbox{ and }A\tau=<{\sum_{i}}b_{i}S_{i}> \tag{2}\]

If the signal shape can be described with a function \(g\), then the samples \(S_{i}\) can be expressed in the following way:

\[S_{i}=Ag(t_{i}-\tau)=Ag_{i}-A\tau g^{\prime}_{i}+n_{i} \tag{3}\]

Here, \(n_{i}\) is the noise, while \(g_{i}\) and \(g^{\prime}_{i}\) are respectively the value of the shaping function \(g\) and the value of its first derivative for the sample \(i\) (a Taylor expansion has been used).

When replacing \(S_{i}\) by its Taylor expansion in equation (2), one gets:

\[\begin{array}{l}A=\sum_{i}(Aa_{i}g_{i}-A\tau a_{i}g_{i}^{\prime}+<n_{i}>)\\ A\tau=\sum_{i}(Ab_{i}g_{i}-A\tau b_{i}g_{i}^{\prime}+<n_{i}>)\end{array} \tag{4}\]

By requiring that the average of the noise remains equal to zero, the following constraints are obtained:

\[\begin{array}{l}\underset{i}{\sum}a_{i}g_{i}=1\quad\underset{i}{\sum}a_{i}g_ {i}^{\prime}=0\\ \underset{i}{\sum}b_{i}g_{i}=0\quad\underset{i}{\sum}b_{i}g_{i}^{\prime}=-1 \end{array} \tag{5}\]

With these conditions, the variances \(Var(\sum_{i}a_{i}S_{i})\) and \(Var(\sum_{i}b_{i}S_{i})\) are minimized using Lagrangian multipliers. This yields to the following equations:

\[\begin{array}{l}a_{i}=\lambda V_{ij}g_{j}+\kappa V_{ij}g_{j}^{\prime}\\ b_{i}=\mu V_{ij}g_{j}+\rho V_{ij}g_{j}^{\prime}\end{array} \tag{6}\]

Here, \(V_{ij}\) is the inverse of the autocorrelation matrix \(R_{ij}=<n_{i}n_{j}>\), while \(\lambda\), \(\kappa\), \(\mu\) and \(\rho\) are the Lagrangian multipliers, which are computed using the constraints given by the equations (5).

In ATLAS, data will be taken synchronously with 5 samples at 25 ns intervals. The third sample will be close to the peak, with a precision of 2 ns. Optimal filtering will be applied to compute the pulse amplitude, to compensate for the jitter between the sampling clock and the pulse and to reduce the noise [6]. The computation of the amplitude \(A\) and the start time \(\tau\), along with the knowledge of the average pulse shape, can be used to obtain an estimation for the five samples, provided that the energy is high enough. Furthermore, a too large deviation between the measured samples and the computed ones may indicate a significant pile-up noise, so the corresponding events will be flagged.

### Computation of optimal weights in the 1997 testbeam data

In the 1997 testbeam, physics data were taken asynchronously, which means that the five samples were not at fixed positions on the pulse, so none of the samples was arranged to stand at the top of the peak. In order to calculate the pulse amplitude, one must first know the pulse shape, then compute the optimal weights and finally apply them to the pulse generated by a passing electron. The pulse shape can be determined in physics runs for each channel that receives enough energy (as shown in figure 2). For the channels which do not receive enough energy, one uses the optimal weights computed for the nearby illuminated channels. Since the phase of the pulse with respect to the sampling clock varies, it is possible to cover the whole pulse with a large number of events. The pulse is divided into 100 bins. For each of them, the average value of the signal is computed. For each event and each cell, the phase of the pulse with respect to the sampling clock is measured and stored. Using this phase, the time bins corresponding to the five samples of the event are computed. As the sampling frequency is 40 MHz,the phase difference between the pulse and the sampling clock can vary between 0 and 25 ns. Each phase of the pulse has a corresponding set of optimal weights for the five samples. The interval 0-25 ns is divided into 20 phase bins for each of which a set of optimal weights is computed. To apply the optimal filtering, the phase of the pulse is read in the data, the corresponding phase bin is identified and the corresponding set of optimal weights is applied.

Calibration data were taken synchronously: the five samples were always at the same position on the pulse. This does not allow the pulse shape and the optimal weights to be computed using testpulse runs. Consequently, one has to use the weights computed in physics runs to apply the optimal filtering to the calibration signals. This is not fully correct, since electron pulses and calibration signals are not identical: the electron pulses have a triangular shape and they directly come from the ionization of the liquid argon, while the calibration pulses are exponential signals which are injected into the detector from outside the cryostat. But, despite these differences, we will assume that their pulse shapes are the same.

If one wants to apply the weights of the physics runs to the calibration pulses, it is necessary to first determine the phase of the calibration pulse with respect to the sampling clock. Therefore, the calibration data must be processed twice: once for computing the phase of the calibration pulse with respect to the sampling clock and choosing the right set

Figure 2: _Normalized pulse shape measured in a presampler cell during a physics run._

of optimal weights, once to compute the correspondance between the detector response and the energy scale, with the use of optimal filtering. To compute the phase of the calibration pulse with respect to the sampling clock, one proceeds as follows. First, one chooses an arbitrary phase bin and the corresponding set of optimal weights computed in a physics run. These weights are applied to the five samples of the calibration pulse. The time \(\tau\) computed in this way is the phase of the calibration pulse with respect to the bin chosen. Knowing the phase of this bin with respect to the sampling clock, one can thus derive the phase of the pulse with respect to the sampling clock. For each channel, it is stored in a database and then reused in the computation of the amplitude of the pulse for the detector calibration.

## 3 Calibration of the detector

### Conversion between the injected pulse and the energy scale

A charged particle which passes through the detector induces ionization in the liquid argon all along its track. The corresponding charges are collected by the anodes of the detector. After the amplification and the shaping, five samples of the signal are digitized by an ADC (Analog to Digital Converter). At this stage, the signal is measured in ADC-counts.

The presampler is a 1.1 cm thick liquid argon layer, where a minimal ionizing particle (further refered to as a MiP) deposits 2.11 MeV per centimeter of liquid argon. This means that the energy deposited by a MiP crossing the presampler is:

\[E_{MiP}=2.32\ \mathrm{MeV} \tag{7}\]

This energy induces ionization in the liquid argon. The mean energy required to produce an ion-electron pair is \(W=23.6\) eV [7] and the drift time is \(t_{D}=420\) ns in the presampler. This means that a MiP induces the following current:

\[i_{MiP}=\frac{E_{MiP}\times e}{W\times t_{D}}=37.5\ \mathrm{nA} \tag{8}\]

At the input of the motherboard, the signal is in the range 0-5 V and it is divided into \(2^{17}\) DAC (Digital to Analog Converter) units. The input impedance of the motherboard is 50 \(\Omega\) (see figure 3). Thus, the injected current \(i_{inj}\) for the smallest unit of the DAC is:

\[i_{inj}=\frac{5\ \mathrm{V}}{2^{17}\times 50\ \Omega}=0.76\ \mu\mathrm{A/DAC-count} \tag{9}\]

As shown in figure 3, this current is divided into 16 channels and the impedance of the calibration board is 33.4 k\(\Omega\). Taking this into account, the current injected in one presampler cell is 1.14 nA/DAC-count. Since the current induced by one MiP has been computed, the energy corresponding to one DAC-count can be derived:

\[1\ \mathrm{DAC-count}=0.070\ \mathrm{MeV} \tag{10}\]In order to get the correspondance between an ADC count and a DAC-count, one has to calculate the gain of each readout cell. This is done in the calibration runs, after the substraction of the pedestals.

### Pedestal

The pedestal of a readout channel is the output signal when there is neither a beam nor a calibration pulse. The pedestal levels are calculated by computing the average output of each channel over all the pedestal events. Together with their standard deviation (which corresponds to the electronic noise), the pedestal levels are stored in a database for later use with calibration and physics data, where they are substracted channel by channel.

### Calibration of the response

To calibrate the response of the presampler, its cells are pulsed with signals of different amplitudes in DAC-counts. These pulses have roughly a triangular shape but are actually exponential signals with a time constant close to \(t_{D}\). The whole dynamic range is scanned using 10 to 15 DAC values. When the presampler is pulsed, its response (in ADC-counts) is read out and recorded (see figure 4).

Shown in figure 5 is the response of a presampler cell when it is pulsed with calibration signals of various amplitudes: the presampler response is linear with a good accuracy and it is thus parametrized by a straight line (the calorimeter cells response is parametrized with a third degree polynomial function). The gain derived in this way is stored in a database for later use in physics runs. Note that, for the dead channels, the gain is artificially set to zero.

Figure 3: _Calibration system for the presampler [8]._

Figure 4: _A calibration pulse (lower curve) and the corresponding response in a presampler cell (upper curve)._

Figure 5: _Response of one presampler cell to a ramp of injected pulses for the two possible output gains. On the right-hand side figure, the error bars are of the order of 1 ADC count: they are thus too small to be seen (see section 4.1)._

Noise measurements

### Noise measurements in presampler single cells

The electronic noise in the presampler cells is computed as follows. First, the standard deviation of the pedestal is calculated channel by channel. Then, the presampler gains are computed for each cell by using a testpulse run. Knowing the electronic noise in ADC-counts, it is thus possible to transform it into DAC-counts and further make the conversion into an energy scale. This study has been done for the two possible gains of the bipolar shapers (see figure 6). On average, the electronic noise, without optimal filtering, is 3.5 MeV (respectively 6.3 MeV) per single cell when the bipolar shapers work in high (respectively low) gain.

When the shapers work in high gain, the electronic noise mainly comes from the detector cells and the preamplifiers. For a module 3 of the presampler, one expects a noise level at 3.95 MeV if the peaking time \(t_{p}\) of the signal between 5% and 100% of its amplitude is 32.8 ns [9]. Here, \(t_{p}\) is close to 40 ns (see figure 4), so it is not surprising to measure an average electronic noise which is lower than the expected 3.95 MeV, because the higher the peaking time, the lower the electronic noise in the preamplifiers.

When the shapers work in low gain, the electronic noise coming from the preamplifiers decreases. As a result, one essentially measures the contribution from the electronics downstream the preamplifiers. If one measures the electronic noise in ADC counts, the component coming from downstream the preamplifiers is smaller than the one coming from the detector cells and the preamplifiers. But, if one measures the electronic noise in

Figure 6: _Noise measurements in the presampler cells, when the shapers work in high gain (left-hand side figure) and low gain (right-hand side figure)._

MeV, one must also take the values of the calibration gains into account. As a result, the noise level in MeV is higher when the shapers work in low gain than when they work in high gain.

### Coherent and incoherent noise

In order to understand what is meant by coherent and incoherent noise, let us consider pedestal signals from two presampler channels. These signals are two random variables called \(X\) and \(Y\). Their sum has a noise level \(\sigma_{Noise}\) which is given by:

\[{\sigma_{Noise}}^{2}={\sigma_{X}}^{2}+{\sigma_{Y}}^{2}+2Cov(X,Y) \tag{11}\]

where \(Cov(X,Y)\) is the covariance of the \(X\) and \(Y\) random variables and where \(\sigma_{X}\) and \(\sigma_{Y}\) are the noise levels for \(X\) and \(Y\) as individual channels. The incoherent noise \(\sigma_{Incoh}\) of these two channels is defined as the noise level of \(X-Y\):

\[{\sigma_{Incoh}}^{2}={\sigma_{X}}^{2}+{\sigma_{Y}}^{2}-2Cov(X,Y) \tag{12}\]

The coherent noise \(\sigma_{Coh}\) is given by:

\[{\sigma_{Coh}}^{2}={\sigma_{Noise}}^{2}-{\sigma_{Incoh}}^{2}=4Cov(X,Y) \tag{13}\]

From this last equation, it is clear that the coherent noise represents the correlation of the two signals, or their _coherence_. If \(X\) and \(Y\) were independent variables, as two different detector channels should ideally be, then the coherent noise would be equal to zero. Coherent noise arises from imperfections in the electronic design giving rise for instance to ground loops, interferences with power supplies or cross-talk between channels. In ATLAS, the coherent noise must be kept lower than 3 MeV per channel, because some high coherent noise in an isolated group of cells could fake outgoing particles and thus spoil missing transverse energy measurements.

For an even number of cells N, the coherent and incoherent noises are computed as follows. First, the two quantities _Sum_ and _Alternated Sum_ are computed:

\[\begin{array}{c}Sum=\sum_{cells\ in\ group}S_{i}\\ Alternated\ Sum=\sum_{cells\ in\ group}(-1)^{i}S_{i}\end{array} \tag{14}\]

where \(S_{i}\) is the signal in MeV from the cell \(i\) after calibration. Thus, one has:

\[\begin{array}{c}{\sigma_{Noise}}^{2}=<Sum^{2}>-<Sum>^{2}\\ {\sigma_{Incoh}}^{2}=<Alternated\ Sum^{2}>-<Alternated\ Sum>^{2}\end{array} \tag{15}\]

The coherent noise is then defined by:

\[{\sigma_{Coh}}^{2}={\sigma_{Noise}}^{2}-{\sigma_{Incoh}}^{2} \tag{16}\]

Here, the average values are taken over all pedestal events.

### Effect of the optimal filtering on the noise in the presampler

The influence of the optimal filtering on the electronic noise has been studied for both low and high gain modes in single cells, in 2\(\times\)2 and 1\(\times\)2 clusters (both in the \(\Delta\eta\times\Delta\phi\) and \(\Delta\phi\times\Delta\eta\) coordinates) and in the whole module. In order to estimate the effect of the optimal filtering, the ratio between the noise before and after the use of the optimal filtering is computed (it is called the _reduction factor_).

The influence of the optimal filtering on the electronic noise in single presampler cells has been studied using physics runs. The optimal weights have been computed with data obtained with a beam of 100 GeV (respectively 20 GeV) electrons, when the shapers work in low (respectively high) gain. The noise levels have been computed for the cells where no energy is deposited, before and after the use of the optimal filtering. The results which have been obtained are summarized in table 1. The average noise level in low (high) gain mode after use of optimal filtering is 4.7 MeV (2.3 MeV). An average reduction factor of 1.44\(\pm\)0.04 (respectively 1.38\(\pm\)0.09) can be reached in high (respectively low) gain mode thanks to the optimal filtering in the presampler. This is compatible with the measurements performed in the calorimeter, i.e., 1.34\(\pm\)0.04 for individual channels in high gain mode [10]. According to [11], the reduction factor with a peaking time of \(\tau\)=15 ns (as used in the 1997 tests) should be about 1.7, somewhat higher than what we find here. Nevertheless, as explained in [11], any source of white noise after the shapers can reduce the potential gain of the optimal filtering by up to 30%.

Shown in table 2 are the reduction factors for the total, coherent and incoherent noises in low and high gain modes, when several cells are considered. Here, four 2\(\times\)2 clusters and four 1\(\times\)2 clusters were used. The reduction factors in table 2 are the average reduction factors over the four clusters of the same size.

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|c|} \hline \(\eta\) position (\(\phi=1\)) & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\ \hline \hline Noise in MeV without optimal filtering (low gain shapers) & 5.7 & 6.4 & 6.5 & 6.5 & 7.0 & 6.0 & 7.6 & 6.5 \\ \hline Noise in MeV with optimal filtering (low gain shapers) & 4.0 & 5.0 & 4.6 & 5.1 & 4.6 & 4.3 & 5.3 & 5.0 \\ \hline Noise in MeV without optimal filtering (high gain shapers) & 3.4 & 3.5 & 2.9 & 3.4 & 3.4 & 3.4 & 3.2 & 3.5 \\ \hline Noise in MeV with optimal filtering (high gain shapers) & 2.3 & 2.3 & 2.1 & 2.4 & 2.3 & 2.4 & 2.2 & 2.5 \\ \hline \end{tabular}
\end{table}
Table 1: _Noise level in some presampler cells before and after the use of the optimal filtering, when the bipolar shapers are used in low gain or high gain._

### Variations of the noise with the cluster size

The noise results presented in this section are the values obtained after the application of the optimal filtering. The coherent, incoherent and total noises have been computed in the whole presampler module, in four 2\(\times\)2 and four 1\(\times\)2 clusters, in both low and high gain modes. The results are displayed in tables 3 and 4. The values of the coherent noise presented in these tables have been divided by the number of cells in the cluster. The values of the incoherent noise have been divided by the square root of the number of cells in the cluster. The noise in a group of cells is the standard deviation of the pedestal. The error on one noise measurement is the error on the standard deviation given by \(\frac{\sigma}{\sqrt{2N}}\)[12], where \(N\) is the number of pedestal events and \(\sigma\) is the noise. The number of pedestal events for each gain mode is 1000.

The noise measurements displayed in tables 3 and 4 show that:

* the coherent noise is always smaller than 3 MeV per cell, which is the limit required for ATLAS,
* the coherent noise in some clusters is larger than the coherent noise in the module, this increase can reach 70% in high gain mode,
* the coherent and incoherent noises in low gain mode are not affected by the size of the cluster.

If the coherent noise is essentially due to cross-talk between neighbouring channels, then the coherence remains local and the noise which is coherent at the scale of a small group of cells becomes incoherent in larger clusters. This means that, if there is some coherent noise between close neighbouring cells, then the coherent noise for this cluster will be larger than the coherent noise over the whole module. This also implies that a part of the noise which is coherent at the scale of the small cluster becomes incoherent at the scale of the whole module.

If the coherent noise is rather independent of the relative position of the cells, then the coherent noise arises from interferences with external sources rather than from cross-talk between the channels. In this case, the coherent and incoherent noises are more or less independent of the size of the group of cells.

\begin{table}
\begin{tabular}{||c||c|c|c||c|c|c||} \hline Group of & \multicolumn{3}{c||}{Low Gain} & \multicolumn{3}{c||}{High Gain} \\ \cline{2-7} Cells & Coherent & Incoherent & Total & Coherent & Incoherent & Total \\ \hline Module & 1.31\(\pm\)0.06 & 1.21\(\pm\)0.06 & 1.26\(\pm\)0.06 & 1.63\(\pm\)0.07 & 1.43\(\pm\)0.06 & 1.46\(\pm\)0.06 \\ \hline
2\(\times\)2 clusters & 1.29\(\pm\)0.06 & 1.21\(\pm\)0.03 & 1.23\(\pm\)0.02 & 1.42\(\pm\)0.07 & 1.38\(\pm\)0.02 & 1.38\(\pm\)0.02 \\ \hline
1\(\times\)2 clusters & 1.13\(\pm\)0.17 & 1.29\(\pm\)0.03 & 1.26\(\pm\)0.05 & 1.42\(\pm\)0.20 & 1.41\(\pm\)0.06 & 1.41\(\pm\)0.04 \\ \hline \end{tabular}
\end{table}
Table 2: _Average reduction factors in low and high gain, in different groups of presampler cells. The reduction factors for the 2\(\times\)2 and 1\(\times\)2 clusters have been computed for four clusters of each type. The quoted values are the average of 4 measurements._

## 5 Presampler response to electrons

After the calibration procedure described in section 3, the presampler response to an electron beam was studied. Only one presampler cell sitting in front of the calorimeter region illuminated by the beam received enough energy for the optimal weights to be computed. Thus, these weights have also been used for all the other cells of the presampler, where the signal remained too weak to allow the computation of the pulse shape.

### Shower profiles in the presampler

In this subsection, we look at the shower profiles in the presampler. Figure 7 shows how the energy is distributed among all the presampler cells, for a beam of 20 GeV electrons and with 0.7 or 2.7 radiation lengths of dead material in front of the presampler. To draw such profiles, only the events hitting the middle of the cell 3,0 are selected. One can notice that the larger the amount of upstream material, the larger the zone where energy is deposited in the presampler, which is consistent with an increase of the multiple scattering and the showering due to an increase of upstream material.

### Energy spectra in the presampler

The signal in the presampler is proportional to the number of ionizing particles crossing the liquid argon layer, which have been created by the early showering in the upstream material and which have not been absorbed. As the number of secondary particles is roughly proportional to the energy loss in the upstream material, the presampler response increases when one adds lead plates in front of the cryostat, as shown in figure 8 for 100 GeV electrons and 0.7, 1.7 or 2.7 X\({}_{0}\) of upstream material. To compute the presampler response, we only used the cell giving the largest signal (cell 3,0). It was also the only cell receiving enough energy to allow computation of optimal filtering weights.

\begin{table}
\begin{tabular}{||c||c|c|c||} \hline Group of Cells & Coherent (MeV) & Incoherent (MeV) & Total (MeV) \\ \hline Module & 2.19\(\pm\)0.06 & 4.47\(\pm\)0.10 & 4.97\(\pm\)0.11 \\ \hline
2\(\times\)2 clusters & 2.25\(\pm\)0.05 & 4.48\(\pm\)0.10 & 5.02\(\pm\)0.11 \\ \hline
1\(\times\)2 clusters & 2.16\(\pm\)0.05 & 4.54\(\pm\)0.10 & 5.03\(\pm\)0.12 \\ \hline \end{tabular}
\end{table}
Table 4: _Noise after optimal filtering in low gain mode. The noises in the whole module, in 2\(\times\)2 and in 1\(\times\)2 clusters are shown._

\begin{table}
\begin{tabular}{||c||c|c|c||} \hline Group of Cells & Coherent (MeV) & Incoherent (MeV) & Total (MeV) \\ \hline Module & 1.10\(\pm\)0.02 & 2.47\(\pm\)0.06 & 2.70\(\pm\)0.07 \\ \hline
2\(\times\)2 clusters & 1.14\(\pm\)0.03 & 2.39\(\pm\)0.05 & 2.65\(\pm\)0.06 \\ \hline
1\(\times\)2 clusters & 1.50\(\pm\)0.03 & 2.26\(\pm\)0.05 & 2.72\(\pm\)0.06 \\ \hline \end{tabular}
\end{table}
Table 3: _Noise after optimal filtering in high gain mode. The noises in the whole module, in 2\(\times\)2 and in 1\(\times\)2 clusters are shown._Figure 8: _Energy deposited in one presampler cell by a 100 GeV electron beam with different amounts of material upstream of the presampler. A cut at 80 GeV is applied on the total energy in the calorimeter in order to separate electrons from pions and muons._

Figure 7: _Shower profiles in the presampler module when it is illuminated by a 20 GeV electron beam and when there are (left-hand side) 0.7 and (right-hand side) 2.7 radiation lengths of upstream material in front. The readout cell 1,0 is dead when the bipolar shapers work in high gain._

### Impact of the presampler on the energy resolution

Because of the choice of the amplification factors, data which were taken with a beam of 200 GeV electrons were largely saturating the calorimeter response, even when the bipolar shapers worked in the low gain mode. Data at 20 GeV and 50 GeV were taken in high gain only, which also led to saturation. At 100 GeV, some data were taken with the bipolar shapers working in low gain and could thus be analysed.

#### 5.3.1 Cluster of cells used to reconstruct the energy

The calorimeter cluster (in \(\eta\)\(\times\)\(\phi\) coordinates) used to reconstruct the energy deposited by 100 GeV electrons was 3\(\times\)3 cells in the two first sampling layers and 2\(\times\)3 cells in the last sampling layer, which has a coarser granularity in the \(\eta\) direction. When 2.7 radiation lengths of upstream material are placed in front of the cryostat, the shower is spread on a significantly larger zone of the calorimeter because of the early scatterings in the material upstream. In order to improve the containment of the shower, we took as many calorimeter cells as possible, that were cabled and that received an energy above the noise. These constraints lead to a 5\(\times\)4 cluster in the two first sampling layers and a 4\(\times\)4 cluster in the third sampling layer. In the presampler, one usually uses the cell where the energy deposition is maximal on average (cell 3,0 in our case). But, when the beam spot in the presampler is large, summing the energy of two cells in the \(\eta\)-direction might improve the energy resolution of the calorimeter-presampler system [9]. Therefore, the energy resolution has been computed with either one or two cells (3,0 and 4,0) in the presampler.

#### 5.3.2 Event selection and corrections

The following selection cuts and corrections were applied to the data [13]:

* to remove pions and muons, only the events showing an energy deposited in the calorimeter in the range 80-110 GeV are selected.
* only the events for which the barycenter of the shower is in the cell under study are taken into account (this cell is chosen at the position 2,3 in the calorimeter).
* phase dependent correction: a TDC-reading is a time measurement giving the phase of the pulse with respect to the sampling clock. The energy reconstructed after optimal filtering should not depend on the pulse phase. Nevertheless, if the pulse shape used for the computation of the optimal weights differs from the real pulse shape, then the optimal filtering can introduce a TDC dependence for the energy. The TDC range is divided into 100 bins and, for each of them, an average energy is associated by searching for the events having the same TDC-reading. In this way, an energy is associated with each TDC bin and a bin-to-bin correction can be applied in order to suppress the TDC dependence of the energy.
* corrections of the \(\phi\)- and \(\eta\)-dependence of the energy: the accordion shape of the calorimeter and the energy leakage outside of the cluster introduce a position dependence of the energy.

#### 5.3.3 Presampler weight

After the event selection and corrections, the energy of the presampler cluster \(E_{pres}\) is first weighted and then added to the energy of the calorimeter cluster \(E_{calo}\), so that the reconstructed energy \(E\) is \(E=E_{calo}+\alpha\times E_{pres}\), where \(\alpha\) is the _presampler weight_, a coefficient which can be optimized in order to minimize the energy resolution \(\sigma(E)/E\) (see figure 9). The optimal weight is determined by fitting the energy resolution as a function of the presampler weight \(\alpha\) with a parabola. The error on the optimal weight is derived from the errors on the parabola coefficients. One can notice that, when the amount of upstream material increases, the error on the optimal weights displayed in table 5 dicreases, which is in accordance with the deepening of the parabola in figure 9.

#### 5.3.4 Energy resolution for 100 GeV electrons

Table 5 shows the energy resolution obtained for 100 GeV electrons with 0.7, 1.7 and 2.7 radiation lengths of upstream material, without the presampler and with one or two presampler cells. The weights have been optimized as explained in section 5.3.3. From this table, it is clear that the energy resolution is deteriorated by an increase of the amount of upstream material. However, the presampler allows to compensate significantly for the energy loss in the cryostat wall and the lead plates. Figure 10 shows how the energy spectrum obtained with 100 GeV electrons and 2.7 X\({}_{0}\) of upstream material is transformed when using the presampler: here, the improvement of the energy resolution reaches 35%.

Figure 9: _Energy resolution of the presampler-calorimeter system as a function of the presampler weight \(\alpha\) for a 100 GeV electron beam, with various amounts of upstream material. The beam spread, which is equal to 0.68%, was substracted in a quadratic way. Only one presampler cell is used here._

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline Amount of upstream material & 0.7 \(X_{0}\) & 1.7 \(X_{0}\) & 2.7 \(X_{0}\) \\ \hline \hline Energy resolution & \(1.03\pm 0.02\)\% & \(1.43\pm 0.04\)\% & \(2.02\pm 0.05\)\% \\ without the presampler & & & \\ \hline \hline \multirow{2}{*}{Optimal weight} & \multicolumn{3}{c|}{1 cell in the presampler} \\  & \(14.1\pm 7.1\) & \(32.2\pm 4.0\) & \(37.0\pm 2.3\) \\ \hline Energy resolution & \(1.01\pm 0.02\)\% & \(1.10\pm 0.04\)\% & \(1.39\pm 0.03\)\% \\ with the presampler & & & \\ \hline \hline \multirow{2}{*}{Optimal weight} & \multicolumn{3}{c|}{2 cells in the presampler} \\  & \(16.9\pm 4.3\) & \(29.8\pm 3.2\) & \(31.2\pm 1.5\) \\ \hline Energy resolution & \(1.01\pm 0.02\)\% & \(1.11\pm 0.04\)\% & \(1.33\pm 0.03\)\% \\ with the presampler & & & \\ \hline \end{tabular}
\end{table}
Table 5: _Optimal presampler energy weight and energy resolution, before and after the use of the presampler, with 100 GeV electrons (the beam spread, which is equal to 0.68%, has been substracted in a quadratic way)._

Figure 10: _Energy spectra with and without the presampler correction, for 100 GeV electrons, when the amount of upstream material is 2.7 \(X_{0}\) (two presampler cells are used)._Conclusion

This note presents the main performance of the first final ATLAS barrel presampler module tested in beam. An average electronic noise of 3.5 MeV (6.3 MeV) per channel was measured in high (low) gain. When optimal filtering is applied, the noise is reduced by a factor close to 1.4 both in high and low gains, for single channels as well as for various types of clusters.

The energy resolution of the presampler-calorimeter system has been computed with a 100 GeV electron beam. It has been shown that the presampler significantly compensates for the deterioration of the energy resolution due to the dead upstream material: an improvement of about 23% (respectively 35%) on the energy resolution is achieved when the amount of upstream material is 1.7 X\({}_{0}\) (respectively 2.7 X\({}_{0}\)). The final energy resolution is 1.10\(\pm\)0.04% (respectively 1.33\(\pm\)0.03%) with 1.7 radiation lengths (respectively 2.7 radiation lengths) of dead material in front of the presampler. These results are in agreement with the ones obtained in 1996 with a previous presampler prototype [14].

## Acknowledgements

We would like to express our gratitude to D. Nicod and M. Seman for their help in the use of the analysis programs. We also would like to thank J. Collot, P. Fassnacht and B. Lund-Jensen for fruitfull discussions.

## References

* [1] ATLAS Collaboration, Liquid Argon Calorimeter Technical Design Report, CERN/LHCC/96-41 (1996), page 189.
* [2] RD3 Collaboration, _Performance of a large scale prototype of the ATLAS liquid argon calorimeter_, NIM **A364** (1995) 290.
* [3] D. Nicod, _EMTB Guide_, accessible from: [http://atlasinfo.cern.ch/Atlas/GROUPS/LIQARGON/TESTBEAMSOFT/welcome.html](http://atlasinfo.cern.ch/Atlas/GROUPS/LIQARGON/TESTBEAMSOFT/welcome.html).
* [4] W.E. Cleland and E.G. Stern, _Signal processing considerations for liquid argon ionization calorimeters in a high rate environment_, NIM **A338** (1994) 467.
* [5] I. Wingerter-Seez, _Study of energy reconstruction using optimal filtering with the LAr electromagnetic calorimeter_, ATLAS internal note LARG-019 (1995).
* [6] ATLAS Collaboration, Liquid Argon Calorimeter Technical Design Report, CERN/LHCC/96-41 (1996), chapter 10.
* [7] M. Miyajima et al., Physics Review **A9** (1974) 1438.
* [8] J.Y. Hostachy, private communications.
* [9] A. Ferrari, _A study of the ATLAS barrel presampler performance_, internal LARG note in preparation.
* [10] M. Seman, Liquid Argon meeting, CERN, 11 december 1997.
* [11] Y. Jacquier, C. de La Taille, I. Nikolic and L. Serin, _Strengths and weaknesses of digital filtering_, ATLAS internal note LARG-NO-80 (1997).
* [12] See for example Physics Review **D54** (1996) page 159.
* [13] M. Seman, _Offline analysis user's guide_, internal ATLAS documentation (1998).
* [14] C. Clement, _Performance of the ATLAS presampler prototype of June 1996_, ATLAS internal note LARG-NO-112 (1998).