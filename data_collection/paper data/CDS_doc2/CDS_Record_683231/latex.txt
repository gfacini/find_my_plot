# ATLAS Internal Note

TECH-No-015

25 May 1995

The Modified CERN POISSON Program Package and

Its Application to the ATLAS Magnetic System Simulation

Vyatcheslav I. Klyukhin and Boris I. Klochkov

Manuscript received May 25, 1995.

V. I. Klyukhin, e-mail Klyukhin@mx.ihep.su; B. I. Klochkov, e-mail Klochkov@mx.ihep.su.

###### Abstract

The CERN POISSON program package designed by R. F. Holsinger and C. Iselin is updated by us for the CERNLIB 94B and 95A releases. The modified package is used on AXP/VMS, and under UNIX on HP 9000/7xx and IBM RS 6000 for the computation of the ATLAS magnetic system. Increased possibilities of the package have allowed us to describe the solenoid magnetic field distribution inside the iron-scintillator hadronic calorimeter and to apply the package to the design of the air core toroid field monitoring system. Various graphical representations of the results realised in new version 4.03 of the package serve as a powerful tool to go step by step through different investigated options of magnetic system.

## I Introduction

The CERN POISSON package [1] consists of a set of programs designed for the solution of Poisson's or Laplace's equation in two-dimensional regions. The package is popular to solve magnetostatic problems for the systems with the geometry reducing to two-dimensional case. There are four constituents of the package: the mesh generator LATTCR, the equation solver POISCR, the plot program TRIPCR, and the force computing program FORCCR. To discretize the problem a topologically regular triangle mesh is used over all the programs and each node of this mesh is identified by two logical coordinates in the arrays of data and two physical coordinates in the \(xy\)- or \(rz\)-plane in which the geometry of magnetic system is described. To resolve magnetostatic problems a vector potential is used. The equation solver gives in each mesh node the values of \(z\)-component \(\{A_{z}\}\) or radius times azimuthal component \(\{rA_{\phi}\}\) of the vector potential in cartesian or cylindrical coordinate cases, accordingly.

### _Package Modifications_

#### I-A1 Data flow increase

The merits of the POISSON package are a possibility to use it for the rapid estimates of properties of various magnetic systems, an openness of this kind of software, and its flexibility to the modifications.

To apply the package to the ATLAS magnetic system simulation we have to fit it to such the features of the system [2] as its huge dimensions in combination with small size of its parts, large number of elements with different magnetic properties, various geometrical shapes of the system objects. Starting from the original package version 3.04 [April 1991], we have increased the supported number of the triangle mesh nodes from 40 000 to 270 000, the maximum number of regions characterized by diverse magnetic properties from 200 to 7 000, and the maximum number of the mesh nodes along a region boundary from 1 000 to 6400 [3]. All these modifications are working well on AXP/VMS and under UNIX on APOLLO, HP 9000/7xx, IBM RS 6000, and SUN machines.

#### I-A2 Graphics upgrade

Since 1991 we have computed several tens of the magnetic system options with the package. To compare the calculated field behaviours we have added to TRIPCR a possibility to represent the dependencies of various magnetic flux density components versus coordinates as the graphs, and to extract these dependencies as the tables. Managing with optional cards, we plot the magnetic flux density \(\{B\}\), the angle of its vector with respect to any coordinate axis, and the flux density components \(\{B_{x},\ B_{y}\ {\rm or}\ B_{r},\ B_{z}\}\) versus any physical coordinate \(\{x,\ y\ {\rm or}\ r,\ z\}\) for diverse constant values of another one [3]. As special cases we use an azimuth angle as physical coordinate and radial direction as an axis, and display azimuthal component of the magnetic flux density \(\{B_{\phi}\}\) as well. It is possible also to plot with TRIPCR the magnetic flux density isolines and to calculate the field integrals [4] inside the tracking volume contained in the solenoid a coil.

### _Poisson-Geant Interface_

Following the ideas expressed in [5], we have included into the package a special program POISGT which extracts the calculated field values into a ZEBRA structure map in the form of grids of the magnetic flux density values withing the plane cross sections of magnetic system. Using a symmetry conditions, an interpolation subroutine GUFLD, included into the modified POISSON package as well, allows to obtain the space components of the magnetic flux density in each space point of the system.

The program POISGT includes also such the performances of the program POISCR as the field editing and the field harmonic analysis and can run it in the postprocessor mode.

### _Auxiliary Programs_

It is impossible to prepare 'by hands' a geometrical description of such a complicated system, as the ATLAS magnetic system is. Some special preprocessor routines have been created by us for this purpose. The most advanced one is the program LATTCP [3] which is an auto-mesh generator using physical coordinates only and preparing the input data for the program LATTCR.

## II Solenoidal Field Simulation

### _General Behaviour of Solenoidal Field_

The ATLAS magnetic system [2] is based on an inner superconducting solenoid around the inner detector cavity, and large superconducting air-core toroids consisting of independent coils arranged with eight-fold symmetry outside the calorimetry. The solenoid flux return iron yoke is integrated into the scintillating tile hadronic calorimeter support structure.

#### Ii-A1 Model of solenoid magnetic system

To simulate the solenoid field distribution we use the following model of magnetic system [6] (see Figs. 1 and 2):

- the coil has an inner radius of 1.23 m, a thickness of 1.28 cm, and a length of 5.3 m. The total current used is 8.916 MA-turnes, that gives the magnetic flux density of 2 T in a centre of solenoid;

- the hadronic tile calorimeter consists of three cylindrical structures (central barrel and two extended barrels) with the inner radii of 2.25 m and the outer radii of 3.779 m, and an outward support girder presented as two 12.3 m long steel tubes combined with 10 cm thick steel plates at the edges. The inner tube has an outer radius of 3.92 m and a thickness of 14.1 cm. The outer tube has an inner radius of 4.1 m and a thickness of 10 cm. A space between the tubes is filled with a steel with a stacking factor of 0.1778;

- central barrel has a length of 5.894 m and consists of steel plates and 11 horizontal rows of the scintillator tiles. The inward row begins from the radius of 2.26 m, the outward one ends at \(r=3.779\) m. Odd rows begin and end at 2.9 cm from the barrel edges, even rows
- at 2 cm. The thickness of each tile is 0.4 cm, a steel space between the tiles along the \(z\)-axis is 1.4 cm. There are 325 tiles along each odd row and 326 tiles along even row. Radial widths of the tiles are 9.9, 2\(\times\)9.8, 3\(\times\)12.8, 3\(\times\)14.8, and 2\(\times\)18.8 cm. There is a steel space of 2 mm between the scintillator rows;

- two 2.699 m long extended barrels are 0.5 m away from both edges of central barrel. Each extended barrel includes 11 horizontal rows by 148 scintillating tiles. Odd rows begin at 2 cm from the sides closest to central barrel and end at 2.9 cm from each of edges. Even rows are shifted by 0.9 cm toward the barrel edges.

As the boundary conditions we put \(rA_{\phi}=0\) at the \(z\)-axis and on acylinder surface with \(r=5\) m and \(z=\pm 7\) m.

#### Ii-A2 Magnetic field distribution

The obtained solenoid field distribution [6] is displaied in Fig. 1, and in detail in Fig. 2. Inside the tile calorimeter the field prefers to go either vertically through the steel plates between the tiles or horizontally through the 2 mm steel space along the tile rows. The values of \(B_{z}\) inside the steel plates between the tiles are 0.1-17 mT and reach 30-150 mT in the 2 cm master plates at the neighbouring edges of central and the extended barrels. \(B_{z}\)-component rises from zero at \(z=0\) to 140-610 mT at the edges of central barrel and then falls from 320-520 mT to 17-37 mT inside the extended barrel. The field values in the girder and in the steel along the tile rows are up to 1.2 T.

Fig. 1: Solenoidal magnetic field distribution. Fifteen equidistant lines between \(rA_{\phi}\)-values of 0.1 and 1.5 \(V\cdot s/r\)=4 are displaied. The tile images are removed.

Fig. 2: Enlarged central part of the tile calorimeter. The used triangle mesh and four equidistant lines between \(rA_{\phi}\)-values of 1.45 and 1.48 \(V\cdot s/r\)=4 are shown.

The behaviour of the magnetic flux density along the inner tracker cavity is shown in Fig. 3 together with a \(z\)-dependence of the angle between the field direction and \(z\)-axis. Such a dependence presents a special interest in the regions occupied by microstrip gas counters [2] included in the ATLAS inner detector.

Basing on these calculations, a simplified analytic representation of the field inside the inner tracker volume is proposed in [7] to reduce the time spent in computations.

### _Magnetic Field Integrals_

To determine the momentum resolution of particle passing through solenoidal magnetic field one needs to know the field integral over the track length inside the tracking volume. Consider the trajectory of particle emitted at angle \(\theta\) from the nominal beam crossing point, which is taken as the origin of the coordinate system. The \(z\)-direction is defined to be along the beam axis and the transverse radius \(r\) is the orthogonal distance from the \(z\)-axis. For energetic particles the magnetic deflection is small compared to the track length, therefore the distance along the trajectory can be approximated by \(l=r/sin\theta\) and small angle approximations are valid. At \(l\) the relative angle \(\alpha\) of the track with respect to its initial direction in transverse projection is given by

\[\alpha\{l\}=\frac{0.3}{p\sin\theta}\int\limits_{0}^{\mid}B\sin\theta_{(d^{ \prime},\vec{B})}dl,\]

where \(p\) is the momentum of the particle in \(\mathrm{GeV}/c\), \(\vec{B}\) is the vector of magnetic flux density in Tesla, \(\theta_{(d^{\prime},\vec{B})}\) represents the longitudinal component of the angle between the track and field vectors, and \(d^{\prime}\)is small step (in meters) along the direction of the particle motion. Integrating this equation over \(dr=dl\sin\theta\) we derive the total transverse deflection \(x\) from \(rz\)-plane as

\[x\left(l\right)=\frac{0.3}{p\sin\theta}\int\limits_{0}^{\mid\sin\theta\ \tau/\sin\theta\mid}B\sin\theta_{(d^{\prime},\vec{B})}dl\,dr.\]

Now consider a cluster of measurements, near the end of the tracking volume, providing a momentum measurement by their impact parameter at the beam axis. In this limiting case, the relative momentum precision for a real (an inhomogeneous field case) versus ideal (a homogeneous field case) solenoid is given by \(R\), the relative values of \(x(L)\), where \(L\) is the total track length in the tracking volume. Such a length is equal to \(r_{max}/\sin\theta\) for \(\mid\mid z\mid<z_{max}\) and to \(z/\cos\theta\) for \(\mid\mid z\mid=z_{max}\), where \(r_{max}\) and \(z_{max}\) are the radius and half-length of the tracker cavity. The degradation in \(\Delta p/p\) is \(1-R\).

A more precise momentum measurement can be obtained from measuring the track sagitta, which is \(x(L)/2-x(L/2)\). For the ideal solenoid the sagitta equals \(x(L/2)=x(L)/4\). The value of \(x(L/2)\) is essentially the same for the ideal solenoid and for the vertex region of the ATLAS solenoid, in which the majority of the tracking volume is contained in a good approximation to the homogeneous field. Thus, the ratio of sagitta is given by \(2R-1\) and \(\Delta p/p\) is degraded by \(2(1-R)\).

To obtain the ratio \(R\) we plot with the modified TRIPCR the dependences of the double integrals

\[I_{2}=\int\limits_{0}^{L\sin\theta\ \tau/\sin\theta}\int\limits_{0}^{\mid\sin \theta\ \tau/\sin\theta}B\sin\theta_{(d^{\prime},\vec{B})}dl\,dr\]

versus pseudorapidity \(\eta=-\ln\tan\{\theta/2\}\) for the ideal and inhomogeneous fields. In Fig. 4 these dependences are presented together with the degradation \(1-R\), as function of \(\eta\).

In the inhomogeneous field case \(I_{2}\) is almost constant up to \(\left|\eta\right|=0.5\) (it decreases by only \(0.1\%\) when compared to the ideal solenoid); the decrease reaches \(1\%\) by \(\left|\eta\right|=0.9\), \(5\%\) at \(\left|\eta\right|=1.4\) and \(10\%\) at \(\left|\eta\right|=1.6\).

Beyond the corner of the inner tracking cavity in the \(rz\)-plane (\(\left|\eta\right|>1.88\)), the degradation \(1-R\) is approximately constant and reaches \(\sim\)24%. In this region the magnitude of the field integral is falling rapidly due to the reduced radial distance traversed. However there is a \(\sin\theta\) term to be included when considering the momentum resolution for a fixed value of \(p\). This compensates the field integral contribution to the momentum resolution at high pseudorapidities.

Figure 3: Magnetic flux density and angle of its vector with respect to the \(z\)-axis for diverse radii inside the inner tracker cavity.

### _Field Inside Scintillating Tiles_

As shown in [2], strong magnetic field effects on the light yield of the scintillator tiles used in the ATLAS hadronic calorimeter. To estimate the field values inside the tiles we use two mesh triangles _abc_ and _acd_ in the middle of each tile region (see Fig. 2). Inside the triangle (_e.g.__abc_) we consider the field as constant and determine it in the following way:

\[B_{r} =(rA_{\phi a}=rA_{\phi c})/(z_{c}-z_{a})/\overline{r},\] \[B_{z} =(rA_{\phi b}=rA_{\phi c})/(r_{b}=r_{c})/\overline{r},\] \[\overline{r} =(r_{a}+r_{b}+r_{c})/3.\]

From Fig. 5, where we plot \(B_{r}\) and \(B_{z}\) versus \(z\) in central barrel, one can see that both triangles give approximately equal results. The field in tiles in the centre of barrel is at the level of 3-4 mT and reaches the maximum values of 7 mT at the barrel edges. The field in tiles in the extended barrels rapidly decreases from 3 to 0.1-0.5 mT. Such the values of field will increase the light output of scintillating tiles by less then 1%.

## III Barrel Toroid Field Simulation

The modified POISSON package allowed us to describe the full eight coil configuration of the ATLAS barrel toroid and to investigate an influence of the coil displacements on the field behaviour inter the coils [8].

### _General Field Behaviour_

General layout of the barrel toroid system model used for the computations is shown in Fig. 6. The elements of magnetic system are as follows:

- 8 barrel coils are placed at azimuthal angles of 22.5deg, 67.5deg etc. with respect to the \(x\)-axis. The coils in cross section consist of two halfs: an inner one with positive current density and an outer one with negative current density. The centre-of-gravity of the inner half is at a radius of 5.315 m, the same of the outer half is at \(r=9.145\) m. Each coil half includes two conductor pancakes having radial thickness of 45 cm, azimuthal width of 15 cm and separated by 5 cm in azimuthal direction. Total current in each pancake is 1.52 MA-turns;

- the girder of hadronic tile calorimeter is described as two steel tubes: one with an inner radius of 3.78 m and a thickness of 14 cm and another one with an inner radius of 4.1 m and a thickness of 10 cm. A space between the tubes is filled with an iron with a stacking factor of 0.1778;

- hadronic tile calorimeter is presented as a space between two radii of 2.25 and 3.78 m filled with an iron with a stacking factor of 0.76;

As a boundary condition we put \(A_{z}=0\) at a circle with a radius of 13 m.

Fig. 6 displays the magnetic field distribution in the barrel toroid system. About 7.5% of magnetic flux going through the tile calorimeter and its girder. As shown in Fig. 7, the values of \(B_{r}\) and \(B_{\phi}\) induced in the outergirdre tube are comparable with the flux density components inside the toroid. In the inner tube and inside the tile calorimeter the magnetic flux densities are smaller.

Fig. 4: top) The double integral \(I_{2}\) vs pseudorapidity \(\eta\) for the ideal (solid line) and inhomogeneous (dashed line) cases; bottom) The field integral degradation as a function of \(\eta\).

Fig. 5: \(B_{r}\) and \(B_{z}\) calculated in the middle of inward and outward tile rows from the triangles _acd_ (solid and dotted lines) and _abc_ (dashed and dot-dashed lines).

### _Coil Displacements and Field Changes_

To investigate an influence of the coil displacements on the field behaviour we have shifted the coils at 22.5deg and 67.5deg by \(\pm\)1 cm along and perpendicularly radius, and also rotated it by \(\pm\)5.22 mrad around the middle of radial distance between the coil halfs. Comparing the field values along radii at \(\pm\)11.25deg around the coils, we have concluded that only two field sectors symmetrical around the moved coil feel the coil displacements. The influence of one coil shift to the field around the nearest coil is in limits of \(\pm\)2 mT. The field near the moved coil reflects the coil rotations and its azimuthal displacements in unique way, and the maximum effect reaches 6-11 mT. This study confirms the idea to monitor the toroid field behaviour with restricted amount of the Hall probes.

## Conclusions

The modified CERN POISSON package is powerful and well managed tool to provide a wide spectrum of estimates for different kind of magnetic systems and to represent the results in the best way.

## Acknowledgment

The authors thank Peter Jenni, Marzio Nessi of CERN, and Alexander Vorobiev of IHEP for their support and help with this work; Cornelis Daum, Christian Fabjan, Daniel Fournier, Daniel Froidevaux, Hans Hoffmann, Witold Kozanecki, Bruno Mansoulie, Christopher Onions, Alan Popleton, and Jurriaan Schmitz of the ATLAS Collaboration for lots of prolific discussions; and Jamie Shiers of CERN/CN for his great help with new package version releases.

## References

* [1] R. F. Holsinger and C. Iselin, _The CERN-POISSON program package [POISCR] user guide_. Geneva: CERN, August 1984.
* [2]_ATLAS technical proposal for a general-purpose-sp experiment at the Large Hadron Collider of CERN_, CERN/LHCC/94-43, LHCC/P.2 Geneva: CERN, December 1994.
* [3] V. I. Klyukhin, B. I. Klochkov, "A second life of the CERN POISSON program package," _CERN Computer Newsletter_, no. 217, pp. 18-19, July-September 1994.
* [4] V. I. Klyukhin, A. Poppleton, J. Schmitz, "Magnetic field integrals for the ATLAS tracking volume," IHEP preprint 93-38. Protvino, March 1993.
* [5] V. I. Klyukhin, "Interface program for POISSON and GEANT packages." In: _Proc. of the Conf. on Computing in HEP, 21-25 Sept. 1992, Annecy, France_. CERN report 92-07, Geneva, 1992, pp. 844-864.
* [6] V. I. Klioukhine, B. I. Klochkov, "General behaviour of the ATLAS solenoid magnetic field calculated with the modified CERN POISSON package," ATLAS internal note TILECAL-NO-02. August 1994, unpublished; [http://atlasinfo.cern.ch/Atlas/SUB_DETECTOR/STILE/#ifert/note22/file-022.ps.Z](http://atlasinfo.cern.ch/Atlas/SUB_DETECTOR/STILE/#ifert/note22/file-022.ps.Z) (compressed).
* [7] A. Poppleton, "P\({}_{T}\) resolution with the post Annecy tracker layout," ATLAS internal note INDET-NO-077. January 1995, unpublished; [http://atlasinfo.cern.ch/Atlas/GROUPS/NER_DETECTOR/NOTES/note77/d77_modifyd.ps](http://atlasinfo.cern.ch/Atlas/GROUPS/NER_DETECTOR/NOTES/note77/d77_modifyd.ps).
* [8] V. I. Klioukhine, B. I. Klochkov, "An influence of the barrel toroid coil displacements on the intercoil sector magnetic field behaviour," ATLAS internal note MUON-NO-077. March 1995, unpublished; [http://atlasinfo.cern.ch/Atlas/GROUPS/MUON/NOTES/note77/muon-77.ps.Z](http://atlasinfo.cern.ch/Atlas/GROUPS/MUON/NOTES/note77/muon-77.ps.Z) (compressed).

Figure 6: Toroidal magnetic field distribution. Fifteen equidistant lines between \(A_{z}\)-values of -1.1 and 3.1 \(V\cdot s/m\) are displaied.

Figure 7: \(B_{r}\) and \(B_{\phi}\) induced by the toroid coils in the tile calorimeter, its girder and produced along the circle with radius of 7.23 m.