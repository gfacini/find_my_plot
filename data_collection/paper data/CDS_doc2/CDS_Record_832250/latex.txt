**Cell Based Jet Calibration with DC1**

C. Roda\({}^{(1),(2)}\), I. Vivarelli\({}^{(1),(3)}\)

\({}^{(1)}\)_Istituto Nazionale di Fisica Nucleare, Pisa, ITALY_

\({}^{(2)}\)_Universita degli studi, Pisa, ITALY_

\({}^{(3)}\)_Scuola Normale Superiore, Pisa, ITALY_

We apply a cell weighting method already used at the combined test of 1996 on singl pions to DC1 jets. The method uses a set of corrections that depends on the energy deposits at cell level and th total energy of the reconstructed jets. We show the results obtained testing the method on simulated single pions, on real pions from the combined test beam of 2004, and, finally on jets. The linearity obtained is within \(\pm 2\%\), with a substantial improvement on the resolution.

## 1 Introduction

Accordingly to the current theory, jets are manifestations of scattered sub-nuclear partons (quark and gluons).

Because of the QCD confinement, quarks and gluons emerging from a hard scattering loose their energy by pulling out from the vacuum more partons (fragmentation) that have to rearrange themselves so that only color singlets emerge from the fundamental interaction (hadronization).

The final result is a number of collimated hadrons (mainly \(\pi^{0}\) and \(\pi^{\pm}\)) which are collected and measured by the calorimetric system.

A very schematic picture is presented in fig. 1. The parton jet produces a jet of particles, and, thus, clusters of calorimetric cells. The aim of the reconstruction process is to identify jets from the calorimetric clusters so that their kinematical properties can be related to those of the parent partons.

To reconstruct the energy of the jet, corrections have to be applied to take into account different effects that come into play, such as:

* Detector effects: A jet is mainly composed by hadrons. Since the ATLAS calorimetric system is non-compensating, the response of the calorimeters to electromagnetic and hadronic energy is different (\(e/h\neq 1\)). Moreover, the presence of dead material

Figure 1: _The parton jet fragments and hadronizes in a number of hadrons (particle jet) that are detected by the calorimeters (calorimeter jet). The reconstruction defines jets from clusters of calorimetric cells. Calibration constants have to be applied to get the parton energy._and cracks, and the use of different technologies in different pseudorapidity regions degrades the angular uniformity of the response.
* Physics effects: The energy associated to the jet from calorimetric clusters can differ from that of the parent parton because of initial and final state radiation, fluctuations in the underlying event, clustering effects (out of cone energy).

The aim of the present work is to use simulated data to develop a calibration algorithm which corrects for detector effects only. In fact, while we expect them to be precisely predicted by the simulation of the detector once tuned on the test beam results, the physics effects are strictly dependent on many different issues of the MonteCarlo (PDFs, fragmentation functions, modeling of ISR, FSR, underlying event, pile-up). The theoretical uncertainties in the evaluation of their contributions are too large to provide useful calibration constants.

Thus the strategy considered at present in the ATLAS collaboration is to use the results of the simulation to predict constants at the detector level to be used for the very early stages of the data taking. The final calibration for jets (including the distinction between light jets, \(b\)-jets, \(\tau\)-jets) can (and will) be obtained with the real data.

## 2 Compensation and Weighting Techniques

If the calorimeters are non-compensating, the energy measurement of a jet needs to be corrected for the \(e/h\) factor. One of the most used technique is to compute a set of weights to be applied to the single cell energy measurement. The method has been developed and extensively used by the H1 experiment [1]. We propose a possible implementation of a cell weighting method a la H1 for ATLAS. The method described in the following has been already used to correct for non-compensation for the combined test beam data of 1996 and 1998 ([2], [3]).

### A Weighting Algorithm for Jets

Naively, the idea is to compute a set of weights that take into account which is the expected response of a cell for a jet of a given energy and correct for fluctuations of the energy deposits. This should correct for the \(e/h\) improving both the resoution and the linearity of the the jet energy measurement.

After jet reconstruction, the reconstructed energy of the jet is defined as the sum of the measured energy in the cells belonging to the jet multiplied by a weight (\(w_{i}\)) that depends on the energy deposit itself and on the jet energy:

\[E_{J}^{Rec}=\sum_{i\in J}w_{i}(E_{J},E_{i})E_{i} \tag{1}\]

where \(E_{i}\) is the energy deposited in the cell \(i\) and \(E_{J}\) is the actual jet energy, which is not accessible. All along the next section, the true jet energy from the MonteCarlo (\(E_{MC}\), _i.e._, the energy obtained by the particle level jet) will be used. Then we will show in sec. 4.2 that the jet energy calculation can be done by an iterative procedure using only measurable quantities.

The weights are computed minimizing the resolution of the jet energy measurement with respect to that of the closest, in \(\eta\) and \(\phi\) (see 4.1), MonteCarlo jet with a constraint on the linearity. The function which is minimized is

\[\chi^{2}=\sum_{e}\frac{(E_{J,e}^{Rec}-E_{MC,e})^{2}}{E_{MC,e}^{2}} \tag{2}\]

where \(e\) is an index that runs on all the events, while the constraint is

\[\sum_{e}(E_{J,e}^{Rec}-E_{MC,e})=0 \tag{3}\]

### The Technical Implementation

Since the number of cells of the ATLAS calorimetry is huge, and since the statistics available is limited, the number of parameters \(w_{i}\) has to be reduced. To achieve this, the

Figure 2: _The geometry of the ATLAS calorimetric system. The plane of the view is parallel to the beam axis._

same weight is assigned to cells that are within the same longitudinal calorimeter sample. Within each sample the weights of the cells depend (roughly) on the pseudorapidity of the jet to which they belong. Five eta bins have been chosen following roughly the structure of the calorimeters, as shown in fig. 2 and tab. 1. The weights of the presampler and the first sample of the EM calorimeter are set to 1 because mostly EM deposits are expected in those longitudinal samples.

In order to simplify the extraction of the weights, the distribution of the energy deposit in each cell \(E_{i}\) is subdivided in 17 different bins. The bin ranges are chosen so that each bin is almost equally populated when considering the cell deposits observed for by the QCD di-jet events. The lower limits for the cell energy bins are

\[E_{bin}[17]=\{0;200;400;600;900;\] \[1.2\cdot 10^{3};1.7\cdot 10^{3};2.5\cdot 10^{3};3.5\cdot 10^{3};\] \[4.9\cdot 10^{3};6.8\cdot 10^{3};10^{4};1.38\cdot 10^{4};\] \[2\cdot 10^{4};3.2\cdot 10^{4};6\cdot 10^{4};\] \[20\cdot 10^{4}\} \tag{4}\]

where all the energies are expressed in MeV and the last bin involve all cell deposits with \(E_{i}>200\) GeV. We can thus reexpress the total reconstructed energy (eq. 1) as:

\[E_{J}^{Rec}=\sum_{i\in J}w_{k}(E_{J},E_{i})E_{i}=\sum_{k}\sum_{j=1}^{17}w^{ \prime}_{kj}(E_{J})E_{kj}^{sum} \tag{5}\]

where \(k\) is running on the calorimetric samples, \(j\) is the bin index, \(w^{\prime}_{kj}\) is the weight of the energy bin \(j\) in the sample \(k\), and \(E_{kj}^{sum}\) is the sum of all the cells belonging to the calorimetric sample \(k\) that are in the energy bin \(j\).

Equation 2 can thus be rewritten as

\[\chi^{2}=\sum_{e}\frac{(\sum_{k}\sum_{j}w_{kj}(E_{J,e})E_{kj,e}^{sum}-E_{MC,e} )^{2}}{E_{MC,e}^{2}} \tag{6}\]

\begin{table}
\begin{tabular}{c|c} \hline \hline Pseudorapidity region & Weighted sample \\ \hline \hline \(|\eta|<0.7\) & EMB2+EMB3,Tile1,Tile2,Tile3 \\ \hline \(0.7<|\eta|<1.5\) & EMB2+EMB3,Tile1,Tile2,Tile3,EME2+EME3 \\ \hline \(1.5<|\eta|<2.5\) & EME2+EME3,HEC1+HEC2+HEC3+HEC4, \\  & EMB2+EMB3+Tile1+Tile2+Tile3 \\ \hline \(2.5<|\eta|<3.2\) & EME2+EME3,HEC1+HEC2+HEC3+HEC4, \\  & FCAL1+FCAL2+FCAL3 \\ \hline \(3.2<|\eta|<5\) & EME2+EME3+HEC1+HEC2+HEC3+HEC4, \\  & FCAL1,FCAL2+FCAL3 \\ \hline \hline \end{tabular}
\end{table}
Table 1: _Calorimeter samples that has been weighted as a function of the pseudorapidity of the jets. The symbol “+” means that the samples have been associated in one sample._(we suppressed the prime for \(w_{kj}^{\prime}\)).

Since the number of weights is still large (in the central barrel we have 6 longitudinal samples, thus assigning one set of weights at each sample we have a total of \(17\cdot 6=104\) weights for each jet energy), in order to simplify the weights assignment, a parametrization is introduced. The choice of the parametrization is somewhat arbitrary. We adopted the following one:

\[w_{kj}(E_{J})=A_{k}(E_{J})+\frac{B_{k}(E_{J})}{<E_{j}>} \tag{7}\]

where \(<E_{j}>\) is the central energy value of bin \(j\).

This function describes reasonably well the weight dependence on the cell energy using only two independent parameters for each sample. This has been verified using a sample of MonteCarlo QCD di-jet events obtained with the G3 simulation of the detector. Only the barrel calorimeter region and monoenergetic jets of \(E=50\) GeV have been considered. First the minimization has been done leaving free the 17 weights \(w_{j}^{LAr}\) of the LAr calorimeter (no longitudinal segmentation considered) and those of the Tile Calorimeter \(w_{j}^{Tile}\), for a total number of 34 weights. Then, the fit has been repeated considered only 4 parameters (\(A^{LAr},B^{LAr},A^{Tile},B^{Tile}\)) and imposing eq. 7. The results obtained for the final jet energies are the same within \(\pm 0.2\)-\(0.3\%\).

The dependence of the parameters \(A(E_{J})\) and \(B(E_{J})\) of eq. 7 on the total jet energy \(E_{J}\) has to be determined from the MonteCarlo. Thus, the fit of the parameters will at first be done for jets of the same MC energy, obtaining the values of the weights for a number of energy points. Then, the points will be fitted to determine a parametrization for the functions \(A(E_{J})\) and \(B(E_{J})\).

Figure 3: _The number of reconstructed jets for a sample of fully simulated 50 GeV single pions._

## 3 Results on Single Pions

Both the cone jet reconstruction algorithm and the calibration procedure has been checked in two different contexts. First, the whole machinery has been used to find the calibration constants for single pions using the full G4 simulation of the ATLAS detector. Then, the calibration procedure has been checked also with the 2004 combined testbeam data.

### Results on Fully Simulated Single Pions

Four samples of single charged pions of different energies (20, 50, 100, and 200 GeV) have been generated (uniform distribution in pseudorapidity with a cut \(E_{T}<1\) GeV) and simulated using the full G4 simulation [4] of the detector. MC data have been simulated without electronic noise and pileup. The pions have been reconstructed using the standard seeded jet cone algorithm of the ATLAS reconstruction (\(\Delta R=0.7\), \(E_{T}^{seed}=2\) GeV). Figure 3 shows the number of reconstructed jets per event for the 50 GeV sample. The 12% inefficiency shown is due to the cracks in the calorimetry between the Tile barrel and extended barrel and the HEC and Forward. Moreover, at large pseudorapidity the transverse energy for 50 GeV pions is comparable to the seed threshold, thus the algorithm behaviour is unpredictable.

The comparison of the pseudorapidity distributions obtained for the reconstructed and simulated pions are shown in fig. 4 (on the left), the two distributions show a good agreement. To confirm that the pion direction is well reconstructed, the distance in \(\Delta R\) of the jet from the MC pion is shown in the right plot of fig. 4. As can be seen, the reconstructed jet is always spatially very close to the generated pion.

The calibration algorithm has been tested in all the five pseudorapidity regions considered in tab. 1. The reference energy considered is that of the MC pion (\(E_{\pi}\)). At this stage, the parameters \(A_{i}\) and \(B_{i}\) of eq. 7 are considered dependent on the generated

Figure 4: _On the left: pseudorapidity distribution for the reconstructed and the MC pions. On the right: \(\Delta R\) distance between the reconstructed and the MC pion. Both the plots have been obtained using single charged pions simulated with the full G4 simulation of the ATLAS detector._and no iterative procedure is applied to use only measurable quantities. The \(\chi^{2}\) of eq. 2 is then minimized with the constraint 3 for each \(\eta\) region and for each available energy, obtaining the complete set of parameters \(A_{i}\) and \(B_{i}\). As an example, the dependence of the parameters on the MC energy for the EME2+EME3 sample is shown in fig. 5. We make the following remarks:

* The energies considered are higher than the typical pion energies inside a jet. In fact, a jet typically contains 20 particles. This number has a little dependence on the jet energy. This implies that, for example, a large fraction of the energy of a 100 GeV jet is carried by \(<10\) GeV pions.
* Qualitatively, the general behavior is that the \(A\) parameter increases with the energy, saturating to about one, while the \(B\) parameter decreases. Since \(B\) in eq. 7 takes into account the cell energy, its decrease is a consequence of the fact that the correction for \(e/h\) is less important at high energies.

Once the weights have been determined, they can be used to check if the corrections work properly. The results in the central region of the detector are shown in fig. 6, where the histogram of \(E_{J}^{rec}/E_{\pi}\) is shown. The comparison between the black (pions calibrated to the EM scale, _i.e._, \(w_{ij}=1\)) and the red (calibrated pions) curve shows that the linearity of the measurement is restored, while the ratio between the RMS and the mean value is improved. The distributions are not expected to be gaussians (long tails), thus they are first fitted with a gaussian (regardless of the \(\chi^{2}\) of the fit), obtaining a first estimate of the mean value \(\mu^{*}\) and a sigma \(\sigma^{*}\), then they are fitted again in the core (\((\mu^{*}-2\sigma^{*},\mu^{*}+2\sigma^{*})\)), obtaining values for \(\mu\) and \(\sigma\).

The dependence of the mean value (linearity) and of the \(\sigma/\mu\) (resolution) of the gaussian on the energy is summarized in fig. 7 and 8 respectively for some of the five \(\eta\) regions. Since the electronic noise is not included in the simulation, the po

Figure 5: _Dependence of the \(A\) and \(B\) parameters of eq. 7 on the energy (in GeV) for the EME2+EME3 sample (pions with \(0.7<|\eta|<1.5\))._

fitted with the quadratic sum of a stochastic and a constant term. It should be point out that while the restoration of linearity is expected, since each energy point is fitted seprately and the true energy is used, the improvement obtaine in the energy resolution is significant.

\[\frac{\sigma(E)}{E}=\frac{a}{\sqrt{E}}\oplus b \tag{8}\]

The points for 20 GeV pions have not been considered in the forward and backward regions of the calorimeters, since they produce very low \(E_{T}\) jets. The values obtained have of course to be considered as mean values in the pseudorapidity region under study. The results obtained for the resolutions are summarized in tab. 2 and compared, where possible, with the ATLAS TDR and previous test beam results. In spite of several differences between the present setup and the previous ones (the 1996 combined test beam results, for example, were obtained with prototype modules both for the Tile and the LAr calorimeters) the agreement is quite good. In particular, the comparison of the present results with those of the TDR (which refers to single particle in the ATLAS detector)

Figure 6: _The \(E_{J}^{rec}/E_{\pi}\) for pions with \(|\eta|<0.7\) is shown before (black curve) and after (red curve) the calibration discussed in the text for \(E_{\pi}=20\) (top–left), 50 (top–right), 100 (bottom–left), 200 (bottom–right) GeV. The linearity of the energy measurement is restored and the \(\sigma(E)/E\) ratio decreases._

shows the possible improvement on the stochastic term with respect to a benchmark approach [5] used in the past. This is confirmed by the consistency with the 1996 Combined Test Beam (CTB) results, obtained with the weighting techniques as well. The differences in the constant term are mostly due to a larger amount of material in front of the calorimeters in the present setup than in the CTB 1996 and TDR (the present simulation of the ATLAS detector takes into account modifications in the experiment setup that have happened after the release of the TDR).

\begin{table}
\begin{tabular}{c|c|c|c|c|c|c} \hline \hline \(\eta\) region & Results & \multicolumn{2}{c|}{CTB 1996} & \multicolumn{2}{c}{TDR} \\  & & \multicolumn{2}{c|}{(\(\eta=0.35\))} & \multicolumn{2}{c}{(\(\eta=0.3\))} \\  & & \multicolumn{2}{c|}{} & \multicolumn{2}{c}{Benchmark approach} \\ \cline{2-7}  & a & b & a & b & a & b \\ \hline \hline \(|\eta|<0.7\) & 45.2\% & 4.5\% & 45.2\% & 1.29\% & 53\% & 3.0\% \\ \(0.7<|\eta|<1.5\) & 49.8\% & 4.3\% & & & & \\ \(1.5<|\eta|<2.5\) & 50.2\% & 3.9\% & & & & \\ \(2.5<|\eta|<3.2\) & 77.8\% & 2.6\% & & & & \\ \(3.2<|\eta|<5\) & 45.2\% & 2.6\% & & & & \\ \hline \hline \end{tabular}
\end{table}
Table 2: _Results on the resolution for pions in 5 pseudorapidity regions. For comparison, also the 1996 Combined Test Beam (CTB) and the Technical Design Report results are shown._

Figure 7: _Linearity plots for pions in the \(|\eta|<0.7\) (left) and \(2.5<|\eta|<3.2\) (right) pseudorapidity regions. The ratio \(E_{J}^{Rec}/E_{\pi}\) is shown as a function of the pion energy._

Finally, the linearity of the energy measurement for single pions (all the four energies considered have been included) is shown as a function of the pseudorapidity (fig. 9). The overall linearity is well within \(\pm 2\%\), with the exception of the very forward region, where

Figure 8: _Resolution plots for pions in the \(|\eta|<0.7\) (left) and \(2.5<|\eta|<3.2\) (right) pseudorapidity regions._

Figure 9: _The profile histogram of the ratio \(E_{J}^{Rec}/E_{\pi}\) is shown as a function of the pseudorapidity. The calorimeter gaps around \(\eta=1.5\) and \(\eta=3.2\) are well visible for the non–calibrated pions. The calibration procedure provides a good linearity (within \(\pm 2\%\)) with the exception of the gap and the very forward regions._

the lateral leakage of the shower has a strong effect, and the gap regions around \(\eta=1.5\) (the end of the TileCal) and \(\eta=3.2\) (crack between the HEC and the FCAL calorimeters). However, the correction algorithm reduces the non linearity from 20% to 5% also in these critical regions.

### Preliminary Results from the Combined Test Beam 2004

Between May and November 2004, the ATLAS collaboration has collected data at a combined test beam of the detector, using the SPS H8 beam line at CERN. A full slice of the central ATLAS detector from the inner detector to the muon chambers has been put on the beam.

The aim of this section is neither to validate the calibration algorithm with the data nor to estimate the final performances of the ATLAS calorimetry. In the first case, in fact, a correct approach would require to obtain the calibration weights on the G4 simulation of the Combined Test Beam setup and then apply them to real data. However, the description of the CTB geometry has just been inserted in the G4 simulation and the program is still under test. In the second case, the preliminary reconstruction algorithms used to evaluate the signal in the LAr calorimeter is not adequate at low energies. The final signal reconstruction in the LAr channels will be done using an Optimal Filtering (OF). At the time of this analysis the final OF coefficients were not available. The energy in each channel is therefore calculated using a cubic interpolation of the first five samples of the LAr signal. This leads to a degradation of the resolution for low signals [6]. Since pions release a relatively small signal in a large number of cells, the final resolution will be not the optimal one.

Therefore, the topics discussed in this section should be taken as an additional test of the calibration algorithm on real data. The "final" results reported here has to be taken as preliminary as there is room for further improvements.

#### 3.2.1 The Test Beam Setup

Fig. 10 shows a sketch of the setup of the ATLAS detector on the H8 beam line.

A box containing 2 layers of the pixels and 2 modules of the SCT detector is placed inside the "Morpurgo Magnet" in order to verify the performances of the tracker also in presence of magnetic field. Just outside the magnet, one sector of the Transition Radiation Tracker is placed perpendicular to the impinging beam. One complete barrel module of the Liquid Argon calorimeter is placed inside a cryostat (specific for the test beam) whose shape and size differ from the one that will be used in ATLAS. In particular, the amount of dead material present between the LAr and the Tile Calorimeter is larger than the one that will be present in ATLAS. Three barrel modules of the Tile Calorimeter are placed just outside the LAr cryostat. Not in the picture, between the LAr cryostat and the Tile Calorimeter there is a plastic scintillator that can be used to select pions showering only in TileCal. The calorimeter modules are on a moveable table that allows their rotation and traslation, to simulate particles that impinge at different pseudorapidities. Behind the calorimeter there is a full section of the muon spectrometer, including both barrel and extended barrel chambers of MDT, RPC, TGC, together with a magnet (in brown in the picture) that allows for momentum measurement in the spectrometer. A scintillator placed downstream the Tile Calorimeter (\(MuTag\) in the following analysis) can be used also to reject muons while selecting pions or electrons.

Upstream of the beam, before the pixel detector, there is a set of beam detectors that can be used to select the beam direction, the particle type and provide the trigger signal (the use of the standard LVL1 ATLAS trigger was foreseen only for the very last data taking periods). The presence of five wire chambers allows to reject particles away from the beam axis, the two Cherenkov counters allow \(e/\pi\) separation for energies below 20 GeV, while three plastic scintillators (\(S1,S2,S3\) in the following) are used in coincidence and can be used as particle trigger.

The runs that have ben selected for the present analysis have been acquired at the end of August. During that period the data taking was done with the calorimeters standalone and the trigger was provided by the coincidence of the S1 and S3 scintillators

#### 3.2.2 Pion Selection

The performances of the calibration algorithm had been checked with particles impinging on the calorimeters at \(\eta=0.35\). Seven energy points (20, 50, 150, 180, 250, 320, 350 GeV) have been considered. The contamination of \(\mu\) and \(e\) in a pion beam depends on the energy beam. For the first two energies, almost 1/3 of the particles are pions, while at 150 and 180 (tertiary beams were used) there's a strong (\(\simeq 85\%\)) contamination of muons. The beams used for the high energy runs were secondary beams of pions, therefore very pure.

The analysis proceeds as follows: the beam chambers select particles within 1 cm from the beam axis, then a section of the calorimeter which corresponds to a region \(\eta\times\phi=0.5\times 0.3\) has been considered to determine the pion energy. The \(\phi\) size of this region is limited by the number of the tile calorimeter modules installed on the beam.

Figure 10: _The setup of the detectors along the H8 beam line._

The baseline of the pedestal is automatically subtracted by the offline reconstruction algorithms, while the spread of the cells of each sample of the LAr and Tile calorimeter has been computed using fake triggers between the particle spills. Cells within \(3\sigma_{noise}\) from 0 have been removed from the energy calculation. Figure 11 (left plot) shows the total energy in the region considered for a nominal 50 GeV pion beam. The first peak on the left corresponds to the residual of pedestal events. The second peak around 3 GeV corresponds to the muon signal. The wide peak around 34 GeV is due to pions. The bump at 48 GeV is produced by electrons (the 2 GeV offset in the electron scale is caused both by the preliminary LAr calibration and by the \(3\sigma_{noise}\) cut on the cells, which is not optimized for electrons).

The plot on the right of fig. 11 shows (for the same beam energy) the correlation between the energy deposit in LAr and that in TileCal. Muons are clearly separated from the pedestal visible thanks to the very good muon to Pedestal signal ratio in the TileCal. Most of the pions have the first interaction inside the LAr calorimeter (about 2/3, consistent with the fact that the LAr is about one interaction lenght at \(\eta=0.35\)), but pions interacting in TileCal alone are also clearly visible. It has been shown [7] that the TileCal standalone performances (_i.e._, linearity and resolution of pions that start to shower in TileCal) at the CTB 2004 are in agreement with what was found during the 2001,2002,2003 testbeam.

To remove the muons from the beam, all the events not compatible with pedestal events in the \(MuTag\) have been rejected. Moreover, events with a signal compatible with a Minimum Ionizing Particle (MIP) in the three samples of the Tile calorimeter have been rejected as well.

The electron rejection has been done considering the first and the second samples of the LAr calorimeter. Since the first sample is \(6X_{0}\) long while the second is \(16X_{0}\), where \(X_{0}\) is the radiation lenght, almost all the electron energy is released in the first two LAr samples. Moreover, for electrons the energy in the first and second sample of the LAr

Figure 11: _On the left: total energy deposited in the calorimeters for a nominal 50 GeV pions beam. On the right: correlation between the energy deposited in the LAr and the Tile calorimeters for the same beam._

should be anticorrelated. Figure. 12 (on the left) shows the energy in the EMB1 against the energy deposits in EMB2 for a 50 GeV beam. To exploit better this correlation, we rotate the axis so that the \(x^{\prime}\) axis is perpendicular to the anticorrelation band of the electron and we project the histogram onto the \(x^{\prime}\) axis. Thus, a new parameter is defined as:

\[\psi=E_{EM2}\cos\theta+E_{EM1}\sin\theta \tag{9}\]

where \(E_{EM1}\) (\(E_{EM2}\)) is the energy measure in the first (second) EM sample, while \(\theta\) is the angle between the \(x^{\prime}\) and \(x\) axis. The histogram of \(\psi\) is shown on the right of fig. 12. It has been fitted with the sum of two gaussians. To remove \(\simeq 95\%\) of the electrons, particles yielding a signal with \(\psi\) values greater than \(\mu_{e}-2\sigma_{e}\) (the mean value and the \(\sigma\) of the electron gaussian) have been rejected.

Finally, the request of a signal within \(3.5\sigma_{noise}\) in the LAr PreSampler (PS) has been applied to reject particles interacting before the calorimeters.

To summarize:

* off-axis impinging beam particles have been removed using the beam chambers.
* muons have been rejected requiring a pedestal signal in the \(MuTag\) or a MIP in the three longitudinal samples of TileCal.
* electrons have been removed with an energy dependent cut on the correlation between the energy deposit in the EMB1 and EMB2.

The particles that survive this selection are then used to calculate the calibration weights for the test beam data as described in the previous sections.

Figure 12: _On the left: correlation between the energy deposited in the first and second sample of the EM calorimeter for the 50 GeV beam. On the right: histogram of the value of \(\psi\) (as it has been defined in the text) for the same events._

#### 3.2.3 Results

The weights have been computed as described in sec. 2 for each energy point (the parametrization of the weights as a function of the particle energy has been done only for jets as described in sec. 4.1). The results cannot be compared directly with those obtained with the G4 simulation of ATLAS because of the different setup. In any case it has to be noticed that the weights of the LAr compartments are sistematically lower while those of the Tile are higher (tab. 3), indicating (as well known [8]) that the present tuning of the G4 simulation predicts showers that are narrower and longer than the data.

The distributions of \(E_{J}^{rec}/E_{\pi}\) are shown in fig. 13 for four different energies of the beam. The use of the calibration corrects for the linearity of the measurement and improves the resolution. The summary of the mean values \(\mu\) and of the \(\sigma(E)/E\) obtained as described in sec. 3.1 can be found in fig. 14. The overall linearity that can be achieved is within 1% while the final resolution curve has been fitted with

\[\frac{\sigma(E)}{E}=\frac{a}{\sqrt{E}}\oplus b\oplus\frac{c}{E} \tag{10}\]

Figure 13: _Distribution of \(E_{J}^{rec}/E_{\pi}\) for 20 (top left), 50 (top right), 150 (bottom left), 250 (bottom right) GeV pions._where the term \(c/E\) has been included to take into accont the presence of noise. The results for the parameters are

\[a=(53\pm 10)\%\] \[b=(5.3\pm 0.4)\%\] \[c=(2.5\pm 0.4)\ \mathrm{GeV} \tag{11}\]

where the large errors are due to the poor statistics available.

As discussed in the beginning of the present section, even if the results are not so different (within the errors) from previous results, they only show, at present, that the algorithm can be effective to correct for the linearity and improve the resolution of the hadron energy measurement. The final calibration constants for the LAr calorimeter should improve the energy measurement in the LAr, and thus allow for the evaluation of

Figure 14: _Linearity (on the left) and resolution (on the right) as a function of the beam energy for real pions at the ATLAS Combined Test Beam 2004._

\begin{table}
\begin{tabular}{c||c|c|c|c} \hline \hline Parameter & EMB2 & Tile1 & Tile2 & Tile3 \\ \hline \hline \(A_{G4}\) & \(0.92\pm 0.01\) & \(0.97\pm 0.01\) & \(0.93\pm 0.01\) & \(1.18\pm 0.04\) \\ \(B_{G4}\) & \(0.050\pm 0.003\) & \(0.90\pm 0.03\) & \(0.57\pm 0.04\) & \(0.65\pm 0.06\) \\ \(A_{TB}\) & \(0.84\pm 0.01\) & \(1.07\pm 0.01\) & \(1.07\pm 0.01\) & \(1.33\pm 0.05\) \\ \(B_{TB}\) & \(0.070\pm 0.005\) & \(1.09\pm 0.04\) & \(0.58\pm 0.05\) & \(0.58\pm 0.06\) \\ \hline \hline \end{tabular}
\end{table}
Table 3: _Comparison between the \(A\) and \(B\) parameters of the ATLAS G4 simulation and of the CTB 2004 for 50 GeV pions. Since the \(B\) term is almost equal in the four samples, the comparison can be done on the \(A\) parameter. The G4 parameter is sistematically lower in the TileCal and higher in the LAr, indicating that (as expected [8]), the G4 hadronic shower is longer than in the data._the final performances of the calorimetry. Moreover, the use of the weights calculated in each energy point instead of their parametrization leads to an overestimation of the algorithm potential with respect to both resolution and linearity.

In any case, the substantial improvement of the measurement also on real data proves that the method is working and therefore can provide better performances also for jets at the early stage of the data taking, provided an optimal tuning of the MonteCarlo used for the weights calculation.

## 4 Results on Jets

The calibration of jets is performed using a sample of QCD di-jet events. In the past (at the time of the TDR) a "di-jet" gun was used to estimate the jet resolution and linearity all over the detector. The generated jets differ substantially from full QCD events, because of the complexity of the event (jet multiplicity, low energy clusters due to radiation of soft gluons, the presence of underlying events). Therefore, the use of a di-jet gun can lead to optimistic results [9].

In this analysis we use full G3 simulated QCD events, generated by Pythia 6.203 (msel=1), with initial and final state radiation turned on. The model for the description of the underlying event describes (at best) the low \(P_{T}\) interaction [10]. The only free parameter of the model (\(P_{T}\) cut off) is tuned to reproduce the CDF minimum bias data [11]. Eventually, the final weights will be calculated using the G4 MonteCarlo tuned on the testbeam data.

For sake of simplicity, at first the electronic noise will be excluded from the simulation, and only jets in the central region of the detector will be considered, in order to understand the main issues related to the weights determination. Then the noise will be added, and the study will be done in the whole pseudorapidity range.

### The Results without Noise

The calibration constants that we want to extract should take into account only detector issues of the jet energy measurement. As already discussed, the final jet calibrations will depend on the jet type (gluon, \(b\), \(\tau\), light jet), on the jet multiplicity in the event etc. Therefore they are, eventually, analysis dependent, and they must be extracted by the data themselves.

The definition of the MC reference for our purposes should therefore satisfy the requirement of being as much as possible independent of the particular physics process used for the calibration. One should in particular avoid any choice made at parton level, since the resulting weights would be strictly dependent on the description of ISR, FSR, underlying event.

We take as reference the MC jets that are obtained running the same reconstruction algorithm used for the calorimetric towers on the MC (Kine) particles. This would decouple the physics issues from the detector effects. Reconstructed jets are instead defined as the jets obtained running the reconstruction algorithm on the calorimeter towers.

Once the reconstruction is done, two sets of jets (one from the calorimetric towers, the other from the MC particles) are obtained. In order to uniquely associate a reconstructed jet to a MC jet, a match between MC and reconstructed jets is performed. For the \(i\)-th MC jet, the distance

\[\Delta R_{ij}=\sqrt{(\eta_{i}^{MC}-\eta_{j}^{Rec})^{2}+(\phi_{i}^{MC}-\phi_{j}^{ Rec})^{2}} \tag{12}\]

with the \(j\)-th reconstructed jet is calculated. The \(\Delta R\) between each MC jet and the closest reconstructed jet is shown on fig. 15 on the left. A cut at \(\Delta R=0.4\) defines the matching between the two. The corresponding efficiency as a function of the pseudorapidity is shown on the right plot of fig. 15.

The extraction of the weights for the central barrel region (\(|\eta|<0.7\)) has been done minimizing eq. 2 with the constraint of eq. 3. The minimization has been performed separately for 14 energy points, from a minimum MC jet energy of 25 GeV up to a maximum energy of \(\simeq 3\) TeV.

The results obtained for the parameters \(A\) and \(B\) of eq. 7 in the EMB2+3 and Tile2 samples are shown as a function of \(E_{MC}\) in fig. 16. The general behavior is similar to that discussed in sec. 3.1: while the \(A\) parameter increases with the jet energy up to a saturation value, the \(B\) parameter decreases as \(E_{MC}\) increases.

The parametrization used for \(A(E_{MC})\) and \(B(E_{MC})\) is:

\[A=A_{0}+\frac{A_{1}}{E_{MC}} \mbox{if }E_{MC}<500\mbox{ GeV}\] \[A=const \mbox{if }E_{MC}>500\mbox{ GeV} \tag{13}\] \[B=B_{0}+\frac{B_{1}}{E_{MC}}\]

which is a good (and simple) parametrization for all the samples. The presence of \(E_{MC}\) in

Figure 15: _On the left: \(\Delta R\) distance between the MC jet and the closest reconstructed jet. On the right: reconstruction efficiency of the cone algorithm for two different energies of the jet as a function of \(\eta\) once a cut at \(\Delta R=0.4\) is applied._

the parametrization has to be avoided (as already discussed). This issue will be addressed in the next section.

Because of the lack of statistics, the final linearity and resolution that can be obtained are evaluated on the same sample used for the weights determination. The correct variable to evaluate the linearity and resolution is the transverse energy, because it is Lorentz invariant. Fig. 17 (on the left) shows that the linearity that can be achieved is around 1% in the full \(E_{T}\) range. The resolution plot is shown on the right plot of fig. 17. The points are well fitted with

\[\frac{\sigma(E)}{E}=\frac{a}{\sqrt{E}}\oplus b \tag{14}\]

The errors are evaluated taking into account both the statistic uncertainty of \(E_{Rec}/E_{MC}\) (for the linearity) and \(\sigma(E)/E\), and the uncertainty on all the parameters \(A_{0}\),\(A_{1}\),\(B_{0}\),\(B_{1}\) due to the weight determination from the fit. As it can be seen, the stochastic term decrease from 79% (at the EM scale) to 63% (for calibrated jets). Moreover the constant term decreases (3% at the EM scale, 1.8% for calibrated jets), indicating that the corrections are effective against the non-compensation of the calorimeters.

### The Results with Electronic Noise

Once the electronic noise is added to the simulation, it can happen (especially for low \(E_{T}\) jets) that the energy deposit in the cell has (non negligible) negative values. This is because the baseline of the pedestal is already subtracted by the standard reconstruction. Therefore, the pedestal distribution is a gaussian with mean value 0. Negative fluctuations of the electronic noise can thus occur.

This is true especially for the LAr compartments, where the \(\sigma_{noise}\) in a single cell is some tens of MeV, and strictly dependent on the calorimeter sample considered, _i.e._, on

Figure 16: _Dependence of the parameters \(A\) and \(B\) of eq. 7 for the EMB2+3 (on the left) and Tile2 (on the right) samples on the MC jet energy._

the cell dimensions. The noise in the Tile calorimeter is less important, since \(\sigma_{noise}\) is about 25 MeV per cell. Moreover, since the \(\eta\times\phi\) dimension of one tile cell is \(0.1\times 0.1\) (in the first and second sample) while that of the LAr calorimeter cells is \(0.025\times 0.025\), the noise level of 1 tile cell should be compared with that of 16 LAr cells, resulting in few hundreds MeV.

Negative values for the cell energies lead to weights quite different from those obtained in the no noise case, as shown in fig. 18 (left plot). The black points refer to a fit of the \(a\) parameter of eq. 7 in the EMB2 sample obtained for events with electronic noise and without any cut on the noise. The behavior of the parameter is very different from the no noise case (red line). In the plot, the results obtained for the same parameter with an asymmetric cut at 120 MeV (\(E_{cell}>120\) MeV, which roughly corresponds to a \(2\sigma_{noise}\) cut) in the LAr cells and at 50 MeV in the Tile cells are also reported. As can be seen, the results are much closer to those obtained without noise, indicating that the asymmetric cut on the cell energies could be a viable solution.

However, the application of the energy cut in the cell produces a bias of the energy measurement of low \(E_{T}\) jets. This is illustrated in fig. 18 (right plot), where the mean value \(\mu\) and the resolution \(\sigma(E)/E\) of the \(E/E_{MC}\) distribution for \(E_{MC}=25\) GeV are reported as a function of the cut value in \(\sigma_{noise}\) units. The scale on the left refers to \(\mu\) while the one on the right refers to \(\sigma(E)/E\). As shown on the plot, if one simply neglects cells with negative energy (_i.e._, 0 \(\sigma_{noise}\) cut), the measured energy is about 150 GeV. This can be understood as follows: in a \(\Delta R=0.7\) jet in the central calorimeter region there are \(\simeq 4000\) cells from LAr. The noise of each of them contribute with \(\simeq 40\) MeV to the total energy. Thus, this extremely rough estimation gives a 160 GeV contribution from the noise, which is not so far from the obtained value.

The right plot of fig. 18 also shows the results obtained wi

Figure 17: _Linearity and resolution plot for jets in the central region (\(|\eta|<0.7\)) of the calorimeters before (EM scale) and after the calibration procedure (calibrated). The results refer to a sample simulated without electronic noise._

line). A \(3\sigma_{noise}\) cut reproduces the measurements obtained without noise. Therefore a \(3\sigma_{noise}\) cut has been chosen to get rid of the noise.

The presence of the cracks between the calorimeters affects the uniformity of the jet response. There are six gaps in the ATLAS calorimetry, the first one around \(\eta=1\) between the barrel and the extended barrel of the Tile, the second one around \(\eta=1.5\) between the Tile and the HEC, the third (and most important) one between the HEC and Forward calorimeters. While the algorithm should correct for the third one because of the segmentation chosen for the weights calculation (two different \(\eta\) bins crossing the crack region), the first one can be corrected with the use of the Tile Gap scintillators. At present, the staging of this part of the Tile Calorimeter at the beginning of the data taking is under discussion. Nevertheless we consider the possibility of using it, in order to evaluate the performances of the final calorimetry. It was found that a factor 3, independent of the jet energy, can be used to multiply the energy deposits in the Tile Gap to improve the uniformity of the jet response.

The weights have been determined as described in sec. 4.1. The dependence of the parameters \(A\) and \(B\) of eq. 7 on the jet energy is well described by the same functional dependence described in sec. 4.1. Fig. 19 shows the weights applied as a function of the cell energy for two different jet energies: 75 GeV (blue curve) and 280 GeV (red curve). On the left the EM sample of the central calorimeter is shown, while the Tile2 sample is shown on the right. For both jet energies, the frequency multiplied by the value of the

Figure 18: _On the left: comparison between the parameter \(a\) of the EMB2 sample obtained without any cut on the noise (black points) and with \(a\simeq 2\sigma_{noise}\) cut on the cell energy deposits on a sample of jets of \(E_{MC}=25~{}GeV\). The result obtained with data simulated without noise is also reported (red line). On the right for the same data sample: the mean value \(\mu\) (scale on the left) and the \(\sigma/\mu\) (scale on the right) of the \(E/E_{MC}\) distribution as a function of the noise cut (in \(\sigma_{noise}\) units)._

cell energy bin is also shown. It can be seen that for a 75 GeV jet the weights enhance the response of the low energy cells while they suppress the response of the cells that over-fluctuated. The energy deposits in the bins are much more uniform for a 280 GeV jet. In this case, the enhancement of the low energy bins is lower, while there is no suppression for the high energy bins (the weight saturates to 1). An overall view of the values of the weight in the EMB2 for central jets (\(|\eta|<0.7\)) can be found in fig. 20: the correction is effective for low energy in the cells for high energy jets, and for a wider range of cell energies for low energy jets.

The results for the linearity and the resolution obtained with the final parametrization of the weights in the central region are shown respectively in the left and right plot of fig. 21. The fit of the resolution curve has been done adding a noise term to eq. 15. Therefore, the fit function used is

\[\frac{\sigma(E_{T})}{E_{T}}=\frac{a}{\sqrt{E_{T}}}\oplus b\oplus\frac{c}{E_{T}} \tag{15}\]

As it can be seen, the results for the stochastic term \(a\) and for the constant term \(b\) are consistent (within the errors) with those obtain in absence of noise (fig. 17). The presence of noise is described by the parameter \(c\) only, and it is about 3 GeV, indicating that the noise is not completely removed by the noise cut discussed above. The results for the linearity show that the measured energy is within \(\pm 2\%\) from the true for the whole energy range considered, between 25 GeV and 3 TeV.

Up to this point, the reconstructed energy has been calculated using eq. 1, where the true value \(E_{MC}\) of the jet energy has been used as \(E_{J}\). In order to make the energy measurement independent of non-measurable quantities, the use of \(E_{MC}\) has to be avoided. To achieve this, the calculation of the final reconstructed energy can be done with an iterative procedure. One can first compute the EM scale energy \(E_{0}^{Rec}=\sum_{i}E_{i}\), where \(i\) runs over the cells. Then an iteration is performed so that the value used for \(E_{J}\) at the

Figure 19: _On the left: Profile of the energy deposited as a function of the energy in the cell for two jets of different energies in the EM sample. The weights applied as a function of the cell energy are also shown. On the right: the same for the Tile2 sample._

step is that reconstructed at the step \(j-1\):

\[E_{j}^{Rec}=\sum_{i}w_{i}(E_{j-1}^{Rec},E_{i},\eta)E_{i} \tag{16}\]

where \(\eta\) is the pseudorapidity of the jet. The iteration stops either when \(E_{j}^{Rec}-E_{j-1}^{Rec}<100\) MeV or if \(j=5\). The results of fig. 21 are shown again in fig. 22 using the iterative procedure. The linearity plot (in the left) does not show any difference, while the resolution plot shows a clear worsening of \(\sigma(E)/E\) at low energy. This produces an increase of the \(c\) coefficient of the noise term up to 4.8 GeV, indicating that the precision of the iterating procedure is energy independent.

The fit of the parameters has been repeated for jets in all the five \(\eta\) regions considered in tab. 1 and the parametrization of eq. 13 has been repeated. The \(\eta\) segmentation has been chosen in order to follow the pseudorapidity structure of the calorimeters. In particular, the choice of having two bins between \(\eta=2.5\) and \(\eta=5\) should allow to correct on average the inhomogeneity of the response around the crack between the HEC and the forward calorimeter. Tab. 4 reports the results for the resolution in the five pseudorapidity regions. The results of the region \(3.2<|\eta|<5\) have big errors because of the lack of statistics in that region and because of the poor linearity achieved (fig. 23). The stochastic term decreases as the pseudorapidity increases, as expected, since the results are given in terms of the transverse energy. In fact, since the stochastic term comes from the number of interactions done by a particle entering the calorimeter, this is related more to the energy than to the transverse energy. Since the energy released at high pseudorapidity is much higher than at low \(\eta\) (at the same \(E_{T}\)), the stochastic term has to be lower at high \(\eta\). Coherently the stochastic term increases as a function of the pseudoradity when the

Figure 20: _Value to of the weight to be applied to the cells of EMB2+EMB3 as a function of the jet and the cell energy. The plot shows only cell energies above 1 GeV._

resolution is expressed in term of energy.

Finally, the linearity can be checked over the full pseudorapidity range. Fig. 23 shows the ratio \(E_{T}^{Rec}/E_{T}^{MC}\) as a function of the pseudorapidity for four different jet energies. While at the EM scale the calorimeter response is not uniform (because of different technologies and calorimeter cracks), the response for calibrated jets is uniform, with some residual effect (in particular for low \(E_{T}\) jets) at \(\eta=1.5\), \(\eta=3.2\). At large \(\eta\) (where only low \(E_{T}\) jets are present in the simulated events), the lateral leakage leads to large variations of the response with \(\eta\).

\begin{table}
\begin{tabular}{c|c|c|c} \hline \hline Pseudorapidity & \multicolumn{4}{c}{Results} \\ region & \multicolumn{2}{c}{\(\frac{\sigma(E_{T})}{E_{T}}=\frac{a}{\sqrt{E_{T}}}\oplus b\oplus\frac{c}{E_{T}}\)} \\ \cline{2-4}  & a & b & c (GeV) \\ \hline \hline \(|\eta|<0.7\) & \((61\pm 4)\%\) & \((2.08\pm 0.06)\%\) & \(4.8\pm 0.3\) \\ \(0.7<|\eta|<1.5\) & \((62\pm 6)\%\) & \((3.98\pm 0.07)\%\) & \(4.9\pm 0.6\) \\ \(1.5<|\eta|<2.5\) & \((39\pm 6)\%\) & \((2.4\pm 0.2)\%\) & \(3.8\pm 0.3\) \\ \(2.5<|\eta|<3.2\) & \((34\pm 9)\%\) & \((2.6\pm 0.4)\%\) & \(5.2\pm 2\) \\ \(3.2<|\eta|<5\) & \((60\pm 10)\%\) & \((5\pm 1)\%\) & \(2\pm 1\) \\ \hline \hline \end{tabular}
\end{table}
Table 4: _Results obtained for the resolution in the 5 pseudorapidity considered for jets simulated with electronic noise included and with the iterative procedure to extract the reconstructed energy desribed in the text._

Figure 21: _Linearity (on the left) and resolution (on the right) plot for QCD di–jet events with noise included in the simulation. The weights have been applied using the MC energy._

## 5 Conclusions

Jets can be reconstructed by the ATLAS detector with a cone algorithm with high efficiency. A calibration algorithm based on cell weighting has been developed and tested on single pions both using fully simulated G4 data and with data from the 2004 Combined testbeam. The results found with the former are compatible with what is reported in the TDR. It has been shown that the algorithm works on the latter, even if the preliminary status of the LAr calorimeter signal reconstruction does not allow for a direct comparison of the last testbeam results with those of the previous ones.

Calibration constants for jets have been derived using QCD events with ISR, FSR, underlying event included (both with and without noise) simulated with G3. The results show that a linearity within 2% can be achieved on a large pseudorapidity range and over a large energy interval. The response in the crack regions is improved while the very large \(\eta\) regions (\(|\eta|>3.2\)) need further study, especially for low \(E_{T}\) jets. The resolution of the jet transverse energy measurement after the calibration is improved over the full \(\eta\) range.

## References

* [1] W. Braunschweig et al., Desy internal report (1989), DESY 89-022.
* [2] M. Casado and M. C. Sforza, ATLAS internal note (1996), TILECAL-NO-75.
* [3] S.Akhmadaliev et al., Nucl. Inst. and Meth. **A449**, 461 (2000).
* [4][http://atlas.web.cern.ch/atlas/groups/software/oo/simulation/geant4/index.html](http://atlas.web.cern.ch/atlas/groups/software/oo/simulation/geant4/index.html).

Figure 22: _Linearity (on the left) and resolution (on the right) plot for QCD di–jet events with noise included in the simulation. The weights have been calculated applying the iterative procedure to calculate the jet energy, as described in the text._