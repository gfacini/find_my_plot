###### Abstract

The multichannel remotely controlled high voltage source of 256 channels was designed by TESLA company in Prague, Czech Republic. Each channel delivers current of up to 20 mA at voltage levels -700 V, -900 V and -1100 V. A working sample with 2 HV channels was produced and undergoes laboratory tests and beam tests with TILECAL module zero. The working sample fulfils the requirements imposed.

[MISSING_PAGE_FAIL:2]

protection.

HV output channels are controlled and stabilised by communication and control unit based on singlechip computer INTEL 8051. The card's front panel has the LCD display and small keyboard. All functions of the crategy be controlled either manually via the keyboard and display or automatically by means of remote control through serial line.

Modular design guarantees simple maintenance by mere exchange of the faulty part by the one on stock.

### Electronics Parameters

The HV source specifications according to TESLA company design are presented in Tab.1.

Figure 1: Main HV source layout. The source consists of 2 racks with 16 crates(a), each crate accommodates communication and control unit(b) and 8 cards with 2 HV channels(c) each. Each channel supplies a distributor with up to 48 photomultipliers.

The source is designed with floating ground. Ground level of each output channel in a crate is floating in respect to the ground of the HV source crate. The 16 output channel grounds in a crate are connected into single source ground. A removable bridge wire is placed on the back panel of a crate (see table on a back panel of the crate) that connects the common ground of the source and a ground of the crate. The bridge normally connects the two grounds. In case of ground loop problems the bridge can be disconnected. Voltage level between the grounds is maximum \(\pm\)500 V (see Tab. 1).

Some specific notions used in Tab. 1 specification have following definition:

**Output voltage accuracy**: For a fixed output load, the tolerance in percent of the output voltage with respect to its nominal value under all minimum or maximum conditions.

Figure 2: Principal scheme of 16 channel HV crate. The supplies deliver 3 levels of input voltage for each channel. Each channel is independently controlled by a control unit.

**Line regulation**: The change in output voltage in percent as the input voltage is varied over its specified limits, with load and temperature constant.
**Load regulation**: The percent change of output voltage when the load is changed from minimum to maximum (6 to 19 mA), at constant input line and constant temperature with respect to the value at 12.5 mA load current.
**Long-term stability**: The output voltage change of a power supply, in percent, due to time only, with all other factors held constant. Long-term stability is a function of components stability.
**Temperature coefficient**: The average percent change in output voltage per one degree Centigrade change in ambient temperature over a specified temperature range with other factors held constant.

\(dU=U(40^{\circ}C)-U(5^{\circ}C)\), \(dt=40^{\circ}C-5^{\circ}C=35^{\circ}C\)

\(T_{C}=dU/dt\times 1/U_{nominal}\times 100[\%]\)

Remark:

The working sample was constructed for the input voltage of 220 V. Future prototype will be reconstructed according a new European norm requiring 230 V\(\pm\)10%.

### Mechanical Parameters

HV source is built into two 19 inch racks. Each rack contains 8 HV crates based on CERN standard 19 inch Eurochassis boxes of 6U height.

Connectors:

Line input 220 V EURO plug

HV output HV BNC connectors

RS 485 CANNON 9 pin

The whole HV source is composed of following parts:

part pieces

19 inch powered racks 2

19 inch, 6U crates with main power source 16

plug-in card with 2 HV channels 128

plug-in communication and control unit 16

The input power of both HV source racks is less then 7 kW.

## 3 HV Source Control

Each crate is controlled by single chip microcomputer INTEL 8051. The computer watches and controls all functions and parameters of the crate. Four LEDs (3 green + 1 red) indicate the output voltage level or the switched off state of each output channel. When switch on of a voltage level is requested, the control unit checks several conditions:

1. Load is connected
2. Load current is more than 5 mA and less then 20 mA
3. There is no overvoltage (e.g. from other source connected by chance, short circuit)

When the conditions are not fulfilled the protection algorithm is activated and the channel is automatically switched off. These conditions are continuously watched by communication and control unit and if violated, the channel is switched off and the red LED indicates the state. The main HV source can be controlled either manually or remotely over serial line.

### Manual Control

Manual control allows to switch each channel on at one of the three voltage levels and to switch the channel off. A local address of the output channel is chosen and then desired voltage is set.

### Remote control

Main HV source is remotely controlled by the serial interface line using RS 485 protocol. Transmission speed is 9600 Bd, 8 bit data, 1 stop bit without parity. The line may be connected to the simple text terminal (e.g. V T100), or other serial devices.

The source is controlled by a set of text commands. It is possible to control it by simple terminal, but it might be tedious to type in the commands. Standard control by PC, OS/9 or other computers is anticipated.

Syntax of the control commands is presented in Appendix A. Each command sent to the source is analysed and executed by the source and the source sends a reply. The reply is normally always sent with the exception of broadcast commands. Each command includes one character for the checksum. The command starts with two characters indicating the address of the output channel and of the crate number. When the source is operated remotely the manual control is switched off (priority of remote control).

Remark:

The first working sample with 2 HV channels has simpler both manual and remote control. The manual control does not set the channel address, but it is duplicated and operates independently both channels. Serial protocol RS232 (3 wire null modem) is used, the remote control does not transmit the crate address and does not use the checksum.

## 4 Test Schedule

The TESLA company has produced in the middle of 1995 working sample of the basic unit with 2 HV channels and presented it to the TILECAL collaboration in June 1995. The sample underwent successfully laboratory tests at the CERN Electronic System Support (ESS)[4], fulfilling thus the main requirement of long term service stability, low noise and robustness. Tab. 2 and Tab. 3 from ESS report illustrate measured values.

It is used for beam tests of the constructed TILECAL module zero during 1996. In 1997 a prototype of a complete crate with 16 channels will be built and tested. This is basic unit that builds up the main HV source. Special test bet for long time testing will be prepared in the Institute of Physics in Prague. The complete HV source is supposed to be built during 1998 or 1999.

## 5 Conclusions

The TILECAL subdetector needs special 256 channel HV power source delivering in each channel 20 mA at three possible voltage levels -700 V, -900 V and -1100 V with special stress on low noise and long term reliability and service stability. The TESLA company in Prague has designed the modular HV source and produced working sample with 2 channels. A limited evaluation of the sample was carried out at CERN (main parameters and only in manual control) and is used for beam tests of the TILECAL module zero. The 16 channel prototype will be built after the tests in 1997. The results of further tests will decide on final HV source construction.

**Syntax of control commands for the HV source of TILECAL**

Communication will use ASCII character set. All numbers (addresses, values) will use hexadecimal form converted to ASCII (see example).

**Communication tokens:**

Type  First character

COMMAND @

REPLY ( handshake ) #

BROADCAST *

General features:

* fixed length (10 characters)
* confirmed by reply (handshake)
* optional checksum, sum of all bytes in command before the checksum modulo 0xF, if the checksum is not required dash character '-' is put instead

_Byte structure of COMMAND:_

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|} \hline
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\ \hline @ & adr1 & adr2 & c & c & c & c & csum & CR & LF \\ \hline \end{tabular}

Where

@ indicates COMMAND

adr1 address of crate (0 F)

adr2 address of channel inside crate (0 F)

c character, command definition

csum checksum modulo OxF

CR carriage return

LF line feedList of commands:

1. Set 700 V ```
@ adr1 adr2 L V L 1 csum CR LF example: Set 700 V in crate number 2, channel 4 without checksum "@24 LV L1-<CR><LF>" or "@24 LV L1-\n" (C syntax)
2. Set 900 V
``` @ adr1 adr2 L V L 2 csum CR LF example: Set 900 V in crate number 0, channel 0 without checksum "@00LV L2-<CR><LF>" or "@00LV L2-\n" (C syntax)
3. Set 1100 V ```
@ adr1 adr2 L V L 3 csum CR LF example: Set 1100 V in crate number 5, channel 15 without checksum "@5FLVL3-<CR><LF>" or "@5FLVL3-\n" (C syntax)
4. Channel On (previous value of voltage is set)
``` @ adr1 adr2 O N \(\cup\)\(\cup\) csum CR LF ```
The empty characters \(\cup\) are spaces. example: Channel in crate number 2, channel 4 will be switched on, without checksum "@24ON_UU -<CR><LF>" or "@24ON_UU "(C syntax)
5. Channel Off
``` @ adr1 adr2 O F F \(\cup\) csum CR LF ``` The empty characters \(\cup\) are spaces. example: Channel in crate number 2, channel 4 will be switched off, without checksum "@24OFF_U"<CR><LF>" or "@24OFF_U" (C syntax)6. Read ```
@|adr1|adr2RE|A|DcsumCR|LF
``` example: Channelincratenumber2,channel4willberead,withoutchecksum"@24READ-<CR><LF>"or"@24READ-\n"(Csyntax)
7. SetLocal(setscrateinlocalmode-enablemanualcontrol) @|adr1L|O|C|A|LcsumCR|LF example: Setcratecoinlocalmodetoenablemanualcontrol,withoutchecksum"@0LOCAL<CR><LF>"or"@0LOCAL-\n"(Csyntax)
8. REPLY: Replyhasfollowingfeatures: * replyissentaftereachcommand
9. fixedlength(13characters)
10. checksumissumofallbytesincommandbeforechecksummoduloOxF
11. 2. 3. 4. 5. 6. 7. 8. 9. 10. 11. 12. 13. #|adr1|adr2|V|V|V|V|V|V|S|csum|CR|LF ```
Where:
```
#indicatesREPLY adr1addressofcratec(0F) adr2addressofchannelinsidecratec(0F) csumchecksummodulo0xF CR carriagereturn LFLinefeed Vvalueofthevoltage,inthedecimalfloatingpointformatwithdecimaldotandtrailingzeros,precisiononedecimaldigit. Ifvoltageisoutsidemeasurementlimits,OVER\({}_{\texttt{ULU}}\)orUNDER\({}_{\texttt{UL}}\)isdisplayedinstead. ```

S status of the channel (0.9, A..F), represents 4 bit information,  bit 0,1 - state of output

 0 OFF  1 700V  2 900V  3 1100V  bit 2 - overcurrent, undercurrent  bit 3 - fault voltage on the output (out of tolerance)

 example :  After READ command is sent a REPLY command is received:  "# 001099.63D\(<\) CR\(>\)\(<\) LF\(>\)"  Crate 0, channel 0, voltage 1099.6 V, status of the channel is 3, i.e. level 1100 V set, checksum is D.  "# 00699.9013\(<\) CR\(>\)\(<\) LF\(>\)"  Crate 0, channel 0, voltage 699.9 V, status of the channel is 1, i.e. level 700 V set, checksum is 3.  "# 00UNDER\(\_\)56\(<\) CR\(>\)\(<\) LF\(>\)"  Crate 0, channel 0, voltage outside measurable range (too low), status of the channel is 5 (binary 0101), i.e. 700 V level was requested, the current is outside working limits (i.e. 5-19 mA), checksum is 6. It means that the output channel is either overloaded or is in some transition state (e.g. after switching).

BROADCAST :  For switching on and off all outputs there are two broadcast commands _Byte structure of BROADCAST_

1. Shut down all

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|} \hline
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\ \hline
* & S & D & O & W & N &
* & csum & CR & LF \\ \hline \end{tabular}

Where:

* indicate broadcast command
* csum checksum modulo OxF

**CR** carriage return

**LF** line feed

example : Shutdown requested

"*SDOWN*-\(<\)CR\(>\)\(<\)LF\(>\)"
2. Start all

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|} \hline
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\ \hline
* & S & T & A & R & T &
* & csum & CR & LF \\ \hline \end{tabular}

example : Start requested

"*START*-\(<\)CR\(>\)\(<\)LF\(>\)"

## References

* [1] ATLAS Collaboration: ATLAS Technical Proposal CERN/LHCC/94-43
* [2] TILECAL internal note, in preparation
* [3] Address: TESLA, joint stock company, Antenna Systems Division, Measuring Equipment Department, Podebradska 186, 180 66 Praha 9, Czech Republic, contact: Dipl. Ing. Jiri Najman, head of the department, tel. +42-2-66107 677, fax +42-2-862357,+42-2-66107 467
* [4] ESS Electronic Systems Support, GI General Instrumentation, W. van Sprolant, Rapport d'evaluation hautetension de TESLA Prague, pour photomultiplicateurs HAMAMATSU R 5900, 29 fevrier 1996.