**Topological \(B\) hadron decay reconstruction and identification of \(b\)-jets with JetFitter in the ATLAS experiment at the LHC**

The ATLAS Collaboration

The identification of jets containing heavy flavour hadron decays, in particular bottom quark initiated jets, plays a major role in the LHC physics program. The topology of \(b\to c\to s\) decays gives rise to two detached vertices corresponding to the \(b\)- and \(c\)-flavoured hadron decays. The vertices can each have high invariant mass and several associated charged tracks, giving a very distinctive signature for the identification of \(b\)-jets. This note discusses the algorithm developed for the topological reconstruction of \(b\)-flavoured hadron decays in ATLAS, its implementation and performance based on simulation and 13 TeV collision data.

(c) 2018 CERN for the benefit of the ATLAS Collaboration.

Reproduction of this article or parts of it is allowed as specified in the CC-BY-3.0 license.

## 1 Introduction

The identification of jets containing bottom or charm hadrons plays a major role in the LHC physics program. Top-quark decays proceed almost exclusively through a \(b\)-quark, due to the hierarchy of the CKM mixing matrix elements. The Standard Model (SM) Higgs boson decays predominantly to \(b\bar{b}\) pairs, since the \(b\)-quark is the heaviest fermion that can be pair produced in its decay. Several scenarios of new physics result in an enhanced production of fermions of the third generation, such as models with an extended Higgs sector or scalar top and bottom quark production in Supersymmetry. SM measurements and searches for New Physics in such final states require efficient identification of \(b\)-flavoured hadron decays with small mis-identification probability over a broad kinematical range.

The ATLAS detector [1] is well equipped for the identification and reconstruction of B and D hadron decays1. With the start of Run 2, the Insertable B Layer (IBL) [2], an additional layer of pixel sensors surrounding a new beam pipe of smaller radius, has further enhanced the ATLAS tracking capabilities. It provides precise space point measurements along the charged particle trajectories in closer proximity to the LHC interaction region (see section 2.2), thus improving the ability to reconstruct primary and secondary interaction vertices [3, 4].

Footnote 1: In the following, the notation \(B\)- and \(D\)- hadrons is used to indicate \(b\)- and \(c\)-flavoured hadrons, inclusive of mesons and baryons. Specific meson states are indicated by their charge.

The identification of decays from \(B\)-hadrons is based on their relatively long lifetime (\(<c\tau>\sim\) 470 \(\mu\)m) and large charged decay multiplicity (\(\sim\)5 charged particles on average) [5]. These properties result in a secondary decay vertex that is significantly displaced with respect to the primary interaction vertex, and thus well identifiable. The identification of the secondary decay system is further favoured by the hard \(b\)-quark fragmentation function, with a large fraction \(x_{b}\) of the \(b\)-quark energy transferred to the \(b\)-flavoured hadron (\(<x_{b}>\sim\) 0.8), and by the large invariant mass of \(B\)-hadrons (\(\sim\)5.2 GeV). In addition, the \(b\)-flavoured hadron decays, in most cases, into at least one \(c\)-flavoured hadron, which decays itself with appreciable lifetime. This corresponds to a chain of \(b\to c\to s\) weak decays giving rise to a topological configuration with two detached vertices. While \(B\)-hadron decays differ from \(D\)-hadron and \(\tau\)-lepton decays in kinematics and decay length, additional discrimination can be obtained by identifying this unique topology of secondary and tertiary vertices.

The identification of \(b\)- and \(c\)-jets can be performed either by analysing the individual properties of charged particle tracks associated to a hadronic jet, or by explicitly reconstructing an inclusive detached vertex, or by reconstructing the full structure of decay vertices originating from the \(B\)- to \(D\)-hadron decay chain and analysing their topological and kinematical properties. All three methods highlighted here are implemented in ATLAS, respectively in the IPTag, SV and JetFitter algorithms, and have been used since Run-1 as the low-level algorithms that are combined in the ATLAS baseline multivariate \(b\)-tagging algorithm [6].

The aim of this note is to describe the JetFitter vertex reconstruction algorithm and its performance, including technical details about how the Kalman Filter (KF) formalism widely used for single vertex reconstruction [7] has been extended to determine the topological structure of weak \(B\)- and \(D\)-hadron decays expected inside a \(b\)-jet. The note is organised as follows. Generalities on \(B\)-hadron decays and details on the reconstruction of the relevant physics objects used in this study are briefly reviewed in section 2. The JetFitter algorithm is presented in section 3. The performance of the JetFitter algorithm is studied in section 4, using a combination of simulation and \(\sqrt{s}=13\) TeV ATLAS data. The impact oftopological vertex reconstruction on the flavor tagging performance is presented in section 5. Conclusions are given in section 6.

## 2 Topological reconstruction of \(b\) Decays at LHC with ATLAS

The topological decay reconstruction aims at measuring the characteristic properties of \(B\)-hadron decays in an optimal way for their use in the identification of \(b\)-jets and their discrimination from \(c\)- and light-quark jets. A robust reconstruction of charged-particle tracks and hadronic jets is required to cope with the challenging conditions presented by the LHC. The broad kinematic range of the jets produced in \(pp\) collisions corresponds to a large variation of the charged particle multiplicity in the jet. The increasing LHC luminosity brings a corresponding increase in event pile-up (PU) due to additional \(pp\) collisions within the same bunch crossing. Both effects constitute additional challenges for the discrimination of the \(B\)-decay products and their topological reconstruction.

### Topology and kinematics of \(b\) Decays

The topological vertex reconstruction is sensitive to the charged particle multiplicity in the jet and to the angle between the direction of the jet and that of the \(B\)-hadron. The \(B\)-hadron charged decay multiplicity, with about the same number of decay products expected at the \(B\)- and \(D\)-hadron vertices, must be compared to the number of charged particles originating in the fragmentation process. The latter increases logarithmically with the jet energy and it is subject to large fluctuations, and constitutes a combinatorial background that the topological vertex reconstruction must reject. As an example, charged particles from \(B\)- and subsequent \(D\)-hadron decays account for approximately 20% of the charged particles associated to a \(R=0.4\) anti-\(k_{t}\) jet [8] with transverse momentum \(p_{T}\) of 100 GeV, decreasing to \(\sim\)13% for a jet with a \(p_{T}\) of 500 GeV. The increase in the number of tracks from fragmentation, especially when hard gluon radiation occurs, and the potential overlap with hadronic activity unrelated to the jet originating from the \(b\)-quark at higher jet \(p_{T}\) result also in a degradation of the correlation between the jet direction and the \(B\)-hadron direction. These effects need to be taken into account when using the jet axis as an estimator of the heavy flavor flight direction: the RMS of the angle between the \(B\)-hadron direction and the jet axis scales from 27 mrad for a 100 GeV \(p_{T}\) jet to 45 mrad for a 350 GeV jet in \(t\bar{t}\) events, as will be illustrated in more detail in section 3.4.

The topological decay reconstruction of separate \(B\)- and \(D\)-decay vertices requires that at least one charged particle must be emitted from each of the \(B\)- and \(D\)-hadron decay vertices. On average 85% of decays of \(b\)-flavoured hadrons have at least one charged particle emitted at both the \(B\)- and \(D\)-hadron decay vertices and 52% of the decays have two or more. The lifetime of the majority of weakly-decaying \(B\)-hadrons is very similar, and the average lifetime of a mixture of \(B\)-hadrons representative of those produced in \(b\)-jets is 1.566 ps [5]. The lifetime corresponding to different \(D\)-hadron species varies more widely, and is in the range of approximately 0.1 to 1 ps, and in average about half of the \(B\)-hadron lifetime [5]. The decay distance of \(B\)- and \(D\)-hadrons from the primary vertex (PV) and the distance between the \(B\)- and \(D\)-hadron decay vertices in \(b\)-jets are shown as a function of jet \(p_{T}\) in Fig. 1. The average distance between \(B\)- and \(D\)-hadron decay vertices ranges from 5 to 15 mm. This separation must be compared to the experimental decay length resolution that ranges from \(\sim\)0.4 mm to \(\sim\)1.1 mm, depending on vertex multiplicity, mass and jet momentum, as studied in detail in section 4.2.

### Reconstruction of particle tracks and hadronic jets in ATLAS

The ATLAS detector [1], with a near cylindrical geometry2 consists of an inner tracking detector (ID), surrounded by a thin 2 T superconducting solenoid, a calorimeter system, and a muon spectrometer (MS) that measures the deflection of muon tracks in the field of three superconducting toroidal magnets.

Footnote 2: ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point in the centre of the detector and the \(z\)-axis along the beam pipe. The \(x\)-axis points from the interaction point to the centre of the LHC ring, and the \(y\)-axis points upward. Cylindrical coordinates \((r,\phi)\) are used in the transverse plane, \(\phi\) being the azimuthal angle around the \(z\)-axis. The pseudorapidity is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan(\theta/2)\). Angular distance is measured in units of \(\Delta R=\sqrt{(\Delta\eta)^{2}+(\Delta\phi)^{2}}\).

Charged particle reconstruction is based on the hits reconstructed in the Pixel, Semiconductor Tracker (SCT) and Transition Radiation Tracker (TRT) detectors. The Pixel detector consists of four concentric barrel layers and its measurements determine how precisely tracks can be extrapolated to their point of production. Since the start of Run 2, a new innermost pixel layer, the Insertable B Layer (IBL), surrounds a new and thinner beam pipe at an average radius of 33.5 mm. The barrel section is completed by three pixel disks in the forward region covering the interval \(1.9<|\eta|<2.9\). The pixel hit position and error and the identification of clusters created by multiple charged particles are obtained with a series of Neural Network (NN) clustering algorithms [10; 11]. The measured single point resolution of the reconstructed pixel hits is 10 \(\mu\)m in the transverse and 55, 110 \(\mu\)m on average in the longitudinal direction for the IBL and other layers, respectively.

The reconstruction of charged particle tracks [12] relies on the correct assignment of hits to tracks, a pattern recognition task that is made more challenging by the presence of additional tracks from PU events and due to collimated tracks in jets. Track reconstruction starts from track seeds formed from sets of three hits, recorded in either the Pixel or the SCT detector, or both. These are then extended to include

Figure 1: Average decay distance of the \(B\)- and \(D\)-hadrons with respect to the primary interaction vertex, and distance between the \(B\)- and \(D\)-hadron decay vertices as a function of the jet \(p_{T}\) obtained for a sample of broad \(Z^{\prime}\) bosons decaying to quark pairs [9].

additional hits from the remaining layers of the Pixel and SCT detectors, creating track candidates, to be later extended to the TRT detector. At this stage many of such candidates have either overlaps or wrongly assigned hits. To improve the quality of reconstructed tracks a dedicated processing step is implemented, defined as the ambiguity solver. This algorithm ranks track candidates according to a score that depends on their quality, and either solves or limits ambiguous hit to track assignments by iteratively rejecting tracks with a low score. In this process the information provided by the NN-based pixel clustering algorithm [10] about merged clusters from multiple hits is combined with information about hits shared by multiple track candidates. After pattern recognition and ambiguity solving a final \(\chi^{2}\)-based track fit is performed. Only tracks with \(p_{T}\) larger than 400 MeV are kept. In addition, further _Loose_ selection criteria are applied to reject fake and poorly measured tracks [3]. With these, the track reconstruction efficiency, evaluated by using minimum bias simulated events, in which more than 98% of charged particles are pions, scales from 91% in the central (\(|\eta|<0.1\)) to 73% in the forward (\(2.3<|\eta|<2.5\)) region. Customised selections are applied in the JetFitter algorithm, on top of the loose tracking cut to which these efficiency values refer to, to select \(B\)- and \(D\)-hadron decay track candidates and reject tracks from PU particles.

The primary vertex (PV) reconstruction is performed by iteratively associating the reconstructed particle tracks to vertex seed positions. Tracks incompatible with the vertex seed position are dropped and the whole procedure is repeated with the remaining unassociated tracks. Both the vertex seed positions of the vertices and the vertex in the \(\chi^{2}\) fits are constrained to be compatible with the interaction region of the LHC proton beams, whose transverse projection is defined as the beam spot. This poses a tight constraint on the position of the primary vertex in the transverse plane. A longitudinal vertex position resolution of \(\sim\)30 \(\mu\)m is achieved for events with high multiplicity of reconstructed tracks while the transverse resolution is 10-30 \(\mu\)m depending on the LHC running conditions that determine the beam spot size [13, 14].

Particle trajectories are fully specified by five defining helix parameters: \(d_{0}\), \(z_{0}\), \(q/p\), \(\phi\) and \(\theta\), defined at the perigee, i.e. the position of closest approach in the transverse plane to a reference position. Such reference position, in the following, is always chosen to be the reconstructed primary vertex. The perigee parameters \(d_{0}\) and \(z_{0}\) represent the transverse and longitudinal projections, respectively, of the point of closest approach and their errors are estimators of the the track extrapolation resolution. The transverse impact parameter component IP\({}_{r\phi}\) corresponds to the perigee parameter, \(|d_{0}|\), defined above, while the longitudinal component IP\({}_{z}\) is \(|z_{0}\sin\theta|\). The impact parameter resolution depends on the track transverse momentum, \(p_{T}\), and pseudorapidity, \(\eta\), due to multiple scattering effects, and is typically parameterised as \(a\oplus b(\eta)/p_{T}\). Here \(a\) is the asymptotic resolution reached for high \(p_{T}\) tracks, \(\sim\)10 and \(\sim\)40 \(\mu\)m in the IP\({}_{r\phi}\) and IP\({}_{z}\) projections, respectively, and \(b(\eta)\) the multiple scattering term, \(b(0)\sim\) 60 and \(b(1.5)\sim\) 90 \(\mu\)m/GeV in the IP\({}_{r\phi}\) projection [2, 3].

Hadronic jets are reconstructed from topological clusters [15] formed from energy deposits in the calorimeter system, using the anti-\(k_{t}\) algorithm [8] with a radius parameter of \(R=0.4\) and implemented in the FastJet package [16]. The calorimetric clusters are calibrated at the electromagnetic energy scale, and the final hadronic jet energy scale is calibrated through a series of corrections [17]. These include a Monte Carlo-based calibration to bring the scale to that of stable particles and in-situ techniques on pp collision data that reduce residual differences between data and Monte Carlo.

A common jet selection is used as a basis for all the studies reported here. Only jets with \(p_{T}\) above 20 GeV and \(|\eta|<2.5\) are selected. In order to reject jets originating from PU interactions, a requirement on the output of the Jet Vertex Tagger algorithm (JVT) [18] is used. This algorithm is based on track-based variables combined in a multivariate discriminant and is designed to suppress PU jets so that the efficiency for jets from the hard scattering collision is stable as a function of the number of primary vertices in the event. Jets with \(p_{T}<60\) GeV and jet \(|\eta|<2.4\) are discarded if the JVT score is less than 0.59. This algorithm working point has been evaluated using 36.5 fb\({}^{-1}\) of proton-proton collision data recorded by the ATLAS in 2015 and 2016, by selecting a sample of \(Z\)-boson events decaying into muons with at least one extra jet. This results in an efficiency for jets from the hard-scatter interaction of 92% for a residual observed rate from PU jets of 2%.

The jet axis, which is based entirely on calorimetric information, can be used in \(b\)-tagging as an initial estimator of the \(B\)-hadron direction. Particle tracks are therefore associated to reconstructed jets by using the angular separation \(\Delta\)R between their momentum (defined at the point of closest approach to the primary vertex) and the jet axis. The \(\Delta\)R requirement varies as a function of jet \(p_{\mathrm{T}}\), being wider for low \(p_{\mathrm{T}}\) jets (0.45 for jet \(p_{T}=20\) GeV) and narrower for high \(p_{\mathrm{T}}\) jets (0.26 for jet \(p_{T}=150\) GeV) since decay products from high \(p_{T}\)\(B\) hadrons are more collimated [6].

Jets in the simulation are labelled \(b\)-, \(c\)- or light-flavour jets. Jets are first matched to \(B\)- and \(D\)-hadrons having \(p_{T}\)\(>\)5 GeV within a cone of radius \(\Delta\)R=0.3 around the jet axis. The labelling is performed by first searching for \(b\)-flavoured hadrons within this cone. If no \(b\)-flavoured hadron is found, \(c\)-flavoured hadrons and finally \(\tau\) leptons are searched for. The remaining jets which are not matched to a heavy-flavoured hadron or \(\tau\) lepton are considered to be light-flavour jets. A requirement on the possible overlap between jets and leptons is also applied. Jets are removed if they overlap with a truth electron or muon from \(W\) or \(Z\) boson decays in a cone of \(\Delta\)R\(<\)0.3.

## 3 The JetFitter algorithm

In the SV inclusive secondary vertex finding algorithm used in ATLAS [19], displaced tracks are selected and an inclusive single vertex is obtained using a Billoir-based \(\chi^{2}\) fit [20; 21]. The topological algorithm used in JetFitter is based on a different strategy, where several vertices can be reconstructed simultaneously along a common line that approximates the \(B\)- and \(D\)-hadron flight directions. Generated and reconstructed track and vertex topologies for a simulated \(B^{0}\) meson decay are shown in Figure 2.

The task of the vertex finder is to find the correct vertex topology (number of vertices and associated track-to-vertex assignments) inside the jet, while the vertex fiter is responsible for reconstructing the positions of the vertices and their uncertainties for a fixed topology. The assumptions made in the algorithms are discussed in section 3.1. The variables that describe the decay chain reconstructed by the JetFitter algorithm are introduced in section 3.2. Finally, the vertex finding and fitting algorithms are described in detail in sections 3.3 and 3.4.

### Underlying topological assumption

The JetFitter algorithm assumes the \(B\)- and \(D\)-hadron decay vertices to be aligned on the line defined by the \(B\)-hadron flight path. Under this hypothesis, all charged particle tracks stemming from either the \(B\)- or \(D\)-hadron decay intersect this axis. There are several advantages to this method:

* Incomplete topologies can be reconstructed, including topologies with a single track from the \(B\)-hadron decay and a single track from the \(D\)-hadron decay;* The fit evaluates the compatibility of the given set of tracks with a \(B\to D\)-like cascade decay topology, increasing the discrimination power against \(c\)- and light-flavoured jets;
* Constraining the tracks to lie on the \(B\)-hadron flight axis reduces the number of degrees of freedom of the fit, increasing the chance of separating the \(B\)- and \(D\)-hadron vertices.

This hypothesis is justified by the kinematics of the particles involved, determined by the hard \(b\)-quark fragmentation function and the masses of \(B\)- and \(D\)-hadrons. The lateral displacement of the \(D\)-hadron decay vertex perpendicular to the \(B\)-hadron flight path needs to be small enough not to significantly undermine the basic assumption within the typical resolution of the tracking detector. It is in the transverse plane that such comparison is most critical, since this is where the smallest detector resolution is achieved. The lateral displacement was studied in more detail on \(t\bar{t}\) simulated events looking for \(B\)- and \(D\)-hadrons in \(b\)-jets. The \(B\)- and \(D\)-hadron decays are modelled by the EvtGen [22] 1.6.0 program with an ATLAS tuned decay table. Considering \(b\)-jets with an average transverse momentum of \(\approx\) 60 GeV, the average transverse flight length of \(B\)-hadrons is 4.3 mm, while the subsequent transverse flight length of the \(D\)-hadrons produced at the \(B\)-vertex is on average 1.9 mm. The average lateral displacement of the \(D\)-hadron perpendicularly to the \(B\)-hadron flight direction, projected onto the transverse plane, is \(\approx\) 30 \(\mu\)m.

Figure 3 shows a comparison of the lateral displacement normalised to the decay length (\(\Delta_{T}\)) and based on generator (MC-truth) level information, to the same quantity as estimated from reconstructed vertices, thus including experimental resolution effects. In most cases, the hypothesis made is well justified. However, the vertex resolution, which depends on the number, topology and \(p_{T}\) of the tracks, can occasionally be smaller than this displacement and therefore can cause a possible large contribution to the overall fit \(\chi^{2}\). This is taken into account by just making the requirement on the overall \(\chi^{2}\) probability of

Figure 2: Event display of a simulated \(B^{0}\) decay showing generated (left panel) and reconstructed (right panel) particle trajectories. Only charged particles originating from the \(B^{0}\) meson decay are shown. In the right panel, reconstructed particles (in green those originating from the secondary and in red those from the tertiary vertex) are extrapolated to the point of closest approach to the beam collision point. The axes give the coordinates in mm. JetFitter performs a multi-vertex fit constraining all vertices to lie on a single flight axis, indicated by an orange line in both figures, which is initialised using the jet direction.

the decay chain vertex fit slightly looser (0.1%) when testing for different possible configurations of the decay chain topology.

The hypothesis of a negligible lateral displacement of the \(D\)-hadron decay vertex with respect to the \(B\) hadron flight path was adopted for the first time in the "ghost track algorithm" developed by the SLD Collaboration [23]. The \(B\)-hadron flight axis was substituted by a "ghost track" and a numerical global \(\chi^{2}\) minimisation procedure used to perform the multi-vertex fit. The use of a dedicated Kalman Filter in JetFitter has several advantages compared to a conventional global \(\chi^{2}\) minimisation, in particular the higher execution speed, especially during the clustering process where any arbitrary merging of two pre-existing vertices can be performed with one single processing step.

### Definition of decay chain variables

Figure 4: Schematic view of a track crossing the heavy hadron flight axis with the definition of the variables used by JetFitter in the decay chain fit.

Figure 3: Average lateral displacement \(\Delta_{T}\) of the generated (continuous line) and reconstructed (dashed line) \(D\) hadron decay vertex with respect to the \(B\)-hadron flight direction, normalised to the \(D\)-hadron decay distance from the interaction point. Only reconstructed vertices with a decay length compatible with the generated value for the true \(D\)-hadron vertex within 2.5 times the experimental resolution are considered.

While in a conventional vertex finder there is only a single vertex with position variable \(\vec{x}\), in JetFitter the decay chain is described through the following variables as illustrated in Figure 4:

\[\vec{d}=(x_{PV},y_{PV},z_{PV},\phi,\theta,d_{1},d_{2},...,d_{N}) \tag{1}\]

with:

* \(x_{PV},y_{PV},z_{PV}\): the primary vertex position.
* \(\phi,\theta\): the azimuthal and polar directions of the \(B\)-hadron flight axis.
* \(d_{1},d_{2},...,d_{N}\): the distances of the fitted vertices, defined as the intersections of one or more tracks and the \(B\)-hadron flight axis, to the primary vertex position along the flight axis (\(N\) representing the number of vertices).

### Vertex finder

In this section the basic finding algorithm implemented in JetFitter starting with \(N\) input tracks to be used for the topological reconstruction of the \(\mathrm{P}V\to B\to D\) hadron decay chain is described.

The selection of input tracks is designed to minimise the number of charged particles not originating from a \(B\)- or \(D\)-hadron decay considered in the decay chain fit. This includes both prompt charged particles from fragmentation, and, to a minor extent, secondary particles from other sources. Tracks that are compatible with the primary vertex are removed with a cut that depends on the lifetime sign, computed with respect to the jet direction. For tracks with positive lifetime sign the \(\chi^{2}\) probability \(P\) is required to be below 10%. Tracks with a negative life time sign are less likely to originate from a heavy hadron decay, and must satisfy a tighter requirement \(P<5\%\).

Tracks compatible with originating from hadronic material interactions are identified and rejected. The procedure selects pairs of tracks forming a vertex, using a conventional \(\chi^{2}\) vertex fitting minimization procedure. Vertices with a \(\chi^{2}\) probability \(>\)3% (or 5%) and lifetime-signed decay length significance \(L/\sigma(L)>\)1.5 (or 1) are tested for the compatibility of the vertex position with the location of one of the pixel barrel layers. In this selection phase, no attempt is made to reduce combinatorics. As a result, each track can be associated to zero, one or multiple two-track vertices. Tracks associated to at least one two-track vertex, but not associated to any two-track vertex compatible with material interactions, are used as input to the heavy hadron decay reconstruction. Further requirements are applied to these tracks with respect to the _Loose_ requirement applied during track reconstruction: \(|\mathrm{I}\mathrm{P}_{r\phi}|<3.5\) mm, \(|\mathrm{I}\mathrm{P}_{z}|<5\) mm and the track \(p_{T}\) must exceed 0.5 GeV.

Additionally, the algorithm includes a procedure to reject tracks originating from photon conversions, \(K^{0}_{S}\) or \(\Lambda^{0}\) decays. In this case, the same vertexing procedure used to identify material interactions is applied, and tracks associated to two-track vertices compatible with photon conversions (\(m_{e^{+}e^{-}}<30\) MeV), \(K^{0}_{S}\) (\(|m_{\pi^{+}\pi^{-}}-m_{K^{0}}|<18\) MeV), \(\Lambda^{0}\) decays (\(|m_{p\pi}-m_{\Lambda}|<30\) MeV) are rejected. Although the fraction of these vertices being rejected is comparable for \(b\)-, \(c\)- and light-flavoured jets, the removal of photon conversions, \(K^{0}_{S}\) and \(\Lambda^{0}\) decays reduces the overall number of light-flavoured jets with secondary vertices resulting in a modest increase of the achievable \(b\)-tagging purity. This rejection is however not applied as default in the current production version of the JetFitter code.

A first vertex fit is performed on the selected tracks using the JetFitter vertex fitting algorithm (described in Section 3.4) under the hypothesis that each of the selected tracks represents a single vertex along the \(B\)-hadron flight axis, initialised as the jet axis. This results in a first set of fitted (\(\phi\),\(\theta\),\(d_{1}\),\(d_{2}\),...,\(d_{N}\)) values, where \(N\) corresponds initially to the number of tracks used as input to the fit. Vertices having a \(\chi^{2}\) contribution to the overall decay chain fit corresponding to a probability below 0.1% are removed. Such \(\chi^{2}\) contribution typically includes two terms: the compatibility of the tracks assigned to the vertex and the compatibility of the vertex to the overall decay chain. The latter depends on how well aligned that vertex is with respect to all other vertices along the common \(B\)-hadron flight axis, compared to the fit uncertainties. A clustering procedure is then performed, where all combinations of two vertices (picked up among the vertices lying on the \(B\)-hadron flight axis plus the primary vertex) are taken into consideration. The probability of each combination of vertices to form a common vertex and simultaneously for this vertex to be compatible with the overall decay chain is computed, using the previously mentioned \(\chi^{2}\) computation, filling a "table of probabilities" as exemplified in Table 1.

After this table of probabilities is filled, the two vertices \(x\) and \(y\) with the highest probability value \(P_{xy}\) are merged, a new complete fit is performed with the new decay chain structure and a new table of probabilities is filled. This procedure is iterated until all pairs of vertices with a probability above a threshold are exhausted. The threshold for merging any displaced vertex with the primary vertex is fixed to 0.1%. In order to optimise the reconstruction efficiency for tertiary vertices, the \(\chi^{2}\) probability cut applied to decide whether to merge or not two-track vertices into a single secondary vertex depends on the actual reconstructed secondary vertex mass, \(m_{\rm sec}^{\rm IF}\). This is determined as follows. The invariant mass of tracks reconstructed from truth particles belonging to the secondary vertex, \(m_{\rm sec}^{\rm truth}\) is first computed for simulated events. This mass distribution is integrated to obtain the probability to observe on average a massvalue \(m_{\rm sec}^{\rm truth}\) larger than that of the vertex under study. The \(\chi^{2}\) probability cut applied to merge a two-track vertex to the secondary vertex is then rescaled according to this probability, so that the merging is less likely if the probability to have \(m_{\rm sec}^{\rm truth}>m_{\rm sec}^{\rm JF}\) is small and more likely if this probability is large. This procedure improves the efficiency for reconstructing a tertiary vertex in a \(B\)-hadron decay by \(\sim\)15%, without significantly affecting the rate of fake tertiary vertices in \(c\) and light jets. It also ensures that the reconstructed secondary vertex mass, \(m_{\rm sec}^{\rm JF}\), does not exceed the expected invariant mass of charged particle tracks originating from the \(B\)-hadron decay vertex.

In a second iteration, additional tracks, not forming any of the two-track vertices considered in the first pass, are considered if they fulfill a tighter selection: \(|{\rm IP}_{r\phi}|<1.5\) mm, \(|{\rm IP}_{z}|<\)3 mm and \(p_{T}>\)0.75 GeV. Since non-prompt single tracks may originate from PU tracks with high impact parameter significance in the longitudinal direction, \(|z_{0}\sin\theta|/\sigma(z_{0})>\)5, but small impact parameter significance in the transverse direction, \(|{\rm IP}_{r\phi}|/\sigma<\)2, are not considered. The sensitivity to PU is discussed in detail in Section 4.6. This iteration starts with initializing the decay chain fit to the topology found in the first stage and this second

\begin{table}
\begin{tabular}{c|c|c|c|c|c} \hline Vertex & 1 & 2 & 3 &... & Primary vtx \\ \hline
1 & - & \(P_{12}\) & \(P_{13}\) &... & \(P_{1P}\) \\ \hline
2 &... & - & \(P_{23}\) &... & \(P_{2P}\) \\ \hline
3 &... &... & - &... & \(P_{3P}\) \\ \hline... &... &... &... & - &... \\ \hline Primary vtx &... &... &... &... & - \\ \hline \end{tabular}
\end{table}
Table 1: Table of probabilities generated during the clustering phase. A compatibility test is performed between all pairs of vertices along the \(B\)-hadron flight axis and the table of probabilities is filled accordingly, where \(P_{xy}\) is defined as the probability for vertex \(x\) and vertex \(y\) to form a common vertex and \(P_{xP}\) is the probability for vertex \(x\) to be compatible with the primary vertex.

set of tracks is tested for forming additional single-track vertices along the decay chain, by re-running the full vertex fitting algorithm including the additional tracks. The vertex finding procedure then proceeds again through incompatible vertex removal and clustering/merging.

The result of this clustering procedure is a well-defined decay chain topology with a unique association of tracks to vertices along the \(B\)-hadron flight axis, where each vertex has at least one associated track.

### Vertex fitter

The vertexing task is mathematically implemented in JetFitter as an extension of the KF formalism for vertex reconstruction [7]. While in a conventional KF vertex fit the variables to be iteratively updated in the fit are the three-dimensional components of the vertex position \(\vec{x}\), in the case of JetFitter the variables that are iteratively updated and describe the full decay chain are \(\vec{d}=(x_{PV},y_{PV},z_{PV},\phi,\theta,d_{1},d_{2},...,d_{N})\).

Before starting the fit, the variables are initialised with their prior knowledge:

* The primary vertex position \(x_{PV},y_{PV},z_{PV}\) (with covariance matrix), as provided by the primary vertex finding algorithm.
* The \(B\)-hadron flight direction (\(\phi\), \(\theta\)), approximated by the direction of the jet axis, with an uncertainty that includes the effect of the jet direction resolution and the average displacement of the jet direction relative to the \(B\)-hadron flight axis.

The root mean square (RMS) of the distribution of residuals of the reconstructed jet direction with respect to the real \(B\)-hadron direction for \(b\)-jets in simulated \(t\bar{t}\) events is shown in Figure 5 as a function of the \(B\)-hadron \(p_{T}\) (left panel) and the jet \(p_{T}\) (right panel). While the former plot shows that in this energy regime where hard gluon radiation is still sub-dominant the resolution improves with \(B\)-hadron \(p_{T}\), the

Figure 5: Residual RMS of the reconstructed jet direction with respect to the \(B\)-hadron direction in the azimuthal angle as a function of the hadron \(p_{T}\) (left) and as a function of the jet \(p_{T}\) (right), as obtained in simulated \(t\bar{t}\) events. For the left plot, only jets with \(p_{T}\) up to 350 GeV have been considered to reduce the impact of nearby jet activity.

latter plot shows that nearby jet activity starts to significantly degrade the resolution at high jet \(p_{T}\) when the \(b\)-jet merges with the other top quark decay products. The residual distributions shown here refer to the azimuthal angle, but the behaviour for the polar angle is analogous. The jet directional resolution for describing the \(B\)-hadron flight axis direction is parametrised as a function of the jet \(p_{T}\) and \(|\eta|\) and used as a constraint in the fit.

The fit is performed by adding iteratively as input the track parameters of the individual tracks, specifying at each iteration the vertex number to be updated. The main input needed by the KF is the measurement equation, that relates the track measurement vector (the helix parameters \(\vec{q}\)) to the position of the vertices to be updated and to the momentum of the track evaluated at the vertex. In the case of the single-vertex fit the measurement equation is [7]:

\[\vec{q} = \vec{C}+A\vec{x}+B\vec{p} \tag{2}\]

where \(\vec{x}=(x,y,z)\) is the (single) vertex position and \(\vec{p}=(p_{x},p_{y},p_{z})\) is the track momentum at the vertex, while the Jacobians \(A\) and \(B\) and the constant vector \(C\) encode the linearisation parameters. In JetFitter the single vertex position \(\vec{x}\) is replaced with the full decay chain configuration expressed by \(\vec{d}\), resulting in a new measurement equation:

\[\vec{q} = \vec{\bar{C}}+\widehat{A}\vec{d}+\widehat{B}\vec{p} \tag{3}\] \[= \vec{q}(\vec{d},\vec{p})=\vec{q}(\vec{d},\vec{p})_{\vec{d}=\vec {d}_{0},\vec{p}=\vec{p}_{0}}+\left.\frac{\delta\vec{q}(\vec{d},\vec{p})}{ \delta\vec{d}}\right|_{\vec{d}=\vec{d}_{0}}\left(\vec{d}-\vec{d}_{0}\right)+ \left.\frac{\delta\vec{q}(\vec{d},\vec{p})}{\delta\vec{p}}\right|_{\vec{p}= \vec{p}_{0}}\left(\vec{p}-\vec{p}_{0}\right)\]

In order to be used in a KF, the measurement equation needs to be linearised, which corresponds to a first-order Taylor expansion. This is equivalent to computing the Jacobian matrices \(\widehat{A}\) and \(\widehat{B}\), and the vector \(\vec{\bar{C}}\) in the formula above for a fixed set of \(\vec{d}_{0}\) and \(\vec{p}_{0}\).

As highlighted in Section 3.3, in the first sequence of KF update iterations only single-track vertices are considered, therefore the number of vertices \(N\) in \(\vec{d}\) is initialised to the number of tracks. A first approximate estimate of \(\vec{d}_{0}\) needed to compute the Jacobians for the measurement equation is provided by the points along the flight axis (as estimated from the jet direction and having as origin the primary vertex) corresponding to the minimum distance to the single tracks. Since this task cannot be solved analytically, the minimum distance is obtained through a Newton-based iterative method, which minimises the distance between a straight line (the \(B\)-hadron flight axis) and the track helix, assuming a constant magnetic field.

Taking \(\vec{x}=(x,y,z)\) to be the position of the vertex on the \(B\)-hadron flight axis to be updated by the track added to the fit, the relation between \(\vec{x}\) and \(\vec{d}\) is:

\[x=x_{PV}+d_{i}\cdot\sin\theta\cos\phi \tag{4}\] \[y=y_{PV}+d_{i}\cdot\sin\theta\sin\phi\] \[z=z_{PV}+d_{i}\cdot\cos\theta,\]

where \(d_{i}\) is the flight length corresponding to the vertex considered, so that one can relate back the measurement equation for JetFitter (equation 4) to the equivalent one for a single-vertex fit (equation 2) by the equality:

\[\vec{x}-\vec{x_{0}}=\vec{x}(\vec{d})-\vec{x}(\vec{d}_{0})=\left.\frac{d\vec{ x}(\vec{d})}{d\vec{d}}\right|_{\vec{d}=\vec{d}_{0}}\left(\vec{d}-\vec{d}_{0} \right), \tag{5}\]where \(x_{0}\) is the three-dimensional position of the vertex corresponding to the flight length \(d_{0}\). This means the matrices \(\widehat{A}\) and \(\widehat{B}\), and the vector \(\widehat{C}\) of equation 4 can be related, through equation 5, to the equivalent single vertex quantities \(A\), \(B\) and \(C\) of equation 2, which are implemented in the main ATLAS vertex reconstruction package [13]. This is effectively equivalent to a change of coordinates from Cartesian to spherical coordinates. In particular, \(\widehat{\mathcal{C}}=\vec{C}\) and \(\widehat{B}=B\), while \(\widehat{A}\) can be obtained from \(A\) by computing: \(\widehat{A}\)\(=\)\(A\)\(\frac{d\vec{x}(\vec{d})}{d\vec{d}}\bigg{|}_{\vec{d}=\vec{d}_{0}}\), where the transformation matrix \(\frac{d\vec{x}(\vec{d})}{d\vec{d}}\) is:

\[\frac{d\vec{x}(\vec{d})}{d\vec{d}}=\left(\begin{array}{cccccc}1&0&0&-d_{i} \sin\theta\sin\phi&d_{i}\cos\theta\cos\phi&...&\sin\theta\cos\phi&...\\ 0&1&0&d_{i}\sin\theta\cos\phi&d_{i}\cos\theta\sin\phi&...&\sin\theta\sin\phi&...\\ 0&0&1&0&-d_{i}\sin\theta&...&\cos\theta&...\end{array}\right) \tag{6}\]

and the columns numbered \((6,...,i+4,i+6,...,N+5)\) related to the vertices not considered in the current iteration \((d_{1},d_{2},...,d_{i-1},d_{i+1},...,d_{N})\) are identically zero.

Once the linearised measurement equation is defined, the KF formalism can be used to iteratively add tracks to the fit, yielding at each iteration an updated decay chain \(\vec{d}\) and related covariance matrix. The final configuration is equivalent to minimizing the overall \(\chi^{2}\) of all track to vertex residuals, with the \(B\)-hadron flight axis constraint applied.

The original Jacobian \(A\) of a single-vertex fit is quite insensitive to small changes of the position of the vertex \(\vec{x}\). In contrast, the transformation matrix and thus the Jacobian \(\widehat{A}\) has a highly non-linear dependence on the distance from the primary vertex \(d_{i}\) of the vertex formed by one or more intersecting tracks. For this reason, several iterations of the decay chain fit are needed for the fit to converge, and during each new iteration the position Jacobian \(\widehat{A}\) needs to be recomputed. The procedure can be sped up significantly by keeping \(A\) fixed at the old linearisation point, and only updating the transformation matrix and thus \(\widehat{A}\), as explained in more detail in [24]. In a typical decay chain fit around 4-5 iterations are required before the fit converges: the convergence criterion is that, after a new iteration, \(\left|\chi^{2}_{\text{new}}-\chi^{2}_{\text{old}}\right|\) is required to be smaller than \(10^{-3}\).

The fit procedure remains perfectly defined if more than one track is fitted to the same vertex along the flight axis. In this case, when the tracks corresponding to this vertex are added iteratively to the decay chain fit, they both contribute the same flight length \(d_{i}\) corresponding to the vertex to be updated.

Once the assignment of tracks to vertices is made, the vertex fitting procedure yields the optimal values for the \(B\)-hadron flight axis direction and the positions of the fitted vertices along it.

## 4 Performance

The data and simulated samples used and the event selection employed are described in Section 4.1. The performance of the JetFitter algorithm is first studied in Section 4.2 in terms of secondary vertex reconstruction efficiency and resolution, and of how often particles are correctly associated to their vertex of origin, either from a \(B\) hadron, or from a \(B\to D\) cascade decay. This study requires detailed truth level information and is thus carried out on true \(b\)-jets in simulated samples. The performance of the algorithm is then studied in data in Section 4.3, based on observables representing \(B\) hadron production and decay properties that stem from the topological vertex reconstruction. The study is carried out separately on two data samples, one enriched in \(b\)-jets, the other in light-flavoured jets. The distributions observed in data are compared to simulations. A good modelling of the data is essential to make sure that the optimization and performance studies carried out based on simulations are applicable to data.

The ability of simulations to correctly model the data also depends on how sensitive the JetFitter algorithm is on the \(B\) hadron fragmentation function and on the \(B\) and \(D\) hadron charged decay multiplicity, which are only known with finite precision. The dependence of the algorithm on these physical parameters, within their uncertainties, is studied in Section 4.4. The modelling of \(B\) hadron decays is also studied in Section 4.5 on a sample of \(D\) meson decays reconstructed exclusively and semi-exclusively. Finally, the robustness of the algorithm with respect to contamination from PU events is discussed in Section 4.6.

### Samples and Event Selection

The optimisation and the performance evaluation for \(b\)-jets are carried out using a MC sample of \(t\bar{t}\) events produced in proton-proton collisions generated at a centre-of-mass energy of \(\sqrt{s}=13\) TeV and simulated with Powheg [25] interfaced with Pythia8[26] for parton shower and hadronization. The CT10[27] parton distribution function set is used in the simulation. The EvtGen[22] program is used to model the decays of \(B\) and \(D\) hadrons. Only \(t\bar{t}\) decays with at least one lepton from a subsequent \(W\)-boson decay are included in the simulation. Minimum bias interactions are produced with Pythia8 and included in the simulation in order to model additional inelastic \(pp\) collisions accompanying the hard-scatter interactions (PU). Single top \(Wt\) events generated with Powheg interfaced with Pythia6[28] are also included. The simulation is generated with an average \(<\mu>=25\) PU interactions per bunch-crossing.

The response to light-flavour jets is studied in \(t\bar{t}\) and \(Z+\mathrm{jets}\), \(Z\to\mu\mu\) events generated with Powheg interfaced with Pythia8. The jet multiplicity distribution in the Powheg \(Z+\mathrm{jets}\) sample is re-weighted to the distribution predicted by MadGraph+Pythia 8[29], which is known to give a better description of the \(Z+\mathrm{jets}\) data. A similar re-weighting is applied to the \(b\)-jet flavour fraction, for which again the MadGraph sample is expected to provide better modeling. The propagation of particles through the detector and the detector response is simulated using Geant4[30, 31]. The ATLAS reconstruction software is run on the simulated samples.

Subsets of the data collected by the ATLAS detector from proton-proton collisions in 2016 at a centre-of-mass energy of 13 TeV have been used to compare the response on data to that obtained on simulation. This comparison is based on two samples: selected \(e^{\pm}\mu^{\mp}\) events, enriched in \(b\) jets from top quark decays, and \(Z\to\mu^{+}\mu^{-}+\mathrm{jets}\) events, where light-flavoured jets are dominant. Muons and electrons must satisfy isolation requirements based on inner-detector tracks and topological clusters in the calorimeter. The \(e\mu+\mathrm{jets}\) sample consists of events with a pair of opposite-sign \(e^{\pm}\mu^{\mp}\) having leading and subleading \(p_{T}(e/\mu)>25/20\) GeV and \(>15\) GeV, respectively, invariant mass in excess of 10 GeV, and between 2 and 7 selected jets. Requirements for jets to be tagged by MV2MuRNN high-level flavour tagger[9] are imposed, as described below for the different studies. No \(p_{T}\)-dependent, data-based calibration has been applied to the tagging efficiency of the MV2MuRNN tagger in simulation. Aside from the dominant \(t\bar{t}\) contribution the main additional source of events in the \(e\mu+\mathrm{jets}\) sample is due to the associated production of a single top quark and a \(W\) boson. The \(Z\to\mu\mu+\mathrm{jets}\), sample is selected by requiring two oppositely-signed muons, with \(p_{T}>25\) GeV for the leading and \(p_{T}>20\) GeV for the other muon, with invariant mass \(76<m(\mu)<106\) GeV and at least one selected jet. No flavour tagging requirements are imposed on the \(Z\to\mu\mu+\mathrm{jets}\) sample. The main background is given by \(t\bar{t}\) events, which are included in the simulation. The selected \(e\mu+\mathrm{jets}\) events corresponds to a total integrated luminosity of 2.5 fb\({}^{-1}\) and the selected \(Z\rightarrow\mu\mu\) + jets events to 0.5 fb\({}^{-1}\). These sets of data have been chosen to sample the data collected at different PU conditions, in a way to roughly cover the full spectrum of PU conditions of the 2016 data. In both cases, simulated events have been reweighted to reproduce the PU distributions of the data samples, for the data/MC comparisons.

### Topological reconstruction

The topological decay reconstruction relies on the ability of the vertexing algorithm to reconstruct the secondary and tertiary vertices and to correctly associate the charged particle tracks originating from the \(B\)- and \(D\)-hadron decays. Using simulated \(B\)-hadron decays in \(t\bar{t}\) events, the efficiency for reconstructing a JetFitter vertex with at least two associated tracks in \(b\)-jets with two or more charged particles generated in the sum of \(B\)- and the \(D\)-hadron decays is 84%. The true fraction of these decays with at least two charged particles is 97%. The efficiency for reconstructing two distinct vertices in decays with at least two charged particles emitted at each decay vertex is \(\sim\)30%. The reconstruction performance is characterised in terms of the fraction of selected \(b\)-jets with reconstructed JetFitter vertices of a given topology and their purity, defined as the fraction of tracks associated to the vertex that originate from a heavy-flavoured hadron decay. Results are given in Table 2 for different topologies of JetFitter vertices. The corresponding rates of reconstructed JetFitter vertices observed in simulation for charm- and light-flavoured jets are given in a corresponding table in Section 5. In addition, the table compares the average number of charged particles from \(B\)-hadron and subsequent \(D\)-hadron decays successfully associated to a JetFitter vertex, \(<N_{\rm Bdec}^{\rm JF}>\), with the average generated \(B\)-hadron charged decay multiplicity, \(<N_{\rm Bdec}>\), of decays corresponding to each topology of reconstructed vertices. Apart from the single track vertex topology, the secondary particle purity in the reconstructed vertices is rather stable for the different topologies. A significant correlation between the generated charged decay multiplicity of the heavy hadrons, the JetFitter vertex topology and the number of tracks associated to the reconstructed vertices is observed.

The rate of reconstructed vertices in different reconstructed topologies and the corresponding purities of tracks associated to these vertices depend on several parameters. Some of the most important are: the \(B\)-hadron decay distance from the PV, upon which the ability to discriminate secondary from primary tracks depends, and the \(D\)-hadron decay distance from the \(B\)-hadron vertex, upon which the separation of tertiary from secondary particles depends.

The purity, defined above as the fraction of tracks associated at JetFitter vertices that stem from true \(B\)- or \(D\)-hadron decays, is \(\sim\)85% when averaging over all topologies in \(b\)-jets from simulated \(t\bar{t}\) events. The performance of the track-to-vertex association is studied in more detail in

\begin{table}
\begin{tabular}{l|c|c|c|c|c|c} \hline  & JFVert. & \(\geq\)1 Single Trk & 0 Single Trk & \(\geq\)1 Single Trk & & \\  & All & 0 Multi Trk & 1 Multi Trk & 1 Multi Trk & 2 Multi Trk & \(\geq\)3 Multi Trk \\ \hline Fraction & 0.893 & 0.147 & 0.414 & 0.227 & 0.102 & 0.004 \\ Purity & 0.846 & 0.684 & 0.894 & 0.825 & 0.839 & 0.769 \\ \hline \(<N_{\rm Bdec}>\) & 4.9 & 3.8 & 4.8 & 5.1 & 6.3 & 7.3 \\ \(<N_{\rm Bdec}^{\rm JF}>\) & 3.0 & 1.1 & 2.9 & 3.7 & 4.9 & 6.0 \\ \hline \end{tabular}
\end{table}
Table 2: Fractions of selected \(b\)-jets with JetFitter vertices reconstructed in different topologies, their purity and the average generated, \(<N_{\rm Bdec}>\), and reconstructed, \(<N_{\rm Bdec}^{\rm JF}>\), \(B\)-hadron charged decay multiplicity for JetFitter decay chains in simulated \(t\bar{t}\) events.

and tertiary vertex are reconstructed. Figure 6 presents the fraction of correctly assigned tracks to the secondary vertex as a function of the \(B\)-hadron decay radius, with the points labelled \(B\to B\) in the leftmost panel. The result for the tertiary vertex is labelled \(D\to D\) in the rightmost panel. The fraction of incorrectly assigned tracks is broken down by origin. The \(D\to B\) and \(B\to D\) categories represents tracks from the tertiary vertices incorrectly assigned to the secondary vertex, and vice versa. The "Others" category includes tracks form the primary vertex, from pile-up and material interactions. For very short decay distances, when the distance between two vertices is comparable to the decay length resolution, the contamination from particles from the adjacent vertex is significant. As expected, the ability to separate secondary from primary and tertiary from secondary vertices depends, critically, on the their relative distance. On average approximately 40-50% of the tracks are correctly assigned to the their vertex of origin.

Once the decay length resolution is fixed by the track opening angles at the vertex and the track extrapolation resolutions, the ability to separate secondary from primary, and tertiary from secondary vertices depends critically, jet-by-jet, on their relative distance.

The vertex position resolution is studied first in terms of the geometrical resolution, i.e. the position resolution due to the track extrapolation accuracy, track multiplicity and decay angles. This is computed by comparing the reconstructed decay position to the generated value for decay chains where JetFitter correctly associates all the tracks to their vertex of origin. The dependence of the vertex resolution on the particle multiplicity at the vertex, the vertex invariant mass and the energy of the decaying \(B\)-hadrons is shown in Figure 7, where the resolution is defined as the RMS of the central 90% (RMS90) of the distribution of the differences between the generated and reconstructed decay distance. The geometrical resolution, given by the white filled markers in Figure 7, improves with increasing vertex decay multiplicity and with increasing vertex mass, ensuring a larger opening angle and thus a better constraint along

Figure 6: Fraction of tracks associated to the secondary (B) (left) and tertiary (D) (right) JetFitter vertices with at least two particles, originating from \(B\) hadron (B), \(b\to c\) hadron (D) decays and not originating from an heavy hadron decay (Other) as a function of the radius of the corresponding generated vertex. Only \(b\)-jets with reconstructed secondary and tertiary JetFitter vertices are considered here. The fraction of tracks correctly associated to their vertex of origin are shown by the filled circular markers in both plots.

the \(B\)-hadron direction of flight, and degrades with the \(B\)-hadron energy, due to the increasing collimation of particles emitted in the decay. In the topological vertex reconstruction, this degradation is approximately balanced by the linear increase of the decay length with heavy hadron energy. A resolution of \(\sim\) 0.3 mm for the vertex position along the line of flight for sufficiently large multiplicity and mass values is obtained for \(B\)-hadrons with an energy of 50-100 GeV. The filled black markers in Figure 7 correspond to the final resolution that takes into account additional effects such as wrong assignments of tracks to vertices.

The resolution of the decay distance of the secondary vertex from the position of origin of the \(B\)-hadrons is studied for an inclusive sample of JetFitter vertices having at least one track correctly associated to the vertex of origin. This shows the additional resolution effects on the vertex position resolution due to the track-to-vertex mis-association. The resolution, including the effect of incorrectly associated tracks, is compared to the geometrical resolution in Figure 7.

### Modelling of JetFitter observables

The topological decay information from JetFitter can be encoded in a set of observables that can be used to discriminate \(b\)-jets from \(c\)- and light jets. The first topological observable is the rate of secondary and tertiary vertices reconstructed by JetFitter. This rate is measured in candidate \(t\bar{t}\to e\mu+\mathrm{jets}\) events, with the sub-leading jet tagged by the MV2MuRNN BDT discriminant [9] at a working point corresponding to 77% \(b\) jet efficiency, and in \(Z\rightarrow\mu\mu+\mathrm{jets}\), where the \(b\) jet contribution is predicted by the simulation to be smaller by a factor \(\sim\)2.5. Only the jets other than the one tagged are considered in the \(t\bar{t}\to e\mu+\mathrm{jets}\) to avoid biases. The rate observed in \(t\bar{t}\to e\mu+\mathrm{jets}\) data for at least one (more than one) multi-prong vertex is 0.287\(\pm\)0.008 (0.072\(\pm\)0.005), compared to 0.144\(\pm\)0.009 (\(0.0280\pm 0.0004\)) for \(Z\rightarrow\mu\mu+\mathrm{jets}\) events. The same rates measured in simulation are 0.286 (0.070) and 0.140 (0.0256) for the \(t\bar{t}\) and \(Z\rightarrow\mu\mu+\mathrm{jets}\) samples respectively. The rate of jets with more than one multi-prong vertices, where the contribution of \(b\) jets is expected to be dominant (see Table 3), scales as the predicted \(b\)-jet content of the samples in both data and simulation.

Figure 7: Resolution of the JetFitter secondary vertex position as a function of (left) the number of tracks associated to the vertex, (center) the reconstructed vertex invariant mass and (right) the \(B\)-hadron energy. The open markers represent the geometrical component of the resolution obtained selecting vertices to which JetFitter correctly associated all tracks, i.e. having exclusively tracks from \(B\)-hadron decay products. The filled points represent the resolution for vertices to which JetFitter associated at least one \(B\)-hadron decay product track.

Figure 8 presents the normalized distribution of the number of displaced (single- and multi-prong) vertices per jet reconstructed by JetFitter. The result in the left panel corresponds to the \(e\mu+\text{jets}\) selection, the result in the right panel to the \(Z\to\mu\mu+\text{jets}\) sample. In both cases, the measured distribution is compared to a prediction based on a Monte Carlo simulation of the \(t\bar{t}\) and \(Z\to\mu\mu+\text{jets}\) processes. The estimated contribution from \(b\), \(c\) and light-flavoured jets, based on the labelling explained in Section 2.2, is indicated with different fill colours. Overall, excellent agreement is found.

In addition to the number of single-prong and multi-prong decay vertices, other observables stemming from the topological vertex reconstruction are: the multiplicity of the tracks associated to the reconstructed vertices, the vertex decay length normalised by its uncertainty the invariant mass of the reconstructed secondary system and the fraction of the jet energy carried by all the particles at the detached vertices. The distributions of the invariant mass and number of tracks associated to the JetFitter vertices are shown in Figure 9 for three classes of vertices: 1) vertices in jets which have only a single reconstructed vertex, 2) secondary and 3) tertiary vertices in jets with two distinct vertices. It should be noted that in simulation no jet-\(p_{\text{T}}\) dependent data-based calibration has been applied to the tagging efficiency of the MV2MuRNN tagger. However, dedicated studies show that the impact of the calibration scale factors is at most at the 3% level, and thus does not significantly affect the results of the comparisons of data to simulation

Figure 8: Number of detached vertices reconstructed by JetFitter in 2016 collision data (points with error bars) and simulation (histograms) for jets from selected \(t\bar{t}\) (left) and \(Z\to\mu\mu+\text{jets}\) (right) events. The contribution of \(b\), \(c\) and light-flavoured jets in simulation is also shown. The error bars on the data points represent statistical uncertainties. No uncertainties are included for the Monte Carlo prediction.

presented here. In general, the agreement of simulation with data in all these distributions is found to be good.

### Sensitivity to \(B\)-hadron production and decay modelling

Finally, the effects of the modelling of \(B\)-hadron production and decays on the efficiency of vertex reconstruction have been studied. The \(b\)-quark fragmentation function, defined as the fraction of the \(b\)-quark energy transferred to the weakly decaying \(B\)-hadron, \(x_{B}=E_{B}/E_{b}\) and the charged decay multiplicity, \(N_{\rm dec}^{\rm cha}\) have been considered. The \(b\)-quark fragmentation function has been studied in detail at LEP and SLC [32; 33; 34; 35]. The favourable kinematics of the \(e^{+}e^{-}\to Z^{0}\to b\bar{b}\) process at the resonance peak made possible to determine the average value, \(<x_{B}>\), and the \(x_{B}\) distribution. In this study, \(b\)-jets in simulated \(t\bar{t}\) events are linearly reweighted to reproduce the 68% range of LEP measurement of \(<x_{B}>=0.7094\pm 0.0025\)[35]. The corresponding relative change of the efficiency for reconstructing at least one or two JetFitter vertices is \(\pm 0.004\) and \(\pm 0.006\), respectively.

Figure 9: Invariant mass (top) and number of tracks (bottom) associated to detached vertices reconstructed by JetFitter in 2016 collision data (points with error bars) and simulation (histograms) for jets from selected \(t\bar{t}\) events. The left column shows the variables for jets with a single reconstructed vertex, the other columns for jets with two vertices, with the secondary vertex in the center and the tertiary vertex on the right. The contribution of \(b\), \(c\) and light (\(q\)) jets in simulation is also shown. The error bars on the data points represent statistical uncertainties. No uncertainties are included for the Monte Carlo prediction.

The average charged decay multiplicity of \(b\)-flavoured hadrons was measured for \(B^{-}_{u}\) and \(B^{0}_{d}\) mesons by CLEO at the \(\Upsilon\)(4S) [36] resonance and by DELPHI at LEP, inclusive for all \(b\)-flavoured hadron species, obtaining \(4.97\pm 0.03\pm 0.06\)[37]. By linearly reweighting \(b\)-jets in simulated \(t\bar{t}\) events to reproduce the changes of the average multiplicity by \(\pm 0.07\), the corresponding relative change of the efficiency for reconstructing at least one vertex, or more than one, with JetFitter is \(\pm 0.005\) and \(\pm 0.013\), respectively. In summary, the impact of these systematics on the JetFitter reconstruction are found to be small, making the algorithm more robust. Residual effects from production and decay modelling in simulation are then corrected in the final data-based calibration: in this procedure data control samples are used to extract the \(b\)-tagging efficiency of the multi-variate taggers that include the JetFitter observables, and the simulation is then corrected accordingly.

### Exclusive decay reconstruction

Exclusive and semi-exclusive \(B\)-hadron decays can be used to evaluate the performance of the JetFitter vertex reconstruction algorithm on topologies with a well-defined invariant mass, such as decays with all-charged decay products as in \(D\to K\mathrm{n}\pi\). Comparisons with simulation of the invariant mass spectrum and particle track multiplicity reconstructed in data can also help to understand whether reconstruction efficiency, combinatorial contributions and vertexing features are correctly reproduced by the simulation.

The study is performed first on \(t\bar{t}\) events selected as discussed in Section 4.1. In addition, events are required to have (at least) two selected jets tagged by MV2MuRNN high-level flavour tagger at the working point corresponding to 80% \(b\)-jet efficiency. All selected jets having at least two JetFitter vertices, of which at least one vertex has two or more associated tracks, are considered. Simulation predicts 81% of selected jets to contain a \(B\)-hadron, 4% only a \(D\)-hadron decay and 15% to be light-flavoured jets.

Semi-exclusive decays are reconstructed in the \(D^{0}\), \(D^{\pm}\to K\mathrm{n}\pi\) (\(n=\)1-5) mode. The invariant mass of the particles at the vertex at largest radius is computed by iteratively assigning the \(K^{\pm}\) mass to one of the particle tracks associated to the vertex, while others are given the \(\pi^{\pm}\) mass. The configuration giving the invariant mass closest to the average \(D^{0}\) and \(D^{\pm}\) meson masses is kept. The resulting tertiary vertex \(m_{3}^{\mathrm{IF}}(Kn\pi)\) invariant mass distribution for vertices having total charge of 0 or 1, shown in Figure 10, exhibits a clear peak at \(m_{3}^{\mathrm{IF}}(Kn\pi)=(1.872\pm 0.004)\) GeV. Simulation shows that most of this enhancement is due to genuine reconstructed \(D^{0}\) and \(D^{\pm}\) mesons with fully reconstructed decays accounting for 25% of the reconstructed vertices in the mass region within a \(\pm 0.075\) GeV mass window around the peak position.

The multiplicity of the tracks associated to tertiary JetFitter vertices in the mass region \(1.795<m_{3}^{\mathrm{IF}}(K\mathrm{n}\pi)<1.945\) is shown in Figure 10.

This shows that the JetFitter algorithm fully reconstructs heavy hadrons decaying into charged final states and the simulation describes the invariant mass distribution observed in data for decay multiplicities from 2 to 5 quite well. The discrepancy observed in the multiplicity spectrum may be due to various factors such as a different efficiency as a function of vertex multiplicity in data and MC or an imperfect modeling of the decay branching fractions and kinematics.

Finally, the same analysis is applied to \(Z+\mathrm{jets}\) (\(Z\rightarrow\mu\mu\)) selected events, without requiring either \(b\)-tagged jets in the event or reconstructed JetFitter vertices in the jet. A rate of \(D^{0}\), \(D^{\pm}\) candidates in the mass region \(1.795<m_{3}^{\mathrm{IF}}(K\mathrm{n}\pi)<1.945\) of (5\(\pm 0.5\))\(\times 10^{-4}\) and 6\(\times 10^{-4}\) is obtained in data and MC, respectively. The low rate observed in this sample, where the \(b\)-jet content is low as discussed above,shows that the probability of reconstructiong spurious vertices yielding a relatively large invariant mass is small in non-\(b\) jets, as predicted by simulation.

### Sensitivity to event pile-up

The JetFitter algorithm response has been studied in relation to the mean number of interactions per bunch crossing, to understand the robustness of the algorithm with respect to contamination from PU events. Specific requirements are included in the track selection to mitigate the PU effects in the algorithm performance, as mentioned in Section 3.3. Figure 11 shows the two-dimensional distributions of the IP\({}_{r\phi}\) and IP\({}_{z}\) impact parameter significance for tracks from single-track vertices in heavy flavoured hadron decays and for tracks generated from PU. PU tracks are found to populate the region of large longitudinal impact parameter significance and small transverse impact parameter significance. Tracks with large \(|\)IP\({}_{z}|/\sigma(\)IP\({}_{z}\)\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\()\) are removed when adding single-tracks in the second pass of JetFitter vertex finding. The change in the rates of vertex reconstruction as a function of the average number of PU interactions per bunch crossing is shown in Figure 12. Thanks to the selection implemented against tracks from PU, the vertex reconstruction rate is rather stable as a function of the PU conditions, although a mild increase in the probability to reconstruct a single vertex is seen for light jets, due to tracks from PU being occasionally fitted into a displaced vertex.

Figure 10: \(K\)n\(\pi\) invariant mass (left) and track multiplicity in the \(D^{0}\), \(D^{\pm}\) meson peak region of the JetFitter tertiary vertex reconstructed in jets from selected \(t\overline{t}\) events in 2016 collision data (points with error bars) and simulation (histograms). The contribution of \(b\)-, \(c\)- and light- (\(q\)) jets in simulation is shown. In addition, the light shaded histogram shows the predicted contribution of \(b\)-jets with \(D^{0}\) and \(D^{\pm}\) mesons decaying to all-charged final states. The error bars on the data points represent statistical uncertainties. No uncertainties are included for the Monte Carlo prediction.

## 5 Jet flavour tagging with topological variables

The topological reconstruction of heavy hadron decays with JetFitter yields a set of observables well suited for the identification and the discrimination of heavy-flavour jets. The efficiencies for vertex reconstruction in \(b\)-, \(c\)- and light-flavoured jets with \(p_{T}>20\) GeV are summarised in Table 3 for the same topologies already considered in Table 2. Considering jet variables, the efficiency of vertex reconstruction is given as a function of the jet \(p_{T}\) and \(|\eta|\) in simulated \(t\bar{t}\) events in Figure 13, separating vertices with one or more associated tracks from all reconstructed vertices. After a rise at low \(p_{T}\) values, where the separation between the secondary vertex and the PV is comparable to the decay length resolution, the

Figure 11: \(\mathrm{IP}_{r\phi}/\sigma(\mathrm{IP}_{r\phi})\) vs. \(\mathrm{IP}_{z}/\sigma(\mathrm{IP}_{z})\) impact parameter significance for tracks used to build a JetFitter single-track vertex and originating from heavy flavour decays (left) and pile-up (right). The boxes show the 2D cuts applied to reduce the effect of PU tracks in the vertex reconstruction.

Figure 12: Rate of vertices reconstructed by JetFitter in \(b\)-, \(c\)- and light-flavoured jets as a function of the number of pile-up events. The rates for reconstructing one (== 1 vtx) and more than one (\(>1\) vtx) vertex in the jet are given separately.

efficiency for \(b\)-jets reaches a plateau around 95%, when including single-track vertices, and around 86% when requiring at least two tracks. The efficiency for reconstructing two vertices reaches its plateau at \(\sim\)55%, including single prong vertices, and \(\sim\)20%, considering only multi-prong vertices, in \(b\)-jets with \(p_{T}>150\) GeV. This has to be compared to the probability to reconstruct two vertices in a \(c\)- and a light-jet, in the same \(p_{T}\) range, of 10 (4)% and 5 (2)%, respectively, when considering also single prong (or only multi-prong) vertices. The identification of the two-vertex topology is one of the most discriminant single observables available for \(b\)-jet identification.

In order to evaluate the performance of the JetFitter algorithm applied to flavour tagging, a multivariate \(b\)-tagging algorithm based on Boosted Decisions Trees (BDT) is implemented to combine the jet-flavour discrimination powers of several observables extracted from the multi-vertex reconstruction. This algorithm is based on the ROOT Toolkit for Multivariate Data Analysis (TMVA) [38]. The BDT training is performed assigning \(b\)-jets as signal and a mixture of 93% light-jets and 7% \(c\)-jets as background. The training parameters are optimised for the best discrimination power between signal and background. A scan of the minimum node size parameter defining the minimal fraction of jets in a leaf over the total number of jets in the training, the number of trees in the BDT forest, the typical depth of the trees, and the number of cuts in the training, i.e. the number of grid points over the variable range used to find the

Figure 13: Efficiency for reconstructing one and more vertices in simulated \(t\bar{t}\) events as function of the jet (left) \(p_{T}\) and (right) \(\eta\) for \(b\)-, \(c\)- and light-flavoured jets. The rates for reconstructing one (= 1 vtx) and more than one (\(>\) 1 vtx) vertex in the jet are given separately.

\begin{table}
\begin{tabular}{l|c|c|c|c|c|c} \hline  & JF Vertices & \(\geq\)1 Single Trk & 0 Single Trk & \(\geq\)1 Single Trk & & \\  & All & 0 Multi Trk & 1 Multi Trk & 1 Multi Trk & 2 Multi Trk & \(\geq\)3 Multi Trk \\ \hline \(b\)-jets & 0.893 & 0.147 & 0.414 & 0.227 & 0.102 & 0.0040 \\ \(c\)-jets & 0.556 & 0.246 & 0.258 & 0.044 & 0.008 & 0.0001 \\ light jets & 0.234 & 0.155 & 0.069 & 0.010 & 0.001 & 0.0001 \\ \hline \end{tabular}
\end{table}
Table 3: Efficiencies for JetFitter vertex reconstruction in different topologies in \(b\)-, \(c\)- and light-flavoured jets having \(p_{T}>20\) GeV and \(|\eta|<2.5\) from simulated \(t\bar{t}\) events.

optimal cut in node splitting, has been performed. The chosen values are 0.25 for the minimum node size, 800 for the number of trees, 5 for the maximal tree depth.

The list of observables used as input for the training of the algorithm is given in Table 4. These variables are divided in three sets. The first set ("Reduced") consists of the variables related to the particles associated to reconstructed displaces vertices - number of particles, invariant mass and fraction of the charged jet energy, significance of the average decay distance - without use of the information from the multi-vertex topology. These are representative of the observables available from an inclusive secondary vertex reconstruction algorithm. Then, information on the number of reconstructed detached vertices is added to the above variables ("Baseline"). This consists of the number of single-prong and multi-prong vertices and the number of two-track vertices prior the decay chain fit. These two first variable sets represent the JetFitter inputs to the ATLAS MV2 tagger [9], used as the baseline b-tagging algorithm by the ATLAS collaboration since beginning of the LHC run II. Finally, the full information of the kinematics of the reconstructed topological decay chain ("Full") - number of particles, invariant mass and jet energy fraction - is used in addition. The use of these three sets of variables allows to evaluate the discrimination power added by the detailed information from the topological decay reconstruction. This third variable set is also included to the MV2 tagger for charm-tagging application.

The values of the jet \(p_{T}\) and \(|\eta|\) ("Kinematics") are also included in the training to take advantage of their correlations with the input variables. To avoid any differences in the kinematic distributions of signal and background being interpreted as discriminating by the training, signal jets as well as c-jet background are reweighted in \(p_{T}\) and \(|\eta|\) to match the spectrum of light-flavour background jets. No kinematic reweighting is applied at the evaluation stage of the multivariate classifier.

\begin{table}
\begin{tabular}{l|c|l} \hline Input & Variable & Description \\ \hline Kinematics & \(\mathrm{p}_{T}\) & Jet \(p_{T}\) \\  & \(\eta\) & Jet \(|\eta|\) \\ \hline \multirow{4}{*}{Reduced} & \(m\) & Invariant mass of tracks from displaced vertices \\  & \(f_{E}\) & Fraction of the charged jet energy in the secondary vertices \\  & \(\Delta R(\vec{p}_{\mathrm{jet}},\vec{p}_{\mathrm{vtx}})\) & \(\Delta R\) between jet axis and vectorial sum of momenta of all tracks \\  & \(S_{\mathrm{xyz}}\) & Significance of average distance between PV and displaced vertices \\  & \(N_{\mathrm{Tk\&AVV\&}}\) & Number of tracks from multi-prong displaced vertices \\ \hline \multirow{4}{*}{Baseline} & above variables + & \multirow{2}{*}{Number of 2-track vertex candidates (prior to decay chain fit)} \\  & \(N_{\mathrm{Tk\&Vtx}}\) & Number of single-prong displaced vertices \\  & \(N_{\mathrm{\geq 2-t\&vtx vertices}}\) & Number of multi-prong displaced vertices \\ \hline \multirow{4}{*}{Full} & above variables + & \multirow{2}{*}{Distance of 2\({}^{\mathrm{nd}}\) or 3\({}^{\mathrm{nd}}\) vertex from PV} \\  & \(L_{xy}({\mathrm{2}}^{\mathrm{nd}}/{\mathrm{3}}^{\mathrm{rd}}\mathrm{vtx})\) & Transverse displacement of the 2\({}^{\mathrm{nd}}\) or 3\({}^{\mathrm{nd}}\) vertex \\ \cline{1-1}  & \(m_{\mathrm{Tk\&}}({\mathrm{2}}^{\mathrm{nd}}/{\mathrm{3}}^{\mathrm{rd}}\mathrm{vtx})\) & Invariant mass of tracks associated to 2\({}^{\mathrm{nd}}\) or 3\({}^{\mathrm{nd}}\) vertex \\ \cline{1-1}  & \(E_{\mathrm{Tk\&}}({\mathrm{2}}^{\mathrm{nd}}/{\mathrm{3}}^{\mathrm{rd}}\mathrm{vtx})\) & Energy of charged tracks associated to 2\({}^{\mathrm{nd}}\) or 3\({}^{\mathrm{nd}}\) vertex \\ \cline{1-1}  & \(f_{E}({\mathrm{2}}^{\mathrm{nd}}/{\mathrm{3}}^{\mathrm{rd}}\mathrm{vtx})\) & Fraction of charged jet energy in 2\({}^{\mathrm{nd}}\) or 3\({}^{\mathrm{nd}}\) vertex \\ \cline{1-1}  & \(N_{\mathrm{Tk\&AVV\&}}({\mathrm{2}}^{\mathrm{nd}}/{\mathrm{3}}^{\mathrm{rd}} \mathrm{vtx})\) & Number of tracks associated to 2\({}^{\mathrm{nd}}\) or 3\({}^{\mathrm{nd}}\) vertex \\ \hline \end{tabular}
\end{table}
Table 4: Input variables used for the three trainings of the multivariate tagging algorithm. All the variables up to the Baseline variable set are used as the JetFitter inputs to the ATLAS MV2 tagger [9]. The Full variable set brings additional information from to the full topological properties of the reconstructed decay chain.

The BDT algorithm returns a continuous discriminating variable peaking around \(+1\) for signal and \(-1\) for background jets. The \(b\)-jet tagging efficiency and the \(c\)- and light-jet rejection, defined as the inverse of their mis-identification probability, are determined for jets from \(t\bar{t}\) simulated events as a function of the threshold on the BDT discriminant. Figure 14 shows their values for the training obtained on the three sets of JetFitter variables. A significant improvement of the discrimination of \(b\)-jets, with an increase of the rejection of light-flavoured jets by a factor of 1.4 and 2.0 and of that for \(c\) jets by a factor of 1.45 and 2.0 at constant \(b\)-tagging efficiency of 50%, when adding the information on the number of reconstructed detached vertices in the decay chain and their full kinematical properties.

The sensitivity to the PU conditions is estimated by computing the rejection for simulated events with different average numbers of PU events. The light-flavoured and \(c\)-jets rejection at constant 50% \(b\)-jet efficiency is reduced by 38% and 18% when increasing the average PU values from 25 to 60, without re-training the BDT discriminant.

## 6 Conclusions

The topological reconstruction of \(B\)-hadron decays is important to efficiently and cleanly separate \(b\)- from \(c\)- and light-flavoured jets. The JetFitter algorithm adopted by ATLAS for the reconstruction of the decay chain in hadronic jets and applied in jet flavour tagging is based on an extension of the Kalman Filter

Figure 14: Rejection of (left) light- and (right) \(c\)-jets as a function of the \(b\)-jets efficiency obtained with the BDT multivariate discriminant trained with three different sets of JetFitter variables.

formalism for single-vertex reconstruction and uses the jet direction as an initial estimator of the heavy hadron line of flight. Its principles and implementation have been presented in this note together with highlights of its performance in simulation and data.

The reconstruction of the structure of decay vertices originating from the \(B\)- to \(D\)-hadron decay chain and the analysis of their topological and kinematical properties from the JetFitter algorithm have been characterised in terms of the efficiency for reconstructing one or more secondary vertices in the decay chain, their spatial resolution, the ability to fully reconstruct \(D\) meson decays originating from \(B\)-hadrons and the sensitivity to PU.

In \(b\)-jets of \(p_{\rm T}\)\(\sim\) 150 GeV, the efficiency for reconstructing at least one vertex has been estimated to be 95%, when including single-track vertices, and \(\sim\)86%, when requiring at least two tracks per vertex. Analogously, the efficiency for reconstructing two vertices was found to be \(\sim\)55%, when including single-track vertices, or \(\sim\)20%, when considering only multi-track vertices. This has to be compared to the probability to reconstruct two vertices in \(c\)- and light-jets, in the same \(p_{T}\) range, which was estimated to be 10 (4)% and 5 (2)%, respectively, when considering also single-track (or only multi-track) vertices, highlighting the power of the topological reconstruction in separating \(b\)- from non-\(b\) jets.

The resolution of the position of the vertices reconstructed by JetFitter along the direction of flight of the \(B\)-hadron is estimated to be \(\sim\) 0.3 mm for sufficiently large track multiplicities and reconstructed mass values and for \(B\)-hadrons with an energy of 50-100 GeV. The resolution increases to \(\sim\) 1 mm for \(B\)-hadrons with an energy of 200-300 GeV. These values are small compared to the average decay distance of \(D\)-hadrons with respect to the \(B\)-hadron decay vertex, corresponding to 5 to 15 mm in the same energy ranges, thus ensuring the reconstruction of the decay chain.

The rate of jets with more than one multi-track vertex reconstructed by JetFitter, where the contribution of \(b\)-jets is expected to be dominant, has been measured for a sample enriched in \(t\bar{t}\) events and one of selected \(Z\to\mu\mu+\)jets events and found to scale between the two samples as the predicted \(b\)-jet content of the samples, in both data and simulation. The track multiplicity and the invariant mass of both secondary vertices and tertiary ones (when reconstructed) show good agreement between data and simulation, confirming the good modelling of the JetFitter observables that provide discrimination between \(b\)-, \(c\)- and light-flavoured jets.

A mass peak corresponding to the \(D\) mass signals fully and correctly reconstructed \(D\)-mesons, in two- to four-prong topologies, in the decay chain of \(B\)-hadrons. In addition, the JetFitter vertex reconstruction rate has been found to be rather stable as a function of the PU conditions, and the effects of the imperfect modelling of \(B\)-hadron production and decays on the efficiency of vertex reconstruction have been found to be small.

The role of the detailed information provided by JetFitter on the reconstructed topology and kinematics of detached vertices in the flavour tagging of jets has been studied using a dedicated Boosted Decision Tree multi-variate analysis. The comparison of the non-\(b\) jet rejection of three multivariate discriminants, the first trained on observables typically available from an inclusive secondary vertex reconstruction, the second on improved information on the number of detached vertices reconstructed by JetFitter and the third with the full information of the kinematics of the JetFitter topological decay chain, has been used to quantify the gain provided the JetFitter topological reconstruction. Factors of 1.4 (1.45) and 2.0 (2.0) improvement in terms of the light flavoured (\(c\)-) jet rejection are observed at a constant \(b\)-tagging efficiency of 50%, when adding the information on the number of reconstructed vertices in the decay chain and their full kinematical properties. These results confirm the advantages brought by the use of topological and kinematical variables obtained from the JetFitter topological reconstruction strategy,in particular for applications requiring higher levels of \(c\)- and light-jet rejection at intermediate \(b\)-jet efficiencies or as input to a high-level multi-variate tagger, as used in ATLAS.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003.
* [2] ATLAS Collaboration, _ATLAS Insertable B-Layer Technical Design Report_, CERN-LHCC-2010-013. ATLAS-TDR-19 (2010), url: [https://cds.cern.ch/record/1291633](https://cds.cern.ch/record/1291633).
* [3] ATLAS Collaboration, _Early Inner Detector Tracking Performance in the 2015 data at \(\sqrt{s}\) = 13 TeV_, ATL-PHYS-PUB-2015-051, Geneva, 2015, url: [https://cds.cern.ch/record/2110140](https://cds.cern.ch/record/2110140).
* [4] ATLAS Collaboration, _Track Reconstruction Performance of the ATLAS Inner Detector at \(\sqrt{s}=13\) TeV_, ATL-PHYS-PUB-2015-018, Geneva, 2015, url: [https://cds.cern.ch/record/2037683](https://cds.cern.ch/record/2037683).
* [5] C. Patrignani et al., _Review of Particle Physics_, Chin. Phys. C40.10 (2016) 100001.
* [6] ATLAS Collaboration, _Performance of b-Jet Identification in the ATLAS Experiment_, JINST **11**.04 (2016) P04008, arXiv: 1512.01094 [hep-ex].
* [7] R. Fruhwirth, _Application of Kalman filtering to track and vertex fitting_, Nucl. Instrum. Meth. A262 (1987) 444-450.
* [8] M. Cacciari, G. P. Salam and G. Soyez, _The anti-\(k_{t}\) jet clustering algorithm_, JHEP **04** (2008) 063.
* [9] ATLAS Collaboration, _Optimisation and performance studies of the ATLAS b-tagging algorithms for the 2017-18 LHC run_, ATL-PHYS-PUB-2017-013, Geneva, 2017, url: [https://cds.cern.ch/record/2273281](https://cds.cern.ch/record/2273281).
* [10] ATLAS Collaboration, _A neural network clustering algorithm for the ATLAS silicon pixel detector_, JINST **9** (2014) P09009, arXiv: 1406.7690 [hep-ex].
* [11] ATLAS Collaboration, _Measurement of performance of the pixel neural network clustering algorithm of the ATLAS experiment at \(\sqrt{s}\) = 13 TeV_, ATL-PHYS-PUB-2015-044, Geneva, 2015, url: [https://cds.cern.ch/record/2054921](https://cds.cern.ch/record/2054921).
* [12] ATLAS Collaboration, _Performance of the ATLAS Track Reconstruction Algorithms in Dense Environments in LHC Run 2_, Eur. Phys. J. C77.10 (2017) 673, arXiv: 1704.07983 [hep-ex].
* [13] ATLAS Collaboration, _Reconstruction of primary vertices at the ATLAS experiment in Run 1 proton-proton collisions at the LHC_, Eur. Phys. J. C77.5 (2017) 332, arXiv: 1611.10235 [physics.ins-det].
* [14] ATLAS Collaboration, _Vertex Reconstruction Performance of the ATLAS Detector at \(\sqrt{s}=13\) TeV_, ATL-PHYS-PUB-2015-026, Geneva, 2015, url: [https://cds.cern.ch/record/2037717](https://cds.cern.ch/record/2037717).