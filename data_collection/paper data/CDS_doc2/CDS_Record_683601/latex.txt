**European Organisation for Nuclear Research**

ATLAS Internal Note

TILECAL-NO-0xx

23 January 1997

**Studies of internal resolution for 12 bit and 10 bit ADCs in the Tilecal readout electronics**

**Sven-Olof Holmgren and Jorgen Sjolin**

_Stockholm University_Introduction

Cost and power consumption suggest using 10 bit instead of 12 bit ADCs in the Tilecal readout electronics. Hence, the aim of this study is to estimate the consequences to the internal electronics resolution. The result will be a prediction of the measurable internal resolution, channel by channel, that one could expect in a new configuration with 10 bit electronics. However, the internal electronics resolution at the critical high gain saturation energy correlates with a "worst case" scenario for the calorimeter where all the energy is released in one channel (Since there are two channels per cell one could regard that as a safety margin of \(\sqrt{2}\)). Any distribution of the energy among the cells will only improve the resolution from electronics point of view since less energy is likely to be at the most critical values. This "worst case" is not explicitly physical, but serves as a safe upper limit of the expected impact on the overall performance since the electronics resolution is just one of many other effects: photo-electron statistics, e/h, fibre to fibre fluctuations, etc..

## 2 Simple analytical model

In a first attempt to estimate the impact of digital resolution a very basic model was used to enable simple calculations. The model is based on one peak sample, perfectly located in time and read out by a perfect ADC.

The LSB voltage assumes 1 V full swing and the relative gains assume that the overall gain has been adjusted so that the low gain covers the entire energy range.

The resolution given in Table 1 is the resolution in the lower gain channel at the energy where the higher gain saturates. This is the worst case.

The last row in the table gives the expected intrinsic calorimeter resolution at the same saturation energy. This estimate is simply \(4\,7\%/\sqrt{E}\), i.e. neglecting the constant term which is the most conservative assumption one can make.

To get the effect of the digital resolution on a given sample one should add the intrinsic and the digital resolution in quadrature. If we do this for the above examples the resolution in the last column goes from \(5.9\%\) to \(6.1\%\). In all the other places there is no deterioration of the intrinsic resolution.

All this assumes that the contribution from noise can be neglected at the ADC level. The maximum allowed noise indicated in the table is just the LSB divided by \(\sqrt{12}\) at which limit the noise is the same as the RMS error of the sampling.

In reality the energy estimate in one channel is a combination (filter) of up to 7 consecutive samplings which reduce the contribution of the digital resolution since these add in quadrature. But here only one sample is used: the theoretical peak of the pulse. This again is a conservative estimate.

Each calorimeter cell is seen by two independent PMT channels. This reduces the contribution of the digital resolution to the resolution of the overall energy estimate by \(\sqrt{2}\).

For the parameters that go in to the model se Table 1, and resulting Goggiplot Fig. 1.

There are interesting factors left out in this simple model, e.g.: noise and multi sample filters. In order to get closer to the real design, a simulation using real 12-bit data was used to estimate a 10-bit system. This simulation is presented in the next section.

## 3 Simulation based on real data

The base of this simulation is the charge injection (CIS) data taken during the September 1997 test-beam. These data were originally used for calibration of the 12 bit bigain electronics.

The simulation was done within the framework of the Tilemon program. For the 12 bit electronics the compression of the dynamic range was performed by the use of two separate channels with different gains. Since this study concerns with worst case, not averages, only the low gain channel was considered.

To remove the sampling phase dependence of the energy estimator and get closer to the real conditions in ATLAS a sum of 8 samples was used as an energy measure. The samples were equally weighted, that is, the filter was not optimised. However, it turns out to work good enough to reduce the phase dependence below the level of the overall noise.

With the proposed final 10 bit electronics there are two major changes that affect the resolution: the replacement of 12 bit ADCs with 10 bit ADCs and adjustments to ATLAS full range of 800pC (in 1997 data 640pC). A minor effect compensated for is the reduction of the dynamic range due to the pedestal (90 counts in 12 bit 1 997 data and 15 counts assumed for the 10 bit simulated data). These effects are implemented in the following way:

\[ADC_{10}=C*round(\frac{ADC_{12}}{C})\]

where

\[C=\frac{4095-90}{1023-15}*\frac{800}{628}\]

and \(ADC_{10}\) are 10 bit simulated ADC samples and \(ADC_{12}\) are low gain raw data ADC samples.

An important issue that is left out of this study is that from experience it is known that an \(X\) bit ADC does not behave exactly as \(X\) bit, but rather as \(X-\epsilon\) bit. Simulating a 10 bit ADC by rounding a 12 bit ADC probably gets very close to an ideal 10 bit ADC. Reasonable would be to expect an \(\epsilon\) between 0.5 to 1 bit. However, if this degradation mainly is due to noise in the ADC and this noise is lower than the maximum allowed noise (see Table 1), then it should not significantly alter the results of the present study.

## 4 Results

Critical points are the gain switching points. For a gain ratio of 64 between the channels in the 10+10 bit system this will happen at 15 GeV if the muonrequirement is 15 MeV/count. For a 12+12 bit system the critical point will be at 62 GeV. These are to be compared to the intrinsic resolution of the calorimeter for hadrons which is 12% at 15 Gev and 5.9% at 62 Gev assuming \(4\,7\%/\sqrt{E}\) as the hadron calorimeter resolution.

In Figs. 2 and 3 are shown distributions of measured and simulated data. In Fig. 4 measured and simulated resolutions are compared to the detector resolution. Compared to the analytical model 10 bit data agrees much better then the 12 bit data. This is probably mainly due to the fact that a real 12 bit ADC rounded to 10 bit have close to 10 effective bit resolution, while the real 12 bit have 10-11 effective bit resolution. Note also that with the current filter, no improvement beyond one ideal peak sample is reached.

## 5 Conclusion

The internal resolution of a new 10 bit readout system is simulated and compared to the 12 bit readout used in Tilecal 1997 test-beam. The results could be seen as a "worst case". If so, the worst case effect ever to be induced by the 10 bit system for hadrons is a \(2.3\%\oplus 12\%-12\%=0.2\%\) degradation in absolute percent compared to \(0.4\,\%\oplus 5.9\%-5.9\%=0.01\%\) using a 12 bit system.

**General assumption:** for a flat probability distribution in one dimension the Standard Error (RMS) is 1/12 times the sampling pitch.

Under this assumption we investigate the contribution to the energy resolution from a single sampling and for different combinations of bi-gain or tri-gain bit-widths.

**General parameters common to all options:**

\begin{table}
\begin{tabular}{|l|c|} \hline Quantity & value \\ \hline Maximum energy/cal.cell & 2 TeV \\ \hline Maximum energy/PMT chnl & 1 TeV \\ \hline Max carge/PMT chnl & 800 pC \\ \hline LSB for highest gain & 15 MeV \\ \hline Muon energy /cal. cell & 350 MeV \\ \hline Muon energy/PMT chnl & 175 MeV \\ \hline \# counts for muon in high gain & 11 \\ \hline \end{tabular} 
\begin{tabular}{|l|r|r|r|r|r|r|r|r|} \hline  & \multicolumn{2}{c|}{12 + 12 bits} & \multicolumn{2}{c|}{10 + 12 bits} & \multicolumn{4}{c|}{10 + 10 bits} & \multicolumn{4}{c|}{8 + 8 + 8 bits} \\ \hline  & hi & lo & hi & lo & hi & lo & hi & mi & lo \\ \hline Range & 12 & 12 & 10 & 12 & 10 & 10 & 8 & 8 & 8 \\ (bits) & & & & & & & & \\ \hline Gain & 16 & 1 & 16 & 1 & 64 & 1 & 256 & 16 & 1 \\ \hline Max charge (pC) & 50 & 800 & 12 & 800 & 12 & 800 & 3 & 52 & 800 \\ \hline LSB (MeV) & 15.25 & 244 & 15.25 & 244 & 15.25 & 977 & 15.25 & 256 & 3906 \\ \hline LSB (\(\mu\)V) & 244 & 244 & 977 & 244 & 977 & 977 & 3906 & 3906 & 3906 \\ \hline Sat. (MeV) & 62500 & 1 TeV & 15625 & 1 TeV & 15625 & 1 TeV & 3906 & 62500 & 1 TeV \\ \hline \# cnts & 255 & & 63 & 15 & & 15 & 15 \\ at prev & & & & & & & & \\ Sat & & & & & & & \\ \hline Resolut ion at & 0.1\% & & 0.45\% & & 1.9\% & & 1.9\% & 1.9\% \\ Sat & & & & & & & & \\ \hline Max allowed & & 70 & 70 & 282 & & 1000 & 1000 \\ noise (\(\mu\)V) & & & & & & & & \\ \hline Intrinsi c cal res & 5.9\% & & 12\% & & 12\% & & 24\% & 5.9\% \\ at Sat & & & & & & & & \\ \hline \end{tabular}
\end{table}
Table 1: Analytical model configurations.

Figure 1: Analytical resolution for different configurations compared to the detector resolution for hadrons.

Figure 2: Internal resolution (\(\sigma/\mu\)) at the most critical charge (12pC) for the 10+10 bit alternative (2.3%) compared to 10+12 bit (1.1%). One channel example.

Figure 3: Internal resolution (\(\sigma/\mu\)) at the most critical charge (50pC) for the 12+12 bit alternative (0.4%) compared to 10+10 bit (0.7%). One channel example.

Figure 4: Internal resolution for three independent 10+10 bit 12+12 bit channels compared to the intrinsic hadron resolution of the detector at critical energies.