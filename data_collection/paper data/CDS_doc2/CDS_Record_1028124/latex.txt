ATLAS

ATL-LUM-PUB-2007

April 2007

**Spatial Resolution Study of ALFA from the CERN Testbeam in 2006**

**S. Ask**

_CERN (Switzerland)_

**S. Hoffmann**, **H. Stenzel**

_II. Physikalisches Institut, Justus-Liebig-Universitat, Giessen (Germany)_

The Roman Pot units located at a distance of 240m on each side of the ATLAS interaction point will be equipped with a scintillating fiber tracker system called ALFA (Absolute Luminosity For ATLAS). The main purpose of the ALFA system is to determine the absolute luminosity of ATLAS from elastic proton scattering at very small angles. This note describes in detail the spatial resolution study of ALFA that was performed using the data from the beam test at CERN in October 2006. The resolution performance was studied for a first ALFA prototype in the DESY testbeam in November 2005, but using off-the-shelf electronics and a 6 GeV electron beam. At the CERN testbeam a new ALFA prototype was operated with a first version of the dedicated ALFA front-end electronics and exposed to a hadron beam with energy up to 230 GeV. The resolution study shows an adequate tracking capability of ALFA using the first version of the front-end electronics and a new method to obtain alignment information is described.

Introduction

The Roman Pot detectors in ATLAS are planned to measure the absolute luminosity by tracking elastically scattered protons at very small angles [1]. For this purpose a scintillating fiber tracker system called ALFA (Absolute Luminosity For ATLAS) has been chosen, based on scintillating square fibers read-out by multi-anode photomultipliers (MAPMT) [2]. The spatial resolution of the tracker has to be significantly smaller than the beam spot at the detector, \(130\mu m\), in order not to limit the luminosity measurement and the design goal was therefore a resolution of about \(30\mu m\) or better.

### Motivation for the CERN Testbeam

The detector design was tested in a beam test at DESY in November 2005 where the detector performance was shown to be adequate for the luminosity measurement. The DESY testbeam was, however, carried out using a 6 \(GeV\) electron beam which is significantly different from the 7 \(TeV\) protons at the LHC. In addition the ALFA prototype used at DESY was operated with analog standard off-the-shelf electronics (CAEN QDCs etc.) which can not be used at the final location inside the LHC tunnel, 240m away from the ATLAS interaction point. For these reasons a second beam test of ALFA was organized at CERN in October of 2006 where a new ALFA prototype was used in a hadron beam with energy up to 230 \(GeV\). The new prototype (called ALFA_10\(2\)16, due to the 10 fiber planes with 16 fibers per \(u\) and \(v\) layer) was used with a first version of the binary front-end (FE) electronics dedicated for ALFA. The new prototype had more fibers than the one used at DESY, which allowed for a more complete test of the FE electronics (a full 5\(\times\)MAPMT array). The CERN testbeam setup is described in more detail in [3, 4].

Figure 1: The ALFA resolution as a function of beam energy. The plot shows the resolution measured at the DESY testbeam in 2005 together with the expected resolution obtained by GEANT4 simulations of ALFA [5].

The resolution performance obtained at the DESY testbeam was significantly degraded by the relatively low energy electron beam. Figure 1 shows the ALFA resolution measured in the testbeam as a function of the beam energy. This measurement was consistent with GEANT4 simulations of the detector [5] and it was shown that the resolution performance of ALFA was mainly decreased due to multiple scattering. The simulation together with the measured resolution of ALFA was also used to estimate the expected performance for a high energy hadron beam. In the scenario of the second testbeam the degrading effects from multiple scattering was indicated to be negligible. The estimated resolution for ALFA if exposed to a \(230\)\(GeV\) proton beam was about \(20-25\)\(\mu m\).

The fact that the ALFA prototype was operated with the first version of the front-end electronics at the CERN testbeam implied a quite different data quality compared to the DESY testbeam. Several small imperfections were found which will be corrected in the next version. Also a higher noise hit contamination of the data was observed than when using the conventional electronics at DESY. Figure 2 shows the hits of two events from the CERN testbeam. The left plot shows a good ALFA event where one fiber per layer is hit1, with the exception of layer 5 where a hit is missing and layer 19 where an additional noise hit is present. The missing hit in layer 5 is consistent with the approximately \(90\%\) fiber detection efficiency of the ALFA detector when operated at \(950\)V. The right plot of figure 2 on the other hand shows a very noisy event which have many layers with multiple hits. The presence of this kind of noisy events requires a more sophisticated track reconstruction algorithm, in order to maintain a high reconstruction efficiency for a given resolution. Hence the "real track" is harder to find compared to the DESY testbeam data where the noise level was very low. The impact on the resolution performance will be discussed below, however, the noise and cross talk is investigated in a parallel study of the CERN testbeam data and will not be discussed further here.

Footnote 1: Odd layer numbers corresponds to the so-called \(u\)-fibers and even to the \(v\)-fibers.

## 2 Track Reconstruction Algorithm

The ALFA track reconstruction was organized in two stages. In the first stage hit candidates were selected by using a Hough transform method [7]. The selected hit candidates were then used by the so-called minimum overlap algorithm (see below) to reconstruct the point in the \(x-y\) plane where the particle transversed ALFA. Here \(x\) and \(y\) are the horizontal and vertical axis in the plane parallel to the ALFA layers. In the absence of a magnetic field the track was

Figure 2: Hits, layer vs fiber numbers, of two events from the CERN testbeam.

assumed to be well described by a straight line. In addition to the mapping of the data thorough the electronics and MAPMT channels to the fibers, the reconstruction is based on the individual position of each fiber. The position of each fiber inside the active area of ALFA, i.e. where the \(u\) and \(v\) fibers overlap, was obtained by a metrology measurement of the ALFA prototype [6]. In the output of the metrology measurement each fiber, \(i\), is represented by a straight line equation, \(y=a_{i}\cdot x+b_{i}\), with respect to the location of a high precision positioning pin which also takes care of the internal staggering alignment of the ALFA layers.

### The Hit Candidate Selection

The hit candidate selection of the first reconstruction stage is based on a so-called Hough transform. The hit candidates were selected in the \(z-u\) and \(z-v\) planes individually, starting from two histograms where the \(u/v\) and \(z\) coordinates were scaled to the ranges 0-16 and 0-10, i.e. approximately the layer and fiber numbers,

\[u\ (or\ v)=-\frac{b_{i}-b_{min}}{\Delta u};\ z=\frac{z_{i}-z_{min}}{\Delta z} \tag{1}\]

where \(\Delta u=\Delta v=1/\sqrt{2}\ mm\) and \(\Delta z=2.5\ mm\). Figure 3 shows the corresponding \(z-u\) histograms of the two events in figure 2.

In order to derive a "seed track" from the event, to base the hit selection on, the \(z-u\) and \(z-v\) histograms are analyzed by a Hough transform. The Hough transform associate a point \(P\) in the \(z-u\) plane2 with all straight lines that intersects \(P\). Any such line \(L\) can be represented by the parameters \(r\) and \(\theta\),

Footnote 2: The following \(z-u\) hit selection discussion is equivalent for the \(z-v\) hits.

\[r=z\cdot\cos\theta+u\cdot\sin\theta \tag{2}\]

where \(r\) is the distance along the normal of \(L\) to the point (\(z=5,u=0\)) and \(\theta\) is the angle between the normal of \(L\) and the \(z\)-axis. Hence each point in the \(z-u\) plane is represented by a curve in the \(\theta-r\) plane, corresponding the manifold of possible intersecting lines. To obtain the seed track each hit in the \(z-u\) histogram was used to compute a curve in a \(\theta-r\) histogram, from 32 equidistant values of \(\theta\) between \(\pi/4\) and \(3\pi/4\), i.e. \(\pm 45^{\circ}\) of the incoming track with respect to the \(x-y\) plane. The straight line in the \(z-u\) plane which intersects most hits then corresponds to the bin in the \(\theta-r\) histogram with the most entries. This line is also chosen as the seed track. This is illustrated by the \(\theta-r\) histograms in figure 4 which corresponds to the \(z-u\) histograms in figure 3.

Figure 3: \(z-u\) histogram for the two events shown in figure 2.

As in figure 3 it is relatively easy to define an approximate seed track for the clean event in the left plot which have its maximum bin at (1.45,11.25). The choice of seed track for the noisy event in the right plot is, however, a bit more ambiguous, where the maximum bin at (1.6,10.25) is used.

After the seed track is determined it is used to select the hit candidates. This is done by selecting the closest hit in each layer, under the condition that the hit is within 2 fiber distances away from the seed track. This gives an output from the first track reconstruction stage consisting of at maximum one hit candidate per layer where the \(u\) and \(v\) hits have been selected separately.

### The Minimum-Overlap Algorithm

The so-called minimum-overlap algorithm has been used previously both for the ALFA resolution study of the DESY testbeam and to characterize the tracker based on the metrology measurements [2, 6]. For this reason the same algorithm was also used here to simplify the comparison between different results.

The basic principle of the algorithm is to determine the point in the \(x-y\) plane where the particle transversed based on the minimum overlapping \(x-y\) window from the selected fibers. The 2-dimensional track reconstruction makes it less precise for particles entering with a non-perpendicular angle with respect the the ALFA layers, however, after alignment this is not significant due to the small divergence of the beam. Due to the required overlap between hits, this algorithm is relatively insensitive to selected "out-layers" caused by noise.

In more detail, the algorithm is calculating the minimal-overlap for the \(u\) and \(v\) fibers separately. The overlap is determined from the \(b_{i}\) values of the participating fibers where an upper and lower \(b\) value is determined from the fibers which allows the smallest overlapping \(b\) range taking into account the fiber thickness. The upper and lower \(b\) limits obtained for the \(u\) and \(v\) fibers are then used together with the average slope of the fibers involved to compute the central point of the overlapping area. This point then corresponds to the reconstructed \(x-y\) coordinate where the particle transversed ALFA.

## 3 Resolution from ALFA Stand-Alone

In this study the tracks were reconstructed by ALFA as two independent track segments, using planes 1-5 (layers 1-10 = H1) and planes 6-10 (layers 11-20 = H2) separately. In this way the

Figure 4: Histograms of figure 3 Hough transformed to \(\theta\) vs \(r\).

ALFA resolution can be studied without an external tracking detector, however, with limited possibilities to estimate the efficiency. In the following we call this method the stand-alone method. For this study events were only used if their \(x-y\) position was within a 2 \(mm\) radius from the center of ALFA. This ensured that the selected particles transversed a region of ALFA where all 20 layers physically overlap. All the following studies were done for both the \(x\) and \(y\) coordinates, but for simplicity only one will be discussed if the the results for the other were the same.

To confirm the importance of a good hit selection the Hough transform method was compared to a selection where simply the first hit found in each layer was selected. In this case it is much more frequent that a noise hit, which will worsen the track reconstruction, is selected instead of a true hit. Figure 5 shows \(x\)-coordinate residuals of the two track segments reconstructed by the two halves of ALFA. The left plot corresponds to the tracks where the simple hit selection was used and one can clearly see a large amount of badly reconstructed tracks. The right plot shows the same reconstructed residual histogram when using the Hough transform method. One can see how the badly reconstructed tracks are almost eliminated and also how the width of the main peak has decreased.

During the beam test a number of runs were taken at different angles of ALFA with respect to the beam. These runs were taken with the MAPMTs of ALFA operated at \(900V\) and the detector was rotated around the \(x\) and \(y\) axis. The runs were analyzed based on the mean value and sigma of the \(H1-H2\) track residual distributions. Figure 6 shows the mean of the residual distribution as a functions of the rotation angle with respect to the original position of ALFA. The left plot shows the mean from the reconstructed \(x\) and \(y\) coordinates as a function of the rotation angle, \(\theta_{x}\), around the \(x\)-axis and the right plot corresponds to different \(\theta_{y}\) angles.

Since the overlap algorithm is reconstructing \(x\) and \(y\) coordinates under the assumption that the tracks are perpendicular to the ALFA planes, the presence of an angle will imply a systematic shift between the coordinates from \(H1\) and \(H2\). This shift should be in the order of \(12.5\ mm\cdot\tan\theta\), also seen in figure 6, due to the \(z\)-distance between the two halves, \(d_{H1-H2}=12.5\ mm\).

The angular scan was first done for the \(\theta_{x}\) angle and after aligning the detector to a rough online estimate of the optimal angle the scan was done for \(\theta_{y}\). This can also be seen in figure 6 where the mean of the \(x\)-coordinate has a constant shift of about \(60\mu m\) for the \(\theta_{x}\) scan, indicating an angle in \(\theta_{y}\) in the order of 5 \(mrad\). The \(\theta_{y}\) scan on the other hand was done with an aligned \(\theta_{x}\) angle and the mean of the reconstructed \(y\)-coordinate is constant and close to zero. In both scans the optimal angle can be found from the point where the mean of the

Figure 5: \(x\)-coordinate residuals from the ALFA stand-alone study. For the left plot a simple hit selection was used and for the right plot the Hough transform method was used.

reconstructed coordinate that is affected by the rotation (i.e. \(x\) for the \(\theta_{y}\) rotation and vice versa) is zero.

The angle scan was also studied in terms of the obtained \(H1-H2\) track residual distribution sigma. Figure 7 shows the \(x\) and \(y\) residual sigma as functions of \(\theta_{x}\) and \(\theta_{y}\). One can clearly see the minimum which coincides with the results obtained from the study of the distribution mean and the results based on the reconstructed \(x\)- and \(y\)-coordinates differ at most about \(3\%\).

It should be stressed that the stand-alone method, and especially studying the mean of the \(H1-H2\) distribution, provide a sensitive tool to determine the perpendicular alignment of ALFA with respect to the incoming particles and this will also be useful information when finally operating in the LHC.

After the alignment of ALFA to the beam, high statistics runs were taken which were used for the ALFA resolution study using the stand-alone method. High statistics runs were taken with \(\theta_{x}=2\)_mrad_ and \(\theta_{y}=-7.5\)_mrad_ with respect to the original position of ALFA and with the MAPMTs operated both at \(900\)\(V\) and \(9\,50\)\(V\).

Figure 5 was obtained using data from the high statistics runs taken at \(950V\) and a Gaussian fit to the right plot distribution gives a \(\sigma=55\pm 0.3\)\(\mu m\) (error only contains statistical error from the fit). As both half detectors are practically identical the spatial resolution of each of

Figure 6: The mean of the \(H1-H2\) residual of the reconstructed coordinate (\(x\) corresponds to the solid line and \(y\) the dashed line) as a function of the \(\theta_{x}\) and \(\theta_{y}\) angles.

Figure 7: The sigma of the \(H1-H2\) residual of the reconstructed coordinate (\(x\) corresponds to the solid line and \(y\) the dashed line) as a function of the \(\theta_{x}\) and \(\theta_{y}\) angles.

them is expected to be \(\sigma_{H1}=\sigma_{H2}=55/\sqrt{2}\sim 39\ \mu m\). Comparison with the output of the geometrical Monte-Carlo (MC) code used in [6] allows to interpret the measured value. Figure 8 shows the results from this MC, with the as-measured detector geometry as input. In the left plot the same stand-alone analysis was done with the MC data as previously for the real data, where as for the right plot the residual was based on the reconstructed \(x\)-coordinate from the full detector and the true track coordinate value. As shown in the plots the MC code predicts a half detector resolution of \(\sigma_{H1}^{MC}=44/\sqrt{2}=31\ \mu m\) and a full detector resolution of 20 \(\mu m\).

The ultimate theoretical resolution of ALFA with a total of \(2\times 10\) (or half, \(2\times 5\)) layers is \(500/(10\cdot\sqrt{12})=14.4\ \mu m\) (\(28.8\ \mu m\) for half). From the MC simulations of the ALFA_10\(2\)16 detector it was estimated that the geometrical imperfections of the detector contributes with about \(\sigma_{geo}\sim 14\ \mu m\) to the obtained spatial resolution. From this the interpretation of the measured half detector resolution into full detector resolution was done in the following way,

\[\sigma_{ALFA}=\frac{\sigma_{H1}\odot\sigma_{geo}}{2}\oplus\sigma_{geo}=\frac {\sqrt{\sigma_{H1}^{2}+3\cdot\sigma_{geo}^{2}}}{2} \tag{3}\]

Based on this formula the measured half resolution of \(39\ \mu m\) indicates a full detector resolution of about \(23\ \mu m\).

The impact from a number of systematic effects have also been studied. From the MC results, \(\sigma_{geo}\) was estimated in several different ways. These gave values between \(\sigma_{geo}=12-17\mu m\) which imply a full ALFA resolution between \(22-24\mu m\). The same Gaussian fit as shown in figure 5 was done for four equivalent runs taken at \(950\ V\) which all gave consistent results and a RMS spread of less than \(1\ \mu m\) for both the measured \(x\) and \(y\) resolutions. Secondly the impact from different ranges of the Gaussian fit was studied. The fit was made with ranges around the mean of \(\pm 2\sigma\) up to \(\pm 8\sigma\). The effect on the resolution from badly reconstructed tracks in the tail was less than \(55\pm 3\ \mu m\) which implies an effect on the full ALFA resolution of \(23\pm 1\ \mu m\). A rough test of any potential degraded performance in the edge region was done by comparing the obtained resolution from tracks in the central region of ALFA to tracks within a distance of \(1\ mm\) from the beam approaching edge. The selected regions were based on the reconstructed area of ALFA where the trigger clearly cover the edge region. No degrading effect could be observed. Finally the resolution was also studied using the high statistics data taken at \(900\ V\) under nominal alignment, discriminator and amplification conditions. The resolution was again studied using four equivalent runs which all showed an increased resolution from \(55\) to \(59\ \mu m\). This imply t

Figure 8: z-coordinate residuals from a geometrical Monte-Carlo. The left plot corresponds to the results from the stand-alone method and the left to the residuals from the tracks reconstructed by the full detector and true track information.

an increase of the full ALFA resolution of slightly more than 1 \(\mu m\). The total systematic error from the contributions discussed above corresponds to \(\pm 2\mu m\).

The resolution was also studied using additional more stringent cuts, but for example the requirements of having 16 to 22 hits per events and no more than 2 layers with more than one hit improved the full detector resolution with only about 1 \(\mu m\) at the same time as the reconstruction efficiency was decreased by a factor two. The residual distribution of these cleaner events, however, resulted in that the resolution became less sensitive to the fit range. The variation of the fit range (again from \(\pm 2\sigma\) to \(\pm 8\sigma\)) decreased the systematic error from 1 \(\mu m\) to about \(\pm 0.3\)\(\mu m\) for the full ALFA tracker.

## 4 Resolution and efficiency from ALFA and the RD42 Si-Telescope

During the regular ALFA testbeam period a dedicated reference tracking detector was not available, but a few runs could be taken with track information from a high precision telescope with which the RD42 collaboration performed measurements about 1 \(m\) upstream of the ALFA set-up. For these runs the data acquisition systems of the two experiments were synchronized. The telescope was mounted in front of the ALFA set-up and the tracks reconstructed by the telescope were extrapolated to the \(z\)-position of ALFA. After a software alignment of the telescope and ALFA coordinate systems the tracks positions of both systems could be directly compared. For ALFA the tracking algorithm outlined in Section 3 was used to calculate track positions both with the full detector and again with the two detector halves. Two scenarios were considered, in the first the efficiency was optimized and only loose cuts were applied, requiring a successful reconstruction. In the second scenario tighter cuts were applied on the number of layers with more than one hit and on the total amount of hits. With these quality cuts the resolution was optimized. In order to determine the efficiency of ALFA a fiducial area was selected with the telescope on the surface of ALFA, which ensure that the particles are contained within the detection volume. Four runs were available for this analysis in two groups at different positions, the fiducial volume was optimized for each group.

In a first step the positions from the half-detectors were compared to telescope positions, and knowing the ALFA half resolution \(\sigma_{H}\), the resolution of the telescope \(\sigma_{B}\) at the position of ALFA was determined. The distance between the telescope and ALFA was about 1 m and the intrinsic resolution of about 10 \(\mu m\) inside the telescope degrades to the observed telescope resolution of about 46 \(\mu\)m in \(x\) and to 66 - 77 \(\mu m\) in \(y\) at the ALFA position. The performance of the telescope depends on the irradiated region of the telescope for the vertical coordinate, which explains the observed range of resolution. In a second step the tracks from the full ALFA detector were compared to the telescope prediction, from the residual distributions and after subtraction of

\begin{table}
\begin{tabular}{|c|c|c|} \hline  & reconstruction cuts & quality cuts \\ \hline \(\sigma_{H}\) [\(\mu\)m] & 56 \(\pm\) 3 & 51 \(\pm\) 2 \\ \hline \(\sigma_{B}\) [\(\mu\)m] & 46\(\pm\)2 in \(x\) and 66–77 \(\pm\)4 in \(y\) \\ \hline \(\sigma_{ALFA}\) [\(\mu\)m] & 26 \(\pm\) 3 & 25 \(\pm\) 3 \\ \hline Efficiency [\%] & 96 \(\pm\) 3 & 56 \(\pm\) 3 \\ \hline \end{tabular}
\end{table}
Table 1: Resolution (averaged over \(x\) and \(y\)) and efficiency.

the calculated telescope contribution the spatial resolution for ALFA was extracted and at the same time the ALFA efficiency was determined, as summarized in Table 1.

It can be concluded that with basic reconstruction cuts a good detection efficiency above 95% was obtained with a spatial resolution of about 26 \(\mu m\). The resolution improves marginally for the full detector when quality cuts were applied while the efficiency drops drastically. As a caveat the modest telescope resolution and the limited statistics must be mentioned, which is reflected in the errors in Table 1 obtained from the spread of results using different runs.

## 5 Conclusions

The testbeam data recorded at CERN in 2006 have been used to study the spatial resolution performance of the scintillating fiber tracker ALFA. The requirement of ALFA for the absolute luminosity measurement in ATLAS is a spatial resolution of about 30 \(\mu m\) or better and the expected performance in a high energy hadron beam, based on previous tests using an 6 \(GeV\) electron beam is about \(20-25\)\(\mu m\). The main purpose of the 2006 testbeam was to prove that ALFA could be operated with the first version of the front-end electronics and to study the performance in a high energy hadron beam which is more similar to the situation in the LHC. Unfortunately a dedicated high precision tracker was not available during the period of the CERN testbeam, however, a few runs could be taken together with the RD42 collaboration, which had a Si-telescope mounted in front of the ALFA setup, at the end of the testbeam period.

By using a stand-alone method, where two track segments were reconstructed by two halves of ALFA, the spatial resolution could be studied independently of an external tracking detector. The results from this method, together with additional information from a detector MC, was interpreted into a resolution of the full ALFA detector of \(23\pm 2\mu m\). It was also shown that the stand-alone method provides detailed information about the perpendicular alignment of ALFA with respect to the beam. In the presence of an angle between the beam and the normal of the ALFA layers, the tracking algorithm implies a systematic shift between the reconstructed coordinates from the two halves. This shift can be used to study the ALFA alignment at a precision of a few _mrad_.

In addition the spatial resolution together with the corresponding reconstruction efficiency was studied by including the RD42 telescope information. A resolution of \(26\pm 3\)\(\mu m\) was obtained with a reconstruction efficiency of \(96\pm 3\%\). By introducing additional quality cuts the resolution only improved to \(25\pm 3\)\(\mu m\) where as the efficiency decreased to \(56\pm 3\%\).

## 6 Acknowledgment

We would like to thank the people from the SPS experimental area and beam support team for their help with the H8 beam. We in particular appreciate the help from the RD42 collaboration with the combined runs and providing us with their data from the Si-telescope.

## References

* [1]_ATLAS Forward Detectors for Measurement of Elastic Scattering and Luminosity Determination_, ATLAS TDR, in preparation; _ATLAS Forward Detectors for Luminosity Measurement and Monitoring_, CERN-LHCC/04-10, LHCC I-014.
* development, construction and test of scintillating fibre prototype detectors_, Nucl. Instr. and Meth. **A568** (2006) 588-600.
* 2006 Nuclear Science Symposium (session N29-1), 1 Nov 06, San Diego.
* [4] B. Di Girolamo, _Luminosity measurement at ATLAS with Roman Pots and Scintillating Fibre Detectors_, Proceeding of the 11th Vienna Conference on Instrumentation, 19 Feb 07, Vienna.
* [5] V. Vorobel and H. Stenzel, _GEANT4 simulation of the testbeam set-up for the ALFA detector_, ATL-LUM-PUB-2006-006.
* [6] A. Braem _et al._, _Metrology results of the ALFA 2006 prototype detectors_, ATL-LUM-PUB-2006-007.
* [7] P. Hough, _Method and Means for Recognizing Complex Patterns_, U.S. Patent 3,069,654, 1962; R.O. Duda and P.E. Hart, _Use of the Hough Transform to Detect Lines and Curves in Pictures_, Comm.ACM, Vol. 15 (1972) 11-15.