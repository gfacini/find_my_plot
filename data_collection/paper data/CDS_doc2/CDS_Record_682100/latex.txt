**ATLAS Internal Note**

**LARG-NO-82**

**September 19th 1997**

**Analysis of test beam data taken with the OSAM readout system**

E. Auge, O. Dore, I. Nikolic, G. Romet-Lemonne

Laboratoire de l'Accelerateur Lineaire,

IN2P3-CNRS et Universite Paris-Sud

91405 Orsay Cedex, France.

**Abstract**

We present the analysis of test beam data recorded in june 1996 with the 2 meter accordion calorimeter prototype in the H8 beam line at CERN. The calorimeter was readout by a prototype system designed by an Orsay-Saclay-Annecy-Marseille (OSAM) collaboration. This system is based on a switched capacitor array (SCA) designed in Orsay/Saclay.

Introduction

We present the analysis of test beam data recorded in june 1996 with the 2 meter accordion calorimeter prototype in the H8 beam line at CERN. The calorimeter was readout by a prototype system designed by an Orsay-Saclay-Annecy-Marseille (OSAM) collaboration. This system is based on a switched capacitor array (SCA) designed in Orsay/Saclay.

### Description of the system

The system consists of five identical front-end boards plus a controller board. A detailed description may be found in [1]. Each front-end board was designed to be connected to two existing bi-gain shaper boards. As a result, a front-end board treats 24 calorimeter cells, with two channels per cell (one per shaper gain). Furthermore, since each SCA chip carries 16 channels, 12 of them are indeed connected to shaper outputs whereas the 4 others have their input connected to ground. All 16 channels are readout, and a front-end boards carries 32 bi-gain channels (4 SCA chips).

Since the cables between the shapers and the SCAs are long (10 meters), it is necessary to have a 50 Ohms adaptation at the input of the front-end boards. As a result, the range of the signals at the input of the SCAs is less than 2 Volts, which does not match the SCAs' one (4 Volts). We have an extra amplifier stage at the input of the front-end boards, which also allows to adjust the gain ratio to approximately 16 (we obtained 14.2 in reality). Unfortunately, because we power it with 5 Volts, this amplifier saturates at 3 V above reference, slightly before the SCA.

The signal at the input of each SCA channel is permanently sampled at 40 MHz. The resulting voltage is written in the memory (i.e. stored in one of the 128 capacitors). The samples corresponding to an interesting event (trigger received by the controller board) are later read back from these capacitors. This operation does not interrupt the writing in the SCA, which behaves as a real dual-port memory.

Every 25 ns, the controller board provides all the SCA chips with the address where the present time sample is stored (write address, between 0 and 127). When the controller board receives a trigger signal, it determines the address of 5 consecutive time samples which will be read form the SCAs and digitized. The controller is also in charge of providing the signals to control the read procedure ("read sequence"). It is connected to the front-end boards by a special bus on the backplane.

Although it was not needed, we artificially delayed the trigger signal in the controller such that SCA readout starts 2 micro-seconds after the data were written. (i.e. almost ATLAS-like conditions).

For each calorimeter cell, for each sample read, the voltage from the high gain SCA channel and the one from the low gain SCA channel are read simultaneously. The high gain signal is compared to a tunable threshold voltage to determine whether the saturation has been reached. In this case, the low gain signal is sent to the ADC. Otherwise, the high gain signal is digitized. We may also force the gain switching logic to always use the same gain. It is however not possible to read and digitize both the high and the low gain data for all channels.

For a given time sample, we multiplex the 16 channels corresponding to each SCA chip, choose the correct gain and stabilize the relevant signals at the input of each ADC at 10 MHz. We therefore use two 12 bit 10 MHz ADC (SPT972) per board (one per couple of SCA chips).

To minimize systematic perturbations to the analog signals from the various control signals, which contribute in particular to the coherent noise of the system, each SCA chip is equiped with 4 "reference channels", one per group of 4 normal channels. When reading a time sample from one of the 16 normal channels, the signal at the same read address from the nearest reference channel is subtracted before digitization. In first approximation, this eliminates the perturbations which are identical (coherent) for all channels in the chip, and has consequences on the pattern of the coherent noise as well as on the cross-talk.

For the runs analysed below, the ADC data were buffered and read by VME. The dead time in the trigger was such that there was no activity on the VME backplane while the samples corresponding to an event were written in the SCA, nor while they were read from the SCA and digitized.

### Description of the test beam data

Data a have been recorded with the 2 meter prototype in the H8 beam during 5 days in june 96. Electrons of energies 20, 50, 100, 150, 200 and 300 GeV have been recorded, shooting at \(\eta=4\), \(\phi=12\). A few runs were also taken at \(\eta=8\), \(\phi=12\). Pedestal and Testpulse runs were also taken. The high gain SCA channel corresponding to the calorimeter cell at \(\eta=5\), \(\phi=13\) in the front layer was broken.

In the test pulse runs, the analog signals from the pulser were synchronous with the 40 MHz clock of the system, and the timing was such that the third sample in the SCA was falling at the maximum of the signals. In the electron runs, the physics trigger was selecting electrons such that the third sample was falling close to the maximum of the signal (in practice 1.5 to 4.5 ns after the maximum).

## 2 Optimal filtering

For each event, N samples (5 in the present data) per channel are recorded. Furthermore, the signal shape is always the same except for a scale factor. The optimal filtering method gives the weights to be used when combining linearly the N samples in order to obtain the best signal/noise ratio. This is explained in details in [2].

In our case, the signals are almost synchronous with the sampling clock. Neglecting any jitter, the measurement of the energy in a cell is written :

\[E=\sum_{i=1}^{N}a_{i}s_{i}\ =\ A\sum_{i=1}^{N}a_{i}g_{i}+\sum_{i=1}^{N}a_{i}n_{i}\]

where \(s_{i}\) is the signal sampled at time \(t_{i}\), as read in the data, \(n_{i}\) is the noise and \(g_{i}\) the normalized noiseless signal. A is the amplitude of the signal, to be measured with the best possible accuracy. The coefficients \(a_{i}\) are obtained by minimizing the variance of S over a large number of events, with the normalisation constraint \(\sum_{i=1}^{N}a_{i}g_{i}=1\). We obtain

\[a_{i}\propto\sum_{i=1}^{N}(R^{-1})_{ij}g_{j}\]

where R is the noise autocorrelation matrix : \(R_{ij}=<n_{i}n_{j}>\) (average over the events). The proportionality factor is given by the normalisation constraint.

The signal shape and its phase with respect to the 40 MHz clock varies slightly among the calorimeter cells. In the beam region, for the high gains, the shape of the electron signal, measured in a nonet (3\(\times\)3 cells in the front layer + 3\(\times\)3 in the middle layer + 2\(\times\)3 in the back layer) is :

\[g_{1}=0.005\ ;\ g_{2}=0.349\ ;\ g_{3}=1.000\ ;\ g_{4}=0.504\ ;\ g_{5}=0.098\]

We have used the same parameters for all cells considered in the analysis. The noise autocorrelation matrix is (for the nonet, for high gain) :

\[R=\left(\begin{array}{rrrr}0.98&-0.09&-0.16&-0.03&0.04\\ -0.09&0.94&-0.07&-0.17&-0.04\\ -0.16&-0.07&1.00&-0.05&-0.17\\ -0.03&-0.17&-0.05&0.98&-0.07\\ 0.04&-0.04&-0.17&-0.07&0.95\end{array}\right)\]

The precision is estimated to be \(\pm\)0.02 for the diagonal terms in \(R\) and \(\pm\)0.014 for the off-diagonal ones. The statistical error on the \(g_{i}\) is less then 0.002.

The set of optimal coefficients for high gains is then :

\[a_{1}=0.147\ ;\ a_{2}=0.347\ ;\ a_{3}=0.657\ ;\ a_{4}=0.398\ ;\ a_{5}=0.212\]

See [3] for the detailed analysis, and [4] for a precise comparison with theoretical expectations and a discussion of the noise components.

## 3 Noise performances

For channels connected to high gain shapers, the noise per sample is of the order of 1.5 mV (equivalent to 56 MeV). It is 0.95 mV (507 MeV) for the low gain channels, and 0.85 mV (32 MeV) for the unconnected ones. Later hardware improvements on the boards have decreased this last number to 0.65 mV (24 MeV) with the system re-installed in Orsay.

### Fixed Sequence noise

In this paragraph, we consider systematic effects that appear as noise if they are not properly corrected.

Because of the sequence of operations to write a sample in the SCA chip, which takes 125 ns (5 clock cycles), some perturbations of the sampled signals depend on the series of successive values of the write address at write time. Other perturbations depend on the value of the write address at various steps during the read operation. Because we record only one event at a time, these perturbations appear as a systematic shift of the pedestal as a function of the address in the analog memory : if we calculate the pedestal separately for each memory location, we obtain 128 different values for each SCA channel. The above mentionned effects are responsible for some dispersion among those 128 values, generically called Fixed Sequence noise. This indeed appears as a noise component if we use a single average pedestal value per channel or if the sequence of write addresses is almost random. The subtraction of reference channels before digitization decreases these effects by a factor 5, and we observe only a residual effect, which does not contribute to the coherent noise. Figure 3.1 shows the observed dispersion as a function of the channel number for all five boards. It is of the order of 0.3 mV (11 MeV) and may be neglected.

For each SCA channel, we also observe a pedestal difference between the first sample and the others. This effect is the same in all SCA chips and varies with the channel number in the chip between +0.6 or -0.6 mV. The contribution (when not corrected for) to incoherent noise is negligible, but it spoils the coherent noise estimates, based on sums and alternate sums over channels. Later measurements with the system re-installed in Orsay show that this is related to the switch connecting the read bus in the SCA chip to the reference voltage, which remains open for a long time between two events. We eliminate this effect by a modification of the read sequence.

In the end we observe that, for a few channels in each chip, the pedestal for a specific sample is shifted down by 0.4 mV. This has a negligible impact on noise (incoherent or coherent) and is attributed to interference with signals controlling the data movements into the buffer used for later VME access.

### Coherent/incoherent noise per sample

In this section, we use pedestal runs with forced high gain, considering each sample of each event independantly from each other.

We use a simple model with incoherent noise affecting each SCA channel independently plus coherent noise, which shifts each channel in a sample by the same amount. This component does not contribute to the dispersion over the events of an alternate

Figure 1: _Fixed Sequence Noise in mV as a function of channel #_

sum over the channels (adding signal from even channels, subtracting the one from odd channels) whereas the incoherent component contributes equally to the dispersions of the sum and of the alternate sum.

Because of the subtraction procedure before digitization, the noise of each reference channel is expected to appear as a coherent contribution within each set of 4 SCA channels sharing the same reference channel.

We can in principle separate the coherent from the incoherent noise components for any set of channels (in even number), such as an SCA chip, a board and the full system. The results can however not reliably be used for large sets of channels because of the the shift in the pedestals for the first sample in each event, as mentionned in the previous paragraph.

We have nevertheless calculated for each layer the correlation matrix corresponding to the nonet centered on the beam spot : \(V_{ij}=<E_{i}E_{j}>-<E_{i}><E_{j}>\), where i and j run from 1 to 9, and label calorimeter cells. As an example, the matrix for the front layer is :

\[V=\left(\begin{array}{rrrrrrrr}2.29&0.03&0.05&0.08&-0.03&0.03&0.01&0.06&0.01\\ 0.03&2.06&0.11&-0.03&-0.05&-0.01&0.04&0.06&0.06\\ 0.05&0.11&1.78&0.06&0.03&0.00&0.09&0.07&0.09\\ 0.08&-0.03&0.06&2.70&\mathbf{0.19}&0.10&\mathbf{0.17}&0.01&0.02\\ -0.03&-0.05&0.03&\mathbf{0.19}&2.91&-0.02&\mathbf{0.12}&0.03&0.02\\ 0.03&-0.01&0.00&0.10&-0.02&2.17&0.02&\mathbf{0.17}&0.08\\ 0.01&0.04&0.09&\mathbf{0.17}&\mathbf{0.12}&0.02&2.90&0.06&-0.01\\ 0.06&0.06&0.07&0.01&0.03&\mathbf{0.17}&0.06&2.60&0.09\\ 0.01&0.06&0.09&0.02&0.02&0.08&-0.01&0.09&1.75\end{array}\right)\]

The statistical uncertainty is 0.06 for the diagonal terms, and 0.04 for the off-diagonal ones.

The diagonal terms are of the order of 2.35, corresponding to a noise contribution of 1.5 mV (56 MeV) per cell. The coefficients in bold correspond to cells sharing the same reference channel. Those terms are of the order of 0.16, larger than the other off-diagonal terms. From them, we infer that the noise of the reference channels is of the order of 0.4 mV (15 MeV) and is the dominant contribution to the coherent noise.

Noting \(\sigma_{t}\) the total noise for the 9 cells, we have \(\sigma_{t}^{2}=\sum_{i,j}V_{ij}\). In a (too simple) model of the noise in each channel with an incoherent component \(\sigma_{i}\) and a coherent one \(\sigma_{c}\), we have : \(\sigma_{t}^{2}=9\sigma_{i}^{2}+(9\sigma_{c})^{2}\). Noting \(X^{2}\) the sum of the diagonal terms of V, we have : \(X^{2}=9(\sigma_{i}^{2}+\sigma_{c}^{2})\), from which we conclude that :

\[\sigma_{c}=\sqrt{\frac{\sigma_{t}^{2}-X^{2}}{9^{2}-9}}\ \ and\ \ \sigma_{i}=\sqrt{\frac{9X^{2}-\sigma_{t}^{2}}{9^{2}-9}}\]

Numerically, \(\sigma_{t}=4.98\,\)mV (186 MeV in the nonet), and in average per cell, \(\sigma_{c}=0.22\,\)mV (8.4 MeV), \(\sigma_{i}=1.52\,\)mV (56.6 MeV).

Similar results are obtained for the Middle and the Back layers.

### Effect of optimal filtering

Because of the chosen normalisation, the optimal filtering does not change the energy scale. The improvement in the signal/noise ratio is seen as a reduction of the noise. Wehave redone the matrix analysis of the previous paragraphe, considering for each event the optimal combination of the samples. The results are :

We observe that optimal filtering reduces the incoherent noise by 30% (factor 1.4) while the coherent noise is reduced only by less than 10% (factor 1.1). Since most of the coherent noise comes from the SCA chip itself (common reference channel), this means that the noise from the SCA does not show a significant correlation between the successive samples.

### Noise term in the energy resolution

We have applied the electron reconstruction algorithm to high gain pedestal runs, forcing the impact cell to be the same as for the electron data.

We have first used only the third sample in each event. Figure 2 shows that the energy spectra for the front, middle and back layers as well as for the total of the three layers are gaussian. It shows that this is also the case when using optimal filtering.

\begin{table}
\begin{tabular}{|l|c|c|c|c||c|c|} \hline Layer & \multicolumn{2}{c||}{Front} & \multicolumn{2}{c||}{Middle} & \multicolumn{2}{c||}{Back} \\ \hline Noise per cell (MeV) & \(\sigma_{c}\) & \(\sigma_{i}\) & \(\sigma_{c}\) & \(\sigma_{i}\) & \(\sigma_{c}\) & \(\sigma_{i}\) \\ \hline Single sample & 8.4 & 56.6 & 8.1 & 54.2 & 6.4 & 43.3 \\ \hline Optimal filtering & 7.4 & 39.5 & 8.1 & 38.2 & 5.3 & 30.3 \\ \hline Ratio & 1.1 & 1.4 & 1.0 & 1.4 & 1.2 & 1.4 \\ \hline \end{tabular}
\end{table}
Table 1: _Noise reduction with optimal filtering_

Figure 2: _Noise in the nonet. Energy spectra in GeV in the Front layer (a), Middle layer (b), Back layer (c), Total (d)._

Results from gaussian fits are :

These numbers are compatible with the results of the matrix analysis above. The quadratic sum of the noise over the three layers is 281 MeV with the third sample alone and 210 MeV with optimal filtering, showing that the noise contribution coherent over the layers is negligible.

A similar analysis has also been performed on pedestal runs using the low gain channels. In this case, the noise in MeV is dominated by the SCA. The noise autocorrelation matrix shows much smaller correlation between the successive time samples than for the high gains. As a consequence, little improvement is expected from the optimal filtering. Indeed, optimal filtering reduces the noise by a factor 1.08, compatible with the reduction factor on the coherent noise in the high gain (which also originates mainly from the SCA).

## 4 Calibration data

The calorimeter calibration uses a pulser with 12 different patterns for the pulsed channels. In the \(\eta\) direction, each fourth calorimeter cell is pulsed at the same time. In the \(\phi\) direction, couples of neighbouring cells are pulsed simultaneously.

### Linearity

The variation of the measured signals after pedestal subtraction as a function of the DAC driving the calibration pulser has been studied for each channel. Figure 3 shows the deviation from linearity for the 12 connected channels of the first high gain SCA chip on the first board. A third degree polynomial has been used to fit the DAC as a function of the ADC values. The linear terms (gains) are uniform between channels within better than 10 %. Figure 3 shows the residues of the fit for the first high gain SCA chip of the first board. All residues are within \(\pm 0.1\%\) of the full scale.

### Noise

Figure 4.2 shows the resolution on the amplitude measurements per SCA channel both for high and low gains as a function of the amplitude. To a good approximation, it is given by the noise terms of 56 MeV for the high gain and 507 MeV for the low one, as expected from the pedestal runs, down to resolutions below 0.1 %. We have therefore no evidence for a constant term above 0.1% in the resolution.

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline Layer & Front & Middle & Back & Total \\ \hline Single sample & 183. & 179. & 115. & 294. \\ \hline Optim al filtering & 137. & 137. & 81. & 210. \\ \hline Ratio & 1.34 & 1.31 & 1.43 & 1.40 \\ \hline \end{tabular}
\end{table}
Table 2: _Noise in a “nonet” (\(\sigma\,fromfit\)) in MeV_Figure 4: _Energy resolution (%) for calibration signals. First high gain chip, first board. Peak sample_

Figure 3: _Result in ADC counts for the first high gain chip on the first board. Only the sample at the signal maximum is used_

### Dynamic range

Saturation is observed around 3 Volts above pedestal, both for high and low gain channels. It comes from the amplifier sitting between the shaper and the SCA. The ratio between saturation and noise levels in the whole system is therefore 2000 for the high gains (11 bits) and 28300 for the bi-gain system (14.8 bits). The dynamic range of the front-end board alone (excluding pre-amplifiers and shapers) is 49950 (15.6 bits). Later measurements in Orsay have reached 16 bits.

### Timing resolution

An estimator of the time difference between the maximum of the signal and the third sample, \(T_{max}\), is obtained by a parabolic fit using the second, third and fourth samples in the event. The estimator is slightly biased, but there is an unambiguous correspondance between \(T_{max}\) and the true time difference. We have studied the spread over the events of the difference in \(T_{max}\) for couples of cells at the same \(\eta\) and pulsed simultaneously. This spread is shown as a function of the amplitude in figure 5. The fitted constant term is 34 ps. Such a precision, if achieved for clusters in ATLAS, would allow to separate events in the same bunch crossing when their interaction vertices are separated by a few centimeters.

### Cross-talk

In the ATLAS version of the front-end board, the three SCA channels corresponding to the same calorimeter cell, read with three different shaper gains, will be neighbours in the same SCA chip, meaning that there will be large (saturated) signals close to small ones. Cross-talk is therefore a very sensitive issue, as it should not deteriorate the energy resolution. A study of the cross-talk from calibration runs is presented in this section.

For each event, we have used only the third sample (corresponding to the maximum of the direct signals). Since the shape of the cross-talk signals is expected to be different from the one of direct signals, the combination of cross-talk and multiple samples is complex, and we left it aside.

Figure 5: _Time resolution as a function of the energy, from high gain calibration runs._Three components of cross-talk are considered in this study. The geometrical cross-talk affects neighbouring calorimeter cells in the \(\eta\) direction. It is not a priori considered to be symmetrical between the left and the right neighbours. In the \(\phi\) direction, two neighbouring cells use two different electrodes, and we therefore expect no cross-talk. Cross-talk between the middle and the back layers is also considered. It is expected because of the shape of the electrodes in those two layers.

The second source of cross-talk affects neighbouring shaper channels. The third one affects neighbouring SCA channels. In the SCA chip, the 4 reference channels are mixed with the normal ones. As a result, we have cross-talk from normal channels into the reference channels (as well as cross-talk between neighbouring normal channels). Because of the subtraction of the reference channels, the cross-talk pattern in the SCAs appears as more complex than in the shapers. This allows to disantangle the two components. Again, cross-talk is not a priori assumed to be symmetrical for the "upper" and "lower" neighbours.

We have thus six parameters (2 in the calorimeter, 2 in the shaper, 2 in the SCA's) that can be extracted from calibration data. Measuring the signal in cells neighbouring a pulsed cell (in \(\eta\) in the calorimeter or in the shaper boards or in the SCA chip), for each of the 12 pulser patterns, provides a set of 15 equations from which the 6 parameters are extracted. The results are comparable for all 5 front-end boards. They are summarized in table 3 for the high gain runs.

As expected, the measured cross-talk is the same in the left and the right direction for the calorimeter. The numbers agree with previous measurement using track and holds. However, there is a strong correlation between the cross-talk estimates for the calorimeter and for the shapers, and only the sum of the two components is precisely determined. The cross-talk in the SCA agrees with previous test bench measurements [1]. The -1.2% cross-talk measured between a channel and its upper neighbour comes from an error in the layout of the SCA chip, which has been corrected in the new version of the chip. As expected, the cross-talk in the new SCA chip is measured well below 0.1% [5].

In the case of the low gain calibration runs, the extracted values for the cross-talk in the SCA's are the same as in the high gain runs, as expected. The sum of the calorimeter and shaper contributions is also the same. However, the two contributions could not reliably be disentangled.

Later test bench measurements show that the small cross-talk to the lower channel in the SCA is not a geometrical effect, but comes from the 10 MHz multiplexing at the SCA output, which is a bit too fast.

A correction matrix has been applied to electron data, and the effect is discussed in the next section.

\begin{table}
\begin{tabular}{|c|c|c|} \hline source of cross-talk & (\%) & (\%) \\ \hline calorimeter \(\eta\) cell & \(\eta\) + 1: 1.1 & \(\eta-1\) : 1.1 \\ shaper channel & upper channel : -0.1 & lower channel : 0.1 \\ SCA channel & upper channel : -1.2 & lower channel : \(<\) 0.1 \\ \hline \end{tabular}
\end{table}
Table 3: _Cross-talk coefficients for high gains_.

Electron data

The low gain threshold is around 100 GeV in a cell. As a result, only high gains are used for beam energies up to 200 GeV. The 300 GeV data is treated in the next section.

The electron showers are reconstructed by summing the energy in a \(3\times 3\) nonet around the impact cell. In the back layer, where the granularity in the \(\eta\) direction is larger, only \(2\times 3\) cells in \(\eta\times\phi\) are used.

The electron impact position in \(\eta\) and \(\phi\) is determined from the barycenter in the front layer. We made no attempt to measure the calorimeter uniformity, and applied strong cuts to keep electron impinging close to the center of the impact cell (see figure 5(a)). In the high energy runs (in particular 200 GeV), a low energy tail is observed and is correlated with the \(\eta\) coordinate of the impact, as shown in figure 5(b). The tail is observed with both the SCA readout and the track and old readout. It is also present at two different impact points, for which cells are equipped with different preamplifiers (0T and Silicon). It is therefore attributed to a beam effect, even though decoding the scintillators information did not bring any insight. In order to reduce the tail, the events falling in the positive \(\eta\) region are thus not used in the analysis.

Before determining the energy resolution at various beam energies, the nonet energy is corrected to take into account the time jitter of the electrons with respect to the 40 MHz clock (limited to 3 ns in total by the trigger), the relative weighting of the signal in the front layer with respect to the middle and back layers, the \(\phi\) modulations and the limited cluster size. Only the first correction is specific of the present analysis, where signals are sampled at 40 MHz; however, the parameters for all four corrections have been extracted from the present data.

The energy in the nonet as a function of the above defined \(T_{max}\) estimator is shown in figure 7. The slope is positive, which means that the third sample falls after the peak. A linear correction is applied, and the corrected nonet energy as a function of the \(T_{max}\) is flat, as shown in figure 7. The extreme values of the correction are \(\pm 0.5\%\) when only the third sample is used in each event. When optimal filtering is applied to the five samples, the distribution of the energy as a function of the \(T_{max}\) is flat, as can be seen from figure 8.

Figure 6: _(a) The part of the impact cell used in the electron analysis. The right side of the cell (\(\eta>0\)) is not used, because of the low energy tail, as shown in (b)._

[MISSING_PAGE_EMPTY:13]

Usal corrections as a function of the impact point coordinates are applied. As shown on figure 9, the correction as a function of \(\phi\) can be approximated by a sum of two sine functions combined with a parabola (finite cluster size effect in \(\phi\)). A parabolic correction as a functions of \(\eta\) has also been applied to correct for finite cluster size in \(\eta\), except for 200 GeV electrons where this did not significantly improve the resolution.

The energy spectra after corrections for the 200 GeV electron beam is shown in figure 10, with only the third sample (a), and with optimal filtering applied to the five time samples (b). The resolutions are respectively 0.76% and 0.72%. Subtracting a beam energy spread of 0.15% brings the resolution down to 0.705%.

Resolutions obtained with beam energies from 20 to 200 GeV, after subtraction of the beam spread, are shown in figure 11. Optimal filtering brings a significant improvement at low energies. However, the 20 GeV run suffers from a very low statistics, due to the poor beam rate.

The resolution is fitted as a function of the electron beam energy with the usual relation:

\[\frac{\sigma_{E}}{E}=\frac{a}{E}\oplus\frac{b}{\sqrt{E}}\oplus c\]

Figure 9: _Energy before and after the phi modulation corrections. The phi dependence is fit with two sine functions and a parabola._

The parameters of the fit are strongly correlated. Moreover, since the point at 20 GeV is somewhat higher than expected, a three parameters fit would overestimate the noise parameter a. We have fixed this parameter to the value measured with pedestal runs (290 MeV when using only the third sample and 210 MeV with optimal filtering). Then, the trend of the fit is to overestimate the sampling parameter b and underestimate the constant term c. Indeed, the result for c is 0, at the edge of the allowed region.

From previous measurement with the same calorimeter, a sampling term of \(9.99\%\pm 0.29\%\) at \(\eta=0.28\) has been obtained [6], from which we expect b = 9.86% at \(\eta=0.16\). The result of the fit is in good agreement with this expectation, as seen on figure 11.

A sampling term of \(9.86\%/\sqrt{E}\) and a noise term of 210 MeV are exactly enough to account for the observed resolution at 200 GeV, 0.705%. The measurement uncertainties leave no possibility for a local constant term above 0.05%.

We tried to correct for cross-talk using the correction matrix extracted from calibration data in the case when only the peak sample was used. For 200 GeV electrons, the improvement on the resolution was marginal : 0.73% compared to 0.76% (without subtraction of the beam spread), given the large uncertainty on the correction procedure. For the lower energy runs, no improvement is observed.

Figure 10: _Energy resolution after corrections for 200 GeV electrons. Only the sample at the peak is used in (a) and optimal filtering is applied to the five time samples in (b)._

## 6 Gain switching system

Calibration runs have been taken both in the free gain mode where the system automatically switches to the low gain SCA channel for large signals, in forced high gain mode and in forced low gain mode.

Figure 12(a) shows the equivalent energy (signal after calibration corrections) as a function of the DAC value for forced gain runs. The high gain data and the low gain data have the same slope and agree well. In the case when the system chooses freely the gain that should be digitized, it can be seen in figure 12(b) that the two gains give the same slope, but that there is an offset in a transition region. Going to much higher energies, we see no offset anymore.

Figure 11: _Energy resolution as a function of the incident electron beam energy. The triangles and the dotted line correspond to resolutions obtained with only one sample used(2). The circles and the full line correspond to the resolutions obtained with the use of five time samples and the optimal filtering(1). The noise term has been fixed to respectively 290 MeV (210 MeV)._The same effect is present in the 300 GeV electron data. The distribution of the impact cell energy is shown in figure 13 when the high gain was chosen, and when the low gain was chosen. The cut is sharp. However, the high gain stops at 120 GeV while the low gain starts at 114 GeV.

In the calibration runs only 25% of the channels are pulsed simultaneously. In the electron runs, there is a high signal in at most a single channel. This is the reason why we

Figure 12: _Energy as a function of the input DAC value in a forced gain mode (a) and in the free gain mode (b). An offset of 6 Gev can be seen in the case of the free gain mode._

Figure 13: _The energy in the impact cell for 300 GeV electrons. The plain histogram is for the events remaining in the high gain, and the shaded histogram corresponds to events in which the impact cell is in the low gain._

systematically send the high gain SCA output into the ADC, until we eventually realize that it is above threshold. We then switch the low gain SCA output into the ADC instead. For the cells where we have to switch to low gain, the SCA output and the ADC input reach saturation (4V) while the decision is being taken (i.e. 20 ns). When we indeed switch to low gain, the excursion back to the correct voltage level is small if the low gain channel is itself close to saturation. On the contrary, the excursion is large for a signal just above the gain switching threshold. In this case, there is not enough time to reach stabilisation before digitization. This is the reason of the observed offset.

The effect was cured after the run, taking advantage of the asymmetry in the voltage variation with time : it increases much faster than it decreases. We now systematically send the low gain SCA output to the ADC, and switch to the high gain one when needed (i.e. most of the times). No offset is observed, even in the most critical case of a signal just below the transition from high to low gain. If the multiplexing period increases from 100 to 150 ns, as foreseen in ATLAS, the problem disappears completely.

To analyse the 300 GeV electron data, the offset is compensated by adding 6 GeV to the impact cell when the low gain was used. The energy resolution is derived separately for the events where only the high gain was used and for the events where the impact cell uses the low gain. The results are shown in figure 14. In the high gain case, the resolution is 1.0%, worse than the 0.6% which are expected from the extrapolation of figure 11. For these events however, the impact position is close to the edge of the impact cell, and this deteriorates the energy resolution. In the low gain case, the resolution is 1.15%. This means that the gain switching procedure was not understood with sufficient precision at the time of data taking. We expect significantly better performances with the next iteration.

Figure 14: _Energy resolution for the 300 GeV electron run, when the impact cell is in high gain (a), and when the impact cell is in the low gain (b)._

Conclusion

Data have been recorded at CERN in real beam conditions, with a complete readout system, prototype of the front-end electronics for the ATLAS liquid argon calorimeters. The behaviour of the SCA chip is now understood with a level of precision which proves that a dynamic range of 12 bits is achievable in practice. Test beam data do not allow the same precision level when using the gain switching system. However, further work with the system allowed us to reach the dynamic range of 16 bits for the bi-gain front-end board (without preamplifiers). An Alberta-Nevis-Orsay-Saclay team is now working on the ATLAS front-end board with a slightly more conservative design, using three gains per cell instead of two.

The energy resolution for electrons is better than with the standard Track and Hold system, with a noise term of 210 MeV (as compared to 300 MeV), a sampling term of \(9.93\%/\sqrt{E}\) and a local constant term compatible with 0.

As mentionned in the text, results obtained with optimal filtering have triggered more detailed work in a separate note.

## References

* [1] J. Ardelean et al., **ATLAS Note LARG-N0-50**
* [2] W.E. Cleland and E.G. Stern, **NIM(A338) 1994** N. Launay et al., ATLAS Internal Note, **CAL-N0-24** I. Wingerter-Seez, ATLAS Internal Note, **LARG-N0-19**
* [3] G. Romet-Lemonne, pres. at the LARG test beam meeting, may 6th 1997 and Report (june 1997)
* [4] Y. Jacquier et al., ATLAS Note in preparation
* [5] J. Parsons, pres. at the LARG electronics meeting, march 12th 1997
* [6] D.M. Gingrich et al., **NIM(A364) 1995 290**