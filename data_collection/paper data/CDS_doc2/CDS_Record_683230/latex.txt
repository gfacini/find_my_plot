**ATLAS Internal Note**

**TECH - NO - 014**

**Revised version**

**23 February, 1995**

**Least square fit and covariance matrix for an**

**octagonal alignment grid for the ATLAS detector**

C. Daum

**Abstract**

A proposal for the overall alignment of the ATLAS detector has been made [1, 2] by setting up an alignment grid using precise distance measurements. An analysis is made of the precision obtained for a given accuracy of the distance measurements.

_The revision corrects a computational error and contains further insight in the mathematics of the problem._

**Introduction**

In Ref. [1], we introduced the concept of a planar polygonal grid in which the two coordinates of each corner, e.g. radius and azimuthal angle with respect to the centre of the polygon, are determined from distance measurements between corner points only. We have shown that for increasing order of the polygon, the pentagon has the lowest order for which the number of distance measurements is equal to the number of unknowns, i.e. 10. In the ATLAS geometry, we have to avoid distance measurements which cross the centre of the polygon where the beam pipe is located. Therefore, the hexagon has only 12 measurements for 12 unkown. The septagon permits 21 distances to be measured for 14 unknowns. This has the advantage that the determination of the unknowns is overconstrained and that the failure of one or a few measurements does not jeopardize solving the problem with adequate precision. Fig. 1 shows the octagonal grid proposed in Ref. [2]. It has 24 distance measurements which do not cross the centre for 16 unknowns.

**1. Least-square fit and covariance matrix**

For the ideal polygon of order n, we have the relations

\[r_{1}=r_{2}=\ldots=r_{n}=r\] (1),

\[d_{12}=d_{23}=\ldots=d_{n-1n}=d_{n1}=2r\sin\frac{\pi}{n}\] (2),

\[d_{13}=d_{24}=\ldots=d_{n-11}=d_{n2}=2r\sin\frac{2\pi}{n}\] (3),

\[d_{14}=d_{25}=\ldots=d_{n-12}=d_{n3}=2r\sin\frac{3\pi}{n}\] (4),

etc., and

\[\phi_{\frac{1}{2}}=(i-1)\ \frac{2\pi}{n}\] (5),

for i = 1 to n.

The cosine rule in triangles between any two corner points and the centre is

Figure 1: Planar octagonal alignment grid.

\[\Delta\phi_{\rm i}=\phi_{\rm i} \tag{12a}\] \[\Delta\phi_{\rm i}=\phi_{\rm i} \tag{12b}\]

Differentiating Eqs. (12a) and (12b), we get \[\Sigma_{i=1}^{n-1}\left(\cos\phi_{i}\,\mathrm{d}r_{i}-r_{i}\sin\phi_{i}\, \mathrm{d}\phi_{i}\right)=0\] (13a), \[\Sigma_{i=1}^{n-1}\left(\sin\phi_{i}\,\mathrm{d}r_{i}+r_{i}\cos\phi_{i}\, \mathrm{d}\phi_{i}\right)=0 \tag{13b}\]

which then yields (n*jmax + 2) linear equations.

In the case of the octagon of Fig. 8 we have at most 26 linear equations with 16 variables \(\mathbf{x}\) to be determined and 24 measurements \(\mathbf{y}\), represented by

\[\mathbf{y=A\ x} \tag{14}\]

where \(\mathbf{A}\) is a matrix of 16 columns and at most 26 rows. The solution of this equation is

\[\mathbf{\hat{x}=\left(A^{T}A\right)^{-1}A^{T}y} \tag{14}\]

If we take for a start \(\sigma(\mathrm{d}\mathrm{i}\mathrm{k})=\sigma\), independent of the pair 'ik', the variance of \(\mathbf{y}\) is

\[\mathrm{V(y)=\sigma^{2}\ I_{n}} \tag{15}\]

where \(\mathbf{I_{n}}\) is the unit matrix of order 2n. Then, the covariance matrix of the vector \(\mathbf{\hat{x}}\) is

\[\mathrm{V(\mathbf{\hat{x}})=\sigma^{2}\left(A^{T}A\right)^{-1}} \tag{16}\]

The inversion of \(A^{T}A\) requires that its determinant should not be equal to zero. The value of the determinant is independent of the ordering of the variables in Eqs. (11), i.e. the columns of \(\mathbf{A}\) can be interchanged arbitrarily.

However, the determinant of \(A^{T}A\) turns out to be equal to zero, as the sum of the radius vectors of a polygon equals zero. i.e. the vectors are linearly dependent.

This can be solved by taking one radius vector as reference with infinite precision and to relate all other vectors to this reference vector. This means leaving out one column in \(\mathbf{A}\) corresponding to e.g. \(r_{n}\) and one for \(\phi_{n}\), and taking \(\phi_{n}=0\). The solution is then made for the reduced matrix \(\mathbf{A}\) with (2n*j) rows and (n-2) columns. The reduced covariance matrix (\(A^{T}A\))-1 is then an (n-2)x(n-2) matrix.

If measuring all distances \(\mathrm{d}\mathrm{i}\mathrm{k}\) with j = k - i = 1, 2, and 3 and using the constraints (13a) and (13b) on the angles, we obtain, a matrix \(\mathbf{A}\) of 26 rows and 14 columns. If one or more measurements are absent, the number of rows in \(\mathbf{A}\) decreases by one for each missing measurement. The determinant of (\(A^{T}A\))-1 gives an indication of the 

[MISSING_PAGE_EMPTY:5]

of two angles are in general a large fraction of the variance of an angle.

The choice of the reference radius is arbitrary, and the variance of all radii and angle should be the same. The variances are than the mean of the seven values each for the radial and angular variance. The mean variances for the radius and angle at r = 1.0m, a typical radius for the inner detector, are

\[\sigma(\mathrm{r})=\sigma(\Delta\mathrm{r})=\sqrt{0.31}\ \sigma\] (18),

\[\sigma(\phi)=\sigma(\Delta\phi)=\sqrt{0.46}\ \frac{\sigma}{\Gamma} \tag{19}\]

and at r = 4.5m, a typical radius immediately at the inside of the muon spectrometer,

\[\sigma(\mathrm{r})=\sigma(\Delta\mathrm{r})=\sqrt{0.31}\ \sigma\] (20),

\[\sigma(\phi)=\sigma(\Delta\phi)=\sqrt{0.023}\ \frac{\sigma}{\Gamma} \tag{21}\]

The radial variance is independent of the radius r. This is also observed for the cases with missing measurements. These introduce in general asymmetries in the matrix with respect to r\({}_{\mathrm{R}}\), and also in matrices for other reference radii.

Frequency Scan Interferometry [4] provides a variance of about \(\sigma\) = 2\(\mu\)m over a distance of about 1m. The distances at the outer radius of the inner detector are of the order r = 1m, hence, \(\sigma(\mathrm{r})\) = 1.1\(\mu\)m and \(\sigma(\phi)\) = 1.4\(\mu\)rad. The distances at the inner radius of the muon detector are of the order r = 4.5m and we assume as a first estimate that \(\sigma\) scales with r, hence, \(\sigma\) = 9\(\mu\)m, \(\sigma(\mathrm{r})\) = 5.0\(\mu\)m and \(\sigma(\phi)\) = 0.30\(\mu\)rad.

We can now study the change in the covariance matrix by leaving out measurements, i.e. rows in the matrix A. This is shown in Tables 2 and 4 for r = 1.0m, and in Tables 3 and 5 for r = 4.5m.

Tables 2 and 4 show that the constraints of Eqs. (13a) and (13b) are an absolute necessity. Tables 2 and 3 demonstrate that leaving out one distance measurement hardly changes the variances. Missing up to eight distance measurements deteriorates the radial variance by at most a factor 2.5 to \(\sigma(\mathrm{p})\) = 2.8\(\mu\)m for the radial variance and a factor 2.1 to \(\sigma(\phi)\) = 2.8\(\mu\)rad for the angular variance for a measurement error \(\sigma\) = 2\(\mu\)m at r = 1.0m. These factors are 2.5 to \(\sigma(\mathrm{p})\) = 12.7\(\mu\)m and 2.0 to \(\sigma(\phi)\) = 0.62\(\mu\)rad, respectively, for a measurement error \(\sigma\) = 9\(\mu\)m at r = 4.5m. The numerical quality factor of Eq. (17) is always Q < 10\({}^{\text{-}}\)30, except for the case without the constraints (13a) and (13b), for which Q < 10\({}^{\text{-}}\)9.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline \multicolumn{1}{|c|}{Measurements deleted (constraints)} & var (\(\tau_{\rm l}\))/\(\sigma^{2}\) & var (\(\phi_{\rm l}\))/\(\sigma^{2}\) & det (A\({}^{\rm T}\)A)\({}^{-1}\) \\ \multicolumn{1}{|c|}{(13a,b) active, when not mentioned)} & \multicolumn{1}{c|}{} & \\ \hline None, no constraints (13a,b) & 0.8-(0.2E+23) & (0.1-7.0)E+22 & 0.67E+18 \\ \hline None & 0.29-0.31 & 0.44-0.49 & 0.31E-07 \\ \hline one d\({}_{\rm ik}\) missing & & & \\ \hline d\({}_{\rm 12}\) & 0.29-0.34 & 0.44-0.60 & 0.64E-07 \\ \hline d\({}_{\rm 13}\) & 0.29-0.40 & 0.44-0.57 & 0.67E-07 \\ \hline d\({}_{\rm 14}\) & 0.32-0.48 & 0.45-0.51 & 0.72E-07 \\ \hline eight d\({}_{\rm ik}\) missing & & & \\ \hline d\({}_{\rm 12}\), d\({}_{\rm 23}\), d\({}_{\rm 34}\), d\({}_{\rm 45}\), d\({}_{\rm 56}\), d\({}_{\rm 67}\), d\({}_{\rm 78}\), d\({}_{\rm 81}\) & 0.34-0.38 & 1.10-1.95 & 0.31E-04 \\ \hline d\({}_{\rm 13}\), d\({}_{\rm 24}\), d\({}_{\rm 35}\), d\({}_{\rm 46}\), d\({}_{\rm 57}\), d\({}_{\rm 68}\), d\({}_{\rm 71}\), d\({}_{\rm 82}\) & 0.69-0.84 & 0.70-0.84 & 0.15E-04 \\ \hline d\({}_{\rm 14}\), d\({}_{\rm 25}\), d\({}_{\rm 36}\), d\({}_{\rm 47}\), d\({}_{\rm 58}\), d\({}_{\rm 61}\), d\({}_{\rm 72}\), d\({}_{\rm 83}\) & 0.91-1.99 & 0.50-0.75 & 0.72E-04 \\ \hline \end{tabular}.

\end{table}
Table 2: Variances of r and \(\phi\) at r = 1.0m.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline \multicolumn{1}{|c|}{Measurements deleted (constraints)} & var (\(\tau_{\rm l}\))/\(\sigma^{2}\) & var (\(\phi_{\rm l}\))/\(\sigma^{2}\) & det (A\({}^{\rm T}\)A)\({}^{-1}\) \\ \multicolumn{1}{|c|}{(13a,b) active, when not mentioned)} & \multicolumn{1}{c|}{} & \\ \hline None, no constraints (13a,b) & 0.8-(0.2E+23) & (0.1-7.0)E+22 & 0.67E+18 \\ \hline None & 0.29-0.31 & 0.44-0.49 & 0.31E-07 \\ \hline one d\({}_{\rm ik}\) missing & & & \\ \hline d\({}_{\rm 12}\), d\({}_{\rm 23}\), d\({}_{\rm 34}\), d\({}_{\rm 45}\), d\({}_{\rm 56}\), d\({}_{\rm 67}\), d\({}_{\rm 78}\), d\({}_{\rm 81}\) & 0.34-0.38 & 0.055-0.096 & 0.22E-13 \\ \hline d\({}_{\rm 13}\)

[MISSING_PAGE_EMPTY:8]

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline \multicolumn{4}{|l|}{Measurements deleted (constraints)} & var (r)/\(\sigma^{2}\) & var (\(\phi_{\rm i}\))/\(\sigma^{2}\) & det (A\({}^{\rm T}\)A)-1 \\ (13a,b) active, when not mentioned) & & & \\ \hline nine d\({}_{\rm ik}\) missing & & & \\ \hline d\({}_{\rm 13}\) & 0.91-2.79 & 0.023-0.043 & 0.26E-12 \\ d\({}_{\rm 14}\), d\({}_{\rm 25}\), d\({}_{\rm 36}\), d\({}_{\rm 47}\), d\({}_{\rm 58}\), d\({}_{\rm 61}\), d\({}_{\rm 72}\), d\({}_{\rm 83}\) & & \\ \hline ten d\({}_{\rm ik}\) missing & & & \\ \hline d\({}_{\rm 45}\) & 1.03-3.39 & 0.033-0.045 & 0.92E-12 \\ d\({}_{\rm 13}\) & & & \\ d\({}_{\rm 14}\), d\({}_{\rm 25}\), d\({}_{\rm 36}\), d\({}_{\rm 47}\), d\({}_{\rm 58}\), d\({}_{\rm 61}\), d\({}_{\rm 72}\), d\({}_{\rm 83}\) & & \\ \hline \multicolumn{4}{|l|}{eleven d\({}_{\rm ik}\) missing} & & \\ \hline d\({}_{\rm 12}\), d\({}_{\rm 23}\), d\({}_{\rm 34}\), d\({}_{\rm 45}\), d\({}_{\rm 56}\), d\({}_{\rm 67}\), d\({}_{\rm 78}\), d\({}_{\rm 81}\) & 0.40-1.80 & 0.059-0.262 & 0.28E-11 \\ d\({}_{\rm 13}\), d\({}_{\rm 87}\), d\({}_{\rm 72}\) & & & \\ \hline d\({}_{\rm 45}\) & 0.76-3.88 & 0.040-0.117 & 0.28E-11 \\ d\({}_{\rm 13}\), d\({}_{\rm 24}\), d\({}_{\rm 35}\), d\({}_{\rm 46}\), d\({}_{\rm 57}\), d\({}_{\rm 68}\), d\({}_{\rm 71}\), d\({}_{\rm 82}\) & & \\ d\({}_{\rm 47}\), d\({}_{\rm 72}\) & & & \\ \hline \multicolumn{4}{|l|}{d\({}_{\rm 45}\)} & 1.32-3.82 & 0.039-0.049 & 0.51E-11 \\ d\({}_{\rm 13}\), d\({}_{\rm 68}\) & & & \\ d\({}_{\rm 14}\), d\({}_{\rm 25}\), d\({}_{\rm 36}\), d\({}_{\rm 47}\), d\({}_{\rm 58}\), d\({}_{\rm 61}\), d\({}_{\rm 72}\), d\({}_{\rm 83}\) & & \\ \hline \multicolumn{4}{|l|}{twelve d\({}_{\rm ik}\) missing} & & \\ \hline d\({}_{\rm 12}\), d\({}_{\rm 23}\), d\({}_{\rm 34}\), d\({}_{\rm 45}\), d\({}_{\rm 56}\), d\({}_{\rm 67}\), d\({}_{\rm 78}\), d\({}_{\rm 81}\) & 0.41-14.8 & 0.11-1.48 & 0.12E-09 \\ d\({}_{\rm 13}\),Tables 3 and 5 show that up to eleven measurements can be absent. At r = 1.0m the radial variance deteriorates by at most a factor 3.5 to \(\sigma(\rho)=3.9\mu\)m, and the angular variance by at most a factor 3.4 to 4.6 \(\mu\)rad for a measurement error \(\sigma=2\mu\)m. At r = 4.5m the radial variance deteriorates by at most a factor 3.5 to \(\sigma(r)=17.7\mu\)m, and the angular variance by a factor 3.4 to \(\sigma(\phi)=1.0\mu\)rad for a measurement error \(\sigma=9\mu\)m. The numerical quality factor of Eq. (17) is always Q < 10\({}^{\text{-}}\)30, except for the case, for which twelve measurements including the ring of measurements \(\text{d}_{\mathbf{ik}}\) with j = k - i = 2 are missing, for which Q < 10\({}^{\text{-}}\)8.

## Conclusion

The results show that a grid with up to 24 measurements is desirable for a robust alignment. A permutation of up to eight missing measurements guarantees a radial variance of < 2.8\(\mu\)m and an angular variance of < 2.8\(\mu\)rad for a measurement error of \(\sigma=2\mu\)m at a radius r = 1.0m, and a radial variance of < 12.7\(\mu\)m and an angular variance of < 0.62\(\mu\)rad for a measurement error of \(\sigma=9\mu\)m at r = 4.5m. No study has been made of systematic errors. Careful design is needed of the holders of light sources, light receivers and/or reflectors which may contribute substantial systematic errors.

Hence, the construction of an octagonal alignment grid using precise distance measurements promises to be a viable technique and should be further discussed for ATLAS.

The study will be continued with an analysis of the longitudinal parts of the alignment grid and thus of the complete grid. Finally, it should be extended to include an external reference, preferably directly to the LHC machine elements at each side of the intersection.

## References

* [1] C. Daum, Alignment of the ATLAS inner detector, ATLAS Internal Note, INDET-NO-060, 12 september 1994.
* [2] C. Daum, Alignment of the ATLAS detector from inner detector to muon spectrometer, ATLAS Internal Note, TECH-NO-13, 7 november 1994.
* [3] Courtesy, S. Kolbig, CN-division, CERN.
* [4] Alignment, Distortion, Survey & Assembly, R. Nickerson, INDET-TR-118.