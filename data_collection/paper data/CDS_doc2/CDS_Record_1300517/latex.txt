The FastCaloSim calorimeter simulation was developed to provide a reasonably accurate but still fast simulation of the ATLAS calorimeter system. Parametrizations of electromagnetic and hadronic calorimeter showers are used to deposit particle energies in the detailed calorimeter structure.

In the present document a short overview of the fast calorimeter simulation principle is presented. This is followed by a comparison of individual particle signatures and event properties to the full Geant 4 based ATLAS detector simulation.

Introduction

One of the most essential tools for data analysis in particle physics is a Monte Carlo simulation of the detector. The current standard simulation suite for the ATLAS detector [1] is based on a detailed description of the detector geometry and of the simulation of particle interactions in the detector material with Geant 4 [2, 3, 4]. The drawback of such a detailed simulation is a CPU time requirement of several minutes per event, of which more than 90% is spent inside the calorimeter systems. With the rapidly increasing LHC luminosity, this CPU time requirement is a challenge for the production of sufficiently large Monte Carlo samples. Hence an accurate but fast detector simulation, such as the one the FastCaloSim package provides for the calorimeter system, is useful.

The aim of the FastCaloSim package is to provide a parametrized simulation of the particle energy response and of the energy distribution in the ATLAS calorimeter and hence reduce the calorimeter simulation time to a few seconds per event. The parametrization is based on the Geant 4 simulations of single photons, electrons and charged pions in a fine grid of simulated particle energies and directions.

The note is organized as follows. Section 2 describes the ATLAS detector and calorimeter system. The fast calorimeter simulation model is discussed in Section 3 and is followed by a section showing the validation against the Geant 4 simulation. Section 5 shows a comparison of the charged hadron calorimeter response. Finally, a comparison of inclusive jet and missing transverse momentum quantities in simulated minimum bias events is shown in Section 6.

## 2 The ATLAS Detector

The ATLAS detector covers almost the whole solid angle around the collision point with layers of tracking detectors, calorimeters and muon chambers and is described in detail in Ref. [1].

The Inner Detector (ID) system is immersed in a 2 T axial field and provides tracking measurements in the pseudorapidity range \(|\eta|<2.5\)1. The Inner Detector consists of silicon tracking detectors, pixel and silicon microstrip (SCT), covering the pseudorapidity range \(|\eta|<2.5\) and a Transition Radiation Tracker (TRT) up to \(|\eta|<2.0\).

Footnote 1: The ATLAS coordinate system is defined such that the x-axis points towards the center of the LHC ring, the y-axis points up, the z- axis defines a right-handed coordinate system and \(r=\sqrt{x^{2}+y^{2}}\). \(\phi\) is the azimuthal angle defined such that \(\phi=0\) is along the x-axis. The pseudorapidity is \(\eta=-\ln\tan(\theta/2)\), where \(\theta\) is the polar angle measured from the beam pipe.

The calorimeter system covers the pseudorapidity range \(|\eta|<4.9\), using a variety of techniques. High granularity liquid-argon (LAr) electromagnetic sampling calorimeters, with excellent performance in terms of energy and position resolution, cover the pseudorapidity range \(|\eta|<3.2\). They use accordion-shaped electrodes and lead absorbers and consist of a barrel part (EMB, \(|\eta|<1.475\)) and an end-cap part (EMEC, \(1.375<|\eta|<3.2\)). The hadronic calorimetry in the range \(|\eta|<1.7\) is provided by a sampling calorimeter made of iron and scintillating tiles (TileCal). The TileCal is separated into a large barrel (\(|\eta|<0.8\)) and two smaller extended barrel cylinders (\(0.8<|\eta|<1.7\)). In the end-caps (\(1.5<|\eta|<3.2\)), LAr technology with copper absorbers is used for the hadronic calorimeters (HEC). The copper/tungsten-liquid argon forward calorimeters (FCal) provide both electromagnetic and hadronic energy measurements, and extend the coverage to \(|\eta|<4.9\).

The muon spectrometer is based on the magnetic deflection of muon tracks in the large superconducting air-core toroid magnets, instrumented with separate trigger and high-precision tracking chambers. A system of three large air-core toroids, a barrel and two end-caps, generates the magnetic field for the muon spectrometer in the pseudorapidity range of \(|\eta|<2.7\).

Calorimeter simulation model

The aim of the fast calorimeter simulation FastCaloSim is to provide a sufficiently good simulation to run the same standard ATLAS detector reconstruction software as is used with data and Geant 4 simulated events. Here "sufficiently good" means that the key features of reconstructed object properties are well reproduced. Differences in details due to simplifications in the simulation model have to be accepted, but should not lead to large and unpredictable differences at the analysis level.

In order to evaluate the performance of the calorimeter simulation, the inner detector and the muon system are simulated with Geant 4. This combination of full and fast simulation is called Atlfast-II in the following and reduces the overall simulation time by approximately one order of magnitude (see Section 3.5 and Table 1). However, it is also possible to use a combination of the fast calorimeter simulation and of the ATLAS fast track simulation FATRAS [5] for the inner detector and the muon system, called Atlfast-IIF, which reduces the overall simulation time by another order of magnitude.

### Simplifications

It is clear that any significant improvement in speed must stem from simplifications in the simulation model. The design baseline was to make the simulation algorithm as fast as possible in all areas that cost a large amount of time. Hence the following decisions were taken:

* The simulation uses the reconstruction geometry of the calorimeter that describes calorimeter cells as cuboids in \(\eta\), \(\phi\) and the depth of the calorimeter (forward calorimeter cells are cuboids in x,y,z). This is a reasonable assumption for the homogeneous regions of the EM calorimeter, but only an approximation for the other calorimeters or for calorimeter edge regions.
* The simulation of the development of particle showers in the calorimeter takes a large amount of time and is therefore replaced by parametrizations. The fast simulation model reproduces the longitudinal shower properties, including fluctuations and correlations, but only average lateral shower properties and uncorrelated lateral energy fluctuations.
* Only three types of particles are parametrized and used for the simulation: photons, electrons and charged pions. The charged pion parametrization is used for all hadrons (neutral and charged). A refined treatment of the response to different hadrons is under development.

### Geant 4 parametrization template

The parametrizations used in FastCaloSim are based on \(\sim\)\(30\cdot 10^{6}\) single particle events simulated with Geant 4 in the energy range between 50 MeV and 1 TeV and in the full pseudorapidity range of the ATLAS calorimetry \(0<|\eta|<4.9\). The energy and rapidity ranges are subdivided into 16 constant energy points and 100 equidistant bins in \(|\eta|\), respectively.

For the photon and charged pion parametrization, corresponding particles are used that are generated with their origins distributed according to the beam spot and which pass the inner detector without hard interactions. For the electron parametrization, the simulated electrons were generated with their origin at the surface of the calorimeter cryostat in order to avoid bremsstrahlung in the Inner Detector. Calorimeter noise is not simulated for these input samples, in order to reduce the needed amount of single particle events. In the fast calorimeter simulation, the noise is added in the same way as for the full simulation, using the detector electronics digitization code [4].

### Longitudinal shower shape parametrization

The total energy deposition and the longitudinal shower development are parametrized as a function of the longitudinal shower depth (the energy weighted distance of depositions from the calorimeter surface). For the calorimeter energy, an internal layer-based calibration is used. The calibration constants are fitted individually for all particle energy and \(|\eta|\) points to ensure an average response of unity and a minimal resolution. This internal calibration improves the quality of the simulation of the energy response of physics objects after their respective calibration procedures in the object reconstruction. The longitudinal shower depth is subdivided into \(\sim\)10 bins of equal probability and all following parametrizations are performed as function of these bins.

In order to preserve the correlation between the calibrated energy response and the shower depth, a 2-dimensional histogram of both properties is used as a basis of the parametrization. Figure 1 shows this correlation for photons and charged pions of 200 GeV energy in the range \(0.20<\eta<0.25\).

In a similar way, the energy in each calorimeter layer is stored as 2D histograms of the energy fraction in this layer versus the shower depth. Finally, in order to preserve the correlation between the different energy fractions (the sum of all fractions should be unity), one correlation matrix of the energy fractions in each calorimeter layer is built for each bin in the shower depth.

During the simulation of particles in the calorimeter, a random total energy response and shower depth is determined from the corresponding histogram for the appropriate particle species, energy and pseudorapidity region. Following this, random energy fractions in each calorimeter layer are determined from the distribution of the fraction histograms using correlated random numbers created according to the energy fraction correlation matrix. As a last step, the raw energy response is recovered by inverting the calibration step that was performed as first step of the parametrization.

### Lateral shower shape parametrization

The fast calorimeter simulation aims for a good description of the average lateral energy distribution of particle showers within each calorimeter layer. Figure 2 (left) shows an example lateral energy profile in the second electromagnetic calorimeter layer obtained from the the average cell energies of a large sample of simulated photons.

Figure 1: Correlation of the calibrated energy response and the longitudinal shower depth for simulated photons (left) and charged pions (right) of 200 GeV energy in the range \(0.20<\eta<0.25\). The color of a given point shows the relative probability density in a linear color scale from blue (low probability) to red (high probability). The black bars indicate the mean and width of a Gaussian fit in each bin of the shower depth. The dynamic range of the x-axis is chosen to contain 99% of all events and the y-axis to contain 99.5% of all events.

The basic parametrization ansatz for the lateral energy distribution is a radial symmetric function centered on the expected impact point of a particle into a calorimeter layer. Cell energies are simulated by integrating the shape function within the area of a calorimeter cell and then adding fluctuations according to the intrinsic energy resolution of the calorimeter technology.

The basic radial energy dependency of the shape function is described by a third order polynomial spline function. The radial symmetric shape is then modified by parameters accounting for the asymmetry created by particles crossing a calorimeter layer at an angle that is not perpendicular to a layer surface and parameters that describe the effective shape distortion in \(\phi\) caused by the accordion geometry of the electromagnetic LAr calorimeters. The spline function and the additional parameters are obtained in a global fit to all particles inside the same category, where each category is differentiated by the particle type, energy, pseudorapidity, the bin in the shower depth distribution and the calorimeter layer. The dependence of the lateral shape function on the bin in the longitudinal shower depth introduces a correlation between the longitudinal and lateral shower shape that is needed for a good simulation of the overall shower properties. Figure 2 (right) shows the ratio between simulated cell energies and the parametrized shape function for photons of 200 GeV energy in the second electromagnetic barrel calorimeter layer.

The ansatz of an average lateral shape is well suited for photons and electrons, but not adequate for hadrons. Hadronic showers show a complex interplay of relatively long distances traveled by secondary hadrons and localized energy depositions caused by photons produced in the decay of secondary neutral pions. This leads to large fluctuations in the longitudinal and lateral energy distribution. While the longitudinal fluctuations are contained and described by the parametrization model of FastCaloSim, the lateral hadron shapes are not well reproduced yet. However, an improved lateral shower shape model for hadrons is currently in development.

### Computing performance

The improvement reached in the event simulation speed by using FastCaloSim was evaluated in Ref. [4] with a representative set of Monte Carlo event samples, comparing the full Geant 4 simulation, the fast

Figure 2: Lateral energy distribution of simulated photons of 200 GeV energy in the range \(0.20<\eta<0.25\) in the second electromagnetic calorimeter layer. Left: Profile histogram of the average simulated cell energy as function of the distance in \((r*\Delta\eta,r*\Delta\phi)\) of the cell from the expected photon impact point into the calorimeter layer. The black circle indicates the area where a parametrization of the shape is created. Right: Average ratio between the simulated cell energies and the cell energies calculated from the parametrized lateral shower shape as function of the distance in \((r*\Delta\eta,r*\Delta\phi)\) of the cell from the expected photon impact point into the calorimeter layer.

Geant 4 simulation2, Alffast-II and Alffast-IIF. Table 1 shows the average event simulation time for all tested samples and simulation flavors3. Compared to the full Geant 4 simulation, Alffast-II increases the simulation speed by an approximate factor \(\sim\)20 due to the use of FastCaloSim alone. However, in this configuration the calorimeter is no longer the most time consuming component. When FastCaloSim is combined with the fast inner detector and muon system simulation FATRAS, as in Alffast-IIF, the simulation time can be reduced by approximately a factor 100.

Footnote 2: the fast Geant 4 simulation uses a combination of shower parametrizations and shower libraries inside Geant 4.

Footnote 3: Recent improvements promise considerable reductions in the simulation time for all simulation flavors

The variation of the per event simulation time is shown in Figure 3 for \(t\bar{t}\) events. As can be seen, the relative variation in the CPU time requirement is approximately identical for all simulation flavors and the simulation time is decreased for all events by roughly the same factor.

## 4 Simulation validation

The first step in the validation of the FastCaloSim performance for electromagnetic energy depositions is to compare the response of single photons and electrons to that obtained with the full Geant 4 simulation. This basic test can confirm that there are no important physics effects neglected by the FastCaloSim

\begin{table}
\begin{tabular}{l l l l l} \hline \hline
**Sample** & **Full G4 Sim** & **Fast G4 Sim** & **Atflfast-II** & **Atflfast-IIF** \\ \hline Minimum Bias & 551. & 246. & 31.2 & 2.13 \\ \(t\bar{t}\) & 1990 & 757. & 101. & 7.41 \\ Jets & 2640 & 832. & 93.6 & 7.68 \\ Photon and jets & 2850 & 639. & 71.4 & 5.67 \\ \(W^{\pm}\to e^{\pm}\nu_{e}\) & 1150 & 447. & 57.0 & 4.09 \\ \(W^{\pm}\rightarrow\mu^{\pm}\nu_{\mu}\) & 1030 & 438. & 55.1 & 4.13 \\ \hline \hline \end{tabular}
\end{table}
Table 1: Simulation times per event, in kSI2K seconds, for the full Geant 4 simulation, fast Geant 4 simulation, Alfvén-II, Alffast-IIF [4]. Alffast-II uses the full simulation for the inner detector and muon system and FastCaloSim in the calorimetry. Alffast-IIF uses FastCaloSim for the calorimetry and FATRAS for the inner detector and muon system. All times are averaged over 250 events.

Figure 3: Distributions of CPU time for 250 \(t\bar{t}\) events in full Geant 4, fast Geant 4, and Atlfast-II simulations [4]. The vertical dotted lines denote the averages of the distributions.

method, and that the parameterization binning has sufficient granularity to model all detector inhomogeneities. Single particle validation is a useful step before a more "physics" oriented validation using more complex event topologies and more conventional simulation parameters.

### Photon validation

Figure 4 compares the FastCaloSim and Geant 4 response for the total energy deposited in the EM calorimeter for photons of 20 GeV energy entering the calorimeter in the region \(1.00<\eta<1.05\). The electronic calorimeter noise is not simulated in either cases in order to increase the sensitivity to the intrinsic shower properties. Three metrics are used to test the consistency: the mean value of the distribution, the RMS of the distribution and a Kolmogorov-Smirnov (K-S) test between the distributions obtained with FastCaloSim and the full Geant 4 simulation. For this data point, the results are:

These tests have been performed for a range of energies and pseudorapidities. Figure 5 summarizes the results for the mean and RMS for photons generated with an energy of 20 GeV. A point is considered "good' if the mean energy and RMS resolutions agree to within \(3\sigma\) or if the K-S test probability is greater than 0.01. In general, FastCaloSim reproduces the full simulation well, except for the calorimeter transition region near \(|\eta|=1.5\). At the lowest probed energy of 1 GeV discrepancies are also visible at \(|\eta|>3.5\). For the highest energies (\(\geq 50\) GeV) the RMS responses differ by more than \(3\sigma\) for some points in the range \(|\eta|<0.7\).

Similar studies have been performed for many other variables used for the identification of photons. An example is given in Figure 6, which compares FastCaloSim and Geant 4 simulation using the shower

Figure 4: Comparison of the total energy response \(E_{TOT}\) in the EM calorimeter for Atlfast-II and the full Geant 4 simulation for photons with a true energy of 20 GeV in the pseudorapidity range \(1.00<\eta<1.05\).

shape variable \(w_{\eta 2}\), the lateral width calculated in a window of \(3\times 5\) cells in the second electromagnetic calorimeter layer using the energy weighted sum over all cells [6].

### Electron validation

To compare the electron reconstruction and trigger efficiencies a sample of \(Z\to ee\) events generated by the Pythia[7] Monte Carlo generator were used. The same set of Monte Carlo events were passed through either the full Geant 4 simulation and reconstruction chain or through Atlfast-II followed by the same reconstruction chain. Both the full simulation and Atlfast-II samples were then passed through the same analysis code and no corrections were applied to either of the samples. Electrons were preselected within the rapidity range \(|\eta|<2.47\), but not in the range \(1.37<|\eta|<1.52\). To allow for an efficiency comparison down to low values, no cut was placed on the transverse momenta of the reconstructed electrons.

Figure 5: Comparison between Atlfast-II and the full Geant 4 simulation of the mean value (left) and RMS (right) of the total energy response \(E_{TOT}\) in the EM calorimeter for photons of 20 GeV energy in the whole pseudorapidity range covered by the ATLAS calorimeter system.

Figure 6: Comparison between Atlfast-II and the full Geant 4 simulation of the mean value (left) and RMS (right) of the lateral width \(w_{\eta 2}\) (WETA2) in the second EM calorimeter layer for photons of 20 GeV energy in the pseudorapidity range of \(|\eta|<2.5\).

Figure 7 shows the electron reconstruction efficiency for electrons passing the _medium_ quality electron selection [8, 9] and matched to a truth electron within a distance of \(dR<0.1\). The selection efficiencies are calculated with respect to truth electrons with a transverse momentum \(p_{\rm T}>5\) GeV and in the rapidity range \(|\eta|<2.5\). The Alffast-II simulation reproduces the full Geant 4 simulation within the statistical precision at the 5% level or better.

In Figure 8 the combined trigger efficiency for the event filter EF_e10_loose trigger, including the relevant Level 1 and Level 2 triggers, is shown. This trigger selects a _loose_ quality electron with an \(E_{\rm T}\) threshold of 10 GeV[10]. The trigger efficiency is calculated with respect to offline electrons that pass the electron preselection. To determine if the offline electron has been triggered, it is required to be matched within a distance of \(dR<0.2\) to a relevant trigger Region of Interest (ROI). It can be seen that within the statistical precision the Alffast-II simulation reproduces the full Geant 4 simulation at the 5% level or better.

Figure 8: Trigger efficiency of the EF_e10_loose trigger with respect to offline _loose_ electrons [8, 9], as a function of \(p_{\rm T}\) (left) and pseudorapidity (right). The black points show the full Geant 4 simulation and the red points the Atlfast-II simulation.

Figure 7: Electron identification efficiency for _medium_ quality electrons [8, 9], with respect to truth electrons, as a function of \(p_{\rm T}\) (left) and pseudorapidity (right). The black points show the full Geant 4 simulation and the red points the Atlfast-II simulation.

Response of the calorimeter to charged hadrons

The calorimeter response to charged hadrons is quantified computing the ratio between the energy \(E\), deposited by a single isolated charged particle in the calorimeter, and the momentum \(p\) of the corresponding track. The ratio \(E/p\) has been extensively studied in Ref. [11] and this study follows the reference closely, using the same event selection.

### Monte Carlo samples and event selection

For the MC simulation, non diffractive (ND) minimum bias events are generated with Pythia[7] and the detector is simulated with both the standard Geant 4 simulation and with Atlfast-II. The two resulting MC samples consist of 1 million events each.

To compare the charged hadron response in the two detector simulations, the energy deposits from a particle are defined as those within a cone of \(\Delta R<0.2\) of the extrapolated particle track impact point into the calorimeter. In Ref. [11] the energy was reconstructed from topological clusters. In the following, the same procedure is repeated, but using calorimeter cells instead. Tracks are required to satisfy the following requirements: they should be good quality tracks4 with a transverse momentum \(p_{T}>0.5\) GeV and isolated in the inner detector system without any other track candidate with \(p_{T}>0.1\) GeV within a cone of \(\Delta R<0.4\).

Footnote 4: good quality tracks have at least 1 hit in the Pixel detector, 6 hits in the SCT detector and small transverse and longitudinal impact parameter with respect to the primary vertex (\(|d_{0}|<1.5\) mm, \(|z_{0}|\sin\theta<1.5\) mm) [12]

The requirement for the isolation of tracks reduces the probability of the energy measured in the \(\Delta R<0.2\) cone to be contaminated by showers produced by other charged particles. The same does not hold for showers initiated by photons (\(\pi^{0}\to\gamma\gamma\)) or neutral hadrons (mostly \(K_{L}^{0}\) and neutrons), for which a dedicated background estimation, based on in-situ measurements, has been performed.

As described in Ref. [11], the idea of the background estimation is to take advantage of those charged hadrons behaving like minimum ionizing particles (MIP) in the EM calorimeter, so that, apart from the energy deposited in a cone of \(\Delta R<0.1\) around the MIP track, all the remaining energy will be due to showers from neutral particles. We can then define the background as the quantity \(\langle E/p\rangle_{BG}=(E_{\rm EM}^{0.2}-E_{\rm EM}^{0.1})/p\), where the average is performed over many events in each bin of momentum and pseudorapidity. \(\langle E/p\rangle_{BG}\) is then subtracted from the total in order to estimate \(\langle E/p\rangle\).

### Results

Following the procedure described in Section 5.1 to select the events and to subtract the background, the results in Figure 9 were obtained. Here, the average \(\langle E/p\rangle\) is shown for the central region of the detector (\(0.0<\eta<0.6\)) for tracks with \(p>2\) GeV. In Ref. [11] it was shown that the agreement of the full Geant 4 simulation to data is better than 5% in this region. The discrepancies between Atlfast-II and the full Geant 4 simulation are below the level of 10%, taking into account the statistical error. For intermediate values of \(p\) the Atlfast-II simulation tends to systematically overestimate \(\langle E/p\rangle\). These indications of a bias in Atlfast-II are currently under investigation.

## 6 Comparison of jet and missing transverse energy observables

The calorimeter observables of jets and missing transverse energy and their reconstruction performance are a good test of the overall quality of the Atlfast-II simulation. In this section the Atlfast-II performance for jets and missing transverse energy is compared to the full Geant 4 detector simulation of non-diffractive minimum bias events. Details for the event selection and the analysis of jet observablesare described in Ref. [13, 14]. Details for the analysis of the missing transverse energy observables are described in Ref. [15, 16].

### Jets

Jets are reconstructed using the anti-\(k_{t}\) algorithm [17] with a distance parameter of \(R=0.6\). The inputs to the algorithm are topological clusters [18] which aim at a reconstruction of the three-dimensional shower of each particle entering the calorimeter. Measured jets are calibrated to the hadronic scale with a \(p_{\mathrm{T}}-\) and \(\eta-\) dependent calibration scheme derived from the Geant 4 Monte Carlo simulation (EM+JES calibration [19]). In the following, all events are required to have at least one jet with a transverse momentum above 20.

#### 6.1.1 Kinematic Distributions of Jets

Figures 10 show the jet transverse momentum (\(p_{\mathrm{T}}\)) and rapidity (\(y\)) distributions for jets with \(p_{\mathrm{T}}>30\) in the full Geant 4 and the Alffast-II simulations. The jet \(p_{\mathrm{T}}\) distribution is well described by the Alffast-II simulation, but some discrepancies in the rapidity distributions are seen between Alffast-II and the full Geant 4 simulation. Further studies show that the discrepancies in Alffast-II appear for low momentum jets and are related to the shortcomings of the lateral shower model in FastCaloSim (see Section 3.4). Studies indicate that jet reconstruction techniques which are less sensitive to lateral shower shape profiles result in distributions that agree better with the full Geant 4 simulation. The Alffast-II bias in the central region \(|\eta|<0.4\) is under investigation.

Figure 9: \(\langle E/p\rangle\) as a function of the track momentum, for \(0.0<\eta<0.6\). The black open circles represent the MC minimum bias Alfast-II prediction and the green rectangles the Geant 4 simulation prediction. The lower plot shows the ratio between Alfast-II and the full Geant 4 simulation, with dotted lines placed at \(\pm 10\%\) from unity.

#### 6.1.2 Jet Energy Scale and Resolution

Jets play an important role in many analysis and the description of their energy scale and resolution are crucial. Figure 11 shows the \(p_{\mathrm{T}}^{\mathrm{rec}}-p_{\mathrm{T}}^{\mathrm{true}}\) distribution for reconstructed jets with \(p_{\mathrm{T}}>20\GeV\) and \(|y|<2.8\), where \(p_{\mathrm{T}}^{\mathrm{rec}}\) and \(p_{\mathrm{T}}^{\mathrm{true}}\) are the reconstructed and true jet momenta, respectively. A matching criteria of \(\Delta R<0.2\) between the reconstructed and the true jet is applied, where \(\Delta R\) is the distance in \(\eta-\phi\) space. The jet energy scale in Alfast-II is well reproduced and also the energy resolution agrees reasonably well within the uncertainties of the calibration.

### Missing transverse energy

The performance of the reconstruction of the missing transverse energy (\(E_{\mathrm{T}}^{\mathrm{miss}}\)) with the calorimeter depends on the proper simulation of the calorimeter response to all interacting particles in all calorimeter regions. \(E_{\mathrm{T}}^{\mathrm{miss}}\) is therefore a sensitive probe of the overall calorimeter simulation quality.

The missing transverse energy is reconstructed only from calorimeter cells associated to topological clusters using the formulae:

\[E_{\mathrm{x}}^{\mathrm{miss}} = -\sum_{i=1}^{N_{\mathrm{cell}}}E_{i}\sin\theta_{i}\cos\phi_{i}, \tag{1}\] \[E_{\mathrm{y}}^{\mathrm{miss}} = -\sum_{i=1}^{N_{\mathrm{cell}}}E_{i}\sin\theta_{i}\sin\phi_{i},\] (2) \[E_{\mathrm{T}}^{\mathrm{miss}} = \sqrt{E_{\mathrm{x}}^{\mathrm{miss}^{2}}+E_{\mathrm{y}}^{\mathrm{ miss}^{2}}}, \tag{3}\]

where \(E_{i}\), \(\theta_{i}\), \(\phi_{i}\) and \(N_{\mathrm{cell}}\) are the calorimeter cell energies, the polar and azimuthal angles and the number of calorimeter cells associated to topological clusters, respectively. A full description of the \(E_{\mathrm{T}}^{\mathrm{miss}}\) reconstruction is given in Ref. [16].

Figure 10: Jet \(p_{\mathrm{T}}\) (left) and rapidity (right) distributions for jets with \(p_{\mathrm{T}}>30\GeV\) and \(|y|<2.8\). The filled histogram shows the full Geant 4 simulation and the open squares with error bars show the Alfast-II simulation, respectively. The EM+JES calibration is applied. The total numbers of jets are normalized to unity.

Figure 12 shows the distributions of \(E_{\mathrm{x,y}}^{\mathrm{miss}}\) and \(E_{\mathrm{T}}^{\mathrm{miss}}\). The Atlfast-II distributions agree sufficiently well with the ones from the full Geant 4 simulation.

As a further test of the calorimeter response, the contributions of jets and low energetic clusters that are not associated to any reconstructed object are compared. Figure 13 shows \(E_{\mathrm{T}}^{\mathrm{miss}}\) reconstructed using cells associated to jets and \(E_{\mathrm{T}}^{\mathrm{miss}}\) reconstructed using clusters not associated to any reconstructed object, where the cell energies are calibrated by applying cell-level signal weights which compensate for the different calorimeter response to hadronic and electromagnetic energy deposits (global cell energy-density weighting calibration, GCW) [16]. The distributions of the two simulations agree reasonably well with each other for both \(E_{\mathrm{T}}^{\mathrm{miss}}\) components.

Figure 11: The \(p_{\mathrm{T}}^{\mathrm{rec}}-p_{\mathrm{T}}^{\mathrm{true}}\) distribution of the non-diffractive minimum bias process for reconstructed jets with \(p_{\mathrm{T}}>20\) GeV. The filled histogram show the full Geant 4 simulation and the open squares with error bars show Atlfast-II.

Figure 12: Distributions of \(E_{\mathrm{x,y}}^{\mathrm{miss}}\) (left) and \(E_{\mathrm{T}}^{\mathrm{miss}}\) (right) for events with at least one jet with \(p_{\mathrm{T}}>20\) GeV reconstructed using the EM scale signals for all cells. The filled histogram shows the full Geant 4 simulation and the open squares with error bars show Atlfast-II, respectively.

## 7 Conclusion

The fast calorimeter simulation FastCaloSim has been developed in order to reduce the simulation time in the ATLAS calorimeter system from several minutes to a few seconds per event, using a parametrization model for the longitudinal and lateral shower development of photons, electrons and charged pions. The fast simulation performance was validated against the full Geant 4 based detector simulation for photons, electrons and isolated charged hadrons.

Finally, the performance for the simulation of jets and the missing transverse energy was compared between Alffast-II and the full Geant 4 simulation. Overall a good agreement between Alffast-II and the full Geant 4 simulation is observed inside the tested kinematic reach.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3 S08003** (2008).

* [3] A.Ribon et al., _Status of Geant4 hadronic physics for the simulation of LHC experiments at the start of LHC physics program_, CERN-LCGAPP-2010-01 (2010).
* [4] ATLAS Collaboration, and others, _The ATLAS Simulation Infrastructure_, arXiv:1005.4568 [physics.ins-det].
* [5] K. Edmonds et al., _The Fast ATLAS Track Simulation (FATRAS)_, Tech. Rep. ATL-SOFT-PUB-2008-001, CERN, Geneva, Mar, 2008.
* [6] ATLAS Collaboration, _Evidence for prompt photon production in \(p\)\(p\) collisions at \(s\) = 7 TeV with the ATLAS detector_, Tech. Rep. ATLAS-CONF-2010-077, CERN, Geneva, Jul, 2010.
* [7] T. Sjostrand et al., _PYTHIA 6.4 physics and manual_, JHEP05 **026** (2006).

Figure 13: Distribution of \(E_{\mathrm{T}}^{\mathrm{miss}}\) for events with at least one jet with \(p_{\mathrm{T}}>20\) computed from cells from topological clusters in jets (left) and \(E_{\mathrm{T}}^{\mathrm{miss}}\) computed from cells from topological clusters not contained in other reconstructed objects (right). All cell energies are calibrated with GCW. The filled histogram shows the full Geant 4 simulation and the open squares with error bars show Atlfast-II, respectively.