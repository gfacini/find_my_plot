10 June 2002

**How well can we reconstruct continuum background \(\longrightarrow\)\(b\)-jet calibration for the ATLFAST fortran framework.1\({}^{,}\)2**

Footnote 1: Supported in part by Polish Government grant KBN 2P03B11819

and by 620/E-77/SPUB-M/CERN/P-03/DZ 295/2000-2002

Footnote 2: Fortran code available from /afs/cern.ch/user/p/pbruckma/public/jets/nn_b-calibration/

**P. Bruckman**

Institute of Nuclear Physics

ul. Radzikowskiego 152 Cracow 31-342, Poland

**E. Richter-Was**

Institute of Computer Science

Jagiellonian University,

Institute of Nuclear Physics

ul. Radzikowskiego 152 Cracow 31-342, Poland

We shortly recall principles of \(b\)-jet calibration implemented presently in ATLFASTB package. Then we propose an alternative calibration based on neural network approach. Comparison of the two is shown on the Higgs signal events of \(t\bar{t}H,H\to b\bar{b}\) as well as on the different continuum backgrounds: \(t\bar{t}b\bar{b}\), \(Wb\bar{b}\) and \(Zb\bar{b}\).

Reliable calibration of jets and \(b\)-jets in the fast simulation framework is important for understanding shape and normalization of the multi-\(b\)-jet continuum backgrounds, critical for several searches of heavy resonances.

Introduction

Good calibration of four-momenta of reconstructed jets is a key quality factor in all analyzes aiming to reconstruct heavy resonances from the final hadronic states. Among all produced jets the ones originating from hadronisation of \(b\)-quarks (so called \(b\)-jets) play a distinct role in many specific analyzes, predominantly reconstruction of the Higgs boson in the lower part of its allowed mass range [1]. Precise calibration allows not only for good reconstruction of the signal events (invariant mass peak, etc.) but above all for good understanding of the underlying background shape.

The main aim of the study presented here was to verify the existing ATLFASTB jet calibration as well as to evaluate possibility of improvements. In the presented study we used simulated events of Higgs produced together with a pair of \(t\overline{t}\) quarks and decaying into a \(b\overline{b}\) pair (\(t\overline{t}H,H\to b\overline{b}\)). In such events \(b\)-jets can originate either from Higgs decay itself and contribute to the signal or from cascade decay of \(t\)'s giving rise to the combinatorial background. To further evaluate the existing calibration we checked its performance on \(t\overline{t}b\overline{b}\), \(Wb\overline{b}\) and \(Zb\overline{b}\) events which are sources of continuum background to the different Higgs searches. Important is that the latter are topologically different from the signal and therefore are particularly challenging for the calibration tuned to best reconstruct signal events.

The paper is organized as follows. In section 2 we define the simulated event samples used in this study. In section 3 we remind the principle of the the calibration currently implemented inside the ATLFASTB. In section 4 an alternative method derived using neural network tools is shortly described. Section 5 contains the comparison of results obtained from the two methods. Conclusions are given in section 6.

## 2 Studied samples

Events were generated using AcerMC matrix element Monte Carlo [2] and PYTHIA 6.2 [3]. Generated events we reconstructed using ATLFAST [4] fast simulation. Simple cone jet reconstruction was used with R=0.4.3 Energy collected within the cone was smeared with resolution \(50\%/\sqrt{E}\). This reconstruction procedure defined the raw jet momenta \(p_{T}^{\mathrm{raw}}\). Then these four-momenta should be re-calibrated in order to bring reconstructed quantity as close as possible to the partonic one. This re-calibration should correct primarily for the out-cone energy loss, semileptonic decay, particle loss because of magnetic field and some detector inefficiencies.

Footnote 3: R denotes cone radius in \((\eta,\phi)\) plane.

In the study we used resonant signal events: \(t\overline{t}H,\,H\to b\overline{b}\) for several Higgs boson mass points ranging from 80 GeV to 160 GeV with 20 GeV intervals. We generated \(4\times 10^{5}\) events for each mass point. For continuum background studies we used \(t\overline{t}b\overline{b}\), \(Wb\overline{b}\) and \(Zb\overline{b}\) events. For the first process we generated \(5\times 10^{5}\) events and \(3\times 10^{5}\) for each of the latter ones.

## 3 ATLASIB \(b\)-jet calibration

The existing ATLASIB jet calibration in realized in a relatively simple way. It is based on 1D calibration function which gives the scale factor to be applied to the energy-momentum four-vector of a reconstructed jet. The function is dependent exclusively on the raw transverse momentum of the reconstructed jet and on the type of the jet: _light_-jet or \(b\)-jet. The scaling functions as currently implemented in ATLASIB are shown in Fig. 1. They have been derived by fitting with Gaussian function peak position of the \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) distribution and taking calibration factor as the value needed to rescale this position to one. Such fit was performed for several bins of the raw transverse momentum of jets, thus giving calibration factor as a function of raw \(p_{T}\) of the jet.

As will be shown such calibration gives very good overall results in the absence of inhomogeneity of the detector. This is the case of the fast simulation where several detector effects are absent or averaged. However, this direct \(p_{T}\)-dependent re-calibration could potentially lead to biases in projection on some other variables (e.g. on pseudorapidity) and it also neglects details of event topology (jet multiplicity, angular separation, etc.). This observation was the main motivation to develop an alternative calibration which would be explicitly dependent not only on the raw \(p_{T}\) but also on the topology of the event.

Figure 1: ATLASIB calibration factors as function of raw jet transverse momentum \(p_{T}^{\rm raw}\) for \(b\)-jets and _light_-jets.

## 4 NN \(b\)-jet calibration

The alternative calibration proposed here is based on similar goals:

1. use only jet-level information (four-momenta of reconstructed jets);
2. re-calibrate by scaling the whole four-momentum, i.e. without altering jet direction;
3. optimize jet \(p_{T}\) and di-jet mass reconstruction in terms of a Gaussian fit to the bulk of the spectrum distribution;
4. provide an easy to use and fast user interface.

To realize the above conditions a two-stage calibration was found to offer the best performance. It consists of:

* neural network calibration to optimize w.r.t. several available variables,
* fit to the \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) profile to fine tune the \(p_{T}\) calibration in the peak region.

The earlier aimed to optimize jet calibration in the multi-dimensional space. However, since this NN procedure corresponds to a \(\chi^{2}\) minimization it is very sensitive to the whole \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) distribution in particular to its tail regions. This is why the direct fine tuning based on Gaussian fits had to be applied in the second stage to satisfy the point (3) from the above list.

### Stage I - neural network re-calibration

The neural network calibration was devised to optimize transverse momentum reconstruction. The net had a "normal feed forward" structure with four inputs, one hidden layer of 18 nodes and one output variable. The net inputs were:

1. \(p_{T}\) of the jet (raw - as reconstructed by the jet-finding algorithm).
2. \(E\) of the jet (raw),
3. pseudorapidity (\(\eta\)) of the jet,
4. \(\Delta R\) to the closest jet

and the output is trained to best reproduce transverse momentum of the initial parton (\(b\)-quark) i.e.: \(p_{T}^{\rm jet}=p_{T}^{b-{\rm quark}}\). NN was implemented as Multi-Layer Perceptron (MLP) in PAW [5] and used 'hybrid linear-BFGS' learning method (default). For the purpose of this study the net was trained on signal vents i.e. \(b\)-jets from Higgs decay (\(t\overline{t}H,\;\;H\to b\overline{b}\)). The training sample was \(2\times 10^{5}\) events.

Only two quality requirements were applied on the jets used for training:

1. \(\Delta R_{b-{\rm quark}}^{\rm jet}<0.2\) to ensure good association,
2. \(p_{T}^{\rm jet}/p_{T}^{b-{\rm quark}}<2.0\) to eliminate outlayers.

The first cut was applied to ensure good association of jets to their initial quarks. There is no clear jet history which can be unambiguously derived from the event record and the angular coincidence remains the only strong criterion. The second cut had to eliminate outlayer examples. Reconstructed energy twice larger than the energy of initial parton is highly suspicious. Usually, it means again a jet-parton mis-association or large migration of the energy originating from QCD shower of another parton into the cone of the studied jet. Due to the \(\chi^{2}\) nature of the NN optimization such events influence and significantly bias the result.

Fig. 2 shows the convergence process of the NN training over 100 epochs. Clearly, there is no sign of overtraining and the minimization is smoothly converging. More epochs (e.g. 200) has also been tried but this did not lead to any further improvement of the optimization (although was still free from signs of overtraining). In fact some characteristics even indicate that the neural network structure should be enlarged in order to increase number of degrees of freedom. Such a change should improve the overall quality of NN response. The effect of the NN calibration is shown in Fig. 3. It shows the \(p_{T}^{\rm jet}/p_{T}^{b-quark}\) distribution as a function of \(p_{T}^{\rm raw}\) before and after re-calibration (top and middle plots respectively). On the bottom plot the distribution after re-calibration is shown in terms of mean values of Gaussian fits to the slices of the corresponding

Figure 2: Convergence of the MLP neural network over 100 epochs. The net was trained on \(2\times 10^{5}\)\(t\bar{t}H\), \(H\to b\bar{b}\) events.

2D histogram. It reveals the remaining calibration imperfection. Some insight into the corresponding mechanism of NN optimization can be found in the Appendix.

### Stage II - \(p_{T}\) fine tuning

In order to fully satisfy the goal (3) listed in at the beginning of Section 3 one has to further fine tune the calibration. This time the procedure in almost identical to the one used in the standard ATLFAST B jet calibration. The remaining deviation from one of the \(<p_{T}^{\rm jet}/p_{T}^{b-{\rm quark}}>\) is approximated by a third order polynomial as shown on the bottom plot of Fig. 3. The obtained correction is applied on top of the Stage I NN re-calibration. It should be noted here that the polynomial correction was applied to all jets down to the lowest \(p_{T}^{\rm jet}\) although in this region points do not follow the fitted function. It was done to suppress already large calibration factors in the low \(p_{T}^{\rm jet}\) range. As will be shown this does not significantly influence invariant mass reconstruction neither for the signal nor for the background.

Figure 3: \(p_{T}^{\rm jet}/p_{T}^{b-{\rm quark}}\) as a function of uncalibrated \(p_{T}^{\rm raw}\). The top and the middle plots show the 2D distributions for jets before and after NN calibration respectively. Points on the bottom plot show mean values of Gaussian fits to slices of the 2D histogram for calibrated jets.

Figure 4: Reconstruction of a \(b\)-quark \(p_{T}\) from the reconstructed and calibrated jets in \(t\bar{t}H\),\(H\to b\bar{b}\) events. ATLFASTB calibration applied.

Figure 5: Reconstruction of a \(b\)-quark \(p_{T}\) from the reconstructed and calibrated jets in \(t\bar{t}H\), \(H\to b\bar{b}\) events. NN calibration applied.

[MISSING_PAGE_FAIL:8]

In Fig. 6 one can see how the neural network tries to flatten the response projected on jet pseudorapidity \(\eta\). The ATLFASTB calibration is not dependent on the actual value of \(\eta\). For large \(|\eta|\) it leads to over-calibration of \(p_{T}^{\rm jet}\) by around 3%. Unlikely, NN gets \(\eta\) as an input and tries to make use of it. However, from the resulting shape of \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) profile it can be seen that NN has still difficulties to do the job correctly. Most likely the net structure should be made more complex (more hidden layers or second hidden layer). The observed shape indicates too few DoF's of the imposed fit. The shape of the

Figure 8: \(p_{T}\) of the system of two _b_-jets compared to \(p_{T}\) of corresponding partonic system for \(\Delta R_{|j|}>0.7\).

plots from Fig. 6 are reflected in the stability of peak positions of \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) distributions. These are shown for central and forward jets separately in Fig. 7. Indeed, NN calibration results in better stability of the peak position.

Fig. 8 shows how \(p_{T}\) of a pair of \(b\)-quarks is reproduced from jets after calibration. A cut \(\Delta R_{\rm jj}>0.7\) was applied here to ensure good separation of the two jets.4 As before, jets originated from \(b\)'s from Higgs decay in the \(t\overline{t}H\) events. Here we used sample of Higgs events generated with mass of 120 GeV. In case of large cone separation both calibration methods lead to spectra where parton level distributions are very nicely reproduced by the reconstructed jets. On the plots lighter line corresponds to the parton level while darker one to reconstructed jets.

Footnote 4: \(\Delta R_{\rm jj}\) denotes cone separation in (\(\eta\),\(\phi\)) plane.

Finally, we show \(p_{T}\) resolution (distribution of \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\)) for different ranges of \(p_{T}\). Again \(b\)-jets come from Higgs decay in the \(t\overline{t}H\) events. Figures 9 and 10 show plots obtained with ATLFASTB calibration and figures 11 and 12 show an identical set of plots obtained using NN calibration. As could be expected already from Fig. 4, there is no substantial difference between the two calibrations. In both cases the fitted resolution ranges from about 20% for the lowest moment a (15-25 GeV) down to below 8% in the high \(p_{T}\) range (\(>\)150 GeV). Again, however, ATLFASTB calibration results in slightly narrower fits.

### Mass reconstruction for the resonance

Fig. 13 shows the reconstruction of the Higgs invariant mass from the four-momenta of re-calibrated jets. In three rows there are plots for Higgs events generated at 80 GeV, 120 GeV and 160 GeV. Performance of the two calibrations is very similar. Both show remaining inefficiency to exactly follow the increase of generated Higgs boson mass and at 160 GeV they underestimate the peak position of invariant mass of the \(b\)-jet system by over 2%. The resolution of the invariant mass varies from about 9% for \(m_{H}=\)80 GeV to 12% for \(m_{H}=\)160 GeV.

### Mass reconstruction for the continuum

Fig. 14 shows the reconstruction of the invariant mass of two \(b\)-quarks system from the four-momenta of the re-calibrated jets. A cut \(\Delta R_{\rm jj}>0.7\) was always applied to ensure good separation of the two jets. In the first row \(b\)'s come from the combinatorial background in the \(t\overline{t}H\) events (at least one \(b\) originates from decay of a \(t\) quark). Plots in the second row come from non-resonant \(t\overline{t}b\overline{b}\) events - an irreducible background to the \(t\overline{t}H\) signal. Finally, in the bottom row one has histograms of the invariant mass of two \(b\)-quarks system as reconstructed from \(Wb\overline{b}\) and \(Zb\overline{b}\) events. They are topologically different from the \(t\overline{t}b\overline{b}\) or \(t\overline{t}H\), \(H\to b\overline{b}\) events and so they constitute a valuable test of calibration itself. On all plots lighter line corresponds to the parton level while darker one to reconstructed jets. For all three event categories the reconstruction is satisfactory. The largest difference between the performance of the two calibrations (in favor of NN method) is observed in the \(Wb\overline{b}\oplus Zb\overline{b}\) events. It can be easily explained. The \(Wb\overline{b}\oplus Zb\overline{b}\) events have predominantly soft \(b\)-jets for which NN calibration is better, compare Fig. 4 and 5 (upper right plot).

Figure 9: Distributions of \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) in \(t\bar{t}H\),\(H\to b\bar{b}\) events for different ranges of \(p_{T}\) obtained with ATLFAST calibration.

Figure 10: Distributions of \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) in \(t\bar{t}H\),\(H\to b\overline{b}\) events for different ranges of \(p_{T}\) obtained with ATLFAST calibration (cont.).

Figure 11: Distributions of \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) in \(t\bar{t}H\),\(H\to b\overline{b}\) events for different ranges of \(p_{T}\) obtained with NN calibration.

Figure 12: Distributions of \(p_{T}^{\rm jet}/p_{T}^{\rm quark}\) in \(t\bar{t}H\),\(H\to b\overline{b}\) events for different ranges of \(p_{T}\) obtained with NN calibration (cont.).

Figure 13: Invariant mass distribution of the two \(b\)-jet system from Higgs boson decay. Generated Higgs mass 80 GeV, 120 GeV and 160 GeV.

Figure 14: Invariant mass distribution of the two \(b\)-jet system from the continuum compared to the distribution of the invariant mass of the corresponding two partons. Plots obtained from \(t\bar{t}H\), \(t\bar{t}b\bar{b}\) and \(Wb\bar{b}\oplus Zb\bar{b}\) events.

Conclusions

The existing ATLFASTB \(b\)-jet calibration was compared with an alternative calibration based on neural network. Performance of the two methods are found to be similar and satisfactory. There exists an indication, however, that the NN-type calibration will be more adequate in more realistic environment, in particular in the presence of detector nonuniformities. It should also better adopt to different event topologies. For the time being, however, there is no strong evidence in favor of one or another method.

We find it an important result of the presented study that within the ATLFASTB framework continuum background spectra relevant for low mass Higgs analyzes are well reproduced from the re-calibrated jets.

The neural network calibration presented here is available in FORTRAN code from: /afs/cern.ch/user/p/bruckma/public/jets/nn_b-calibration/

## References

* [1] ATLAS Collaboration, ATLAS Detector and Physics Performance TDR, ATLAS TDR 15, CERN/LHCC/99-15, 25 May 1999.
* [2] B. Kersevan and E. Richter-Was, _The Monte Carlo event generator AcerMC version 1.0 with interfaces to PYTHIA 6.2 and HERWIG 6.3_, hep-ph0201302.
* [3] T. Sjostrand et al., _High energy physics generation with PYTHIA 6.2_, eprint hep-ph/0108264, LU-TP 01-21, August 2001.
* [4] E. Richter-Was, D. Froidevaux and L. Poggioli, ATLAS Internal Note ATL-PHYS-98-131 (1998).
* [5] PAW Reference Manual: [http://wwwinfo.cern.ch/asd/paw/reference_manual/MLP.html](http://wwwinfo.cern.ch/asd/paw/reference_manual/MLP.html).
* [6] Piotr Bialas private communication.

## 7 Appendix

Here we will recall the principle of neural network optimization and will show how the answer is returned from the proposed NN [6].

Let \(X\) be a random variable denoting some combination of data that represents the input to the neural network. This random variable is distributed according to some (unknown) probability density \(\rho(X,p_{T})\).

We can distinguish two extreme cases:

1. \(\rho\) carries no information about \(p_{T}\). The density does not depend on the \(p_{T}\): \(\rho(X,p_{T})=\rho(X)\),
2. \(\rho\) carries complete information about \(p_{T}\). There exists a function \(f(X)\) such that \(f(X)=p_{T}\) for all \(X\).

The neural network is supposed to find (or rather approximate) a function \(\pi(X)\) that minimizes the functional:

\[F[\pi]=\int\mathrm{d}X\int\mathrm{d}p_{T}g(p_{T})\rho(X,p_{T})(\pi(X)-p_{T})^{2} \tag{1}\]

Here \(g(p_{T})\) denotes the distribution of transverse momenta used for _training_ the network. This variational problem leads to an equation:

\[\int\mathrm{d}X\int\mathrm{d}p_{T}g(p_{T})\rho(X,p_{T})(\pi(X)-p_{T})\delta\pi (X)=0 \tag{2}\]

Because that has to be true for all \(\delta\pi(X)\) we finally obtain :

\[\int\mathrm{d}p_{T}g(p_{T})\rho(X,p_{T})(\pi(X)-p_{T})=0 \tag{3}\]

or

\[\pi(X)=\frac{\int\mathrm{d}p_{T}p_{T}g(p_{T})\rho(X,p_{T})}{\int\mathrm{d}p_{T }g(p_{T})\rho(X,p_{T})} \tag{4}\]

Let's see how this behaves in the two extreme cases. In the first case

\[\pi(X)=\frac{\int\mathrm{d}p_{T}p_{T}g(p_{T})\rho(X)}{\int\mathrm{d}p_{T}g(p_{ T})\rho(X)}\equiv\overline{p_{T}} \tag{5}\]

In the second case we can substitute \(f(X)\) for \(p_{T}\) and we obtain

\[\pi(X)=\frac{\int\mathrm{d}p_{T}f(X)g(p_{T})\rho(X,p_{T})}{\int\mathrm{d}p_{T }g(p_{T})\rho(X,p_{T})}=f(X)\frac{\int\mathrm{d}p_{T}g(p_{T})\rho(X,p_{T})}{ \int\mathrm{d}p_{T}g(p_{T})\rho(X,p_{T})}=f(X)=p_{T} \tag{6}\]

as expected.

Unfortunately not much can be said in general for the intermediate cases. It is, however, a safe guess to say that in a general case \(<\pi(X)>_{p_{T}^{0}}\) should lie somewhere between the perfect solution \(<\pi(X)>_{p_{T}^{0}}=p_{T}^{0}\) and the complete lack of information \(<\pi(X)>=\overline{p_{T}}\) (\(\pi\) gets trained to return the average \(\overline{p_{T}}\) fed in during the _training_ procedure). This agrees well with our intuition. We may say that diluting the information carried by \(X\) we loose our sensitivity to \(p_{T}\). The most general answer of the neural network should be of the form:

\[<\pi(X)>_{p_{T}^{0}}=\int\mathrm{d}X\rho(X,p_{T}^{0})\pi(X)=m\,(p_{T}^{0})p_{ T}^{0}+n\qquad\qquad\text{where}\qquad\quad|m|<1. \tag{7}\]

The proof of formula 7 is beyond the scope of this paper. However, it should not be surprising that in our example after the NN calibration there remains a residual inefficiency to reconstruct \(<p_{T}>\) manifested by the slope in the bottom plot of Fig. 3.