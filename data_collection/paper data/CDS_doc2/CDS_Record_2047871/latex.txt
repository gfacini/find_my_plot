# Commissioning of the ATLAS \(b\)-tagging algorithms using \(t\bar{t}\) events in early Run-2 data

The ATLAS Collaboration

###### Abstract

The efficient and accurate identification of \(b\)-jets is a vital element for much of the ATLAS Run-2 physics programme. Substantial changes to the inner tracking detector, track reconstruction, and \(b\)-tagging algorithms, have been made between Run-1 and 2, which are expected to significantly improve the \(b\)-tagging performance. This note contains a first study of the \(b\)-tagging algorithms' response to \(b\)-jets in Run-2. A di-leptonic \(t\bar{t}\) event selection is used, giving a high \(b\)-jet purity of about 69% and 99% before and after the requirement that the jets are \(b\)-tagged. Good agreement is found between the data and the simulation.

The ATLAS Collaboration

The efficient and accurate identification of \(b\)-jets is a vital element for much of the ATLAS Run-2 physics programme. Substantial changes to the inner tracking detector, track reconstruction, and \(b\)-tagging algorithms, have been made between Run-1 and 2, which are expected to significantly improve the \(b\)-tagging performance. This note contains a first study of the \(b\)-tagging algorithms' response to \(b\)-jets in Run-2. A di-leptonic \(t\bar{t}\) event selection is used, giving a high \(b\)-jet purity of about 69% and 99% before and after the requirement that the jets are \(b\)-tagged. Good agreement is found between the data and the simulation.

Introduction

The identification of jets containing a \(b\)-hadron, typically referred to as \(b\)-tagging, will play a vital role for the ATLAS experiment [1] during the LHC Run-2. It is important for both precise Standard Model measurements, including in the Higgs sector, and for exploring new physics scenarios, which have a significantly extended reach thanks to the higher centre of mass energy (\(\sqrt{s}=13\) TeV) and increased luminosity of the proton-proton collisions delivered by the LHC, compared to Run-1.

Between Run-1 and 2, a fourth pixel layer, the Insertable B-Layer (IBL) [2], was installed in the ATLAS detector between a new beam pipe with a smaller radius and the previously existing pixel detector. Due to the significantly improved impact parameter resolution, the IBL is expected to have a major impact on the \(b\)-tagging performance. In addition, the tracking and \(b\)-tagging algorithms have been revisited. In the track reconstruction domain one of the main changes is an improved handling of pixel hits shared between multiple tracks in the core of high transverse momentum (\(p_{\mathrm{T}}\)) jets [3], based on a neural network pixel hit clustering algorithm [4].

In the domain of \(b\)-tagging, a new algorithm has been developed, referred to as MV2c20. It is based on a boosted decision tree approach, which utilises jet properties and variables based on the reconstructed charged particle tracks as input. The algorithm is trained on \(b\)-jets as signal and a mix of \(c\)- and light jets, in the proportion of 80% and 20%, as background. The training is performed using simulated \(t\overline{t}\) events. The MV2c20 inputs are based on algorithms that exploit the relatively long \(b\)-hadron lifetime: a likelihood-based combination of the transverse and longitudinal impact parameter significances (IP3D), the presence of a secondary vertex and related properties (SV), and the reconstruction of the \(b-\)hadron decay chain using a Kalman filter to search for a common direction connecting the primary vertex to both the beauty and the tertiary charm decay vertices, referred to as JetFitter (JF). The expected performance of the MV2c20 tagger and the basic input algorithms are detailed in Ref. [5].

Both the incorporation of the IBL and the algorithmic enhancements in the tracking and \(b\)-tagging reconstruction are expected to lead to significant improvements in the \(b\)-tagging performance. Additionally, EvtGen[6] is now used by default in the Run-2 simulation to model the decays of \(b\) and \(c\)-hadrons, which can alter the simulated \(b\)-tagging performance. As such it is vital to validate the modelling of \(b\)-tagging related quantities. This note contains a first study of the modelling of the \(b\)-tagging in Run-2 when applied to real \(b\)-jets, using a topologically selected \(t\overline{t}\) sample which is very pure in \(b\)-jets because the \(\mathcal{BR}(t\to Wb)\) is about 99.8% and both \(W\) bosons are forced by the selection criteria to decay into leptons. The \(e\mu\) decay channel events, which have a low predicted background fraction, are used.

More detailed studies repeating the Run-1 simulation-to-data \(b\)-tagging calibration analyses [7, 8] are also being conducted.

This note is organised as follows. Section 2 outlines the data and simulated samples. Section 3 describes the physics object and event selection, with Section 4 describing the systematic uncertainties. A comparison between key \(b\)-tagging quantities in data and simulated events is presented in Section 5. Conclusions are presented in Section 6.

## 2 Data and Simulated Samples

This study is performed using \(pp\) collision data collected by ATLAS at the centre-of-mass energy of 13 TeV with 50 ns bunch-spacing. The data was collected between the 13th of June and the 16th of July 2015. The data is required to have been collected during the periods in which all the detector subsystems were operational, and corresponds to an integrated luminosity of about 85 pb\({}^{-1}\).

Monte Carlo (MC) simulated samples are used to model the relevant Standard Model physics processes. The nominal simulated \(t\bar{t}\) sample is produced using the next-to-leading order (NLO) matrix element generator Powheg-BOX[9, 10, 11] (v2) with the CT10 [12] parton distribution function (PDF) set. The parton showers and the underlying event are simulated using Pythia6[13] (v6.428) with the CTEQ6L1[14] PDF and the corresponding Perugia 2011C set of tunable parameters (tune) [15] intended to be used with this PDF. The same generators and setup are used for the dominant background process, single-top production in the \(Wt\)-channel. The diboson background contribution is estimated using the Sherpa[16] (v2.1.1) generator, where the matrix element is evaluated at NLO using the Comix[17] and OpenLoops[18] generators. The CT10 PDF set and its corresponding parton shower tuning is used. The \(Z+\)jets background contribution is simulated using the Powheg-BOX generator interfaced with Pythia8[19] (v8.186). The CT10 PDF is used in the matrix element, while for the parton shower CTEQ6L1 PDF and the corresponding AZNLO[20] tune are used. In all samples, except the ones produced with Sherpa, the EvtGen[6] (v1.2.0) generator is used to model the decays of \(b\) and \(c\)-hadrons.

The \(t\bar{t}\) MC predictions are normalised to the theoretical cross section calculated with the Top++2.0 program at next-to-next-to-leading order (NNLO) in perturbative QCD, including soft-gluon resummation to next-to-next-to-leading-log order (see [21] and references therein), and assuming a top-quark mass \(m_{t}=172.5\) GeV. The predicted value is \(\sigma_{t\bar{t}}=832^{+20}_{-30}\) (scale) \(\pm 35\) (PDF + \(\alpha_{S}\)). The first uncertainty comes from the independent variation of the factorisation and renormalisation scales, \(\mu_{f}\) and \(\mu_{r}\), while the second one is associated to variations in the PDF and \(\alpha_{S}\), following the PDF4LHC prescription with the MSTW2008 68% CL NNLO, CT10 NNLO and NNPDF2.3 5f FFN PDF sets (see references [22, 23, 24, 25]). Single-top production in the \(Wt\)-channel is normalised to the approximate NNLO cross-section of \(71.7\pm 3.8\) pb [26]. The \(Z+\)jets sample is normalised to a NNLO reference cross-section using the FEWZ[27] program with the MSTW2008 NNLO PDF[28].

To realistically model the data, additional inelastic \(pp\) interactions, referred to as pileup interactions, are overlaid on the high \(p_{T}\) process of interest, referred to in the following as the hard-scatter event. The Pythia8 generator with A2 tune[29] for MSTW2008LO PDF[28] is used for pileup interactions modelling. The simulated samples are processed through the ATLAS detector simulation[30] whereby the propagation of particles through the detector and the detector response are modelled using GEANT4[31]. Simulated events are then processed using the same reconstruction algorithms and analysis chain as the data.

## 3 Object Definitions and Event Selection

Reconstructed jets, electrons and muons are used to select a data sample enriched with \(t\bar{t}\to e\mu\nu\overline{\nu}b\bar{b}\) events. The object and event selection closely follow the selection used in Ref. [32], with three exceptions: only events with at least two jets are considered and the jet \(p_{\mathrm{T}}\) requirement is lowered from 25 to 20 GeV to correspond to the minimum \(p_{\mathrm{T}}\) value considered for \(b\)-tagging jets in analyses. In addition, for most comparisons, no \(b\)-tagging requirement is applied to the jets, so as not to bias the \(b\)-tagging distributions being studied. When a \(b\)-tag is applied, a higher efficiency working point is used.

Jets are reconstructed by clustering energy deposits in the calorimeter with the anti-\(k_{t}\) algorithm [33] and a radius parameter of 0.4, where clusters are calibrated at the electromagnetic energy scale and the hadronic scale is obtained through a \(p_{\mathrm{T}}\) and pseudorapidity1 (\(\eta\)) dependent correction factor. A 

[MISSING_PAGE_FAIL:4]

The small fake and non-promt lepton background contribution is estimated from the data using a technique described in Ref. [32]. It is based on requiring the events to pass the same event selection as the signal events, but changing the opposite-sign (OS) lepton requirement to a same-sign (SS) requirement. Given the small number of selected same-sign events in data, the background shape is taken from the \(t\bar{t}\) simulated events. The normalisation and its associated uncertainty is taken from the data. To account for differences expected between the OS and SS yields a scaling factor of \(R\)=OS/SS=\(1.5\pm 1.0\) estimated from Ref. [32] is applied to obtain the final OS background prediction.

After applying the full event selection 502 candidate events are selected in the data. The sample is predicted to be composed of approximately 93% \(t\bar{t}\) events, with \(Wt\)-channel single top forming the majority of the remaining events. The \(p_{\mathrm{T}}\) and \(\eta\) distributions of the two leading jets are shown in Fig. 1. As for all distributions shown throughout this note, the predictions from simulation are normalized to the theoretical cross sections outlined in Section 2 and to the integrated luminosity of the data. Good agreement between the data and the simulation is observed.

## 4 Systematic Uncertainties

The following sources of systematic uncertainty have been evaluated and added to the comparison plots:

Figure 1: The jet (a) and \(\eta\) (b) of the two leading jets in the selected sample of events, comparing the data (points) to the expectation from the simulated samples: \(t\bar{t}\) (white), \(Wt\) single-top (blue), \(Z\)+jets (orange) and events with mis-identified leptons (purple). The simulated diboson events are included but make a negligible contribution to the background. The ratio of the data and simulated event counts is shown in the lower panels. The dark green shaded area represents the total systematic and statistical uncertainty on the simulated events and the error on the points represents the statistical uncertainty on the data events.

* **Lepton reconstruction** The modelling of the electron and muon identification efficiency, energy scale and energy resolution in the simulation is compared to the 8 TeV[36, 38, 39] and 13 TeV[40, 37] data in \(Z\to\ell\ell\) events. Corrections that improve the modelling of the data are derived and are applied to the simulated samples' lepton offline selection. The correction factors are varied in the simulation by their associated uncertainties.
* **Jet reconstruction** The jet energy scale and resolution uncertainties used in the analysis have been derived exploiting knowledge acquired during Run-1[41] combined with detailed studies using MC simulations[34] to extrapolate these uncertainties to the expected detector configuration and conditions in Run-2. The energy scale uncertainties are evaluated using uncertainty sets with a reduced number of three nuisance parameters[42].
* **Signal modelling** Alternative \(t\bar{t}\) samples, produced with the Powheg-BOX generator interfaced with Herwig++[43] (v2.7.1) and EvtGen, and with MadGraph5_aMC@NLO (v2.2.1)[44] interfaced with Herwig++ and EvtGen are considered. In addition samples produced with the same setup as the nominal sample, but with simultaneous variations of the Powheg-BOX parameters controlling \(\mu_{f}\) and \(\mu_{r}\), the hdamp parameter and the Pythia6 parameters controlling renormalisation scales in the parton shower are used. For the sample with increased QCD radiation activity the settings hdamp=\(2m_{t}\), \(\mu_{f}\)=\(\mu_{r}\) of twice the nominal value and the Perugia 2012 radHi tune[15] are used. For the sample with decreased QCD radiation activity the settings hdamp=\(m_{t}\), \(\mu_{f}\)=\(\mu_{r}\) of half the nominal value and the Perugia 2012 radLo tune are used[45]. These variation samples are simulated using a fast detector simulation program that relies on parametrised showers in the calorimeters, while still rely on a full detector simulation in the inner detector and muon system volumes[46]. The uncertainty is extracted from the difference of the alternative sample with respect to the nominal Powheg-BOX+Pythia6 signal sample processed with the fast simulation accordingly. The contributions from individual sources are added in quadrature.
* **Signal normalisation** The normalisation of the \(t\bar{t}\) prediction is varied within the uncertainties of the theory calculation detailed in Section 2.
* **PDF uncertainties** The uncertainties are evaluated by reweighting the nominal CT10 PDF to its associated error set as well as MSTW 2008 NLO[28] and NNPDF 2.3 NLO PDF[25] and their associated error sets. All error sets are used at 68% confidence level. The final uncertainty is obtained from the envelope of the corresponding predictions following the guideline in Ref.[22]. The MadGraph5_aMC@NLO \(t\bar{t}\) sample is used for the evaluation.
* **Integrated luminosity** The uncertainty on the integrated luminosity is 9%. It is derived, following a methodology similar to that detailed in Ref.[47], from a preliminary calibration of the luminosity scale using a pair of \(x\)-\(y\) beam-separation scans performed in June 2015.

The lepton reconstruction represents a small contribution to the modelling uncertainty for the studied observables. For \(b\)-tagging related variables, the signal modelling uncertainty represents the largestcontribution, due to the change in the predicted jet flavour composition. For other observables, jet reconstruction and signal modelling uncertainties are of comparable size. Since this study is aimed at testing the \(b\)-tagging modelling, no systematic uncertainties related to \(b\)-tagging are applied.

## 5 Modelling of \(b\)-Tagging Distributions

Variables that typify the distinct properties of the basic \(b\)-tagging algorithms, IP3D, SV and JF, are shown in Figs. 2, 3 and 4 respectively. The variables are split according to the jet flavour labelling information as discussed in Section 3. The MC prediction is normalised to the same integrated luminosity as the data. In Fig. 3 results are only shown if a secondary vertex is reconstructed. No secondary vertex is found in about \(46~{}\pm~{}3\%\) and \(44\pm~{}5\%\) of jets in data and simulation respectively. In the case of the JF algorithm, no vertex with at least two tracks is found in about \(44~{}\pm~{}3\%\) and \(43\pm~{}5\%\) of data and simulation respectively. The uncertainty on the simulated fractions corresponds to the total systematic and statistical uncertainty. These cases are displayed as vertices with zero tracks in Fig. 4(b) and are not shown in Fig. 4(c). All data distributions are correctly reproduced by the simulation within the present statistical and systematic uncertainties.

The output of these algorithms is used as the input for the default Run-2 multivariate \(b\)-tagging algorithm, MV2c20, whose output distribution is shown in Fig. 5. The 77% \(b\)-jet efficiency operating point is defined by requiring that a jet has an MV2c20 output value greater than -0.4434. The \(c\), light-flavour and \(\tau\)-jet rejections (the inverse of the efficiencies) for this operating point are expected to be approximately 5, 10 and 140 respectively from simulation studies. The number of the leading two jets passing this requirement per event is shown in Fig. 6, along with their \(p_{\mathrm{T}}\) and \(\eta\) distributions in Fig. 7. A good level of agreement is found between the data and simulation within the present uncertainties.

The \(b\), \(c\) and light-flavour jet fractions are detailed in Table 1 for the following cases: the leading two jets in the event, jets in which a secondary vertex is reconstructed by the SV algorithm and jets \(b\)-tagged using the MV2c20 77% \(b\)-jet efficiency operating point.

## 6 Conclusions

This note contains a first study of the modelling of the ATLAS \(b\)-tagging algorithms in Run-2 on a high \(b\)-jet purity sample, based on a topologically selected \(t\bar{t}\) sample from 85 pb\({}^{-1}\) of \(\sqrt{s}=13\) TeV \(pp\) collisions. Input observables from the basic \(b\)-tagging algorithms and the output of the multivariate algorithm MV2c20 have been studied, and good agreement is found between the data and the simulation within the present statistical and systematic uncertainties. This is an important milestone on the way to

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline  & \multicolumn{3}{c|}{Fraction of Jets [\%]} \\ \hline Flavour & Leading Two Jets & Jets with a Secondary Vertex & \(b\)-tagged Jets \\ \hline \(b\) & 69.0 \(\pm\) 6.0 & 96.2 \(\pm\) 0.9 & 98.8 \(\pm\) 0.3 \\ Light & 28.9 \(\pm\) 6.2 & 2.5 \(\pm\) 0.8 & 0.5 \(\pm\) 0.2 \\ \(c\) & 2.0 \(\pm\) 0.5 & 1.2 \(\pm\) 0.3 & 0.8 \(\pm\) 0.2 \\ \hline \end{tabular}
\end{table}
Table 1: Predicted fractions of \(b\), \(c\) and light-flavour jets in the \(t\bar{t}\) dominated \(e\mu\) sample. The fractions are shown for three cases: the leading two jets in the event, jets in which a secondary vertex is reconstructed by the SV algorithm and jets \(b\)-tagged using the MV2c20 77% \(b\)-jet efficiency operating point. The uncertainty corresponds to the total systematic and statistical uncertainty.

Figure 2: The log likelihood ratio for the IP3D \(b\)-tagging algorithm applied to jets selected from the \(t\bar{t}\) dominated \(e\mu\) sample. The data is shown by the points and the simulation by the filled area, divided into \(b\) (red), \(c\) (light green) and light-flavour (blue) components. The ratio of the data and simulation is shown in the lower panel. The dark green shaded area represents the total systematic and statistical uncertainty on the simulation and the error on the points represents the statistical uncertainty on the data.

Figure 3: Selected properties of the secondary vertices reconstructed by the SV algorithm in jets from the \(t\bar{t}\) dominated \(e\mu\) sample: the invariant mass (a), the number of tracks (b), and the energy fraction, defined as the energy from the tracks in the displaced vertex relative to all tracks reconstructed within the jet (c) are shown. The data is shown by the points and the simulation by the filled area, divided into \(b\) (red), \(c\) (light green) and light-flavour (blue) components. The ratio of the data and the simulation is shown in the lower panels. The dark green shaded area represents the total systematic and statistical uncertainty on the simulation and the error on the points represents the statistical uncertainty on the data.

Figure 4: Selected properties of the secondary vertices reconstructed by JetFitter in jets from the \(t\bar{t}\) dominated \(e\mu\) sample: the number of 1-track vertices (a), the number of vertices with at least two tracks (b) and the number of tracks from vertices with at least two tracks (c) are shown. The data is shown by the points and the simulation by the filled area, divided into \(b\) (red), \(c\) (light green) and light-flavour (blue) components. The ratio of the data and the simulation is shown in the lower panels. The dark green shaded area represents the total systematic and statistical uncertainty on the simulation and the error on the points represents the statistical uncertainty on the data.

re-commissioning the \(b\)-tagging in Run-2, after the addition of the IBL detector and several upgrades to the tracking and \(b\)-tagging algorithms. The next step is the complete data-based calibration of the \(b\)-,\(c\)-jet efficiency and light-flavour jet mistag rate, following the approach taken in Run-1 [7, 8].

Figure 5: The output distribution of the MV2c20 algorithm applied to jets from the \(t\bar{t}\) dominated \(e\mu\) sample. The data is shown by the points and the simulation by the filled area, divided into \(b\) (red), \(c\) (light green) and light-flavour (blue) components. The ratio of the data and the simulation is shown in the lower panel. The dark green shaded area represents the total systematic and statistical uncertainty on the simulation and the error on the points represents the statistical uncertainty on the data.

Figure 6: The number of \(b\)-tagged jets per event comparing data (points) to the expectation from simulated events (filled area) in the \(t\bar{t}\) dominated \(e\mu\) sample. The MV2c20 algorithm with the 77% \(b\)-jet efficiency operating point is used. Only the leading two jets are considered and the simulated events are divided into \(bb\) (red), \(bl\) (purple), \(ll\) (blue) and \(cb/cc/cl\) (light green) components based upon their flavour. The ratio of the data and simulated events is shown in the lower panel. The dark green shaded area represents the total systematic and statistical uncertainty on the simulation and the error on the points represents the statistical uncertainty on the data.

Figure 7: The jet \(p_{\rm T}\) (a) and \(\eta\) (b) of the \(b\)-tagged jets in the \(t\bar{t}\) dominated \(e\mu\) sample. The MV2c20 algorithm with the 77% \(b\)-jet efficiency operating point is used. The data is shown by the points and the simulation by the filled area, divided into \(b\) (red), \(c\) (light green) and light-flavour (blue) components. The ratio of the data and the simulation is shown in the lower panel. The dark green shaded area represents the total systematic and statistical uncertainty on the simulation and the error on the points represents the statistical uncertainty on the data.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003.
* [2] ATLAS Collaboration, _ATLAS Insertable B-Layer Technical Design Report_, CERN-LHCC-2010-013. ATLAS-TDR-19. [https://cdsweb.cern.ch/record/1291633](https://cdsweb.cern.ch/record/1291633).
* [3] ATLAS Collaboration, _The Optimization of ATLAS Track Reconstruction in Dense Environments_, ATL-PHYS-PUB-2015-006. [http://cdsweb.cern.ch/record/2002609](http://cdsweb.cern.ch/record/2002609).
* [4] ATLAS Collaboration, _A neural network clustering algorithm for the ATLAS silicon pixel detector_, JINST **9** (2014) P09009, arXiv:1406.7690 [hep-ex].
* [5] ATLAS Collaboration, _Expected performance of the ATLAS b-tagging algorithms in Run-2_, ATL-PHYS-PUB-2015-022. [https://cdsweb.cern.ch/record/2037697](https://cdsweb.cern.ch/record/2037697).
* [6] D. Lange, _The EvtGen particle decay simulation package_, Nucl. Instrum. Meth. **A462** (2001) 152-155.
* [7] ATLAS Collaboration, _Calibration of b-tagging using dileptonic top pair events in a combinatorial likelihood approach with the ATLAS experiment_, ATLAS-CONF-2014-004. [http://cdsweb.cern.ch/record/1664335](http://cdsweb.cern.ch/record/1664335).
* [8] ATLAS Collaboration, _Calibration of the performance of b-tagging for c and light-flavour jets in the 2012 ATLAS data_, ATLAS-CONF-2014-046. [http://cdsweb.cern.ch/record/1741020](http://cdsweb.cern.ch/record/1741020).
* [9] S. Frixione, P. Nason and C. Oleari, _Matching NLO QCD computations with Parton Shower simulations: the POWHEG method_, JHEP **11** (2007) 070, arXiv:0709.2092 [hep-ph].
* [10] P. Nason, _A New method for combining NLO QCD with shower Monte Carlo algorithms_, JHEP **11** (2004) 040, arXiv:hep-ph/0409146 [hep-ph].
* [11] S. Frixione, G. Ridolfi and P. Nason, _A Positive-weight next-to-leading-order Monte Carlo for heavy flavour hadroproduction_, JHEP **09** (2007) 126, arXiv:0707.3088 [hep-ph].
* [12] H. L. Lai et al., _New parton distributions for collider physics_, Phys. Rev. **D 82** (2010) 074024, arXiv:1007.2241 [hep-ph].
* [13] T. Sjostrand, S. Mrenna and P. Z. Skands, _PYTHIA 6.4 Physics and Manual_, JHEP **05** (2006) 026, hep-ph/0603175.
* [14] J. Pumplin et al., _New generation of parton distributions with uncertainties from global QCD analysis_, JHEP **07** (2002) 012, arXiv:hep-ph/0201195.
* [15] P. Z. Skands, _Tuning Monte Carlo Generators: The Perugia Tunes_, Phys. Rev. **D 82** (2010) 074018, arXiv:1005.3457 [hep-ph].
* [16] T. Gleisberg et al., _Event generation with SHERPA 1.1_, JHEP **0902** (2009) 007, arXiv:0811.4622 [hep-ph].