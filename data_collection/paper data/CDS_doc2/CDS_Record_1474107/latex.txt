# ATLAS NOTE

ATL-PHYS-PUB-2012-003

**Summary of ATLAS Pythia 8 tunes**

The ATLAS Collaboration

###### Abstract

We summarize the latest ATLAS Pythia 8 minimum bias and underlying event tunes, making use of a new \(x\)-dependent hadronic matter distribution model. The underlying event tunes in this note have been constructed for nine different PDFs, and minimum bias tune for two different PDFs.

The ATLAS Collaboration

Introduction

In previous notes [1, 2], we presented new tunes of the Pythia 8 [3] event generator using ATLAS analysis data from the 2010 data-taking period. These tunes were named AM1 and AU1 depending on whether minimum bias (MB) or underlying event (UE) data was used in the tuning.

The Pythia 8 generator is intended as the long-term replacement for Pythia 6[4], and the migration of simulation samples to use the new C++ code in ATLAS is underway. Pythia 8 is currently used in ATLAS for the modeling of all simulated pile-up interactions, including much improved diffractive simulation relative to Pythia 6, so there is great interest in obtaining the best possible description of minimum bias interactions in addition to jet observables and the underlying event in hard-scale "signal" simulation. In this note, Pythia 8 tunes have been performed using a newly introduced feature in version 8.153, where the width of the hadronic matter distribution varies depending on the momentum fraction \(x\) of the interacting partons [5]:

\[\rho(r,x)\propto\frac{1}{a^{3}(x)}\exp(-\frac{r^{2}}{a^{2}(x)}), \tag{1}\]

with,

\[a(x)=a_{0}(1+a_{1}\ln{(1/x)}) \tag{2}\]

So far in ATLAS, tune 4C [6] with the leading order CTEQ6L1 PDF has been used. Subsequently tune 4Cx [5], based on tune 4C, but using this \(x\)-dependent matter profile was performed by the authors.

The multiple parton interaction (MPI) parameters tuned are described in Table 1, which also shows the tune 4C and 4Cx values and corresponding Pythia 6 parameters for easy reference. The parameters tuned are MultipleInteractions:ecmPow (subsequently referred to as ecmPow), MultipleInteractions:pT0Ref (subsequently refereed to as pT0Ref), BeamRemnants:reconnectRange (subsequently referred to as reconnectRange) and MultipleInteractions:a1 (subsequently referred to as a1). The a1 parameter represents the constant in the \(x\)-dependent portion of the width of the hadronic matter distribution (Eq. 2). The actual pT0 parameter used at a given CM energy scale, \(\sqrt{s}\), is obtained as

\[pT0=pT0(\sqrt{s})=pT0Ref\times(\sqrt{s}/1800)^{ecmPow} \tag{3}\]

The other parameters are the same as in tune 4C, except, SpaceShower:rapidityOrder is turned off, as there are some indications from multi-jet matching results that the shower gets closer to the matrix-element results when it is switched off. The tunes described in this note have been performed using the aforementioned new feature (MultipleInteractions:bProfile = 4, subsequently referred to as bProfile). The Pythia 8 tunes in this note include tunes shown in reference [2] for the purpose of completeness. The shower part was not tuned, as the default settings give a reasonably good description of the relevant distributions.

The PDFs used include leading order (LO), next to leading order (NLO) and MC-adapted modified leading order PDFs (MLO), as shown in Table 2, with their corresponding LHAPDF [7] codes. The MLO PDFs are constructed using leading-order (LO) matrix elements and the modified LO (mLO) approach (mLO PDFs employ a degree of sum-rule relaxation and changes in the evolution of \(\alpha_{s}\) to in principle better match MC event generator usage).

As for the previous tunings, all tuning was performed using the Rivet [14] analysis toolkit and the Professor [15] MC tuning system, now updated to versions 1.6.0 and 1.3.1 respectively. The Pythia 8version used was 8.153, with the PDFs taken from LHAPDF version 5.8.5 [7]. For LO, no difference was observed with using the Pythia-provided internal PDF set. Soft-QCD events were generated with single and double diffraction turned on, with particles having \(c\tau>10\) mm kept stable.

## 2 Tunes

The tuning strategy employed was to tune only to published ATLAS \(\sqrt{s}=\) 900 GeV and 7 TeV minimum bias (MB) [16] and leading track and cluster underlying event (UE) [17, 18] data, since it has already been seen that tuning to LHC and Tevatron data with three different centre-of-mass energies is impossible with the current models for energy extrapolation. We started with the tune 4C parameters, and tuned only the parameters mentioned before. Table 1 shows the parameter ranges used for tuning. 200 runs each with 1 million events were generated using random sampling from this parameter range, leading to comfortable degree of oversampling of 5 (\(N_{\rm min}=40\)) for cubic parameterizations

\begin{table}
\begin{tabular}{l r r r r} \hline MPI parameter & Equivalent Pythia 6 parameter & Tune 4C value & Tune 4Cx value & Sampling Range \\ \hline pT0Ref & PARP(82) & 2.085 & 2.15 & \(1.50-2.80\) \\ ecmPow & PARP(90) & 0.19 & 0.19 & \(0.14-0.30\) \\ reconnectRange & PARP(77), PARP(78) & 1.5 & 1.5 & \(0.00-9.00\) \\ bProfile & MSTP(82) & 3 & 4 & – \\ If bProfile = 2 (double-Gaussian matter dbn.) & & & & \\ coreFraction & PARP(83) & – & – & – \\ coreRadius & PARP(84) & – & – & – \\ If bProfile = 3 (exp/Gaussian overlap dbn.) & & & & \\ expPow & PARP(83) & 2.0 & – & – \\ If bProfile = 4 (varying hadronic matter distribution width) & & & & \\ a1 & None & – & 0.15 & \(0.00-1.00\) \\ \hline \end{tabular}
\end{table}
Table 1: Pythia 8 MPI parameters

\begin{table}
\begin{tabular}{l r} \hline PDF Set & LHAPDF Code \\ \hline Leading Order & \\ CTEQ6L1 [8] & 10042 \\ MSTW08LO [9] & 21000 \\ NNPDF21 LO [10] & 200400 \\ \hline \end{tabular} \begin{tabular}{l r} \hline Model leading order (mLO) & \\ MRST2007 (LO*) [11] & 20650 \\ MRSTMCal (LO**) [11] & 20651 \\ \hline \end{tabular} 
\begin{tabular}{l r} \hline Next-to leading order (NLO) & \\ CTEQ6.6 [12] & 10550 \\ CT10 [13] & 10800 \\ NNPDF21 NLO [10] & 192800 \\ MSTW2008NLO [9] & 21100 \\ \hline \end{tabular}
\end{table}
Table 2: PDFs used in the tunes with corresponding LHAPDF sets

[MISSING_PAGE_EMPTY:4]

\begin{table}
\begin{tabular}{l r r r} \hline \hline Observable & \(\sqrt{s}\) & Fit range & AU2 weight \\ \hline
**Track-based underlying event at 900 GeV and 7 TeV in ATLAS**[17] & & \\ Transverse region \(N_{\rm ch}\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & \(\geq\) 6 GeV & 40 \\ Toward region \(N_{\rm ch}\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & \(\geq\) 6 GeV & 10 \\ Away region \(N_{\rm ch}\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & \(\geq\) 6 GeV & 10 \\ Transverse region \(\sum p_{\perp}\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & \(\geq\) 6 GeV & 40 \\ Toward region \(\sum p_{\perp}\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & \(\geq\) 6 GeV & 10 \\ Away region \(\sum p_{\perp}\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & \(\geq\) 6 GeV & 10 \\ Transverse region \(\langle p_{\perp}\rangle\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & & 40 \\ Toward region \(\langle p_{\perp}\rangle\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & & 10 \\ Away region \(\langle p_{\perp}\rangle\) density vs. \(p_{\perp}\) (leading track) & 7 TeV & & 10 \\ Transverse region \(\langle p_{\perp}\rangle\) density vs. \(N_{\rm ch}\) (leading track) & 7 TeV & & 80 \\ Toward region \(\langle p_{\perp}\rangle\) density vs. \(N_{\rm ch}\) (leading track) & 7 TeV & & 10 \\ Away region \(\langle p_{\perp}\rangle\) density vs. \(N_{\rm ch}\) (leading track) & 7 TeV & & 10 \\ Transverse region \(N_{\rm ch}\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & \(\geq\) 3 GeV & 20 \\ Toward region \(N_{\rm ch}\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & \(\geq\) 3 GeV & 5 \\ Away region \(N_{\rm ch}\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & \(\geq\) 3 GeV & 5 \\ Transverse region \(\sum p_{\perp}\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & \(\geq\) 3 GeV & 20 \\ Toward region \(\sum p_{\perp}\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & \(\geq\) 3 GeV & 5 \\ Transverse region \(\langle p_{\perp}\rangle\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & & 20 \\ Toward region \(\langle p_{\perp}\rangle\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & & 5 \\ Away region \(\langle p_{\perp}\rangle\) density vs. \(p_{\perp}\) (leading track) & 900 GeV & & 5 \\ Transverse region \(\langle p_{\perp}\rangle\) density vs. \(N_{\rm ch}\) (leading track) & 900 GeV & & 40 \\ Toward region \(\langle p_{\perp}\rangle\) density vs. \(N_{\rm ch}\) (leading track) & 900 GeV & & 5 \\ Away region \(\langle p_{\perp}\rangle\) density vs. \(N_{\rm ch}\) (leading track) & 900 GeV & & 5 \\ \hline
**Cluster-based underlying event at 900 GeV and 7 TeV in ATLAS**[18] & & \\ Transverse \(N\) density vs. \(p_{\perp}^{\rm cus1}\) & 7 TeV & 20 \\ Transverse \(\sum p_{\perp}\) density vs. \(p_{\perp}^{\rm cus1}\) & 7 TeV & 20 \\ Transverse \(N\) density vs. \(p_{\perp}^{\rm cus1}\) & 900 GeV & & 10 \\ Transverse \(\sum p_{\perp}\) density vs. \(p_{\perp}^{\rm cus1}\) & 900 GeV & & 10 \\ \hline \hline \end{tabular}
\end{table}
Table 4: Observable–weight combinations used for the MPI tuning of AU2 tunes. Where the fit has been made to a restricted range in leading \(p_{\perp}\), the fit range for that weight is shown in the “Fit range” column.

For the LO PDFs 1), tunes for both minimum bias (named A2) and for underlying event (AU2) were obtained. However, for higher order PDFs, this was not the case, and only underlying event (AU2) tunes were performed 2). Table 5 shows the tune parameters for all the tunes corresponding to different PDFs. A few of these tunes are also included in the latest Pythia 8 official release (8.165), which can be set using _Tune:pp_, as shown in the last column of Table 5. For the AU2 tunes with CTEQ6L1 PDF, and modified LO PDFs, to avoid unphysical values of the a1 parameter, it was fixed to the closest acceptable value.

Footnote 1): MB tune for NNPDF2.1 LO was not done as it was not preferred for pileup simulation in ATLAS

Footnote 2): It should be noted that for LO PDFs a simultaneous description of MB and UE data would have been achievable (contrary to the situation for NLO and mLO PDFs). It was, however, decided to have separate MB and UE tunes given the pressing need for the best possible pile-up simulation

In Figure 1. the tuning results for reconnectRange and a1 are plotted as function of pT0, calculated using Eq. 3. A common feature for all the tunes, except the AU2 MSTW2008 NLO tune are very low a1 values. This is very different from tune 4Cx, which has a higher value (0.15) of a1 parameter. Equation 1, 2 show that the \(x\) dependence almost vanishes for such low values of a1.

From looking at Figure 1, we observe that the tuning results cluster by PDF type in pT0. NLO PDFs require a low value for pT0 (\(\sim 2\) GeV), while LO PDFs cluster at values of about 2.5 GeV and the modified LO PDFs at even larger values of \(\sim 3.3\) GeV (a high value of pT0 means that on average the MPI algorithm will produce fewer particles). A similar observation of clustering was made during an earlier tuning study for Jimmy/Herwig [19]. Also an anti-correlation of reconnectRange and pT0 can be observed in the right Figure 1. NLO PDFs have highest reconnectRange values. On the contrary the mLO UE tunes have the weakest color reconnection.

Obviously, the reason for the clustering must come from the individual PDF properties at the typical scale of MPI scatters. Thus, we calculate the "color-weighted parton flux", \(\Phi_{\text{partons}}\), for each PDF at \(Q^{2}=(3.0)^{2}\) GeV\({}^{2}\)

\[\Phi_{\text{partons}}=\iint\limits_{x_{1}x_{2}>\tau_{\text{train}}}\text{d}x_ {1}\text{d}x_{2}N(x_{1},Q^{2})\cdot N(x_{2},Q^{2}) \tag{4}\]

\begin{table}
\begin{tabular}{l r r r r r} \hline \hline PDF & pT0Ref & ecomPow & a1 & reconnectRange & Tune:pp \\ \hline \multicolumn{5}{l}{Minimum-bias tunes: A2} \\ \hline CTEQ 6L1 & 2.18 & 0.22 & 0.06 & 1.55 & 7 \\ MSTW2008 LO & 1.90 & 0.30 & 0.03 & 2.28 & 8 \\ \hline \multicolumn{5}{l}{Underlying event tunes: AU2} \\ \hline CTEQ 6L1 & 2.13 & 0.21 & 0.00 & 2.21 & 9 \\ NNPDF 2.1 LO & 1.98 & 0.18 & 0.04 & 3.63 & – \\ MSTW2008 LO & 1.87 & 0.28 & 0.01 & 5.32 & 10 \\ NNPDF 2.1 NLO & 1.74 & 0.17 & 0.08 & 8.63 & – \\ CTEQ 6.6 & 1.73 & 0.16 & 0.03 & 5.12 & – \\ CT10 & 1.70 & 0.16 & 0.10 & 4.67 & 11 \\ MSTW2008 NLO & 1.51 & 0.19 & 0.28 & 5.79 & – \\ MRST2007 LO* & 2.39 & 0.24 & 0.01 & 1.76 & – \\ MRST2007 LO** & 2.57 & 0.23 & 0.01 & 1.47 & – \\ \hline \hline \end{tabular}
\end{table}
Table 5: Tuned MPI parameters for the A2/AU2 Pythia 8 tunings.

where \(x_{1,2}\) are the parton momentum fractions of partons of the colliding protons and \(\tau=4.0*Q^{2}/E_{\rm cm}\) is a lower cut-off required by kinematics. The function \(N(x,Q^{2})\) takes the contributing quark- and gluon-distributions \(q(x,Q^{2},\bar{q}(x,Q^{2}))\) and\(g(x,Q^{2})\) into account:

\[N(x,Q^{2})=\sum_{\rm quarks}(q(x,Q^{2})+\bar{q}(x,Q^{2}))+\frac{9}{4}g(x,Q^{2}) \tag{5}\]

In Figure 2 the obtained values for \(\Phi_{\rm partons}\) at \(Q^{2}=(3.0)^{2}\) GeV\({}^{2}\) for all PDFs of the AU2 tunes are plotted as function of the respective \(pT_{0}\) values at \(\sqrt{s}=7\) TeV. It shows the correlation of \(\Phi_{\rm partons}\) with \(pT0\) and explains the observed clustering.

Figure 3 shows the new LO MB tunes (and tunes 4C and 4Cx), compared with ATLAS minimum bias data at \(\sqrt{s}=7\) TeV. For the LO PDFs, the MB \(p_{\rm T}\) distributions (bottom row of Figure 3 ) and MB and UE \(\langle p_{\rm T}\rangle\) vs \(N_{\rm ch}\) correlation (Bottom rows of Figure 4 and Figure 6) demanded lower color reconnection (CR) strength, while MB and UE multiplicity spectra demanded stronger CR. We have used the lower CR value, since a better description of MB \(p_{\rm T}\) spectra in Figure 3 could only have been achieved at the cost of a poorer description of the MB and UE multiplicity distributions. The former was deemed more important for the MB tunes as these are to be used for all pile-up simulations. Figure 5 and Figure 6 show the tunes for all PDFs compared with ATLAS underlying event data at \(\sqrt{s}=7\) TeV.

## 3 Summary

In this note we have presented new tunes of the Pythia 8 event generators, which provide the first ATLAS tunes of Pythia 8 to make use of the new \(x\)-dependent hadronic matter distribution feature for a range of different PDFs. It is possible to achieve quite a good description of the data when tuning with the same weights regardless of the PDF used. However it is interesting to observe that the \(x\)-dependence preferred by the tunes is not very high. The tunes lead to a similar level of description of UE data compared to currently used 4C tune, and a better description of MB data which was urgently needed for ATLAS pileup simulation. The NLO underlying event tunes allow for the NLO generators that use Pythia 8 for shower and MPI simulation to generate events more realistically. We calculated the colour-weighted parton flux to help understand the clustering of tuning results by PDF type in pT0.

Figure 1: Correlation of AU2 tuned parameter values for various PDFs at 7 TeV, compared with 4Cx Colour-weighted parton flux, \(Q^{2}=(3.0\) GeV\()^{2}\)\(x_{1},x_{2}\in(10^{-6},1]\)

Figure 2: Correlation of color-weighted parton flux with pT0 for AU2 tunes for various PDFs at 7 TeV, compared with 4Cx

Figure 3: Comparison plots of the new Pythia 8 tunes to ATLAS minimum-bias event data [16] at 7 TeV. The yellow shaded areas represent the data uncertainty.

Figure 4: Comparison plots of the new Pythia 8 tunes to ATLAS minimum-bias event data [16] at 7 TeV. The yellow shaded areas represent the data uncertainty.

Figure 5: Comparison plots of the new Pythia 8 tunes to ATLAS underlying event data at 7 TeV [17]. The tunes corresponding to LO, and NLO and mLO PDFs are shown respectively in the left and right columns. The yellow shaded areas represent the data uncertainty.

Figure 6: Comparison plots of the new Pythia 8 tunes to ATLAS underlying event data at 7 TeV [17]. The tunes corresponding to LO and NLO and mLO PDFs are shown respectively in the left and right columns. The yellow shaded areas represent the data uncertainty.

## References

* [1] The ATLAS Collaboration, _ATLAS tunes of PYTHIA 6 and PYTHIA 8 for MC11_, 2010. [http://cdsweb.cern.ch/record/1363300](http://cdsweb.cern.ch/record/1363300). ATL-PHYS-PUB-2011-009.
* [2] The ATLAS Collaboration, _Further ATLAS tunes of PYTHIA 6 and PYTHIA 8 for MC11_, 2011. [http://cdsweb.cern.ch/record/1400677](http://cdsweb.cern.ch/record/1400677). ATL-PHYS-PUB-2011-014.
* [3] T. Sjostrand, S. Mrenna, and P. Skands, _A brief introduction to Pythia 8.1_, Comput. Phys. Commun. **178** (2008) 852-867, arXiv:0710.3820 [hep-ph].
* [4] T. Sjostrand, S. Mrenna, and P. Skands, _PYTHIA 6.4 physics and manual_, JHEP **05** (2006) 026, hep-ph/0603175.
* [5] R. Corke and T. Sjostrand, _Multiparton Interactions with an x-dependent Proton Size_, JHEP **05** (2011) 009, arXiv:1101.5953 [hep-ph].
* [6] R. Corke and T. Sjostrand, _Interleaved parton showers and tuning prospects_, JHEP **03** (2011) 032, arXiv:1011.1759 [hep-ph].
* [7] M. R. Whalley, D. Bourilkov, and R. C. Group, _The Les Houches Accord PDFs (LHAPDF) and LHAGLUE_, arXiv:hep-ph/0508110.
* [8] J. Pumplin et al., _New generation of parton distributions with uncertainties from global QCD analysis_, JHEP **07** (2002) 012, arXiv:hep-ph/0201195.
* [9] G. Watt and R. Thorne, _Study of Monte Carlo approach to experimental uncertainty propagation with MSTW 2008 PDFs_, arXiv:1205.4024 [hep-ph].
* [10] R. D. Ball, L. Del Debbio, S. Forte, A. Guffanti, J. I. Latorre, et al., _A first unbiased global NLO determination of parton distributions and their uncertainties_, Nucl.Phys. **B838** (2010) 136-206, arXiv:1002.4407 [hep-ph].
* [11] A. Sherstnev and R. S. Thorne, _Parton distributions for LO generators_, Eur. Phys. J. **C55** (2008) 553-575, arXiv:0711.2473 [hep-ph].
* [12] P. M. Nadolsky, H.-L. Lai, Q.-H. Cao, J. Huston, J. Pumplin, et al., _Implications of CTEQ global analysis for collider observables_, Phys.Rev. **D78** (2008) 013004, arXiv:0802.0007 [hep-ph].
* [13] H.-L. Lai, M. Guzzi, J. Huston, Z. Li, P. M. Nadolsky, et al., _New parton distributions for collider physics_, Phys.Rev. **D82** (2010) 074024, arXiv:1007.2241 [hep-ph].
* [14] A. Buckley, J. Butterworth, L. Lonnblad, H. Hoeth, J. Monk, et al., _Rivet user manual_, arXiv:1003.0694 [hep-ph].
* [15] A. Buckley, H. Hoeth, H. Lacker, H. Schulz, and J. E. von Seggerm, _Systematic event generator tuning for the LHC_, arXiv:0907.2973 [hep-ph].
* [16] The ATLAS Collaboration, _Charged-particle multiplicities in \(pp\) interactions measured with the ATLAS detector at the LHC_, New J. Phys. **13** (2011) 053033, arXiv:1012.5104 [hep-ex].
* [17] The ATLAS Collaboration, _Measurement of underlying event characteristics using charged particles in pp collisions at \(\sqrt{s}=900\) GeV and 7 TeV with the ATLAS detector_, Phys. Rev. D **83** (2011) 112001, arXiv:1012.0791 [hep-ex].