# Inner Detector alignment development and performance in preparation for Run 3

The ATLAS Collaboration

The ATLAS Collaboration

Several major changes were introduced in the ATLAS track reconstruction software to deal with the challenges posed by the Run 3 of the Large Hadron Collider, necessitating a new detector alignment campaign. The re-alignment results are shown to be stable over Run 2 and to have smaller remaining biases than the previous iteration. In addition, new methods were introduced for determining the track momentum biases, based on \(Z\rightarrow\mu^{+}\mu^{-}\) events. The refined detector description will improve future data analysis performed with Run 2 and Run 3 data.

## 1 Introduction

In order to reach its physics goals, the ATLAS experiment [1] relies on the precise reconstruction of the trajectories of charged particles emerging from the Large Hadron Collider (LHC) collisions. For this, the Inner Detector (ID) [2] tracking system must provide efficient, robust and precise position measurements of the charged particles as they cross its sensors.

A charged particle generates signals (hits) that are recorded by the detector elements. Those hits are used to reconstruct the trajectory (track) and estimate the particle track parameters. The precision achieved in the determination of track parameters is affected by how accurately the geometry of the ID is known, i.e. the location and orientation of its detector elements. The precision of the detector geometry description has consequences in almost every measurement performed using the ATLAS detector: from Standard Model (SM) processes, to searches for new physics phenomena. In particular, a performant track reconstruction and an accurate detector alignment are vital inputs to flagship results such as the \(W\)-boson mass measurement [3].

The process of determining the almost 750 000 degrees of freedom necessary to find the exact position and orientation of the ID active sensors, is known as _alignment_. The ID uses a track-based alignment [4] consisting in the minimization of the track-hit residuals1. Correlated geometrical distortions (such as coherent rotation of the ID barrel layers), or _weak-modes_, can lead to systematic biases in the reconstructed track parameters, and therefore are of particular concern.

Footnote 1: The track-hit residual in a given sensor is defined as the distance between the measured hit position and the extrapolated point of the track at that sensor.

During the LHC Long Shutdown 2 (LS2), the ATLAS collaboration improved the existing reconstruction algorithms and developed new techniques in preparation for the LHC Run 3 data taking challenges. The track reconstruction performance was improved and the required computing resources were reduced [5]. Both aspects were necessary to achieve the Run 3 physics goals and prepare for the High-Luminosity LHC era.

One change was the replacement of the Neural Network used during Run 2 (Run 2 NN [6]) to estimate the position and uncertainty of the charged particle hits, recorded by the Pixel detector sensors. A _Mixture Density Network_[7, 8] (MDN) is now used. This change removed a small bias in the reconstructed Pixel hits by the Run 2 NN, which directly translated in a bias of the track-hit residuals. As a consequence, an update of the ID alignment became necessary.

Futhermore, a new technique to estimate whether alignment weak-modes introduce a bias in the reconstructed track momentum has been implemented, resulting in significant improvements.

This note is organized as follows: a brief description of the ATLAS detector is given in Section 2. The re-alignment campaign of the Inner Detector needed for the reprocessing of the Run 2 data with the software algorithms developed for Run 3 is described in Section 3. A new technique to determine the sagitta bias weak-mode is described in Section 4.

## 2 ATLAS detector

The ATLAS experiment [1] at the LHC is a multipurpose particle detector with a symmetric cylindrical geometry that covers nearly the entire solid angle around the collision point. It consists of an inner tracker, a magnet system, electromagnetic and hadronic calorimeters and a muon spectrometer.

The outer part of the detector consists of the muon spectrometer (MS) built with high-precision tracking chambers for coverage up to \(|\eta|=2.7\) (read Section 2.1 for the definition of pseudorapidity: \(\eta\)), fast detectors for triggering within \(|\eta|=2.4\) and three large superconducting toroid magnets [9] with eight coils each. The calorimetry system is placed inside the MS. The lead/liquid-argon sampling calorimeters provide electromagnetic energy measurements with high granularity and a outer hadronic (steel/scintillator-tile) calorimeter covers the central pseudorapidity range up to \(|\eta|<1.7\). The end-cap and forward regions are instrumented with liquid-argon calorimeters for both the electromagnetic and hadronic energy measurements up to \(|\eta|<4.9\).

The closest detector to the interaction point is the Inner Detector (ID) [2]. In Run 2, it consisted of three subdetectors using different technologies: the Pixel detector [10], including the insertable B-Layer (IBL) [11], a semiconductor tracker (SCT) [12], and a transition radiation tracker (TRT). The ID is surrounded by a superconducting solenoid providing a 2 T axial magnetic field [13]. The ID was designed to reconstruct charged particle trajectories within a pseudorapidity range of \(|\eta|<2.5\).

The ATLAS detector has a two-level trigger system to select events for offline analysis [14]. An extensive software suite [15] is used in the reconstruction and analysis of real and simulated data, in detector operations, and in the trigger and data acquisition systems of the experiment.

### Coordinate reference systems and track parametrization

ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point (IP) in the centre of the detector and the \(z\)-axis along the beam pipe. The \(x\)-axis points from the IP to the centre of the LHC ring, and the \(y\)-axis points upwards. Cylindrical coordinates (\(r\), \(\phi\)) are used in the transverse plane, with \(\phi\) being the azimuthal angle around the \(z\)-axis. The pseudorapidity is defined in terms of the polar angle, \(\theta\), as \(\eta=-\ln\tan(\theta/2)\). Track parameters are referenced in this global system.

The track-hit residuals are computed in the local coordinate system of each individual sensor. This local system is a right-handed reference frame with the origin placed in the geometrical centre of the sensor. For pixel-like sensors, the axis orientation uses the following convention: the local-x axis points along the most sensitive direction of the sensor (shorter pitch side). The local-y axis is oriented along the longer pitch direction. The local-z axis is perpendicular to the sensor plane.

The chosen parameterisation by ATLAS to describe the five parameters of a track in a magnetic field is the following: \((d_{0},~{}z_{0},~{}\phi_{0},~{}\theta_{0},~{}q/p)\), where \(d_{0}\) and \(z_{0}\) are the transverse and longitudinal impact parameters, \(\phi_{0}\) and \(\theta_{0}\) the azimuthal and polar angles, \(q\) the charge of the particle and \(p\) its momentum.

## 3 Inner Detector alignment campaign

The ID uses a track-based alignment which is a complex and multi-staged process [4, 16]. It is based on the minimization of the track-hit residuals with the least square method and proceeds in a sequence of hierarchical levels from the global mechanical assembly structures to local sensors, with an increasing number of degrees of freedom at each level.

Due to variations in the operational conditions, the ID geometry is not static in time. Thus, the position and orientation of the sensors or their supporting structures are not fixed. Movements of the detector occurring during a LHC fill are usually of the order of a few micrometers and involve the Pixel Detector as a whole, while the module positions relative to their assembly structure are more stable in time. Consequently, short time-scale movements of the large structures are aligned several times during a LHC fill, while long time-scale movements (module level alignment) require much fewer updates during the data-taking. The alignment weak-modes consist of correlated geometrical distortions that preserve the helical path of the charged particles, but systematically bias the reconstructed track parameters. The removal of weak-modes deserves special attention during the alignment procedure.

### Motivation for re-alignment campaign

In preparation for the Run 3 data-taking, the MDN algorithm [7] was introduced for correcting the position and uncertainty of pixel clusters arising from up to three particle crossings. It replaces the NN-based method [6] used during Run 2. The MDN algorithm is more suited to be used in the context of high hit occupancy that is expected during Run 3 [8]. Furthermore, the MDN is free from a small bias introduced by the Run 2 NN in the local-y position.

The local-y position residual of IBL hits given by the Run 2 NN and the MDN algorithm are shown in Figure 1 as a function of the incident angle of the particle. In simulated events (that assume perfect geometry of the detector) the local-y residuals computed with the Run 2 NN exhibit a bias, which is dependent on the incident angle of the particle. The MDN algorithm provides unbiased residual distributions (see Figure 1(a)).

As the NN position bias was absorbed by the alignment procedure through adjusting the detector geometry in Run 2, track-hit residuals of the order of 10 \(\mu\)m appeared in data events when enabling the MDN into the reconstruction software suite, as shown in Figure 1(b). Therefore, the ID alignment needed to be updated with the MDN in place to remove the geometry distortion generated by the Run 2 NN position bias.

### New alignment of the Run 2 data

The MDN (and previously the Run 2 NN) algorithm are applied only to the Pixel detector, thus the bias affected only the hit positions in this sub-detector. The observed bias in local-y position of the cluster is observed to be stable with time, as shown in Figure 1(b), in which only tiny differences are observed between data collected in 2017 and 2018. Therefore, it was not necessary to correct the alignment of the Pixel mechanical structures, or their time evolution. Thus, only the module-level alignment constants needed to be updated separately for the various periods of proton-proton collisions, Pb-Pb collisions, and special runs. A total of 10 sets of alignment constants were produced. For this purpose, two alignment rounds were performed.

The first round of the alignment targeted the corrections due to the use of the MDN. This corrected the position of the Pixels at module level and minimized their track-hit residuals, Figure 2(a). A second round of alignment was then performed to ensure no weak-modes were present. The degrees of freedom considered were those from all barrel layers and end-cap disks of the ID sub-detectors.

The derived alignment constants sets were tested on dedicated samples enhanced with \(Z\to\mu^{+}\mu^{-}\) events2 to determine the presence of impact parameter, Figure 2(b), and transverse momentum (sagitta) weak-modes. The latter is discussed in Section 3.3.

Footnote 2: The selection of \(Z\to\mu^{+}\mu^{-}\) events was the same as in [4], which can be summarized as requiring two opposite charged tracks: identified as muons by the MS [17], that emerged from the primary vertex, both tracks with a \(p_{\mathrm{T}}>20\) GeV and with an invariant bases between 70 and 110 GeV. It must be noted that the MS acts as a tagger and that this work considers only the muon track segment reconstructed by the ID.

The measured biases on the impact parameter and momentum in the \(Z\to\mu^{+}\mu^{-}\) events were mapped in \((\eta,\ \phi)\) coordinates and used in the alignment procedure as track parameter constraints, as described in [4]. A brief description follows:

* The \((\eta,\ \phi)\) maps of track parameter biases were used to constrain the track fits and to the derive new alignment constants.
* The new set of alignment constants was then used to re-fit the tracks of \(Z\to\mu^{+}\mu^{-}\) events and then to update the track parameter bias maps.
* The updated impact parameter and sagitta bias maps were used as input to the next alignment iteration.

Figure 1: Observed bias on the IBL track-hit residuals in the direction along the beam axis depending on the incident angle of the track into the Pixel modules. (a) The local-\(y\) residual in simulated events with the MDN algorithm (red) and Run 2 NN (gray). (b) The local-\(y\) residual in data events with the MDN algorithm (open markers) and Run 2 NN (filled markers). Data events from 2017 data-taking are displayed in green, while data events from 2018 are displayed in purple.

The alignment campaign achieved both precision goals. The track-hit residuals were successfully minimized, Figure 2(a), and the observed weak mode biases in the track impact parameter, Figure 2(b), and in the track momentum (see Section 3.3) were removed.

### Minimizing sagitta biases

A precise determination of the particle momentum is a key ingredient of the performance of the detector and has an impact on almost every physics analysis by the experiment. As the sagitta and transverse momentum (\(p_{\mathrm{T}}\)) are almost inversely proportional, a bias in the sagitta directly translates into a bias in the \(p_{\mathrm{T}}\). Therefore, it is crucial for the alignment to mitigate possible sagitta biases.

A sagitta bias (\(\delta_{s}\)) alters the reconstructed momentum (\(p_{\mathrm{T}}^{\prime}\)) of a particle with respect to its original momentum (\(p_{\mathrm{T}}\)) in a charge (\(q\)) dependent way and according to:

\[p_{\mathrm{T}}^{\prime}=p_{\mathrm{T}}\left(1+qp_{\mathrm{T}}\delta_{s}\right) ^{-1} \tag{1}\]

In reference [4], the technique used to constrain the sagitta of the tracks is only sensitive to local sagitta biases (i.e. gradients of the sagitta bias over the detector). In order to quantify the global bias, an alternative and less precise method (\(E/p\) for the electrons in \(Z\to e^{+}e^{-}\)) was used.

Instead, a new technique is used with respect to the procedure described in [4]. Since, to first order, positive and negative muons from \(Z\) boson decays are expected to have the same average transverse momentum, the global sagitta bias (\(\delta_{s}\)) can be estimated with the formula:

\[\delta_{s}=-\frac{1}{\langle p_{\mathrm{T}}\rangle}\frac{\langle p_{\mathrm{T }}^{+}\rangle-\langle p_{\mathrm{T}}^{-}\rangle}{\langle p_{\mathrm{T}}^{+} \rangle+\langle p_{\mathrm{T}}^{-}\rangle} \tag{2}\]

Figure 2: Observed biases in the alignment procedure. Grey points indicate the initial conditions, the red points stand for the results of the first alignment round using only track-hit residual minimization, and the green points show the results of the alignment that uses constrains on the track parameters. (a) Track-hit residuals in the IBL and Pixel detectors. There are 4 group of points that correspond to the IBL, and then the 3 layers of the Pixel system. The points in each group correspond to the different ladders of modules segmented in \(\phi\). (b) Profile of the transverse impact parameter (\(d_{0}\)) versus the track \(\eta\).

where \(\langle p_{\rm T}^{+/-}\rangle\) stands for the average of the \(p_{\rm T}\) distribution of positive and negative muons, while \(\langle p_{\rm T}\rangle\) is the average \(p_{\rm T}\) of all muons from \(Z\to\mu^{+}\mu^{-}\) events. The extracted value of \(\delta_{s}\) is used to constrain the tracks momentum in a new alignment iteration.

Figure 3 compares the \(p_{\rm T}\) spectra of \(\mu^{+}\) and \(\mu^{-}\) after the first alignment round Figure 3, and after the second alignment round, Figure 3, where track parameter constraints were introduced in the alignment procedure.

After the second alignment round, a significant improvement of the agreement between the \(p_{\rm T}\) spectra of \(\mu^{+}\) and \(\mu^{-}\) was observed, especially at high \(p_{\rm T}\), which is most affected by the \(\delta_{s}\) (Equation 1). Equation 2 can be used to estimate the global \(\delta_{s}\) present in the initial and final alignment constants sets: the global sagitta bias is reduced from \(\approx 0.06\)\(\mathrm{\,Te\kern-1.0ptV}^{-1}\) after the first re-alignment round to \(\approx 0.01\)\(\mathrm{\,Te\kern-1.0ptV}^{-1}\) after the second re-alignment round.

This procedure does not to affect any physics-motivated difference in positive and negative \(p_{\rm T}\) spectra. This is shown in Figure 4, where the reconstructed forward-backward asymmetry [18] in \(Z\to\mu^{+}\mu^{-}\) events is not removed by the procedure, while the sagitta bias (that appears as a wiggle in the asymmetry trend) is substantially reduced after the second alignment round.

### Summary of the performance

The performance of the new alignment was tested with \(Z\to\mu^{+}\mu^{-}\) events and its stability evaluated for all collected data. The evolution of the average difference of transverse (\(d_{0}\) ) and longitudinal (\(z_{0}\)) impact parameters between positive and negative muons are observed to be stable over Run 2, as shown in Figures 5 and 6. Each point in the plot corresponds to events from a single LHC fill, which are used to measure \((\eta,\phi)\) maps (of \(12\times 12\) bins) of the \(d_{0}\) and \(z_{0}\) difference between positive and negative muons. The marker and the corresponding uncertainty stand for the mean and the standard deviation of the observed bias over the \((\eta,\phi)\) map, respectively.

Figure 3: Comparison of the \(p_{\rm T}\) spectrum of the positive and negative muons in \(Z\to\mu^{+}\mu^{-}\) events (a) before using track parameter constraints in the alignment and (b) after the alignment round with track parameter constraints.

The difference in \(d_{0}\) for \(\mu^{+}\) and \(\mu^{-}\) is within \(1/3\)\(\mu\)m for all Run 2 LHC fills, as shown in Figure 5. The difference between \(z_{0}\) of positive and negative muons agree within 5 \(\mu\)m over Run 2, as shown in Figure 6. Note the different scales between \(\delta d_{0}\) and \(\delta z_{0}\), which are due to the higher resolution of the ID in the transverse impact parameter than in the longitudinal one. The performaces in terms of momentum biases are shown in Section 4. The stability of the reconstructed invariant mass of the di-muon system is also presented in Figure 7, computed using a similar procedure as for Figures 5 and 6.

In conclusion, this alignment campaign removed the biases introduced by the Run 2 NN, providing a robust description of the detector geometry over time for the whole Run 2 data.

Figure 4: Reconstructed forward-backward asymmetry (\(A_{FB}\)) using the Collins-Soper frame [18] in \(Z\rightarrow\mu^{+}\mu^{-}\) events in MC and data events from 2017. The plot shows the values for the asymmetry before (blue) using track parameter constraints in the alignment and after (green) the alignment round with track parameter constraints.

Figure 5: Difference of transverse impact parameter (\(d_{0}\)) for positive and negative muons versus time during the Run 2.

## 4 New technique for determining the sagitta bias

One of the goals of the alignment campaign described in Section 3 was to deliver a new and bias free ATLAS ID alignment for the whole Run 2 dataset. In order to asses the presence of alignment weak modes, \(Z\rightarrow\mu^{+}\mu^{-}\) events were used to scrutinize the impact parameter and sagitta biases.

The method used to derive \((\eta,\phi)\) maps of sagitta bias used in the re-alignment campaign was not detailed in this note and it is the same as described in reference [4]. It will be referred to as the _Mass_ method here and has two disadvantages: it is not sensitive to global sagitta biases and it is resource intensive, as many iterations are needed until convergence is reached.

In the _Mass_ method, the measurement of the sagitta bias is derived from the shifts of the reconstructed mass from the reference \(Z\) mass. Equation 1 describes the effect of a sagitta bias (\(\delta_{s}\)) on the reconstructed \(p_{\mathrm{T}}\), and it can be used to derive a formula for the shift of the reconstructed di-muon mass (\(m^{2}_{\mu\mu}\)) from the real mass (\(m^{2}_{\mu\mu,0}\)):

\[\frac{m^{2}_{\mu\mu}-m^{2}_{\mu\mu,0}}{m^{2}_{\mu\mu}}=(p^{-}_{\mathrm{T}} \delta^{-}-p^{+}_{\mathrm{T}}\delta^{+}) \tag{3}\]

where \(p^{+/-}_{\mathrm{T}}\) and \(\delta^{+/-}\) are the \(p_{\mathrm{T}}\) and the sagitta bias affecting the positive/negative muons respectively.

Figure 6: Difference of longitudinal impact parameter (\(z_{0}\)) for positive and negative muons versus time during the Run 2.

Figure 7: Stability of the reconstructed invariant mass of the di-muon (\(m_{\mu\mu}\)) system during the Run 2.

Equation 3 shows that, in the presence of a global sagitta bias (i.e. \(\delta^{+}=\delta^{-}\)), the mean of the reconstructed mass distribution is unchanged, and therefore the _Mass_ method can not be sensitive to such bias. Consequently, alternative methods were used to measure the global biases during Run 2, as described in reference [4], and in the re-alignment campaign, as depicted in Section 3.3.

Conversely, a sagitta bias would cause the variance of the di-muon system mass to increase. The minimization of the variance of the \(m_{\mu\mu}\) distribution is the basic concept of the new implemented technique for the sagitta measurement, the _VarMin_ method, which is sensitive to a global sagitta bias. In this context, the usage of the VarMin \(\delta_{s}\) maps as track parameter constraints in the alignment procedure allows the global \(\delta_{s}\) bias to be removed during alignment iterations directly. For this reason, the _VarMin_ method will replace the _Mass_ procedure in future Run 3 alignment campaigns.

The _VarMin_ method estimates the sagitta bias over the detector, segmented in \(D\) sectors in \(\eta\) and \(\phi\) coordinates. The sagitta bias is defined as a \(D\)-dimensional vector \(\boldsymbol{\delta}=(\delta_{1},\ldots,\delta_{D})\). By using \(\boldsymbol{\delta}\) and Equation 3, the sagitta bias corrected di-muon system mass (\(m_{\mu\mu,\bullet}\)) is:

\[m^{2}_{\mu\mu,\bullet}=\Delta m^{2}_{\mu\mu,i}-\boldsymbol{e}_{i}\cdot \boldsymbol{\delta} \tag{4}\]

where \(\Delta m^{2}_{\mu\mu,i}\) stands for \(m^{2}_{\mu\mu,i}-m^{2}_{\mu\mu,0}\) in the \(i\)-th event and \(\boldsymbol{e}_{i}\) is the vector of the reconstructed \(p^{+/-}_{\mathrm{T}}\) filling their corresponding \((\eta,\ \phi)\) cell entry:

\[\boldsymbol{e}_{i}=m^{2}_{\mu\mu,i}\ (0,\ldots,\ p_{\mathrm{T}}^{+}_{i},\ldots,\ p _{\mathrm{T}}^{-}_{i},\ldots,0) \tag{5}\]

In Equation 5, the non-trivial entries in the \(D\)-dimensional vector are at the indices corresponding to the \((\eta,\ \phi)\) sectors where the positive and negative muons are detected in the \(i\)-th event. The expression of the variance for the sagitta-subtracted reconstructed mass is

\[\mathrm{Var}[m^{2}_{\mu\mu,\bullet}]=\mathrm{Var}[\Delta m^{2}_{\mu\mu,i}]- \sum_{\alpha,\beta}\mathrm{Cov}[(\boldsymbol{e}_{i})_{\alpha},\ (\boldsymbol{e}_{i})_{\beta}]\ \delta_{\alpha}\delta_{\beta}-2\sum_{\alpha} \mathrm{Cov}[\Delta m^{2}_{\mu\mu,i},\ (\boldsymbol{e}_{i})_{\alpha}]\ \delta_{\alpha} \tag{6}\]

where the indices \(\alpha\), \(\beta\) run over the \(D\ (\eta,\ \phi)\) bins. Its minimization against the value \(\delta_{\beta}\), that is the sagitta correction of the \(\beta\)-th \((\eta,\ \phi)\) sector of the detector (\(d\mathrm{Var}[m^{2}_{\mu\mu,\bullet}]/d\delta_{\beta}=0\)) leads to a \(D\)-dimensional system of equations:

\[M_{\alpha,\beta}\ \delta_{\beta}=k_{\alpha} \tag{7}\]

where the elements of the vector \(\boldsymbol{k}\) and matrix \(M\) are computed with:

\[k_{\alpha} =\mathrm{Cov}[\Delta m^{2}_{\mu\mu,i},(\vec{e}_{i})_{\alpha}] \tag{8}\] \[M_{\alpha,\beta} =\mathrm{Cov}[(\vec{e}_{i})_{\alpha},(\vec{e}_{i})_{\beta}] \tag{9}\]

The solution of this system of equations provides the estimation of the sagitta bias over all the \(D\ (\eta,\ \phi)\) sectors of the detector.

The residual sagitta bias after the re-alignment campaign was computed with both the _Mass_ and _VarMin_ methods using the \(Z\rightarrow\mu^{+}\mu^{-}\) events from the 2018 data-taking which amount to 59.9 fb\({}^{-1}\). For this calculation, the detector was segmented in \(D=24\times 24=576\) cells over the \((\eta,\phi)\) plane. The sagitta bias maps as computed via _Mass_ and _VarMin_ methods are shown in Figure 8.

As shown in Figure 8, the \(\delta_{s}\) values obtained with the two methods are compatible. In order to quantify their agreement, their correlation is studied in Figure 9 and found to be high, as expected from the agreement in Figure 8. This observation also indicates that the global sagitta bias is almost negligible in the analysed dataset, because _VarMin_ and _Mass_ method provide compatible results despite the _Mass_ method not being sensitive to global sagitta bias.

The _VarMin_ additionally improved the _Mass_ method in terms of computation time. While the _Mass_ method needs at least 6-7 iterations to converge, the _VarMin_ method converges with 2 iterations, as shown in Figure 10.

The sagitta bias is measured in the reprocessed Run 2 data with the updated alignment (described in Section 3). The measured sagitta bias as a function of time is shown in Figures 11 and 12 for the _VarMin_ and _Mass_ method respectively. They were evaluated using the same procedure as described in Section 3.4.

Figure 8: Measured sagitta bias \((\eta,\phi)\) maps from \(Z\to\mu^{+}\mu^{-}\) data events from 2018 data-taking as obtained with the _Mass_ (a) and _VarMin_ (b) methods. The detector is split in \(24\times 24\) uniformly spaced \((\eta,\phi)\) sectors.

Figure 9: Comparison of the \(\delta_{s}\) as computed with the _Mass_ and _VarMin_ methods on \(Z\to\mu^{+}\mu^{-}\) events. Each point has as coordinates the computed \(\delta_{s}\) with each method for the same \((\eta,\ \phi)\) sector.

On one hand, as the _Mass_ method is not sensitive to a global sagitta bias, the mean of the \(\delta_{s}\) in Figure 12 is, by construction, compatible with zero, with very small oscillations of the order of 0.01 TeV\({}^{-1}\). However, in a previous alignment campaign [4], a global sagitta bias (\(\approx 0.05\) TeV\({}^{-1}\)) was found with an alternative method (electrons E/p in this case). Therefore, Figure 12 does not provide the complete information as the global sagitta bias has to be also considered.

On the other hand, the _VarMin_ method measures a small, but non-zero global sagitta bias. Thus, the points in Figure 11 are more scattered. Using the VarMin method in the derivation of the sagitta bias maps (see Section 3) allows a prompt adjustment of the alignment constants that minimizes simultaneously the local and global sagitta biases. This will represent a significant improvement with respect to the use of the _Mass_ method.

Figure 11: The sagitta bias on tracks, measured in \(Z\rightarrow\mu^{+}\mu^{-}\) events following the _VarMin_ method and for the data from the Run 2.

Figure 10: \(\delta_{s}\) corrections per iteration. Each line shows the \(\delta_{s}\) computed for a given \((\eta,\ \phi)\) cell. For the sake of clarity, only a fraction of the total number of cells are drawn: just the 24 cells of the 12th row (\(\phi\approx 0\)) in Figure 8. The line colors are used to distinguish each cell.

## 5 Conclusion

The ATLAS track reconstruction software has been improved in view of the new requirements and challenges posed by the LHC Run 3 physics and also to prepare for the High-Luminosity LHC era [5]. The algorithm that estimates the position and uncertainty of the charged particles hits recorded by the Pixel detector sensors was updated to use a _Mixture Density Network_ (MDN) [7]. The MDN is not affected by a bias in the position of the Pixel hits, observed in the Run 2 version of the algorithm and absorbed by the Run 2 alignment constants. Therefore the ID required a new detector alignment. Thus, new sets of alignment constants were derived and then used for the reprocessing of the ATLAS Run 2 dataset using the reconstruction software planned for the Run 3 data-taking.

The performance of the new ID alignment constants sets were evaluated by checking the basic track-hit residuals, as well as track parameters (impact parameters and \(p_{\mathrm{T}}\)) and the reconstructed invariant mass in \(Z\rightarrow\mu^{+}\mu^{-}\) events. No significant biases were observed for any of those quantities in the Run 2 data. In addition, all of them show a good stability for the entire Run 2 data set. The improved detector description, brought by the new set of alignment constants, is expected to have a positive impact on precision physics measurements.

In preparation for the Run 3, a new method for the estimation of the sagitta bias was implemented. This new method solved two issues affecting the procedure used in the past [4]: it proved to be sensitive to global sagitta biases and improved the computation time. An almost negligible global sagitta bias over Run 2, significantly smaller than the existing results [4], was obtained. The inclusion of this method in the alignment procedure, for constraining the track parameters, will lead to an almost automatic removal of the sagitta bias during the alignment of the Run 3 data.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003 (cit. on pp. 2, 3).

Figure 12: The sagitta bias as measured on muon tracks from \(Z\rightarrow\mu^{+}\mu^{-}\) events following the _Mass_ method in [4] versus time during the Run 2.