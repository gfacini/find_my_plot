[

###### Abstract

The overall functionality and performance of the muon trigger system with respect to data produced as part of the ATLAS Computing System Commissioning effort is described. The physics performance in terms of trigger efficiency and accepted rates is studied for the muon inclusive signatures for different luminosity scenarios. Dedicated studies on physics samples with single and double muon final states are also performed in order to evaluate the trigger efficiencies on realistic data and background rejection capabilities. Methods to evaluate muon trigger efficiencies from real data are discussed. Furthermore, strategies to use the ATLAS calorimeters to tag and select isolated muons are presented.

1]ATLAS NOTE

[1]ATL-PHYS-PUB-2009-000

[2]March 17, 2009

[3]**Performance of the Muon Trigger Slice with Simulated Data**

[1]The ATLAS Collaboration1]

Footnote 1: This note is prepared by M. Bellomo, M. Biglietti, K.M. Black, G. Carlino, G. Cataldi, F. Conventi, A. Di Mattia, S. Giagu, S. Grancagnolo, N. Kanaya, M. Ishino, A. Krasznahorkay, H. Kurashige, H. Lim, K. Nagano, A. Nisati, C. Omachi, K. Ozone, M. Primavera, A. Ruiz-Martinez, A. Sidoti, G. Siragusa, S. Spagnolo, S. Tarem, Z. Tarem, G. Usai, J. Valls, A. Ventura.

[2]The ATLAS Collaboration1]

Footnote 1: This note is prepared by M. Bellomo, M. Biglietti, K.M. Black, G. Carlino, G. Cataldi, F. Conventi, A. Di Mattia, S. Giagu, S. Grancagnolo, N. Kanaya, M. Ishino, A. Krasznahorkay, H. Kurashige, H. Lim, K. Nagano, A. Nisati, C. Omachi, K. Ozone, M. Primavera, A. Ruiz-Martinez, A. Sidoti, G. Siragusa, S. Spagnolo, S. Tarem, Z. Tarem, G. Usai, J. Valls, A. Ventura.

[3]This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020.

Introduction

Triggering and identifying muons will be crucial for many LHC physics analyses. In accordance with the ATLAS general trigger scheme, the muon trigger system has three distinct levels: L1, L2, and the Event Filter (EF). The paper discusses the software tools used for muon trigger reconstruction and the algorithm selection strategy and trigger configuration. Next, the resolution and selection efficiencies of the various muon triggers are presented, followed by a discussion of the trigger rates for various luminosities. Subsequently, the rejection of background from in-flight meson decays and selection of isolated muons using calorimeter information is discussed. Finally, the trigger performance on the di\(-\)muon final states \(Z\;\rightarrow\;\mu\mu\)and \(Z^{\prime}\rightarrow\mu\mu\) is presented along with a description of plans to determine the trigger efficiency from collider data.

## 2 Detector simulation and data samples

The samples used in this paper were produced using a full GEANT4 based simulation of the ATLAS detector. The trigger simulation options included both standard and \(B\)-physics trigger simulation configurations, which correspond to the standard and the low trigger thresholds (see Section 3). The deterioration of efficiency due to the geometrical acceptance and the limited size of coincidence window are taken into account in the L1 simulation and trigger logic emulator.

Large samples of single prompt muons, simulated uniformly in \(\eta-\phi\), with fixed \(p_{T}\) ranging from 2 GeV to 1 TeV, have been used to study the muon trigger performance. One of the main backgrounds for the muon trigger selection comes from in-flight decays of charged kaons and pions. This has been evaluated using samples of minimum bias events and single pions, where the mesons are forced to decay inside the Inner Detector cavity in order to facilitate the production of a sizable sample of in-flight \(\pi/K\) decays. Muon trigger rates were determined using both single muons and minimum bias events. The selection of muons using the Tile Calorimeter has been studied using low \(p_{T}\) (4 and 6 GeV) single muons and semi-inclusive \(b\) quark decays, \(b\bar{b}\rightarrow\mu X\). Muon trigger studies on high-\(p_{T}\) dimuon final states and the determination of trigger efficiency from data have been performed using \(Z\;\rightarrow\;\mu\mu\)and \(Z^{\prime}\rightarrow\mu\mu\) as signal processes and \(B\rightarrow\mu\mu\), W boson decays, \(Z\rightarrow\tau\tau\) and top-pair events as background processes.

## 3 Muon trigger algorithms and configuration

The L1 muon trigger selects active RoIs, in the event using Resistive Plate Chambers (RPC) [1] in the barrel (\(|\eta|<1.05\)) and Thin Gap Chambers (TGC) [1] in the endcaps (\(1.05<|\eta|<2.4\)). The trigger algorithms look for hit coincidences within different RPC or TGC detector layers inside the programmed geometrical windows which define the transverse momentum region. A coincidence is required in both \(\eta\) and \(\phi\) projections. The information about muon candidates in both the barrel and the end-cap is transmitted to the Muon to Central Trigger Processor Interface (MuCTPI) [1], which calculates the number of L1 muon candidates for six different \(p_{T}\) thresholds and takes overlaps between the trigger sectors into account by using look-up-tables (LUT). There are several L1 signatures each corresponding to a different \(p_{T}\) threshold:

* mu0, mu5, mu6, mu8, mu10 for the low \(p_{T}\) selection;
* mu11, mu20, mu40 for the high \(p_{T}\) selection.

The integer numbers after the "mu" symbolize the required \(p_{T}\) threshold. L1 also provides the coordinates in \(\eta\) and \(\phi\) of the selected RoIs. The mu0 threshold represents a L1 configuration with completely open coincidence windows; it is also called the "Cosmic" threshold as it can be used to trigger on cosmic rays during the detector commissioning phase and between the LHC fills. Similar thresholds, labeled with "muXX", have been defined for L2 and EF.

The muon HLT runs L2 and EF algorithms. It starts from the RoI delivered by the L1 trigger and applies trigger decisions in a series of steps, each refining the existing measurement by acquiring additional information from the ATLAS detectors. A list of physics signatures, implemented in the event reconstruction and selection algorithms, are used to build signature and sequence tables for all HLT steps. This stepwise and seeded processing of events is controlled by the trigger steering. The reconstruction progresses by calling feature extraction algorithms. These typically request detector data from within the RoI and attempt to identify muon features. Subsequently, a hypothesis algorithm determines whether the identified feature meets the criteria necessary to continue. The decision to reject the event or continue is based on the validity of signatures, taking into account prescale and pass-through factors. Thus, events can be rejected after an intermediate step if no signatures remain viable.

The main algorithm of the muon L2 system, muFast, runs on full granularity data within the RoI defined by L1. An optimized strategy is used to avoid heavy calculations and access to external services to reduce the execution time of the algorithm. After pattern recognition driven by the trigger hits which selects Monitored Drift Tubes (MDT) regions crossed by the muon track, a track fit is performed using MDT drift time precision measurements. The \(p_{T}\)evaluation is performed using LUT. Reconstructed tracks in the Inner Detector can be combined with the tracks found by muFast by a fast track combination algorithm called muComb.

The L2 algorithm (muIso) is used to discriminate between isolated and non-isolated muon candidates by examining energy depositions in the electromagnetic and hadronic calorimeters. The algorithm is seeded by muons selected by muFast or muComb and decodes LAr and Tile Calorimeter quantities in cones centered around the muon direction. For the muon selection two different concentric cones are defined: an internal cone chosen to contain the energy deposit deposited by the muon itself, and an external cone, containing energy only from detector noise, pile-up and jet particles.

A strategy for tagging muons at L2 in the TileCal is implemented in the TileMuId algorithm. It can provide additional redundancy and robustness to the muon trigger, as well as enhance the efficiency in the low \(p_{\mathrm{T}}\) region. The search starts from the outermost calorimeter layer, which contains the cleanest signals, and once a deposited energy is compatible with a muon, the algorithm checks the energy deposition in the neighboring cells for the internal layers. Candidates are considered tagged muons when muon compatible cells are found following a \(\eta\)-projective pattern in all the three TileCal layers. There are two different variants of this algorithm : one (TrigTileLookForMuAlg) is fully executed on the L2 Processing Unit (L2PU) while the other (TrigTileRODMuAlg) has a core part executed on the Readout Driver (ROD).

The EF accesses the full event with its full granularity. Given the larger admissible latency, it is possible to adapt algorithms developed for the off-line reconstruction to the on-line framework, an approach that minimises algorithm development. The EF processing starts by reconstructing tracks in the Muon Spectrometer around the muons found by L2 and is done by three instances of the EF algorithm; the first instance reconstructs tracks inside the Muon Spectrometer, starting with a search for regions of activity within the detector, and subsequently performing pattern recognition and full track fitting. The second step extrapolates muon tracks to their production point. Finally the information from the first two steps is combined with the reconstructed tracks from the Inner Detector.

The hypothesis algorithms define a set of HLT trigger thresholds by applying cuts on the \(p_{T}\) of the muon candidate. The muon trigger efficiency is defined as

\[\frac{\text{The number of events with a triggered muon}}{\text{The number of events with a muon}} \tag{1}\]

The effective trigger thresholds are obtained in such a way that at the nominal threshold value the efficiency is 90% of the corresponding efficiency without cuts. For this reason effective thresholds are slightly lower than nominal thresholds.

## 4 L1 performance

### Barrel muon trigger performance

As mentioned earlier, studies of muon trigger performance were conducted using simulated samples of single muon events generated over a large \(p_{T}\) and angular range. L1 selection algorithms show an efficiency greater than 99% for muons with \(p_{T}\) above threshold. The overall acceptance (82% low-\(p_{T}\), 78% high-\(p_{T}\)) is due exclusively to geometrical regions of the Muon Spectrometer not covered by the RPC. Figure 1 shows the inefficient regions corresponding to the magnet support structures (\(-2.3\leq\phi\leq-1.7\) and \(-1.4\leq\phi\leq 0.9\)) and the spectrometer central crack at \(\eta\sim 0\), not covered by RPCs. The overall loss in geometrical acceptance due to the \(\eta=0\) crack is approximately 7% while the loss due to the support structure is about 5%. Moreover smaller inefficiency patterns are clearly visible which are due to magnetic ribs in small trigger sectors. The geometrical acceptance effects are visible also in Fig. 2 where the L1 efficiency above threshold is shown with respect to \(\eta\) and \(\phi\).

Figure 1: L1 geometrical acceptance in the \(\eta\)-\(\phi\) plane.

Figure 3 shows turn-on curves for low-\(p_{T}\) and high-\(p_{T}\) thresholds; the efficiencies at plateau and effective thresholds are summarized in Table 1.

Muon tracks are deflected in the \(r-\eta\) plane under the action of the toroidal magnetic field. Their trajectories are symmetrical under charge exchange and reflection with respect to the plane \(z=0\), but the layout of the Muon Spectrometer is not. This asymmetry, could, in principle, produce a bias in the trigger efficiency calculation. From the single muon data sample, it was found that for muons with \(p_{T}\) greater than the L1 threshold the asymmetry in the efficiency is quite small (\(<1\%\)).

Particular attention was devoted to the study of muons with \(2<p_{T}<3.5\) GeV in the barrel region (\(|\eta|<\)1.05). Given the large inclusive cross-section with muons in the final state, this very low-\(p_{T}\) region represents the most significant contribution to the total expected muon rate. Table 2 shows the fraction of these events that produce hits in the RPCs and the L1 barrel efficiency for passing the mu6 trigger. Most of the low \(p_{T}\) muons that pass L1 have \(|\eta|\simeq\)1.

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline Threshold & Plateau Efficiency & Effective Threshold (GeV) & Sharpness(GeV) \\ \hline \hline mu6 & 0.82 & 5.3 & 2.2 \\ \hline mu8 & 0.82 & 6.1 & 1.9 \\ \hline mu10 & 0.82 & 6.7 & 2.2 \\ \hline mu11 & 0.78 & 10.9 & 3.7 \\ \hline mu20 & 0.78 & 15.3 & 7.1 \\ \hline mu40 & 0.78 & 27.8 & 19.7 \\ \hline \end{tabular}
\end{table}
Table 1: Plateau efficiencies, effective thresholds, and sharpness for L1 signatures. Sharpness is defined as the difference of \(p_{T}\) corresponding to 90% and 10% of the plateau efficiency.

\begin{table}
\begin{tabular}{|c|c|c|} \hline Muon \(p_{T}\) (GeV) & Percentage of events with hits in RPC & L1 Efficiency \\ \hline \hline
2 & 0.15\% & \((1.4\pm 0.1)\cdot 10^{-3}\) \\ \hline
2.5 & 0.35\% & \((3.4\pm 0.1)\cdot 10^{-3}\) \\ \hline
3 & 0.48\% & \((4.8\pm 0.1)\cdot 10^{-3}\) \\ \hline
3.5 & 3.36\% & \((33.4\pm 0.3)\cdot 10^{-3}\) \\ \hline \end{tabular}
\end{table}
Table 2: L1 RPC efficiency for very low-\(p_{T}\) single muon events with \(|\eta|<\)1.05.

Figure 2: \(\eta\) and \(\phi\) dependence of barrel trigger efficiency for single muons with a \(p_{T}\)=75 GeV.

Very low-\(p_{T}\) muons produced in the acceptance of the TGC (\(|\eta|>\)1.05) sometimes give hits in the RPC (\(|\eta|<\)1.05) because they are strongly deflected by the magnetic field. The fraction of muons with \(|\eta|>\)1.05 that give RPC hits ranges from 46% at \(p_{T}=2\) GeV to about 10% at 3.5 GeV, and is negligible above 4 GeV. The overall efficiency for such muons to pass the mu6 trigger is about \(10^{-3}\).

Figure 4 shows L1 end-cap efficiency curves for low \(p_{T}\) (left) and high \(p_{T}\) thresholds (right).

Efficiencies at the threshold and plateau are summarized in Table 3. The efficiency of mu6 at threshold is 77%, relatively lower than other cases. This is due to the limited window-size of the three-station coincidence for muons having \(p_{T}\) of 6 GeV.

The \(\eta\) dependence of the mu6 and mu20 efficiency are shown in Fig. 5 (at threshold) and Fig. 6 (at plateau) with respect to the sign of charge of muon \(q\times\eta\). Because the two muon end-cap stations are made as mirror images, \(\mu^{-(+)}\) with \(\eta>(<)\) 0 behaves the same as \(\mu^{+(-)}\) with \(\eta<(>)\) 0. The difference of efficiency between the two signs of \(q\times\eta\) is large at the geometrical boundary for muons near the \(p_{T}=6\) threshold as shown in Fig. 5. One more point

Figure 4: The end-cap trigger efficiency curves for each \(p_{T}\) threshold. The left plot shows the low-\(p_{T}\) thresholds of 6, 8, and 10 GeV and the right plot shows the high-\(p_{T}\) thresholds of 11, 20 and 40 GeV.

\begin{table}
\begin{tabular}{|l|c|c|c||c|c|c|} \hline \(p_{T}\) threshold (GeV) & 6 & 8 & 10 & 11 & 20 & 40 \\ \hline Threshold & 77\% & 84\% & 88\% & 88\% & 92\% & 90\% \\ Plateau & 95\% & 95\% & 95\% & 95\% & 94\% & 93\% \\ \hline \end{tabular}
\end{table}
Table 3: Trigger efficiencies at threshold and plateau for various muon \(p_{T}\) thresholds.

Figure 3: L1 barrel efficiency as a function of \(p_{T}\) for low-pt (left) and high-pt (right) thresholds.

worth noting is the dip at \(\eta\)=2 for the mu6 signature. Muons in the dip region pass through chambers which belong to different trigger sectors, consequently the requirement of a three-station coincidence is not satisfied and trigger efficiency is reduced. Figure 7 shows the \(\phi\) dependence of mu6 (left) and mu20 (right) trigger efficiencies at the plateau and at threshold. The effect of octant symmetry of the magnetic field is seen in the plot of the mu6 efficiency for threshold muons. For the mu6 signature at plateau and for the mu20 signature, this effect is not observed, resulting in an approximately uniform efficiency.

## 5 Performance of L2 muon algorithms

As described in Section 2, algorithm performance is evaluated on samples of single muons generated with different transverse momenta. The resolution of the inverse of the measured momentum with respect to the generated transverse momentum is studied. Due to the non-uniform magnetic field in the Muon Spectrometer it is divided into four regions according to the pseudorapidity of the muon candidate: the Barrel region with \(|\eta|<1.05\), and three end-cap regions with \(1.05<|\eta|<1.5\), \(1.5<|\eta|<2.0\), and \(2.0<|\eta|<2.4\).

For the Muon Spectrometer standalone reconstruction (muFast), the resolution of inverse \(p_{T}\) as a function of the muon transverse momentum is shown in Fig. 8(left). The degradation in the resolution

Figure 5: \(\eta\) dependence of end-cap trigger efficiency for mu6 (left) and mu20 (right). The solid circles represent \(q\times\eta>0\), the open circles represent \(q\times\eta<0\).

Figure 6: \(\eta\) dependency of end-cap trigger efficiency at plateau for mu6 (left) and mu20 (right). The solid circles represent \(q\times\eta>0\), the open circles represent \(q\times\eta<0\).

with respect to previous results [2] is caused by the realistic geometry misalignment introduced in the muon simulation. Resolution as function of \(\eta\) and \(\phi_{Loc}\)2 is shown in Fig. 8(right). The degradation of the resolution in the endcap regions is evident.

Footnote 2: \(\phi_{Loc}\) is the azimuthal angle folded up in \([0,\pi/16]\) such to cover half of an odd MS sector (\([0,\pi/32]\)) and half of an even MS sector \([\pi/32,\pi/16]\).

The muFast efficiency with respect to L1 function of muon momentum are shown for mu4, mu6, and mu20 selections in Fig. 9. The low rejection at small momentum (\(2.5<p_{T}<4.5\,\) GeV), in particular in the barrel region, is caused by candidate tracks not pointing to the nominal interaction vertex due to large scattering angles.

Efficiencies of the MS standalone reconstruction (muFast) (mu6 trigger selection) with respect to L1 selection as a function of \(\eta\) and \(\phi_{Loc}\) for muons with \(P_{T}=6\,\) GeV are shown in Fig. 10.

The combination of a Muon Spectrometer standalone muon candidate with an Inner Detector track found by the L2 tracking algorithms is performed by muComb. For muons with \(p_{T}<50\) GeV the Inner Detector measurement has a better resolution than the Muon Spectrometer standalone measurement. Therefore, the combination of the two measurements gives better resolutions in the low-\(p_{T}\) range. Figure 11 shows the 1/\(p_{T}\) resolution as a function of \(p_{T}\) and also the resolution as function of \(\eta\) and \(\phi_{Loc}\). The muComb efficiency with respect to muFast as a function of \(p_{T}\) for mu4, mu6, and mu20 is shown in Fig. 12. The problem of low rejection for low-\(p_{T}\) muons is partially solved when the Muon Spectrometer candidates are combined with Inner Detector tracks.

Figure 8: 1/\(p_{T}\) resolution (Muon Spectrometer StandAlone) as a function of \(p_{T}\) (left) and \(\eta-\phi_{Loc}\) (right).

Figure 7: \(\phi\) dependence of end-cap trigger efficiency for mu6 (left) and mu20 (right) for muons with \(p_{T}=45\) GeV. The open circles show the efficiency at threshold and the solid circles show the efficiency at plateau.

Figure 10: Efficiency of muFast as a function of \(\eta\) (right) and \(\phi_{Loc}\) (left) for muons with \(p_{T}=6\) GeV.

Figure 9: muFast efficiency with respect to L1 selection for the mu4, mu6, and mu20 triggers for different \(\eta\) regions.

Figure 11: The muon combined \(1/p_{T}\) resolution as a function of \(p_{T}\) (left) and as a function of \(\eta-\phi_{Loc}\) (right).

Figure 12: The muComb algorithm efficiency with respect to mu4, mu6, and mu20 triggers for the different \(\eta\) regions.

Efficiencies of muComb (mu6 trigger selection) with respect to muFast selection as a function of \(\eta\) and \(\phi_{Loc}\) for muons with \(p_{T}=6\,\) GeV are shown in Fig. 13.

## 6 Event filter performance

The full reconstruction in the Muon EF has been executed on the simulated samples described in Section 2. The reconstruction in the Muon Spectrometer is carried out by the MOORE algorithm, the extrapolation to the vertex of the muon track found in the Muon Spectrometer is performed by the MuId standalone algorithm and the combination of the tracks found in the Muon Spectrometer and in the Inner Detector by the Muld Combined algorithm.

Efficiency for single muon events is defined as the ratio of events with a reconstructed track at the EF after the execution of each reconstruction step to all events which have passed L1 and L2. The efficiency with respect to L2 as a function of muon \(p_{T}\) is shown in Fig. 14 for all three EF algorithms.

The efficiency is defined on an event basis, and counts only once events having L2 muon-feature or EF track multiplicity greater than 1. According to this definition, the efficiency to trigger an event with more than one muon is expected to be higher with respect to what is estimated here.

Figure 14: Efficiency as a function of muon \(p_{T}\) for MOORE, Muld Standalone and Muld Combined.

Figure 13: Efficiency of muComb as a function of \(\eta\) (right) and \(\phi_{Loc}\) (left) for single muons with \(p_{T}=6\) GeV.

The efficiencies are lower for \(3<p_{T}<6\) due to multiple scattering and energy loss fluctuation effects. Moreover, in the case of Muld Combined, at very high \(p_{T}\) the increasing probability of muon showering is responsible for a small loss in efficiency. The efficiencies as a function of \(\eta\) and \(\phi\) show a structure, especially at low momentum, explainable with some residual dependence in \(\eta\) and \(\phi\) on the Muon Spectrometer geometrical acceptance and on the magnetic field inhomogeneities which affect less previous levels. It can be seen in Fig. 15 where the efficiency is shown for 6

GeV muons.

In Fig. 16 the Muld combined efficiency with respect to L2 for different thresholds is shown on the left, while the overall trigger efficiency (L1 + L2 + EF) with respect to the generated muons is shown on the right. All efficiency values are averaged over the whole \(|\eta|<\)2.4 range.

In Fig. 17, the \(1/p_{T}\) resolution is shown as a function of muon \(p_{T}\) for all EF algorithms. For a muon with \(p_{T}\) below 50 GeV the Inner Detector dominates the reconstruction precision so the combination of measurements greatly improves the resolutions. For a muon with \(p_{T}\) above 100 GeV, the Muon System dominates the measurement of the muon combined transverse momentum. \(1/pt\) resolution as a function of \(\eta\) is shown in Fig. 18 for 20 GeV muons. The worsening of the resolution in the region \(1.0<|\eta|<1.5\) can be attributed to the highly inhomogeneous magnetic field in the transition regions of the Muon Spectrometer. This effect is recovered by means of the combined reconstruction which exploits the Inner Detector performance.

Figure 16: Muld combined efficiencies for various \(p_{T}\) thresholds with respect to L2 (Left) and with respect to generated truth muons (Right).

Figure 15: Efficiency of Muld Combined as a function of \(\eta\) (left) and of \(\phi\) (right) for 6 GeV muons.

## 7 Muon trigger rates

The trigger rates for single muon event originating from all the physical processes expected in ATLAS were obtained using the EF MuiD combined algorithm (the events must of course also pass the L1 and L2 muon algorithms). Various luminosity scenarios expected during LHC operation (from \(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\) to 10\({}^{34}\) cm\({}^{-2}\) s\({}^{-1}\)) were considered. Trigger rates were typically computed by convolving, over a given \(p_{T}\) range, the estimated efficiencies with the cross-sections of processes representing the main muon sources at LHC. For the i-th process with cross-section \(\sigma_{i}\), the rate is

\[R_{i}=\mathcal{L}\int\frac{d\sigma_{i}}{dp_{T}}\epsilon(p_{T})dp_{T} \tag{2}\]

where \(\mathcal{L}\) is the instantaneous luminosity and \(\epsilon(p_{T})\) is the muon trigger efficiency for a given \(p_{T}\) value. In order to take into account the \(\eta\) dependence, separate estimates for different \(\eta\) regions have been considered. An 0.5 GeV step has been applied in the numerical integration. The inclusive muon cross-sections at the LHC for \(b\rightarrow\mu\) and \(c\rightarrow\mu\) decays have been parameterized by using PYTHIA 6.403 [3]

Figure 17: \(1/p_{T}\) resolution as a function of \(p_{T}\) for MOORE, MuId Standalone and MuId Combined.

Figure 18: \(1/p_{T}\) resolution for MuId Combined as a function of \(\eta\) for muons with \(p_{T}=20\) GeV.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline \multicolumn{6}{|c|}{L1 muon trigger rates} \\ \hline \hline  & \multicolumn{2}{c|}{\(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\)} & \multicolumn{2}{c|}{\(\mathcal{L}=10^{33}\) cm\({}^{-2}\) s\({}^{-1}\)} & \multicolumn{2}{c|}{\(\mathcal{L}=10^{34}\) cm\({}^{-2}\) s\({}^{-1}\)} \\ \hline  & Barrel (Hz) & Endcaps (Hz) & Barrel (Hz) & Endcaps (Hz) & Barrel (Hz) & Endcaps (Hz) \\ \hline  & \multicolumn{2}{c|}{“Cosmic”} & \multicolumn{2}{c|}{6 GeV} & \multicolumn{2}{c|}{20 GeV} \\ \(\pi/K\) & 454 & 199 & 8600 & 5300 & 1100 & 5200 \\ \hline beauty & 85 & 74 & 4400 & 5100 & 2500 & 3300 \\ \hline charm & 124 & 104 & 6100 & 6900 & 2800 & 4400 \\ \hline top & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & 0.3 & 0.5 \\ \hline \(W\) & \(<\)0.1 & \(<\)0.1 & 3.0 & 4.4 & 26 & 41 \\ \hline TOTAL & 663 & 377 & 19100 & 17300 & 6400 & 12900 \\ \hline  & \multicolumn{2}{c|}{5 GeV} & \multicolumn{2}{c|}{8 GeV} & \multicolumn{2}{c|}{40 GeV} \\ \(\pi/K\) & 162 & 81 & 2200 & 3800 & 470 & 1900 \\ \hline beauty & 54 & 53 & 2900 & 4000 & 1100 & 1300 \\ \hline charm & 76 & 73 & 3800 & 4700 & 1200 & 1400 \\ \hline top & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & 0.3 & 0.3 \\ \hline \(W\) & \(<\)0.1 & \(<\)0.1 & 4 & 4.5 & 23 & 33 \\ \hline TOTAL & 292 & 207 & 8900 & 12500 & 2800 & 4600 \\ \hline \end{tabular}
\end{table}
Table 4: Single muon trigger rates at L1, for various low and high \(p_{T}\) thresholds, at \(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\), \(\mathcal{L}=10^{33}\) cm\({}^{-2}\) s\({}^{-1}\) and \(\mathcal{L}=10^{34}\) cm\({}^{-2}\) s\({}^{-1}\).

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline \multicolumn{6}{|c|}{L2 muon standalone trigger rates} \\ \hline \hline  & \multicolumn{2}{c|}{\(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\)} & \multicolumn{2}{c|}{\(\mathcal{L}=10^{33}\) cm\({}^{-2}\) s\({}^{-1}\)} & \multicolumn{2}{c|}{\(\mathcal{L}=10^{34}\) cm\({}^{-2}\) s\({}^{-1}\)} \\ \hline  & Barrel (Hz) & Endcaps (Hz) & Barrel (Hz) & Endcaps (Hz) & Barrel (Hz) & Endcaps (Hz) \\ \hline  & \multicolumn{2}{c|}{4 GeV} & \multicolumn{2}{c|}{6 GeV} & \multicolumn{2}{c|}{20 GeV} \\ \(\pi/K\) & 190 & 140 & 4300 & 3700 & 410 & 1800 \\ \hline beauty & 50 & 67 & 3000 & 3900 & 540 & 1500 \\ \hline charm & 70 & 94 & 4000 & 5200 & 520 & 1700 \\ \hline top & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & 0.2 & 0.4 \\ \hline \(W\) & \(<\)0.1 & \(<\)0.1 & 3 & 4 & 24 & 38 \\ \hline TOTAL & 310 & 301 & 11300 & 12800 & 1494 & 5038 \\ \hline  & \multicolumn{2}{c|}{5 GeV} & \multicolumn{2}{c|}{8 GeV} & \multicolumn{2}{c|}{40 GeV} \\ \(\pi/K\) & 82 & 120 & 840 & 1500 & 200 & 690 \\ \hline beauty & 37 & 59 & 1000 & 2200 & 87 & 280 \\ \hline charm & 49 & 81 & 1300 & 2900 & 83 & 290 \\ \hline top & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & 0.1 & 0.2 \\ \hline \(W\) & \(<\)0.1 & \(<\)0.1 & 3 & 4 & 17 & 23 \\ \hline TOTAL & 168 & 260 & 3143 & 6604 & 387 & 1283 \\ \hline \end{tabular}
\end{table}
Table 5: Single muon trigger rates at L2 muon standalone, for various low and high \(p_{T}\) thresholds, at \(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\), \(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\), 10\({}^{33}\) cm\({}^{-2}\) s\({}^{-1}\) and 10\({}^{34}\) cm\({}^{-2}\) s\({}^{-1}\). The large expected rate in particularly in the endcap, caused by the relatively low rejection of low \(p_{T}\) muons, can be reduced by improving the selection algorithm.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline \multicolumn{6}{|c|}{L2 muon combined trigger rates} \\ \hline \hline  & \multicolumn{2}{c|}{\(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\)} & \multicolumn{2}{c|}{\(\mathcal{L}=10^{33}\) cm\({}^{-2}\) s\({}^{-1}\)} & \multicolumn{2}{c|}{\(\mathcal{L}=10^{34}\) cm\({}^{-2}\) s\({}^{-1}\)} \\ \hline  & Barrel (Hz) & Endcaps (Hz) & Barrel (Hz) & Endcaps (Hz) & Barrel (Hz) & Endcaps (Hz) \\ \hline  & \multicolumn{2}{c|}{4 GeV} & \multicolumn{2}{c|}{6 GeV} & \multicolumn{2}{c|}{20 GeV} \\ \(\pi/K\) & 130 & 124 & 3500 & 2600 & 68 & 890 \\ \hline beauty & 48 & 66 & 2700 & 3400 & 320 & 830 \\ \hline charm & 66 & 91 & 3800 & 4400 & 280 & 840 \\ \hline top & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & 0.2 & 0.4 \\ \hline \(W\) & \(<\)0.1 & \(<\)0.1 & 3 & 4 & 22 & 35 \\ \hline TOTAL & 244 & 281 & 10000 & 11000 & 690 & 2590 \\ \hline  & \multicolumn{2}{c|}{5 GeV} & \multicolumn{2}{c|}{8 GeV} & \multicolumn{2}{c|}{40 GeV} \\ \(\pi/K\) & 44 & 55 & 400 & 530 & 6 & 310 \\ \hline beauty & 31 & 45 & 660 & 1100 & 31 & 92 \\ \hline charm & 41 & 61 & 780 & 1300 & 26 & 99 \\ \hline top & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & \(<\)0.1 & 0.1 & 0.1 \\ \hline \(W\) & \(<\)0.1 & \(<\)0.1 & 3 & 4 & 7 & 12 \\ \hline TOTAL & 116 & 161 & 1840 & 2900 & 70 & 513 \\ \hline \end{tabular}
\end{table}
Table 6: Single muon trigger rates at L2 muon combined, for various low and high \(p_{T}\) thresholds, at \(\mathcal{L}=10^{31}\) cm\({}^{-2}\) s\({}^{-1}\), \(10^{33}\) cm\({}^{-2}\) s\({}^{-1}\), and \(10^{34}\) cm\({}^{-2}\) s\({}^{-1}\).

[MISSING_PAGE_FAIL:16]

* Barrel-Endcap double counts (BE): When a single muon is detected by an overlapping RPC-TGC sector pair.
* Endcap-Endcap double counts (EE): When a single muon is detected by two overlapping "Endcap" TGC sectors.
* Forward-Forward double counts (FF): When a single muon is detected by two overlapping "Forward" TGC sectors.

The probabilities that a single muon would cause any of these fake double counts have been calculated separately. The effect of the MuCTPI overlap handling can be seen in Fig. 20, where the left plot shows the BE fake dimuon trigger probabilities for the 6 \(p_{T}\) thresholds in the 2 to 50 GeV range without using the overlap handling, while the right plot shows the probabilities after applying the MuCTPI overlap handling.

The probabilities for 6 and 20 GeV single muons to produce a fake dimuon trigger if they caused a single-muon trigger, for all available L1 muon thresholds, can be seen in Table 8.

The fake probabilities can be used to calculate the single-muon trigger rates according to

\[R_{\rm fake}=\mathcal{L}\int\limits_{P_{T}^{\rm{a}eff}}^{p_{T}^{\rm{a}ff}} \sigma_{p}(p_{T})\epsilon(p_{T})P_{\rm fake}(p_{T})dp_{T} \tag{4}\]

where \(\mathcal{L}\) is the instantaneous luminosity of the accelerator, \(\sigma_{p}\) is the inclusive muon production cross-section at LHC and \(\epsilon\) is the L1 trigger efficiency. The fake dimuon trigger rates are presented in Table 9.

## 8 Rejection of muons from \(\pi/K\) decays

Despite the large theoretical uncertainties on the rates of the muon production processes at low transverse momentum, it is clear that in flight decays of pions and kaons are a significant source of single muons and, therefore, a strategy must be developed to reject these events in the trigger. Rejection of muons from \(\pi\) and \(K\) decays at the EF is described below. A study describing rejection at L2 can be found in [7].

Figure 20: Barrel-Endcap fake dimuon trigger probabilities without (a) and with (b) using the overlap handling of the MuCTPI.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline Trigger item & \(p_{T}\)[GeV] & BB prob. [\%] & BE prob. [\%] & EE prob. [\%] & FF prob. [\%] \\ \hline \hline
2mu4 & 6.0 & 1.56 \(\pm\) 0.07 & 1.39 \(\pm\) 0.08 & 1.00 \(\pm\) 0.07 & 0.81 \(\pm\) 0.06 \\  & 20.0 & 1.43 \(\pm\) 0.06 & 0.13 \(\pm\) 0.02 & 0.49 \(\pm\) 0.05 & 0.55 \(\pm\) 0.05 \\ \hline \hline
2mu5 & 6.0 & 1.14 \(\pm\) 0.06 & 1.17 \(\pm\) 0.07 & 0.40 \(\pm\) 0.05 & 0.56 \(\pm\) 0.06 \\  & 20.0 & 1.43 \(\pm\) 0.06 & 0.13 \(\pm\) 0.02 & 0.49 \(\pm\) 0.05 & 0.55 \(\pm\) 0.05 \\ \hline \hline
2mu6 & 6.0 & 1.11 \(\pm\) 0.05 & 0.97 \(\pm\) 0.06 & 0.39 \(\pm\) 0.04 & 0.55 \(\pm\) 0.05 \\  & 20.0 & 1.43 \(\pm\) 0.06 & 0.13 \(\pm\) 0.02 & 0.49 \(\pm\) 0.05 & 0.55 \(\pm\) 0.05 \\ \hline \hline
2mu8 & 6.0 & 0.87 \(\pm\) 0.05 & 0.38 \(\pm\) 0.06 & 0.31 \(\pm\) 0.05 & 0.58 \(\pm\) 0.07 \\  & 20.0 & 1.33 \(\pm\) 0.06 & 0.10 \(\pm\) 0.02 & 0.42 \(\pm\) 0.05 & 0.45 \(\pm\) 0.05 \\ \hline \hline
2mu10 & 6.0 & 0.68 \(\pm\) 0.05 & 0.12 \(\pm\) 0.08 & 0.21 \(\pm\) 0.09 & 0.54 \(\pm\) 0.13 \\  & 20.0 & 1.26 \(\pm\) 0.06 & 0.10 \(\pm\) 0.02 & 0.36 \(\pm\) 0.04 & 0.36 \(\pm\) 0.04 \\ \hline \hline
2mu11 & 6.0 & 0.43 \(\pm\) 0.21 & 0.00 \(\pm\) 0.00 & 0.32 \(\pm\) 0.15 & 0.42 \(\pm\) 0.16 \\  & 20.0 & 0.86 \(\pm\) 0.05 & 0.00 \(\pm\) 0.00 & 0.33 \(\pm\) 0.04 & 0.32 \(\pm\) 0.04 \\ \hline \hline
2mu20 & 6.0 & 0.28 \(\pm\) 0.28 & 0.00 \(\pm\) 0.00 & 0.48 \(\pm\) 0.34 & 0.00 \(\pm\) 0.00 \\  & 20.0 & 0.75 \(\pm\) 0.05 & 0.00 \(\pm\) 0.00 & 0.24 \(\pm\) 0.03 & 0.18 \(\pm\) 0.03 \\ \hline \hline
2mu40 & 6.0 & 0.42 \(\pm\) 0.42 & 0.00 \(\pm\) 0.00 & 0.00 \(\pm\) 0.00 & 0.00 \(\pm\) 0.00 \\  & 20.0 & 0.49 \(\pm\) 0.04 & 0.00 \(\pm\) 0.00 & 0.08 \(\pm\) 0.03 & 0.08 \(\pm\) 0.03 \\ \hline \end{tabular}
\end{table}
Table 8: Probabilities that single muons with transverse momenta 6 and 20 GeV which caused a single muon trigger, to also passes a fake dimuon signature at the same threshold.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline Trigger item & BB rate [Hz] & BE rate [Hz] & EE rate [Hz] & FF rate [Hz] & Total fake rate [Hz] \\ \hline
2mu4 & 1846.6 \(\pm\) 119.2 & 271.6 \(\pm\) 14.1 & 136.2 \(\pm\) 24.5 & 69.2 \(\pm\) 12.3 & 2323.7 \(\pm\) 123.1 \\
2mu5 & 243.9 \(\pm\) 13.0 & 203.1 \(\pm\) 10.6 & 35.3 \(\pm\) 10.5 & 33.3 \(\pm\) 6.5 & 515.5 \(\pm\) 20.8 \\
2mu6 & 193.9 \(\pm\) 12.4 & 82.6 \(\pm\) 7.1 & 24.6 \(\pm\) 6.0 & 24.7 \(\pm\) 4.7 & 325.7 \(\pm\) 16.2 \\
2mu8 & 114.1 \(\pm\) 9.8 & 16.1 \(\pm\) 2.1 & 9.7 \(\pm\) 3.0 & 12.4 \(\pm\) 3.3 & 152.3 \(\pm\) 11.0 \\
2mu10 & 79.2 \(\pm\) 8.0 & 4.9 \(\pm\) 1.2 & 4.8 \(\pm\) 2.2 & 5.5 \(\pm\) 2.0 & 94.4 \(\pm\) 8.6 \\
2mu11 & 11.7 \(\pm\) 1.8 & 0.1 \(\pm\) 0.1 & 3.9 \(\pm\) 2.0 & 4.5 \(\pm\) 1.8 & 20.1 \(\pm\) 3.2 \\
2mu20 & 2.4 \(\pm\) 0.4 & 0.1 \(\pm\) 0.0 & 2.4 \(\pm\) 1.9 & 0.7 \(\pm\) 0.5 & 5.5 \(\pm\) 2.0 \\
2mu40 & 0.8 \(\pm\) 0.1 & 0.0 \(\pm\) 0.0 & 1.7 \(\pm\) 1.7 & 0.1 \(\pm\) 0.1 & 2.6 \(\pm\) 1.7 \\ \hline \end{tabular}
\end{table}
Table 9: Rates of various fake dimuon triggers at \(\mathcal{L}=10^{33}\) cm\({}^{-2}\) s\({}^{-1}\).

### Data samples and their validation

Minimum bias samples would be the most suitable for studies involving pion and kaon decays. However, the probability that pions or kaons produced in low or moderate \(p_{T}\) QCD scattering would decay before interacting hadronically in the calorimeters is low, between 0.1% and 1% depending on the meson \(p_{T}\). In order to enhance the number of charged pion and kaon decays in the sample, the simulation of events without any charged meson with \(p_{T}\) above a given threshold is aborted and one \(\pi^{\pm}\) or \(K^{\pm}\) is forced to decay in the Inner Detector cavity.

The samples produced are:

* \(10^{6}\) single pions with \(p_{T}>2.5\ GeV\) and kinematics (\(p_{T}\times\eta\)) generated according to a double differential cross-section of primary pions in minimum bias events
* \(10^{5}\) minimum bias events, where one charged \(\pi\) or K with \(p_{T}>2\ GeV\) per event is forced to decay;

In order to estimate cross-sections or trigger rates, the abundance of forced decays must be re-weighted on an event by event basis according to meson decay probability. In addition to the above samples, standard minimum bias events have been used as a reference to cross check the results obtained from these dedicated productions.

The muon \(p_{T}\) spectra observed in minimum bias events and single pions, forced to decay, were found to be consistent, after appropriate re-weighting, with each other and in agreement with previous predictions and unforced minimum bias events.

### Rejection strategy at the event filter

The fraction of in flight decay muons retained at the EF, normalised to the L2 efficiency, for the mu6 trigger item, has been measured as a function of the muon \(p_{T}\). There is a very poor rejection capability (\(\lesssim 90\%\)) for muons coming from pion decays, which demonstrates that the standard muon identification procedures are not very sensitive, as expected, to the small kink between the pion and muon tracks. The kinematics of charged kaon two-body decays, which are the dominating kaon contribution to the muon rate, is much more favorable toward rejection due to the larger average value of the angle between the kaon and the muon tracks. In order to improve the rejection capability, additional measured parameters providing some discriminating power between background and primary muons have been identified:

* the impact parameter, \(\mathrm{d_{0}}\), of the track reconstructed in the inner tracker;
* the number of hits associated to the Inner Detector track in the Pixel Detector (\(\mathrm{N_{hits}(Pixel)}\)), in the pixel B-layer (\(\mathrm{N_{hits}(B_{layer})}\)) and in the Silicon Tracker (\(\mathrm{N_{hits}(SCT)}\));
* the ratio \(\mathrm{p_{TID}/p_{TMS}}\) between the transverse \(p_{T}\) in the Inner Detector and in the Muon Spectrometer, after back-extrapolation to the interaction point and correction for the measured energy loss in the calorimeters;
* the \(\chi^{2}_{\mathrm{matching}}\) of the matching between the track parameters as reconstructed in the Muon Spectrometer and in the Inner Detector.

The discrimination power of each variable has been studied by measuring the fraction of accepted events as a function of the cut applied for both isolated muons and fake muons above a given \(p_{T}\) threshold. The results, shown in Fig. 21, are based on the simulations of single muons and single pions with forced decays. For each variable, the fraction of events retained after the cut is normalised to the number of events passing the EF reconstruction before the application of any hypothesis algorithms. From the analysis of the exclusive rejection power of the individual variables, the set of cuts listed below have been defined. These cuts try to minimize the efficiency loss for prompt muons while reducing the background:* \(|\mathrm{d}_{0}|<0.15\) mm, \(\mathrm{N}_{\mathrm{hits}}(\mathrm{B}_{\mathrm{layer}})\geq 1\), \(\mathrm{N}_{\mathrm{hits}}(\mathrm{Pixel})\geq 3\), \(\mathrm{N}_{\mathrm{hits}}(\mathrm{SCT})\geq 6\),
* \(\mathrm{p}_{\mathrm{T}\mathrm{D}}/\mathrm{p}_{\mathrm{T}\mathrm{M}S}<1.25\), \(\chi^{2}_{\mathrm{m}\mathrm{t}\mathrm{a}\mathrm{t}\mathrm{a}}\leq 26\).

In particular, these values have been chosen by considering efficiency and background rejection at \(p_{T}=4\GeV\). It is assumed that cuts will be optimized for each muon item in the trigger menu.

From the application of these cuts on the reference sample of events accepted at the EF, the efficiency for prompt muons and in flight decay muons shown in Fig. 22 have been obtained. A loss of efficiency between 25% at the 4 GeV threshold and 10% at 20 GeV correspond to a reduction in background of 65% and 75%, respectively. The rejection achieved for kaon decays is slightly better than that achieved for \(\pi\) decays, as expected from the different decay kinematics. These results are derived from nominal detector performance and algorithm resolutions. However, they demonstrate that cuts can be adjusted to obtain reasonable trigger rate at the very low \(p_{T}\) threshold of 4 GeV which is reached mostly by reducing uninteresting events at the cost of some efficiency loss for prompt muons. An optimization of the cuts, with specific tuning for each trigger element, will eventually further improve the signal to background ratio.

## 9 Muon isolation

### Optimization procedure

The L2 isolation algorithm is seeded by either muFast or muComb. The algorithm decodes LAr and Tile Calorimeter quantities (i.e. transverse energy deposit or sums of calorimetric cells above a predefined energy threshold) in cones centered around the muon direction. The geometrical definition of these

Figure 21: Efficiency for prompt muons and muons from pion decays as a function of the cut on some discriminating variables.

cones is given by the condition \(\Delta R<\Delta R_{MAX}\), where \(\Delta R=\sqrt{(}\Delta\eta^{2}+\Delta\phi^{2})\), and \(\Delta\eta\), \(\Delta\phi\) are the distances in pseudorapidity and azimuthal angle between the calorimetric cell and the cone axis. Because the muon itself contributes to the energy deposit inside the cone, to improve the discriminating power of the isolation algorithm, two different concentric cones are defined: an internal cone chosen to contain the energy deposit released by the muon itself, and an external one, supposed to include contributions only from detector noise, pile-up and jet particles if present. The optimization of the muon isolation algorithm consists of determining the optimal size of the inner and outer cone radius, the values of the cell energy thresholds, used to compute the transverse energy and number of cells sums, and the isolation requirements.

Table 10 summarizes the samples that have been used to optimize the algorithms and to measure their performance. Half of the events in the samples number 1 and 2 in the Table have been used as signal and background, respectively, in the optimization of the algorithm parameters, the remaining events for sample 1 and 2 and the other samples listed in the Table have instead been used to estimate the algorithm performances.

Only the parameters relative at the muon trigger in the barrel region (\(|\eta|<1.05\)) have been studied. Simulation of the electronic readout noise for both LAr and Tile Calorimeters has been also included.

A muon track passing through the calorimetry will deposit energy in the cells which immediately surround it. The deposited energy can be contained within some cone of radius \(R_{Imner}\), where \(R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\). If the muon is isolated, there will be little energy deposited in cells which lie in an outer

Figure 22: EF efficiency as a function of \(p_{T}\) for different rejection cuts for prompt muons (a), muons from single pion decays (b), minimum bias events (c and d). In (c) \(\pi/K\) contribution has been separated. Each efficiency curve shows the data reduction obtained by the addition of the corresponding cut to the overall selection procedure. The specific values of the cuts are discussed in the text.

annulus around this (\(R\in[R_{Imer},R_{Outer}]\)). The radius of the inner cone (i.e. the cone fully containing the muon) has been determined from the distribution of the summed transverse energy contained within a cone of increasing radius around the muon direction from \(Z\rightarrow\mu\mu\), as shown in Figure 23. The value of \(R\) corresponding to the inner cone radius is visible as a change in the slope of the curve. Once the radius for which all the muon energy is contained in the cone is reached, for each further increase of the cone radius only noise will be summed, resulting in a reduction of the slope of the energy sum curve. The reduction in the slope depends on the level of electronic readout noise per cell, as shown in Fig. 23, where curves for several values of the threshold cut on the calorimetric cell energy is shown, ranging from 40 to 90 MeV. The effect of the electronic noise is only relevant for the LAr calorimeter. From the two figures it can be seen that a cone of radius 0.1 (one readout cell), is sufficient to contain the muon energy deposition in the hadronic calorimeter, while a radius of about 0.07 (one to three readout cells, depending on position), is sufficient for the electromagnetic calorimeter, due to the finer readout granularity. The value of the outer cone radius is instead constrained by timing requirements. Increasing the outer cone radius requires a larger fraction of the calorimeter to be read out and decoded. Because the readout step of the algorithm dominates the execution time (\(>90\%\) of the overall algorithm time) the requirement to keep the overall timing below \(O(10)\)\(ms\) constrains the maximum outer cone radius to be below about 0.4. We have verified that optimal background rejection is obtained by keeping the outer cone radius at is maximum value.

An analysis has been performed over all the quantities used in the isolation hypothesis testing, with a goal of minimizing the number of variable used in the optimization step. Each variable used in the optimization is listed in Table 11, together with the respective separation power expressed in term of minimum variance bound [8]. The optimal value of the cell energy cut thresholds, used to compute the transverse energy and number of cell sums, has been obtained by maximizing the background rejection after applying a fixed cut on the isolation variables (\(var1\) and \(var2\) in Table 11), giving a 95% efficiency for the \(Z\rightarrow\mu\mu\) signal. A common threshold value of 60 MeV has been obtained with this procedure for both the LAr and Tile calorimeter. Algorithm performances are stable for threshold variations of \(\pm 10\) MeV around the optimal values. The distributions of some of the most powerful variables for signal selection and background rejection are shown in Fig. 24.

Optimal cut values for the isolation variables described above have been obtained in a multivariate optimization procedure by simultaneously varying all the cuts in sensible ranges and by minimizing the \(b\bar{b}\rightarrow\mu X\) background efficiency at fixed \(Z\rightarrow\mu\mu\) signal efficiency. In the optimization procedure, both background and signal efficiencies are calculated with respect to muons satisfying the L2 muFast mu20 requirement. In Fig. 25 the background rejection,defined as \(1/\epsilon_{BG}\) where \(\epsilon_{BG}\) is the efficiency for the \(b\bar{b}\) background sample, and \((1-\epsilon_{BG})\) as a function of the \(Z\rightarrow\mu\mu\) signal efficiency, obtained after the optimization procedure, are shown. The chosen working point for the isolation algorithm yields a factor of 10 reduction for the \(b\bar{b}\) background at a 95% signal efficiency for muons with \(p_{T}>\)20 GeV.

\begin{table}
\begin{tabular}{|l|l|c|c|} \hline  & Process & Generator & Number of events \\ \hline
1 & \(Z\rightarrow\mu^{+}\mu^{-}\) & Pythia & \(1\;10^{4}\) \\ \hline
2 & \(bb\rightarrow\mu(15)X\) & Pythia & \(1.5\;10^{4}\) \\ \hline
3 & \(b\bar{b}\rightarrow\mu(6)X\) & Pythia & \(1\;10^{4}\) \\ \hline
4 & \(q\bar{q}\rightarrow\mu X\) & Pythia & \(2.1\;10^{4}\) \\ \hline
5 & Single-\(\mu(p_{T}\)=100 GeV) & Single-Mu gun & \(2\;10^{5}\) \\ \hline
6 & Single-\(\mu(p_{T}\)=38 GeV) & Single-Mu gun & \(2\;10^{5}\) \\ \hline
7 & Single-\(\mu(p_{T}\)=19 GeV) & Single-Mu gun & \(2\;10^{5}\) \\ \hline \end{tabular}
\end{table}
Table 10: Data samples used in the muon isolation algorithm optimization.

\begin{table}
\begin{tabular}{|l|l|c|} \hline Label & variable & Separation \\ \hline \(var1\) & \(Iso_{LAr}=\sum E_{T}^{\Delta R<0.07}/\sum E_{T}^{\Delta R<0.4}\) & 0.21 \\ \hline \(var2\) & \(Iso_{Tile}=\sum E_{T}^{\Delta R<0.1}/\sum E_{T}^{\Delta R<0.4}\) & 0.29 \\ \hline \(var3\) & \(E_{LAr}^{O}=\sum E_{T}^{\Delta R\in[0.07,0.4]}\) & 0.75 \\ \hline \(var4\) & \(E_{Tile}^{O}=\sum E_{T}^{\Delta R\in[0.1,0.4]}\) & 0.40 \\ \hline \(var5\) & \(E_{LAr}^{I}=\sum E_{T}^{\Delta R<0.07}\) & 0.23 \\ \hline \(var6\) & \(E_{Tile}^{I}=\sum E_{T}^{\Delta R<0.1}\) & 0.06 \\ \hline \(var7\) & Number of LAr cells above threshold with \(\Delta R\in[0.07,0.4]\) & 0.72 \\ \hline \(var8\) & Number of Tile cells above threshold with \(\Delta R\in[0.1,0.4]\) & 0.34 \\ \hline \(var9\) & Number of LAr cells above threshold with \(\Delta R<0.07\) & 0.31 \\ \hline \(var10\) & Number of Tile cells above threshold with \(\Delta R<0.1\) & 0.07 \\ \hline \end{tabular}
\end{table}
Table 11: Variable used in the muon isolation optimization procedure. The separation is zero for identical signal and background shapes, and it is one for shapes with no overlap.

Figure 23: The total transverse energy contained within a cone of increasing radius around the muon candidate track from \(Z\rightarrow\mu\mu\) signal events in the LAr calorimeter (left) and Tile calorimeter (right). The different curves on each figure correspond to different thresholds applied on the cell energy.

### Performance

The performance of the isolation algorithms in terms of \(b\bar{b}\) and dijet background reduction, efficiency of benchmark signal channels and timing is presented below. The performance of isolation algorithms can be affected by the instantaneous luminosity since the pile-up requires higher thresholds for the same nominal efficiency. This is particularly true for calorimetry-based isolation, while for track-based isolation the effect can be reduced by requiring that the contributing tracks come from the same primary vertex as the muon. For this reason, the results of this study should be taken as preliminary and valid only in the framework of the approximations used in the simulated events production for these studies. Possible changes and further development may occur as soon as real data is available.

The effect of isolation algorithms on various sources of non-isolated muons at L2 is shown in Table 12. The quantity \(1-\epsilon_{BG}\) is shown for the isolation requirements corresponding to a working point for the isolation algorithm with a nominal \(Z\to\mu\mu\) signal efficiency of 95%. Results from dijet decays give an estimate of the rejection power of the isolation algorithm for high-\(p_{T}\) muons from \(K\) and \(\pi\) in flight decays. The rejection power for low-\(p_{T}\) muons from \(b\bar{b}\) decays selected by the level 2 mu6 requirement has also been estimated. The reduction in rejection power, from a factor 10 to a factor of about 2, at the low-\(p_{T}\) limit is expected, given the low energy associated with the jets. As already mentioned, calorimetry based isolation algorithms are not effective against these kind of muons, and the track-based isolation is expected to be much more powerful in reducing this kind of background.

Figure 24: Most powerful variables for calorimetry-based muon isolation.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline Process & Trigger item & Average muon \(p_{T}\) (GeV) & \(1-\varepsilon_{BG}\) (\%) \\ \hline \(b\bar{b}\rightarrow\mu(15)X\) & mu20 & 25.0 & \(89.4\pm 0.7\) \\ \hline \(b\bar{b}\rightarrow\mu(6)X\) & mu6 & 9.0 & \(54.6\pm 0.9\) \\ \hline \(q\bar{q}\rightarrow\mu X\) & mu20 & 40.0 & \(99.6\pm 0.1\) \\ \hline \(q\bar{q}\rightarrow\mu X\) & mu6 & 20.0 & \(97.3\pm 0.2\) \\ \hline \end{tabular}
\end{table}
Table 12: Muon isolation algorithm \(1-\varepsilon_{BG}\) for muons from several background samples. Efficiencies are calculated with respect to muons passing the level 2 mu20 or mu6 requirements, as specified.

Figure 25: Background rejection (\(1/\varepsilon_{BG}\)) (left), and \(1-\varepsilon_{BG}\) (right), as a function of the signal efficiency as obtained in the muon isolation algorithm optimization procedure.

The isolation algorithm has been tuned such that the efficiency is 95% at the chosen working point. The efficiency of the isolation requirement has been studied as a function of \(p_{T}\) using samples of single muons with a \(p_{T}\) of 11, 39, and 100 GeV. No sizable change in the muon efficiency are visible, indicating that radiation effects are small for \(p_{T}\) in this range. Evaluation of the effect of the muon radiation for very high \(p_{T}\) muons (500 to 1000 GeV) is ongoing. The efficiencies for muons from \(Z\to\mu\mu\) decays and for single muons are reported in Table 13.

The time available for running L2 algorithms in the on-line trigger is limited to approximately 20 ms. The CPU processing time is therefore a relevant parameter for the feasibility of algorithms to be included in the trigger chain. The results obtained indicate a typical overall time of less than 10 ms. Further and more detailed timing studies performed on the actual L2 processors are ongoing.

## 10 Muon identification using the tile calorimeter

The muon signatures in the three radial layers of the Tile Calorimeter are well measured quantities with a typical pattern that can be used to identify the muons efficiently down to very low \(p_{\mathrm{T}}\). This information can be used to confirm the Muon Spectrometer Triggers (i.e. provide redundancy in noisy/dead regions) or to enhance the selection efficiency for very soft muons typically out of reach for the spectrometer.

The algorithm exploits the radial and transverse calorimeter segmentation. The search starts from the outermost layer, which is the one with the cleanest signal, and once a cell is found with energy compatible with a muon, the algorithm checks the energy deposition in the neighbor cells for the most internal layers. These "candidate patterns" are considered as muons when cells compatible with the typical muon energy deposition are found following a \(\eta\)-projective pattern in all the three TileCal layers. More details can be found in Ref. [9].

### Performance

The performance of the TileMuId algorithms has been studied with MonteCarlo single muons and semi-inclusive muon production (\(b\bar{b}\to\mu(4)X\)) samples. The effect of minimum-bias pileup at low luminosity (\(\mathcal{L}=10^{33}\mathrm{cm}^{-2}\mathrm{s}^{-1}\)) has been investigated as well.

Two algorithms, implementing complementary strategies are described, one (TrigTileLookForMuAlg) is fully executed on the LVL2 Processing Unit (PU) the second (TrigTileRODMuAlg) has a core part executed on the Read Out Driver Digital Signal Processor (ROD-DSP) in order to save time. This allows a very fast processing of the entire detector (full scan) as opposed to the RoI based processing typical of the trigger algorithm running on the LVL2 PUs. Since each ROD-DSP processes a small part of the detector readout the TrigTileRODMuAlg acceptance is lower compared with that of TrigTileLookForMuAlg.

\begin{table}
\begin{tabular}{|l|c|c|} \hline Process & Trigger path & \(\epsilon\) (\%) \\ \hline \(Z\to\mu^{+}\mu^{-}\) & mu20 & \(95.5\pm 0.4\) \\ \hline Single \(\mu\)\(p_{T}\)=100 GeV & mu20 & \(98.68\pm 0.07\) \\ \hline Single \(\mu\)\(p_{T}\)=39 GeV & mu20 & \(98.97\pm 0.07\) \\ \hline Single \(\mu\)\(p_{T}\)=6 GeV & mu6 & \(98.54\pm 0.09\) \\ \hline \end{tabular}
\end{table}
Table 13: Muon isolation algorithm efficiencies for muons from several processes and thresholds.

#### 10.1.1 Spatial resolution

The spatial resolution of the algorithms can be studied using the distributions of the residuals \(\Delta\eta=\eta(\mu_{\rm{Tile}})-\eta(\mu_{\rm{truth}})\) and \(\Delta\phi=\phi(\mu_{\rm{Tile}})-\phi(\mu_{\rm{truth}})\) in single muon events with \(2\leq p_{\rm{T}}\leq 15\) GeV. The distributions are well described by a Gaussian and resolution can be defined as \(\sigma_{\eta}=0.05\) for TrigTileRODMuAlg ( \(\sigma_{\eta}=0.04\) for TrigTileLookForMu) and \(\sigma_{\phi}=0.03\) rad. To characterize the performance of the algorithms with MC physics events a matching region with the MC truth will be used. For this analysis a matching region of \(\Delta\eta\times\Delta\phi=0.2\times 0.12\) is used.

#### 10.1.2 Efficiency

The muon-tagging efficiency is defined as the ratio of the number of tagged muons which match a truth muon (\(N_{\rm{tag}}\)) to the number of generated truth muons (\(N_{\rm{gen}}\)).

Figure 26 shows the efficiency as a function of \(\eta\), \(\phi\), and \(p_{\rm{T}}\) of the muon for the two algorithms as obtained using the single muon sample. The efficiency of TileRODMu is lower than that of TileLookForMu. In the region \(0.8\leq|\eta|\leq 1.1\) the towers

Figure 27: Efficiency as a function of \(\eta\) (left) and \(p_{\rm{T}}\) (center) for TrigTileLookForMu (filled circles) and TrigTileRODMu (open squares) in \(b\bar{b}\to\mu(6)X\) events. Right plot show for TrigTileLookforMu the effect of pileup of Minimum Bias events at low luminosity (filled circles) compared with the case without pileup (open squares).

Figure 26: Efficiency as a function of \(\eta\) (left), \(\phi\) (center) and \(p_{\rm{T}}\) (right)for TrigTileLookForMu (filled circles) and TrigTileRODMu (open squares) using single muon events.

are split between the barrel and the extended barrels, and the cells belonging to different partitions are processed by different ROD DSPs. Similar effects are observed for the boundary at \(\eta\sim 0\). Except for these two regions of low geometrical acceptance both algorithms show efficiency \(\sim 85\%\) with good agreement. Since TileCal is homogeneous in \(\phi\), the efficiency is uniform as a function of \(\phi\), see Fig. 26 (center). The efficiency decreases with the muon \(p_{\rm T}\) for \(p_{\rm T}<3\) GeV and is about 42% at \(p_{\rm T}=2\) GeV. Most of the muons with \(p_{T}<2\) GeV stop in the Tile calorimeter. For \(p_{T}>4\) GeV the efficiency is flat at about 60%. Figure 27 (left) and (center) show the efficiency curves for both algorithms as obtained in \(b\bar{b}\to\mu(6)X\) events. These results are in good agreement with the performance obtained using single muons, indicating that the algorithms are not too sensitive to the additional hadronic activity in \(b\bar{b}\) events.

To evaluate the performance in a realistic LHC operation scenario a sample of \(b\bar{b}\to\mu(6)X\) events simulated with pileup of minimum-bias events at a luminosity \({\cal L}=10^{33}\) cm\({}^{-2}\)s\({}^{-1}\) was used. As shown in Fig. 27 (right), the efficiencies as a function of \(p_{\rm T}\) for two cases are similar for \(p_{\rm T}>5\) GeV. The additional muons from minimum-bias events make the efficiency worse in the low \(p_{\rm T}\) region. The average efficiency in the sample with pileup (67.97\(\pm\)0.81)% is slightly lower than the one obtained without pileup (74.25\(\pm\)0.79)%. It can be concluded that the efficiency is not substantially affected by minimum-bias pileup.

#### 10.1.3 Fraction of fakes

The muon tags which are not matched with truth muons are considered fake. The same \(\Delta\eta\times\Delta\phi\) matching cuts are used for the efficiency and fake computation. The fraction of fakes in a given data sample is defined as the ratio of the number of misidentified muons to the total number of events.

The left and center plots of Fig. 28 show the fraction of fakes as a function of \(\eta\) and \(\phi\) obtained by the two algorithms. Both algorithms show a very small fake rate in the central region (0.12% for \(|\eta|<0.7\)). The main contribution of fakes comes from the extended barrel and gap regions, where the cell segmentation is coarse and the projectivity is the worst. The fraction of fakes in the whole range \(|\eta|<1.4\) is \(2.7\pm 0.1\)% for TrigTileRODMu and \(4.1\pm 0.1\)% for TrigTileLookForMu. The fraction of misidentified muons as a function of \(\phi\) is flat as expected.

Figure 28 (right) shows the performance of TrigTileLookForMu in \(b\bar{b}\to\mu(6)X\) events with and without the pileup of minimum-bias events at low luminosity. The fraction of fakes increase from 3.7 \(\pm\) 0.1% to 6.0 \(\pm\) 0.1% when the minimum bias pileup at \({\cal L}=10^{33}\) cm\({}^{-2}\)s\({}^{-1}\) is taken into account. The

Figure 28: Fraction of fakes as a function of \(\eta\) (left) and \(\phi\) (center) for TrigTileLookForMu (filled circles) and for TrigTileRODMu (open squares) in \(b\bar{b}\to\mu(6)X\) events. The right plot compare performance of TrigTileLookForMu in samples with (filled circles) and without pileup (open squares).

fake rate increases at larger values of \(\eta\) (gap and extended barrel), where the cell granularity is worse and more minimum bias event are expected, compared to the central \(\eta\) region.

### Combined performance with the inner detector

In order to measure the \(p_{T}\) of the identified muon, the secondary RoI produced by the TileMuld algorithm is used to seed the Inner Detector (ID) track reconstruction algorithm. The size of the ID RoI that requires processing is defined by the Tile algorithm resolution and by the bending in the central solenoid. For \(p_{\rm T}(\mu_{\rm Truth})>2\) GeV, \(\Delta\phi=\phi(\mu_{\rm Tile})-\phi(\mu_{\rm Track})\approx 0.2\) is required. If at least one track is found within the region \(\Delta\eta\times\Delta\phi=0.1\times 0.2\) and with \(p_{\rm T}>2\) GeV, the calorimetric tag is confirmed to be a muon and the trigger sequence is successful.

Figure 29 shows the multiplicity of track in the ID RoI; left plot shows that a region with \(\Delta\phi=0.1\) misses the low \(p_{\rm T}\) tracks and results in more events with zero track within the RoI. The RoI with \(\Delta\eta=0.2\) does not give any advantage. The RoI with a size \(\Delta\eta=0.1\) and \(\Delta\phi=0.2\) is a good compromise; the efficiency to reconstruct the muon track is good and the multiplicity of tracks (ambiguity) is acceptable. In the case of reconstruction of multiple tracks, the closest is chosen as the best-matched for the \(\mu\) tagged by TileCal, and all tracks are saved since the ambiguity cannot be further resolved at this level. As shown in Figure 29 (center), the multiplicity of tracks within the RoI is not significantly affected by the pileup.

Figure 29 (right) shows the overall combined (TileCal+ID) efficiency for \(\Delta\phi=0.1\) and \(\Delta\phi=0.2\) as a function of muon \(p_{T}\). The combined efficiency obtained with \(\Delta\phi=0.2\) is approximately equal to that of the TileCal stand-alone except for \(p_{\rm T}<3.5\) GeV. The efficiency from the matched track shows no dependence on \(\eta\) or \(\phi\). The efficiency, purity and acceptance using the different sizes of RoI are summarized in Table 14. The efficiency and acceptance are significantly improved from \(\Delta\phi=0.1\) to \(\Delta\phi=0.2\). For \(\Delta\phi=0.2\), 97% of tagged muons by TileCal match the associated track. The purity and acceptance of \(\Delta\phi=0.3\) are similar to those of \(\Delta\phi=0.2\). However, the size of \(\Delta\eta\) does not affect the efficiency of the matched track with \(\mu\) significantly. The differences due to the minimum-bias pileup are observed to be about 2 to 3% due to the small number of events from pileup samples.

Figure 29: The number of tracks within the given RoI for \(b\bar{b}\to\mu(4)X\) (left) and with the fixed RoI size of \(\Delta\eta=0.1\) and \(\Delta\phi=0.2\) for \(b\bar{b}\to\mu(6)X\) with/without pileup (center). The right plot shows the efficiency as a function of \(p_{\rm T}\) for the muons tagged by only TileCal (TileLookForMu) and the muons combined with the associated track.

## 11 Muon trigger performance for \(Z\to\mu^{+}\mu^{-}\)

### The "tag and probe" method

The trigger efficiency is a fundamental parameter in physics analyses and therefore it is important to have several independent methods for estimating it. The "Tag and Probe" method is a concrete application of a data-driven technique for performance analysis. This method is based on the definition of a "probe-like" object, used to make the performance measurement, within a properly "tagged" sample of events. Physics processes suitable for this method are generally those characterized by a double-object final state signature. The decay of the Z provides two high-\(p_{T}\) muons that can lead to two trigger tracks in the Inner Detector and Muon Spectrometer and to a combined object. These two measurements are in principle independent, thought not necessarily uncorrelated.

"Tagged" events require one triggered track with \(p_{T}\ >\) 20 GeV and "Probe" objects can be defined as _Inner Detector offline reconstructed tracks (ID-Probe)_, where measurements are referred to the offline Inner Detector reconstruction efficiency (\(\sim\)100%), or as _Muon Spectrometer offline reconstructed tracks (MS-Probe)_, where values are normalized to the offline Muon Spectrometer reconstruction efficiency (standalone or combined with the Inner Detector).

The trigger performance is measured by checking for L1, L2, and EF trigger tracks associated with each probe object. A schematic illustration of the method is shown in Fig. 30. It must be verified that selected tracks come from a Z decay. A background process with two isolated tracks in the Inner Detector, of which only one is a real muon, would introduce a systematic error in the efficiency evaluation. For this reason, cuts have to be applied in order to select a clean signal sample.

A significant background contribution is expected from QCD processes, which have large cross-sections.

Figure 30: Illustration of the Tag and Probe method (left) and cross-sections with generation cuts for signal and background processes (right).

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline  & **TileLookForMu** & **RoI size with (\(\Delta\eta\), \(\Delta\phi\)) for matching tracks** \\  & & (0.1, 0.1) & (0.1, 0.2) & (0.1, 0.3) \\ \hline \hline Efficiency (\%) & 73.08 \(\pm\) 0.17 & 42.02 \(\pm\) 0.19 & 70.91 \(\pm\) 0.18 & 72.06 \(\pm\) 0.18 \\ Unmatched \(\mu_{\mathrm{Tile}}\) (\%) & & 42.50 \(\pm\) 0.36 & 2.98 \(\pm\) 0.08 & 1.40 \(\pm\) 0.05 \\ Efficiency (\(p_{\mathrm{T}}>\) 4 GeV) & & 44.09 \(\pm\) 0.20 & 72.94 \(\pm\) 0.18 & 73.06 \(\pm\) 0.18 \\ Purity (\(p_{\mathrm{T}}>\) 4 GeV ) & & 98.51 \(\pm\) 0.88 & 98.79 \(\pm\) 0.67 & 98.69 \(\pm\) 0.67 \\ Acceptance (\(p_{\mathrm{T}}>\) 4 GeV) & & 40.78 \(\pm\) 0.31 & 71.93 \(\pm\) 0.45 & 72.01 \(\pm\) 0.45 \\ \hline \end{tabular}
\end{table}
Table 14: Performance with the matched track for \(b\bar{b}\to\mu(4)X\).

This background has been studied by considering the dominant contribution of muons from decays of \(B\)-meson pairs. Also the muonic W boson decay, which can give a higher energetic muon plus an additional muon from a QCD jet and the \(Z\to\tau^{+}\tau^{-}\to\mu^{+}\nu_{\mu}\bar{\nu}_{\tau}\ \mu^{-}\bar{\nu}_{\mu}\nu_{\tau}\) process have been considered.

Moreover the top-pair production cross-section at LHC is of the same order of magnitude as \(Z\) boson cross-section. Top quarks decay with a 99.9% probability into a \(W\)boson and a \(b\) quark. Therefore muons originating from \(W\) boson and \(b\)-quark decays can also give a signal-like signature. Cross-sections and generation cuts of the processes considered are reported in Fig. 30. PYTHIA [5] is used to generate the processes.

Another possible source of background is muons from cosmic-rays. An estimation of cosmic rates in the trigger system has been done in Ref. [10] and shows a negligible effect on trigger performance.

The isolation variables chosen for this analysis are the number of reconstructed tracks in the Inner Detector (\(N_{cone}^{ID}\)), the sum of \(p_{T}\) of the Inner Detector tracks (\(\sum p_{T,cone}^{ID}\)), the energy of a jet candidate (\(E_{cone}^{jet}\)) and the sum of reconstructed energy in the cells of the Calorimeter (\(\sum E_{cone}^{EM}\)). Muons from QCD processes tend to be produced within a large cascade of other particles and therefore should not appear isolated in the detector. In the case of the decay of top pairs, one highly energetic and isolated muon can come from one \(W\) boson decay while the second \(W\) boson can decay leptonically into a high-\(p_{T}\) electron which appears as an isolated track in the Inner Detector. In order to not count this as a false probe, electrons are vetoed. The values of the selection cuts applied in this analysis have been defined in [11]. The isolation cuts allow for background rejection of approximately 99% while retaining a signal efficiency of about 76%. After applying the probe selection cuts the signal to background ratio is more than \(10^{3}\). In addition, probe muons selected from background processes can be associated to trigger tracks and hence have no negative impact on trigger efficiency measurements.

### Determination of trigger efficiencies

Two measurement scenarios have been studied:

* _Low luminosity_ (\(\int\mathcal{L}dt\simeq 50\) pb\({}^{-1}\)): in order to not rely on the combined reconstruction based on Inner Detector and Muon Spectrometer matching, only the tracks from the Muon Spectrometer are used. The isolation cuts are also based only on Inner Detector quantities;
* _High luminosity_ (\(\int\mathcal{L}dt\simeq 1000\ pb^{-1}\)): full combined information from Inner Detector and Muon Spectrometer is used and also Calorimeter based cuts are applied to select isolated tracks.

In each scenario both the ID- and MS-Probe methods have been studied. The efficiency dependence on \(\phi\) and \(\eta\) is determined by the Muon Spectrometer layout. A \(p_{T}\) cut of 20 GeV has been applied on the probe tracks to test the system in its plateau region. The efficiency as a function of p\({}_{T}\) has been also estimated from data in the _high luminosity_ scenario.

#### 11.2.1 Low luminosity measurements

The relative efficiency as a function of \(\eta\), measured at each trigger level, is shown in Fig. 31 using the ID-probe. L1 acceptance losses are related to an incomplete coverage of the trigger detectors due to the presence of support and access structures. The L2 efficiency, with respect to the L1 selection, is about 96% in the barrel region with a small decrease in the endcap, an improvement is expected due to optimization of the TGC cabling in next software releases. The EF shows an \(\eta\) efficiency distribution, with respect to L2, close to 99% in the barrel region and a very small decrease from \(|\eta|>2.0\). In the region \(1.05<|\eta|<1.3\) the absence of the some MDT chambers in the ATLAS initial layout resulted in an efficiency loss of about 10%.3)The observed agreement with the Monte Carlo truth-based analysis is very good. In order to quantitatively estimate the bin-by-bin differences the "fractional efficiency difference"

\[\frac{\epsilon_{Tag\&Probe}-\epsilon_{MC}}{\epsilon_{MC}} \tag{5}\]

has been computed. This quantity is shown for each trigger level in Fig. 31 as a function of \(\eta\).

The agreement between Tag and Probe method and Monte Carlo analysis is very high, more than 99% over all the trigger coverage. The only observed deviations, at the level of 2%, are found in the central crack at \(\eta=0\) and in the transitions from barrel to endcap at \(|\eta|=1.05\). The results obtained by the application of the Tag and Probe method using the standalone MS-Probe are reported in Fig. 32 as a functions of \(\eta\). With respect to the values shown in Fig. 31 inefficiencies due to L1 acceptance cracks are partially factorized in the offline muon reconstruction efficiency of the MS-Probe (e.g. the \(\eta=0\) region.). The same effect is clearly evident at the EF level for the efficiency loss at \(1.05<|\eta|<1.3\) visible in Fig. 31.

Table 15 shows the uncertainties on the overall trigger efficiency in each case, calculated also only in barrel and endcap regions. The statistical uncertainty is reported together with expected systematic

Figure 31: The muon trigger efficiency for each trigger level (left) and fractional efficiency difference (right) as a function of \(\eta\) in the _low luminosity_ scenario using the ID-Probe. The efficiencies determined with the Tag and Probe method are compared to those calculated in a Monte Carlo truth-based analysis.

Figure 32: The muon trigger efficiency for each trigger level (left) and fractional efficiency difference (right) as a function of \(\eta\) in the _low luminosity_ scenario using the MS-Probe. The efficiencies determined with the Tag and Probe method are compared to those calculated in a Monte Carlo truth-based analysis.

errors. Two sources of systematic uncertainties are considered: the absolute difference with respect to the value measured in a Monte Carlo truth-based analysis and the background contribution, evaluated by comparing the efficiency calculated with Tag and Probe method using only the signal sample and using a cross-section weighted sum of all processes. Both systematics are less than 0.5%. A greater background contribution is observed when using ID-Probe, since the isolation is based only on Inner Detector quantities.

#### 11.2.2 High luminosity measurements

After early data is collected and analyzed, a better understanding of the detector, in terms of calibration and alignment, will allow to use all the available information such as Calorimeter quantities for track isolation and combination of Inner Detector and Muon Spectrometer tracks. The trigger efficiency measurements from data in this scenario are reported using the _high luminosity_ dataset of \(\int\mathcal{L}dt=1000~{}pb^{-1}\).

As in the _low luminosity_ case the measured differences between the Tag and Probe and Monte Carlo analysis are compatible with zero. Small deviations at the level of 1 to 2% are observed in the endcap for the L2 trigger efficiency in the \(|\eta|>1.5\) region. These effects are expected to be reduced by the L2 algorithm optimization. Results are shown in Table 16. With the addition of the calorimeter-based isolation, the background systematic contribution is reduced by a factor of 10 with respect to the low luminosity scenario.

The dependence of the trigger efficiency on the \(p_{T}\) shows the typical shape of a turn-on curve. The sharpness of the curve is related to the finite \(p_{T}\) resolution, \(\sim 30\%\) at L1, \(\sim 5\%\) at

\begin{table}
\begin{tabular}{|c c c c|} \hline
**Detector region** & **Barrel** & **Endcap** & **Overall** \\  & (\(|\eta<1.05|\)) & (\(1.05<|\eta|<2.4\)) & (\(0<|\eta|<2.4\)) \\ \hline \multicolumn{4}{|c|}{**High luminosity - ID probe** (\(\int\mathcal{L}dt=1000~{}pb^{-1}\))} \\ \hline \hline Trigger Efficiency & 73.24 & 86.31 & 79.73 \\ \hline Statistical Uncertainty & 0.10 & 0.08 & 0.06 \\ \hline \(|\varepsilon_{TRUTH}-\varepsilon_{TP}|\) & 0.02 & 0.72 & 0.58 \\ \hline Expected Background Contribution & 0.05 & 0.01 & 0.03 \\ \hline Overall Systematic Uncertainty & 0.05 & 0.72 & 0.58 \\ \hline \end{tabular}
\end{table}
Table 16: Estimated uncertainties of in-situ determined muon overall trigger efficiency for the _high luminosity_ scenario using the ID-Probe. Systematic uncertainties are reported for background contribution and absolute difference with Monte Carlo truth-based analysis.

\begin{table}
\begin{tabular}{|c c c c|} \hline
**Detector region** & **Barrel** & **Endcap** & **Overall** \\  & (\(|\eta<1.05|\)) & (\(1.05<|\eta|<2.4\)) & (\(0<|\eta|<2.4\)) \\ \hline \multicolumn{4}{|c|}{**Low luminosity - ID probe** (\(\int\mathcal{L}dt=50~{}pb^{-1}\))} \\ \hline Trigger Efficiency & 71.65 & 83.59 & 77.38 \\ \hline \hline Statistical Uncertainty & 0.42 & 0.36 & 0.28 \\ \hline \(|\varepsilon_{TRUTH}-\varepsilon_{TP}|\) & 0.23 & 0.40 & 0.10 \\ \hline Expected Background Contribution & 0.57 & 0.17 & 0.40 \\ \hline Overall Systematic Uncertainty & 0.61 & 0.43 & 0.41 \\ \hline \multicolumn{4}{|c|}{**Low luminosity - MS probe** (\(\int\mathcal{L}dt=50~{}pb^{-1}\))} \\ \hline \hline Trigger Efficiency & 76.94 & 87.83 & 82.13 \\ \hline Statistical Uncertainty & 0.41 & 0.34 & 0.27 \\ \hline \(|\varepsilon_{TRUTH}-\varepsilon_{TP}|\) & 0.17 & 0.64 & 0.33 \\ \hline Expected Background Contribution & 0.01 & 0.00 & 0.01 \\ \hline Overall Systematic Uncertainty & 0.17 & 0.64 & 0.33 \\ \hline \end{tabular}
\end{table}
Table 15: Estimated uncertainties of in-situ determined muon overall trigger efficiency for the _low luminosity_ scenario, using an ID- and an MS-Probe track. Systematic uncertainties are reported for background contribution and absolute difference with Monte Carlo truth-based analysis.

L2, and \(\sim\) 3% at the EF. Turn-on curves are shown in Fig. 33 using the ID-probe and similar results are obtained with the MS-probe. The turn-on point and the plateau values are correctly reproduced from data. The fractional efficiency difference is shown for each trigger level. The disagreement near the threshold is within 5%, due mainly to resolution effects, while in the plateau region the observed difference is less than 1%.

## 12 High \(\mathbf{p_{T}}\) Dimuon final states

In principle, the high mass dilepton/diphoton resonance search should have a fairly straightforward trigger strategy as there are very high energy leptons in the event. However, there are several questions that remain: what trigger requirements are optimal for the analysis? What \(p_{T}\) thresholds and object quality selection should be applied? How can one estimate the trigger efficiency from data for such rare (or non-existent) events? Are the same object quality requirements that are appropriate for lower \(p_{T}\) objects appropriate for very high energy objects?

This Section addresses these questions, evaluates the trigger efficiency for the signal samples of interest, and discusses the trigger strategy for the earliest data taking periods. It is expected that during both low and high luminosity periods there will be an unprescaled single muon trigger without an isolation requirement. The 20 or 40 GeV threshold are expected to be highly efficient for a high mass resonance decaying into two muons.

### Efficiency estimate

The muon trigger efficiency is estimated using several methods. The first method is to rely on simulation; while this is the simplest and most direct method it is believed to be somewhat more optimistic (better resolution, higher efficiency). Therefore, the trigger efficiency is also estimated using methods which can be applied to real data.

The trigger efficiencies are calculated with respect to the offline event selection. Two combined muons are required to satisfy the cuts: \(|\eta|\,<\,2.7\), \(p_{T}\,>\,30\) GeV, track fit \(\frac{\chi^{2}}{\mathrm{D.O.F}}\,<\) 10 and Inner Detector and Muon Spectrometer track match \(\frac{\chi^{2}}{\mathrm{D.O.F}}\,<\) 10. The trigger efficiencies for the dimuon heavy resonance Monte Carlo samples are shown in Table 17. The efficiency as a function of \(p_{T}\) has been fit to

Figure 33: Muon trigger efficiency turn-on curve after each trigger level determined by the Tag and Probe method and by the Monte Carlo truth-based analysis in the _high luminosity_ scenario using the ID-Probe (left). In the right plot the fractional efficiency difference is shown.

\[f(p_{T})=0.5\cdot A_{2}\cdot(1.0+erf(\frac{p_{T}-A_{0}}{\sqrt{2}\cdot A_{1}})) \tag{6}\]

where \(erf\) is the error function, \(A_{0}\), \(A_{1}\), and \(A_{2}\) are the fit parameters which represent the \(p_{T}\) value at which the efficiency reaches half its maximum value, the slope of the turn-on curve, and the maximum efficiency in the plateau region, respectively.

There are several methods to evaluate the trigger efficiency from the data itself. A possible one is to look at the trigger efficiency for a known experimentally clean signature that is similar to the final state of interest; \(Z\rightarrow\mu^{+}\mu^{-}\) is one of such signatures. Since the Z is light compared to the total center of mass energy, it can be produced with a significant \(p_{T}\) distribution. The trigger efficiency on the Z can be measured and extrapolated to high \(p_{T}\). The advantage of this method is that it uses data to measure the trigger efficiency which is the most accurate method of measuring the Z trigger efficiency. A disadvantage is that the muon trigger efficiency is being extrapolated to a \(p_{T}\) by a factor of 10 higher than the mean \(p_{T}\) of the muons from the Z decay.

The strategy of evaluating the trigger efficiency from data is as follows. It is first necessary to use one of several methods to estimate the muon trigger efficiency as a function of the muon \(p_{T}\) and its uncertainty. The single object trigger efficiency allow the construction of the probability for an event with N objects to pass the trigger. This probability can be written as:

\[P=1-\prod_{i=1}^{N}(1-P_{i}) \tag{7}\]

where \(P_{i}\) is the probability for the \(i\)-th object to pass the trigger.

Two common methods that have been used extensively at the Tevatron are the selection by orthogonal triggers and the 'Tag and Probe' method using Z \(\rightarrow\ \mu\mu\) decay. The 'Tag and Probe' requires two offline muons to have an invariant mass within 12 GeV\({}^{2}\) of 91.1 GeV\({}^{2}\). The turn on curves as a function of the offline muon \(p_{T}\), obtained using this method, is fit to equation 6. This procedure was repeated for all three trigger levels and the results are summarized in Table 18.

A second possible method of evaluating the trigger efficiency with data is by the method of orthogonal triggers. To obtain a sample of unbiased events we select events that pass one of the calorimeter based triggers, the single 20 GeV jet trigger. We then perform the offline analysis and require that we have a dimuon pair using identical event selection to the 'Tag and Probe' analysis. From this sample we

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline \hline Target Level & \(A_{0}\) & \(A_{1}\) & \(A_{2}\) \\ \hline \hline L1 & 12.5 \(\pm\) 0.3 & 3.7 \(\pm\) 0.4 & 0.845 \(\pm\) 0.02 \\ \hline L2 & 19.6 \(\pm\) 0.2 & 1.59 \(\pm\) 0.19 & 0.976 \(\pm\) 0.02 \\ \hline EF & 19.5 \(\pm\) 0.4 & 1.56 \(\pm\) 0.3 & 0.931 \(\pm\) 0.01 \\ \hline \hline \end{tabular}.

\end{table}
Table 18: Fitted parameter for the L1, L2, and EF of the trigger \(p_{T}\) turn on curves

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline \hline Sample & L1 \% & L2 \% & EF \% & Total Trigger Efficiency \% \\ \hline
400 GeV \(\rho_{T}/\omega_{T}\) & 97.6 \(\pm\) 0.10 & 98.8 \(\pm\) 0.07 & 99.5 \(\pm\) 0.05 & 96.0 \(\pm\) 0.13 \\
600 GeV \(\rho_{T}/\omega_{T}\) & 98.1 \(\pm\) 0.08 & 98.5 \(\pm\) 0.08 & 99.2 \(\pm\) 0.06 & 95.9 \(\pm\) 0.13 \\
800 GeV \(\rho_{T}/\omega_{T}\) & 97.6 \(\pm\) 0.10 & 98.7 \(\pm\) 0.07 & 99.2 \(\pm\) 0.05 & 95.6 \(\pm\) 0.13 \\
1 TeV \(\rho_{T}/\omega_{T}\) & 97.6 \(\pm\) 0.09 & 98.7 \(\pm\) 0.07 & 99.2 \(\pm\) 0.05 & 95.6 \(\pm\) 0.12 \\
1 TeV Z’ (E6) & 97.8 \(\pm\) 0.09 & 98.9 \(\pm\) 0.06 & 99.5 \(\pm\) 0.04 & 96.3 \(\pm\) 0.1 \\
2 TeV Z’ (SSM) & 97.6 \(\pm\) 0.14 & 98.7 \(\pm\) 0.11 & 98.9 \(\pm\) 0.10 & 95.3 \(\pm\) 0.2 \\ \hline \hline \end{tabular}
\end{table}
Table 17: Trigger efficiencies of dimuon resonance samples. For the meaning of E6 and SSM see [12].

simply check the fraction of events that pass the L1, L2, and EF trigger conditions for the 20 GeV muon trigger. The results are shown in Table 19 and are in good agreement with the 'Tag and Probe' method and direct emulation of the trigger on the Monte Carlo sample. Unfortunately, in the real experiment a single jet trigger with a threshold of 20 GeV would be very highly prescaled and hence will suffer from poor statistics. Events that passed any calorimeter trigger could be used for this study if biases in the event topology were taken into account, however, such a study is beyond the scope of this note.

We have developed two methods that could be used to evaluate the trigger efficiency from data. Extraction of the muon trigger efficiency as a function of the reconstructed muon kinematics via a tag and probe method and an orthogonal trigger method agree well with the simulated trigger efficiency. These methods will allow us to more accurately estimate the trigger efficiency for LHC data.

## 13 Summary

In this paper Muon trigger baseline performance and rates for initial and standard LHC operation have been presented. Trigger efficiency has been studied in detail in a wide energy range using single muon simulated samples. From efficiencies the muon rates have been evaluated. It should be noted that due to the uncertainties of the inclusive muons cross-sections, rates could vary significantly and different threshold cuts could be adopted. A further rate reduction should come from dedicated strategies to reject muon from in-flight decays of \(K\) and \(\pi\); in this paper a preliminary analysis is presented at Event Filter. It is demonstrated that a good rejection can be achieved with contained losses of prompt muons.

The possibility to select at the ATLAS second level trigger with high efficiency isolated muons from \(W\) and \(Z\) decays reducing the ones from heavy quark decays has been studied in depth. Although electronic readout and pileup noise have been simulated, no cavern background has been yet included. A factor of ten reduction on high-\(p_{T}\) muons from heavy-quark decays has been obtained while maintaining a 95% efficiency on \(Z\rightarrow\mu^{+}\mu^{-}\) final state. Next step will be to investigate how much the use of the longitudinal granularity of the calorimeters and inner tracker detector will increase the muon isolation rejection power.

The overall performance of the TileCal muon tagging algorithm has been presented, using MC samples of single muons and inclusive B-Physics processes, including minimum-bias pileup at low luminosity.

We finally addressed the question of how the muon trigger efficiency can be measured with \(Z\rightarrow\mu^{+}\mu^{-}\) and \(Z^{\prime}\rightarrow\mu\mu\) using the tag and probe method. This technique shows a very good agreement with results based on Monte Carlo studies.

## References

* [1] ATLAS Collaboration, Muon Spectrometer Technical Design Report, CERN/LHCC/97-022 (1997).
* [2] A. Sidoti, The ATLAS trigger muon'vertical slice, Nucl. Instrum. Meth. A **572** (2007) 139.

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline _Sample_ & L1Mu20 Efficiency \% & L2Mu20 Efficiency \% & EFMu20 Efficiency & Total Efficiency \\ \hline \hline Z’ 1 TeV (SSM) & 97.7 \(\pm\) 0.11 & 99.0 \(\pm\) 0.07 & 99.6 \(\pm\) 0.04 & 96.3 \(\pm\) 0.01 \\ \hline \(Z\rightarrow\mu^{+}\mu^{-}\) & 97.83 \(\pm\) 0.04 & 98.86 \(\pm\) 0.03 & 99.52 \(\pm\) 0.02 & 96.26 \(\pm\) 0.05 \\ \hline \hline \end{tabular}.

\end{table}
Table 19: L1Mu20 trigger efficiencies at L1, L2, and Event Filter w.r.t offline reconstruction using orthogonal trigger selection to record events