September 22, 1999

**Lead Matching and Consequences**

**on the EM Module 0 Constant**

**Term**

**F. Fleuret, B. Laforge, Ph. Schwemling**

_LPNHE-Paris, Universites Paris 6-7, and IN2P3-CNRS_

We present in this note the mathematical algorithms that have been used to sort and pair the lead plates during the construction of the Module 0 of the Liquid Argon barrel calorimeter. This pairing is done to reduce as much as possible the contribution to the constant term that arises from lead thickness inhomogeneities. It is planned to use similar algorithms also during the construction of the complete detector, for the same reason. In addition to the pairing itself, we describe the physical considerations that have led us to the choice of a particular class of algorithms. At the end, we show how the chosen algorithm performs using the thickness dat a available for the lead plates that have been used for the construction of module 0.

[MISSING_PAGE_EMPTY:2]

Introduction

The constraints that the expected performance of the Liquid Argon calorimeter places on the constant term are very stringent. From the Technical Design Report [1], the goal is to have a total constant term amounting to 0.7%, with the contribution of the mechanics (due to local non-uniformities of various origins : lead thickness variations, shape changes from one absorber to its neighbours, gap variations appearing during the assembly of the absorbers, etc.) less than 0.3%. Most of the constant term due to these mechanical causes is expected to be due to the lead thickness non-homogeneities, due to the high variation induced locally on the collected charge by a local variation of the lead thickness : an increase of 1% in the lead thickness translates into a 0.59% decrease of the induced signal [3].

In practice, it is extremely difficult to produce lead with 1% tolerance on the thickness. A 1% tolerance, given the lead thicknesses we use (1.13 mm and 1.53 mm), represents a tolerated thickness variation of 10 to 15 microns. No lead provider is technically able to produce lead with such small tolerances ; the company which is the closest to this number achieves only 3% with no special equipment. This appears at first largely insufficient, however, it is possible by using thickness informations, plate by plate, to cope with the fact that the manufacturer cannot reach a tolerance of 1% on the lead thickness. The main idea is to take advantage from the fact that the electric charge generated by an electromagnetic shower is the sum of the charges generated in the vicinity of several absorbers. In other words, if at some place of the calorimeter there is an absorber whose lead is too thin, the variation this would induce on the collected charge can be largely compensated by placing close to this "thin" absorber an other one that is too thick.

## 2 Thickness shape of the lead plates

The production process of the lead plates has been largely documented elsewhere [4]. We will simply recall that the lead is laminated from lead blocks of about 1 to 2.3 tons each and wound on big rolls, called "coils".

The final thickness is obtained after several (typically 7) passes. Since the roller is an alternating, reversible system, the lead always passes through the same rolls, whose separation is progressively reduced as the lead thickness decreases. Since the lead is soft and the thickness decrease during the last pass is of the order of 0.4 mm, i.e. much bigger than the highest thickness variation along the whole roll, the force applied (\(\simeq 1\)\(MN\)) is sufficient to resorb all the inhomogeneities that have been created before, so we are left only with the ones created during the last pass. Thickness is measured on the fly using an on-line X-ray measurement system during this last pass. Thickness measurements [4] and visual observation of the operation of the roller have shown that thickness variations are due to :

* ellipticity of the rolls. This effect is more or less pronounced, depending upon the temperature (the effect decreases when the rolls get hotter) and upon the relative phase of the rolls. This phase is unfortunately random at the start of the processing of each roll and cannot be changed. This leads to an oscillating thickness pattern of period \(\simeq 50\pi\ cm\) with an amplitude varying from a few \(\mu m\) to \(\simeq 40\ \mu m\).
* instabilities of the hydraulic sytem used to control the speed and torque of the winding and unwinding rolls. This has been seen to lead also to thickness oscillations of various periods and amplitudes but usually less striking than the previous ones.
* parallelism defects in the positionning of the axes of the rolls with respect to each other. This leads to an inclined thickness profile in the r-profile of the plates, whereas the two previous causes only affect the \(\eta\)-profiles. This effect is typically of the order of a few microns along the whole radius span of the calorimeter.

## 3 Implementation of the pairing system in the IN2P3 hall

After being laminated, lead is cut into plates which are stored by boxes of about 40 plates. The X-ray measurement made during the laminating process gives information about the average thickness of plates within a box. After this step, boxes are sent to IN2P3 hall in Orsay where they are stored.

Ideally, one could think of unpacking all the plates and building the absorbers by always choosing for the \(n^{th}\) absorber the plates that "best match" the absorbers previously built. By "best match", we mean "that will produce the most uniform local response". This criterion will be explicited more precisely in the next sections.

Due to space limitations, only 8 heaps are possible (+2 heaps containing the plates ready for absorber production. See figure-1 which shows the practical organisation of hall IN2P3). Furthermore, the total plate weight (80 t) is so large that it is not possible to unpack them all and stack them at once over the 9 available heaps. The challenge is then to always supply lead with the most constant mean thickness as possible. For the module 0, this is not a problem due to the limited number of plates needed to build it (\(2\times 64\)), so that the storing system could load them all at the same time, its total capacity being about 2 modules. For the production, the X-ray information will be used to select which box must be unpacked in order to constitute the heaps, so as to ensure a lead supply of long range constant average thickness.

When a plate is unpacked, its ultra-sound measurement is done. This information is then put into a database which will be used for the pairing process. After this measurement, the plate is stacked using a vacuum lift mounted on a mobile deck.

## 4 General description of the pairing method

Despite a reasonable accuracy of the lead plate thickness achieved in the laminating process (30 \(\mu m\)), plate to plate thickness fluctuations cannot be neglected. Reaching a contribution to the constant term as small as possible (below 0.3% as required in the ATLAS TDR [1]) requires the build-up of a plate to plate correlation able to smooth out the average thickness calculated over the number of plates seen by an electromagnetic shower.

As soon as we have established this effective number of lead plates seen by a shower, we have elaborated a way of pairing the plates based on a minimization principle taking into account the extremely constrained conditions of lead manipulation in the hall IN2P3. Basically, as we can't move plates except to use them to build an absorber, we have 9 possibilities for each kind of plate (1.13 mm and 1.53 mm) to choose one. Thus, the pairing scheme consists of the calculation of a choice function for each heap. At this step, the work remaining to be done is to decide what is the best choice function. This implies to contruct an estimator to test the different choice functions we could think about. The choice function has to be chosen to ensure the most possible constant response.

As we cannot take the thickness measurements to put them into GEANT and choose the combination that gives the most constant response (due to obvious computing time limitations) we have to design choice functions and a "response constantness evaluation function" that are more easily calculable, as described in the next section.

The data we can use to contruct a choice function are the ultra-sound measurements of each lead plate. These constitute a matrix of about 460 (63 in z \(\times\) 15 in r) local thickness measurements taken over the whole surface of Figure 1: Schematic of the technical design of lead plates heaps in the IN2P3 hall. On the right hand side is represented the ultra-sound measurement system. There are actually 10 heaps present ; the 10\({}^{th}\) is used as an intermediate storing place, before placing the plates in their final stack.

the plate for each of them. A schematic of the measurement matrix is shown figure 2.

## 5 Actual implementation of the method

### Number of plates seen by an electromagnetic shower

The build-up of the correlation that is supposed to ensure constant response needs first the knowledge of the number of consecutive plates (absorbers) over which the correlation has to be effective, i.e. the number of plates over which an electromagnetic shower develops. The determination of the average number of lead plates seen by an electromagnetic shower requires the use of a detailed simulation of a module. We have used the dedicated version of DICE done especially to simulate the Module 0 of the EM barrel done by G. Parrour and P. Petroff. We have adapted this program in order to get the energy deposited in each liquid Argon gap by a shower [3].

Looking at the distribution of this energy as a function of the gap number, we can get the effective number of gaps over which a certain fraction of the shower energy is deposited. We have studied both electron and photon showers for energies between 10 to 100 GeV. We did not simulate higher energy showers because above 100 GeV, leakage begins to be sizeable and because the most stringent requirements on the calorimeter resolution come from

Figure 2: Schematic of the measurement matrix available on each absorber lead plates. The dashed lines delimit the 60 \(\eta\)-cells.

physical processes that involve photons or electrons of energies of \(\simeq 100\) GeV or less (\(H\rightarrow\gamma\gamma\), \(H\to e^{+}e^{-}e^{+}e^{-}\)).

In order to get a robust result, we have changed in our simulation several parameters that are likely to have an effect on the shower width. We have studied also the effect of the pre-shower detector and established that it has almost no effect at the level of precision we required. We have simulated showers both in the 1.13 mm and 1.53 mm lead region. We also tested the effect of the \(\phi\) inhomogeneities, shooting particles in between two absorbers or directly in the "foot" of an absorber, i.e. in the G10 bar. None of these effects were found to have a big effect on the shower shape. In each case, using a gaussian fit of the energy profile of the obtained electromagnetic shower, we obtained a \(\sigma_{N_{gap}}\), the standard width of a shower, located between 1.60 and 1.68 gap. The corresponding plots are presented on figures 3 to 4. We simulated 10 events for each case in order to save CPU time. However, we checked that simulating 100 events does not change the result by more than 5%. As we are interested in determining an integer effective number of plates, the precision that we obtained this way is large enough for our purpose.

According to the previous fit, we can deduce that the main part of a shower energy is roughly deposited over 5 plates. This number of plates is also the one which can be deduced from calculations made in [2]. We choose then to make the matching in order to reduce fluctuation of the mean thickness over 5 plates.

### Estimator of the pairing quality

As the final result we want to achieve is a smoothing of the mean thickness over 5 plates, the natural estimator we can think about to evaluate the constantness of the calorimeter response is the variance of this quantity calculated along the whole module 0 using a sliding mean thickness calculation over 5 plates since, at first order, the response is linearly dependent over the thickness. This estimator can be written :

\[\sigma^{(5)}=RMS\bigg{\{}\vec{e}_{i}-e_{n}\bigg{\}}_{\mbox{\scriptsize all cells}}\]

where \(e_{n}\) is the nominal thickness of the lead plates and \(\vec{e}_{i}\) is the mean thickness over 5 plates of a defined cell \(i\). This mean thickness is computed from ultra-sound measurements of all points in the cell over the 5 plates. The number of cells we have used is 60 as represented on figure 2. We have used this estimator in all the studies presented here.

Figure 3: Energy deposited in each gap of the module 0 for a photon of 100 GeV emitted at \(\Phi=0.2\) and \(\eta=0.3\) as a function of the gap number (1 to 64). The sigma obtained with a gaussian fit is 1.67 gap.

Figure 4: Energy in Gev deposited in each gap of the module 0 for (a) a electron of 50 GeV, (b) a photon of 100 GeV, (c) a photon of 50 GeV without the pre-shower detector. All these particles were emitted at \(\Phi=0.2\) and \(\eta=0.3\) as a function of the gap number (1 to 64). (d) Same distribution for a photon of 50 GeV emitted in the 1.13 mm thickness part. On each of these plots is given the fitted sigma value in number of gaps.

### Test of Choice functions

The knowledge of the lead plate thickness over their all surface allows to compute choice functions giving both information on the local and global fluctuation of each plate thickness.

Having built \(n\) absorbers in a module, the most naive choice function to pick up a lead plate which can be thought about is based on each top plate. We can, for instance, take the plate whose average thickness is the nearest to the nominal value. But doing that, we don't use the available information coming from the existing absorbers already put in the module nor the information based on the structure of the lead plates still in the heaps available to make the next absorbers. As the number of plates seen by an electromagnetic shower is five, we decided to use information from 2 plates from the 2 last already built absorbers and from 3 plates available on the heaps. Each of these three plates corresponds to a plate which would be on top of a heap after we would have picked up the previous one. In other words, we use information on plates which can be buried in the heaps at a maximum depth of 3 plates.

Global shape information are obtained from averages over a large domain of a plate whereas local information is given from few measurements located close to each other. The most global information over a 5 plates configuration is then the mean thickness computed from every single measurement from every plate. The most local information is the mean over the 5 plates of the thickness measurements taken at the same point. We have to find a compromise between the long and the short range information to compute a choice function. Indeed, on one hand, using only long range quantities can be very inefficient as global compensation can occur. As an illustration of that fact, imagine a plate with half of it being 20 \(\mu\) thinner than the nominal thickness and the second half being 20 \(\mu\) thicker, globally the mean thickness would be the nominal value. Therefore, choosing such a plate without further consideration can create a very bad fluctuation in the local response of the detector. On the other hand, short range criteria could reject a very good plate because of a very local default. As we choose a whole plate each time, both kinds of information must be used.

A convenient estimator of the local plate thickness quality is the difference to the nominal thickness : \(e_{i}-e_{n}\). Thus, we will naturally construct the choice functions with this quantity.

As the fluctuation in the \(r\) direction is much smaller than the one in the\(z\) direction, we decided to use local information on the z structure of the lead plates. More precisely, we defined 60 cells in \(\eta\) as represented on fig. 2. Because of the large number of \(\eta\) cells, this segmentation is roughly equivalent to a \(z\) segmentation.

Then, we naturally define choice functions with the functional form :

\[\sum_{i\in\text{cell}}\bigg{|}\sum_{j\in plate}w_{j}\;(e_{i}-e_{n})\bigg{|}^{\alpha}\]

where \(\alpha\) is a certain power and \(w_{j}\) a weight factor. These weight factors are respectively 1 and 2 for the two plates already in the module and 3, 2, 1 for the three plates used to compute the choice function. This procedure cancels any degenerated solutions space (with no weight, we could find situations where taking plates in reverse orders would give the same value of the choice function) and gives a predominance to the plate to be chosen in the choice function value. Moreover, a natural idea is to attribute weights relatively to the fraction of the shower seen by each plate. The weights that we have applied are an approximation of the shower tranverse energy density distribution in order to have a physically motivated weighting.

### Respect of technical constraints

The algorithms that we wrote and tested are meeting two key-points imposed by the organisation of the production process. The first one is due to the very delicate manipulation of lead plates which is done with a system based on a vacuum pump and an armada of succion pads. In order not to damage the plates, each of them should not be moved except to be used in the module being built. The second technical constraint taken into account is the difference of thickness between the 1.53 mm plate and the 1.13 mm plate at the interface of each absorber. We took into account the constraint :

\[\left|e_{1.53}-e_{1.13}\right|=0.4\,\pm 0.02\]

around a region of 20 cm around the \(\eta=0.8\) cut line. This constraint is supposed to avoid bubbles when the absorber is built up.

### The final configuration

Using real data, we tested different values of the power \(\alpha\) given in the previous equation, trying to minimize the value of our estimator. It turned out that the best exponent sits around 1. Therefore, the module 0 matching will be done using an exponent exactly equal to 1. The final choice function is then :

\[\sum_{i\in cell}\bigg{|}\sum_{j\in plate}w_{j}\;(e_{i}-e_{n})\bigg{|}\]

## 6 Simulation results on toy thickness distributions

In order to test our ideas and methods, we used different 'toy' distributions of lead plate thickness. As a first try, we used plates with distributed thickness but without local inhomogeneities. We used equiprobable distributions and gaussian distributions. We also investigated the consequences of heaps constitution. We especially tested a distribution of plates whose thickness increased gradually in order to see how our algorithms could make vanish a very strong plate to plate correlation intendedly put in the heaps. These simulations showed that we could even in this case decrease the fluctuation of the thickness averaged over 5 plates by 50 % compared to the one obtained with an uncorrelated distribution whose plates would have been chosen in the heaps order.

## 7 Results on real thickness distribution

The different algorithms were also tested with the real distribution of plates as it was available in the hall IN2P3 at Orsay. We compared our algorithm to the case where the plates were chosen in the order of the heap (1\({}^{st}\) of the 1\({}^{st}\) heap, \(\Delta^{nd}\) of the 1\({}^{st}\) heap,...,last of the last heap) and with the "orthogonal" order (1\({}^{st}\) of 1\({}^{st}\) heap, 1\({}^{st}\) of 2\({}^{nd}\) heap,..., last of last heap). Depending upon the way heaps were built, one mode corresponds to constructing absorbers with a succession of plates having the same fluctuation dependence as the one produced by the laminating process and the other to a large breaking of this correlation. The second case can roughly be considered as being equivalent to an uncorrelated distribution of plates because all plate to plate correlation is broken by the dealing procedure. In that case, correlations between plates being on top of a heap are almost null since these plates were produced either from a different lead roll or at a non-adjacent place on the same roll.

We did the analysis both for 1.13 mm plates and 1.53 mm. As the laminating production process is roughly the same for both kind of thickness, the \(\sigma\) on the thickness (_e_) of the two kind of plates is the same. Consequently, \(\sigma_{1.1}^{(5)}/e_{1.1}\) (for 1.13 plates) is bigger than \(\sigma_{1.5}^{(5)}/e_{1.5}\) (for 1.53 plates). We give below the obtained results on the 1.13 and 1.53 plates for the three cases discussed above :

\begin{tabular}{||c|c|c||} \hline Matching method & \(\sigma_{1,1}^{(5)}/e_{1.1}\) & \(\sigma_{1,5}^{(5)}/e_{1.5}\) \\ \hline \hline In the order of heap & \(7.4\,10^{-3}\) & \(2.3\,10^{-3}\) \\ \hline In the orthogonal order & \(5.48\,10^{-3}\) & \(2.3\,10^{-3}\) \\ \hline Our Matching & \(4.10^{-3}\) & \(2.2\,10^{-3}\) \\ \hline \end{tabular}

It turns out that for \(1.13\) plates, our weighting procedure induces a subtantial gain whereas for the \(1.53\), the gain is smaller. This is due to the fact that the \(1.53\) plate distribution was already of good quality. Figure 5 shows the map of the Module 0 actually built (\(60\,\eta\)-cells \(\times\)\(64\) plates). Figure 6 shows the \(\eta\) profiles of the Module 0 for both \(1.13\) mm and \(1.53\) mm parts. Figure 7 shows the distribution of \(\eta\)-cell thickness for each individual plate or averaged over 5 plates. These distributions were used to extract the thickness fluctations quoted in the previous table. Figure 7.(b) exhibits a small peak around \(1.13\) mm. This peak is due to the last 4 plates of the modules which were chosen by the pairing program at a time when there were very few remaining plates on the \(1.13\) mm heaps and consequently a limited choice. Figure 8 shows the same distribution than figure 7.(b) but with the last 4 plates of the modules removed showing clearly the origin of the bump. During the series production such an effect should not occur since heaps will be repeatedly loaded with new plates.

As the relation between \(\sigma^{(5)}/e\) and the constant term C was determined from a simulation to be about (see figure 9) :

\[C\simeq\sqrt{\left(\,0.53\ \frac{\sigma^{(5)}}{e}\,\right)^{2}+0.25^{2}}\]

and

\[C\simeq\sqrt{\left(\,0.44\ \frac{\sigma^{(5)}}{e}\,\right)^{2}+0.3^{2}}\]

respectively at \(\eta=0.3\) and \(\eta=1.1\)[3], we can quote constant term contributions from lead inhomogeneities to be : \(C_{1.1}=1.8\times 10^{-3}\) and \(C_{1.5}=1.17\times 10^{-3}\).

## 8 Conclusion

Finally, we have reached the goal for Module 0 and achieved a contribution from lead thickness inhomogeneities to the constant term smaller than \(0.3\) %. We can quote constant term contributions from lead inhomogeneities should be for the Module 0 :

\[C_{1.1}=1.8\times 10^{-3}\quad\mbox{and}\quad C_{1.5}=1.17\times 10^{-3}\]

This will be checked in the coming beam tests.

Figure 5: (a) Individual thickness map of Module 0 (60 \(\eta\)-cells \(\times\) 64 absorbers). (b) Averaged over 5 absorbers thickness map of module 0

Figure 6: (a) Individual thickness \(\eta\)-profile of the 1.13 mm part of the Module 0. (b) Averaged (over 5 plates ) thickness \(\eta\)-profile of the 1.13 mm part of the Module 0. (c) Individual thickness z-profile of the 1.53 mm part of the Module 0. (d) Averaged (over 5 plates ) thickness \(\eta\)-profile of the 1.53 mm part of the Module 0. The multiple lines which are observed reflect the projection on the \(\eta\)-axis of the 2D-map of the Module 0 (60 \(\eta\)-cells \(\times\) 64 absorbers).

Figure 7: Module 0 characterization : (a) individual cell thickness distribution in the 1.13 mm (b) \(\eta\)-cell averaged (over 5 plates) thickness distribution in the 1.13 mm (c) \(\eta\)-cell individual thickness distribution in the 1.53 mm (d) \(\eta\)-cell averaged (over 5 plates) thickness distribution in the 1.53 mm

Figure 8: Same distribution as figure 7.b but without the last four 1.13 plates. The peak around 1.13 mm has disappeared. This peak reflects the small number of available plates at the end of the construction of the Module 0. This effect should not occur during the series production since heaps will be continuously loaded.

Figure 9: Evolution of the constant term as a function of the ratio of the fluctuation of the mean thickness over 5 plates divided by the nominal thickness of the lead plates.

Acknowledgements

We take the opportunity of thanking B. Mansoulie for fruitful discussions and suggestions along that work.

## References

* [1] ATLAS Liquid Argon Calorimeter Technical Design Report, 15 December 1996.
* [2] B. Mansoulie, ATLAS Internal Note ATL-LARG-98-099, _"Non-uniformity of lead plates and gap : Analytical estimates of the shower averaging effect."_, 1998.
* [3] F. Fleuret, B. Laforge et Ph. Schwemling, _Constant Term Evolution with Lead Plate Thickness fluctuations in EM Module 0_, ATL-LARG-99-???.
* [4] B. Canton et al., _"Analysis and Results of the measurements of the plate thickness, done at the factory, during the production of the lead for the module 0 of the Barrel and End-Cap ATLAS electromagnetic calorimeter"_. ATLAS Internal note LARG-76