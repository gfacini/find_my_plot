**Comparison between the ATLAS/TileCal hadron barrel calorimeter prototypetest beam data and Hadronic Simulation packages.**

**Ilias Efthymiopoulos**

_CERN/PPE, Geneva Switzerland_

**for the ATLAS/TileCal Collaboration \({}^{*}\)**

ABSTRACT

A comparison between the test beam data of the ATLAS/TileCal hadronic calorimeter prototypes modules, in standalone and in combined mode with the Liquid Argon EM barrel calorimeter prototype in front, and different hadronic shower simulation codes (FLUKA, GHEISHA, CALOR) in the framework of the GEANT program is presented. Comparisons are made for all packages for the general hadronic shower parameters, as well as for the energy resolution and response linearity. From these studies, it is shown that none of the above packages is able to describe in the desired precision the test beam data.

## 1 Introduction

For the needs of the ATLAS/TileCal hadronic calorimeter a full simulation package has been developed based on the GEANT program [1] which describes in full detail the detector prototypes that have been used for the test beam runs, and was extensively used during the R&D work for the final ATLAS detector design. During the almost four years of the TileCal collaboration five prototype modules were constructed. These prototypes have been put in the CERN SPS H8 test beam line, which is able to provide a variety of beam energies from 10 up to 400 GeV for protons, muons and electrons. The modules have been extensively tested both in standalone and once, in September 1994, in a combined mode with the ATLAS/LARG EM calorimeter prototype in front, aiming to reproduce as much as possible the finalATLAS setup. In order to describe this combined detector setup, the TileCal simulation program was merged with the similar one developed for the LARG detector which also describes in the best possible detail the EM prototype [2].

Comparisons between the pion and muon test beam data and simulated data using the three hadronic packages interfaced with the GEANT program (FLUKA, CALOR and GHEISHA) are presented. For this comparison, the basic hadronic shower characteristics such as the longitudinal and lateral profiles, the energy resolution and response linearity are used. Special emphasis is given in the reproduction of the pion response linearity curve from the Monte Carlo data, since this will allow us to transfer safely the knowledge from the test beam to the ATLAS environment at the TeV range.

## 2 The Detector

The ATLAS/TileCal barrel hadron calorimeter is a sampling calorimeter with steel as the absorber and scintillating tiles as the active material, oriented in planes perpendicular to the colliding beams and staggered in depth. The iron to scintillator ratio is about 4.67:1 in volume. Each scintillating tile is read out by two wavelength shifting fibres, placed at its ends along the radial direction. Each river is read by one photomultiplier.

This innovative design allows a simple construction technique, very important for the large ATLAS detector dimensions, and as was shown from the test beam data and from Monte Carlo simulations in the ATLAS environment, provides good sampling homogeneity when placed behind an EM calorimeter and a coil, of about two interaction lengths in total [3].

For the test beam, five prototype modules were constructed. Each module covers 2\(\pi\)/64 in azimuth and extends 1m long in the \(z\) direction. The radial depth, starting from an inner radius of 200cm to an outer radius of 380cm accounts to about 9 \(\lambda\), divided in four segments corresponding to 1.5,2, 2.5 and 3 \(\lambda\) at \(\eta=0\). The five modules were stacked together giving a total front face coverage of about 100 \(\times\)100 cm\({}^{2}\).

### The Combined Setup

For the combined run, the LARG EM calorimeter 1[4] and the TileCal hadron calorimeter prototypes were put together in a setup as close as possible to the final ATLAS configuration (fig. 1). In this configuration, the distance between the active parts of the two calorimeters was about 55 cm (0.27\(\lambda\)), almost a factor of two from the ATLAS value. Due to the mechanical constrains of the prototypes the calorimeters were put in a fixed position, with the beam entering with an angle of 11.3\({}^{0}\) at \(\eta\sim 0.44\), with the total active thickness of the two calorimeters being about 10.3\(\lambda\). In front of the EM calorimeter, a 3\(X_{0}\) thick fully equiped preshower detector was put, which was used in the analysis to reject particles which give interactions in the materials before the calorimeters. From the total active volume of the EM calorimeter only a window of 11 \(\times\)11 cells (or about 25 \(\times\) 25\(cm^{2}\)) was used, centred at the nominal beam incident point. The EM calorimeter is segmented in depth in three compartments of 9, 9 and 7 \(X_{0}\) at \(\eta=0\), and its fully projected cells measure 0.018 \(\times\) 0.02 in \(\eta\times\phi\) (0.036 \(\times\) 0.02 for the last compartment). With the incident angle of this setup the calorimeter was not projective.

## 3 Standalone tests

For the standalone tests of the detector data from pions, muons and electrons of various energies in the range from 10 to 400 GeV were used[5]. In the simulation program all the experimental effects (such as tile response non-uniformities, fibre to fibre fluctuations, light attenuation in the fibres, noise etc..) were included thus allowing the best possible description of the detector. This was indeed verified with the quality of the agreement in the simulation of the muon signal at various energies with the experimental data[6][7].

For the study of the hadronic showers, simulated data with all the available hadronic shower packages interfaced to the GEANT program were used[1].

Figure 1: The combined calorimeter setup.

The GHEISHA package does not contain any simulation of the physical processes that determine the dynamics of the interaction of hadrons with matter; instead it, is using different parameterisations trying to reproduce directly the outcome of these reactions. The secondary particles are produced according to scaling lows, symmetry requirements, and careful tuning of the parameters to reproduce available experimental data. It was therefore of no surprise that some level of disagreement with the TileCal experimental data, was observed for this package.

The other two packages FLUKA and CALOR are actually not very different ones, at least in the way they are implemented in the GEANT code. In the FLUKA code primary interactions for particles above 5 GeV are treated according to the Dual Parton Model, while for lower energies up to 300 MeV for nucleons and 50 MeV for other particles, a resonance production model is used. For particles bellow these energies, all important nuclear effects are taken into account. In the CALOR package particles with energies above 10 GeV or particles different from pions and nucleons are treated exactly as in FLUKA. For lower energies and up to 2.5 GeV for pions and 3.5 GeV for nucleons a hybrid treatment starts, in which a fraction \(\alpha\) of the interactions is performed as in FLUKA and the rest is simulated by the so called _scaling model_. Bellow these thresholds, the Bertini IntraNuclear Cascade (INC) code is used [8].

For the comparison the basic characteristics of the hadronic showers are used: longitudinal and lateral shower profiles, energy resolution, pion response linearity and the \(\mu/\pi\) ratio which characterises the amount of the hadronic activity. To set the scale for both Monte Carlo and real data, electron runs were used. The shower integration time in the simulation is set to 150nsec as the ADC gate in the test beam.

### longitudinal profiles

As was mentioned before in sec. 2 the TileCal calorimeter is segmented in four compartments in depth. In fig. 2 the energy for each longitudinal compartment is plotted for real and simulated data using the CALOR package. For the FLUKA package similar agreement is observed while the GHEISHA is somehow worse. All the packages reproduce quite well the average energy deposited, although they tend to predict "longer" tails at all energies.

### lateral profiles

The lateral profile of the hadronic showers is strongly dependent on the production of fast neutrons and they way these are treated by the simulation code. In general for all the packages considered, the simulation tends to predict narrower showerscompared to the data. The situation improves when lowering the energy cutoff values for the tracking of the neutrons.

### energy resolution

In fig. 3 the energy resolution for pions obtained for the experimental and the simulated data is shown. The FLUKA and CALOR packages predict almost the same values, with those of CALOR being closer to the data, but too optimistic. GHEISHA on the contrary seems too pessimistic.

### response linearity

The TileCal calorimeter is a non compensating calorimeter, therefore the pion response varies with the incident particle energy, according to the formula:

\[R_{h}\propto(e/\pi)^{-1}=\frac{e/h}{1-(1-e/h)<f_{\pi^{0}}(E)>} \tag{1}\]

In fig. 4 we see this variation for both the experimental and the simulated data. It is clear from this plot that none of the packages is able to follow the data.

As we see from eq. 1, the pion response depends on the \(e/h\) ratio of the calorimeter and of the fraction of \(\pi^{0}\) produced. In tab. 1 the values of the \(e/h\) are given for two different sets of energy cutoff values. What is observed, is that the

Figure 2: Longitudinal shower development for 300 GeV pions. The simulated (dots) and experimental data (solid line) are compared.

pure electromagnetic response is almost the same for all packages while the hadronic one varies a lot, and gets smaller when the GEANT energy thresholds are increased. The \(e/h\) value for all the packages is anyhow far away from the \(1.36\pm 0.11\), the value obtained from the experimental data [3]. Correlated to the value of the \(e/h\) ratio, is the fraction of electromagnetic energy produced in a hadronic shower. For the three packages considered, FLUKA is the one that predicts much more EM part (especially at low energies) with respect to the other two who predict almost the same ammount. Once again all the packages are away from the predicted ammount according to both Wigman's and Groom's parameterisations when fitted to our data.

The low values for the \(e/h\) in the case of FLUKA and CALOR is also reflected in the value of the \(\mu/\pi\) ratio, which is about 4% higher than the experimental data. The GHEISHA code predicts lower values by about 7%

\begin{table}
\begin{tabular}{c c c c}  & all GEANT thresholds at 100 KeV \\ \hline  & CALOR & FLUKA & GHEISHA \\ \(e\) & \(2.700\pm 0.02\) & \(2.77\pm 0.02\) & \(2.69\pm 0.02\) \\ \(h\) & \(2.16\pm 0.02\) & \(2.32\pm 0.02\) & \(1.65\pm 0.02\) \\ \hline \hline \(e/h\) & \(1.25\pm 0.02\) & \(1.19\pm 0.02\) & \(1.63\pm 0.03\) \\ \end{tabular}
\end{table}
Table 1: The \(e/h\) values for the different hadronic simulation codes

Figure 3: Energy resolution for pions from the standalone tests of TileCal calorimeter.

## 4 Combined tests

For the energy reconstruction in the hybrid calorimeter case, three different algorithms have been developed [9]. The first and simplest one, also referenced as the "benchmark" approach, uses a simple formula for the total energy, keeping the electron energy scale for the EM calorimeter:

\[E_{total}=E_{em}+a\cdot E_{had}+b\cdot\sqrt{(E_{em}^{s3})\cdot(a\cdot E_{had}^{s 1})}+c\cdot E_{em}^{2} \tag{2}\]

The third term is a parametrisation found from the simulated data of the energy lost in the materials between the calorimeters (mainly dead liquid argon and the cryostat). \(E_{em}^{s3}\) and \(E_{had}^{s1}\) is the signal in the third EM in the first hadronic calorimeter depths respectively. The quadratic term in eq 2 is used in order to correct the strong dependence of the total reconstructed energy from the part released in the EM calorimeter, while for the simulation due to the low \(e/h\) values (at least for the CALOR and FLUKA packages) this dependence is much lower (fig 5). The parameters in eq. 2 are obtained by minimising the resolution at 300 GeV and are kept constant for all the energies.

The other two methods are weighting techniques, one previously used for the standalone data and the other one was taken from a similar analysis of the H1 calorimeter [3] [10]. For the purpose of this study no weighting was applied to the simulated data, instead for most of the comparisons both simulated and

Figure 4: The pion energy response linearity curve for the TileCal standalone tests.

experimental data are used as "raw" quantities, adopting the electron energy scale everywhere.

### longitudinal profiles

In fig. 6 the mean energy per sampling is ploted, as well as the percentage of the total energy released in the EM and the hadronic part, using raw energies. From these plots it can be seen that in general the simulation prefers showers that develop "deeper" than the experimental data, which also implies that the energy released in the hadronic calorimeter is bigger. For all the energies more than 50% of the total energy is released in the hadronic calorimeter.

### energy resolution

In fig. 7 is compared the resolution for the simulated data using the "benchmark" method for the energy reconstruction and that obtained from the experimental data using all three methods.

Like before for the standalone case, FLUKA gives the best resolution, CALOR stays closer to the data and GHEISHA predicts worse values. The agreement with the experimental data is good for the high energies but for the lower ones and in particular for the 20 GeV case is quite bad. With the present understand

Figure 5: The dependence of the total reconstructed energy from the energy released in the EM calorimeter for experimental data (a) and simulated data with the G-CALOR package for pions at 300 GeV.

Figure 6: The mean energy released in each calorimeter sampling using “raw” energies for pions of 20 GeV (a), and 300 GeV (b). In (c) the ratio of the total energy released in the EM and in the hadronic calorimeters for different beam energies is shown.

Figure 7: The energy resolution for simulated and experimental data.

ing, this is due to experimental problems during the data taking such as the beam conditions and the large noise in the EM calorimeter [9].

### response linearity

Since both calorimeters are non compensating it is expected that the total energy increases as the beam energy increases. This can be clearly seen in fig. 8, which is to be compared with fig. 4. The FLUKA and CALOR packages predict a much better linearity as for the standalone case, while GHEISHA seems to agree reasonably well, perhaps because its the one that describes better the EM calorimeter2.

Footnote 2: to investigate further this problem a new combined run was realized in April 1996, but the data have not been analyzed yet

## 5 Conclusions

Summarising all the comparison studies presented, it is clear that none of the packages used is adequate to describe the experimental data for the hadron showers in both standalone and the combined setup. The major problem is the reproduction of the linearity curve which in case of FLUKA and CALOR is far away from the experimental data, a direct consequence of the wrong \(e/h\) value and the amount of the electromagnetic activity produced. Apart from linearity in the combined case

Figure 8: The pion response non-linearity for the combined case, using “raw” energies.

the energy released in the EM calorimeter is much lower in the simulated than the experimental data.

In the years to come until the starting date of the experiment, many more test beam data with the actual detector modules in both standalone and in combined mode will be taken in a big energy range from few, up to hundreds of \(GeV\). The study of the simulation packages, not only the ones considered already but perhaps new ones or new in environments outside of the usual GEANT one, of course will be continued and more comparison tests will be made in the single particle level as well as for the jets, where it was shown in the past that the situation is much different.

## 6 Acknowledgements

The author would like to thank all the colleagues from the TileCal and LArgon collaborations and especially M. Bosman, and A. Juste for their help in the work for the TileCal standalone data and P. Petroff and G. Parrour for their guidance in setting up the combined simulation program.

## References

* [1] R. Brun and F. Carminati, "GEANT Detector Description and Simulation Tool", CERN Program Library, **Long Writeup W5013**, September 1993
* [2] M. Lefebvre et.al., ATLAS Internal Note, RD3 No **41**, (1993)
* [3] F. Ariztizabal et. al.(RD34 Collaboration), Nucl. Instr. and Meth. **A 349**, (1994) F. Ariztizabal et. al.(RD34 Collaboration), LRDB Status Report, **CERN/LHCC 95-44**
* [4] D. M. Gingrich et. al. (RD3 Collaboration), Nucl. Instr. and Meth. **A 364**, 290(1995)
* [5] See talk of M. Bosman at the same conference
* [6] A. Juste, Master Thesis, **IFAE/UAB October 1995**
* [7] See talk of A. Henriques at the same conference
* [8] A. Ferrari, P. R. Sala, ATLAS Internal Note, **PHYS-No-086**, 6 June 1996 (and refs therein)
* [9] M. Cobal et al., ATLAS Internal Note, TILECAL No **67**, (1995)
* [10] P. Casado, M. Cavalli-Sforza, ATLAS Internal Note, TILECAL No **75**, (1996)