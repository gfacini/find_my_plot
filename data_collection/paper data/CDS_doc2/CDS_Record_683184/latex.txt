# Multi-Tape Readout in Slug

Pavel Nevski, CERN, PPE division

###### Abstract

A proposal to organize a multi-tape readout in SLUG is discussed. A suggestion is made to access multi-volume files as an input and output streams for SLUG not only by using the FATMEN system but also with a simple mechanism described below.

## 1 Introduction

An increasing amount of the detailed simulation for the Technical proposal leads to an urgent request to set up a possibility to handle many input and sometime output tapes or files in one job. The most advanced example is the analysis of the 1,000,000 jet sample produced recently at CERN.

A possibility to use the FATMEN system for this purpose has been discussed since long time in the ATLAS software group but has not been implemented yet in particular due to the current FATMEN problems on CSF. It may also be a disadvantage to force ATLAS users to install everywhere a complicate FATMEN system just for this purpose instead of providing more flexible possibility to select between different simplified options.

Here we describe a possible solution of this problem. The corresponding correction to SLUG has been developed and tested on the CERN IBM mainframe, ATLAS cluster and on the CSF farm.

## 2 Definition of a user's I/O request

In the present version SLUG is using up to three I/O streams to handle the simulated events. These streams ('P','B' and 'O') are described in Table 1.

In principle any of these streams may need a multi-volume concatenation. To describe a set of volumes (tapes) to be used as one set on any of the streams it was suggested to introduce a new **SMFILE** datacard ([?]). We suggest to use this datacard in a more general way as described below 1 :*FILE stream mode [\(i_{1},..i_{n}\)] request where:
* _stream_ is 'P', 'B' or 'O' ( see also other features below )
* _mode_ is 'FATM', 'LIST' or 'LOOP'
* \(i_{1},..i_{n}\) is a list of integer numbers ( may be empty)
* _request_ is a text string up to 255 characters

According to the _mode_ parameter there are three mode defined:

**FATM - a FATMEN request**

This is the easiest mode as suggested in [?] - it does not use anything else but instead transmit the request string with possible wild-card characters to the FATMEN FMLFIL routine and sequentially use all found tapes as an input or output.

Example:
*FILE'P''FATM'//CERN/ATLAS/DICE/JETS/FILTER/TRIAL/T0*' will select two tapes presently existing in the ATLAS catalog matching this request: T001 (I28447) and T002 (I28323). A description ofa FATMEN request as well as the catalog management is described elsewhere [?] and is outside the scope of this note.

**LIST - use a list of tapes provided by the user**

This mode should be in particular interesting for users who is not familiar with the FATMEN system or do not have it installed on their computer. The list of optional integer numbers \(i_{1},...i_{n}\) is used to substitute the '*' wild-card characters in the tape request. which is then used in a normal FORTRAN OPEN statement. The character string with the request should be given in a form understandable by your local system. Tapes should be staged by the user

\begin{table}
\begin{tabular}{|c||c|c|c|} \hline stream & data & default file & description \\ \hline ’P’ & Physics & ZEBRA.P & main event input \\ ’B’ & Background & ZEBRA.B & pile-up event input \\ ’O’ & Physics+BG & ZEBRA.O & event output \\ \hline \end{tabular}
\end{table}
Table 1: _SLUG I/O data streams definition_before the program is executed. The number of tapes should not exceed 20 in the present version.

Example:

*FILE'P' 'LIST' 447,443,323'/shift/shd06/data1/zp/nessi/i28***.out' will select 3 tapes (128447, 128443, 128323) as one multi-volume input file for the data stream 'P'. Note, that this command is case sensitive if executed in a Unix environment.

LOOP - use a list of tapes produced in a loop

A FORTRAN-like DO loop ( DO I=\(i_{1},i_{2},i_{3}\)) is used to provide sequentially an integer number to be substituted instead of '*' characters in the request string. The request again does not use FATMEN but a normal FORTRAN OPEN statement to access the data. The request should be understandable by the local system and tapes should be staged before the program is executed. IF \(i_{3}\) is omitted, step 1 is assumed.

Example:

*FILE'P' 'LOOP' 21,25'/shift/shd06/data1/zp/nessi/b000**.out' will select 5 tapes (B00021,...B00025) as one multi-volume input file for the data stream 'P'.

## Acknowledgments

I would like to thank Andrea Dell'Acqua for his patient help with an infinite amount of attempts to overcome FATMEN problems on CSF and Gilbert Poular for friendly discussions and many usefull advices.

## References

* File and Tape Management System. CERN program Library entry Q123.
* [2]S.O'Neale, Minutes of the weekly Software meeting on 13.04.94