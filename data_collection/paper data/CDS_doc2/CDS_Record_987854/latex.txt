# Modelling of Noise and Straw to Straw Variations in the ATLAS Transition Radiation Tracker

Thomas H. Kittelmann

The Niels Bohr Institute, University of Copenhagen. Email Kittel@nbi.dk.

October 6, 2006

###### Abstract

In this note a procedure is presented for modelling noise and channel-to-channel variations in the ATLAS Transition Radiation Tracker which can ultimately be based on reliable off-beam occupancy maps. The model is tuned and validated against the results of a test beam study [10], and its implementation in offline digitisation software is discussed.

## 1 Introduction

Even though the noise levels and channel-to-channel variations in the ATLAS Transition Radiation Tracker1 (TRT) are known to be relatively small (\(\mathcal{O}\left(1\%\right)\) and \(\mathcal{O}\left(10\%\right)\) respectively), they are not entirely negligible and as such ought to be present in simulated data. Furthermore, the effects can be enhanced locally due to groupings of abnormal channels, resulting in non-negligible effects in the reconstruction.

Footnote 1: See e.g. [1] and [1].

A model based on a small number of physics inspired assumptions is presented, which is able to reproduce the performance of the detector down to a channel-level granularity through variations in thresholds and background noise. In particular, it reproduces the off-beam occupancy maps after the trivial handling of channels that are not active or masked. An important point is that the noise fluctuations are assumed to be independent of whether a given straw is passed by physics particles or not. This is done both for consistency and because it is the most straight-forward way to ensure that the modelling of the noise in the hit straws is actually constrained by input from conditions data. In principle the model presented could be easily applied in any multi-channel detector with threshold discrimination.

After a brief summary of the effects of the TRT front-end electronics in the next section, the model is presented in section 2. In section 3 it is tuned and validated against the results of a test beam study (cf. [10]), and finally the implementation and performance are discussed in section 4.

### Signal Treatment in Front-End Electronics

The ionisation taking place in the active gas of a TRT straw when crossed by a particle depends both on its trajectory, momentum and identity, and the resulting pulses in the wiresthus in principle contains information regarding those quantities. For practical reasons the resulting analog signal in the wire is digitised in the front-end electronics before it, given a first-level trigger, is read out by the higher level triggers and possibly stored offline. A concise yet thorough description of the front-end electronics is given in [1, chap. 12.8], but the relevant features will be briefly sketched here.

The digitisation is performed by discrimination against two thresholds: A low threshold (LT) for tracking - approximately corresponding to the signal height produced by a single primary cluster with a minimum deposit of 300 eV - and a high threshold (HT) used for detecting the absorption of energetic photons emitted by electrons through transition radiation. The high threshold is usually set to about 5-7 keV.

After being collected on the wire the signal is propagated to the ASDBLR chip where it is amplified, shaped and discriminated. The actual threshold settings can vary from channel-to-channel, but can only be tuned for each ASDBLR chip which is each connected to a total of 8 straws. The shaping functions for low and high thresholds are shown in figure 1.1. The Boolean discrimination results are read out in segments corresponding to 75 ns, using 24 bits for the low threshold and 3 for the high threshold.

## 2 The Model

There are several possible sources of the observed noise and non-uniformities found in the TRT, but the goal of the model presented here is not necessarily to provide a detailed understanding of these effects but rather to reproduce their combined effect in the detector. The model will thus be based on a set of simple assumptions about the workings of the detector.

One possible source of noise is the channel-to-channel cross-talk induced by very large signals from passing tracks, primarily due to the collection of TR photons associated with electrons. It has been found [10] to be quite low, 3 and 0.6 extra hits for each electron and pion track, respectively, when running at a reduced low threshold of 250 eV where the effects should be enhanced. The model constructed here will thus not attempt to include such

Figure 1.1: Signal shaping functions used to model the shaping in the ASDBLR for signal passed onto both the low and high threshold discriminator as well as for noise in the low threshold discriminator.

effects. It is not inconceivable, however, that one might wish to revisit this issue at a later date.

Regarding noise effects that are not track-induced, one can think of two sources: The first is so-called "white noise", thought to consist of a high number of uncorrelated and small fluctuations, which is the recipe for Gaussian behaviour. This will form the basis of the present model and is discussed in detail in section 2.1. Naturally one can also imagine noise caused by a low number of large fluctuations. One such source could be the "spontaneous" appearance of energetic noise clusters in the straw volumes, e.g. from radioactive decays of unstable nuclei in the active gas. Apart from the magnitude and frequency of signals due to such a source, the main feature distinguishing it from white noise is that the signals induced will always be positive, since one can not have real ionisation clusters giving negative potential fluctuations at the wire. Code for dealing with such spontaneous noise clusters has been written, but have not been employed so far since the test beam data do not seem to warrant it. It is of course possible that the environment in the full ATLAS setup will turn out to be different, so the capability has been kept.

In addition, one final related effect is being added at the same time: Allowing the actual low threshold value used for signal discrimination in a given channel to vary from event-to-event. This will be controlled by one overall parameter, \(r\), denoting the relative level of the fluctuations. As will be discussed in section 3, a value of \(r=11\%\) gives the best agreement with test beam data. Specifically this means that a channel with an average low threshold of \(y_{i}\), in a given event will have an effective low threshold of \(y_{i}^{\text{eff}}=g_{i,\text{evt}}\cdot y_{i}\) where \(g_{i,\text{evt}}\) is a random number picked independently for each channel and event from a Gaussian with unit mean and spread \(\sigma=r\).

Finally, it is crucial that the model is able to reproduce channel-to-channel variations as seen in the detector and quickly adapt to drifts of the electronics parameters. This ability is discussed in section 2.2.

### Basic Modelling of White Noise

In the TRT, white noise is thought to be mainly thermal in nature, originating in dissipative elements such as the amplifiers in the ASDBLR chips. These fluctuations directly results in free charges, again giving rise to potential fluctuations through capacitive coupling. This means that, on average, the amplitude of the noise in a given channel is expected to depend on the length of the attached wire:

\[\left\langle\mathcal{A}\right\rangle_{l}\propto c_{1}l+c_{2} \tag{2.1}\]

where \(l\) is the wire length, and \(c_{1}\) and \(c_{2}\) are constants thought to depend on the wire and chip capacitances respectively. Experience indicate that a barrel straw with \(l=70\text{ cm}\) has noise of about \(3000\text{ ENC}\) (equivalent noise charges), while a chip with no attached wire has \(1200\text{-}1500\text{ ENC}\) ([VB05] and [B+96]). Apart from an overall constant of proportionality this implies \(c_{1}=(3000-1350)/70\text{ cm}\) and \(c_{2}=1350\).

In addition to the amplitude of the noise it is necessary to be able to provide simulated samples of the time-structure of white noise. The basic mechanism for doing this will be based upon a scheme due to A. Romaniouk.2 As used here, the scheme is to generate a number of primary potential fluctuations with a magnitude given by a zero-centred Gaussian distribution of some width (amplitude). The determination of the amplitude for a given channel will be discussed in section 2.2. These primary fluctuations should then be distributed in time according to some chosen scheme. The next step is to perform a signal shaping on the primary fluctuations, mimicking the amplification and shaping taking place even for noise fluctuations in the ASDBLR. The shaping function used for noise is also shown in figure 1. It is not exactly identical to the shaping used for signal, which is simply because of a slight (otherwise neglected) dependence on the magnitude of the signal that is shaped.

In figures 2.1.a-d are shown examples of the resulting noise distribution given by four different schemes: The average distance between pulses is either \(1\) ns or \(25\) ns and they are distributed with either fixed or random distances. It is clear that for average distances much less than the width of the shaping function of \(\mathcal{O}\left(10\text{ ns}\right)\), the fine structure is washed out by the signal shaping and there is no difference between a fixed and random distribution scheme. Furthermore, the only difference between two low values for the average distance will be an overall scale factor, which is anyway left undetermined at this point.

Figure 2.1: Examples of noise signals given various schemes for distribution of unit-amplitude Gaussian noise pulses, before (grey) and after (black) shaping. One every \(1\) ns with random (a) and regular (b) distribution, and one every \(25\) ns with random (c) and regular (d) distribution.

### Channel-to-Channel Variations

Apart from geometrical issues of placement and length, the TRT simulation and digitisation algorithms have traditionally been treating all straws as copies of the same "ideal" straw. In the real detector, however, each straw has unique performance and settings. Some straws are outright "dead" for various reasons. Some had their wire removed due to problems found in high voltage tests and some were sealed off due to e.g. gas leaks found in gain tests. Others are effectively dead because the front-end electronics is faulty, with e.g. a blown fuse, and some are simply masked out due to intolerable behaviour like an excessive level of noise. The active straws differ from each other in several ways. Examples are: Threshold values, the magnitude of the noise fluctuations, the amplification and signal shaping in the front-end electronics, some straws might be bent, the gas densities might differ slightly, different straws are connected to different power supplies, etc. Trying to implement all of these effects in the digitisation code would be impractical and one clearly has to make some simplifying assumptions in order to keep the number of free parameters low and the requirements on resources and conditions data reasonable. The model presented here will, in addition to a few overall free parameters, simply assume that an off-beam straw occupancy map, i.e. a map of the individual channel noise levels, is available along with a list of channels that are dead or masked. It is also important to note that the model is constructed so as to be robust enough that it can be trusted to work well over a large range of input parameters without requiring constant by-hand re-validation by experts.

As a side remark one should notice that there are straw, module and wheel misalignments which break the geometrical symmetries of the ideal setup. The simulation of those is, however, the regime of the detector description and will not be discussed further here. For how this is handled in the ATLAS GeoModel framework see e.g. [1], [2] and [3].

The goal of the model presented here is to assign each of the \(N\) active straws a unique low threshold value, \(\mbox{LT}_{i}\), and white noise amplitude, \(\mathcal{A}_{i}\), so as to reproduce the actual measured noise level map for a given period of running. It is clear that, with white noise as the sole source of noise, there must be a one-to-one relationship between the noise level of the \(i\)'th straw and the ratio \(f_{i}=\mbox{LT}_{i}/\mathcal{A}_{i}\). The discussion of how to derive this relationship is postponed until section 2.2.1. For now it will just be assumed that \(f_{i}\) is provided by conditions data along with the overall average value of the low threshold, \(\langle\mbox{LT}\rangle=\frac{1}{N}\sum_{i=1}^{N}\mbox{LT}_{i}\), which is needed to set the scale.

This leaves \(N-1\) degrees of freedom in the model which are taken to be the \(N\) values of the noise amplitudes, \(\mathcal{A}_{i}\), apart from a common scale factor, \(a\). With \(\mathcal{A}_{i}=a\cdot r_{i}\) the distribution of \(r_{i}\) is thus an input to the model. As described in section 2.1 the average noise amplitude of a channel depends on the length of the attached wire. Consequently, the \(r_{i}\)'s will be modelled as being distributed according to Gaussians with means, \(\mu_{i}\), given by formula 2.1 and a width given by \(\sigma_{i}=w\mu_{i}\), where \(w\) is a free overall parameter which thus controls the relative channel-to-channel spread in noise amplitudes.

Inserting \(\mbox{LT}_{i}=f_{i}\cdot\mathcal{A}_{i}=f_{i}\cdot a\cdot r_{i}\) in \(\langle\mbox{LT}\rangle=\frac{1}{N}\sum_{i=1}^{N}\mbox{LT}_{i}\) yields \(a=\langle\mbox{LT}\rangle/\langle f_{i}\cdot r_{i}\rangle\), and thus

\[\mbox{LT}_{i}=f_{i}\cdot r_{i}\cdot\frac{\langle\mbox{LT}\rangle}{\langle f _{i}\cdot r_{i}\rangle}\quad\mbox{and}\quad\mathcal{A}_{i}=r_{i}\cdot\frac{ \langle\mbox{LT}\rangle}{\langle f_{i}\cdot r_{i}\rangle} \tag{2.2}\]

Test beam experience indicates that \(\langle\mbox{LT}\rangle=250-300\mbox{ eV}\) is a reasonable setting, but detector condition maps containing the individual channel noise levels will obviously not beavailable until actual ATLAS data taking starts. Until then the simulations will of necessity have to be based on a random map of noise levels.

Based on the test beam findings in [10], a simple distribution of straw noise levels, \(x\), according to \(\exp[-x/0.019]\) was chosen. In particular this means that there will be no channel-to-channel correlations in noise level at neither the chip nor the module level. One could have envisioned a more ambitious distribution model including these correlations, but at the time of this writing the channel-to-chip mappings were not available at run-time in the ATHENA framework. Finally, the relative channel-to-channel spread in noise amplitudes, \(w\) is chosen to be \(w=15\%\). That this is reasonable can be seen by roughly comparing e.g. the root-mean-square of the resulting final distribution of low thresholds, shown in figure 2.2, with that expected from tests.

#### Determining Ratio between LT and Noise Amplitude from Noise Level

As described in the previous section, the model hinges on having the mapping between the noise level (i.e. off-beam occupancy) and the corresponding ratio between low threshold and noise fluctuation amplitude, depicted in figure 2.3.a, readily available at initialisation time. Furthermore, it is greatly preferable to have said mapping constructed on the fly during each digitisation job.

Denoting the ratio between low threshold and noise fluctuation amplitude by \(f\) and the noise levels by \(x\), the straight-forward procedure for finding \(f(x)\) would be to select a number of values of \(f\), and generate a large number (e.g. \(10^{5}\)) of digits for each value. The fraction of those with a signal above the low threshold gives the corresponding noise level. The function \(f(x)\) can subsequently be evaluated by interpolation between the obtained set of points, \(\{(f,x)\}\). While this _sampling_ method of determining \(f(x)\) can be robust if sampling occurs at a sufficiently large number of \(f\)-values, it is also prohibitively inefficient in terms of computational time. This is because each 75 ns segment of shaped noise fluctuations is simply discriminated against a single low threshold, throwing away a lot of information in the process. It would be more

Figure 2.2: Distribution of low thresholds given a simple distribution of straw noise levels, \(x\), according to \(\exp[-x/0.019]\) and a relative channel-to-channel spread in noise amplitudes of 15%.

efficient to reuse the _same_ set of 75 ns segments of noise fluctuations for comparing against all of the \(f\) sampling values. This philosophy, taken to its limit, results in the following improved scheme, the _sorted-array_ method: Generate a large number, \(N\), of 75 ns segments of noise fluctuations with unit amplitude, and store the maximum level reached by the fluctuations within each segment into an array. Next sort the array in descending order. The \(i\)'t entry in said array now contains the value of \(f\) that should be associated with the noise level \(x=i/(N-1)\) (given zero-based array indices).

To test the timing and accuracy of the methods, a small standalone toy Monte Carlo study were performed with some hypothetical true \(f(x)\).3 The three lower curves in figure 2.3.b show a comparison between this "true" \(f(x)\) and the same \(f(x)\) reconstructed using the two aforementioned methods. The sorted-array method is seen to perform extremely well, and is orders of magnitudes faster than the perhaps more straight-forward sampling method.

Footnote 3: The “true” \(f(x)\) used as input to the toy Monte Carlo is based on a failed attempt at calculating the curves analytically, and is thought to approximate the true curve particularly well at small values of \(x\).

Unfortunately this is not the end of the story. The procedures discussed so far in this section fail to take into account the possibility of event-to-event low threshold fluctuations in each straw. As noted in section 2 the low threshold in a given straw will fluctuate according to a Gaussian from event-to-event with a relative factor of \(r=11\%\). Adding this effect to the sampling procedure is straight-forward, since the fluctuation can simply be included in the signal to threshold comparisons performed. On the other hand, obtaining the proper \(f(x)\) from the sorted-array method is a little more tricky. If \(f_{r=0}(x)\) is the mapping in the case of no LT fluctuations and \(f_{r}(x)\) is the corresponding mapping one gets when the LT undergoes event-to-event fluctuations of relative size \(r\), the following relation can be used to obtain \(f_{r}(x)\) from \(f_{r=0}(x)\):

Figure 2.3: Ratio of low threshold to noise fluctuation amplitude as a function of noise level (a). In (b) is shown the results of a toy Monte Carlo study testing various schemes for reproducing said relationship, as described in the text.

\[f_{r}^{-1}(y)=\int_{-\infty}^{\infty}f_{r=0}^{-1}(y^{\prime})\,G(y-y^{\prime}; \sigma=ry)dy^{\prime} \tag{2.3}\]

Where \(G\) is a Gaussian distribution. Thus the additional numerical work involved for the sorted array method involves inverting a look-up table twice which is negligible and a number of numerical integrations which takes a total of \(\mathcal{O}\left(0.1\text{ s}\right)\) after moderate tuning.

## 3 Tuning and Validation

Having thus constructed the model in the previous sections, the few free overall parameters need to be tuned to best reproduce data, in addition to reproducing the off-beam occupancy map discussed in section 2.2. The test beam distributions shown in this section are all the result of the study presented in reference [10] which is based on data from the summer 2004 standalone TRT test beam.

First of all one needs to decide upon a specific scheme for distribution of the pre-shaping potential fluctuations as discussed in section 2.1. Looking at how often each of the 24 LT bits are set in the pure noise hits found in data in figure 3.1, one sees a definite 25 ns structure on top of a flat distribution. This is not surprising since the front-end electronics are driven by an external 40 MHz clock frequency. Consequently, the final composition is taken to be 1 ns and 25 ns fixed distance components, weighted by 0.4 and 0.6 respectively.4 The final Monte Carlo result in figure 3.1 is quite satisfactory.

Footnote 4: Note that this gives a result whose dominating contribution comes from the 1 ns component, since more of those are generated during a given time interval. The difference in amplitude between the two components can be inferred by comparing the scales of figures 2.1.b and 2.1.d, and can be estimated to be about 2.75.

Another variable that is useful for comparison is the number of LT bits set in noise digits, also known as the time over threshold. The distribution of this variable is shown in figure 3.2.

Figure 3.1: Probability of each of the 24 low threshold bits of being set in noise digits for both data and tuned Monte Carlo simulation. To ease comparison the Monte Carlo simulation has been scaled to the data by a factor of 0.91 (a difference caused by the different means in figure 3.2). Also note that the initial dip is merely an artifact of a leading edge cut.

The first thing to note is that the average time over threshold for noise appears to be around 2 bins \(\times\,3.125\) ns/bin\(\approx 6\) ns, which is comparable to the width of the noise shaping function from figure 1.1 - exactly what would be expected from Gaussian fluctuations exceeding threshold. The figure was used to tune two of the existing digitisation parameters. These are the length of the enforced minimum period the threshold will register as being exceeded even when the actual period where the signal is above threshold is very short, and the additional time the discriminator will stay on after the signal drops below threshold (the settling time). The two parameters went from 6 ns and 1.6 ns, respectively, to 0.8 ns for both. The distributions for both the original and final values are shown in the figure. Although the final distribution does differ somewhat from data, the average number of set LT bits is correct to within 10%. The difference is thought to be due to minor differences in the way discrimination is actually performed in the ASDBLR chips and the way it is implemented in code, primarily tuned for the longer track-induced signals.

Finally, it is necessary to tune the overall event-to-event level of low threshold fluctuations. It turns out that the fraction of noise digits containing two "islands" of set LT digits is a parameter which is _very_ sensitive to this level, and good agreement is found by fixing \(r=11\%\) as can be seen in figure 3.3. The figure also shows a remarkable agreement in the fraction of digits having 3 islands. This can be taken as confirmation that the basic understanding and modelling of the noise is sound.

### Effects on Track Residuals

Apart from the addition of noise hits in unhit straws, another important effect is the influence of noise and straw-to-straw variations on the leading edge of the signal due to a genuine particle passing a straw. The effect due to noise (but not varying LT) is illustrated in figure 3.4.a-d, where the post-shaping signals found right before threshold discrimination in four straws passed by a single 20 GeV pion, are shown with and without noise fluctuations. Figures 3.4.a and 3.4.b show how the leading edge can be moved slightly forward and backwards - the latter only possible since the model allows a negative noise contribution. Figures 3.4.c and

Figure 3.2: Distribution of the number of LT bits set in noise digits for both test beam data and Monte Carlo data with two different settings of discrimination parameters.

3.4.d show a few cases where a more drastic shift could be observed, depending on the specific low threshold in the straws.

To quantify the effect on the leading edge, and thus on the tracking resolution for each straw, a simplified setup was made where high numbers of fake straw crossings were fed to the digitisation. The procedure is discussed in more detail in [13]. After constructing appropriate \(r\)-\(t\) relationships, returning the most probable (as opposed to the mean) \(r\)-value given each \(t\)-bin, the residual distribution of the track-wire distance can be found and is shown in figure 3.5.a. The only clearly visible effect of the addition of noise is the appearance of a low plateau to the left of the peak. This is easily understood to represent the cases where a large noise pulse exceeds the threshold before any signal from the track could possibly have reached the wire. Clearly this effect is sensitive to the time offset of the front-end electronics, as an offset pushing all signals to higher times will leave more room for noise fluctuations to disturb the leading edge. The version of the digitisation code used to produce the results here is thought to have a too low value of said offset, so the noise effect is underestimated somewhat.

The one-sided tail in 3.5.a means that there is a bias towards overestimating the track-wire distance. In a real track fit this bias will not always pull in the same direction, but will have opposite sign depending on whether the track passed to the right or the left of the wire. To get a realistic residual distribution as experienced by a track, one should add the distribution shown in 3.5.a (corresponding to "right" passings) to itself after a sign change (corresponding to "left" passings). The resulting distribution is shown in figure 3.5.b. Due to the non-Gaussian shape of said distribution, it is ambiguous how the resolution should be defined, but here it will be taken as the width of a Gaussian fitted to the central region. Three different central intervals will be used, \(\pm 150\)\(\mu\)m, \(\pm 200\)\(\mu\)m and \(\pm 250\)\(\mu\)m. Figure 3.5.b includes the result of a Gaussian fit to the region given by \(\pm 200\)\(\mu\)m, and the results from similar fits to the other regions, and for residuals with and without effects from noise and straw-to-straw variations, are shown in table 3.1. The effect due to noise and straw to straw variations can thus be found by taken the quadratic difference between the two numbers, and the table shows this

Figure 3.3: Number of LT bit “islands” in pure noise digits for both test beam and Monte Carlo data. Islands are here intuitively defined as sets of LT bits with the LT exceeded separated by either bits where the threshold is not exceeded or the ends of the digit.

Figure 3.4: Pre-discrimination signals due to a passing 20 GeV pion in four different straws. Solid curves show the original signals after shaping while dashed curves are after the addition of noise.

Figure 3.5: Residual distributions of reconstructed track-wire distances with and without noise effects (a). A residual appropriate for actual tracks, passing both right and left of wires, are shown in (b) along with the result of a Gaussian fit to the range \(\pm\)200 \(\mu\)m.

to be around \(25-30\)\(\mu\)m. It should of course be stressed that this effect is only the _average_ expected effect. Correlations in the distribution of noisy straws could lead to much higher effects for tracks in certain regions of \(\phi\) and \(\eta\) space. Furthermore, the effect of pure noise hits on track pattern recognition is not considered.

Finally, there is naturally also an effect on the low threshold efficiency when the low threshold is allowed to vary from straw-to-straw as well as from event-to-event. This has not been studied in detail, but initial investigations does not show major problems.

## 4 Implementation

The model as described so far has been implemented in ATLAS offline software in the publicly available TRT Digitisation C++ package, and has been used by default for productions since November 2005. For the actual details of the implementation, the reader is referred to the source code itself, while only the main concepts pertaining to the present model will be described here.

The first thing done at initialisation is to construct a list of all available channels in the detector, and associate them with individual noise levels, thresholds and noise amplitudes. The list is constructed through information made available via the GeoModel framework, and conditions data are then either looked up or simulated as mentioned in section 2.2, i.e. either marking a channel as dead or assigning it both a noise level and a value of the relative noise amplitude, \(r_{i}\) as described in section 2.2. The latter two are then transformed into thresholds and absolute noise amplitudes as also described in that section.

In order to avoid unreasonable execution times several optimisations take place using caching techniques. First of all, instead of generating the computationally expensive post-shaping fluctuations of the potential discussed in section 2.1 on demand, two very long (\(\mathcal{O}\left(1000\cdot 75\text{ ns}\right)\)) time intervals of shaped fluctuations are generated - one for the 1 ns and 25 ns separated noise respectively. Whenever a noise signal is needed a random 75 ns segment is taken from each of the cached sequences, added with appropriate weights and multiplied by the actual amplitude of the straw in question. During the initialisation phase the sequences are regenerated several times in order to avoid degenerated statistics, whereas the same sequences are used repeatedly for adding noise to all straws with passing particles ("hit" straws).

Regarding noise in "unhit" straws, it is first determined which of those will actually produce a noise digit by comparing their noise level against a random number. The actual noise digit produced is not generated on the fly but is instead, for performance reasons, taken from a large (\(\mathcal{O}\left(5000\right)\)) pool of noise digits generated at initialisation time. This approach of course

\begin{table}
\begin{tabular}{l l l l} \hline \hline  & \multicolumn{2}{c}{Gaussian width} & \\ \cline{2-3} Fit Range & Basic model & With noise effects & Quadratic Difference \\ \hline \(\pm 150\)\(\mu\)m & \(108.7\pm 0.2\)\(\mu\)m & \(112.6\pm 0.4\)\(\mu\)m & \(29.3\pm 2.3\)\(\mu\)m \\ \(\pm 200\)\(\mu\)m & \(111.8\pm 0.1\)\(\mu\)m & \(115.5\pm 0.3\)\(\mu\)m & \(29.0\pm 1.6\)\(\mu\)m \\ \(\pm 250\)\(\mu\)m & \(115.0\pm 0.0\)\(\mu\)m & \(117.9\pm 0.2\)\(\mu\)m & \(26.0\pm 0.9\)\(\mu\)m \\ \hline \hline \end{tabular}
\end{table}
Table 3.1: Results of Gaussian fits to residuals such as the one shown in figure 3.5.b, with and without noise and straw-to-straw variation effects. Last column shows the derived quadratic difference attributed to said effects.

assumes that noise digits produced in straws with different values of \(\text{LT}_{i}/\mathcal{A}_{i}\) are "sufficiently" similar.

As an illustration of the implementation the same event with a Higgs boson, simulated at low luminosity, is shown without and with the new noise and straw-to-straw variation effects in figures 4.1 and 4.2, respectively.

### Performance

It is important that the addition of noise and straw-to-straw variations does not impose unreasonable demands upon especially event processing time and output file size. Table 4.1 shows the additional resource requirements for three different scenarios: A pathological single track event, a physics event at low luminosity (3.3 average \(pp\) interactions) and a physics event at high luminosity (25 average \(pp\) interactions). The only case where the performance is significantly compromised is the single-track case, which is easily understood since the number of pure noise hits in the TRT will, in such a scenario, be much larger than the number of track induced hits. For dedicated single track studies, in particular Inner Detector only studies, one might consider turning off the generation of pure noise digits. As could be expected, this

Figure 4.1: Inner Detector hits in simulated \(H\to\gamma\gamma\) event at low luminosity with a uniform TRT detector without noise.

Figure 4.2: Inner Detector hits in simulated \(H\rightarrow\gamma\gamma\) event at low luminosity with a non-uniform noisy TRT detector.

eliminates the performance overhead entirely as is seen in the last column. It is essential to note that table 4.1 shows the added event time for just the digitisation job. A simulation job is typically at least an order of magnitude slower for the same number of events, so the increase in the total required event processing time in large-scale productions will be negligible.

In addition to the extra resources required per event, the noise also adds about 10 s to the job initialisation time, and the job memory consumption is increased by about 10 MB (which is inevitable when assigning unique properties to 350.000 channels).

## 5 Conclusions

A model which allows inclusion of noise effects and straw-to-straw variations as given by reliable conditions data in the TRT has been presented. It could in principle be used for modelling any multi-channel detector with threshold discrimination. It has been tuned and validated against test beam data and implemented in the ATLAS offline framework where its requirements on computing resources are very reasonable.

## Acknowledgements

The author is grateful to the many persons contributing to the development of the model described in this note through their helpful advice and interesting discussions. This includes in particular R. Van Berg, M. Dam, D. Froidevaux, P. Hansen, E. Klinkby, F. Luehring and A. Romaniouk.

## References

* [ATL97a] ATLAS Collaboration, ATLAS Inner Detector: Technical Design Report. Vol. 1, (Apr 1997), CERN-LHCC-97-16.
* [ATL97b] ATLAS Collaboration, ATLAS Inner Detector: Technical Design Report. Vol. 2, (Apr 1997), CERN-LHCC-97-17.
* [B+96] B. Bevensee, F. M. Newcomer, R. Van Berg and H. H. Williams, An amplifier shaper discriminator with baseline restoration for the ATLAS transition radiation tracker, IEEE Trans. Nucl. Sci. **43**, 1725-1731 (1996).
* [Bou03] J. Boudreau, Geometry Kernel Classes, [http://atlas.web.cern.ch/Atlas/GROUPS/DATABASE/detector_description/](http://atlas.web.cern.ch/Atlas/GROUPS/DATABASE/detector_description/), 2003.

\begin{table}
\begin{tabular}{l c c c c} \hline \hline  & \multicolumn{2}{c}{Physics Events} & \multicolumn{2}{c}{Single Tracks} \\ \cline{2-5}  & Low lum. & High lum. & Full noise & Hit straws only \\ Added time/event & 1 s (6\%) & 2 s (3.6\%) & 1 s (14\%) & 0 s (0\%) \\ Added file size/event & 73 KB (2\%) & 40 KB (0.6\%) & 89 KB (5\%) & 0 KB (0\%) \\ \hline \hline \end{tabular}
\end{table}
Table 4.1: Additional resources required for the noise and straw-to-straw variation for a digitisation job. Note that when the full chain of GEANT 4 simulation and digitisation is run the relative processing requirements goes down with an order of magnitude.

* [BT04] J. Boudreau and V. Tsulaia, THE GEOMODEL TOOLKIT FOR DETECTOR DESCRIPTION, in _Proceedings of the Conference on Computing in High Energy and Nuclear Physics (CHEP 2004), Interlaken, Switzerland_, Sep 2004.
* [Kit05] T. H. Kittelmann, Simulation and Digitization Validation, TRT, Talk given at ATLAS Inner Detector Performance Week, CERN, October 24-28, 2005.
* [KK06] T. H. Kittelmann and E. B. Klinkby, A Study of TRT Noise in 2004 Test Beam Data, ATL-COM-INDET-2006-015, October 2006.
* [SAB\({}^{+}\)04] S. Spagnolo, K. Assamagan, J. Boudreau, S. Baranov, V. Tsulaia, A. Nairz, I. Trigger, C. Bourdaios, G. Unal, M. Lelchuk, B. Seligman, J. Toth, P. Strizenec, D. Costanzo, G. Gorfine, T. Kittelmann, Y. Hasegawa, D. Pomarede, A. Vania-chine and A. Zalite, The Description of the Atlas Detector, in _Proceedings of the Conference on Computing in High Energy and Nuclear Physics (CHEP 2004), Interlaken, Switzerland_, Sep 2004.
* [TRT04] T. Akesson et al. (ATLAS TRT Collaboration), ATLAS Transition Radiation Tracker test-beam results, Nucl. Instrum. Meth. **A522**, 50-55 (2004).
* [VB05] R. Van Berg, Private communications., nov 2005.