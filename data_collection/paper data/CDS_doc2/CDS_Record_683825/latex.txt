###### Abstract

The effect of the solenoidal magnetic field for the existing Level 2 Trigger TRT tracking algorithms has been studied in comparison with the ideal solenoid homogeneous field. The contribution of drift-time measurements to the quality of the reconstruction in the TRT is investigated.

**ATLAS Internal Note**

**23 March 1999**

**TRT Trigger Performance in the Solenoidal Magnetic Field**

**Sergey Sivoklokov1**

Footnote 1: e-mail: Serguei.Sivoklokov@cern.ch

Institute of Nuclear Physics, Moscow State University, Moscow, Russia.

## 1 Introduction

Simple algorithms based on histograming methods have been demonstrated to be suitable candidates for use in level 2 trigger feature extraction (FEX) procedures [1],[2]. The (almost) linear dependence of the azimuthal angle of the charged particle trajectory on radius (barrel geometry) or on the longitudinal coordinate \(z\) (end-cap geometry ) is used in the existing FEX algorithms for the precision tracker and the TRT detector. The performance of these algorithms could however be substantially degraded by effects which distort the particle trajectory from a straight line in these coordinates. The trajectory of a primary particle would be linear in the \((\phi-z)\) projection in a constant field inside a long solenoid. However the ATLAS solenoid is shorter (its half-length is 265 cm [3]) than the inner detector (the outermost wheel of the TRT is positioned at \(z=336\) cm [1]). Hence the real field departs significantly from an ideal solenoidal field at the end of the ID volume.

In this note, the magnitude of the impact of the solenoidal field with respect to a constant one for the existing FEX algorithms is presented and possible correction procedures are discussed.

A study of the \(p_{T}\)-resolution of the Inner Detector in a solenoidal magnetic field has previously been reported in [4] for an old ID layout using a semi-analytical approach. For a more recent layout, a study of the effect of the solenoidal field on the resolution of various track parameters has been presented in note [5].

The results presented in this note have been obtained using the full GEANT simulation for the TDR layout of the Inner Detector [1] (Fig. 1).

## 2 Magnetic Field

The ATLSIM package [6] was used to generate event samples. The magnetic field used for the simulation may be changed from a constant field with \(B_{z}=2T,B_{R}=0\) to the real field, as described by a tabulated 3D map, by using the following data-card:

DETP MFLD mflg(1).version=2 RmaxInn=4 ZmaxInn=10 eps0=1

where RmaxInn and ZmaxInn are the maximum values of \(R\) and \(z\) (in cm) in the region of constant field, and \(eps0\) is the width of the transition region from the constant field to the field described by the map. Fig. 2 shows the \(B_{z}\) and \(B_{R}\) components of the field inside the ID volume. The z-component falls from its nominal value of \(\approx\)2 T at the centre of the detector to less than 0.5 T at the end of the Inner Detector. In addition, the radial field component increases with R and z, reaching 0.8 T at the outside edge of the TRT and at the highest z.

This map is compatible with earlier calculations [7], [8] and with the Magnet Project TDR [3].

Precise field calculations [9] show a small increase of the field value in the central region above 2 T due to the presence of metallic elements. This is why the a central value of \(B_{z}=2.085\) T has been used in the simulation and reconstruction of the constant field data samples.

## 3 Trajectories in an Inhomogeneous Field

The bending power of a magnetic field is proportional to the field integral along the particle trajectory [8]. Using the field map, one can calculate this integral numerically or by tracking the particle using GEANT.

To track the trajectory of a charged particle in the inhomogeneous field of the Inner Detector, muons of various momenta have been used. As an example, one can see the trajectories of muons in the \((R,\phi)\) plane Fig. 3. The muons have been tracked through the ID volume i.e. \(R<140\ cm,\mid Z\mid<350\ cm\). The difference in curvature for the case of

Figure 1: View of one quarter of the ATLAS Inner Detector in the \((R,z)\) plane.

constant and solenoidal field is clearly visible and in some regions the curvature may even change the sign.

Fig. 4 shows \(\phi-Z\) projections of 5 GeV \(p_{T}\) muon trajectories in the ID end-cap region. The SCT region is at \(R<56~{}cm,\mid Z\mid<278~{}cm\). The most significant deviation of trajectories from a straight line (i.e. constant field case) is at \(\eta\sim 1.8\). For \(\eta>2.2\), the part of the trajectory crossing the low-radius part of the outer four TRT wheels (see Fig. 1) is an almost straight line, but its slope is different from that in the case of the nominal constant field. This feature will be used in the following analysis.

Figures 5 to 7 show the \(\Delta\phi\) and \(\Delta L\) displacements (see definitions in Fig. 3) of track hits with respect to their "nominal" position in a constant field, for a set of pseudorapidities from 1.4 to 2.4 and for a \(p_{T}\) of 5 GeV. All abscissa values scale proportionally to \(1/p_{T}\). At 5 GeV, the maximum shift of position is about \(1.5~{}cm\) at \(\eta=1.8\) and \(z=340~{}cm\). At 30 GeV, it will be about \(2.5~{}mm\), i.e. less than a straw diameter, but the relative slope (curvature) change will be the same as for lower momenta. The degradation of performance, as will be demonstrated, is larger for higher momenta for obvious reasons: the measurements of the track position in the region of inhomogeneous field are less precise, since the real field bending power is lower than for the constant field case.

The deviation from the straight line trajectory in the \(\phi-z\) plane is proportional to the ratio of the respective field integrals. The dependence of the z-component of the field on the radius is small. The difference in path length between the two field cases is negligible. If the transverse component is neglected, the change in azimuthal angle in the solenoidal field, \(\Delta\phi_{solen}\), and the constant field, \(\Delta\phi_{const}\), are related by a function that depends approximately, only on z :

Figure 2: Magnetic field strength in the Inner Detector as a function of R and z: longitudinal component \(B_{z}\), along the beam direction (left), and radial component \(B_{R}\) (right).

Figure 3: View in the \((X-Y)\) plane at \(\eta=1.7\) of particles trajectories of various transverse momenta through the Inner Detector.

Figure 5: Z-dependence of the azimuthal displacement of hits, \(\Delta\phi\) (see Fig. 3), with respect to the position expected for the constant magnetic field at different \(\eta\) values.

Figure 6: Z-dependence of displacement of hits, \(\Delta L\) (see Fig. 3), in the \((R-\phi)\) plane with respect to the position expected for the constant field at different \(\eta\) values.

Figure 7: Z-dependence of displacement of hits, \(\Delta L\) (see Fig. 3), in the \((R-\phi)\) plane with respect to the position expected for the constant field at different \(R\) values.

\[\frac{\Delta\phi_{solen}}{\Delta\phi_{const}}\approx\frac{\int B_{z,solen}(z)dl_{ solen}}{\int B_{z,const}dl_{const}}=f_{corr}(z) \tag{1}\]

Figure 8 illustrates that these assumptions are valid to a good approximation over the full ID volume.

One approach to provide a fast and simple trigger strategy is to search for track segments separately in the precision tracker and the TRT. As Fig. 4 illustrates, there are quite different field conditions in the SCT/Pixel and TRT parts of the Inner Detector. The analysing power of the field for the TRT part is lower, especially in the high-z region. This is illustrated by Fig. 9, where the mean value of the field, averaged over the part of the trajectory in the TRT, is plotted for the \(p_{T}=\infty\) :

\[\frac{<B_{solen}>}{B_{const}}=\frac{\int\limits_{TRT}\mathbf{B_{solen}}\times dl _{solen}/L}{\int\limits_{TRT}\mathbf{B_{const}}\times dl_{const}/L}=f_{corr}^{ p_{T}}(\eta) \tag{2}\]

The mean value of the field and, hence, the slope of the trajectory in the \(\phi-z\) plane drops down to 0.3 of the maximum value at the highest values of \(\eta\).

## 4 Tracking with TRT in an Inhomogeneous Field

### Hit finding and track reconstruction

A histograming (Hough transform) method is used as the first stage of many track search algorithms used in triggering for the Inner Detector ([10], [11], [12].

In a constant field, the trajectory of a charged particle of a given momentum has a constant curvature and can be represented by a straight line after some conformal transformation (to the \(R-\phi\) or \(\phi-z\) plane). This feature simplifies the procedure of

Figure 8: Ratio of the bending angles for the true and constant field. Each line segment corresponds to a rapidity range of \(\Delta\eta=0.2\) for high (bold) or low (dashed) momentum.

the track parameter reconstruction. To study the sensitivity of the existing algorithms to the field inhomogeneity, muons were generated with \(p_{T}=1\) and \(5~{}GeV\) and reconstructed by the modified TBTREC package [10] with some features from the initial track search step of XXALMAN[13]. This package corresponds to the TRT FEX algorithm currently (ATRIG version up to 04-11-00) implemented in the ATRIG trigger simulation package. Only the end-cap part of the TRT detector has been used in this analysis, since the constant field approximation is an accurate enough assumption for the barrel TRT.

The two main steps of the FEX algorithm are the initial track search using a histograming method, and a subsequent track fitting. At the histograming stage sets of hit straws satisfying the following straight line conditions:

\[\phi=\phi^{\prime}_{0}+C_{z}z;\hskip 28.452756pt\phi^{\prime}_{0}=\phi_{0}-z_{0}C _{z};\hskip 28.452756ptC_{z}=\frac{0.003\cdot B\cdot q\cdot tan(\theta)}{2p_{T}}~{}~ {},\]

are searched for. Here \(z_{0},\phi_{0},\theta\) are the initial z-coordinate, azimuthal and polar angles of the particle trajectory with an electric charge \(q\) in a field of strength \(B\) (\(B\) - in Tesla, \(p_{T}\) - in GeV, angles - in radians).

The consequence of using the constant field approximation in the first step of algorithm is that in the real field some points will be lost as they lie outside the search road using the straight-line boundaries. It is certainly not favourable to widen the search road in the high-occupancy conditions expected at high luminosity. Fig. 10 shows the \(\eta\) dependence of the average number of hits, \(N_{hits}\), found on the reconstructed tracks. The observed \(\eta\)-dependence is due to the TRT detector geometry. For high-\(p_{T}\) (above 5 GeV) tracks, \(N_{hits}\) is only slightly lower at \(\eta=1.7\div 2.0\) than in the case of the constant field, while for the low-\(p_{T}\) (1 GeV), tracks there is a substantial loss of hits at mid-rapidity.

To recover from these losses, the search road (or look-up table) has to be calculated using the expected actual trajectories of the charged particles (see Fig. 4). The fact that the correction factors depend (approximately) only on the z - position of the straws, as shown in Fig. 8, makes this correction simpler. The function from Eq. 1 should be applied to the histograming stage to obtain a search road with a modified "slope":

Figure 9: Average value of B along the part of the trajectory inside the TRT (normalised to \(B_{const}=2.085~{}T\)). Each kink on the curve corresponds to one of the “corners” of the TRT geometry.

\[C_{z}^{solen}=\frac{0.003\cdot q}{2p_{T}}\int\limits_{0}^{L}{\bf B_{solen}(r,z) \times dl_{solen}}\approx C_{z}\cdot f_{corr}(z)\ \,\]

where the integration is over the particle trajectory. The result of this procedure is shown in Fig.10 by the open circles. It successfully restores the correct number of hits on the reconstructed tracks down to \(p_{T}=1\ GeV\).

The second step of the FEX procedure is the track fitting of points selected in the first step. At this stage the algorithm (default option) uses also information from drift-time measurements. The importance of the use of this information is discussed in the Section 4.2. A simple straight-line fit is possible only in cases when the curvature (in the \(\phi-z\) plane) is small compared to the straw size. This is the case only for high-\(p_{T}\) tracks. The \(p_{T}\) value is therefore reconstructed from the fitted value of \(C_{z}^{solen}\) after the correction by the factor \(f_{corr}^{p_{T}}(\eta)\) (Eq. 2). The reconstructed value of \(\eta,\eta^{rec}\) can be used instead of true value. Its precision is sufficient to give a good value of the correction even at highest \(\eta\), where the quality of \(\eta\) reconstruction in the TRT is poor. This is illustrated by Fig. 11 together with a comparison with the constant field simulation and reconstruction.

The quality of the reconstruction is comparable with the constant field case except the high \(\eta\) region. The reason for this is clear from Fig. 9, since the \(1/p_{T}\) resolution decreases proportionally to the field value. Fig. 12 shows a comparison of 30 GeV muons reconstructed at \(\eta=2.2\) for solenoid field and for a constant field with \(B=0.6\) T (in accordance to Fig. 9). The dispersions of the two distributions are about the same.

Figures 13 and 14 show the distributions of \(p_{T}/p_{T}^{rec}\) for 30 GeV muons and electrons in four regions of \(\eta\). The r.m.s. increases by a factor 3 for the high \(\eta\) region with respect to the constant field case. There are large bremsstrahlung tails at low momentum in the case of electrons. These obscure somewhat the effect of the additional smearing of the distributions due to the decrease of the field at higher \(\eta\).

Figure 10: Mean number of TRT hits on reconstructed muon tracks for the cases of the constant field (crosses), and of the solenoidal field, without correction of the hit position (solid circles), and with correction of the hit positions (open circles).

Figure 11: Distribution of \(p_{T}/p_{T}^{rec}\) for muons with \(p_{T}=5\div 30\) GeV. The error bars correspond to r.m.s. Left figure is the case of a constant 2T field (horizontal distribution) and solenoid field without correction of \(p_{T}^{rec}\) (lower distribution). On the right plot the reconstructed \(p_{T}\) values is corrected by the factor \(f_{corr}^{p_{T}}(\eta^{rec})\) from Fig. 9.

Figure 12: Distributions of \(p_{T}/p_{T}^{rec}\) for 30 GeV muons in a constant 0.6 T field (dashed line) and in a solenoidal field (full line) at \(\eta=2.2\).

Figure 13: Distribution of \(p_{T}/p_{T}^{rec}\) for 30 GeV muons in four intervals of \(\eta\), where \(p_{T}^{rec}\) is corrected as in Fig. 11. The full line corresponds to the simulation using the solenoid field (upper statistics box) and the dashed line to the constant field (lower statistics box).

The low-\(p_{T}\) (\(\lesssim 5\) GeV) case needs more sophisticated approach. In this case, a straight-line fit is no longer possible because of the significant sagitta of particle trajectories at high z and \(\eta\). This subject is not covered by this note.

### Importance of Drift Time Measurements

The measurement of drift-time, or of time needed for an ionisation cluster to reach the wire in the straw tubes of the TRT, provides the capability of measuring the particle trajectory with a high accuracy. The expected drift-time resolution is about 200 \(\mu m\) at the LHC design luminosity [1]. In addition to providing the better \(p_{T}\) and \(\phi\) resolutions, the drift-time measurements also provide a better rejection against fake track candidates. However, the trigger scheme will require more information to be transmitted to Level 2.

To study the effect of drift-time measurements, the reconstruction of data with and without these measurements has been performed both for the constant field and for the solenoid field cases. Figure 15 shows a comparison of the \(p_{T}\) resolutions obtained for these two cases. The importance of the drift time measurements is evident in the high-\(\eta\) region.

The reason for the degradation of the resolution is illustrated by Figures 16 and 17, which show a quite small azimuthal deflections of the 10 GeV \(p_{T}\) muons which are almost "unnoticed" for the solenoidal field (\(p_{T}=10\) GeV does not correspond to the highest possible value of \(p_{T}\) by far!). If the drift time measurements were not to be used for the fitting, then there would be no way to determine the true track parameters, since all trajectories which cross all hit straws are equivalent, and linear fit cannot choose the correct slope in this case of rather large measurement "errors" (typically of 2 mm, i.e., half of the straw diameter).

Figure 15: Distributions of \(p_{T}/p_{T}^{rec}\) versus \(\eta\) for muons with \(p_{T}=5\div 30\) GeV with (left) and without (right) using the drift time measurements in the fit. The upper figures correspond to a \(B=2\)T constant field, whereas the lower ones correspond to the solenoidal field. (See also Fig. 11b for the \(p_{T}\) reconstruction details).

Figure 16: Event display (hit straw positions) in the \((\phi-z)\) plane for muon track with \(p_{T}=10~{}GeV,\eta=2.2\) and \(\phi_{0}=1\) in a constant field. The upper graph shows the drift-time position (represented by shaded rectangles with left-right ambiguities). The lower graph shows only the straw positions, which used in the fit when calculating the slope and \(p_{T}\) value of the candidate track. The dashed lines represent the true track trajectory, whereas the dotted lines represent the fitted track position.

Figure 17: Same as Fig. 16 for the solenoidal field. The dashed line represent the true track position as expected in a 2T constant field. The reconstructed \(p_{T}\) is corrected according to Fig. 11. Note that the straw hits align almost along a horizontal line because of the much reduced \(B_{z}\) value in that region (\(B_{z}\approx 0.6T\)). As a consequence, the reconstructed \(p_{T}\) has the wrong sign in the case of the fit without drift time (bottom).

### TRT Trigger Performance

In this section, results on single track trigger performance for high-\(p_{T}\) muons and electrons are presented for the end-cap part of the TRT detector. The simulation does not include any pile-up yet and all efficiencies quoted are relative to the total number of events generated, i.e. there is no Level 1 nor Level 2 calorimeter simulation and the ROI position was defined by KINE parameters of the trigger particles. The reconstructed \(p_{T}\) has been corrected as described in Section 4. The drift time information has been used in the reconstruction.

The efficiency of the algorithm for finding high-\(p_{T}\) tracks with \(p_{T}^{rec}>p_{T}^{threshold}\) is shown as a function of \(\mid\eta\mid\) in Fig. 18 for single 30 GeV \(p_{T}\) muons and electrons in the solenoidal and constant field. The difference between the two cases is rather small and for muons only the true field simulation results are shown. This is due to the fact that the chosen \(p_{T}^{cut}\) value of 5 GeV is sufficiently low with respect to nominal \(p_{T}\) of 30 GeV and that the difference in the low-\(p_{T}\) tails in the distributions of Figs. 13- 14 are small even for the broader distributions obtained in the case of the solenoidal field.

The efficiency of the algorithm as a function of the particle \(p_{T}\) is shown in Fig. 19 for muons and electrons generated with a uniform \(p_{T}\) distribution in the interval \(1\div 30\) GeV. The threshold applied is 5 GeV. The threshold behaviour is less sharp for the solenoidal field but the effect is rather small.

An appropriate \(p_{T}\) cut should be chosen to give a high efficiency for events passing this selection and on the other hand, to reduce the total event rate. The distributions of efficiency as a function of \(p_{T}\) cut are shown in Fig. 20 for two intervals of pseudorapidity and for both the constant and solenoidal field cases. There is very little difference between them in the low-\(\eta\) region. At high \(\eta\), there is some degradation of efficiency for muons. For a typical cut of 5-7 GeV, there is probably no significant drop in efficiency expected.

## 5 Conclusions

The effect of the inhomogeneity of the magnetic field inside the volume of the Inner Detector will affect significantly the reconstruction procedures. Due to the lower value of

Figure 18: TRT trigger algorithm efficiency as a function of \(\mid\eta\mid\) for \(p_{T}^{cut}=5\) GeV and for single muons and electrons with \(p_{T}=30\) GeV. The results are shown both for the constant and solenoidal fields.

Figure 19: TRT trigger algorithm efficiency as a function of \(p_{T}\) for \(p_{T}^{cut}=5\) GeV and for single muons (top) and electrons (bottom). The results are shown both for the constant and solenoidal fields.

Figure 20: TRT trigger efficiency as a function of \(p_{T}^{cut}\) for single muons (left) and electrons (right) with \(p_{T}=30\) GeV and for two \(\eta\)-intervals (top and bottom). The results are shown both for the constant (full line) and solenoidal (dashed line) fields.

field strength at the ends of detector, the TRT Level 2 algorithm shows the degradation of the quality of tracks reconstruction in that region. This increases the need for measurements with high precision (drift-time) in that region.

Nevertheless, the Level 2 trigger algorithm performance has been shown to be less sensitive to the field change while showing a small loss of performance. A more detailed simulation including that of the full trigger chain and of pile-up effects is needed. Special attention should be paid to fake rates at high luminosity, which could increase due to the degradation of the \(p_{T}\) resolution in the high-\(\eta\) regions, where the fake rates are highest.

A special study for the low-\(p_{T}\) case is necessary: this is especially important for the full scan Level 2 trigger option for B-physics.

## 6 Acknowledgements

I wish to thank Nick Ellis, Traudl Hansl-Kozanecka, Daniel Froidevaux, Igor Gavrilenko and John Baines for the valued advises and discussions and support of this work.

## References

* [1] "ATLAS Inner Detector TDR" CERN/LHCC/97-16, 1997.
* [2] "ATLAS Trigger Performance.Status Report" CERN/LHCC/98-15, 1998.
* [3] "ATLAS Central Solenoid TDR", CERN/LHCC-97/21, 1997.
* [4] "\(P_{T}\) resolution with the post-Annecy tracker layout", A. Poppleton. ATLAS Internal note INDET-NO-077, 1995.
* [5] "Parameterisation of the Inner Detector Performance" E-J Buis et.al. ATLAS Internal Note INDET-NO-215, 1998.
* [6] "DICE95-A Modified DICE Framework", ATLAS Internal note SOFT-NO-14, 1995; ATLASIM online Manual Pages.
* 15 Aug 1994V. Klyukhin et. al., ATLAS Internal Note TILECAL-NO-22, 1994
* [8] "Field integrals for the ATLAS tracking volume", V. Klyukhin et. al., ATLAS Internal Note INDET-NO-023, 1993.
* [9][http://atlasinfo.cern.ch/Atlas/GROUPS/MUON/magfield/mag_page1.html](http://atlasinfo.cern.ch/Atlas/GROUPS/MUON/magfield/mag_page1.html)
* [10] "Pattern Recognition in TRD", I. Gavrilenko. ATLAS Internal Note INDET-NO-016, 1992.
* [11] "Second Level Triggering In the Forward Region of the ATLAS Inner Tracker", S.Sivoklokov, J. Baines, R. Dankers. ATLAS Internal Note INDET-NO-111,1995.
* [12] "Global Pattern Recognition in the TRT for the ATLAS LVL2 Trigger", M. Sessler, M. Smizanska. ATLAS Internal Note INDET-NO-210, 1998.
* [13] "Description of Global Pattern Recognition Program (XKalman)". by: I.Gavrilenko ; 25 Apr 1997. ATLAS Internal Note INDET-NO-165.