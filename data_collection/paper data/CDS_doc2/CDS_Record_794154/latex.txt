ATLAS Physics Communication

ATL-COM-PHYS-2004-057

22 September 2004

revised 24.10.2004

Exploring hadronic \(\tau\) identification with DC1 data samples:

a track based approach1

Footnote 1: Supported in part by Polish-French Collaboration 01-103 (cf. 95-81) within IN2P3.

**E. Richter-Was2**

Footnote 2: Supported also in part by the Polish Government grant KBN 1 P03 091 27 (years 2004-2006) and by the EC FP5 Centre of Excellence “COPIRA” under the contract No. IST-2001-37259.

_Institute of Physics, Jagellonian University_

_30-059 Krakow, ul. Reymonta, Poland._

_Institute of Nuclear Physics PAS_

_31-342 Krakow, ul. Radzikowskiego 152, Poland._

**H. Przysiezniak and F. Tarrade**

_LAPP, 9 Chemin de Belleuve, B.P. 110, 74941 Annecy-le-Vieux, France._

In this note we discuss the identification of hadronic \(\tau\)s. We propose an algorithm, tauID, which starts from a reconstructed, relatively high \(p_{T}\) track and then collects calorimetric energy deposition in a fixed cone seeded by the track \(\eta\) and \(\phi\) at the vertex. With the proposed algorithm we explore exclusive features of the hadronic \(\tau\) decays and we indicate also the possibility of using an energy-flow based approach for defining the energy scale of the reconstructed \(\tau\)-candidates.

The results presented here are limited to the barrel region (\(|\eta|<1.5\)) and are based on the DC1 events simulated without pile-up and electronic noise.

We compare the performances of the proposed algorithm and of the base-line _tauRec_ algorithm and draw some conclusions for further studies.

Introduction

Identification of hadronic \(\tau\) decays will be the key to the possible Higgs boson discovery in the wide range of the MSSM parameter space [1]. The \(h/H/A\to\tau\tau\) and \(H^{\pm}\to\tau\nu\) are the candidates in the mass range spanning from roughly 100 GeV to 800 GeV. The sensitivity increases with large \(\tan\beta\) and decreases with rising mass of the Higgs boson. The \(H\to\tau\tau\) decays will also give access to the Standard Model and light Minimal Supersymmetric Standard Model Higgs boson observability around \(m_{H}=120\) GeV, produced by vector-boson fusion [2]. Needless to say that hadronic \(\tau\) identification is very important for searching for supersymmetic particles.

Hadronic \(\tau\) identification in ATLAS has been studied since several years as a key benchmark signature for optimising detector design and presently, to optimise the performance of the final reconstruction algorithms. Results have been reported on several occasions, the most recent references are [1], [3], [4] and [5]. Several details can be also found in earlier notes e.g. [6].

In this note we propose a new algorithm tauID, for hadronic \(\tau\) reconstruction and identification. The main concept is different from the _base line_ ATLAS algorithm tauRec, established within the Athena framework [7]. The tauID algorithm is intended for studies of a low mass Higgs around 120 GeV, with visible energy from hadronic \(\tau\) decays in the range 20 - 50 GeV. In the reconstruction process of the visible decay products of the \(\tau\), one requires one or three tracks (reconstructed in the inner detector), charged energy deposited in the electromagnetic and hadronic calorimeters from the \(\pi^{\pm}\) (associated to the charged tracks), and additional neutral electromagnetic energy from the accompanying \(n\pi^{0}\). The algorithm starts from the reconstructed, good quality and relatively high \(p_{T}\) track and then collects calorimetric energy deposited in a fixed cone seeded by the track \(\eta\) and \(\phi\) at the vertex.

The tauID algorithm is designed to explore exclusive features of hadronic \(\tau\) decays: single-prong or three-prong signature; the presence of only charged hadronic energy (\(\pi^{\pm}\) or \(3\pi^{\pm}\)) and of only neutral pure electromagnetic energy (\(n\pi^{0}\)), both components being collimated in space; well defined mass of the decaying \(\tau\) which allows to set upper limits on the invariant mass of the reconstructed calorimetric energy and the track momenta represented as 4-vectors. We indicate also the possibility of using an energy-flow based approach [8] for defining the energy scale of the reconstructed \(\tau\)-candidates.

In this note, only the single-prong hadronic \(\tau\) reconstruction, giving a \(\tau_{1P}\) candidate, has been developped in detail. The three-prong decays reconstruction, giving a \(\tau_{3P}\) candidate, still needs to be worked on. The tauID package is presently a private code under developement, and we report on preliminary performance results. The full code, after reaching some level of maturity, will be presented elsewhere [9].

In Section 2 we justify why starting from the track reconstruction is interesting for hadronic \(\tau\) reconstruction. The discussion presented in Section 2 is based on generator level or fast reconstruction information. For these studies, the TAUOLA [10] and PHOTOS[11] complete interfaces [12] to PYTHIA Monte Carlo embeded in the AcerMC-2.0 [13] framework have been used for the simulation of the \(\tau\) decays, with spin-correlations properly simulated.

In Section 3 and 4 we give a detailed description of the algorithm and its performance for the single-prong hadronic \(\tau\) decays. In Section 5, we present a very crude comparison with the performance of the tauRec algorithm. Results presented in Sections 3, 4 and 5 are based on the fully simulated and reconstructed events, mostly from ATLAS Data Challenge 1 (ATLAS DC1) [14]. Events are reconstructed without electronic noise and pile-up. The studies presented in this note were done for the barrel part of the detector: we discuss kinematical distributions only for events with the \(\tau\) decay products within the pseudorapidity range \(|\eta|<1.5\).

In Section 6 we draw some conclusions for the further developement of the tauID algorithm.

In the appendixes we give some details on the code organisation of the tauID package and the parameters used. We also give details on the official ATLAS reconstruction code used in the presented studies and analysed data samples.

## 2 Hadronic \(\tau\) decays with a single leading \(\pi^{\pm}\)

The identification of hadronic \(\tau\) decays with a single (\(\pi^{\pm}\)) is a primary interest of this analysis. The dominant contributions come from the decays \(\tau^{\pm}\to\pi^{\pm}\nu\) ( about 11%), \(\tau^{\pm}\to\pi^{\pm}\pi^{0}\nu\) with the intermediate states of \(\rho\), \(\rho^{\prime}\), \(\rho^{\prime\prime}\) (about 36%) and other \(\tau^{\pm}\to\pi^{\pm}\pi^{0}\nu\) (about 1.5%). In total, the single-prong and three-prong hadronic final states contribute respectively 48.5% and 16.5% to the allowed final states. For the hadronic final states only, the single-prong and three-prong contribute respectively 75% and 23% to the total branching ratio. The remaining fraction is taken by more complicated decays involving \(K_{0}^{L}\) and \(K_{0}^{S}\). A more detailed break-down of the \(\tau\) decay modes and branching ratios is given in Table 2.

Fig. 1 shows multiplicities of \(\pi^{\pm}\) from hadronic decays for two different cut values on the energy of the visible decay products of the \(\tau\), \(E_{T}^{vis}>20\) GeV and 30 GeV, for the \(gg\to H\to\tau\tau\) production process.

For further discussion we select only single-prong hadronic \(\tau\) decays. 75% of them are of the type \((\pi^{\pm},n\pi^{0})\), and 23% of the type \((\pi^{\pm},0\pi^{0})\).

Samples of \(gg\to H(\to\tau\tau)\) and \(qqH\to qqH(\to\tau\tau)\) events with the Higgs boson mass \(m_{H}\ =\ 120\) GeV, and \(q\,\overline{q}\to Z/\gamma^{*}\to\tau\tau\) events, have been generated with one \(\tau\) decaying hadronically and the other decaying leptonically. \(q\,\overline{q}\to W\to e\nu\) background events, which are falsely identified as \(\tau\)-jets, have also been generated.

\begin{table}
\begin{tabular}{|c||c|} \hline \hline Decay modes & Branching ratios \\ \hline \hline \(\tau\to e\nu\;\nu,\;\mu\nu\;\nu\) & 35 \% \\ \hline \hline \(\tau\to\pi^{\pm}\nu\) & 11 \% \\ \hline \(\tau\to\rho\;\nu,\rho\to\pi^{\pm}\pi^{0}\) & 25 \% \\ \hline \(\tau\to\rho\;n\pi^{0}\;\nu\) & 11 \% \\ \hline \(\tau\to\pi^{\pm}\;n\pi^{0}\;\nu\) & 1.5 \% \\ \hline \hline others ( \(>\) 1 charged) & 16.5 \% \\ \hline \hline \end{tabular}
\end{table}
Table 1: \(\tau\) _decay branching ratios_.

Studies presented in the subsections below are based on particle level information or, in the case of the \(q\overline{q}\to W\to e\nu\,\)events, on the fast simulation and reconstruction with the ATLFAST [15] package (no jet energy scale calibration). For simplicity, we have excluded decays to \(K_{L}^{0}\) and \(K_{S}^{0}\) from the particle level analysis. They contribute only a few percent to the allowed final states and the signature in the detector will depend on their decays when propagated through material.

### Hadronic \(\tau\) from the \(H\to\tau\tau\) events

For the \(gg\to H\) events, the mean \(p_{T}\) of the \(\pi^{\pm}\) from a single-prong decay is about 18 GeV, such that 61% of events are accepted when applying a cut of \(p_{T}^{\pi\pm}>10\) GeV. Adding a cut on the visibe transverse energy from \(\tau\) decays of \(E_{T}^{vis}>20\) GeV, we are left with 85% of those events. Similar fractions hold for \(qq\to qqH\) events. Tables 2 and 3 show acceptances of the single-prong hadronic \(\tau\) decays with different selections on the particle level for the two production mechanisms.

\begin{table}
\begin{tabular}{|c||c|c|c|} \hline \hline Selection/Acceptance & \((\pi^{\pm},n\pi^{0})\) & \((\pi^{\pm},0\pi^{0})\) & total \\ \hline \hline \(E_{T}^{vis}>\) 20 GeV & 60.3 \% & 14.0 \% & 74.3 \% \\ \hline \(E_{T}^{vis}>\) 30 GeV & 39.9 \% & 9.3 \% & 49.2 \% \\ \hline \(E_{T}^{vis}>\) 40 GeV & 25.1 \% & 5.7 \% & 30.8 \% \\ \hline \hline \(p_{T}^{\pi\pm}>\) 10 GeV & 41.0 \% & 19.6 \% & 60.6 \% \\ \hline \hline \(E_{T}^{vis}>\) 20 GeV and \(p_{T}^{\pi\pm}>\) 10 GeV & 37.5 \% & 13.9 \% & 51.5 \% \\ \hline \(E_{T}^{vis}>\) 30 GeV and \(p_{T}^{\pi\pm}>\) 10 GeV & 28.9 \% & 9.3 \% & 38.2 \% \\ \hline \(E_{T}^{vis}>\) 40 GeV and \(p_{T}^{\pi\pm}>\) 10 GeV & 19.1 \% & 5.7 \% & 24.8 \% \\ \hline \hline \end{tabular}
\end{table}
Table 2: _Acceptance for hadronic \(\tau\) single-prong decays with different selections on the particle level. Results for a SM Higgs boson produced via \(gg\to H\to\tau\tau\) with \(m_{H}~{}=~{}120\) GeV._The acceptance for the selection requiring a single-prong hadronic \(\tau\) with \(p_{T}^{\pi^{\pm}}>10\) GeV and \(E_{T}^{vis}>20\) GeV is comparable to requiring only \(E_{T}^{vis}>30\) GeV (default selection for the analysis foreseen for the Higgs boson at \(m_{H}\) = 120 GeV). This observation holds both for the \(gg\to H\) and \(qq\to qqH\) production processes.

Fig. 2 shows the fraction of the \(\pi^{\pm}\) and \(\pi^{0}\) energies with respect to \(E_{T}^{vis}\) for a single-prong hadronic \(\tau\), selected by requiring \(E_{T}^{vis}>20\) GeV and \(p_{T}^{\pi^{\pm}}>10\) GeV (left) or only \(E_{T}^{vis}>30\) GeV (right). Clearly, the higher threshold on \(E_{T}^{vis}\) selects events with a large \(\pi^{0}\) component. Requiring a lower threshold on \(E_{T}^{vis}\) but a relatively high transverse momentum on the \(\pi^{\pm}\) selects events with a larger charged component in \(E_{T}^{vis}\).

The cone separation between charged and neutral components is comparable for both selections. Visible decay products of the \(\tau\) are close to each other in space at the particle level. For the \(gg\to H\) and \(qq\to qqH\) samples, the mean value of the cone separation is \(\Delta R=~{}0.04\) and the resolution is \(\sigma\) = 0.02.

### Hadronic \(\tau\) from the \(Z/\gamma^{*}\to\tau\tau\) events

The main irreducible background for \(H\to\tau\tau\) with \(m_{H}~{}=~{}120\) GeV are the \(q\bar{q}\to Z/\gamma^{*}\to\tau\tau\) events. Contribution from the background events to the mass window around 120 GeV is dominated by badly reconstructed events from the on-shell Z-boson, and not by events from the \(Z/\gamma^{*}\) high-mass tail at \(m_{Z/\gamma^{*}}=120\) GeV (see e.g. discussion in [16]).

For this background process, reducing the threshold on the calorimetric energy and introducing cuts on the high \(p_{T}\) track lead to an increase in the acceptance. The \(p_{T}\) spectrum of the visible decay products of hadronic \(\tau s\) for the \(q\bar{q}\to Z/\gamma^{*}\to\tau\tau\) events decreases faster as the \(p_{T}\) increases than for the \(H\to\tau\tau\) events. The decaying Z-boson is a vector while a Higgs boson is a scalar, and this leads to different angular distributions of the \(\tau s\) in the Z or Higgs rest frame.

\begin{table}
\begin{tabular}{|c||c|c|c|} \hline \hline Selection/Acceptance & \((\pi^{\pm},n\pi^{0})\) & \((\pi^{\pm},0\pi^{0})\) & total \\ \hline \hline \(E_{T}^{vis}>20\) GeV & 58.2 \% & 14.6 \% & 72.8 \% \\ \hline \(E_{T}^{vis}>30\) GeV & 45.3 \% & 10.2 \% & 55.5 \% \\ \hline \(E_{T}^{vis}>40\) GeV & 33.7 \% & 7.8 \% & 41.5 \% \\ \hline \hline \(p_{T}^{\pi\pm}>10\) GeV & 45.8 \% & 19.5 \% & 65.3 \% \\ \hline \hline \(E_{T}^{vis}>20\) GeV and \(p_{T}^{\pi\pm}>10\) GeV & 42.4 \% & 14.6 \% & 57.0 \% \\ \hline \(E_{T}^{vis}>30\) GeV and \(p_{T}^{\pi\pm}>10\) GeV & 35.7 \% & 10.2 \% & 45.9 \% \\ \hline \(E_{T}^{vis}>40\) GeV and \(p_{T}^{\pi\pm}>10\) GeV & 27.4 \% & 7.8 \% & 35.2 \% \\ \hline \hline \end{tabular}
\end{table}
Table 3: _Acceptances for hadronic \(\tau\) with single-prong decays with different selections on the particle level. Results for a SM Higgs boson produced via \(qq\to qqH\to\tau\tau\) with \(m_{H}~{}=~{}120\) GeV._Figure 2: _Fraction of the energy carried by the \(\pi^{\pm}\) (top), \(n\pi^{0}\) (middle) with respect to the visible transverse energy and the cone separation between \(\pi^{\pm}\) and bary-centre of the \(n\pi^{0}\) directions (bottom). The distributions are for hadronic \(\tau s\) with single-prong decays (the cone separation distribution is only for \(\tau\rightarrow\pi^{\pm}n\pi^{0}\) events) with \(E_{T}^{vis}>20\) GeV and (a) \(p_{T}^{\pi^{\pm}}>\) 10 GeV (left) (b) no \(p_{T}^{\pi^{\pm}}\) cut (right)._

[MISSING_PAGE_FAIL:7]

Lowering the threshold on the transverse momentum of allowed nearby \(\pi^{\pm}\) will improve rejection against hadronic jets from \(Wj\) events, but this might also lead to signal loss, because of the underlying event activity and pile-up present in the full physics event. One should however bear in mind that tightening the threshold on the nearby \(\pi^{\pm}\) leads to accepting reducible jets similar to the \(\tau\)-jets and as a consequence the subsequent selection will have less rejection power.

### Final remarks

In this Section we have presented a comparison (particle level or fast simulation) of the acceptances for different choices of the thresholds on the visible energy of \(\tau\) decay products in the case of single-prong hadronic \(\tau\) decays. From Tables 2 and 3 one can conclude that lowering the threshold on the visible transverse energy of the \(\tau\) decay products and adding cuts on the transverse momentum of the leading track gives some gain or a comparable acceptance for signal events. The lower threshold will increase the irreducible \(q\overline{q}\to Z/\gamma^{*}\to\tau\tau\) background (see Table 4) but significantly reduce the reducible backgrounds i.e. \(q\overline{q}\to W\to e\nu\) events (see Tables 5 and 6).

\begin{table}
\begin{tabular}{|l||c|c|} \hline \hline Selection/Acceptance & no others with & no others with \\  & \(p_{T}^{\pi\pm}>\) 2 GeV & \(p_{T}^{\pi\pm}>\) 5 GeV \\ \hline \hline \(E_{T}^{jet}>\) 20 GeV and \(p_{T}^{\pi\pm}>\) 10 GeV & 3.7 \% & 5.2 \% \\ \hline \(E_{T}^{jet}>\) 30 GeV and \(p_{T}^{\pi\pm}>\) 10 GeV & 1.6 \% & 2.7 \% \\ \hline \(E_{T}^{jet}>\) 40 GeV and \(p_{T}^{\pi\pm}>\) 10 GeV & 0.8 \% & 1.4 \% \\ \hline \hline \end{tabular}
\end{table}
Table 6: _Acceptances for different cut values on the ATLFAST calorimetric jets (no calibration). Results for the inclusive \(q\overline{q}\to W\to\ell\nu\) events._Reconstruction of the single-prong hadronic \(\tau\)-candidate

In the approach proposed in this note, the single-prong \(\tau\)-candidate is defined as the leading hadronic track (see Section 3.1 for more details) and the energy deposition in the calorimeter around the vicinity of the track.

Reconstruction of the \(\tau\)-candidates is based on the following steps:

* Identify and qualify a leading hadronic track;
* Calculate calorimetric energy deposition from cells in a cone seeded by the track \(\eta\) and \(\phi\) at the vertex and require it to be above a transverse energy threshold;
* Calculate calorimetric and energy flow observables from energy deposition in cells in the cone seeded by this track;
* Qualify the candidate.

The proposed procedure explores the fact that the \(\tau\)-decay gives visible products being exclusively a \((\pi^{\pm},n\pi^{0})\) final state. The hadronic energy will originate from primary \(\pi^{\pm}\) only, electromagnetic energy will be dominated by the primary \(n\pi^{0}\) energy deposition. The decay products are very close in space, so the energy deposition should be concentrated in a narrow cone, even given the fact that track is curved in the magnetic field. The decay products should also be spatially isolated from the rest of the event. One may therefore consider the possibility to disentangle the local topology of the \(\tau\) candidate from the more uniformly distributed in space energy deposition of the hadronic jets. The absence of a primary neutral hadronic component should allow to determine the upper limit on the total hadronic energy, which should not exceed the transverse momentum of the charged track.

The fact that the \(\tau\) itself has a narrow width should also be explored. One may consider the possibility to set an upper limit on the invariant mass reconstructed from the energy deposition in the calorimetric cells, represented as 4-vectors.

The _energy flow_ approach will be used to determine the energy-scale of the \(\tau\)-candidate.

Results presented in this section are based on fully simulated events from the ATLAS DC1 production and the reconstruction is performed using the ATLAS ATHENA Release 7.8.0 with some extensions (see Appendix B).

### The leading hadronic track

The \(\tau\)-candidate reconstruction starts out with the identification of a qualified, leading hadronic track. A track is defined as qualified if it has passed some minimal criteria for a _good quality_ reconstruction. This means requiring a minimal number of hits in the silicon and straw detectors, a threshold on the value of the impact parameter as well as a threshold on the value of the \(\chi^{2}\) of the fit for the trajectory reconstruction. The exact selection used is specified in Appendix A.1. We require that the qualified track is not identified as an _electron_ or a _muon_. For the time being, because of the lack of features in the reconstruction packages, the veto is based on the truth information only.

The _qualified track_ is considered as a _leading track_ if its transverse momentum is above a given threshold \(p_{T}>10\) GeV, and if the number of nearby qualified tracks (in the cone \(\Delta R<0.4\) and with \(p_{T}>5\) GeV or \(p_{T}>2\) GeV) is not greater than 2. This relatively high threshold on the transverse momentum of the nearby tracks should protect us against rejecting too many true-\(\tau s\) in the presence of soft tracks from the underlying event and from pile-up (present even during the low luminosity conditions).

In Table 7 we compare the efficiencies for identifying the leading hadronic track in di-jet events generated with \(p_{T}^{hard}>35\) GeV (noted as dijet35, where \(p_{T}^{hard}\) is the transverse momentum of the hard process), in \(q\overline{q}\to Z\to\tau\tau\) events (noted as Ztautau), in the \(qq\to qqH,H\to\tau\tau\) sample (noted as vbfHtautau) and finally in the \(q\overline{q}\to W\to e\nu\) sample of events (noted as Wtoenu). Requiring a qualified track to fulfill the criteria for a _leading hadronic track_, a rejection factor of 65 can be achieved against qualified tracks reconstructed in the dijet35 sample, with 44 % and 64% acceptance for qualified tracks originating from the \(\tau\) decays in the Ztautau and vbfHtautau samples respectively. This 64% is consistent with the particle-level selection results presented in Table 3.

### The single-prong \(\tau\) candidate

The single-prong hadronic \(\tau\) candidate, called \(\tau_{1P}\)-candidate, is seeded by the leading hadronic track, which has no associated nearby tracks (see previous section). No threshold is initially required on the accompanying calorimetric energy deposition in the cone

\begin{table}
\begin{tabular}{|c||c|c||c|c|} \hline \hline Selection/Acceptance & vbfHtautau & Ztautau & dijet35 & Wtoenu \\  & true-\(\tau\) tracks & true-\(\tau\) tracks & all tracks & all tracks \\ \hline \hline Reconstructed tracks & 100 \% (0.64) & 100 \% (0.62) & 100\% (17.1) & 100 \% (12.0) \\ \hline Qualified tracks & 90 \% & 91 \% & 78.3 \% & 71.3 \% \\ \hline  & \multicolumn{4}{c}{nearby tracks with \(p_{T}^{track}>5\) GeV} \\ \hline Leading hadronic tracks & 58 \% & 40 \% & 1.5 \% & 0.7 \% \\ at most 2 nearby tracks & & & & \\ \hline Leading hadronic tracks & 46.5 \% & 32.5 \% & 0.8 \% & 0.4 \% \\ no nearby tracks & & & & \\ \hline Leading hadronic tracks & & & & \\ no nearby tracks & 35.0 \% & 15.0 \% & 0.4 \% & 0.16 \% \\ \(E_{T}^{eado}>20\) GeV & & & & \\ \hline  & \multicolumn{4}{c}{nearby tracks with \(p_{T}^{track}>2\) GeV} \\ \hline Leading hadronic tracks & 58 \% & 40 \% & 0.7 \% & 0.4 \% \\ at most 2 nearby tracks & & & & \\ \hline Leading hadronic tracks & 43.5 \% & 29.0 \% & 0.3 \% & 0.2 \% \\ no nearby tracks & & & & \\ \hline Leading hadronic tracks & & & & \\ no nearby tracks & 33.0 \% & 14.0 \% & 0.12 \% & 0.06 \% \\ \(E_{T}^{eado}>20\) GeV & & & & \\ \hline \hline \end{tabular}
\end{table}
Table 7: _The efficiencies and in brackets mean multiplicities for tracks reconstructed in the \(|\eta|<1.5\) pseudorapidity range and for the vbfHtautau, Ztautau and dijet35 samples._around the track. In Fig. 3, the top plots represent the separation \(\Delta R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\) at the vertex between the visible \(\tau\) decay products direction (truth information) and the reconstructed track direction, while the bottom plots show the separation \(\Delta R\) at the position of the second layer of the electromagnetic calorimeter. The results are presented for the Ztautau sample and for \(\tau_{1P}\) candidates with \(E_{T}^{calo}>20\) GeV. One can conclude that the true direction of the visible \(\tau\) decay products are fairly well represented by the track \(\eta\) and \(\phi\) at the vertex, with a \(\Delta R\) mean value of 0.02. The track \(\eta\) and \(\phi\) at the vertex will therefore be used as the \(\tau_{1P}\) direction.

Figure 3: _The separation \(\Delta R\) between the true direction of the bary-center of the visible decay products of the \(\tau\) and the reconstructed track \(\eta\) and \(\phi\), at the vertex (top) and at the position of the second layer of the electromagnetic calorimeter(bottom). Shown as a function of the reconstructed transverse calorimetric energy of the \(\tau_{1P}\) (left) and as a function of the transverse momentum of the hadronic track of the \(\tau_{1P}\) (right). Error-bars denote RMS of the distributions._

### The calorimetric observables

Several calorimetric observables can be used to discriminate the narrow \(\tau\)-jet from the hadronic jet originating from quarks or gluons. As already discussed in the previous section, for the single-prong hadronic \(\tau\) decays, the cone separation between neutral electromagnetic and charged hadronic decay products is very small. Even given the fact that the \(\pi^{0}\) will decay further into a pair of photons with some opening angle, the cone separation between bary-centers of the primary decay products should remain small.

The discriminating observables discussed below are those from an existing \(\tau\) identification package which has been used in previous analyses [3, 7] (the exact definitions might be slightly different). If not stated otherwise, the calorimetric observables are calculated from cells in a distance of \(\Delta R=0.4\) with respect to the \(\tau_{1P}\) seed (track \(\eta\) and \(\phi\) at the vertex). Some minimal threshold on the energy deposition in cells is also required.

* Electromagnetic radius of the \(\tau\)-candidate, \(R^{\tau}_{em}\), calculated from cells around the track \(\eta\) and \(\phi\) at the vertex and weighted by the transverse energy deposition of a given cell. Only cells belonging to the first three samplings of the electromagnetic calorimeter (presampler, strips and middle) are used for the calculation. \[R^{\tau}_{em}=\frac{\sum\Delta R^{\tau_{1P},cell}\cdot E^{cell}_{T}}{\sum E^{ cell}_{T}}\] (1)
* Number of strips, \(N^{\tau}_{strips}\) with energy deposition above a certain threshold.
* The width of the energy deposition in strips, \(W^{\tau}_{strips}\), calculated as the variance in the \(\eta\) coordinate, weighted by the transverse energy deposition in a given strip. \[W^{\tau}_{strips}=\frac{\sum(\Delta\eta^{\tau_{1P},strip})^{2}\cdot E^{strip}_ {T}}{\sum E^{strip}_{T}}-\frac{\sum(\Delta\eta^{\tau_{1P},strip}\cdot E^{strip }_{T})^{2}}{(\sum E^{strip}_{T})^{2}}\] (2)
* The fraction of the transverse energy deposited, \(fracE^{R12}_{T}\), in the \(0.1~{}<~{}\Delta~{}R~{}<~{}0.2\) radius with respect to the total energy in the cone \(\Delta R=0.2\). Cells belonging to all layers of the calorimeter are used. \[fracE^{R12}_{T}=\frac{\sum E^{cell}_{T}(R^{\tau_{1P},cell}<0.2)-\sum E^{cell}_ {T}(R^{\tau_{1P},cell}<0.1)}{\sum E^{cell}_{T}(R^{\tau_{1P},cell}<0.2)}\] (3)

In Figs. 4 to 7 we show the distributions and profiles of the above variables for the \(\tau_{1P}\) candidates within three different samples: the \(\rho\rightarrow\pi^{\pm}\pi^{0}\) sample with \(E=50\) GeV and spanned at different \(\eta\) positions (called rho50 sample), the ztautau sample and dijet35 sample. The rho50 sample is used as the reference one, as the single \(\tau\) samples were not available. The rho50 and ztautau distributions are similar although an effect from the full physics (minimum bias event, multiple interaction) can be observed. In particular the \(W^{\tau}_{strips}\) distribution is a bit larger for \(\tau\)s in full physics events. In the \(N^{\tau}_{strips}\) distribution one clearly sees a large fraction of events with no energy deposition in the strips layer (about 20%) which come mostly from the \((\pi^{\pm},0\pi^{0})\)\(\tau\) candidates. The distributions are significantly different for the dijet35 events. This indicates the discriminating power of the variables for reconstructing true-\(\tau\) and fake-\(\tau\) candidates \(\tau_{1P}\).

Figure 4: _The \(R_{em}^{\tau}\) distribution for rho50 (left), ztautau (middle) and dijet35 (right) events. The variable distributions are shown (top) as well as the profile plots (error-bars represent RMS of the distribution) as a function of the transverse momentum of the track \(p_{T}^{track}\) (middle) and as a function of the transverse energy collected in the calorimeter, \(E_{T}^{\rm calo}\) (bottom). All \(\tau_{1P}\) candidates are used for the rho50 distributions, while for the ztautau and dijet35 samples, only the \(\tau_{1P}\) candidates which satisfy \(E_{T}^{\rm calo}>20\) GeV are used._

Figure 5: _Same as Fig. 4 but for the \(N_{strips}^{\tau}\) variable._

Figure 6: _Same as Fig. 4 but for the \(W_{\text{strips}}^{\tau}\) variable._

Figure 7: _Same as Fig. 4 but for the \(fracE_{T}^{R12}\) variable._

### The energy-flow observables

Another set of variables have been derived from the _energy flow_ approach (for more details see [8, 17]). In this note we use only a very simplified procedure for classifying calorimetric cells as being of the _neutral electromagnetic_, _charged electromagnetic_, _charged hadronic_ and _others_ type.

* The charged hadronic energy, \(E_{T}^{chrgHAD}\), is defined as the energy deposited in the hadronic samplings found within a distance \(|\Delta\eta|\), \(|\Delta\phi|<0.2\) from the track.
* The charged electromagnetic energy, \(E_{T}^{chrgEM}\), is defined as the energy deposited in the electromagnetic samplings within a distance \(|\Delta\eta|\), \(|\Delta\phi|<0.0375\) from the track.
* The neutral electromagnetic energy, \(E_{T}^{neuEM}\), is defined as the energy deposition in the remaining cells in the first three layers of the electromagnetic calorimeter within a distance \(|\Delta\eta|\), \(|\Delta\phi|<0.2\) from the track \(\eta\) and \(\phi\) at the vertex.
* The remaining cells in the cone \(\Delta R<0.4\) are considered as _others_ and they contribute to \(E_{T}^{otherHAD}\), \(E_{T}^{otherEM}\).

Ideally, the _neutral electromagnetic_ energy should originate only from \((n\pi^{0})\) deposition while _charged electromagnetic_ and _charged hadronic_ energy from \(\pi^{\pm}\) deposition. Using the classification described above, we build the following variables:

* The ratio of the charged transverse energy deposited in the hadronic calorimeter and the transverse track momentum, \(E_{T}^{chrgHAD}/p_{T}^{track}\).
* The sum of the transverse momenta of all other electromagnetic cells, \(E_{T}^{otherEM}\).
* The sum of the transverse momenta of all other hadronic cells, \(E_{T}^{otherHAD}\).
* The invariant mass, \(M_{cells}\), calculated from all cells classified as _neutral electromagnetic_, _charged electromagnetic_ and _charged hadronic_. Energy deposition in cells is represented as 4-vector and the invariant mass is calculated from a vector sum of all 4-vectors, assuming that individual cells are _massless_.

\[M_{cells}=\sqrt{(\sum cell_{ene})^{2}-(\sum cell_{px})^{2}-(\sum cell_{py})^{2 }-(\sum cell_{pz})^{2}} \tag{4}\]
* The invariant mass, \(M_{neuEM}\), calculated as above but using only _neutral electromagnetic_ cells.
* The invariant mass, \(M_{eflow}\), calculated from two 4-vectors: one from all _neutral electromagnetic_ cells, and the other from the track 4-vector at the vertex.

In Figs. 8 to 13 we show the distributions of the above variables for the \(\rho\to\pi^{\pm}\pi^{0}\) from rho50 sample, for true \(\tau\)-candidates from the Ztautau sample, and for the fake \(\tau\)-candidates from the dijet35 sample. The discriminating power of those variables is visible.

Figure 8: _The \(E_{T}^{chrgHAD}/p_{T}^{track}\) distributions for the rho50 (left), ztautau (middle) and dijet35 (right) samples. Shown are the variable distributions (top) and the profile plots (error-bars represent RMS of the distribution) as a function of the transverse momentum of the track \(p_{T}^{track}\) (middle) and as a function of the energy collected in the calorimeter, \(E_{T}^{calo}\) (bottom). All \(\tau_{1P}\) candidates are used for the the rho50 distributions, while for the ztautau and dijet35 distributions, only \(\tau_{1P}\) candidates with \(E_{T}^{calo}>20\) GeV are used._

Figure 9: _Same as Fig. 8 but for the \(E_{T}^{otherEM}/E_{T}^{calo}\) variable._

Figure 10: _Same as Fig. 8 but for the \(E_{T}^{otherHAD}/E_{T}^{calo}\) variable._

Figure 11: Same as Fig. 8 but for the \(M_{cells}\) variable.

Figure 12: Same as Fig. 8 but for the \(M_{\text{new}EM}\) variable.

Figure 13: Same as Fig. 8 but for the \(M_{eflow}\) variable.

### The energy scale of the \(\tau_{1P}\) candidate

The energy scale of the \(\tau_{1P}\) candidate is defined using an _energy flow_ algorithm, simplified with respect to what is discussed in [8]. More detailed definitions and discussions on the energy flow performance for the hadronic \(\tau\) reconstruction can be found in [17].

The _energy flow_ type of algorithm calculates the energy scale as follows: the energy deposited by the hadronic track is subtracted out and is replaced by the track momentum, the energy deposited by the accompanying neutral electromagnetic particles (\(\pi^{0}\)) is collected, and we try to avoid, if possible, collecting the energy deposition from underlying events or QCD initial and/or final state radiation in the event. The procedure for classification of the energy type was described in Section 3.4

The starting point is provided by a very simple formula:

\[E_{T}^{eflow}=1.2\cdot E_{T}^{neuEM}+p_{T}^{track} \tag{5}\]

where the factor 1.2 which scales the _neutral electromagnetic_ energy is the calibration factor for the energy lost outside the cone from \(\pi^{0}\)'s and it was tuned on the Ztautau sample.

Equation 5 overestimates the energy for the \(\tau\rightarrow\pi^{\pm}\nu\) events when the electromagnetic energy deposited by the \(\pi^{\pm}\) is not totally contained in the narrow window used for the collection of charged electromagnetic energy. This energy, contributing to \(E_{T}^{neuEM}\), will be double counted in the \(E_{T}^{eflow}\) (as it is included in \(p_{T}^{track}\) and \(E_{T}^{neuEM}\)).

On the other hand, for the \((\pi^{\pm},n\pi^{0})\) events for which the \(\pi^{0}\) is close to the charged track, a fraction of the \(\pi^{0}\) energy will be collected as charged electromagnetic energy and hence will not enter in the calculation of the \(E_{T}^{eflow}\) variable. To determine whether the \(\pi^{0}\) is close to the \(\pi^{\pm}\) or not, we evaluate the energy deposited in the presampler and strip layer, \(E_{T}^{EMchrg01}\), and compare it to the track transverse momentum. If \(E_{T}^{EMchrg01}>0.05\)\(p_{T}^{track}\), the \(\pi^{0}\) is most likely close to the \(\pi^{\pm}\) and will confuse the energy flow algorithm. For those events we use the simple alternative expression

\[E_{T}^{eflow}=1.25\cdot E_{T}^{ealo}. \tag{6}\]

Using equations 5 and 6, the distributions in Fig. 14 and 15 are obtained. The core of the distribution has much better resolution than the crude calorimetric \(E_{T}^{ealo}\), while the RMS of the distributions are comparable. The stability of the energy scale is quite good as a function of the track momentum, slightly worse as a function of the \(E_{T}^{ealo}\).

Let us stress that the \(\tau_{1P}\) candidate energy scale definitions and results presented here do not require any complicated calibration or weighting procedure.

Figure 14: _The energy scale of all \(\tau_{1P}\) candidates compared to the \(\tau\) visible decay products. The \(E_{T}^{\it calo}/E_{T}^{vis}\) ratio (left plot) and \(E_{T}^{\it effow}/E_{T}^{vis}\) ratio (right plot) distributions are shown. Results are presented for the Ztautau sample._

Figure 15: _The profile plots of the reconstructed \(\tau_{1P}\) candidates energy scale with the energy-flow approach as a function of \(E_{T}^{\it visible}\), \(E_{T}^{\it calo}\) and \(p_{T}^{\it track}\). Results are presented for the Ztautau sample._

Performance for signal and background samples

The performance of the tauID algorithm for the \(\tau_{1P}\) candidates is evaluated below for the fully simulated true hadronic \(\tau\)s (Ztauauau and vbfHtautau ) and fake hadronic \(\tau\)s ( dijet35 and wtoenu). More details on the samples used can be found in Appendix C.

The content of the true hadronic \(\tau\) samples, Ztauauau and vbfHtautau events, have been studied from the Monte Carlo truth information. Table 8 gives the fraction of hadronic \(\tau\) events passing the different selection cuts on the particle level. The numbers are given for \(\tau\to\mbox{\it had }\nu\) decays within a rapidity acceptance of \(|\eta|<1.5\). Approximately \(2.5\cdot 10^{4}\)Ztauauau and \(5\cdot 10^{3}\)vbfHtautau events, with at least one \(\tau\) decaying hadronically, have been used in this analysis. One expects that \(43.3\%\) and \(23.1\%\) of the hadronically decaying \(\tau\)s in the vbfHtautau and Ztauauau samples respectively will be reconstructed as \(\tau_{1P}\) candidates: single-prong with \(E_{T}^{vis}>20\) GeV and \(p_{T}^{\pi\pm}>10\) GeV. If instead a more calorimetry oriented approach was used, e.g. requiring \(E_{T}^{vis}>30\) GeV and \(p_{T}^{\pi\pm}>2\) GeV, \(43.6\%\) and \(16.9\%\) would respectively qualify as candidates.

The samples discussed above have been processed with the tauID package and \(\tau_{1P}\) candidates have been reconstructed. The efficiencies after different selection cuts are given in Table 9. In total, \(46.3\%\) and \(34\%\) of the hadronic \(\tau\) decays within the vbfHtautau and Ztauau samples respectively have been reconstructed as \(\tau_{1P}\) candidates. The truth fractions of single-prong decays passing the same kinematical thresholds are \(48.8\%\) and \(32.1\%\) respectively. The efficiencies when requiring that \(E_{T}^{eflow}>20\) GeV are \(39.8\%\) and \(22\%\), while the respective fractions from Monte Carlo truth are \(43.3\%\) and \(23.1\%\). The \(\tau_{1P}\) efficiencies with thresholds applied to \(E_{T}^{calo}\) instead of \(E_{T}^{eflow}\) are also given in Table 9.

\begin{table}
\begin{tabular}{|c||c|c|} \hline \hline Selection/Acceptance & vbfHtautau sample & Ztauau sample \\  & true \(\tau\) tracks & true \(\tau\) tracks \\ \hline \hline \(\tau\to\mbox{\it had }\nu\) & \(100.0\)\% & \(100.0\)\% \\ \hline + single-prong & \(74.3\%\) & \(73.0\)\% \\ \hline \(+p_{T}^{\pi\pm}>2\) GeV & \(69.7\)\% & \(63.1\)\% \\ \hline \(+p_{T}^{\pi\pm}>10\) GeV & \(48.8\%\) & \(32.1\)\% \\ \hline \hline \(E_{T}^{vis}>20\) GeV & \(77.1\)\% & \(48.3\)\% \\ \hline + single-prong & \(56.4\)\% & \(33.7\)\% \\ \hline \(+p_{T}^{\pi\pm}>2\) GeV & \(54.8\)\% & \(32.3\)\% \\ \hline \(+p_{T}^{\pi\pm}>10\) GeV & \(43.3\)\% & \(23.1\)\% \\ \hline \hline \(E_{T}^{vis}>30\) GeV & \(61.2\)\% & \(24.8\)\% \\ \hline + single-prong & \(43.6\)\% & \(16.9\)\% \\ \hline + \(p_{T}^{\pi\pm}>2\) GeV & \(42.4\)\% & \(16.4\)\% \\ \hline + \(p_{T}^{\pi\pm}>10\) GeV & \(34.8\)\% & \(12.8\)\% \\ \hline \hline \end{tabular}
\end{table}
Table 8: _Acceptances for different selections on the particle level, extracted from the fully simulated Ztautauau and vbfHtautau samples. Numbers are based on approximately \(2.5\cdot 10^{4}\)Ztauau and \(5\cdot 10^{3}\)vbfHtautau events with hadronic \(\tau\) decays._The performance and purity of the \(\tau_{1P}\) reconstruction is very good. It reconstructs 95% of the single-prong hadronic \(\tau\) decays with \(p_{T}^{\pi\pm}>10\) GeV. One also observes a very good consistency between the efficiencies for the Monte Carlo truth and for the \(\tau\)s reconstrcuted with the tauID package.

In the following the simple cut-based identification for the true and fake \(\tau_{1P}\) candidates has been used. The cuts have been chosen on the basis of the distributions presented in Figs. 4 to 13, and are as follows:

* Calo-based ID: narrow core of the calorimetric cluster
* \(N_{strips}^{\tau}<\) 15
* \(W_{strips}^{\tau}<\) 0.004
* \(R_{em}<\) 0.08
* Eflow-based ID (A): hadronic energy matching reconstructed track momentum
* \(E_{T}^{chrgHAD}/p_{T}^{track}<\) 1.0
* Eflow-based ID (B): isolation of the narrow core from the rest of the event
* Eflow-based ID (C): fixed mass of the decaying \(\tau\) lepton

\begin{table}
\begin{tabular}{|c||c|c|} \hline \hline Selection/Acceptance & vbfHtautau sample & Ztauau sample \\  & true \(\tau\) tracks & true \(\tau\) tracks \\ \hline \hline \(\tau\to\)_had_\(\nu\) & 100.0 \% & 100.0 \% \\ \hline \(\tau_{1P}\), no threshold \(E_{T}^{eflow}\) & 46.3 \% & 34.0 \% \\ \hline \(\tau_{1P}\), \(E_{T}^{eflow}>20\) GeV & 39.8 \% & 22.0 \% \\ \(\tau_{1P}\), \(E_{T}^{eflow}>30\) GeV & 31.2 \% & 11.7 \% \\ \hline \hline \(\tau_{1P}\), \(E_{T}^{calo}>20\) GeV & 34.6 \% & 14.9 \% \\ \(\tau_{1P}\), \(E_{T}^{calo}>30\) GeV & 25.1 \% & 5.7 \% \\ \hline \hline \end{tabular}
\end{table}
Table 9: _Efficiencies with respect to all analysed hadronic \(\tau\) decays, for the \(\tau_{1P}\) reconstruction from the fully simulated Ztauauau and vbfHtautau samples. The samples are the same as those used for the results in Table 8._Results of the identification selection are summarised in Table 10 for two different thresholds on the transverse momentum of nearby tracks. As already mentioned in Section 2.3, tightening the thresholds on the nearby tracks makes the discrimination with the calorimetric/energy flow variables _per se_ less effective. Fake \(\tau_{1P}\) candidates are more \(\tau\)-like. For about 50% efficiency for identifying true \(\tau_{1P}\) using calorimetric and elbow variables, a rejection factor of 20 and 10 can be achieved for fake \(\tau_{1P}\) candidates from the dijet35 and wtoenu samples respectively (for 5 GeV thresholds on nearby track).

These numbers should be convoluted with the efficiency for reconstructing \(\tau_{1P}\) candidates. Table 11 gives the total cumulative efficiencies3 for identifying \(\tau_{1P}\). For true single-prong hadronic \(\tau\) decays with \(E_{T}^{vis}>20\) GeV, the cumulated identification efficiency is 33.4% for the vbfHtautau sample and 36.5% for the Ztautau sample. The efficiency for the leading hadronic track from the dijet35 or wtoenu samples to be identified as \(\tau_{1P}\) is about 3%. This corresponds to an efficiency of the order of \(2\cdot 10^{-4}\) for any qualified track in those samples to be identified as a \(\tau_{1P}\).

Footnote 3: The number of accepted \(\tau_{1P}\) is constant, calculated from line _eflow-based ID (C)_ of Table 10. The respective numbers of initial candidates varies and are extracted from Tables 7 and 8.

Let us stress that presented cut-based identification selection was not optimised yet.

\begin{table}
\begin{tabular}{|c||c|c||c|c|} \hline Selection/Acceptance & vbfHtautau & Ztautau & dijet35 & wtoenu \\  & true \(\tau\) tracks & true \(\tau\) tracks & all tracks & all tracks \\ \hline \hline  & \multicolumn{3}{|c||}{nearby tracks with \(p_{T}^{track}>\) 5 GeV} \\ \hline \hline \(\tau_{1P}\) candidate, \(E_{T}^{eflow}>\) 20 GeV & 100 \% & 100 \% & 100 \% & 100 \% \\ \hline calo-based ID & 73.3 \% & 59.8 \% & 12.0 \% & 20.0 \% \\ \hline eflow-based ID (A) & 70.0 \% & 58.7 \% & 11.0 \% & 19.0 \% \\ \hline eflow-based ID (B) & 68.5 \% & 56.4 \% & 9.4 \% & 15.9 \% \\ \hline eflow-based ID (C) & 43.5 \% & 40.8 \% & 6.4 \% & 11.3 \% \\ \hline \hline  & \multicolumn{3}{|c||}{nearby tracks with \(p_{T}^{track}>\) 2 GeV} \\ \hline \hline \(\tau_{1P}\) candidate, \(E_{T}^{eflow}>\) 20 GeV & 100 \% & 100 \% & 100 \% & 100 \% \\ \hline calo-based ID & 74.2 \% & 62.2 \% & 21.5 \% & 33.3 \% \\ \hline eflow-based ID (A) & 72.1 \% & 61.2 \% & 20.7 \% & 31.5 \% \\ \hline eflow-based ID (B) & 71.1 \% & 59.3 \% & 18.2 \% & 27.8 \% \\ \hline eflow-based ID (C) & 45.0 \% & 53.3 \% & 14.2 \% & 22.2 \% \\ \hline \hline \end{tabular}
\end{table}
Table 10: _The cumulative acceptances of the \(\tau_{1P}\)-candidates in the \(|\eta|<1.5\) pseudorapidity rapidity range. From the processed subsamples about \(10^{4}\)\(\tau_{1P}\)-candidates were reconstructed for vbfHtautau and Ztautau samples, about \(2\cdot 10^{3}\) for dijet35 samples and about 200 for wtoenu samples_.

\begin{table}
\begin{tabular}{|c||c|c||c|c|} \hline \hline The total efficiencies & vbfHtautau & Ztautau & dijet35 & wtoenu \\ with respect to: & true \(\tau\) tracks & true \(\tau\) tracks & all tracks & all tracks \\ \hline \hline \multicolumn{5}{|c|}{nearby tracks with \(p_{T}^{track}>\) 5 GeV} \\ \hline \hline \(\tau_{1P}\) candidates & & & & \\ \(E_{T}^{e\,flow}>\) 20 GeV & 43.5 \% & 40.8 \% & 6.4 \% & 11.3 \% \\ \hline \hline \(\tau_{1P}\) candidates & 34.9 \% & 29.6 \% & 3.2 \% & 4.5 \% \\ \hline leading hadronic tracks & 28.0 \% & 17.1 \% & 1.7 \% & 2.5 \% \\ \hline qualified tracks & 18.0 \% & 7.5 \% & 0.04 \% & 0.03 \% \\ \hline \hline \multicolumn{5}{|c|}{nearby tracks with \(p_{T}^{track}>\) 2 GeV} \\ \hline \hline \(\tau_{1P}\) candidates & & & & \\ \(E_{T}^{e\,flow}>\) 20 GeV & 45.0 \% & 53.3 \% & 14.2 \% & 22.2 \% \\ \hline \hline \(\tau_{1P}\) candidates & 34.0 \% & 26.6 \% & 5.8 \% & 6.8 \% \\ \hline leading hadronic tracks & 25.2 \% & 19.3 \% & 2.5 \% & 3.4 \% \\ \hline qualified tracks & 16.5 \% & 8.5 \% & 0.02 \% & 0.02 \% \\ \hline \hline \(\tau\to\)_had_\(\nu\) & & & & \\ single-prong, \(E_{T}^{vis}>\) 20 GeV & 41.4 \% & 50.8 \% & & \\ \(p_{T}^{\pi\pm}>\) 10 GeV & & & & \\ \hline \(\tau\to\)_had_\(\nu\) & & & & \\ single-prong, \(E_{T}^{vis}>\) 20 GeV & 33.4 \% & 36.5 \% & & \\ \hline \hline all \(\tau\to\)_had_\(\nu\) & 17.9 \% & 11.7 \% & & \\ \hline \hline \end{tabular}
\end{table}
Table 11: _The total efficiencies for identifying \(\tau_{1\,P}\) in the \(|\eta|<1.5\) pseudorapidity rapidity range for analysed signal and background samples. The 5 GeV and 2 GeV thresholds are used for nearby tracks_.

Comparison with the tauRec algorithm

Several criteria can be used to compare the tauID and tauRec algorithms:

* Efficiency for the true hadronic \(\tau\) identification and rejection of the fake \(\tau\).
* The energy scale reconstruction
* The \((\eta,\phi)\) position reconstruction

While the first one is the most crucial for the effectiveness of the analyses where excelent \(\tau\) identification is required, the importance of quality of the energy scale and position reconstruction should not be underestimated. Moreover, the performance of the algorithm should be robust and stable in the presence of electronic noise and pile-up.

Below we show a comparison between the tauRec and tauID algorithms for the single particle samples and for full physics events. The single particle samples are composed of \(\pi^{\pm}\) and \(\rho\to\pi^{\pm}\pi^{0}\) events at fixed rapidity and energy. They represent well the \(\tau\to\pi^{\pm}\nu\) and \(\tau\to\rho\nu\) topologies. Full physics samples comprise of real signal and background events for analyses where hadronic \(\tau\) identification is required.

The definitions of the calorimetric variables, \(R^{\tau}_{em}\), \(W^{\tau}_{strips}\) and \(frac{E^{R12}_{T}}{}\), are not exactly the same in both algorithms, although they are quite similar. The definitions of the energy-flow type variables are also different. The advantages of their specific definitions can be only verified when comparing the rejection power against fake \(\tau\)-candidates for constant efficiency for true \(\tau\) identification.

The tauID algorithm selection has not been optimised yet and no likelihood parametrisation exists. We will therefore compare the discriminating power of the simplest set of calorimetric variables and a very simple cut selection.

\begin{table}
\begin{tabular}{|c|c|} \hline \hline \(\tau_{1P}\)-candidate & tauRec-candidate \\ \hline \hline seeded by & seeded by \\ good quality track & calorimetric cluster \\ with \(p_{T}>10\) GeV & \\ \hline good quality track required & no requirements on tracks \\ no nearby tracks & \\ \hline track \(\eta,\phi\) & \(\eta,\phi\) from \\ at the vertex & calorimetric cluster \\ \hline \hline energy scale & energy scale \\ from energy-flow & from calorimetry \\ \hline \hline \end{tabular}
\end{table}
Table 12: _Comparison between main assumptions for tauID and tauRec algorithms_.

### Single \(\pi^{\pm}\) samples

Single \(\pi^{\pm}\) events at fixed rapidity and transverse energy were studied with both algorithms as an example for the \(\tau\to\pi^{\pm}\nu\) reconstruction.

For the sample containing 10000 \(\pi^{\pm}\) events with \(p_{T}=10\) GeV

* The tauRec algorithm reconstructs 10215 candidates. In 2% of the events more than one candidate (seeded by the calorimetric cluster) is found (the threshold \(E_{T}^{ealo}>1\) GeV was set for the initialisation of the tauRec algorithm). The tauRec algorithm does not require that a track be reconstructed inside a cluster: 330 tauRec candidates have no track associated.
* The tauID algorithm reconstructs 9288 candidates. The 7% inefficiency is due to the requirement of a _good quality_ track.

For the sample containing 10000 \(\pi^{\pm}\) events with \(p_{T}=30\) GeV

* The tauRec algorithm reconstructs 10122 candidates. In 1.2% of the events more than one candidate (seeded by the calorimetric cluster) is found (the threshold \(E_{T}^{ealo}>1\) GeV was set for the initialisation of the tauRec algorithm). The tauRec algorithm does not require that a track be reconstructed inside a cluster: 180 tauRec candidates have no track associated.
* The tauID algorithm reconstructs 9412 candidates. The 6% inefficiency is due to the requirement of a _good quality_ track.

The \(\Delta\eta\) and \(\Delta\phi\) evaluated between the original direction of the \(\pi^{\pm}\) and the direction of the reconstructed \(\tau_{1P}\)-candidate are given in Table 13 for the different samples and algorithms.

\begin{table}
\begin{tabular}{|c||c|c|} \hline \hline Selection/Acceptance & \(\tau_{1P}\)-cadidate & tauRec \\ \hline \hline  & \(\pi^{\pm}\) at \(p_{T}\) = 10 GeV \\ \hline \hline \(\eta^{\tau-reco}-\eta^{\pi-truth}\) & \(<m>=1.3\cdot 10^{-5}\) & \(<m>=-1.8\cdot 10^{-3}\) \\  & \(\sigma=9.0\cdot 10^{-4}\) & \(\sigma=2.0\cdot 10^{-2}\) \\  & \(RMS=1.5\cdot 10^{-3}\) & \(RMS=4.0\cdot 10^{-2}\) \\ \hline \hline \(\phi^{\tau-reco}-\phi^{\pi-truth}\) & \(<m>=5.5\cdot 10^{-6}\) & \(<m>=-5.8\cdot 10^{-2}\) \\  & \(\sigma=3.4\cdot 10^{-4}\) & \(\sigma=2.6\cdot 10^{-2}\) \\  & \(RMS=7.9\cdot 10^{-4}\) & \(RMS=8.5\cdot 10^{-2}\) \\ \hline \hline  & \(\pi^{\pm}\) at \(p_{T}\) = 30 GeV \\ \hline \hline \(\eta^{\tau-reco}-\eta^{\pi-truth}\) & \(<m>=9.4\cdot 10^{-6}\) & \(<m>=8.8\cdot 10^{-4}\) \\  & \(\sigma=7.4\cdot 10^{-4}\) & \(\sigma=1.2\cdot 10^{-2}\) \\  & \(RMS=1.6\cdot 10^{-3}\) & \(RMS=1.6\cdot 10^{-2}\) \\ \hline \hline \(\phi^{\tau-reco}-\phi^{\pi-truth}\) & \(<m>=1.3\cdot 10^{-5}\) & \(<m>=-2.2\cdot 10^{-2}\) \\  & \(\sigma=1.4\cdot 10^{-4}\) & \(\sigma=1.4\cdot 10^{-2}\) \\  & \(RMS=6.3\cdot 10^{-4}\) & \(RMS=1.1\cdot 10^{-1}\) \\ \hline \hline \end{tabular}
\end{table}
Table 13: _The quality of the \((\eta,\phi)\) coordinates reconstruction of the hadronic \(\tau\)-candidate for the \(\pi^{\pm}\) samples with transverse energy \(E_{T}=\) 10 and 30 GeV._Figure 16: _The distributions for \(R^{\tau}_{em}\), \(W^{\tau}_{strips}\) and \(fracE^{R12}_{T}\) for the \(\tau_{1P}\)-candidates (top) and respectively tau_EMRadius, tau_stripWidth2 and tau_IsoFrac for tauRec-candidates (bottom) for the \(\pi^{\pm}\) sample with \(p_{T}=10\) GeV and \(\eta=0.3\)._

Figure 17: _The energy scale of the \(\tau_{1P}\)-candidate (left) and tauRec-candidate (right) for the \(\pi^{\pm}\) sample with \(p_{T}=10\) GeV and \(\eta=0.3\)._

Figure 19: _Same as Fig. 17 but for the \(\pi^{\pm}\) sample with \(p_{T}=30\) GeV and \(\eta=0.3\)._

For the 10 GeV \(\pi^{\pm}\) sample and also 30 GeV sample the resolution and the RMS are better by a factor of at least 10 for the \(\tau_{1\tt p}\) reconstruction (defined by tracking) with respect to the tauRec reconstruction (defined by the calorimetry).

In Figs. 16 and 18 are shown the \(R^{\tau}_{em}\), \(W^{\tau}_{strips}\) and \(fracE_{T}^{R12}\) distributions (and their tauRec equivalent) as calculated for \(\tau_{1P}\)-candidates (top) and for tauRec-candidates (bottom), for both samples (\(p_{T}=10,\ 30\) GeV). The distributions are different, particularly for \(W^{\tau}_{strips}\) which for the tauRec-candidates is calculated with no threshold required on the energy deposition in the strips.

In Figs. 17 and 19 are shown the energy scale of the hadronic \(\tau\) candidate for the \(\tau_{1P}\)-candidates (right) and tauRec-candidates (left), for both samples. For the \(\tau_{1P}\)-candidate the energy-flow based approach is used (see equations 5 and 6 in Section 3.5). For the tauRec-candidate, the energy scale \(E_{T}^{calib}\) is calculated as \(E_{T}^{calib}=E_{T}^{EMcAlib}+E_{T}^{HadCalib}\). Much better resolution of the energy scale can be achieved using the tauID approach as opposed to the tauRec approach.

### Single \(\rho\rightarrow\pi^{\pm}\pi^{0}\) sample

The \(\rho\rightarrow\pi^{\pm}\pi^{0}\) at \(E\ =\ 50\) GeV sample has also been studied. The sample was generated at a different values of the pseudorapidity (\(E_{T}\) goes from 20 to 50 GeV). At least one tauRec candidate is reconstructed for each event. For events with \(E_{T}^{\rho}\ >\ 30\) GeV in 65 to 70% of the cases, the \(\rho\rightarrow\pi^{\pm}\pi^{0}\) decay gives a charged track with \(p_{T}\ >\ 10\) GeV, leading to the \(\tau_{1P}\) candidate.

Table 14 shows the quality of the position reconstruction which becomes comparable for the calorimetry-based and track-based reconstruction. One sees that for the total energy of the visible decay products of 50 GeV, the calorimetry-based reconstruction of the energy scale is on average becoming comparable if not superior to the track-based reconstruction.

Figure 21: _Same as Fig. 17 but for the \(\rho\to\pi^{\pm}\pi^{0}\) sample at \(E=50\) GeV and varying \(\eta\)._

Figure 20: _Same as Fig. 16 but for the \(\rho\to\pi^{\pm}\pi^{0}\) sample at \(E=50\) GeV and varying \(\eta\)._

### True hadronic \(\tau\) samples

For the comparison using the true hadronic \(\tau\) samples, we apply the preselection criteria to candidates reconstructed by both algorithms:

* Both \(\tau_{1P}\) and tauRec candidates within \(|\eta|<1.5\)
* For \(\tau_{1P}\)-candidates one good quality track with \(p_{T}>10\) GeV is required. For tauRec-candidates one track with \(p_{T}>2\) GeV or \(p_{T}>10\) GeV is required (for direct comparison with \(\tau_{1P}\)).
* For both \(\tau_{1P}\) and tauRec candidates no nearby tracks with \(p_{T}>2\) GeV.
* For tauRec candidates simple \(p_{T}\)-matching was performed to reject candidates with an electron or muon track 4. Footnote 4: The tauRec package does not provide a rigorous selection against electron or muon tracks. Therefore, at the analysis level, we have vetoed all candidates with the most energetic track pointing to the electron or muon as the truth for the track. However only simple \(p_{T}\)-matching with tracks from the CBNT_track was possible as CBNT_tauRec does not provide information which allows directly to go back to the track in the CBNT_track.

In the next step we perform a simple calorimetry-based selection requiring:

* For \(\tau_{1P}\) candidates:
* For tauRec candidates (see [7] for the definition of the variables used): Selection (A)
* tau_nStrip \(<~{}20\)
* tau_stripWidth2 \(<~{}0.02\)
* tau_IsoFrac \(<~{}0.4\)
* tau_EMRadius \(<~{}0.13\) Selection (B)
* tau_nStrip \(<~{}15\)
* tau_stripWidth2 \(<~{}0.004\)
* tau_IsoFrac \(<~{}0.2\)
* tau_EMRadius \(<~{}0.08\)

We have chosen two sets of thresholds for the tauRec variables, given the fact that even for simple calorimetric variables, the distributions are different for tauID and tauRec candidates (see Figs. 22 and 23). The comparison therefore cannot be very conclusive.

Figure 23: _Sam e as Fig. 22 but for the vbfHtautau sample._

Figure 22: _The distributions for \(R^{\tau}_{em}\), \(W^{\tau}_{strips}\) and \(frac{R^{\tau}_{1P}}{\tau_{1P}}\)-candidates (top) and respectively for tau_EMRadius, tau_stripWidth2 and tau_IsoFrac for tauRec-candidates (bottom) for the ztautau sample. A preselection was applied, see text._

\begin{table}
\begin{tabular}{|c||c|c||c|c|} \hline \hline Selection & \(\tau_{1P}\), \(E_{T}^{efflow}>\) & tauRec, \(E_{T}^{calib}>\) \\ \hline  & 20 GeV & 30 GeV & 20 GeV & 30 GeV \\ \hline \hline  & \multicolumn{2}{|c||}{all tracks} & \multicolumn{2}{|c|}{all tracks} \\ \hline \hline Preselection & & & & \\ \(p_{T}^{track}>2\) GeV & - & - & 15 720 & 7850 \\ \hline  & & & 12 080 (A) & 6 430 (A) \\ Calo-based ID & & & 5070 (B) & 2860 (B) \\ \hline \hline Preselection & & & & \\ \(p_{T}^{track}>10\) GeV & 11020 & 5910 & 10320 & 5960 \\ \hline Calo-based ID & 6640 & 4020 & 3400 (B) & 2160 (B) \\ \hline \hline  & \multicolumn{2}{|c||}{true \(\tau\) tracks} & & \\ \hline \hline Preselection & & & & \\ \(p_{T}^{track}>10\) GeV & 9260 & 5060 & - & - \\ \hline Calo-based ID & 5760 & 3540 & - & - \\ \hline \hline \end{tabular}
\end{table}
Table 15: _The number of \(\tau_{1P}\)-candidates and tauRec candidates. Results for the Ztautau sample (98 400 events have been analysed)._

\begin{table}
\begin{tabular}{|c||c|c||c|c|} \hline \hline Selection & \(\tau_{1P}\), \(E_{T}^{efflow}>\) & tauRec, \(E_{T}^{calib}>\) \\ \hline  & 20 GeV & 30 GeV & 20 GeV & 30 GeV \\ \hline \hline  & \multicolumn{2}{|c||}{all tracks} & \multicolumn{2}{|c|}{all tracks} \\ \hline \hline Preselection & & & \\ \(p_{T}^{track}>2\) GeV & - & - & 16 360 & 13 150 \\ \hline  & - & - & 11 910 (A) & 9650 (A) \\ Calo-based ID & - & - & 53 90 (B) & 4460 (B) \\ \hline \hline Preselection & & & & \\ \(p_{T}^{track}>10\) GeV & 10180 & 8070 & 12 4 10 & 10790 \\ \hline  & \multicolumn{2}{|c||}{} & 9250 (A) & 7930 (A) \\ Calo-based ID & 7120 & 59 80 & 42 00 (B) & 3630 (B) \\ \hline \hline  & \multicolumn{2}{|c||}{true \(\tau\) tracks} & & \\ \hline \hline Preselection & & & & \\ \(p_{T}^{track}>10\) GeV & 8110 & 6500 & - & - \\ \hline Calo-based ID & 6040 & 5060 & - & - \\ \hline \hline \end{tabular}
\end{table}
Table 16: _Same as Table 15 but for the vbfHtautau sample (48 800 events have been analysed)._

[MISSING_PAGE_FAIL:39]

Figure 25: _Same as Fig. 24 but for wtoenu sample._

### Outlook

In this note we proposed a new algorithm, tauID, for hadronic \(\tau\) reconstruction and identification. The tauID algorithm is intended for studies of the low mass Higgs (120 GeV) and the visible energy from the hadronic \(\tau\) decays in the range 20 - 50 GeV. The main concept is different from the ATLAS _base line_ tauRec algorithm within the Athena framework [7]:

* The reconstruction process of the \(\tau\) visible decay products requires a reconstructed, good quality and relatively high \(p_{T}\) track, and then collects calorimetric energy deposition in a fixed cone seeded by the track \(\eta\) and \(\phi\) at the vertex. The necessity for rigorous veto on electron and/or muon tracks is assumed.
* The separate treatment/optimisation of the one-prong and three-prong decays is assumed.
* The energy scale of the reconstructed hadronic \(\tau\) decay is obtained from the energy-flow approach: energy deposited in the calorimeter is classified for its type; the charged energy is replaced by the track momentum of \(\pi^{\pm}\); only the neutral electromagnetic energy, consistent with originating from \(\pi^{0}\) decays, is included in the estimate.
* For the identification process, both calorimetric and energy-flow observables are used.

So far only the algorithm for the single-prong hadronic \(\tau\) decays has been developed in detail. The first performance results shown in this note seem very promising both for hadronic \(\tau\) identification and energy scale determination. Obviously much more work is needed to bring it to the present status of the tauRec complexity: likelihood optimisation

\begin{table}
\begin{tabular}{|c||c|c||c|c|} \hline \hline Selection & \(\tau_{1P}\), \(E_{T}^{\,eflow}>\) & tauRec, \(E_{T}^{\,calib}>\) \\ \hline  & 20 GeV & 30 GeV & 20 GeV & 30 GeV \\ \hline \hline  & all tracks & \multicolumn{3}{c|}{all tracks} \\ \hline \hline Preselection & & & & \\ \(p_{T}^{\,track}>\) 2 GeV & - & - & 1910 & 1020 \\ \hline  & - & - & 1190 (A) & 730 (A) \\ Calo-based ID & - & - & 330 (B) & 230 (B) \\ \hline \hline Preselection & & & & \\ \(p_{T}^{\,track}>\) 10 GeV & 220 & 90 & 1030 & 710 \\ \hline  & & & 740 (A) & 540 (A) \\ Calo-based ID & 70 & 40 & 240 (B) & 180 (B) \\ \hline \hline \end{tabular}
\end{table}
Table 18: _Same as Table 17 but for fake candidates from the WtGenu sample (29 700 events have been analysed). For tauRec, the electron tracks have been explicitely excluded._for the rejection power agains fake \(\tau\) jets, optimisation of the thresholds used for the reconstruction, and maturity of the energy-flow determination of the energy scale.

The comparison between tauID and tauRec performances should be looked at with some cautions and not taken as the ultimate performance of neither of the discussed packages. In particular, discrepancies observed in Table 17 and Table 18 should be better understood with the forthcoming Atlas Release 9.0.0.

## Acknowledgments

We would like to thank greatly Anna Kaczmarska for providing a code which allowed to extract information on the track vicinity in the different layers of the calorimeter and have it available in Athena CBNT, Matevz Tadel for helping with having available cells map in the Athena CBNT and Pavel Nevski for simulating single-particle samples. We would like to acknowledge help and several discussions with Donatella Cavalli and Michael Heldmann on the tauRec package and \(\tau\)-jet identification.

E. Richter-Was would like to warmly thank Daniel Froidevaux and Anna Lipniacka for very valuable discussions.

E. Richter-Was acknowledges support and hospitality received from the University de Savoie and LAPP-Annecy (France) during May-July 2004, which allowed most of the work presented here to be completed.

## References

* [1] ATLAS Collaboration, ATLAS Performance and Physics Technical Design Report, ATLAS TDR 15, CERN/LHCC/99-15, 25 May 1999.
* [2] S. Asai et al. _Prospects for the search for a Standard Model Higgs boson in ATLAS using vector boson fusion_, ATLAS Scientific Note SN-ATLAS-2003-024.
* [3] D. Cavalli and S. Resconi \(\tau\)_-jet separation in ATLAS detector_, ATLAS Physics Note ATL-PHYS-98-118.
* [4] D. Cavalli and S. Resconi _Combined Analysis of \(A\to\tau\tau\) Events from Direct and Associated bbA Production_, ATLAS Physics Note ATL-PHYS-2000-005.
* [5] I. Hinchliffe, F. E. Paige and L. Vacavant, _Full simulation of hadronic \(\tau^{\prime}\)s in SUSY events in the ATLAS detector._, ATLAS Communication ATL-COM-PHYS-2002-037.
* [6] D. Cavalli et al. _Search for \(A/H\to\tau\tau\) decays_, ATLAS Physics Note ATL-PHYS-94-051.
* [7] M. Heldmann, presentations for the ATLAS Higgs Working Group, 22 January 2004, 1 December 2003; [http://agenda.cern.ch/displayLevel.php?fid=3194](http://agenda.cern.ch/displayLevel.php?fid=3194). M. Heldmann, presentations for the ATLAS Combined Performance Working Groups, 27 May 2004, 4 March 2004; [http://agenda.cern.ch/displayLevel.php?fid=319](http://agenda.cern.ch/displayLevel.php?fid=319). [http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/OO/domains/](http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/OO/domains/) Reconstruction/inAthena/inAthena.htm- status report_, presented at the ATLAS Software Week. March 2004.
* [9] E. Richter-Was at all, _The tauID algorithm for low energy hadronic \(\tau\) identification_, ATLAS Communication in preparation.
* [10] S. Jadach et al., _The tau decay library, TAUOLA: version 2.4_, Comp. Phys. Commun. **76** (1993) 361.
* [11] E. Barberio and Z. Was, _PHOTOS: an universal Monte Carlo for QED radiative corrections. version 2.0_, Comp. Phys. Commun. **79** (1994) 291.
* [12] P. Golonka et al., _The TAUOLA PHOTOS F environment for the TAUOLA and PHOTOS packages: release 2_, CERN-TH-2003-287, hep-ph/0312240.
* [13] B. Kersevan and E. Richter-Was, _The Monte Carlo Generator AcerMC-2.0 with interfaces to PYTHIA 6.2 and HERWIG 6.5_, ATLAS Physics Communication ATL-COM-PHYS-2004-035.
* [14] DC1 Task Force, _ATLAS Data Challenge 1_, ATLAS Software Note ATL-SOFT-2003-012.
* [15] E.Richter-Was, D. Froidevaux and L. Poggioli, _ATLFAST-2.0, a fast simulation package for ATLAS_, ATLAS Physics Note ATL-PHYS-98-131.
* [16] E. Richter-Was and T. Szymocha, _ATLAS observability potential for \(h/H/A\to\tau\tau\) decays below 200 GeV_, ATLAS Physics Note ATL-PHYS-2004-012.
* [17] E. Richter-Was et all., _Energy flow studies for haronic tau's with DC1 data_, ATLAS Communication in preparation.

Algorithms for the \(\tau_{1P}\)-candidate

The algorithm for \(\tau_{1P}\) reconstruction was coded in the root classes, in a form of package build into single executable. This package as input read Athena CBNT.root file and produces much smaller.root file with information on the reconstructed \(\tau_{1P}\)-objects, the \(\tau_{Kine}\)-objects and (optionally) also contains original tauRec objects.

The following classes are available:

* EvenTuple for retrieving information from the.root file conting ATHENA-CBNT.
* EvenInfo for storing information on the reconstructed quantities during execution of the algorithm.
* AlgoTracks for qualifying leading hadronic track
* AlgoMCTruth for building information on the true \(\tau\) decay, the \(\tau_{Kine}\) objects.
* AlgoTau1P for building \(\tau_{1P}\) object.
* ToolKinLib and ToolPrintEvent for calculation of kinematical quantities and printout.
* TreeManager and HistoManager for controling initialisation, filling and storage of the ROOT histograms and trees.

The new.root file can be further analysed with the simple root classes and macros.

### Algorithm for qualifying leading hadronic track: AlgoTracks

The algorithm works as following:

* Reconstructed XXalman track is considered if within pseudorapidity range limited by \(|\eta|<\) RecoEta_cut
* Reconstructed XXalman track is qualified if
* It is not an electron or a muon track (information extracted from truth)
* A0Vert \(<\) A0Vert_cut,
* NTRHits \(>\) NTRHits_cut,
* NStrawHits \(>\) NStrawHits_cut
* Chi2 \(<\) Chi2_cut
* Reconstructed XXalman track is labeled as _true \(\tau\) track_ ifthe matching truth particle originated from \(\tau\) decays.
* The leading hadron track is required to have transverse momentum \(p_{T}>\) pTleadTrack_cut. It is also required that the numer of other tracks with \(p_{T}>\) pTOtherTrack_cut within space distance \(\Delta R<\)detROtherTrack_cut is smallerthan NOtherTracks_cut.

The default value of the parameters (datamembers of the class) are specified below (file AlgoTracks.datacard).

```
A0Vert_cut=1.0(unitsinnm) B1TRHits_cut=5 S1StrrawWits_cut=10 NSiHits_cut=9 Ch12_cut=1.7 RecoEta_cut=1.5 pTleadTrack_cut=10.0 pTOtherTrack_cut=5.0or2.0(unitsinGeV) detRDtnerTrack_cut=0.4 NOtherTracks_cut=3
```

### Algorithm for building \(\tau_{1P}\)-object: AlgoTau1P

This algorithm starts from a collection of leading hadronic track and select only those for which there is no other accompanying tracks, NOtherTracks = 0. Such track becomes a seed for the \(\tau_{1P}\) object.

For each candidate calorimetric variables are calculated.

* The infomation of the energy deposition of all cells within space distance \(\Delta R<\texttt{RconeTrack\_cut}\) and with energy deposition above ETcellmin_cut is used.
* For calculating calorimetric variables entirely based on the energy deposition in strips (NStrips and WStrips) only strips with energy deposition above detaStrip_cut are used. For calculating NStrips only strips within distance in pseudorapidity smaller than detaStrip_cut are used (of course the basic \(\Delta R<\texttt{RconeTrack\_cut}\) condition has to be also fulfilled). The WStrips is calculated using all strips within RconeTrack_cut distance.
* The charged energy associated with a track is calculated from energy deposition in cells within the \((\Delta\eta,\Delta\phi)\) window is defined by dphiChrgEM_cut, detaChrgEM_cut for the electromagnetic samplings and by dphiChrgHAD_cut, detaChrgHAD_cut for the hadronic samplings.
* The neutral electromagnetic energy associated with a track is calculated from the remaining energy deposition in cells within the \((\Delta\eta,\Delta\phi)\) box of dphiHACL_cut, detaEMCL_cut and belonging to the first three layers of the electromagnetic calorimeter.

For each of the \(\tau_{1P}\)-objects given is also information on the index (in the original CBNT) of the true \(\tau\) (if applicable) and origin of the track guiding reconstruction of the \(\tau_{1P}\)-object.

The default value of the parameters (datamembers of the class) are specified below (file AlgoTau1P.datacard).

``` ETcellmin_cut0.1(unitsinGeV) ETstripmin_cut0.2(unitsinGeV) detaStrip_cut0.2(unitsinGeV) RecoTrack_cut0.4 dpiChrgEM_cut0.0375 detaChrgEM_cut0.0375 dphiChrgHAD_cut0.2 detaChrgHAD_cut0.2 dphiEMCL_cut0.2 detaEMCL_cut0.2

### Algorithm for building \(\tau_{Kine}\)-object: AlgoMCTruth

This algorithm starts from a collection of MC particles, selects true \(\tau\) particle and loop over its daughters. It accepts particles if they are in the pseudorapidity range \(|\eta|<RecoEta\_cut\). It calculates the bary-centre of the visible decay products, total transverse energy, bary-centre position and multiplicities of \(\pi^{0}\)'s, total transverse energy, bary-centre position and multiplicities of \(\pi^{\pm}\). For each \(\tau_{Kine}\)-object also given is information on the index (in the original CBNT) of the true \(\tau\).

The default value of the parameters (datamembers of the class) are specified below (file AlgoMC Truth.datacard).

RecoEta_cut 1.5

## Appendix B Packages used for reconstruction

We have used ATLAS Release 7.8.0 to perform reconstruction of the fully simulated events. The default parameters were used for XKalman track reconstruction and energy reconstruction in calorimetric cells. Information on reconstructed quantities were stored in the format of ROOT CBNT. We have used information from the default CBNT_Truth and CBNT_Track blocks have been used. In addition, two extensions have been introduced:

* The full cell map was stored in the CBNT.
* The track vicinity in each layer of the calorimeter was calculated and stored in the CBNT.

### The jobOptions.txt used for reconstruction with tauRec package

// jobOptions file for tau Reconstruction

!pplicationMgr.DLLs ++ { "tanRec" };

!pplicationMgr.Top1lg + { "tauBuilder/taulig" };

//---------------------------------------------------------------------- // Algorithms Private Options //---------------------------------------------------------------------- //tower Maxer sub-algorithms: //taulig.OutputLevel = 1;

!tamllg.tauTrackllgName = "tauTrack/trackllg":  tamllg.tauCelllgName = "tauCellInfo/cellllg":  tamllg.tauCalibratellgName = "tauCalibrateCell/calibllg": // if you don't want the jettype don't set this llgName //taulig.tauJetType1lgName = "tauJetType/jetType1lg":  tamllg.tauCelllgName = "tauUts/cutsllg":

// Name of cluster Container to pick up:  tamllg.ClusterContainer = {"CombinedCluster"};

// Name of Tau container to output:  tamllg.tauContainer = "MYtamContainer":

// parameters required by tauTrack algorithm:tracklig.TrackContainer = "Tracks_rKalman00"; // GeV-MeV tracklig.TrackPTmin = 2000.0; tracklig.TrackDist = 0.3;

// parameters for tanCalibrate

// parameters required by tauCellInfo algorithm: // GeV->MeV celllig.Cellthreshold = 200.0; celllig.StripEthreshold = 200.0; celllig.HMSumThreshold = 500.0; celllig.HMSumRadius = 0.2; celllig.cnsdr = 0.07; // isolation on tracks, inner cone celllig.cnsdr = 0.35; // outer cone

// Parameters required by tauCuts algorithm to select tan's // All tau candidates are kept: these are used only to set tau_accept to // provide basic tau acceptance.

 cutslig.RunTrackMin = 1; // Min. number tracks cutslig.RunTrackMax = 3; // Max. number tracks cutslig.ChargeMin = 1; // Min. net charge cutslig.ChargeMax = 1; // Max. net charge cutslig.HadronicFracMin = 0.1; // EThadronic/sumpt(tracks) cutslig.LikelihoodMin = -6.0; // Likelihood //cutsllg.MMLhRootFile = "/afs/cern.ch/user/h/heldmann/scratch0/Athena/7.6.0/\ Reconstruction/tauRec/tauRec-02-02-05/share/MMLh_nonoise.root"; // file to use for MH likelihood cutslig.MMLhRootFile = "MMLh_nonoise.root"; // file to use for MH likelihood Data samples used for the analysis

For some studies presented here we have used single particle samples, prepared for analysis of [8]:

* The 10000 \(\pi^{\pm}\) events at \(|\eta|=0.3\) and \(p_{T}=10\) GeV and 30 GeV. /castor/cern.ch/user/f/froid/dice03/
* The 13 000 \(\rho\to\pi^{\pm}\pi^{0}\) events at fixed \(E=50\) GeV and spanned over few \(\eta\) bins (rho50 sample) reconstructed from dataset /castor/cern.ch/atlas/project/dc1/simul/data/000002/dc1.000002.simul.000xx.eflow.eta_scan.zebra

The following physics events samples have been used:

* The 50 000 \(Z\to\tau\tau\) events (Ztautau sample) reconstructed from dataset 6 /castor/cern.ch/atlas/project/dc1/simul/data/002054/dc1.002054.simul.000xx.hlt.pyt_Z_tautau.zebra.

Footnote 6: The PYTHIA native \(\tau\) decays library have been used for \(\tau\) decay in this case only.
* The 30 000 \(W\to e\nu\) events (wtoenu sample), reconstructed from dataset /castor/cern.ch/atlas/project/egamma/simul/egamma.002510.pyt_w_enu.simul/data/egamma.002510.pyt_w_enu.simul._000xx.zebra
* The 110 000 dijet events with \(p_{T}^{hard}>35\) GeV (dijet35 sample), reconstructed from dataset /castor/cern.ch/atlas/project/dc1/simul/data/002039/dc1.002039.simul.000xx.hlt.pythia_jet_35.zebra
* The 98 000 \(qq\to qqH(\to\tau\tau\) events with one \(\tau\to e\nu,\mu\nu\) (vbfHtautau sample), reconstructed from dataset /castor/cern.ch/atlas/transfer/higgs/wisc/simul/higgs.002558.vbf_h130_2tau_lh.dc1.simul/data/higgs.002558.vbf_h130_2tau_lh.dc1.simul._00xxx.zebra Events were filtered for a presence of single lepton.