# Fake Level-1 Muon Trigger Rates in the ATLAS experiment

Aleandro Nisati

_I.N.F.N. and University "La Sapienza", Rome, Italy_

July 21, 1998

###### Abstract

The high background level expected in the Atlas experimental hall can contribute to the muon trigger rate by accidental coincidences of hits produced by background particles in the trigger counters. In this note we present an analysis made to evaluate the fake muon trigger rate as a function of the background level, the trigger transverse momentum threshold and the LHC luminosity; the study doesn't include the trigger rate of background hard charged particles expected in the cavern. The muon trigger system appears robust against the accidental coincidences even for a background level 10 times higher than that predicted by detailed MC simulation programs.

## 1 Introduction

The energy and the luminosity of the LHC are such that a large production of background particles is expected in the experimental hall. This background originates from the interaction of hadrons produced in pp collisions at large \(|\eta|\) values with the shielding, the very forward detectors of ATLAS and the machine elements, such as the beam pipe, the collimators, the pumps etc. The result of these interactions is mainly the production of neutrons that diffuse throughout the hall producing secondary particles when interacting with matter; in particular thermal neutrons are absorbed by nuclei with the emission of capture photons. The kinetic energy of these photons is in the range of 10-10\({}^{4}\) keV and they can produce signals in the gas chambers through the Compton electrons originating from the photon interaction with the detector gas or the chamber wall. Fast neutrons on the contrary produce hadrons when interacting with the material of the apparatus. A non negligible fraction of these particles is rapresented by charged particles such as pions, protons and muons. This background behaves as a "gas" of neutral and charged particles that diffuses throughout the cavern and through the apparatus with no time correlation with the bunch collisions. It induces high detector counting rates [1].

The ATLAS Muon System is particularly exposed to this background since the spectrometer is based on an open system. Therefore, particular care is needed a) to design an adequate shielding system in the very forward locations of the experiment to limit the diffusion of neutrons in the cavern and b) to design an adequate trigger (and tracking) system to cope with an unusual noisy environment.

In this note we analyse the rate of fake coincidences induced by the environmental background in the Level-1 Muon Trigger system of the ATLAS detector. The trigger rate induced by muons, pions and protons with energy sufficient to cross the muon trigger system is under study: all effects induced by the coincidence produced by these tracks are fully neglected in this analysis. However it should be mentioned that preliminary results on this study indicate that the trigger rate of these particles could be important, in particular for what the low-pr subsystem is concerned.

## 2 Muon Trigger Scheme

The barrel trigger system is composed of two independent subsystems the first located in the region \(z<0\) and the second in the region \(z>0\). Small and Large Sectors are made with 6 chambers for each half-barrel subsystem and for the three triggerstations. Each trigger station is then made with two single-gap RP C layers, both read-out in two orthogonal projections by conductive strips.

The strips are about 3 cm wide and about 150 cm long. The actual length depends on the trigger chamber position, the projection and the sector concerned; the detail are reported in LVL1 Trigger TDR [2].

There are three trigger stations, two separated by about 70 cm and placed in the middle of the barrel magnet (RP C1 and RP C2), and the last (RPC3) placed just outside the magnet; see fig. 1.

The forward trigger is made with TGC detectors; also in this case there are three trigger stations, TGC1 to TGC3; TGC2 and TGC3 are made with two detector layers, while TGC1 is made with three layers.

In figure 1 the basic muon trigger logic is also shown schematically.

Each strip in station RPC1, the called "pivot plane" is put in coincidence with a set of contiguous strips of station RP C2 in both projections; the size of the coincidence in the bending view defines the transverse momentum trigger threshold, while the size of the coincidence in the other view is made with a small number of strips (typically 3 to 4) and is used for track confirmation. In order to limit the random coincidences from the background hits and to ensure high detection efficiency of muons, a majority logic of 3-out-of-4 hits is required for the bending and the non-bending projection. This logic defines the so called "low-p\({}_{T}\)" trigger scheme since this logic allows the triggering of muons with p\({}_{T}\) in the range 5-12 GeV/c. The measurement of the two-coordinate hit position with a single sensitive gas gap has an impact on the fake trigger rate.

The high-p\({}_{T}\) algorithm is performed in two distinct steps: first the low-p\({}_{T}\) logic is applied with tight coincidence roads for the bending and the non-bending projection; subsequently the high-p\({}_{T}\) station is used in coincidence with the low-p\({}_{T}\) system: all RPC1 strips that satisfied the low-p\({}_{T}\) algorithm are put in coincidence with a set of contiguous strips of station RPC3. The coincidence logic is similar the low-p\({}_{T}\) trigger logic; the size of the coincidence window in the bending view determines the trigger p\({}_{T}\) threshold. In addition to the low-p\({}_{T}\) 3-out-of-4 demand, for the two layers of RPC3 1-out-of-2 hits is required, in both projections.

The trigger logic in the endcap system is quite similar to that of the barrel. The trigger stations TGC3 and TGC2 are used to perform the low-p\({}_{T}\) trigger. The high-p\({}_{T}\) trigger is obtained using also the trigger station TGC1. As in the barrel trigger the trigger requires spatial coincidences in two orthogonal projections. The entire system is located within a longitudinal space of about 160 cm, and is placed in correspondence of the middle forward muon station, just behind the endcap toroids.

The main difference between the barrel and the endcap trigger is the use in the endcap system of three detector layers in the high-p\({}_{T}\) station. The extra layer is read out only in the bending projection.

In order to identify the bunch crossing and to reduce the trigger rate of fake muons, a time coincidence among the trigger planes is also required. The time gate is described in some detail in the next section.

## 3 Trigger windows and coincidence time

Coincidence trigger windows have been evaluated for the barrel and the endcap for two trigger thresholds: p\({}_{T}^{thres.}\)=6 GeV/c and for p\({}_{T}^{thres.}\)=20 GeV/c. The muon trigger at low-p\({}_{T}\) is performed using only the low-p\({}_{T}\) system, RP C1 and RP C2 for the barrel; TGC2 and TGC3 for the endcap. On the contrary, for the high-p\({}_{T}\) trigger the full system is used.

The size of the coincidence windows have been

Figure 1: Muon trigger layout; simplifed scheme of the trigger algorithm.

defined with detailed detector and trigger logic simulation studies. The results are reported in the LVL1 Trigger TDR [2]. The windows used in the rate calculation program have been averaged over \(\phi\) and \(\eta\).

Detailed studies of the width of the effective coincidence time gate have been presented elsewhere, for both the barrel and endcap systems. The effective time gate \(\Delta t_{g\,at\,e}\) related for the barrel system is related to the frequency of the interpolator circuit (\(\nu_{nt\,nt}=3\,20\) MHz) used to give the clock to the trigger electronics. The simulation study performed [3] suggests the value \(\Delta t_{g\,at\,e}\)= 22 ns. The timing procedure for the endcap trigger system is rather different [4]. Each TGC signal produced generates a synchronous pulse that are one or two bunch crossing periods wide, depending on its delay \(\delta t_{TGC}\) with respect to the bunch crossing time: signals produced within a time \(\delta t_{TGC}\) are associated to pulses 50 ns wide, 25 ns in the other case. The study performed showed that full trigger efficiency with right bunch crossing identification is safely achieved with values of \(\delta t_{TGC}=5\) ns. This corresponds to an \(average\) value \(\Delta t_{gate}=31\) ns.

To conclude, a time gate of \(\Delta t_{g\,at\,e}\)= 22 ns has been used in the fake trigger rate calculation of the barrel system, while a time gate \(\Delta t_{gate}\)= 31 ns has been considered for the endcap system.

## 4 Background rates

The background flux and the physics detector counting rate has been evaluated with the FLUKA Monte Carlo program [5]. The results have been presented in several documents [6][7]. For the present study, the background rate and composition are these expected from the use of shielding layout TP32 [1].

The background can be classified in three classes, as follows:

* "Incoherent background"; background originating from the soft Compton electrons (E \(<\) 2 MeV) and neutron induced soft protons, produced in the chamber wall or in the gas of a detector cell and absorbed by the material of the same detection unit. This background does not introduce correlations among the hits detected in different muon chambers;
* "coherent background"; this background is composed of:
* Particles that can produce hits in two adjacent trigger counters (hard Compton electrons with energy above 2 MeV and soft protons). These particles are absorbed in less than 3 g/cm\({}^{2}\) of the typical material of the trigger counters. equivalent This background produces correlated hit patterns in the trigger chambers belonging to the same trigger station.
* Particles that can produce correlated hits also in more than one trigger station. Muons, pions and hard protons having a momentum of about 100 MeV, sufficient to cross not only neighbouring trigger planes, but traverse closely spaced trigger stations, such as the two doublets of the low-p\({}_{T}\) system. In this situation the particle can produce a hit pattern that simulates a muon trigger.

All hits induced by neutrons (detection sensitivity set to \(\epsilon_{n}=1.0\times 10^{-4}\)[8]) plus 90% of hits induced by photons (detection sensitivity \(\epsilon_{\gamma}=5.33\times 10^{-3}\)[8]) are assumed to be fully uncorrelated, i.e. none of the hits is produced in pair with another one. The remaining 10% of track induced by photons are due to electrons with kinetic energy sufficient to cross at least a trigger doublet [8]. These tracks, plus those produced by muons, pions, protons and electrons from other sources than capture photons (25% of the total electron yield [8]) are assumed to produce hit pairs (triplets) in the trigger doublets (triplets). These additional photons are produced by \(\pi^{o}\) decays generated in the hadronic cascades.

In section 5 the trigger rate induced by the incoherent and coherent background is presented, accounting for the correlations produced by hard electrons, muons pions and protons crossing the trigger planes belonging the same trigger station.

Table 1 shows the detector counting rate expected for the RPCs and for the TGCs that has been used in the present computation; the detector counting rate is averaged over the three stations of the trigger system.

As already stated in the introduction, the contribution to the trigger rate of the hard particles c) that cross with high probability at least the low-p\({}_{T}\) subsystem is totally neglected. A dedicated study is on the way. However, the contribution also of these particles to the fake coincidences rate is properly taken into account.

## 5 Trigger rate calculation

We simplified the trigger layout and logic assuming that each of the two systems is subdevided in projective towers. The tower dimension is given by the size of the muon trigger chamber designed for the station 1 for the barrel (160 cm \(\times\) 160 cm) and station 3 for the endcap system (150 cm \(\times\) 130 cm), the "pivot" plane. These values are the average of the muon chamber size in the barrel and in the endcap.

The dimensions of the second (and third) trigger plane, used in coincidence with the pivot plane, are determined by projecting the pivot plane from the nominal vertex position.

The calculation proceeds in three basic steps:

* calculation of the average detector counting rate f(k) for each trigger plane k (k up to 7); to calculate this rate the following formula has been used: \[f(k)=S(k)\times r(k)\times\Delta t\] (1) where S(k) is the detector surface of plane k and r(k) is its corresponding estimated background rate per unit of surface and time. \(\Delta\) t is the integration time, fixed to \(\Delta t\)= 22 ns for the barrel and 31 ns for the endcap trigger. The average detector counting rate, estimated considering the background level presented in Table 1, is about 5\(\times\)10\({}^{-3}\): even for a background level 10 times higher than the predicted one the average detector occupancy would be much below 1.
* given a hit multiplicity configuration \(n_{i}\), (where i goes from 1 to 7 and \(n_{i}\) assumes all positive integer values starting from 0) calculate the probability \(P_{trg}(n_{1};n_{2};...;n_{7})\) that such a configuration produces a trigger, assuming an uniform distribution of the hits on the detector surface; this probability accounts only for geometrical parameters such as the size of the coincidence windows and the size of the trigger tower, and includes also the combinatorial effects present when at least one trigger plans has more than one hit recorded. Example: in case of pure incoherent background, the trigger probability for the low-pt system is: \[P_{trg}(n_{1},...,n_{4})=\] \[(W_{b}/L_{b})(W_{n}/L_{n})(W_{lb}/L_{b})(W_{ln}/L_{n})\] \[\times(n_{1}n_{2}n_{3}+n_{2}n_{3}n_{4}+n_{3}n_{4}n_{1}+n_{4}n_{1}n_{2})^{2}\] (2) where:
* \(W_{b}\) is the size of the coincidence window on station 2 in the bending projection;
* \(W_{n}\) is the size of the coincidence window on station 2 in the non-bending projection;
* \(W_{lb}\) is the size of the local coincidence window in the bending projection;
* \(W_{ln}\) is the size of the local coincidence window in the non-bending projection;
* \(L_{b}\) is the size of the trigger tower seen in the bending projection;
* \(n_{1},...,n_{4}\) represents the hit multiplicity in planes 1 to 4; The term \((W_{b}/L_{b})(W_{n}/L_{n})(W_{lb}/L_{b})(W_{ln}/L_{n})\) gives the trigger probability for a set of three random hits on 4 trigger layers; the term \((n_{1}n_{2}n_{3}+n_{2}n_{3}n_{4}+n_{3}n_{4}n_{1}+n_{4}n_{1}n_{2})\) gives the number of all possible sets of three-hits in ONE projection that is possible to define with \(n_{1},...,n_{4}\) hits available on the 4 trigger layers. The square of this term is justified by the required trigger in both projections. In the calculation the probability of having more than one trigger by a given configuration is neglected; therefore the present analysis tends to overestimate the trigger rate, although the effect is small because the low detector occupancy.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline  & \(n\) & \(\gamma\) & \(\mu,\pi,p\) & \(e\) & incoh. & coherent \\ \hline RPC & 0.30 & 5.4 & 1.6 & 1.8 & 5.2 & 3.9 \\ \hline TGC & 0.30 & 4.5 & 3.6 & 2.0 & 4.3 & 6.1 \\ \hline \end{tabular}
\end{table}
Table 1: background counting rates, in Hz/cm\({}^{2}\), obtained with the FLUKA MC program assuming the the shielding layout “TP 32”. The luminosity is \(L=10^{34}cm^{-2}s^{-1}\).

* the probability \(P_{cnf}(n_{1};n_{2};...;n_{7})\) that a given hit configuration occursi is: \[P_{enf}(n_{1};n_{2};...;n_{7})=\prod_{j=1}^{7}e^{-f(j)}\,f(j)^{n_{j}}\,/n_{j}!\] (3)

The trigger probability \(\mathrm{Tp}_{1}\) for ONE tower within a time gate \(\Delta t\) is given by the sum of trigger probability \(P_{trg}\) for each configuration weighted by the probability \(P_{cnf}\) of observing the given hit multiplicity, plane by plane:

\[Tp_{1}=\sum_{n_{1}=1}^{n_{1}=n_{max}}\ldots\sum_{n_{7}=1}^{n_{7}=n_{max}}P_{ trg}(n_{1};n_{2};...;n_{7})\times\\ \times P_{cnf}(n_{1};n_{2};...,n_{7}) \tag{4}\]

From the mathematical point of view, \(n_{max}\) must go up to \(n_{max}=\infty\); in practice the calculation with the present background rates uses \(n_{max}=7\); for higher values the change in the results is negligible, while the time needed to perform the calculation increases drastically.

The trigger rate in the full subsystem is given by multiplying the single tower trigger probability \(Tp_{1}\) by the number of towers \(N_{tow}\) in the subsystem. This is a good approximation when the \(T\,p_{1}\) is very small; more generally, the trigger rate is obtained through the relation:

\[T\,p=1-exp(-Tp_{1}\times N_{tow}\,) \tag{5}\]

The ratio \(Tr=T\,p\!/\,\Delta t\) gives then the trigger rate.

### Trigger rate induced by coherent background

The calculation of the trigger rate induced by the coincidence of hits produced by soft tracks and hard tracks is performed as follows. In the rate calculation program this is performed assuming full correlation of hits associated to a penetrating track for a given muon station. This effect increases the trigger probability \(P_{trg}\). In the trigger rate calculation, the coincidence of coherent hits with any other background hit has been considered (accounting for the required majority logic). The trigger rate due to the coherent noise is much larger than the rate due to pure incoherent background. However, with this approach, the trigger rate due to hard tracks crossing more than one trigger station is not taken into account. The evaluation of this effect needs information about the origin and momentum in space of these tracks. A full simulation of the geometry, chamber materials and the magnetic field effects is needed to evaluate the trigger probability. This analysis is in progress.

### Trigger rate calculation for the barrel system

The trigger rate calculation in the barrel is performed considering up to 6 detection planes in the trigger system (three doublets). Two different solutions have been compared for the majority of the external doublet: an OR logic, against an AND logic.

Although the AND coincidence is expected to give better results on the rate performance, it should be stressed that the OR solution is the one that gives detection redundancy and hence higher efficiency on signal detection and better system reliability; furthermore, this is nominal operation mode of the trigger system.

### Trigger rate calculation of the endcap system

The endcap trigger system is very similar to the one of the barrel with the difference that the high-\(\mathrm{p}_{T}\) station is made of three individual layers (two in the barrel): all are used in the trigger in the bending view and only two in the transverse view. According to this setup, a 2-out-of-3 majority logic is used in the main view while a trigger logic of 1-out-of-2 in the \(\rho-\phi\) view.

In the program developed, the effect of this particular trigger scheme is described as follows. For physics noise rate made in equivalent fraction of coherent an incoherent background, in consideration of the small size of the coincidence windows and the tight integration time, the trigger rate is dominated by coincidence induced by coherent background for the 2-out-of-3 majority, while the full background counts for a 1-out-of-2 majority logic. As a consequence, the trigger rate is expected to be the sum of the rate induced by the coherent background and that induced by the coincidence of the of the trigger in the bending view, caused by coherent back ground, and the trigger in the other view, induced by twice the incoherent background.

Mathematically:

\[Tr=Tr_{c1}\times(1+2L_{1}L_{2}r_{in\,c}\Delta t) \tag{6}\]

where \(L_{1}\) and \(L_{2}\) are the dimension of the trigger tower, and \(r_{in\,c}\) is the incoherent background rate, all this evaluated in the high-p\({}_{T}\) trigger station. \(Tr_{c1}\) is the trigger rate induced by the coherent background in the high-p\({}_{T}\) station.

### Trigger rate calculation of the high-p\({}_{T}\) system

In the calculation of the trigger rate expected from the high-p\({}_{T}\) subsystems (for both barrel and endcap) the coincidences of prompt muon with background hits are also considered. A conservative "accept" rate of 25 (30) kHz of the barrel (endcap) low-p\({}_{T}\) subsystem has been assumed when the system is used to trigger on muons with p\({}_{T}\) = 20 GeV/c threshold. This effect introduces a linear dependence of the fake trigger rate on the background flux and a quadratic dependence on the luminosity.

### Results

Figure 2 compares the accidental trigger rate (assuming the nominal background level and the same boosted by a factor 5 and 10) with the rate expected from prompt muons (semileptonic decays of beauty and charm hadrons, plus in flight meson decays) as a function of luminosity; both barrel and endcap have been studied.

The dominant contribution given to the fake trigger rate is due to the coincidence of a hit-pair in one of the two stations, produced by a penetrating charged particle, with (at least) one hit deposited in the other stations that originates by soft and hard particles.

## 6 Conclusion

The muon trigger system design can cope with the accidental coincidences induced by the high background level expected in the ATLAS cavern. Even in case of a background level 10 times larger than the predicted one, the fake muon trigger rate is at most comparable with the rate of genuine muons, thus allowing a safe operation of the trigger system.

However, the complete understanding of the background effects on the muon trigger rate needs the analsyis of the trigger rate of muons pions and protons of high energy that are present in the Atlas hall.

## 7 Acknowledgements

The understanding of the background predicted in the Atlas experimental hall and of the possible implications on the muon trigger performance is the results of the work done in collaboration with many colleagues, in the trigger and in the muon groups, that I thank very much for their suggestions, remarks and encouragement.

In particular I'd like to thank Alfredo Ferrari for the studies he made paying attention to the muon trigger problems.

## References

* [1] ATLAS MUON TDR, CERN/LHCC/97-22, 31-May-1997.
* [2] ATLAS LVL1 TDR, CERN/LHCC/98-14, 30-June-1998.
* [3] A. Nisati, "Preliminary Timing Stdies of the Barrel Muon Trigger System", ATLAS Internal Note DAQ-NO-083.
* [4] O. Jinnouchi and O. Sasaki, "Study on muon level-1 trigger scheme for TGC", ATLAS Internal Note DAQ-NO-082.
* [5] A. Fasso' et al., Proc. IV Int. Conference on Calorimetry and their applications, World Scientific, Singapore (1994) p. 493.
* [6] G. Battistoni et al., "Background Calculations for the Atlas Detector and Hall", ATLAS Internal Note GEN-NO-010.
* [7] A. Ferrari and P. Sala, ATLAS Internal Note MUON-NO-090.
* [8] A. Ferrari, private communication.