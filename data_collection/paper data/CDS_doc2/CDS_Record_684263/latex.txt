**Signal Reconstruction in Module 0 of the End-Cap Electromagnetic Calorimeter and Presampler**

**P. Barrillon, F. Djama, L. Hinz, P. Pralavorio**

_CPPM,_

_163, Avenue de Luminy,_

_Case 907,13288-Marseille, France._

Abstract

This note describes signal reconstruction of the EMEC module 0. Two approaches have been tried to derive optimal filtering coefficients. The first one uses an electrical model of the signal path (detector-preamplifier-shaper) while the second approach is based on _ad-hoc_ functions. The pros and the cons of each approach are discussed, and effects of the optimal filtering on noise and energy resolution are shown.

[MISSING_PAGE_EMPTY:2]

Introduction

The EMEC module 0 has been built and tested under electron beam in 1999. During data taking, samples are collected from each channel at a 40 MHz frequency. A given number of these samples are used to reconstruct the maximum of the response shape, which is proportional to the energy seen by the considered channel. This technique, called optimal filtering [1], allows to minimize electronic noise which affects the reconstructed signal.

Using this method, energy and time phase are given by linear combinations of samples collected around the trigger signal :

\[E=\sum_{i=1}^{n}a_{i}\,S_{i}, \tag{1}\]

and

\[E\Delta t=\sum_{i=1}^{n}b_{i}\,S_{i} \tag{2}\]

where \(E\) and \(\Delta t\) are the energy and the time phase, \(S_{i}\) sample values (in ADC unit, after pedestal subtraction), and \(a_{i}\) and \(b_{i}\) are the optimal filtering parameters. \(n\) is the number of the used samples and has been fixed to 5.

Details of \(a_{i}\) and \(b_{i}\) determination can be found in [1]. Here, we should recall that to perform such a computation, we need an analytical parametrization of the response both to calibration and electron signals. Two approaches have been tried and are discussed in this note.

Shape reconstruction is described in section 2. Electrical model approach and _ad-hoc_ function approach, their advantages and problems are discussed in sections 3 and 4. Section 5 is devoted to noise and energy resolution performances with optimal filtering. Future prospects are summarized and conclusions are drawn in section 6.

## 2 Shape reconstruction

### Calibration shapes

Special calibration runs, called delay runs have been taken. The input calibration signal amplitude was fixed, and the delay value was varied from 0 to 24 ns. 100 triggers were taken at each delay value. Using 5 samples of each trigger, the signal shape was reconstructed over 125 ns for all the channels. Figure 1 shows the 2 shapes (one for each gain) of one channel.

When the input calibration signal is zero, the system response is not. This is due to the signal generated by the command itself. This zero-response has been reconstructed for each channel, and subtracted from the calibration shapes.

### Physics shapes

Since physics runs in beam tests are asynchronous, physics pulse shape can be reconstructed naturally, by plotting the 5 samples of each trigger, in their time phase bin. The time phase is measured by a TDC as the difference between the trigger time and a 40 MHz clock.

Depending on beam energy, the position of the cell in the cluster, and its sampling, physics shapes are distorted by cross-talk. To minimize this effect, only highest beam energy available runs were used, and shapes of the most external cells in the cluster were not considered. \(\phi\) symetry was assumed where no shape could be reconstructed.

Figure 2 shows physics shapes for one channel.

## 3 Electrical model

### analytical formulae

The first attempt to find an analytical function for pulse shapes consist in building an electrical model of the detector-preamplifier-shaper system, and to compute its response for calibration or electron signals. The transfer functions of each of these components are listed below:

* The electrical model of one channel is shown in figure 3. Thus, the transfer function of the detector is :

Figure 1: Reconstructed calibration shapes in delay runs.

\[H_{det}^{ca\,l}(s)=\frac{1+s^{2}L\,C}{1+sRC+s^{2}L\,C}\] (3) for calibration and \[H_{det}^{phys}(s)=\frac{1}{1+sRC+s^{2}L\,C}\] (4) for physics. \(s=j\omega\) is the complex frequency and \(R\), \(C\) and \(L\) are defined in figure 3.
* The preamplifier transfer function can be approximated by [2] : \[H_{pa}(s)=\frac{1}{1+sRC}\] (5)
* The transfer function for a CR RC\({}^{2}\) shaper is given by [2] : \[H_{sh}(\,s)=\frac{\tau\,s}{(1+s\tau)^{3}}\] (6)

Figure 2: Reconstructed physics shapes.

where \(\tau\) is the shaping time, and is equal to \(15\)_ns_[3].
* The triangular shape of the physics signal is given in the frequency domain by: \[H_{\mathit{ph}\mathit{y}\mathit{s}}(s)=\frac{e^{-\mathit{s}\tau_{d}}-1}{s^{2} \tau_{d}^{2}}+\frac{1}{s\tau_{d}}\] (7) where \(\tau_{d}\) is the drift time. The drift time varies from 200 to 600_ns_ with pseudorapidity [4].
* The exponential shape of the calibration input signal, expressed in the frequency domain is given by : \[H_{\mathit{calib}}(s)=\frac{\tau_{c}(1-f)}{1+s\tau_{c}}+\frac{f}{s}\] (8) where \(\tau_{c}\) is the calibration signal decay time (\(\tau_{c}=360\mathit{n}\mathit{s}\)), and \(f\) accounts for the small resistive component of the output inductance of the calibration chip (\(f\sim 0.10\)) [5].

Figure 3: Electrical model for calibration and physics. \(R_{\mathit{inj}}\) are the injection resistors for calibration, \(C\) and \(L\) the cell capacitance and inductance, and \(R\) the characteristic impedance of the readout cable. (\(50\Omega\) for presampler and sampling \(1,\ 25\Omega\) elsewhere.)

The response pulse shape to calibration \(f_{cal}\) and to physics \(f_{ph}\) are:

\[f_{cal}(t)=L^{-1}[H_{cal}(s)H_{det}^{cal}(s)H_{pa}(s)H_{sh}(s)], \tag{9}\]

\[f_{ph}(t)=L^{-1}[H_{phys}(s)H_{det}^{phys}(s)H_{pa}(s)H_{sh}(s)] \tag{10}\]

where \(L^{-1}\) is the inverse Laplace transform. Complete analytical formulae for \(f_{cal}\) and \(f_{ph}\) were obtained from the XMAPLE software [6].

### Fits and results on calibration shapes

Calibration pulse \(f_{cal}(t)\) has been fitted to all the calibration shapes [7]. For each channel, the two gains shapes were fitted simultaneously, and only \(C,\,L,\,\Delta_{m}t,\,A_{m},\,\Delta_{h}\,t\) and \(A_{h}\) were free during the fit. \(\Delta_{m/h}t\) and \(A_{m/h}\) are the pulse starting time and the amplitude of the shape, for the medium and the high gain.

Figure 4 shows the fit result for a typical channel and its residuals. The residuals are kept well below 0.5 % except in the begining of the pulse. This region is not reproduced by our

Figure 4: Reconstructed calibration shape and its fit with the electrical model function (a), and residuals of the fit(b).

electrical model. The residual pattern suggests that this difference may come from reflections in the signal path [8].

A model with reflections has been used to compute another analytical formula, but the fit converges hardly, due to the number of unknown parameters of the electrical path, left free in the fit. This model has been put aside, at least for module 0 analysis. Further measurements of the reflection parameters are foreseen and will be used for the ATLAS modules.

Since there is always one sample situated in the begining of the pulse, optimal filtering parameters computed with this method were not used in the analysis. A more pragmatic approach was used (section 4).

However, the simple electrical model without reflections was found sufficiently precise for fitting the electrical parameters. Figure 5 shows the good agreement between fitted and measured capacitances and inductances of two \(\phi\) rows (one in middle and one in the back sampling) against \(\eta\). The additional 15 nH fitted for the inductance are understood as the mother board contribution. The 4-channel-period pics in middle inductance, understood as insufficient grounding are clearely visible in the fitted inductances. Anti-correlation between \(L\) and \(C\) during the fit may explain the other discrepancies.

Strip measurements were not available. The fitted capacitance values for strips were found to be about 2 times the expected detector capacitance, with an inductance of about 10 nH.

Figure 5: Fitted values of capacitance (a and b) and inductance (c and d) for a \(\phi\) row in sampling 2 and 3, compared to measured values. Measurement have been performed without mother boards.

### Fits on physics shapes

Injecting, the \(C\) and \(L\) fitted from \(f_{cal}(t)\) into \(f_{phys}(t)\), and fitting the later to physics shapes with three free parameters (\(\Delta t\), \(A\) and \(\tau_{d}\)) shows the same difficulty to reproduce the signal rising edge, as in calibration (figure 6). Meaningless \(\tau_{d}\) values have also been obtained. As for calibration, electrical model has not been used for physics shapes.

## 4 _Ad-hoc_ function approach

Given the problems of the electrical model approach, a new method has been tried. It requires only a function that fits shapes, regardless to its physical meaning.

For calibration shapes, the shapes themselves were tabulated as functions and used to compute derivatives. The obtained discrete functions and derivatives were used to compute optimal filtering parameters. This method may be improved by smoothing techniques.

For physics shapes, sigmoid sums were fitted to data, using neural network technique [9]. Figure 7 shows the fit result for one channel. Optimal filtering parameters were computed using these sigmoid functions.

Bad fits may occur when the obtained function follows too closely shape fluctuations. These fluctuations may cause also inflexion points. Such bad fits had to be redone after

Figure 6: Reconstructed physics shape and its fit with the electrical model function (a), and residuals of the fit(b).

changing the numbers of neurons and learning epochs.

Physics shapes of the back sampling were distorted by cross-talk. For each \(\phi\) row, the less distorded shape was selected for optimal filtering parameter computation. \(\phi\) symetry was assumed for the other channels.

## 5 Optimal filtering performance

Noise reduction is shown in figure 8. A 2.2 noise reduction factor (for a \(\Delta\eta\) x \(\Delta\phi=3\) x 3 cluster) is obtained while replacing the parabola algorithm by optimal filtering.

Finally, figure 9 shows a comparison between the time phase dependance of the measured energy between parabola and sigmoid algorithms. For energies higher than 50 GeV, there is a residual time dependence coming from the back sampling, which has poorly known shapes.

## 6 Conclusions

Several approaches have been used to parametrize the calibration shapes. Sensitivity to reflections prevented a useful electrical modelization. Measurements should be carried out in

Figure 7: Reconstructed physics shape and its fit with sigmoid sum function (a), and residuals of the fit(b).

Figure 8: Random events energy with the on-line parabola algorithm and with optimal filtering.

Figure 9: Time phase dependence of energy with the on-line parabola algorithm and with optimal filtering.

order to understand and modelize reflections along the electrical path. Tabulation of delay run shapes were used.

Physics pulse parametrization suffers also from reflections. Sigmoid functions have been successfully used to fit physics shapes and derive optimal filtering weights. The difficulty of having undistorded physics shapes for all channels will lead us to investigate methods which rely on delay shapes to predict physics pulses [10].

## References

* [1] W. E. Cleland and E. G. Stern, Nucl. Instrum. Methods A 338 (1994) 467.
* [2] R. L. Chase, Ch. de La Taille, J. P. Richer, N. Seguin-Moreau, ATLAS Internal Note LARG-NO-10 (1995).
* [3] J. Collot, D. Dzahini, Ch. de La Taille, J. P. Richer, F. Lugez, J. Pascual, J. Teiger, ATLAS Internal Note LARG-NO-92 (1998).
* [4] ATLAS Collaboration, Liquid Argon Calorimeter Technical Design Report, CERN/LHCC/96-41 (1996).
* [5] Ch. de La Taille, private communication.
* [6] XMAPLE6, Waterloo Maple Inc.
* [7] F. Djama, talk given at a beam test analysis meeting, CERN, February 22, 2000.
* [8] W. E. Cleland, talk given at a beam test analysis meeting, CERN, February 22, 2000.
* [9] B. Mansoulie and J. Schwindling, Using Multi Layer Perceptrons in PAW, [http://schwind.home.cern.ch/schwind/MLPfit.html](http://schwind.home.cern.ch/schwind/MLPfit.html)
* [10] L. Neukermans, P. Perrodo, R. Zitoun, ATLAS Internal Note ATL-LARG-2001-008 (2001). L. Kurchaninov, Signal Reconstruction in HEC, talk given at the ATLAS Lar Signal Reconstruction Workshop, CERN, July 6, 2001. W. E. Cleland, Method to Transform Calibration Pulse to Physics Pulse, _idem_.