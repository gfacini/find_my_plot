###### Abstract

The delay chip is an ASIC developed to precisely adjust signals within the range of 0-24ns in steps of 1ns. In this note, we report the study of the characteristics of this chip like the linearity and the jitter. We describe the influence of temperature and supply voltage on its behavior. Finally, we study its dependency due to the variations in process on a whole production.

ATLAS Internal Note

november 2003

**ATLAS calibration delay chip study**

Massol N., on behalf of the LAPP calibration group

17th November 2003

Laboratoire d'Annecy-le-Vieux de Physique des Particules, IN2P3-CNRS, Annecy-le-Vieux

Introduction

To avoid any timing misalignment between the signals coming from different locations in the detector, the liquid argon community uses an ASIC to adjust timing [1]. This chip is able to generate precisely delayed signals within the range of 0-24ns in steps of 1ns. It contains four independent delay channels which can be individually programmed via an I2C interface. It is developed in a rad-hard technology (DMILL) to be soldered on the calibration board [2].

We need about 300 chips chosen among 570 chips to get the best ones. That is why it is necessary to develop an automatic procedure to qualify them. We would like to characterize all the chips to know if they work well and to sort them. The first part of the study concerns the measurements of the main parameters. It details the dependence of the chip with temperature and supply voltage. The second part deals with the main results of the production tests.

## 2 Delay chip characterization

### Test bench setup

We have defined a test bench setup (as shown in figure 1) to qualify the delay chip and to obtain an automatic procedure for the production tests.

Figure 1: _Test bench setup to qualify the delay chips. The test board includes a local oscillator at 40MHz which synchronizes the DLL, and an FPGA which synchronizes the calibration pulse with the clock signal and which multiplexes the four channels on the delay chip._

All the hardware we need is given below:

* a custom test board to study a delay chip one at a time,
* a VME crate with a board to generate a calibration pulse of 5V amplitude (independently of the delay chip supply voltage) and a board to address and load the chip with a delay value,
* a VME interface to drive the crate by a PC,
* an oscilloscope to receive the signals and to measure the significant parameters,
* a PC with LabVIEW to control the acquisition and to analyze the data.

With such a test bench, we are able to test the whole chip automatically as the four channels are multiplexed.

### Measurement principle

We are essentially interested by the delay value, the linearity and the jitter. We measure the time between the calibration pulse and the signal at the delay chip output with the oscilloscope. The measurement is made at the middle (2.5V) of the rise-time for both input and output signals. For one channel and one delay value selected on the chip, we send 1000 triggers and the oscilloscope calculates the histogram. An example is given in figure 2.

Figure 2: _Measurement principle of the delay characteristics with an oscilloscope. On the screen, we can see the input and output signals with the corresponding histogram._

We extract the measured delay and the jitter coming from the chip. Then we plot the measured delay versus the selected delay value (an example is given on the left plot in figure 3) to know the real delay step and the linearity of the circuit.

The first basic level of circuit rejection concerns the selected delay values which do not work (any delay). The next step is the calculation of the linear fit to extract the intercept and the slope which are relevant parameters to compare the chips. We study the residuals to verify the linearity of each channel and to know if the measurements are reproducible. In the same time, we plot the intrinsic RMS jitter for each programmed delay value to determine a possible dependence (as shown on the right plot in figure 3). For the jitter, the best performances are obtained in a synchronous mode between the calibration pulse and the clock signal (as shown in figure 1). In an asynchronous mode, we measure systematically a jitter above 100ps.

### Results

#### 2.3.1 Stability in time of the main parameters

This section sums up the results at a given temperature (18\({}^{\circ}\)C, which is the nominal value of the cooling circuit [4]) and at the nominal supply voltage

Figure 3: _On the left plot, measured delay value versus programmed delay value for the four channels of one chip. On the right plot, jitter coming from the delay chip versus programmed delay value._

(5V). For about ten circuits, we have studied the stability in time of their main parameters. The goal was to know if their characteristics are stable and reproducible. Figure 4 shows ten measurements of these parameters for the four channels of one chip.

Whatever the channel, the stability concerning the intercept and the slope is better than 0.02%. We can notice (from top plots in figure 4) that inside a chip, the slope and the intercept are different for each channel. This dispersion can reach several percents, which probably implies to calibrate each channel if we hope to make precise measurements. Concerning the jitter, it is stable at better than 1%. To determine if the method used here is reliable, we can study the bottom-left plot of figure 4. For each measurement, we extract the maximum value of the residues (after the fit calculation) and we plot the difference between the current value and the first one. We obtain a variation of residues of about 5ps. This excellent stability is the proof of the setup and the method quality.

Figure 4: _Stability in time of the main parameters at a given temperature and supply voltage: intercept, slope, jitter, residue variation._

#### 2.3.2 Study with temperature

Ten chips have been tested between 18 and 40\({}^{\circ}\)C by steps of 1\({}^{\circ}\)C, at 5V, to quantify the parameter dependence with temperature and to determine if their behavior is stable and reproducible from one chip to another. To achieve these measurements, we used a dedicated temperature chamber as shown in figure 5.

The acquisition is outside the chamber to avoid the temperature variations on it. On the test board, the oscillator frequency has been measured at several temperatures to verify its stability. Moreover, we have tested the delay chip with an external clock. In this configuration, only the delay chip was influenced by the temperature variations. The results are similar in all configurations.

The temperature chamber offers a regulation to \(\pm 0.1^{\circ}\)C and reaches a good stability after 20 minutes. It is remotely controlled by a PC to have an automatic test. Indeed, the whole test takes about 24 hours! The principle is to select one temperature, then to wait for the stabilization and finally to start an acquisition before programming the next step (as shown in figure 6).

Figure 5: _Setup to study the delay chip with temperature. The test board is shown inside the temperature chamber and the acquisition (VME crate, oscilloscope, PC) is outside. The room is air-conditioned at 21\({}^{\circ}\)C._Whatever the chip, the intercept has a linear dependence of 20ps/\({}^{\circ}\)C as shown in figure 7.

Concerning the slope and the jitter, the situation is more complex (as shown in figure 8). We observe two modes which depend on a temperature threshold. Before this threshold, the slope has a linear dependence of 0.4%/\({}^{\circ}\)C and the jitter is constant, whatever the delay value. After this threshold, we observe a kind of saturation for the slope and an increasing jitter with temperature and with programmed delay value. The jitter average on the 25 delay values can vary by a factor 5 between 18 and 40\({}^{\circ}\)C, depending of the temperature threshold (as shown in table 1).

Figure 6: _Temperature steps used for the whole test of a chip. The right plot is a zoom of the temperature regulation which shows the stability after the transient state._

Figure 7: _Intercept variation with temperature. The behavior is the same whatever the channel and whatever the chip._

We can notice from table 1 that the temperature threshold varies with the chip. The lower the temperature threshold, the higher the jitter. We can't work with circuits having a too high intrinsic jitter and/or having a jitter depending on the programmed delay value. The chip must not be the dominant source or a fluctuating source of jitter compared to the other circuits of the calibration chain. To have an order of magnitude, the chip TTCrx has typically a clock jitter around 30ps (as shown in the note [3]). This constraint implies to work under the temperature threshold to obtain a constant jitter. Of course, the regulation temperature in the future crate must be as low as possible to have enough chips working in this mode. On the other hand, in these conditions we know that both slope and intercept vary linearly. That is the reason why the temperature must be very well regulated.

\begin{table}
\begin{tabular}{c|c|c} \hline \(\mathbf{N}^{\circ}\)**chip** & **average jitter (ps) at 18 and 40\({}^{\circ}\)C** & \(\mathbf{T}^{\circ}\)**threshold (\({}^{\circ}\)C)** \\ \hline
**38** & 10 - 47 & 19 \\
**101** & 10 - 23 & 33 \\
**190** & 10 - 39 & 29 \\
**267** & 10 - 36 & 25 \\
**457** & 10 - 29 & 31 \\ \hline \end{tabular}
\end{table}
Table 1: _Average jitter of five delay chips at 18 and 40\({}^{\circ}\)C, and temperature threshold of five delay chips._

Figure 8: _Slope and jitter variations with temperature. For the jitter, each point is the average on the 25 delay values of a given channel. Two operation modes can be observed._

#### 2.3.3 Study with supply voltage

Five chips have been tested at 4.5V, 5V and 5.5V. In this case, the temperature was not monitored. The goal is to find a possible optimal value concerning the supply voltage because on the calibration board, the delay chip has its own regulator. We extract always the same parameters (slope, intercept and jitter) in the same manner. The five chips have roughly the same behavior (uncertainty due to the non-monitored temperature). The intercept has a linear variation of -0.6ns/V and the slope has a linear variation of -6%/V. About the jitter, the results are shown in table 2.

At 5V and at room temperature, one chip has a jitter which increases with the programmed delay value. Four others have a constant jitter. At 4.5V, on the contrary, all chips become bad, especially for the big delay values. But all chips become again correct at 5.5V, the one which is bad at 5V included. We obtain again a constant jitter around 10ps. That is why if too many chips seem to be bad at room temperature, a solution could be to increase slightly the supply voltage to improve the characteristics.

## 3 Production tests

The observations described in the previous part led us to test the whole production in a monitored environment. 539 chips have beeen tested at three temperatures in the oven and the supply voltage was well regulated at 5V. The test at a defined temperature allows us to compare the chips between them in the same conditions. Moreover, with three temperatures, we are able to verify the chip dependence with this parameter.

First of all, we reject the chips having a problem like a dead channel, an impossible loading value, or an overcurrent. Secondly, we eliminate during

\begin{table}
\begin{tabular}{c||c|c|c} \hline \(\mathbf{N^{\circ}}\)**chip** & **4.5V** & **5V** & **5.5V** \\ \hline  & \multicolumn{3}{c}{Jitter (ps) at 0ns and 24ns} \\ \hline
**38** & 10 - 60 & 10 - 52 & 09 - 10 \\
**101** & 10 - 31 & 10 - 11 & 09 - 10 \\
**190** & 10 - 49 & 10 - 11 & 09 - 11 \\
**267** & 09 - 43 & 10 - 12 & 09 - 11 \\
**457** & 09 - 40 & 09 - 11 & 09 - 10 \\ \hline \end{tabular}
\end{table}
Table 2: _Jitter of five delay chips for different supply voltages, with a programmed delay value of 0ns and a programmed delay value of 24ns._acquisition the chips having a jitter value above 20ps, whatever the temperature. The table 3 indicates the number of rejected chips for each temperature. In fact, we expect a constant jitter around 10ps, and we have seen that a higher value was a sign of dependence of this jitter with the delay value. The table 4 summarizes the chips repartition. To be considered as "functional", the chip must succeed the selection criteria on the jitter for the three temperatures.

Among the 412 functional chips, we must select about 300 chips to cover all the calibration boards and the spares. On the one hand, we sort on the slope dispersion between the channels of the same chip. The distribution of this dispersion is shown in figure 9.

The maximum dispersion reaches 5.5% for

\begin{table}
\begin{tabular}{c||c|c|c} \hline
**Total** & **defective** & **bad jitter** & **functional** \\ \hline
539 & 23 & 104 & 412 \\ \hline \end{tabular}
\end{table}
Table 4: _Chip repartition into the different categories._

Figure 9: _Distribution of the slope dispersion between the channels of a same chip concerning the 412 functional chips (only the dispersion lower than 10% is shown)._

\begin{table}
\begin{tabular}{c||c|c|c} \hline
**Total** & **18\({}^{\circ}\)C** & **21\({}^{\circ}\)C** & **24\({}^{\circ}\)C** \\ \hline
104 & 57 & 15 & 32 \\ \hline \end{tabular}
\end{table}
Table 3: _Number of rejected chips due to an excessive jitter value (\(>\)20ps) classified by temperature._the 300 best chips. We can notice that 10 chips have a slope variation above 10%. On the other hand, we sort on the average slope of the four channels to match the chips two by two. This is to obtain a calibration board roughly homogeneous because we need two delay chips per board. The figure 10 shows that the slope values distribution is approximately the same for the four channels.

Unfortunately, we notice that the dispersion between chips is very big with a maximum of 16% for several chips. This is probably due to the variations in the fabrication process which modify the properties of integrated circuit components. The slow variation of parameters over the wafer can explain the tails in the distributions.

The intercept value is not a sensitive parameter to select and to sort the chips. Indeed, the figure 11 shows that the four channels are homogeneous. The RMS of these distributions is about 200ps. The impact of this dispersion on the programmed delay value is negligible compared to the slope dispersion.

All the characteristics (jitter RMS and peak to peak, slope, intercept) are

Figure 10: _Slope values distribution of the four channels at 18\({}^{\circ}\)C concerning the 300 selected chips._

saved in a database which give the possibility to analyse the chips easily and to keep the information for later.

## 4 Conclusion

The delay chips are used to align the calibration signal with respect to the physics signal. The timing misalignment has an effect on both the reconstructed energy and the energy resolution as shown in figure 10-20 of reference [5]. From this study, this alignment should be within \(\pm 1\)ns, mainly to keep sensitivity to any jitter as low as possible. In these conditions, if we hope to obtain well defined delay values, it is necessary to calibrate each chip, to sort them and to match them before their installation on the calibration board. In operation, we must monitor precisely the temperature which must be as low as possible. Finally, to improve the jitter performance, a solution could be to increase the supply voltage of the delay chip. In this case, the impact on the component life must be studied.

Figure 11: _Intercept values distribution of the four channels at 18\({}^{\circ}\)C concerning the 300 selected chips._

## References

* [1] T. Toifl, R. Vari, P. Moreira, A. Marchioro. _4-channel rad-hard delay generation ASIC with 1ns timing resolution_ _for LHC_, internal note.
* [2] J. Colas et al. _The LARG calorimeter calibration board_, ATL-LARG-2000-006.
* [3] J. Christiansen et al. _A timing, trigger and control receiver ASIC for LHC detectors_, TT Crx reference manual, V3.0.
* [4] private conversation with Pierre Bonneau, CERN.
* [5] ATLAS collaboration. _ATLAS liquid argon calorimeter technical design report_, CERN/LHCC/96-41.