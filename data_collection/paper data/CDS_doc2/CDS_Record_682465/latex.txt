**ATLAS Internal Note PHYS-NO-84**

**April 17, 1996**

**VECBOS:**

**a Lowest Order Matrix Element Calculation to simulate direct QCD W + n jet events**

M. Cobal\({}^{(1)}\), D. Costanzo\({}^{(2)}\), S. Lami\({}^{(2)}\)

_(1) CERN, Geneva, Switzerland, (2) University of Pisa and INFN, Pisa, Italy_

**Abstract**

VECBOS is a \(V+n\ jets\) generator, where V\(\,=\,\)W,Z and n runs from 0 to 4. It is based on the Vegas multi-dimensional integration routine and matrix elements calculated by W.T. Giele et al. The code has been transferred at CERN, interfaced to PDFLIB, and is currently running under CMZ. This note describes the features of this Montecarlo as well as how to use it. A comparison between VECBOS and the PYTHIA generator for W + jet events is also given.

###### Contents

* 1 Introduction
	* 1.1 QCD W + jet calculations
* 2 VECBOS
	* 2.1 Parton generation
	* 2.2 Parton fragmentation
	* 2.3 Comparison VECBOS - data at the Tevatron
* 3 VECBOS at CERN for the ATLAS experiment
	* 3.1 Installing VECBOS
	* 3.2 Generating events with VECBOS
* 4 Comparison between PYTHIA and VECBOS
	* 4.1 Comparison of the shape of some kinematical distributions
	* 4.2 Cross section comparisons
	* 4.3 CPU time
* 5 Conclusions

Introduction

After the Intermediate Vector Bosons [1] and the Top quark discovery [2], the search for the Higgs boson is the central issue for the understanding of the electroweak sector of the Standard Model [3].

The study of W + jets production at the LHC is crucial for the understanding of the background to several channels for the Higgs search, such as WH and H\(t\overline{\rm H}\) with H\(\to b\overline{b}\), when \(80~{}<~{}M_{H}~{}<~{}120~{}{\rm GeV}\), and H\(\to WW\to l\nu\)jj, this last one becoming one of the most promising channels for \(M_{H}~{}>~{}500~{}{\rm GeV}\).

Furthermore, top quark physics at the LHC will require a detailed understanding of the W + jets background in order to accurately measure \(M_{top}\).

### QCD W + jet calculations

In parton collisions the W can be produced together with one or more energetic quarks or gluons. Some of the contributing diagrams are shown in figure 1.

The diagrams (b), (c) show the W recoiling against a quark or gluon. The diagrams of higher order can have a second parton in the final state, which can

Figure 1: Some of the Feynman diagrams for W production. The process at lowest order is shown in (a). Some examples for higher order processes are shown in (b), (c), (d), (e).

generate more than one jet in the event. The matrix element of these processes is proportional to a power of the coupling constant \(\alpha_{s}(Q^{2})\). This coupling constant depends on the \(Q^{2}\) scale at which the parton collision happens. Since one is dealing here with a large momentum transfer, it is possible to get a fair approximation by using perturbative QCD. A good reference point for the constant \(\alpha\), is the PDG world average value \(\alpha_{s}(M_{Z})\)= 0.118\(\pm\)0.003. The calculation of multi-jet final states is complicated. The development of V EBCOS [4] has been possible thanks to new mathematical methods which allow to simplify the calculation of the matrix elements in lowest order ('tree level') for processes with \(n\) partons, allowing to perform the calculation up to \(n=6\)[5].

Cuts on the phase space of the outgoing partons are necessary. To understand why, one can consider the simplest process \(gg\to gg\). The scattering of the four gluons at tree level (i.e. without taking into account loops) is a lowest order process \((O(\alpha_{s}^{2}))\). To calculate the next order in \(\alpha_{s}\) one needs to take into account contributions from the scattering of the four gluons (but now with loop corrections) and the scattering of 5 gluons at tree level.

The contributions from loops to the four gluon scattering contain divergences. The ultraviolet divergences can be absorbed in the renormalization of the coupling constant. However, there are also singularities in the five-gluon matrix element. They occur when two gluons are collinear, or when the energy of one of them comes close to zero. In a more experimentally oriented language this means that two of the outgoing gluons will create a single jet, or that the jet is too close to the beam, or it is not energetic enough to be observed.

As a consequence not all of the 5 gluon scattering processes will be observed as events with 3 jets. Some will rather generate events with 2 jets in the final state. Therefore, if one wants to determine the cross section for the two jets final state, one needs to add the 5 gluon process to the loop corrections of the 4 gluon processes. The infrared singularities cancel, while the divergences due to the initial state collinearities remain. These divergences are reabsorbed in the initial state parton structure functions. It follows therefore, that the resulting cross section will depend on how jets are defined, for example on which angle of separation is required to identify two partons as two different jets. These jet definitions need to be considered when choosing the cuts in phase space so that it is adequate to the experimental situation. Let's suppose for instance that we calculate the 3 jets final state and require some minimum separation between the outgoing partons and a minimum energy for each of these partons. There are events which will not pass these cuts and will therefore contribute to the missing higher order corrections for the two jets case. The events which pass the cuts will be instead part of the lowest order contributions to three jets production.

What is the effect of the lack of higher orders in the calculations? The corrections introduced at the tree level influence mostly the absolute value of the cross section, and have little effect on the shape of distributions. Not accounting for higher order corrections causes a stronger dependence on the \(Q^{2}\) scale. This scale needs to be chosen, according to the process of interest. Therefore if we want to compare the results of the lowest order calculations to the experimental data we have to remember that:

* The overall normalization is not known
* The results depend on the choice of the Q\({}^{2}\) scale.

To quantify the uncertainty in the normalization, one often introduces a "K-factor". This factor is a constant by which one multiplies the cross section at tree level to obtain a better absolute value for the cross section. This factor depends on several parameters, e.g. the Q\({}^{2}\) scale and the center of mass energy (see Section 2.3).

Vecbos

### Parton generation

A characteristic feature of VECBOS is that it gives a weight to each of the generated events. The event weight is determined by the product of the matrix element (ME) times the volume of the phase space hypercube in which the event lies. In the phase space region where the ME is large, the weight can have very large values. This is the case, as an example, for W+jet events with low E\({}_{T}\) or forward emitted partons.

Inside the phase space allowed by the kinematical cuts, the ME can vary in a large range of values. The difference between the smallest and the largest possible value increases with the jet multiplicity. Unfortunately, a very broad distribution of event weights means large statistical errors.

For the events to have the same weight, the density of Montecarlo events in the phase space should be proportional to the ME. To arrive at such a result, it is necessary to subdivide the phase space in small cells. The volume of these cells must be inversely proportional to the dimension of the corresponding ME which is difficult to achieve especially in the case of multidimensional phase space. VECBOS can only subdivide the initial phase space (two-dimensional), identified by the momenta of the initial partons.

As a first step VECBOS divides the initial state phase space in bins of equal dimensions, and generates the same number of events in each bin. The density of the events is then increased by reducing the bin area where the ME is larger. Still, in this two-dimensional phase space VECBOS cannot correctly take into account the correlations between the two variables. The final state is populated randomly. As a result the weight distributions are broad, in particular for W+4 jet events. It is therefore necessary to produce a large number of events in order to reduce the statistical errors.

The distribution in the logarithm of the weights for VECBOS W+3 jet events is shown in figure 2 without (upper plot) and with (lower plot) a cut on the P\({}_{T}^{W}\) at 200 GeV. As one can see, the weights are significantly different for different events, in both cases. The weight distribution after having applied the P\({}_{T}^{W}\) cut becomes narrower. In the upper plot there is an overflow at -8.94.

On the other hand, the user which does not want to deal with weighted events can always apply specific statistical procedures to "unweight" the Montecarlo sample.

As already said in Section 1.1 the ignorance of the diagrams beyond the leading order can result in significant systematic errors in the prediction of cross sections. Caution has to be exercised in defining and limiting the generation to the part of phase space where those assumptions hold reasonably well. This is done by carefully setting minimum thresholds for the E\({}_{T}\)'s and for the parton separation to remain safely away from the region of soft and small angle radiation where perturbative QCD is known to yield divergent results. An example of the cuts to be applied at parton level are given in Table 2.

### Parton fragmentation

The calculations for W+jets production are at parton level, and give the transition probabilities between quark and/or gluon states (with some additional particles which interact weakly, such as leptons and electroweak bosons). However what one really sees in an experiment are not quarks and gluons but jets, and the problem to get a simulation which gives as output jets starting from a theoretical prediction at parton level is not simple. For the fragmentation we used

Figure 2: Distribution of the natural logarithm of the weight (Ln(weight)) for VEC-BOS W+3 jet events without (upper plot) and with (lower plot) the cut \(P_{T}^{W}>200\) GeV.

the LUEXEC routine included in JETSET [6] which transforms partonsintojets based on the Lund string scheme. Since we don't include showering processes each parton in the final state fragments to one single jet. This approach avoids the ambiguities connected to the possibility that a two-parton final state can produce 3-jet events.

In this note VECBOS will be used always for inclusive predictions. However it is possible to shower its partons [7]. This would resolve the inclusive W+ \(\geq\) 2 jets VECBOS prediction in the exclusive W + 2 jets, W + 3 jets, W + 4 jets. One should note that the inclusive 2 jet cross section will still be as VECBOS predicts, provided that one does not lose events in which one of the jets is lost after showering (i.e. W + 2 partons\(\rightarrow\) W + 1 jet). These events should not be added to the W + 1 jet sample generated for instance with VECBOS W + 1 parton plus shower MC, since this would be double counting. This feed-down phenomena happens of course expecially near the \(\mathrm{E}_{T}\) cut on the partons at generation level due to the fact that the showering will lower the jet energy slightly. The way this is handled is that at event generation level one uses a cut of i.e. 8 GeV, while in the final generated MC sample (including showering) one applies a cut of i.e. 15 GeV. Consistency checks are possible, since one can generate W + 3 jets in many ways :

a) W + 1 parton VECBOS + shower MC \(\rightarrow\) W + 3 jets  b) W + 2 parton VECBOS + shower MC \(\rightarrow\) W + 3 jets  c) W + 3 parton VECBOS + shower MC \(\rightarrow\) W + 3 jets  Of course method (c) gives the most accurate prediction. What we know now is that if you use method (b) it still describes the properties of all three jets very well when compared to method (c). Method (a) will describe the behavior of the leading 2 jets reasonably, but will deviate for the third jet too much to be acceptable. In general it seems that using VECBOS with W + n partons, adding a shower MC will give you W + n jets and W + (n+1) jets. Looking at the (n+2)nd jet will not generate the right distributions. For that one needs to start with VECBOS at a higher multiplicity [8].

### Comparison VECBOS - data at the Tevatron

Even with the above explained limitations, VECBOS turned out to be a fundamental tool for the Tevatron data analysis since it was introduced [9]. For instance, the main background for the top search in the single lepton channel is direct QCD production of W's with jets. The understanding of VECBOS has been tuned by a detailed comparison between its prediction and large data samples used as control samples. A comparison between VECBOS and data for W +\(\geq\) 2 jets is shown as an example in figure 3, where there is a good agreement for the leading jet (a) and second jet (b) transverse energy spectra. Since the VECBOS event generator has significant theoretical uncertainties in its absolute rate predictions it has usually been avoided to use its output cross section. However, several detailed studies are under development to normalize the VECBOS Montecarlo to the data [10]. There are indications that the ratio data/QCD ranges from \(\approx\)0.9 to \(\approx\)1.8, depending on the allowed radiation, on the Q\({}^{2}\) scale and on the jet multiplicity. In particular, for the W + \(\geq\) 2 jets case, using a Q\({}^{2}\) = \(<P_{T}>^{2}\) this ratio is about 1.3 and is not very sensitive to the E\({}_{T}\) jet threshold applied (verified in the range 20-70 GeV). If one uses Q\({}^{2}\) = M\({}_{W}^{2}\) the ratio is around 1.6 and shows a stronger dependence from the E\({}_{T}\) jet threshold applied.

Figure 3: Comparison between VECBOS prediction (histogram)and data (points) for the transverse energy distribution of the leading jet (a) and the second jet (b) in W +\(\geq\) 2 jets events at the Tevatron. VECBOS is normalized to the data in each of the two plots.

VECBOS at CERN for the ATLAS experiment

A standalone version of VECBOS, running on the Unix farm cdfsga at Fermilab1, has been copied and installed on the ATLAS farm at CERN. We first compared the output of the two copies in order to check that they give the same results. To this purpose we generated two samples of events, applying the same cuts at generation level:

Footnote 1: Courtesy of S. Rolli, CDF Collaboration

* \(\mbox{P}_{T}(\mbox{charged lepton, neutrino, jets})>30\) GeV
* \(\mbox{P}_{T}(\mbox{jets})>30\) GeV
* \(|\eta(\mbox{charged lepton, jets})|<2\)
* \(\Delta\mbox{R}(\mbox{jet-jet})>0.4\)
* \(\Delta\mbox{R}(\mbox{jet-charged lepton})>0.4\)

Table 1 shows the cross section values for W + 1, 2, 3 jet production for the CERN and Fermilab versions. The values are in good agreement within the statistics.

The jet \(\mbox{E}_{T}\) spectra have also been compared and they are in perfect agreement. The code has been then inserted in the CMZ 2 framework. The program is now interfaced to the PDFLIB library which provides all the most recent sets of parton distributions [11]. PDFLIB requires three parameters to define the pdf set: the pdf type has been fixed to 1 (=Nucleon) in the program while the group and the set can be changed in the input datacard. Currently the default values for NGRO and NSET select the pdf set CTEQ3M. All the software related to VECBOS is in:

Footnote 2: \(CM\,Z\) is an advanced self-documenting and machine independent source code and document management system.

_afs/cern.ch/user/c/costanzo/public/vecbos/vecbos.crmz_

where one can find the executable program, the source code and some example datacards. One can either copy the code to his/her own area and install it, or run the program from this public area.

\begin{table}
\begin{tabular}{|l|c|c|} \hline Process & \(\sigma\) CERN (nb) & \(\sigma\) Fermilab (nb) \\ \hline \hline W + 1 jet & 0.437\(\pm\)0.003 & 0.4 37\(\pm\)0.003 \\ W + 2 jet & 0.162\(\pm\)0.004 & 0.1 61\(\pm\)0.004 \\ W + 3 jet & 0.032\(\pm\)0.003 & 0.033\(\pm\)0.003 \\ \hline \end{tabular}
\end{table}
Table 1: Cross section values found for different processes using the Fermilab and CERN version of VECBOS

### Installing VECBOS

VECBOS can beinstalled on the user's area by copying the files vecbos.cmz and vecbos.ins and then by typing:

_vecbos.ins_

The executable will be created in the designated area.

If you don't want to create the executable in your area you just have to link the executable in the public area by typing:

_ln -s afs/cern.ch/user/c/costanzo/public/vecbos/vecbos vecbos_

### Generating events with VECBOS

The VECBOS program reads an input datacard and writes all the informations on the standard output. To run the program the user has to give the input datacard and, if he/she wants, to send the output to a listfile.

For example, to run VECBOS using vec.datacard:

_vecbos \(<\) vec.datacard \(>\) listfile_

Some examples of datacard files are created during installation and can be found in the public area. If one wants to run VECBOS with different parameters one has just to modify the datacard file. The changes one can select are described in table 2. Remember that it is important to put a cut on the distances jet-jet (\(\Delta\)R\({}_{jj}\)) and lepton-jet (\(\Delta\)R\({}_{jj}\) ), as well as a cut on the P\({}_{T}\) of the outgoing particles, to avoid divergences. Reference values are indicated in table 2 (DRJJ, DRLJ, PMIJ, PMIL and PTMS). The integers ITM1, NCA1, ITM2 and NCA2 are needed to construct the subdivision of the initial phase space which we call grid. This subdivision is built in two different steps. In the first one NCA1 events are generated ITM1 times but only to define the grid (see Section 2.1). In the second one NCA2 events are generated ITM2 times to optimize the grid, and the events of the last iteration are given as output. One should check that the number of events and iterations chosen produce a sufficiently narrow weight distribution. VECBOS creates the following output files:

* _vecbos.out_ which is an hbook file where you can find an ntuple (15) involving some important variables for the event. This ntuple is booked in the deck _//source/ntbook_ and filled in _//source/ntfill_.
* _ZEBRA.O_ which is a binary file written in a machine independent way that contains in a standard ZEBRA banks (created using the GENZ package) all the event informations3. The generation of this file (which could take a big amount of disk space) can be suppressed by selecting STOR 0 in the datacard file.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline KEY & Description & Default & Type \\ \hline \hline PROC & Selectedprocess (1 1 W\({}^{+}\); 1 2 W\({}^{-}\); 2 Z) & 1 1 & 2 INT \\ NJET & Number of jets for the event & 2 & INT \\ NGRO & PDF group number in PDFLIB & 4 & INT \\ NSET & PDF set number in PDFLIB & 30 & INT \\ QCDS & QCD scale & 1 & INT \\  & 1 P\({}_{T}\) average & & \\  & 2 Total invariant mass & & \\  & 3 Average invariant mass of two jets & & \\  & 4 Mass of vector boson & & \\  & 5 Maximum P\({}_{T}\) in the event & & \\ RNDM & Seed numbers to change random generation & 1802 & 2 INT \\  & 9373 & & \\ ITM1 & Nr. of iterations for the first step to build the grid & 10 & INT \\ NCA1 & Nr. of events produced in each iteration ITM1 & 5000 & INT \\ ITM2 & Nr. of iterations for the second step to build the grid & 10 & INT \\ NCA2 & Nr. of events produced in each iteration ITM2 & 10000 & INT \\ TRIG & 0 no fragmentation; 1 fragmentation & 0 & INT \\ STOR & 0 no store on file ZEBRA.O; 1 store & 0 & INT \\ DEBU & Which events to debug & 0 1 & 2 INT \\  & (First event to debug, number of events to debug) & & \\ PPBA & 0 \(pp\) collider; 1 \(p\bar{p}\) collider & 0 & INT \\ ENCM & Center of mass energy & 14000 & REAL \\ PTVC & Minimum P\({}_{T}\) for the vector boson & 0 & REAL \\ PMIJ & Minimum P\({}_{T}\) for jets & 50 & REAL \\ PMIL & Minimum P\({}_{T}\) for charged leptons & 50 & REAL \\ PTMS & Minimum Missing P\({}_{T}\) & 50 & REAL \\ ETAJ & Maximum \(\eta\) (absolute value) for jets & 2 & REAL \\ ETAL & Maximum \(\eta\) (absolute value) for charged leptons & 2 & REAL \\ DRJJ & Min distance between partons in \(\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\) & 0.4 & REAL \\ DRLJ & Min distance partons-leptons in \(\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\) & 0.4 & REAL \\ \hline \end{tabular}
\end{table}
Table 2: Variables which can be changed in the VECBOS datacard. The default values are also listed.

Comparison between PYTHIA and VECBOS

### Comparison of the shape of some kinematical distributions

A comparison between PYTHIA version 5.7 [6] and VECBOS has been performed for W+2, 3, 4 jet events. PYTHIA is a shower Montecarlo which allows the user to simulate several physics processes both for hadronic and leptonic colliders.

Events in PYTHIA are generated in a different way from VECBOS : W plus one parton events are generated4 and then the other jets are obtained via a showering process. The default Q2 for PYTHIA is given by:

Footnote 4: For W+jets production we used ISUB=16, 31.

\[Q^{2}=\frac{1}{2}(m_{3}^{2}+m_{4}^{2})+\hat{p_{t}^{2}} \tag{1}\]

where \(m_{3}\) and \(m_{4}\) are the outgoing W and parton masses, and \(\hat{p_{t}}\) is their transverse momentum.

We remind that in this note we have done an inclusive comparison, i.e. we run VECBOS for W+2 partons to have predictions for W+2 leading jets in the inclusive W+\(\geq\) 2 jets data sample. However, as explained in section 2.2 an exclusive comparison would have been possible by showering the partons from VECBOS.

For the comparison a set of PYTHIA events has been filtered with the same kinematical constraints as those used to generate VECBOS events. No detector simulation has been applied. The jets are then defined using a clustering algorithm (UA2) in the central region.

In the following comparison we adopted a set of selection criteria considering a search for a 1 TeV mass Higgs boson which decays in two W's. One of the W's then decays into hadrons and the other into leptons. The main reason for studying this channel is that the BR is about 150 times larger than BR(H\(\rightarrow\) ZZ\(\rightarrow\)4_l_), thus leading to the largest possible rate with at least one charged lepton in the final state. In order to study the background from direct QCD W + jets production, VECBOS events have been generated in the proper kinematic region by requiring:

* P\({}_{T}\)(W) \(>\) 200 GeV
* P\({}_{T}\)(charged lepton-neutrino) \(>\) 50 GeV
* P\({}_{T}\)(jet s) \(>\) 30 GeV
* \(\Delta\)R(jet-jet) \(>\) 0.4
* \(\Delta\)R(jet-charged lepton) \(>\) 0.4* \(|\eta|<2\) for all particles in the final state The same structure function (CTEQ3M) has been used in both Montecarlos. A comparison between VECBOS and PYTHIA for W + 2, 3 and 4 jets is shown respectively in figure 4, 5, and 6. Fig. 7 shows the rapidity distribution of the lepton and of the four jets for W + 4 jets events: VECBOS and PYTHIA give similar results. The jet energy spectra are slightly harder in VECBOS than in PYTHIA, as we can see better in fig. 8 where we released the \(\mathrm{P}_{T}^{W}>200\) GeV cut which reduces the phase space and consequently the difference between the two Montecarlos. We then studied the dependence on the choice of the \(Q^{2}\) scale. For W + 2 jets fig. 9 shows the comparison for different kinematic variables when we choose either a \(P_{T}\) average or the W boson mass as our QCD scale in the VECBOS Montecarlo. Finally, we wanted to check whether approaching the divergence regions in VECBOS could create problems. For this purpose we performed two separate studies. In the first one we lowered the cut on the \(\Delta R\) (jet-jet) at the parton generation. Figure 10 shows the comparison of some kinematical distribution for VECBOS W + 3 jets and PYTHIA, when a cut \(\Delta R\) (jet-jet)\(\geq\) 0.3 has been applied: the result is not very differerent from what we get with the cut at 0.4. We also verified that going to lower \(\Delta R\) (jet-jet) at the parton generation does not effect the separation of the reconstructed jets. Figure 11 shows the \(\Delta R\) distribution for reconstructed jets in VECBOS W + 2 jet events. Three different \(\Delta R\) (jet-jet) have been applied at the parton level: 0.1, 0.3 and 0.4. Jets are then reconstructed in a cone of radius R= 0.25. For \(\Delta R\) (jet-jet)\(\geq\) 0.4 the three different distributions overlap well. In the second test we extended the pseudorapidity interval up to \(\eta=\pm\) 5. Figure 12 shows the comparison of some kinematical distributions for W+ 2 jet events for VECBOS and PYTHIA. We didn't experience evident problems in increasing in such a way the phase space in the forward regions (the changes in the cross sections are shown in the next Section).

### Cross section comparisons

We also compared the cross section for VECBOS W+ n jets and PYTHIA W+\(\geq\)n jets (n = 1, 2, 3, 4). Jets are reconstructed with the same algorithm as in section 4.1. No cut on \(\mathrm{P}_{T}^{W}\) has been applied in the following analysis, unless otherwise specified. Fig. 13 shows the ratio of the PYTHIA and VECBOS cross sections as a function of the cut on the jet \(\mathrm{P}_{T}\) for W+1 jet events. In both simulation codes the same structure function has been used (CTEQ3M) as well as the same Q\({}^{2}\) for the \(\alpha_{s}\). Partons have not been fragmented and initial and final gluon radiation in PYTHIA have been switched off. The distribution is rather flat, and the mean value is around 1.04 (and not 1.0 as one would have expected). The same exercise has been re-done but this time partons have been fragmented by using for both PYTHIA and VECBOS the LUEXEC routine of JETSET. Thisexercise could point out possible differences due to the fact that VECBOS does not specify whether a gluon or a quark parton has been generated, and does not provide gluon colour flow information. The result is shown in figure 14.

The distribution, inside the statistical errors, is almost unchanged from the previous case. Figure 15 shows again the ratio of the VECBOS and PYTHIA cross sections for W+1 jet. In both the simulation codes the same structure function has been used (CTEQ3M), but for VECBOS a \(Q^{2}=M_{W}^{2}\) while for PYTHIA the default value was chosen. One can notice that the ratio is lower than before, due to the different \(Q^{2}\) choice in PYTHIA.

To understand the effect of the \(Q^{2}\) in VECBOS one can look at figure 16, where the ratio of VECBOS with \(Q^{2}=M_{W}^{2}\) and \(Q^{2}=<P_{T}>^{2}\) is plotted as a function of the jet \(P_{T}\) cut for the W+1 jet case (upper plot) and for the W+2 jets case (lower plot). The same distributions are shown in figure 17 for W+3 jets (upper plot) and for W+4 jets (lower plot). One sees that the differences between the two different choices of \(Q^{2}\) are enhanced with the jet multiplicity.

In figures 18 and 19 the cross section ratios for W+1, 2, 3, 4 jets with VECBOS and PYTHIA are shown. We compared the results using the same value for the \(Q^{2}\) scale, \(Q^{2}\)= \(M_{W}^{2}\): the cross section ratio is shown as a function of the cut on the jet \(P_{T}\).

We wanted to verify whether the cross section for W + 2 jets in VECBOS was still under control when the jets pseudorapidity is extended up to \(\eta=\pm\) 5. With a \(P_{T}^{W}\geq\) 200 GeV cut and \(P_{T}^{jet}\geq\) 30 GeV, the ratio \(\sigma(\mbox{VECBOS})/\sigma(\mbox{PYTHIA})\) is 1.5\(\pm\)0.1 for \(|\eta(\mbox{jets})|\leq\) 2 and 2.5\(\pm\)0.1 for \(|\eta(\mbox{jets})|\leq\) 5.

### CPU time

It is interesting to check the CPU time needed to generate events both in PYTHIA and in VECBOS. In table 3 we report the average time needed to generate one accepted event with reconstructed jets (n = 1,2,3,4) in VECBOS when we require no cut on W transverse energy, as described in this note. Note that the times which are reported in the table can change for different compiling options used for VECBOS and for different grid definitions5 While in VECBOS we can apply our selection criteria on the outgoing partons by the input datacard, in PYTHIA we don't have any control on the showered jets. So we cannot compare directly VECBOS and PYTHIA CPU times because the way events are generated in PYTHIA requires an appropriate filter with the same selection criteria applied in VECBOS. This means that to produce W + 3 jets in PYTHIA without a cut on the \(P_{T}^{W}\) and with the leptons from W decay with a \(P_{T}^{j}\geq\) 40 GeV and with \(|\eta^{i}|\leq\) 2.0 we start from W + 1 jet events (on average 0.1 s per generated event) but we have to generate a huge number of events and to filter them out. In VECBOS there is a high probability that starting with W + 3 partons we will end up with 3 jets after the fragmentation has been applied; on the other hand, due to the weight on each event, many more events are required from VECBOS in order to make a reasonable comparison with the PYTHIA kinematical distributions. Table 4 summarizes our results. In the second column the number of PYTHIA accepted and generated events is shown for the different processes. The third column reports the time needed to produce those events. The time needed to produce statistically equivalent samples of VECBOS accepted events is reported in column four. Finally, the last column shows the ratio of the PYTHIA and VECBOS times. One sees that the VECBOS generator is faster than PYTHIA even for the W+4 jets production.

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline Process & PYTHIA sample & PYTHIA time (s) & VECBOS time (s) & Time ratio \\  & acc/gen & gen sample & equivalent sample & \\ \hline W + 2 jets & 3267/164 3521 & 164 352 & 2417 & 68 \\ W + 3 jets & 615/164 3521 & 164 352 & 24140 & 6.8 \\ W + 4 jets & 120/164 3521 & 164 352 & 78509 & 2.1 \\ \hline \end{tabular}
\end{table}
Table 4: Comparison of the time (in s) needed to generate statistically equivalent samples with PYTHIA and VECBOS.

\begin{table}
\begin{tabular}{|l|c|} \hline Process & Time (s) \\ \hline W + 1 jet & 0.007 \\ W + 2 jets & 0.014 \\ W + 3 jets & 0.09 \\ W + 4 jets & 1.56 \\ \hline \end{tabular}
\end{table}
Table 3: CPU time (seconds) to generate one accepted event in VECBOS for W + n jets (n = 1, 4) on HP 9000/735.

Figure 4: Comparison of VECBOS W + 2 jets (dotted) with PYTHIA W + \(\geq\) 2 jets (solid) for different kinematic variables with \(\mbox{P}_{T}^{W}\)\(>\) 200 GeV.

Figure 5: Comparison of VECBOS W + 3 jets (dotted) with PYTHIA W + \(\geq\) 3 jets (solid) for different kinematic variables with \(\mbox{P}_{T}^{W}\)\(>\) 200 GeV.

Figure 6: Comparison of VECBOS W + 4 jets (dotted) with PYTHIA W + \(\geq\)4 jets (solid) for different kinematic variables with \(\mbox{P}_{T}^{W}\)\(>\) 200 GeV.

Figure 7: Comparison of VECBOS W + 4 jets (dotted) with PYTHIA W + \(\geq\)4 jets (solid) for the lepton and the four jets rapidity distribution.

Figure 8: Comparison between VECBOS W + 2 jets (dotted) and PYTHIA W + \(\geq\) 2 jets (solid) without any cut on the \(P_{T}^{W}\).

Figure 9: Comparison between a choice of \(\rm P_{T}\) average (solid) and the W boson mass (dotted) for the \(Q^{2}\) scale in the VECBOS Montecarlo, for W + 2 jets events

Figure 10: Comparison of VECBOS W + 3 jets (dotted) with PYTHIA W + \(\geq\) 3 jets (solid) for different kinematic variables, having applied a cut on \(\Delta\)R\(\geq\) 0.3

Figure 11: Comparison between three different choices for \(\Delta\)R (jet–jet) in VECBOS W+2 jet events.

Figure 12: Comparison of VECBOS W + 2 jets (dotted) with PYTHIA W + \(\geq\) 2 jets (solid) for different kinematic variables, after extending the pseudorapidity interval up to \(\eta\) = \(\pm\) 5.

Figure 13: Ratio of the VECBOS and PYTHIA cross sections for W+1 jet. In both the simulation codes the same structure function has been used (CTEQ3M) as well as the same Q\({}^{2}\) for the \(\alpha_{s}\). The ratio is shown as a function of the cut on the jet. P\({}_{T}\). Partons have not been fragmented and initial and final state gluon radiation in PYTHIA have been switched off.

Figure 14: Ratio of the VECBOS and PYTHIA cross sections for W+1 jet. In both the simulation codes the same structure function has been used (CTEQ3M) as well as the same Q\({}^{2}\) for the \(\alpha_{s}\). The ratio is shown as a function of the cut on the jet P\({}_{T}\). Partons have been fragmented while initial and final state gluon radiation in PYTHIA have been switched off.

Figure 15: Ratio of the VECBOS and PYTHIA cross sections for W+1 jet. In both the simulation codes the same structure function has been used (CTEQ 3M). For VECBOS a Q\({}^{2}\) = M\({}_{W}^{2}\) while for PYTHIA the default value was used. The ratio is shown as a function of the cut on the jet P\({}_{T}\). Partons are not fragmented and initial and final state gluon radiation in PYTHIA were switched off.

Figure 16: Ratio of the VECBOS cross sections using \(\mbox{Q}^{2}=\mbox{M}_{W}^{2}\) and \(\mbox{Q}^{2}=\mbox{$<P_{T}>^{2}$}\), for \(\mbox{W}+1\) jet (upper plot) and \(\mbox{W}+2\) jets (lower plot).

Figure 17: Ratio of the VECBOS cross sections using \(\mbox{Q}^{2}=\mbox{M}_{W}^{2}\) and \(\mbox{Q}^{2}=\mbox{$<P_{T}>^{2}$}\), for \(\mbox{W}+3\) jets (upper plot) and \(\mbox{W}+4\) jets (lower plot).

Figure 18: Ratio of the VECBOS and PYTHIA cross sections for W+1 (top) and 2 jets (bottom) using Q\({}^{2}\) = \(<P_{T}>^{2}\) for VECBOS and the default value for PYTHIA, as a function of the cut on the jet P\({}_{T}\).

Figure 19: Ratio of the VECBOS and PYTHIA cross sections for W+3 (top) and 4 jets (bottom) using Q\({}^{2}\) = \(<P_{T}>^{2}\) for VECBOS and the default value for PYTHIA, as a function of the cut on the jet P\({}_{T}\).

Conclusions

The VECBOS Montecarlo has been installed on the ATLAS farm at CERN. It generates W/Z + \(n\) partons (\(n\)= 0, 4) according to a complete matrix elements calculation.

In the last years VECBOS has been proved to be an extremely useful tool and we believe it is worthy to include it in the ATLAS generators zoo. We performed a comparison of several kinematical distributions for W + jet events from the VECBOS and PYTHIA Montecarlos. We also compared the two Montecarlo cross sections for the production of W + 1, 2, 3, 4 jet events. A simple description of how to use VECBOS as well as a standard input datacard is provided by this note. VECBOS is also available in the ATGEN package 6.

For the near future more work is foreseen, i.e. one should interface VECBOS with an unweighting procedure and allow the production of W\(b\overline{b}\) events and the W decay in \(\tau\nu\).

Footnote 6: Contact: A. Amorim

We would like to thank D. Froidevaux, L. Poggioli, E. Richter-Was and S. Rolli for their useful suggestions, for the careful reading of this note as well as for providing the fundamental software tools to start this job.

## References

* [1] G. Arnison _et al._, Phys. Lett. **122 B** (1983), 103; M. Banner _et al._, Phys.Lett. **122 B** (1983), 476; G. Arnison _et al._, Phys.Lett. **126 B** (1983), 398; P. Bagnaia _et al._, Phys.Lett. **129 B** (1983), 130.
* [2] F. Abe _et al._, PRL **74** (1995), 2626; S. Abachi _et al._, PRL **74** (1995), 2632.
* [3] J. Gunion _et al_, The Higgs Hunter's Guide (Addison-Wesley, New York, 1990); S.L. Glashow and E.E. Jenkins, Phys. Lett. B **196**, 233 (1987); V. Barger, J. L. Hewett and R.J. N. Phillips, Phys. Rev. D **41**, 3421 (1990).
* [4] F. A. Berends, W. T. Giele, H. Kuijf, B. Tausk, 'On the production of a W and jets at Hadron Colliders', FERMILAB-PUB-90/213-T. W.T. Giele, FERMILAB-CONF-90/229T.
* [5] R. Kleiss, W.J. Stirling, Z. Phys. C **40** (1988), 419; K. Hagiwara, D. Zeppenfeld, Nucl. Phys. B **313**, 560 (1989);