**ATLAS Note**

**April 2002**

**Autocalibration:**

**The Influence of the**

**Track Incidence Angles**

**and a New Method**

M. Deile\({}^{1}\)2, N.P. Hessey\({}^{3}\), A. Staude\({}^{1}\)

Footnote 2: now at Yale University, New Haven, CT, USA

**Abstract**

The calibration of the space-time relationship \(r(t)\) of the Monitored Drift Tube Chambers in ATLAS will have to be done with the chambers' own data because no external reference detector will be available. Techniques for this so-called "autocalibration" have been worked on since the early days of ATLAS preparation. It is a known problem that speed and precision of autocalibration convergence depend crucially on the range of track incidence angles. This note presents an algebraic approach to this dependence. We shall investigate under which conditions autocalibration has enough information to determine the r-t relationship uniquely. A new technical realization will be introduced which is designed for making optimal use of all available information. Finally we determine the spread of track incidence angles for each ATLAS MDT chamber, and discuss the achievable calibration precision.

Our calculations are based on the detector response for the gas Ar/CO\({}_{2}\) (93/7).

###### Contents

* 1 Introduction: The Principle of Autocalibration
* 2 An Algebraic Approach to Autocalibration
	* 2.1 The Matrix Equation of Autocalibration
	* 2.2 Autocalibration Constraints for a Given Track
	* 2.3 Autocalibration Constraints Combining Different Tracks
		* 2.3.1 Fixpoints of Higher Order
		* 2.3.2 Correlation of Tracks with Identical Slope
		* 2.3.3 Correlation of Tracks with Different Slopes
* 3 Auto calibration Methods and their Performance
	* 3.1 The Conventional Autocalibration Technique
	* 3.2 Fitting the Global Matrix Equation
* The Procedure
* 5 Comment on Autocalibration near the Wire
* 6 Auto calibration at ATLAS
	* 6.1 Determination of the Angular Spread in ATLAS MDT Chambers
	* 6.2 Precision of Autocalibration for all MDT Chambers
* 7 Conclusions
* A Derivation of the Autocalibration Matrix Elements
* B Proof of \(\mbox{rank}(M)\leq\mbox{dim}(M)-2\) for the Auto calibration Matrix \(M\)
* C The Distributions of Track Incidence Angles for ATLAS Chambers

Introduction: The Principle of Autocalibration

We start with a short reminder on the basics of autocalibration. They have been described in several reports, e.g. [1, 2, 3].

Autocalibration of the space-time relationship \(r(t)\) of drift-tube chambers uses the correlation of the drift times measured in tubes crossed by a common track. By fitting tracks through a multilayer of tubes the r-t relationship is iteratively obtained.

Autocalibration starts with a first-order r-t relationship \(r_{\rm start}(t)\) which can be obtained e.g. by unfolding the drift-time spectrum [4, 5]. This \(r_{\rm start}(t)\) has a systematic deviation \(\varepsilon(t)\) from the true relationship \(r_{\rm true}(t)\):

\[r_{\rm start}(t)=r_{\rm true}(t)+\varepsilon(t) \tag{1}\]

In the first iteration this start r-t relationship is used to convert the measured drift times \(t_{i}\) in a multilayer of tubes into hit radii to which then a track is fitted. The fitted track serves for obtaining a better estimate for the r-t relationship. In the next iteration this improved r-t relationship replaces \(r_{\rm start}(t)\) for converting the drift times into radii. Again, tracks are fitted and used for improving further the space-time relationship. This procedure is repeated until the r-t relationship has converged.

**The task of autocalibration is to gain knowledge about the deviation \(\varepsilon(t)\) of the start r-t relationship by using the information contained in the fit residuals \(\Delta_{i}\):**

\[\Delta_{i}\equiv r_{\rm start}(t_{i})-r_{i,\rm fit} \tag{2}\]

The index \(i\) designates the tubes hit by the muon (see the illustration in Figure 1). \(r_{i,\rm fit}\) is the shortest distance between the fitted track and the anode wire in tube \(i\).

The outlined calibration principle imposes some important prerequisites:

* For all approaches pursued so far (including the study presented here), the muon tracks have to be straight lines in a sufficiently good approximation. In ATLAS the muons to be used for autocalibration will have momenta down to 6 GeV/c (lower

Figure 1: _Illustration of the definition of the fit residuals, shown for the hit in the second tube layer._

selection limit of the low \(p_{T}\) Level 1 muon trigger). Given the magnetic field of up to 1 T, the deviation of a 6 GeV/c muon track from the straight line is only 16 \(\mu\)m within a multilayer; the rms sagita due to multiple scattering is 3 \(\mu\)m. Within the superlayer (chamber) on the other hand the magnetic deviation amounts to 1.5 mm. This is one reason why - with present knowledge - autocalibration has to be done for each multilayer separately. At a later stage one could try to generalize the technique to non-linear tracks using the ATLAS magnetic field map.
* The r-t relationship must be the same in all tubes used for a track fit. This is another argument restricting us to the separate calibration of every individual multilayer. In the two multilayers of a chamber the r-t relationships are generally unequal due to the inhomogeneous magnetic field and perhaps also due to slightly different gas compositions or temperatures.

Our discussion will start in a general, mathematical way: we first want to find the relation between \(\varepsilon(t)\) and \(\Delta_{i}\). This will tell us which information about \(\varepsilon(t)\) is available in \(\Delta_{i}\). In particular we are interested in the question whether \(\varepsilon(t)\) can be uniquely inferred from the residuals measured in a sample of tracks. From experiments it is already known that the spread of the track incidence angles plays a crucial role (see e.g. [1, 2, 3]). Our aim is to explore this issue in a more systematic way.

Based on these insights we shall analyze the conventional realization of autocalibration, develop a new algorithm and discuss its advantages.

Finally a Monte Carlo study of autocalibration for ATLAS MDT chambers with their particular spread of incidence angles will be described.

## 2 An Algebraic Approach to Autocalibration

### The Matrix Equation of Autocalibration

Consider a track fit through \(n\) hits using \(r_{\rm start}(t)\) to convert the measured drift times \(t_{i}\) into hit radii. As defined in (1), \(r_{\rm start}(t)\) is wrong by \(\varepsilon(t)\). Furthermore, each measured drift time has a statistical error

\[\delta t_{i}=t_{i}-t_{i,{\rm mean}} \tag{3}\]

where \(t_{i,{\rm mean}}\) is the mean drift time corresponding to the true distance of the track from the wire. This translates into a statistical error on the measured hit radius

\[r_{i}\equiv r_{\rm start}(t_{i}) \tag{4}\]

which now has two error contributions:

\[r_{i} = r_{\rm start}(t_{i,{\rm mean}})+\frac{dr_{\rm start}}{dt}\delta t _{i} \tag{5}\] \[= r_{\rm true}(t_{i,{\rm mean}\,n})+\varepsilon(t_{i,{\rm mean} })+\frac{dr_{\rm start}}{dt}\delta t_{i}\] \[= r_{\rm true}(t_{i,{\rm mean}\,n})+\varepsilon(t_{i,{\rm mean} })+\delta r_{i}\]Since the fit is determined by the hit radii in all tubes crossed by the track, the residual \(\Delta_{i}\) in a tube \(i\) depends on the deviations \(\varepsilon(t_{k})\) and on the statistical errors \(\delta r_{k}\) in all \(n\) tubes. We express \(\Delta_{i}\) by a Taylor expansion in \(\varepsilon(t_{k})\) and \(\delta r_{k}\):

\[\Delta_{i} = \sum_{k=1}^{n}\frac{d\Delta_{i}}{dr_{k}}\bigg{|}_{\varepsilon(t_{ k})=\delta r_{k}=0}\left[\varepsilon(t_{k})+\delta r_{k}\right]+{\cal O}(2) \tag{6}\]

Assuming a good start r-t relationship (i.e. a small deviation \(\varepsilon(t_{k})\)) we can drop the higher orders and obtain the matrix equation

\[\Delta_{i} = \sum_{k=1}^{n}M_{ik}\left[\varepsilon(t_{k})+\delta r_{k}\right] \tag{7}\]

where we have defined the matrix elements as

\[M_{ik} \equiv \left.\frac{d\Delta_{i}}{dr_{k}}\right|_{\varepsilon(t_{k})= \delta r_{k}=0}\quad. \tag{8}\]

The next step is the determination of these matrix elements. From the definitions (2), (4) and (8) follows

\[M_{ik} = \delta_{ik}-\left.\frac{dr_{i,\rm fit}}{dr_{k}}\right|_{ \varepsilon(t_{k})=\delta r_{k}=0}\quad. \tag{9}\]

where \(\delta_{ik}\) is the Kronecker symbol. The distance of the fitted track

\[y = mz+c \tag{10}\]

from wire \(i\) is

\[r_{i,\rm fit} = \frac{\left|\!\left|m\,z_{i}+c-y_{i}\right|\!\right|}{\sqrt{1+m^{ 2}}}\quad, \tag{11}\]

where \((\,z_{i},y_{i})\) is the position of wire \(i\). Now the derivative \(\frac{dr_{i,\delta_{i}}}{dr_{k}}\) in (9) can be written as

\[\frac{dr_{i,\rm fit}}{dr_{k}} = \frac{\partial r_{i,\rm fit}}{\partial m}\cdot\frac{\partial m}{ \partial r_{k}}+\frac{\partial r_{i,\rm fit}}{\partial c}\cdot\frac{\partial c }{\partial r_{k}}\quad. \tag{12}\]

The terms \(\frac{\partial r_{i,\delta_{1}}}{\partial m}\) and \(\frac{\partial r_{i,\delta_{1}}}{\partial c}\) are calculated from (11). The two other terms \(\frac{\partial m}{\partial r_{k}}\) and \(\frac{\partial c}{\partial r_{k}}\) can be obtained from the \(\chi^{2}\) minimization equations pertaining to the track fit procedure:

\[\frac{\partial\chi^{2}}{\partial m} = 0 \tag{13}\] \[\frac{\partial\chi^{2}}{\partial c} = 0 \tag{14}\]

with

\[\chi^{2} = \sum_{i=1}^{n}\frac{1}{\sigma^{2}\left(r_{i}\right)}[r_{i}-r_{i, \rm fit}(m,\,c)]^{2} \tag{15}\]Differentiation of (13) and (14) with respect to \(r_{k}\) and lengthy algebraic transformations which are displayed in Appendix A finally yield the following expression for the matrix elements:

\[M_{ik} =\delta_{ik}-\mathrm{sgn}\left(\rho_{\mathrm{i,fit}}\right)\mathrm{ sgn}\left(\rho_{\mathrm{k,fit}}\right)\frac{\sum_{\mathrm{l=1}}^{\mathrm{n}} \frac{1}{\sigma^{2}\left(\mathrm{r_{k}}\right)\sigma^{2}\left(\mathrm{r_{l}} \right)}\left(\zeta_{\mathrm{i}}-\zeta_{\mathrm{l}}\right)\left(\zeta_{ \mathrm{l}}-\zeta_{\mathrm{k}}\right)}{\left(\sum_{\mathrm{l=1}}^{\mathrm{n}} \frac{1}{\sigma^{2}\left(\mathrm{r_{l}}\right)}\zeta\right)^{2}-\left(\sum_{ \mathrm{l=1}}^{\mathrm{n}}\frac{1}{\sigma^{2}\left(\mathrm{r_{l}}\right)} \right)\left(\sum_{\mathrm{j=1}}^{\mathrm{n}}\frac{1}{\sigma^{2}\left(\mathrm{ r_{j}}\right)}\zeta_{\mathrm{j}}^{2}\right)} \tag{16}\]

with

\[\zeta_{\mathrm{i}}\equiv\frac{1}{\sqrt{1+m^{2}}}[z_{\mathrm{i}}+m\left(y_{ \mathrm{i}}-c\right)]=\sqrt{1+m^{2}}\,z_{\mathrm{i}}-m\rho_{\mathrm{i,fit}}\quad. \tag{17}\]

\(\rho_{\mathrm{i,fit}}\) is the signed track radius

\[\rho_{\mathrm{i,fit}} = \frac{m\,z_{\mathrm{i}}+c-y_{\mathrm{i}}}{\sqrt{1+m^{2}}} \tag{18}\] \[\left|\rho_{\mathrm{i,fit}}\right| = r_{\mathrm{i,fit}}\] (19) \[\mathrm{sgn}\left(\rho_{\mathrm{i,fit}}\right) = \begin{cases}+1&\quad\text{if the track passes above wire $i$}\\ -1&\quad\text{if the track passes below wire $i$}\end{cases} \tag{20}\]

(The terms "above" and "below" become evident from Figure 1.)

### Autocalibration Constraints for a Given Track

In the previous section we have shown that the fit residuals \(\Delta_{i}\) for a given track can be expressed as a function of the systematic and statistical errors \(\varepsilon(t_{k})\) and \(\delta r_{k}\) of the hit radii with the matrix equation (7). The dimension of the matrix is the number of tubes crossed by the track.

The problem of autocalibration consists in determining \(\varepsilon(t_{k})\) from the \(\Delta_{i}\). As a first step we want to eliminate the statistical error \(\delta r_{k}\). Keeping in mind that the matrix \(M\) depends on \(m\) and \(c\), we average (7) over many tracks with the same slope and intercept, such that \(\left\langle\delta r_{k}\right\rangle\) can be neglected compared to \(\varepsilon\left(t_{k}\right)\). This results in

\[\left\langle\Delta_{i}\right\rangle=\sum_{k=1}^{n}M_{ik}\,\varepsilon\left(t_ {k}\right) \tag{21}\]

Now the straightforward idea is to invert \(M\) and determine all \(\varepsilon(t_{k})\). However, \(M\) turns out to be singular:

\[\mathrm{rank}(M)=\mathrm{dim}(M)-2=n-2 \tag{22}\]

There are only \(n-2\) independent equations, with the consequence that the linear system of equations is underdetermined. We found an algebraical proof for \(\mathrm{rank}(M)\leq n-2\) which is given in Appendix B. This is sufficient to demonstrate the singularity. For the general equality we only have empirical evidence. Intuitively the theorem (22) can be understood by considering that the straight-line fit correlates the \(n\) components \(\Delta_{i}\) by fixing two degrees of freedom, namely \(m\) and \(c\).

The singularity of \(M\) means that to each possible solution \(\varepsilon\left(t\right)\) one can add a function \(\xi\left(t\right)\) obeying to the homogeneous equation

\[0=\sum_{k=1}^{n}M_{ik}\,\xi\left(t_{k}\right) \tag{23}\]

without any change to the observed residuals \(\Delta_{i}\).

**The conclusion from (22) is that in general the fit residuals for a given track do not provide enough information to uniquely infer the impact radii at the measured times \(t_{i}\).**

Later this observation will be generalized to samples of tracks with different intercepts and identical slopes. But before extending the formalism we want to further analyze the amount of information contained in the residuals for a fixed track.

Fortunately there are constraints on the functions of freedom \(\xi\left(t\right)\). We will start with the general treatment of the constraints and then illustrate this complicated matter with some examples.

* Due to the correlation between the drift times in different tubes Equation (23) contains information about the shape of possible functions \(\xi(t)\). See Example 2 further below.
* If two or more of the drift times \(t_{i}\) are equal, the number of independent variables \(\xi\left(t_{k}\right)\) in (23) is reduced and we can replace (23) by an equation where the matrix columns corresponding to equal \(\xi\left(t_{k}\right)\) are added: \[\underbrace{\left(\begin{array}{cccccc}M_{11}&...&M_{1\alpha}&...&M_{1\beta }&...&M_{1n}\\ \vdots&&&&\vdots\\ \vdots&&&&\vdots\\ \vdots&&&&\vdots\\ \vdots&&&&\vdots\\ M_{n1}&...&M_{n\alpha}&...&M_{n\beta}&...&M_{nn}\end{array}\right)}_{n\ \text{columns}}\left( \begin{array}{c}\xi\left(t_{1}\right)\\ \vdots\\ \xi\left(t_{\alpha}\right)\\ \vdots\\ \xi\left(t_{\beta}\right)\\ \vdots\\ \xi\left(t_{n}\right)\end{array}\right)=\vec{0}\qquad\text{with }t_{\alpha}=t_{\beta}\] (24) transforms into \[\underbrace{\left(\begin{array}{cccccc}M_{11}&\cdots&M_{1\alpha}+M_{1\beta }&\cdots&M_{1n}\\ \vdots&&&&\vdots\\ M_{n1}&\cdots&M_{n\alpha}+M_{n\beta}&\cdots&M_{nn}\end{array}\right)}_{n-1\ \text{columns}}\left( \begin{array}{c}\xi\left(t_{1}\right)\\ \vdots\\ \xi\left(t_{\alpha}\right)\\ \vdots\\ \xi\left(t_{n}\right)\end{array}\right)=\vec{0}\] (25) and so on until all involved \(t_{i}\) are different.

[MISSING_PAGE_FAIL:8]

\(Q=1\) characterizes a fixpoint. \(Q=0\) means that \(\xi(t)\) is arbitrary and not constrained at all. This happens in the case \(\alpha=30^{\circ}\), \(r<(\sqrt{3}-1)R\) (see Example 3 further below). \(0<Q<1\) means that the system is not uniquely determined, but the set of possible solutions \(\xi(t)\) is constrained.
3. \(k>l\) is unphysical and does not occur. It would correspond to \(n-l\) contradictory equations for \(n-k<n-l\) variables, implying that there is no function \(\varepsilon(t)\) which could produce the observed residuals.

Note that \(n\) is the number of hits on the track, not the number of tube layers! For example a track through a triple layer can cross more than three tubes (mainly at big angles).

Each constraint on the r-t relationship at a radius \(r\) is contributed by one specific track with intercept \(c\) and slope \(m\) (or angle \(\alpha\)). For a complete characterization of the constraints they would have to be drawn into a three-dimensional diagramme with axes \(\alpha\), \(c\) and \(r/R\), which is hardly feasible. Since in practice the available intercept range is big enough to cover all impact radii in all tube layers whereas the range in \(\alpha\) is limited, the most interesting projection of the \((\alpha,c,r/R)\)-space is the one onto the \((\alpha,r/R)\)-plane. In general the degree of determination \(Q\) in a point \((\alpha,r/R)\) is not unambiguous because there are several tracks with identical \(\alpha\) but different \(c\) giving different amounts of information about the r-t relationship at \(r\) (see Example 6 below). We decided to give for every point in the \((\alpha,r/R)\)-plane the maximum value \(Q_{\max}(\alpha,r/R)\equiv\max\{Q(\alpha,c,r/R)\}\). Such constraint diagrammes are displayed in the Figures 2 to 4. The first of them represents autocalibration for multilayers with three tube layers; the second plot is the analogue for four tube layers. The last figure refers to a common autocalibration for both triple layers of a chamber. These figures have been obtained by a "brute force" search for tracks with identical radii at given incidence angles \(\alpha\), followed by an algebraic evaluation of the respective matrix equations.

* The circular markers denote the fixpoints.
* The dashed lines at \(\alpha=30^{\circ}\) have \(Q=0\).
* The points \((\alpha,r/R)\) lying on the solid lines are defined by tracks where two or more hits have the same drift times (i.e. \(k\geq 1\)), but where one degree of freedom out of \(n-k>1\) in the matrix equation remains undetermined: these points have \(l-k=1\) and thus \(Q=(n-k-1)/(n-k)\). The black (darker) lines stand for \(k=1\) (see also Example 4), the green (lighter) lines for \(k=2,n\geq 4\) (see also Example 6). The condition \(n-k>1\) has the purpose to exclude the case \(n-k=l-k=1\) where the only available degree of freedom is undetermined (\(30^{\circ}\) case). The value of \(n\) relevant for a point \((\alpha,r/R)\) can be looked up in the Figures 5 and 6 for three and four layers respectively.
* The points away from all lines and markers correspond to tracks for which all drift times \(t_{i}\) are different. They have \(k=0\), \(l=2\) and thus \(Q=(n-2)/n\) which is the worst case apart from the \(30^{\circ}\) problem with \(Q=0\).

For all three multilayer configurations there are almost no constraints at track angles around \(30^{\rm o}\). This will be geometrically clarified in Example 3 below. Another difficult angular region is around \(0^{\rm o}\) (see Example 2). The region between about \(5^{\rm o}\) and \(22^{\rm o}\) is rather well constrained. Above about \(35^{\rm o}\) the typical number of hits per layer becomes greater than one and the number of hits per track increases. Therefore the chance for having identical drift times in two hits is enhanced, which leads to a high fixpoint density. Increasing the number of tube layers has the same effect.

A bigger number of hits per track has the additional advantage that the degree of determination for the not fully constrained cases increases: For three hits a track passing all tubes at different radii determines the r-t relationship at these radii with \(Q=1/3\). For four hits this value increases to \(Q=1/2\) and for six hits to \(Q=2/3\). If two track radii are equal (i.e. \(k=1\)) and one degree of freedom is undetermined (i.e. \(l=k+1=2\)), we get \(Q=1/2\) for three hits, \(Q=2/3\) for four hits and \(Q=4/5\) for six hits.

Figure 4 demonstrates that simultaneous autocalibration for all six layers of a chamber would be very advantageous from the point of view of fixpoints. Apart from the difficult region around \(30^{\rm o}\) the density of fixpoints is high. The gap from \(36^{\rm o}\) to \(40^{\rm o}\) in the fixpoint pattern does not constitute a real problem because it is filled by many constraints with one undetermined degree of freedom (like the solid lines in the Figures 2 and 3). These have \(Q\geq 4/5\). Unfortunately, as we have explained in Section 1, a common autocalibration for all six layers of a chamber will not be possible at ATLAS.

Figure 2: _Constraints on the result of autocalibration for a multilayer with 3 tube layers. The picture indicates for every track radius \(r\) the maximum achievable degree of determination from tracks with incidence angle \(\alpha\). The circular markers and the thick line at \(r=0\) represent fixpoints (\(Q=1\)). The explanation why \(r=0\) is a fixpoint for all angles, is given in Example 5. The solid lines correspond to \(Q=(n-k-1)/(n-k)\) (1 undetermined degree of freedom): the black (darker) lines stand for \(k=1\), the green (lighter) lines for \(k=2,n\geq 4\). The dashed line at \(30^{\circ}\) has \(Q=0\). All other points in the plane have \(Q=(n-2)/n\) (2 undetermined degrees of freedom). \(n\) can be looked up in Figure 5._

Figure 3: _Constraints on the result of autocalibration for a multilayer with 4 tube layers. The circular markers and the thick line at \(r=0\) represent fixpoints (\(Q=1\)). The solid lines correspond to Q = \((n-k-1)/(n-k)\): the black (darker) lines stand for \(k=1\), the green (lighter) lines for \(k=2,n\geq 4\). The dashed line at \(30^{o}\) has \(Q=0\). All other points in the plane have \(Q=(n-2)/n\). \(n\) can be looked up in Figure 6. This figure concerns the MDT stations BIS, BIL, BIR, BEE, EIS, EIL._

Figure 4: _Constraints on the result of autocalibration for an entire chamber with two triple layers of tubes (distance between the multilayers: 235mm). For a better visibility only the fixpoints are shown. The worst case at \(30^{o}\) and \(r<0.56\) has \(Q=1/2\). All other points have \(2/3\leq Q<1\)._

Figure 5: _Three tube layers: The colour code (or grey scale) gives the number \(n\) of hits on the track with angle \(\alpha\) determining the r-t relationship at a radius \(r\) with the highest \(Q\)._

Figure 6: _Four tube layers: The colour code (or grey scale) gives the number \(n\) of hits on the track with angle \(\alpha\) determining the r-t relationship at a radius \(r\) with the highest \(Q\)._

#### Examples

After the general treatment we now give typical examples for the most important kinds of constraints. This illustration will concentrate on multilayers with three layers of tubes.

1. **All track radii are different:** Consider e.g. a track with \(\alpha=5^{\mathrm{o}}\) and a track radius \(r_{1}=0.5R\) in the first layer (Figure 7). It has \(n=3\) hits. 

The matrix equation reads \[\vec{0}=\left(\begin{array}{ccc}0.15013&0.31623&0.16610\\ 0.31623&0.66610&0.34987\\ 0.16610&0.34987&0.18377\end{array}\right)\,\left(\begin{array}{c}\xi\left(t \left(0.50R\right)\right)\\ \xi\left(t\left(0.35R\right)\right)\\ \xi\left(t\left(0.80R\right)\right)\end{array}\right)\] Since we cannot reduce the number of variables \(\xi(t(r_{i}))\), we get \(k=0\). Triangularization yields: \[\vec{0}=\left(\begin{array}{ccc}0.15013&0.31623&0.16610\\ 0&0&0\\ 0&0&0\end{array}\right)\,\left(\begin{array}{c}\xi\left(t\left(0.50R \right)\right)\\ \xi\left(t\left(0.35R\right)\right)\\ \xi\left(t\left(0.80R\right)\right)\end{array}\right)\] The two last rows consisting of zeroes we have \(l=2\). Thus the degree of determination is \(Q=\frac{3-2}{3-0}=\frac{1}{3}.\) This means that the r-t relationship can vary freely in any two out of the three involved radii. The third radius (i.e. one out of three) is fixed by the track through the two others.
2. **Fixpoint and symmetry for \(\alpha=0^{\mathrm{o}}\):** The matrix equation for \(\alpha=0^{\mathrm{o}}\) is \[\vec{0}=\left(\begin{array}{ccc}1/6&1/3&1/6\\ 1/3&2/3&1/3\\ 1/6&1/3&1/6\end{array}\right)\,\left(\begin{array}{c}\xi(t(r_{1}))\\ \xi\left(t(R-r_{1})\right)\\ \xi(t(r_{1}))\end{array}\right)\] Since the impact radii in the first and third tube are equal, we can add the first and the third column of the matrix: \[\vec{0}=\left(\begin{array}{ccc}1/3&1/3\\ 2/3&2/3\\ 1/3&1/3\end{array}\right)\,\left(\begin{array}{c}\xi(t(r_{1}))\\ \xi(t\left(R-r_{1}\right))\end{array}\right)\]

Figure 7: _Illustration of Example 1. All impact radii are different. \(Q=1/3.\)_After triangularization we obtain \[\vec{0}=\left(\begin{array}{cc}1/3&1/3\\ 0&0\\ 0&0\end{array}\right)\,\left(\begin{array}{c}\xi(t(r_{1}))\\ \xi(t(R-r_{1}))\end{array}\right)\] For the special track with \(r_{1}=R/2\) (shown in Figure 8a) a further reduction of variables can be done: \[\vec{0}=\left(\begin{array}{c}2/3\\ 0\\ 0\end{array}\right)\,\left(\begin{array}{c}\xi(t(R/2))\end{array}\right)\] In this case we have \(n=3\), \(k=2\), \(l=2\) and thus \(Q=1\), i.e. a fixpoint. All other tracks have \(n=3\), \(k=1\), \(l=2\) and \(Q=1/2\). The matrix equation for general \(r_{1}\) yields a symmetry condition for \(\xi(t(r))\): \[0=\xi(t(r_{1}))+\xi(t(R-r_{1}))\quad.\] \(\xi(t(r))\), i.e. the function by which the calibrated r-t relationship may be wrong, has to be antisymmetric about the fixpoint at \(r=R/2\) (like the two example functions in Figure 8b). 
3. **The problem at \(\alpha=30^{\circ}\):** Tracks passing a triple layer of tubes at an angle of \(30^{\circ}\) can cross three or six tubes, depending on the track intercept (Figure 9). Let us first look at the case with \(n=3\). These tracks pass all tubes on the same side of the wires and at identical impact radii \(r_{i}=r_{1}\). This happens if \(r_{1}<(\sqrt{3}-1)R\) (symbolized by the dashed line in Figure 2). A representative is track 1 in the figure. The corresponding matrix equation \[\vec{0}=\left(\begin{array}{ccc}1/6&-1/3&1/6\\ -1/3&2/3&-1/3\\ 1/6&-1/3&1/6\end{array}\right)\,\left(\begin{array}{c}\xi(t(r_{1}))\\ \xi(t(r_{1}))\\ \xi(t(r_{1}))\end{array}\right)\]

Figure 8: _(a) Illustration of the hit pattern for Example 2. (b) Two freedom functions \(\xi(t(r))\) allowed by tracks with \(\alpha=0^{\circ}\)._

can be reduced by adding all three columns:

\[\vec{0}=\left(\begin{array}{c}0\\ 0\\ 0\end{array}\right)\left(\begin{array}{c}\xi\left(t(r_{1})\right)\end{array}\right)\]

Obviously this equation doesn't provide any constraint on \(\xi\left(t(r_{1})\right)\). We have \(k=2\), \(l=3\) and thus \(Q=0\). This dilemma is also easy to understand intuitively: All measured drift times are equal (in the limit of perfect resolution or infinite statistics). Whatever r-t relationship is used, it will attribute the same radius to all hits, and the fit residuals will be zero. In the case \(n=6\) which happens for \(r_{1}>(\sqrt{3}-1)R\) the situation is better (track 2 in the figure):

\[\vec{0} = \left(\begin{array}{cccccc}0.47619&0.38095&-0.23810&0.09524&0. 04762&-0.19048\\ 0.38095&0.70476&0.20952&-0.12381&0.03810&0.04762\\ -0.23810&0.20952&0.81905&0.15238&-0.12381&0.09524\\ 0.09524&-0.12381&0.15238&0.81905&0.20952&-0.23810\\ 0.04762&0.03810&-0.12381&0.20952&0.70476&0.38095\\ -0.19048&0.04762&0.09524&-0.23810&0.38095&0.47619\end{array}\right)\left( \begin{array}{c}\xi\left(t(r_{1})\right)\\ \xi\left(t(r_{2})\right)\\ \xi\left(t(r_{1})\right)\\ \xi\left(t(r_{2})\right)\\ \xi\left(t(r_{1})\right)\\ \xi\left(t(r_{2})\right)\end{array}\right)\] \[\vec{0} = \left(\begin{array}{cccccc}0.28571&0.28571\\ 0&0\\ 0&0\\ 0&0\\ 0&0\\ 0&0\end{array}\right)\left(\begin{array}{c}\xi\left(t(r_{1})\right)\\ \xi\left(t(r_{2})\right)\\ \xi\left(t(r_{2})\right)\end{array}\right)\] \[\vec{0} = \left(\begin{array}{cccccc}0.28571&0.28571\\ 0&0\\ 0&0\\ 0&0\\ 0&0\\ 0&0\end{array}\right)\left(\begin{array}{c}\xi\left(t(r_{1})\right)\\ \xi\left(t(\sqrt{3}R-r_{1})\right)\end{array}\right)\]

At \(r=\frac{1}{2}\sqrt{3}R\approx 0.866\,R\) we find a fixpoint. At the other radii \(Q=1/2\).

Figure 9: _Hit pattern for Example 3: track 1 doesn’t provide any information about the r-t relationship; track 2 defines a fixpoint at \(r\approx 0.866\,R\)._

4. **One pair of identical radii:** Consider a track with \(\alpha=5^{\circ}\) and track radii \(r_{1}=r_{2}=0.42\,R\), \(r_{3}=0.72\,R\) (Figure 10).

In the matrix equation

\[\vec{0}=\left(\begin{array}{ccc}0.15013&0.31623&0.16610\\ 0.31623&0.66610&0.34987\\ 0.16610&0.34987&0.18377\end{array}\right)\,\left(\begin{array}{c}\xi\left(t \left(r_{1}\right)\right)\\ \xi\left(t\left(r_{1}\right)\right)\\ \xi\left(t\left(r_{3}\right)\right)\end{array}\right)\]

we can add the first two columns and get after triangularization:

\[\vec{0}=\left(\begin{array}{ccc}0.46635&0.16610\\ 0&0\\ 0&0\end{array}\right)\,\left(\begin{array}{c}\xi\left(t\left(r_{1}\right) \right)\\ \xi\left(t\left(r_{3}\right)\right)\end{array}\right)\]

This system has one undetermined degree of freedom: \(l=2\), \(k=1\), \(n=1\); thus \(Q=1/2\). Consequently the points \((5^{\circ},0.42)\) and \((5^{\circ},0.72)\) sit on black solid lines in Figure 2.
5. **One pair of identical radii with fixpoint at _r = 0:_** A peculiar situation happens if the track goes through the wire of an inner layer, like in Figure 11. The radii in the adjacent tubes are then equal and allow the reduction of the matrix equation. \[\vec{0} = \left(\begin{array}{ccc}1/6&\pm 1/3&-1/6\\ \pm 1/3&2/3&\mp 1/3\\ -1/6&\mp 1/3&1/6\end{array}\right)\,\left(\begin{array}{c}\xi\left(t\left(r_ {1}\right)\right)\\ \xi\left(t\left(0\right)\right)\\ \xi\left(t\left(r_{1}\right)\right)\end{array}\right)\] \[\vec{0} = \left(\begin{array}{ccc}0&\pm 1/3\\ 0&0\\ 0&0\end{array}\right)\,\left(\begin{array}{c}\xi\left(t\left(r_{1}\right) \right)\\ \xi\left(t\left(0\right)\right)\end{array}\right)\] The consequence is that \(\xi(t\left(r_{1}\right))\) is completely unconstrained whereas at \(r=0\) there is a fixpoint. It would be worthwile checking whether this feature can be used to solve the \(t_{0}\)-problem, i.e. the determination of the absolute starting point of the drift-time scale.

Figure 10: _Illustration of Example 4 (“single pair”). \(Q=1/2\)._

6. **Two pairs of identical radii without fixpoint:** We now want to convince ourselves that reduction by two variables does not necessarily give rise to fixpoints. An example is shown in Figure 12a, where the track radii in the two outer hits and those in the two inner hits are equal. Now the calibrated r-t relationship can be wrong at both involved radii in a correlated way such that instead of the true track (solid line in the figure) another track (e.g. the dotted line) is reconstructed without any influence on the \(\chi^{2}\) of the fit. In the matrix formalism the situation for \(\alpha=25^{\circ}\), \(r_{1}=0.73\,R\), \(r_{2}=0.91\,R\) looks as follows: \[\vec{0} = \left(\begin{array}{ccc}0.28379&0.37551&-0.12449&-0.21621\\ 0.37551&0.71621&0.21621&-0.12449\\ -0.12449&0.21621&0.71621&0.37551\\ -0.21621&-0.12449&0.37551&0.28379\end{array}\right)\,\left(\begin{array}{c} \xi\left(t(r_{1})\right)\\ \xi\left(t(r_{2})\right)\\ \xi\left(t(r_{1})\right)\end{array}\right)\] \[\vec{0} = \left(\begin{array}{ccc}0.06758&0.25102\\ 0.25102&0.93242\\ 0&0\\ 0&0\end{array}\right)\,\left(\begin{array}{c}\xi\left(t(r_{1})\right)\\ \xi\left(t(r_{2})\right)\end{array}\right)\] \[\vec{0} = \left(\begin{array}{ccc}0.06758&0.25102\\ 0&0\\ 0&0\\ 0&0\end{array}\right)\,\left(\begin{array}{c}\xi\left(t(r_{1})\right)\\ \xi\left(t(r_{2})\right)\end{array}\right)\] With \(n=4\), \(l=3\) and \(k=2\) we find the degree of determination \(Q=1/2\). The point \((25^{\circ},0.91)\) is better determined by another track, parallel to the first one but with a different \(c\). That other track which is shown in Figure 12b has \(k=1\) and \(Q=2/3\). Since Figure 2 gives for every point the highest possible \(Q\), points like \((25^{\circ},0.91)\) are labelled by a black solid line corresponding to \(k=1\) and not by a green line for \(k=2\).

Figure 11: _Illustration of Example 5 (“centred pair”). \(Q=1/2\)._

Let us summarize these technical considerations in simpler words:

So far we have examined the constraints that an individual track contributes to the result of autocalibration. It was shown that only for a few tracks with particular angles and at some discrete radii the calibrated r-t relationship is uniquely determined by the measured track fit residuals. Other, less stringent constraints allow deviations of the r-t relationship, but keep them limited by imposing certain conditions on their shape. Requiring smoothness and monotony for \(r(t)\) enhances the practical importance of these partial constraints.

However, the fixpoint plots show that the individual constraints are not sufficient to obtain an r-t relationship which is correct over the full radial range. The obvious solution is to combine tracks with different angles, each of them contributing its own constraints.

### Autocalibration Constraints Combining Different Tracks

If the only attainment of combining different tracks were a simple collection of the individual fixpoints, the situation would be rather desperate, particularly for three layers: For example, even within the large angular range from \(0^{\circ}\) to \(11^{\circ}\) we would only have three fixpoints and some partial constraints leaving room for deviations. The good news of the following considerations is that a sample of different tracks contains more information than just a linear superposition of the previously derived constraints. Even tracks with identical slopes but different intercepts bear astonishing correlations.

The treatment will start with a general derivation of the additional constraints from combining tracks. Afterwards the full information contained in a sample of tracks with identical slope but the entire range of intercepts will be analyzed. The final step will be the correlation of different track angles.

#### 2.3.1 Fixpoints of Higher Order

Let us assume that we have \(N\) different tracks. Each track \(j\) has \(n_{j}\) hits with impact radii \(r_{ji}\) (\(i=1,\ldots,n_{j}\)) and measured drift times \(t(r_{ji})\). We now merge the individual matrix

Figure 12: Hit pattern for Example 6: (a) “double pair” without fixpoint; the solid line and hit radii represent the true event geometry; the dotted radii correspond to a wrong r-t relationship leading to the dotted track. (b) Alternative track determining \(r=0.91\,R\) with \(Q=2/3\) instead of \(Q=1/2\) like the track in (a).

equations

\[M_{j}\vec{\xi_{j}}=\vec{0}\qquad(j=1,\ldots,N) \tag{28}\]

where

\[\vec{\xi_{j}}\equiv\left(\begin{array}{c}\xi\left(t\left(r_{j\,1} \right)\right)\\ \vdots\\ \xi\left(t\left(r_{j\,n_{j}}\right)\right)\end{array}\right) \tag{29}\]

to one common equation:

\[\underbrace{\left(\begin{array}{cccc}M_{1}&O&\ldots&O\\ O&\ddots&&\vdots\\ \vdots&&\ddots&O\\ O&\ldots&O&M_{N}\end{array}\right)}_{\mathcal{M}}\left(\begin{array}{c} \vec{\xi_{1}}\\ \vdots\\ \vec{\xi_{n}}\end{array}\right)=\vec{0} \tag{30}\]

The common matrix has the properties

\[\dim(\mathcal{M}) = \sum_{j=1}^{N}n_{j} \tag{31}\] \[\mbox{rank}\left(\mathcal{M}\right) = \sum_{j=1}^{N}n_{j}-2N \tag{32}\]

In a similar way as with the normal fixpoints we can try to achieve uniqueness by looking for identical radii. This time however, identical radii are also relevant if they appear in different tracks. Again we assume that the number of independent variables \(\xi\left(t(r_{ji})\right)\) can be reduced by \(k\), and after triangularization of the matrix the number of zero-rows is \(l\). If \(k=l\) we have found a new fixpoint. Note that due to (31) and (32) we need \(k\geq 2N\). A fixpoint created by correlating \(N\) tracks will be called **"fixpoint of \(N^{\mbox{\bf th}}\) order"**.

The mechanism will be illustrated by the discussion of some interesting cases:

#### 2.3.2 Correlation of Tracks with Identical Slope

Consider the two tracks in Figure 13. They have a common incidence angle of \(16.1^{\circ}\). Their impact radii in the first tube are \(r_{1}=0.24\,R\) and \(r_{2}=0.72\,R\) respectively. For the two tracks together only these two different impact radii occur.

The common matrix equation for this two-track system is Due to the equal impact radii we can add the columns 1, 5, 6 and the columns 2, 3, 4:

\[\left(\begin{array}{ccc}0.11468&-0.43578\\ -0.27523&1.04587\\ -0.16055&0.61009\\ -1/2&1/6\\ 1&-1/3\\ 1/2&-1/6\end{array}\right)\left(\begin{array}{ccc}\xi(t(r_{1}))\\ \xi(t(r_{2}))\end{array}\right) = \vec{0}\]

Triangularization and suppression of the zero-rows yields

\[\left(\begin{array}{ccc}0.11468&-0.43578\\ 0&-0.39749\end{array}\right)\left(\begin{array}{ccc}\xi(t(r_{1}))\\ \xi(t(r_{2}))\end{array}\right) = \vec{0}\quad,\]

which is non-singular! This implies that there are two second-order fixpoints at \(r_{1}=0.24\,R\) and \(r_{2}=0.72\,R\) for the angle \(16.1^{\circ}\).

This is a particularly simple example where only two tracks are required. Most other new fixpoints have a higher order. A combinatorical consideration reveals that each point on a solid line for \(\alpha<27.7^{\circ}\) in Figure 2 is a fixpoint of order \(\leq 16\): At each angle in that range there is a set of \(N\leq 16\) tracks for which only \(N\) different impact radii occur. The resulting matrix equation turns out to be non-singular. Intuitively this mechanism can be understood considering that the tracks corresponding to the points on the solid lines have only one undetermined degree of freedom which can be compensated by information from other tracks.

However, in practice fixpoints of high order are not as useful as fixpoints of lower order: Since a high-order fixpoint relies on the equality of radii in many tracks, the statistical effects due to the finite single hit resolution become important and lead to a dilution of these constraints.

We have made a systematic search for fixpoints up to the fourth order, i.e. by looking for correlations between up to four tracks with the same angle. We restricted ourselves to the most critical case of three tube layers and to an angular range range from \(0^{\circ}\) to \(45^{\circ}\). The result is illustrated in Figure 14. We found that at every angle where at least two lines of partial constraint cross each other, there are fixpoints of order \(\leq 4\).

Up to the present these insights are purely empirical. We have no theorem determining the order of a fixpoint from first principles.

Figure 13: _Creation of a second-order fixpoint by correlating the information of track 1 and track 2._

Figure 14: _Fixpoints for three tube layers up to the fourth order: \(\circ\): 1\({}^{\rm st}\) order; \(\bullet\): 2\({}^{\rm nd}\) order; \(\blacklozenge\) order; \(\blacklozenge\) order; \(\blacktriangle\): 4\({}^{\rm th}\) order. The dotted lines correspond to the lines in Figure 2. They represent fixpoints of order \(\leq 16\)._

**Intermediate Conclusion:**

At this stage we know all constraints for a given track angle, provided that the available tracks have enough spread in their intercept to cover the full radial range of the tubes in all layers. Figure 14 shows that in addition to the fundamental fixpoints discussed in the previous section there are fixpoints of higher order, generated by correlation of tracks with different intercepts.

However, even with these new constraints a single track angle is not sufficient for a unique autocalibration result.

The next step is to look for correlations between tracks with different slopes.

#### 2.3.3 Correlation of Tracks with Different Slopes

**a. "Recycling" of Fixpoints**

The first examples will show that the information from two ordinary (first order) fixpoints can be combined to give rise to new fixpoints: Figure 15a shows a track with \(\alpha=5.8^{\rm o}\) and impact radii \(r_{1}=0.67R\), \(r_{2}=0.33R\) and \(r_{3}=0.5R\). At \(r_{3}\) there is a fixpoint for \(\alpha=0^{\rm o}\) (Section 2.2, Example 2), at \(r_{2}\) for \(10.89^{\rm o}\). Since the track under consideration is fixed by \(r_{2}\) and \(r_{3}\), the r-t relationship is now also fixed at \(r_{1}\). We refrain from giving the explicite matrix calculation because it doesn't provide any new knowledge compared to the previous examples which were discussed in full detail.

A second example is given in Figure 15b: \(r_{1}=0\) is fixed by all tracks through the wire in an inner tube layer (Section 2.2, Example 5); \(r_{3}=0.5R\) is a fixpoint for \(\alpha=0^{\rm o}\). Therefore \(r_{2}=0.74\,R\) is determined by a track with \(\alpha=8.3^{\rm o}\) connecting the radii \(r_{1}\) and \(r_{3}\).

This "recycling" mechanism yields fixpoints of third order: We need two tracks defining the ordinary fixpoints and one track connecting them with each other.

## b. Correlations of Tracks without own Fixpoints

The two tracks drawn in Figure 16 have very different incidence angles and do not define any fixpoints on their own. Nevertheless the combined matrix equation has a unique solution for \(\xi\left(t\left(0.24R\right)\right)\) and \(\xi\left(t\left(0.72R\right)\right)\).

The condition for observing this correlation is the availability of tracks with incidence angles of \(0^{\circ}\) and \(16.1^{\circ}\). At ATLAS very few chambers will dispose of such a wide angular range.

Up to the third order we did not find many representatives of this class of fixpoints.

## c. Evaluation of Higher Order Fixpoints

A complete search for the fixpoints of order \(>1\) is very difficult because for many of them a high number of tracks with sometimes very different angles has to be correlated. We have not found any algorithm determining the full set. However, the practical importance of fixpoints from tracks with very different angles is small anyway because at ATLAS the angular spread of muon tracks will be very limited (cf. Appendix C).

More relevant are the sets of fixpoints that are available for a given angular range. In Figure 17 we have collected all the fixpoints up to the third order which we found in the intervals between angles with primary fixpoints (\([0^{\circ},11^{\circ}]\), \([11^{\circ},30^{\circ}]\) and \([30^{\circ},44^{\circ}]\)) and in some narrower intervals around angles with primary fixpoints (\([0^{\circ},9^{\circ}]\), \([6^{\circ},17^{\circ}]\) and \([22^{\circ},37^{\circ}]\)). Note that these fixpoints require the presence of the entire interval. Most of them are generated by the "recycling" mechanism and disappear when the angles with primary fixpoints are not available. This is well visible comparing diagrams (a) and (d) or - in an even more impressive way - comparing (c) and (f). If the angular interval around \(30^{\circ}\) is narrower than \([21^{\circ},38^{\circ}]\), the only remaining fixpoint is the primary one at \((\alpha,r/R)=(30^{\circ},0.866)\).

Figure 16: _Example for the creation of second order fixpoints by correlating a track at \(0^{\circ}\) and a track at \(16.1^{\circ}\). The impact radii are \(r_{1}=0.24R\) and \(r_{2}=0.72R\)._

## 3 Autocalibration Methods and their Performance

Up to this point we have investigated the fundamental capabilities of autocalibration. The constraints discussed in the previous section constitute the complete information provided by the measured track residuals. We have shown that even by mixing tracks with a wide range of angles the r-t relationship is not fixed at every radius. Hence in the strict mathematical sense the result of autocalibration is not unambiguous. However, in practice we need to know the r-t relationship only at a finite number of drift times, usually every 10 ns. Therefore we have some hope that the density of constraints is high enough for a practically unique determination of \(r(t)\). Before investigating this question in a Monte Carlo study of autocalibration at ATLAS, we shall focus on technical realizations of the autocalibration principle.

We shall first look at the classical autocalibration technique and ask how it takes advantage of the available information. Afterwards we shall tackle the challenge of finding an algorithm making maximum use of the autocalibration constraints.

### The Conventional Autocalibration Technique

As we have said in the short introduction in Section 1, autocalibration is an iterative method. In every iteration \(\nu\) the current estimate \(r^{(\nu)}(t)\) for \(r_{\text{true}}(t)\) serves for a track fit, then the residuals (2) are measured and used to determine a correction to the current r-t relationship.

In the classical method the residuals from a track fit are histogrammed as a function of the drift time. However, for a given track the residuals in the individual tube layers are different and cannot be merged in one common histogramme: the track fit is most

Figure 17: _Fixpoints up to the third order for three layers. The solid circles on the right hand side of the radial axes indicate the positions of fixpoints from correlations between tracks with different angles. All markers on the left hand side correspond to fixpoints contributed by the individual angles. The primary fixpoints are symbolized by open squares, the secondary and tertiary ones by open circles._determined by the hits in the outer layers. This means that for a given deviation of the current r-t relationship from the true one, the residuals are biggest in the inner tubes2. Therefore conventional autocalibration only uses the residuals in one of the inner tube layers, i.e. \(\Delta_{2}\) in the case of three layers and \(\Delta_{2}\) or \(\Delta_{3}\) in the case of four layers. These residuals are then averaged over many tracks within about 50 drift-time slices and directly applied as correction to the current estimate \(r^{(\nu)}(t)\):

Footnote 2: These facts are fully expressed by the matrix equation (21). Here we have only put some of its aspects into simpler words.

\[r^{(\nu+1)}(t)=r^{(\nu)}(t)-\langle\Delta_{2}(t)\rangle \tag{33}\]

with \(r^{(0)}(t)=r_{\rm start}(t)\).

The algorithm sequence (track fit \(\rightarrow\) histogramming \(\Delta_{2}\) versus \(t_{2}\)\(\rightarrow\) correction of \(r(t)\)) is repeated until the \((t_{2},\Delta_{2})\)-distribution is a flat band centred at zero (Figure 18).

Figure 18: _Residuals in the middle tube layer versus drift time in that layer. (a) at the first iteration; (b) at the 11\({}^{\rm th}\) iteration. This autocalibration was done for the angular range of the chamber BML 4 (\([24^{\circ},33^{\circ}]\))._

With the notation of the matrix formalism this approach is equivalent to the assumption

\[\langle\Delta_{2}\left(t_{2}\right)\rangle\quad=\qquad\qquad\varepsilon\left(t_{ 2}\right) \tag{34}\]

instead of the correct matrix equation

\[\langle\Delta_{i}(t_{i},\alpha)\rangle=\sum_{k=1}^{n}M_{ik}\left(\alpha\right) \varepsilon\left(t_{k}\right) \tag{35}\]

Apparently the assumption (34) is a very strong approximation. It has the following consequences:

* The information contained in the residuals is not correctly used.
* One aspect of the information is completely ignored: The residuals are only distinguished by the drift time \(t_{2}\), while their angular dependence is not taken into account.
* In the case of three hits it is justified to only use \(\Delta_{2}\) because according to Eq. (22) for a track with \(n=3\) hits there is only \(n-2=1\) independent residual. We would preserve the full information by exploiting \[\langle\Delta_{2}\left(t_{2},\alpha\right)\rangle=\sum_{k=1}^{3}M_{2k}\left( \alpha\right)\varepsilon\left(t_{k}\right)\quad.\] On the other hand, for \(n>3\) information is lost if only the residual in one tube is analyzed. In the four-layer case there have been attempts to scale the residuals of different layers with respect to each other in order to fill them into a common histogramme. However, the scale factors derived at \(\alpha=0^{\circ}\) failed for other angles, which is no big surprise considering the angular dependence of the matrix.

Later (Section 6.2) we shall see that these problems result in a rather slow convergence if the typical incidence angle of the tracks is in a range with poor constraints and if the angular spread is low. In those cases also the final calibration precision suffers.

Looking at the oversimplification passing from (35) to (34), it is even surprising that the conventional autocalibration technique converges at all. Our attempt of explanation is the following:

For simplicity we assume \(n=3\) and focus on the residual in the middle tube. By ignoring the angular dependence of the residuals the old autocalibration averages the matrix elements over the angle:

\[\langle\Delta_{2}(t_{2},\alpha)\rangle_{\alpha}=\sum_{k=1}^{3}\langle M_{2k} \left(\alpha\right)\rangle_{\alpha}\,\varepsilon\left(t_{k}\right) \tag{36}\]

A detailed analysis of the angular dependence of \(M_{2k}\) reveals that the non-diagonal elements do not always vary smoothly with \(\alpha\). When the slope is changed such that in layer \(k\) a different tube is hit, the non-diagonal element \(M_{2k}\) changes sign, while the diagonal elements don't do so. Thus, if the angular spread is big, the non-diagonal elements average out:

\[\langle\Delta_{2}(t_{2},\alpha)\rangle_{\alpha}\stackrel{{\rm wide \leavevmode\nobreak\ spread\leavevmode\nobreak\ in\leavevmode\nobreak\ \alpha}}{{\approx}}\langle M_{22}(\alpha)\rangle_{\alpha}\,\varepsilon\left(t_{k }\right) \tag{37}\]Now the basic mist ake in the assumption of the old technique is the missing factor \(\langle M_{22}(\alpha)\rangle_{\alpha}\) which can be compensated by a bigger number of iterations. An example is given in Figure 19 where the distributions of the matrix elements \(M_{21}\), \(M_{22}\) and \(M_{23}\) are shown for the large angular range \([0^{\circ},25^{\circ}]\) as it is available at the ATLAS chamber BOL 1. Under such favourable conditions the algorithm converges rather fast and yields a good precision (an rms deviation less than \(20\,\mu\)m).

For low angular spread the non-diagonal elements remain important, as is visible in Figure 20 for the range \([24^{\circ},33^{\circ}]\). We shall see that for such low spreads conventional autocalibration has difficulties.

### Fitting the Global Matrix Equation

Confronted with the disadvantages of the conventional autocalibration, we have developed an alternative technique with the design goal of making optimum use of all available information in the residuals. This new method is closely related to the global matrix equation (30) for a sample of different tracks, discussed in connection with the higher-order fixpoints. The difference is that instead of the homogeneous equation for the freedom function \(\xi(t)\)

Figure 19: _Distribution of the matrix elements \(M_{21}\), \(M_{22}\) and \(M_{23}\) for the angular range of tracks through BOL 1 (\([0^{\circ},25^{\circ}]\), see Appendix C)._

Figure 20: _Distribution of the matrix elements \(M_{21}\), \(M_{22}\) and \(M_{23}\) for the angular range of tracks through EOL 6 (\([24^{\circ},33^{\circ}]\), see Appendix C)._

we now exploit the inhomogeneous equation involving \(\varepsilon(t)\) and \(\vec{\Delta}\):

\[\underbrace{\left(\begin{array}{cccc}M_{1}&O&\ldots&O\\ O&\ddots&&\vdots\\ \vdots&&\ddots&O\\ O&\ldots&O&M_{N}\end{array}\right)}_{\mathcal{M}}\left(\begin{array}{c}\vec{ \varepsilon_{1}}+\vec{\delta r_{1}}\\ \vdots\\ \vec{\varepsilon_{N}}+\vec{\delta r_{N}}\end{array}\right)=\left(\begin{array} []{c}\vec{\Delta}_{1}\\ \vdots\\ \vec{\Delta}_{N}\end{array}\right) \tag{38}\]

\(M_{j}\) (\(j=1,\ldots,N\)) are the matrices belonging to the \(N\) individual tracks in the considered sample. Like in the old autocalibration technique the tracks are fitted using a start r-t relationship which deviates from the true r-t relationship by the function \(\varepsilon(t)\). The deviations at the impact radii of a track \(j\) with \(n_{j}\) hits are given by the vector

\[\vec{\varepsilon}_{j}\equiv\left(\begin{array}{c}\varepsilon(t(r_{j\,1})) \\ \vdots\\ \varepsilon(t(r_{j\,n_{j}}))\end{array}\right)\quad. \tag{39}\]

Furthermore there are statistical errors

\[\vec{\delta r_{j}}\equiv\left(\begin{array}{c}\delta r_{j\,1}\\ \vdots\\ \delta r_{j\,n_{j}}\end{array}\right) \tag{40}\]

on the hit radii which we no longer neglect because the rows in (38) represent individual tracks, not the average over many tracks with given \(m\) and \(c\). After the fit every track has a residual vector

\[\vec{\Delta}_{j}\equiv\left(\begin{array}{c}\Delta_{j\,1}\\ \vdots\\ \Delta_{j\,n_{j}}\end{array}\right)\quad. \tag{41}\]

The matrices \(M_{j}\) for every track are estimated from the fit result \((m,\,c)\) using Eq. (16).

An algebraic inversion of (38) to obtain \(\varepsilon(t)\) is not possible:

* Due to the unknown statistical terms \(\vec{\delta r_{j}}\) there is no exact solution \(\varepsilon(t)\).
* Even if we neglect \(\vec{\delta r_{j}}\) and reduce the number of columns with the scheme explained in Section 2.3, the matrix remains singular in general. We cannot rely on the hypothetically possible case that an extremely good angular spread provides enough constraints for a unique determination of \(\varepsilon(t)\) for all \(t\) occurring in the considered sample of tracks.

We still found a viable solution for extracting maximum information from (38):

* For track reconstruction it is sufficient to know the r-t relationship and hence \(\varepsilon(t)\) in time bins of about 10 ns width. Therefore we can discretize \(\varepsilon(t)\) in 70 time slices and thus reduce the dimension of the vector \(\vec{\varepsilon}\) to 70. Consequently the global matrix has 70 columns. If several drift times of one track end up in the same time bin, the matrix columns corresponding to these hits are summed.

* For an application in practice it is appropriate to keep in mind that every track has only \(n_{j}-2\) independent residuals and matrix rows. We can therefore reduce the number of rows to process from \(N_{\rm tot}\equiv\sum_{j=1}^{N}n_{j}\) to \(N_{\rm ind}\equiv\sum_{j=1}^{N}(n_{j}-2)\) by only keeping independent rows.
* By virtue of the two reduction steps the full matrix \({\cal M}\) with dimension \(N_{\rm tot}\times N_{\rm tot}\) is replaced by a smaller matrix \(\tilde{\cal M}\) with dimension \(N_{\rm ind}\times 70\). The resulting matrix equation looks like the following: \[N_{\rm ind}\ {\rm rows}\ \Bigg{\{}\quad\underbrace{\left(\begin{array}{c} \tilde{\cal M}\\ \tilde{\cal M}\end{array}\right)}_{70\ {\rm time\ bins}}\left(\begin{array}{c} \varepsilon\left(t_{1}\right)\\ \vdots\\ \varepsilon(t_{70})\end{array}\right)\,=\,\left(\begin{array}{c}\Delta_{1} \\ \vdots\\ \Delta_{N_{\rm ind}}\end{array}\right)-\left(\begin{array}{c}D_{1}\\ \vdots\\ D_{N_{\rm ind}}\end{array}\right)\] (42) where we have arranged the contributions from statistical errors (i.e. the independent rows of \({\cal M}\cdot\left(\tilde{\delta r}_{1},\ldots\tilde{\delta r}_{N}\right)^{ \rm T}\)) in the terms \(D_{i}\) on the right side.
* Without statistical errors the 70 components \(\varepsilon(t_{i})\) would obey to \[\left(\begin{array}{c}\tilde{\cal M}\\ \tilde{\cal M}\end{array}\right)\left(\begin{array}{c}\varepsilon(t_{1})\\ \vdots\\ \varepsilon(t_{70})\end{array}\right)\,=\,\left(\begin{array}{c}\Delta_{1} \\ \vdots\\ \Delta_{N_{\rm ind}}\end{array}\right)\] (43) Since we do have errors, we determine the \(\varepsilon(t_{i})\) by minimizing \[\chi^{2}\,\equiv\sum_{i=1}^{N_{\rm ind}}\frac{1}{\sigma^{2}(\Delta_{i})} \left[\Delta_{i}-\sum_{k\,=\,1}^{70}\tilde{\cal M}_{ik}\,\varepsilon(t_{k}) \right]^{2}\] (44) with \[\sigma\left(\Delta_{i}\right)=\sqrt{\sum_{k\,=\,1}^{70}\left[\tilde{\cal M}_ {ik}\,\sigma(r_{k})\right]^{2}}\] (45) where \(\sigma\left(r_{k}\right)\) is the spatial tube resolution at the radius \(r_{k}\) corresponding to the time \(t_{k}\).
* As an alternative to the variation of all 70 components \(\varepsilon\left(t_{i}\right)\) in the fit, we parametrized \(\varepsilon\left(t\right)\) with a sum of sine functions: \[\varepsilon(t)=\sum_{l=1}^{20}p_{l}\,\sin(l\,\pi\,\frac{t}{t_{\rm max}})\quad.\] (46) This allowed us to reduce the number of fit parameters from 70 to 20. The chosen parametrization function has the property of vanishing at \(t=0\) and \(t=t_{\rm max}\) which is reasonable because the start r-t relationship can be chosen to match in these two points. The advantage of the parametrization is a reduction of computing time while the precision was observed to remain unaffected.

This new method uses the full information from the individual matrix equations. Section 6.2 will demonstrate that it has the advantage of very fast convergence: With good angular spread only two iterations are needed. Furthermore, for low angular spread and angles around \(30^{\circ}\) the precision of the calibrated r-t relationship is significantly better than with the conventional method.

## 4 Autocalibration Tests in Monte Carlo -

The Procedure

To judge the performance of the two autocalibration techniques, we performed a Monte Carlo study. This has several advantages with respect to using data from test beams:

* The distribution of incidence angles, i.e. our main point of interest, can be varied at will. In test beams on the other hand only very limited angular ranges can be achieved by rotating the prototype chambers with respect to the beam. A free choice of the angular distribution is particularly important for studying autocalibration at ATLAS (Section 6.2).
* Individual components of the tube response can be switched on and off.
* The problems of autocalibration can be isolated from other difficulties: In real data analysis we suffer from \(t_{0}\) problems, wire displacements, misalignment etc. which mix with the effects to be investigated.

The tests were done in the following way:

1. Generation of tracks through a multilayer with ideal geometry (no wire displacements). The number of tube layers per multilayer could be chosen. The distribution of track intercepts was flat within an interval whose width was such that in every layer at least one tube was fully illuminated. The angular distribution could be custom-designed.
2. The track impact radius in every crossed tube was converted into a drift time using the full response function3\(P(t|r)\) for Ar/CO\({}_{2}\) as measured in a test beam [5] with the Silicon microstrip tracker ODYSSEUS [6]. Footnote 3: \(P(t|r)\) is the probability density for measuring a drift time \(t\) at a given track radius \(r\).
3. A start r-t relationship was used to convert the drift times into hit radii.
4. Tracks were fitted to the hit radii.
5. The r-t relationship was corrected according to either the old or the new method.
6. The steps 3 to 5 were iterated until our convergence criterion was fulfilled: We expect a statistical precision of the order (\(\sigma/\sqrt{N}\,\sim\,100\,\mu\)m/\(\sqrt{N}\), where \(\sigma\) is the single tube resolution and \(N\) the number of tracks. Therefore we considered the calibration as converged when the rms change of the r-t relationship between subsequent iterations was smaller than this expected precision. For 10000 tracks the convergence criterion is 1 \(\mu\)m.

7. The final r-t relationship was compared to the true one used in step 2. The calibration precision was quantified by the rms deviation \[\mathrm{rms}(\Delta\mathrm{r})\equiv\sqrt{\frac{1}{t_{\mathrm{max}}}\int_{0}^{t_{ \mathrm{max}}}[\mathrm{r}_{\mathrm{calib}}(t)-\mathrm{r}_{\mathrm{true}}(t)]^{2 }\,\mathrm{dt}}\quad.\] (47)

## 5 Comment on Autocalibration near the Wire

For impact radii \(r<2\)mm the conditional drift-time distributions \(P(t|r)\) are asymmetric leading to biases in the reconstruction of tracks passing near a wire [7, 5]. To treat the domain near the wire correctly, a maximum-likelihood track fit involving the full knowledge about the tube response is necessary. In principle this is also true for autocalibration. However, the likelihood technique reconstructs the track radii directly from the drift times without introducing hit radii. Thus there are no residuals to which the matrix formalism could be applied. A genuine "maximum-likelihood autocalibration" would require a completely new concept which we decided to postpone unless it would prove to be inevitable.

It turned out that autocalibration with ordinary least-squares fits can give satisfactory results even at small radii:

After a Monte Carlo autocalibration we have to compare the final r-t relationship with the correct \(r_{\mathrm{true}}(t)\) from the event generation. But how should \(r_{\mathrm{true}}(t)\) be defined in terms of \(P(t|r)\)? In [7] we have expressed \(P(t|r)\) by three parameters:

* \(p_{1}(r)\): amount of asymmetry of \(P(t|r)\); \(0\leq p_{1}\leq 1\).
* \(p_{2}(r)\): most probable drift time for a track radius \(r\).
* \(p_{3}(r)\): time resolution at a track radius \(r\).

Figure 21: Comparison of the autocalibration result with the “true” r-t relationship \(r_{\mathrm{true}}(t)\). Two definitions of \(r_{\mathrm{true}}(t)\) were tried: (a) \(r_{\mathrm{true}}(t)\equiv\rho(t)\) (peak position); (b) \(r_{\mathrm{true}}(t)\equiv\langle r(t)\rangle\). This autocalibration with the new method was based on 100000 tracks with the angular spread of the chamber BOL 1.

One possible definition of \(t\left(r\right)\) is the peak position \(p_{2}(r)\); then \(r(t)\) is defined as the inverse function \(\rho(t)\equiv(p_{2}^{-1})(t)\). Unfortunately this definition is inadequate for autocalibration because both autocalibration techniques converge to the mean radius \(\left\langle r\left(t\right)\right\rangle=\int r\,P(r|t)\,dr\) for a given time \(t\) rather than to \(\rho(t)\). If we define \(r_{\text{true}}(t)\equiv\rho(t)\), there is a systematic deviation at low drift times (Figure 21a). If on the other hand \(\left\langle r\left(t\right)\right\rangle\) is taken as reference, the deviation disappears (Figure 21b).

Of course, comparing the calibrated r-t relationship with \(\left\langle r\left(t\right)\right\rangle\) instead of \(\rho(t)\) does not solve the fundamental problem of asymmetric time distributions near the wire. Individual tracks reconstructed with the least-squares method will still have biases if their drift times are just converted into the corresponding \(\left\langle r\left(t\right)\right\rangle\). However, since we know asymmetry \(p_{1}(r)\) and resolution \(p_{8}\left(r\right)\) from test beams, it will be possible to construct the full \(P(t|r)\) from the autocalibrated \(\left\langle r\left(t\right)\right\rangle\).

In other words, autocalibration determines one component of \(P(t|r)\), namely the mean radius as a function of \(t\). The other components of the response must be injected from external knowledge.

## 6 Autocalibration at ATLAS

In this section we shall analyze the performances of the two autocalibration techniques applied to the track-angle distributions as they will be present in the individual ATLAS chambers. The main aim of the study is to know whether the angular spread is sufficient to calibrate the r-t relationship with an rms precision better than the desired \(20\,\mu\)m (see [8]). We are also interested in the statistics required for calibrating an r-t relationship. This will allow us to estimate the time needed for collecting enough data for a calibration of the entire muon spectrometer.

### Determination of the Angular Spread in ATLAS MDT Chambers

The general Monte Carlo procedure was already described in Section 4. However, we still need to determine the distribution of track incidence angles for every MDT chamber in ATLAS.

In Section 1 we have reasoned that for autocalibration at ATLAS all muons with transverse momenta above \(6\,\)GeV/c will be usable in the sense of having a track curvature which can be neglected within a multilayer. Since this lower limit coincides with the threshold of the low \(p_{T}\) level 1 muon trigger, all muonic events selected by the ATLAS trigger strategy can be used.

To measure the distributions of track incidence angles in all different chambers, a full detector simulation with the programme DICE was done. At the ATLAS vertex 24000 single muons were generated with transverse momenta above \(6\,\)GeV/c distributed according to the inclusive muon cross-section shown in Figure 22b. Due to the strong decrease of the cross-section with increasing \(p_{T}\) we introduced an upper cut-off at \(60\,\)GeV/c. The pseudo-rapidity distribution of the generated muons was flat in \([-2.7,2.7]\) (cf. Figure 22a).

To reduce the required number of muons for this simulation, we took advantage of the eight-fold azimuthal symmetry of the muon spectrometer (see Figure 28): equivalent chambers at the same radial and longitudinal position but in different octants were not distinguished. The results for all chamber types together with drawings specifying their locations in the detector are shown in Appendix C.

Generating all muons at the vertex is an approximation which is not fully valid for the muons from pion and kaon decays which take place mainly in the calorimeter. If these muons came from significantly different directions, the total angular spread would increase. To investigate this suspicion, we simulated 4000 events of the class \(\mathrm{b\,\overline{b}}\to\mu\,\mathrm{X}\) with at least one muon above \(6\,\mathrm{GeV/c}\). In the hadronization phase many pions and kaons are formed and decay into soft muons. The resulting angular spread turned out not to be significantly different from the one obtained with muons generated at the vertex.

### Precision of Autocalibration for all MDT Chambers

For every type of MDT chambers 10000 tracks were generated with an angular distribution according to the histogrammes in Appendix C. As start r-t relationship a Garfield [10] prediction with an rms deviation of about \(140\,\mu\mathrm{m}\) was chosen rather than an unfolded \(r(t)\)[4] in order not to treat the most optimistic case.

Before summarizing the performance of autocalibration for all types of MDT chambers we focus on two examples:

1. BOL 1 has a very wide angular spread in a range with sufficient constraints: \(\alpha\,\epsilon\,[0^{\circ},\,25^{\circ}]\) (see Appendix C).
2. EOL 6 has only angles in a narrow range around \(30^{\circ}\): \(\alpha\,\epsilon\,[24^{\circ},\,33^{\circ}]\).

Figure 23 shows the deviation \(\varepsilon^{(\nu)}(t)\) of the current \(r^{(\nu)}(t)\) from \(r_{\mathrm{true}}(t)\) at the iterations \(\nu=1,\,2,\,6\) for the chamber BOL 1. The solid lines represent the real \(\varepsilon(t)\), while the dashed lines stand for the estimate from autocalibration. The latter are the corrections which are applied to \(r^{(\nu)}(t)\) at the end of the current step. The left-hand plots show the

Figure 22: _Simulated inclusive cross-section for primary collision products [9]: (a) as a function of the rapidity, integrated over \(3<p_{T}<50\,\mathrm{GeV}\); (b) as a function of \(p_{T}\), integrated over \(|\eta|<2.7\)._

performance of conventional autocalibration while the right-hand plots give the results of the new method. Apparently for this advantageous angular spread both methods converge rather quickly. This is even more clearly visible in Figure 24a where the rms deviation (defined in Eq. (47)) is drawn as a function of the iteration number.

The new method reaches the optimum already in the first iteration whereas the classical technique needs five iterations. Both methods have the peculiar behaviour of finally converging at a level which is slightly worse than the optimum. In both cases the precision is better than \(20\,\mu\)m.

The difference between the two techniques is much more accentuated in the second example (Figure 24b) where the incidence angles range in a narrow interval with few

Figure 23: _True and reconstructed deviation \(\varepsilon^{(\nu)}(t)=r^{(\nu)}(t)-r_{\rm true}(t)\) after the iterations \(\nu=1,2,6\) of an autocalibration for BOL 1 chambers. The left-hand plots are for the old method_, the right-hand plots for the new method. For iteration 1 the true \(\varepsilon^{(1)}(t)\) characterizes the start r-t relationship.

[MISSING_PAGE_EMPTY:38]

of the statistics. For a precision better than 20 \(\mu\)m the BOL 1 chambers with excellent angular spread need about 3000 events if the new method is applied and 6000 if we do classical autocalibration. For very bad angular spread (e.g. chamber EOL 6) about 7000 tracks are necessary with the new method whereas the old method comes close to 20 \(\mu\)m only if 100000 tracks are available.

The final precision and the necessary number of iterations for all types of ATLAS MDT chambers are summarized in Table 1. The following concluding observations can be made:

* With good angular spread both methods give similar precision. For one chamber type out of 79 the old technique is better by a fraction of a micron, for all the others the new method is superior. The distributions of the final rms deviations are plotted in Figure 26.
* The number of iterations needed is histogrammed in Figure 27. The new method needs typically two iterations. For the classical method typically five iterations are sufficient if the angular spread is good.
* The advantage of the new method is particularly accentuated if the incidence angles lie predominantly in the interval \([22^{\circ},37^{\circ}]\). Note that in this interval there is only one fixpoint up to the third order! Apparently the new method makes better use of higher-order constraints. The difference between the two techniques is best visible at the following chambers where at least one method yields a precision worse than 20 \(\mu\)m: 
 The indicated angular range represents intervals centred about the mean and containing 95 % of all entries. It is difficult to characterize these irregular angular distributions with only two numbers. The behaviour of autocalibration is determined by the full distribution (see Appendix C).

The new technique can calibrate 78 out of 79 chamber types with an rms precision better than 20 \(\mu\)m if for each calibration 10000 tracks are available. With the old method 9 chamber types have a precision worse than 20 \(\mu\)m.

Figure 27: _Distributions of the number of iterations needed for convergence with 10000 tracks. (a) represents the classical method, (b) the new method._

Figure 26: _Distributions of the rms deviation of the calibrated r-t relationship. (a) represents the classical method, (b) the new method._

\begin{table}
\begin{tabular}{|c||c|c|c|c|c|c|c|c|} \hline \multirow{2}{*}{Station} & \multicolumn{6}{c|}{Location index along \(z\) (Barrel) or \(r\) (End-Cap)} \\  & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\ \hline \hline \multirow{2}{*}{BIS} & 14.1 (9) & 14.7 (13) & 19.7 (29) & 16.1 (18) & 14.4 (7) & 14.1 (12) & 14.4 (6) & 14.2 (13) \\  & 11.6 (2) & 13.9 (2) & 13.8 (2) & 11.5 (2) & 13.7 (1) & 11.5 (1) & 12.8 (2) & 12.4 (1) \\ \hline \multirow{2}{*}{BIL} & 16.2 (5) & 17.1 (18) & 31.6 (27) & 13.9 (14) & 13.4 (7) & 13.9 (6) & \multirow{2}{*}{} & \multirow{2}{*}{} \\  & 14.0 (2) & 11.2 (2) & 11.9 (2) & 11.9 (2) & 10.6 (2) & 13.3 (1) & & \\ \hline \multirow{2}{*}{BMS} & 15.8 (5) & 17.6 (19) & 15.5 (24) & 15.5 (16) & 15.3 (5) & 11.4 (4) & \multirow{2}{*}{} & \multirow{2}{*}{} \\  & 12.6 (1) & 14.6 (2) & 13.2 (2) & 12.7 (2) & 11.4 (1) & 11.6 (2) & & \\ \hline \multirow{2}{*}{BML} & 16.2 (6) & 15.9 (20) & 18.6 (22) & 14.4 (11) & 15.1 (5) & 15.2 (6) & \multirow{2}{*}{} & \multirow{2}{*}{} \\  & 13.4 (2) & 14.5 (3) & 13.4 (3) & 13.8 (3) & 13.9 (1) & 14.3 (2) & & \\ \hline \multirow{2}{*}{BOS} & 14.1 (4) & 18.1 (18) & 16.9 (21) & 14.8 (9) & 12.8 (4) & 13.0 (7) & \multirow{2}{*}{} & \multirow{2}{*}{} \\  & 13.3 (2) & 13.1 (1) & 13.2 (2) & 14.0 (2) & 12.1 (2) & 11.5 (1) & & \\ \hline \multirow{2}{*}{BOL} & 17.9 (7) & 15.9 (12) & 15.7 (19) & 14.8 (19) & 16.1 (5) & 13.7 (6) & \multirow{2}{*}{} & \multirow{2}{*}{} \\  & 13.2 (2) & 12.7 (1) & 14.0 (2) & 12.7 (2) & 14.5 (1) & 11.9 (1) & & \\ \hline \multirow{2}{*}{BIR} & 18.9 (15) & 14.5 (5) & 15.3 (20) & 27.3 (29) & 15.3 (18) & 15.2 (6) & 15.1 (6) & \multirow{2}{*}{} \\  & 15.6 (3) & 13.2 (1) & 14.2 (2) & 13.9 (3) & 14.2 (2) & 11.6 (2) & 12.9 (2) & \\ \hline \multirow{2}{*}{BEE} & 13.8 (3) & 12.9 (4) & & & & & \\  & 11.9 (1) & 12.2 (1) & & & & & \\ \hline \hline \multirow{2}{*}{EIS} & 15.5 (10) & 39.1 (34) & & & & & & \\  & 12.5 (2) & 13.5 (4) & & & & & \\ \hline \multirow{2}{*}{EIL} & 16.0 (13) & 16.6 (40) & failed & 16.5 (24) & & & \\  & 14.6 (2) & 11.5 (2) & 39.1 (11) & 12.8 (2) & & & \\ \hline \multirow{2}{*}{EES} & 15.0 (38) & 17.7 (19) & & & & & \\  & 14.0 (3) & 14.2 (2) & & & & & \\ \hline \multirow{2}{*}{EEL} & 29.0 (40) & 17.5 (30) & & & & & \\  & 12.9 (2) & 11.5 (2) & & & & & \\ \hline \multirow{2}{*}{EMS} & 18.8 (13) & 16.3 (15) & 16.9 (16) & 18.3 (27) & 16.5 (27) & & \multirow{2}{*}{} \\  & 16.8 (2) & 13.4 (2) & 16.5 (3) & 13.5 (2) & 13.1 (2) & & \\ \hline \multirow{2}{*}{EML} & 15.5 (13) & 17.2 (8) & 15.7 (39) & 28.0 (26) & 14.3 (19) & & \multirow{2}{*}{} \\  & 13.4 (2) & 13.9 (2) & 12.9 (2) & 11.6 (2) & 13.6 (2) & & \\ \hline \multirow{2}{*}{EOS} & 20.8 (34) & 16.6 (5) & 15.5 (10) & 17.9 (10) & 19.8 (20) & 20.9 (28) & \multirow{2}{*}{} \\  & 18.2 (3) & 14.4 (1) & 14.2 (2) & 14.1 (2) & 13.9 (3) & 13.0 (3) & \\ \hline \multirow{2}{*}{EOL} & 18.1 (24) & 16.1 (5) & 17.5 (13) & 14.7 (19) & 32.7 (29) & 41.4 (46) & \multirow{2}{*}{} \\  & 13.5 (2) & 12.7 (2) & 13.2 (2) & 13.7 (2) & 13.5 (3) & 16.3 (8) & \\ \hline \end{tabular}
\end{table}
Table 1: _RMS deviation of the autocalibrated r-t relationship in microns for all types of ATLAS MDT chambers. In every double row the upper number refers to the conventional method, the lower number to the new technique. The number of iterations needed for convergence is indicated in brackets. The convergence criterion is that subsequent r-t relationships have an rms difference smaller than \(1\mu m\). Every calibration was done with 10000 events. For the BIR chambers the location indices must be reduced by 1. They start with 0 for the chambers centred at \(z=0\)._Conclusions

An algebraic investigation of the autocalibration principle led to a matrix equation relating the fit residuals to the deviation of the used r-t relationship from the true one. Since for a fixed track angle this matrix equation is - in general - singular, a unique calibration of the r-t relationship is impossible if only tracks with one angle are available. However, tracks with certain incidence angles can determine the r-t relationship uniquely at certain radii (fixpoints); other tracks contribute weaker constraints. For a given angular range the achievable calibration precision is given by the radial density of constraints available in this angular range. For track angles around \(30^{\circ}\) the result of autocalibration is very poorly constrained. The calibration precision suffers particularly if mainly angles in the interval \([22^{\circ},37^{\circ}]\) contribute. This happens for 9 out of 79 chamber types in ATLAS. In these pathological cases the classical autocalibration technique applied to samples of 10000 tracks yields an rms calibration precision worse than \(20\,\mu\)m because the little amount of information contained in the track fit residuals is not optimally used.

Another difficult angular region is the one around \(0^{\circ}\).

The interval \([5^{\circ},22^{\circ}]\) provides a rather big density of constraints. The same is true for angles greater than \(37^{\circ}\) where more and more tubes are hit by a track.

We have developed an improved autocalibration method which is based on a matrix formalism. It was designed to take optimum advantage of all available information. With this method even the difficult \(30^{\circ}\) chambers can be calibrated with a precision better than \(20\,\mu\)m (apart from one exception). In all other cases the precision of the new method is only slightly better than that of the old technique, but less iterations are needed.

Derivation of the Autocalibration Matrix Elements

According to Equations (8) and (9) the matrix elements are given by

\[M_{ik}\,=\,\frac{d\Delta_{i}}{dr_{k}}\Bigg{|}_{e\in[t_{k})=\delta r_{k}=0}\,=\, \delta_{ik}\,-\,\frac{dr_{i,\,\rm fit}}{dr_{k}}\Bigg{|}_{e\in[t_{k})=\delta r_{k }=0}\quad, \tag{48}\]

where

\[r_{i,\,\rm fit}\,=\,\frac{\big{|}mz_{i}+c-y_{i}\big{|}}{\sqrt{1+m^{2}}} \tag{49}\]

is the distance of the fitted track \(y=mz+c\) from wire \(i\) with the position \((z_{i},y_{i})\). We write the derivative \(\frac{dr_{i,\,\rm fit}}{dr_{k}}\) as

\[\frac{dr_{i,\,\rm fit}}{dr_{k}}=\frac{\partial r_{i,\,\rm fit}}{\partial m} \cdot\frac{\partial m}{\partial r_{k}}+\frac{\partial r_{i,\,\rm fit}}{ \partial c}\cdot\frac{\partial c}{\partial r_{k}}\quad. \tag{50}\]

and must now calculate the four partial derivatives in that expression.

For convenience we first recall some definitions and abreviations:

\[\zeta_{i}\,=\sqrt{1+m^{2}}\,z_{i}-m\;\rho_{i,\,\rm fit}\quad, \tag{51}\]

\[\big{|}\rho_{i,\,\rm fit}\big{|} = r_{i,\,\rm fit} \tag{52}\] \[\mathrm{sgn}\,(\rho_{i,\,\rm fit}) = \begin{cases}+1&\quad\mbox{if the track passes above wire $i$}\\ -1&\quad\mbox{if the track passes below wire $i$}\end{cases} \tag{53}\]

In addition we define

\[s_{i}\equiv\mathrm{sgn}\,(\rho_{i,\rm fit})\quad. \tag{54}\]

From (49) we obtain by simple differentiation:

\[\frac{\partial r_{i,\,\rm fit}}{\partial m} = \frac{1}{1+m^{2}}\,[\mathrm{sgn}(\rho_{i,\rm fit})\,\mathrm{z_{i} }\,\sqrt{1+m^{2}}-r_{i,\,\rm fit}\,\mathrm{m}]=\frac{1}{1+m^{2}}\,\mathrm{s_{ i}}\;\zeta_{i} \tag{55}\] \[\frac{\partial r_{i,\,\rm fit}}{\partial c} = \frac{1}{\sqrt{1+m^{2}}}\,s_{i} \tag{56}\]

The other two terms are determined by minimizing

\[\chi^{2}\,=\sum_{i=1}^{n}\frac{1}{\sigma^{2}\,(r_{i})}[r_{i}-r_{i,\,\rm fit}(m,\,c)]^{2} \tag{57}\]

with respect to \(m\) and \(c\) in the track fit :

\[0 \stackrel{{!}}{{=}} \frac{\partial\chi^{2}}{\partial m}=-\sum_{i=1}^{n}\frac{2}{\sigma ^{2}\,(r_{i})}[r_{i}-r_{i,\,\rm fit}]\frac{\partial r_{i,\,\rm fit}}{\partial m} \tag{58}\] \[0 \stackrel{{!}}{{=}} \frac{\partial\chi^{2}}{\partial c}=-\sum_{i=1}^{n}\frac{2}{\sigma ^{2}\,(r_{i})}[r_{i}-r_{i,\,\rm fit}]\frac{\partial r_{i,\,\rm fit}}{\partial c} \tag{59}\]Inserting (55) and (56) we get

\[0 = \sum_{i=1}^{n}\frac{1}{\sigma^{2}(r_{i})}[r_{i,\rm{fit}}-r_{i}]\;s_{i }\;\zeta_{i} \tag{60}\] \[0 = \sum_{i=1}^{n}\frac{1}{\sigma^{2}(r_{i})}[r_{i,\rm{fit}}-r_{i}]\;s_ {i} \tag{61}\]

Now we differentiate (60) and (61) with respect to \(r_{k}\):

\[0 = \sum_{i=1}^{n}s_{i}\left\{-\frac{2}{\sigma^{3}(r_{i})}\,\frac{d \sigma}{dr}\,\delta_{ik}\;[r_{i,\rm{fit}}-r_{i}]\,\zeta_{i}\right. \tag{62}\] \[\left.\qquad\quad+\frac{1}{\sigma^{2}(r_{i})}\left[\left(\frac{ dr_{i,\rm{fit}}}{dr_{k}}-\delta_{ik}\,\right)\,\zeta_{i}+(r_{i,\rm{fit}}-r_{i}) \frac{d\zeta_{i}}{dr_{k}}\right]\right\}\] \[0 = \sum_{i=1}^{n}s_{i}\left\{-\frac{2}{\sigma^{3}(r_{i})}\frac{d \sigma}{dr}\,\delta_{ik}\;[r_{i,\rm{fit}}-r_{i}]+\frac{1}{\sigma^{2}(r_{i})} \left[\frac{dr_{i,\rm{fit}}}{dr_{k}}-\delta_{ik}\right]\right\} \tag{63}\]

Insertion of (50) and

\[\frac{d\zeta_{i}}{dr_{k}} = \left[z_{i}\,\frac{m}{\sqrt{1+m^{2}}}-\rho_{i,\rm{fit}}-\zeta_{i} \,\frac{m}{1+m^{2}}\right]\frac{\partial m}{\partial r_{k}}-\frac{m}{\sqrt{1+ m^{2}}}\frac{\partial c}{\partial r_{k}} \tag{64}\] \[= -\frac{1}{1+m^{2}}\,\rho_{i,\rm{fit}}\,\frac{\partial m}{\partial r _{k}}-\frac{m}{\sqrt{1+m^{2}}}\frac{\partial c}{\partial r_{k}}\]

yields the equations

\[0 = \sum_{i=1}^{n}\left\{\frac{\partial m}{\partial r_{k}}\,\frac{1} {\sigma^{2}(r_{i})}\frac{1}{1+m^{2}}\left[\zeta_{i}^{2}\,+(r_{i}-r_{i,\rm{fit} })r_{i,\rm{fit}}\right]\right. \tag{65}\] \[\left.\qquad+\frac{\partial c}{\partial r_{k}}\,\frac{1}{\sigma^ {2}(r_{i})}\frac{1}{\sqrt{1+m^{2}}}\left[\zeta_{i}+s_{i}(r_{i}-r_{i,\rm{fit} })\right]\right.\] \[\left.\qquad-\frac{1}{\sigma^{2}(r_{i})}\,\delta_{ik}\;s_{i}\; \zeta_{i}+\frac{2}{\sigma^{3}(r_{i})}\,\delta_{ik}\;s_{i}\;\zeta_{i}(r_{i}-r_ {i,\rm{fit}})\,\frac{d\sigma}{dr}\right\}\] \[0 = \sum_{i=1}^{n}\left\{\frac{\partial m}{\partial r_{k}}\,\frac{1} {\sigma^{2}(r_{i})}\frac{1}{1+m^{2}}\zeta_{i}\right.\] (66) \[\left.\qquad+\frac{\partial c}{\partial r_{k}}\,\frac{1}{\sigma^ {2}(r_{i})}\frac{1}{\sqrt{1+m^{2}}}\right.\] \[\left.\qquad-\frac{1}{\sigma^{2}(r_{i})}\,\delta_{ik}\;s_{i}+ \frac{2}{\sigma^{3}(r_{i})}\,\delta_{ik}\;s_{i}(r_{i}-r_{i,\rm{fit}})\,\frac{d \sigma}{dr}\right\}\]

Writing (65) and (66) in the form

\[0 = A_{k}\;\frac{\partial m}{\partial r_{k}}+B_{k}\;\frac{\partial c }{\partial r_{k}}+C_{k} \tag{67}\] \[0 = D_{k}\;\frac{\partial m}{\partial r_{k}}+E_{k}\;\frac{\partial c }{\partial r_{k}}+F_{k} \tag{68}\]with

\[A_{k} = \sum_{i=1}^{n}\frac{1}{\sigma^{2}(r_{i})}\frac{1}{1+m^{2}}\left[ \zeta_{i}^{2}\,+\,(r_{i}-r_{i,\text{fit}})r_{i,\text{fit}}\right] \tag{69}\] \[B_{k} = \sum_{i=1}^{n}\frac{1}{\sigma^{2}(r_{i})}\frac{1}{\sqrt{1+m^{2}}} \left[\zeta_{i}\,+\,s_{i}\,(r_{i}-r_{i,\text{fit}})\right]\] (70) \[C_{k} = \sum_{i=1}^{n}\left[-\frac{1}{\sigma^{2}(r_{i})}\,\delta_{ik}\;s_ {i}\;\zeta_{i}+\frac{2}{\sigma^{3}(r_{i})}\,\delta_{ik}\;s_{i}\;\zeta_{i}\,(r_{ i}-r_{i,\text{fit}})\,\frac{d\sigma}{dr}\right]\] (71) \[D_{k} = \sum_{i=1}^{n}\frac{1}{\sigma^{2}(r_{i})}\frac{1}{1+m^{2}}\zeta_ {i}\] (72) \[E_{k} = \sum_{i=1}^{n}\frac{1}{\sigma^{2}(r_{i})}\frac{1}{\sqrt{1+m^{2}}}\] (73) \[F_{k} = \sum_{i=1}^{n}\left[-\frac{1}{\sigma^{2}(r_{i})}\,\delta_{ik}\;s _{i}\;\zeta_{i}+\frac{2}{\sigma^{3}(r_{i})}\,\delta_{ik}\;s_{i}\;\zeta_{i}\,( r_{i}-r_{i,\text{fit}})\;\frac{d\sigma}{dr}\right] \tag{74}\]

we recognize that we have to deal with a linear system of equations which we can resolve for \(\frac{\partial m}{\partial r_{k}}\) and \(\frac{\partial c}{\partial r_{k}}\):

\[\frac{\partial m}{\partial r_{k}} = \frac{C_{k}\;E_{k}-B_{k}\;F_{k}}{B_{k}\;D_{k}-A_{k}\;E_{k}} \tag{75}\] \[\frac{\partial c}{\partial r_{k}} = \frac{A_{k}\;F_{k}-C_{k}\;D_{k}}{B_{k}\;D_{k}-A_{k}\;E_{k}} \tag{76}\]

Since (48) requires the derivatives to be evaluated at \(\varepsilon(t_{k})=\delta r_{k}=0\), we have to set

\[r_{i}=r_{i,\text{fit}} \tag{77}\]

in the coefficients \(A_{k}\) to \(F_{k}\). Thus we obtain

\[\frac{\partial m}{\partial r_{k}}\bigg{|}_{\varepsilon(t_{k})= \delta r_{k}=0} = (1+m^{2})\;s_{k}\;\frac{\sum_{l=1}^{n}\frac{1}{\sigma^{2}(r_{ k})\sigma^{2}(r_{l})}\;(\zeta_{l}-\zeta_{k})}{\left(\sum_{l=1}^{n}\frac{1}{ \sigma^{2}(r_{l})}\zeta_{l}\right)^{2}-\left(\sum_{l=1}^{n}\frac{1}{\sigma^{2} (r_{l})}\right)\left(\sum_{j=1}^{n}\frac{1}{\sigma^{2}(r_{j})}\zeta_{j}^{2}\right)} \tag{78}\] \[\frac{\partial c}{\partial r_{k}}\bigg{|}_{\varepsilon(t_{k})= \delta r_{k}=0} = \sqrt{1+m^{2}}\;s_{k}\;\frac{\sum_{l=1}^{n}\frac{1}{\sigma^{2} (r_{k})\sigma^{2}(r_{l})}\zeta_{l}\;\left(\zeta_{k}-\zeta_{l}\right)}{\left( \sum_{l=1}^{n}\frac{1}{\sigma^{2}(r_{l})}\zeta_{l}\right)^{2}-\left(\sum_{l=1 }^{n}\frac{1}{\sigma^{2}(r_{l})}\right)\left(\sum_{j=1}^{n}\frac{1}{\sigma^{2} (r_{j})}\zeta_{j}^{2}\right)} \tag{79}\]

Finally we can collect the terms (55), (56), (78) and (79) in (50), then (48) gives us the result:

\[M_{ik}\,=\delta_{ik}-\operatorname{sgn}\left(\rho_{\mathrm{i,fit}}\right) \operatorname{sgn}\left(\rho_{\mathrm{k,fit}}\right)\frac{\sum_{ \mathrm{l=1}}^{\mathrm{n}}\frac{1}{\sigma^{2}\left(\mathrm{r_{k}}\right) \sigma^{2}\left(\mathrm{r_{l}}\right)}\left(\zeta_{\mathrm{i}}-\zeta_{\mathrm{l }}\right)\left(\zeta_{\mathrm{l}}-\zeta_{\mathrm{k}}\right)}{\left(\sum_{ \mathrm{l=1}}^{\mathrm{n}}\frac{1}{\sigma^{2}\left(\mathrm{r_{l}}\right)} \zeta_{\mathrm{l}}\right)^{2}-\left(\sum_{\mathrm{l=1}}^{\mathrm{n}}\frac{1}{ \sigma^{2}\left(\mathrm{r_{l}}\right)}\right)\left(\sum_{\mathrm{j=1}}^{ \mathrm{n}}\frac{1}{\sigma^{2}\left(\mathrm{r_{j}}\right)}\zeta_{\mathrm{j}}^ {2}\right)} \tag{80}\]

## Appendix B Proof of \(\operatorname{rank}(M)\leq\operatorname{dim}(M)-2\) for the

Autocalibration Matrix \(M\)

Let \(M\) be the autocalibration matrix as given in (16). It has the dimension \(n\).

We will show that \(M\) has only \(n-2\) linearly independent rows \(\vec{M}_{i}\). For this purpose it is sufficient to prove the equation

\[\vec{0}=\sum_{i\,=1}^{n}\,s_{i}\,w_{i}\,\left(\zeta_{j}-\zeta_{i}\right)\vec{ M}_{i}\qquad\forall j\,\epsilon\left\{1,\ldots n\right\} \tag{81}\]

where we have introduced the abbreviations

\[s_{i}\equiv\operatorname{sgn}(\rho_{\mathrm{i}}) \tag{82}\] \[w_{i}\equiv\frac{1}{\sigma^{2}\left(r_{i}\right)} \tag{83}\]

Equation (81) is equivalent to

\[\vec{M}_{k}\,=\sum_{i\,\{1,\ldots n\}\setminus\{k\}}s_{i}\,s_{k}\frac{w_{i}}{ w_{k}}\,\frac{\zeta_{j}-\zeta_{i}}{\zeta_{j}-\zeta_{k}}\,\vec{M}_{i}\qquad\forall j,k\,\epsilon\left\{1,\ldots n\right\},j\neq k \tag{84}\]

which means that any row \(\vec{M}_{k}\) can be expressed by a linear combination of all other rows except one to which we have given the index \(j\). The contribution of \(\vec{M}_{j}\) vanishes. Other contributions cannot be zero because by geometry \(i\neq j\Rightarrow\zeta_{i}\neq\zeta_{j}\). With other words, \(\vec{M}_{k}\) is a linear combination of \(n-2\) other rows, which is what we want to show.

To ease the manipulations with (81), we first multiply it by

\[D\equiv\left(\sum_{l=1}^{n}w_{l}\,\zeta_{l}\right)^{2}-\left(\sum_{l=1}^{n}w_{ l}\right)\left(\sum_{j=1}^{n}w_{j}\,\zeta_{j}^{2}\right) \tag{85}\]

and work on the right side of (81) for the \(k^{\mathrm{th}}\) column. In the first step we replace \(M_{ik}\) by the explicite expression (16):\[\sum_{i\,=1}^{n}\,D\,s_{i}\,w_{i}\,\left(\zeta_{j}-\zeta_{i}\right)M_{ik}=\] \[= \sum_{i}\delta_{ik}\;s_{i}\,w_{i}\,\left(\zeta_{j}-\zeta_{i}\, \right)\left[\left(\sum_{\alpha}w_{\alpha}\zeta_{\alpha}\right)^{2}-\left(\sum_ {\alpha}w_{\alpha}\right)\left(\sum_{\alpha}w_{\alpha}\zeta_{\alpha}^{2}\right) \right]\] \[+\sum_{i}w_{k}\,w_{i}\;s_{k}\,\left(\zeta_{j}-\zeta_{i}\right) \left[\sum_{\alpha}w_{\alpha}\zeta_{\alpha}^{2}+\sum_{\alpha}w_{\alpha}\zeta_ {i}\zeta_{k}-\left(\zeta_{i}+\zeta_{k}\,\right)\sum_{\alpha}w_{\alpha}\zeta_{ \alpha}\right]\]

Now all we have to do is to transform this expression until it yields zero:

\[\sum_{i\,=1}^{n}\,D\,s_{i}\,w_{i}\,\left(\zeta_{j}-\zeta_{i} \right)M_{ik}=\] \[= s_{k}\;w_{k}\,\left(\zeta_{j}-\zeta_{k}\right)\left[\sum_{\alpha }w_{\alpha}^{2}\zeta_{\alpha}^{2}+2\sum_{\alpha>\beta}w_{\alpha}\,w_{\beta}\; \zeta_{\alpha}\;\zeta_{\beta}-\sum_{\alpha,\beta}w_{\alpha}\,w_{\beta}\;\zeta_ {\beta}^{2}\right]\] \[+s_{k}\,w_{k}\,\sum_{i}w_{i}\,\left(\zeta_{j}-\zeta_{i}\right) \sum_{\alpha}w_{\alpha}\,\left(\zeta_{\alpha}^{2}+\zeta_{i}\;\zeta_{k}-\zeta_ {i}\;\zeta_{\alpha}-\zeta_{k}\;\zeta_{\alpha}\right)\] \[= s_{k}\;w_{k}\left\{\left(\zeta_{j}-\zeta_{k}\right)\left[\sum_{ \alpha}w_{\alpha}^{2}\zeta_{\alpha}^{2}+2\sum_{\alpha>\beta}w_{\alpha}\,w_{ \beta}\;\zeta_{\alpha}\;\zeta_{\beta}-\sum_{\alpha}w_{\alpha}^{2}\zeta_{\alpha }^{2}-\sum_{\alpha>\beta}w_{\alpha}\,w_{\beta}\;\zeta_{\beta}^{2}-\sum_{ \alpha>\beta}w_{\alpha}\,w_{\beta}\;\zeta_{\alpha}^{2}\right]\right.\] \[\left.+\zeta_{j}\sum_{\alpha,\beta}w_{\alpha}\,w_{\beta}\left[ \zeta_{\alpha}^{2}+\zeta_{k}\left(\zeta_{\beta}-\zeta_{\alpha}\right)-\zeta_ {\alpha}\zeta_{\beta}\right]-\sum_{\alpha,\beta}w_{\alpha}\,w_{\beta}\;\zeta_{ \beta}\,\left[\zeta_{\alpha}^{2}+\zeta_{k}\left(\zeta_{\beta}-\zeta_{\alpha} \right)-\zeta_{\alpha}\zeta_{\beta}\right]\right\}\] \[= s_{k}\;w_{k}\left\{-(\zeta_{j}-\zeta_{k}\,)\sum_{\alpha>\beta}w_{ \alpha}\,w_{\beta}\;(\zeta_{\alpha}-\zeta_{\beta})^{2}+\zeta_{j}\sum_{\alpha >\beta}w_{\alpha}\,w_{\beta}\;\zeta_{\alpha}\left(\zeta_{\alpha}-\zeta_{\beta }\right)+\zeta_{j}\sum_{\alpha>\beta}w_{\alpha}\,w_{\beta}\;\zeta_{\beta}( \zeta_{\beta}-\zeta_{\alpha})\right.\] \[\left.-\zeta_{k}\,\sum_{\alpha>\beta}w_{\alpha}\,w_{\beta}\;\zeta_ {\beta}\left(\zeta_{\beta}-\zeta_{\alpha}\right)-\zeta_{k}\sum_{\alpha>\beta} w_{\alpha}\,w_{\beta}\;\zeta_{\alpha}\left(\zeta_{\alpha}-\zeta_{\beta}\right)\right\}\] \[= s_{k}\;w_{k}\,\left(\zeta_{j}-\zeta_{k}\right)\left\{-\sum_{ \alpha>\beta}w_{\alpha}\,w_{\beta}\;(\zeta_{\alpha}-\zeta_{\beta})^{2}+\sum_{ \alpha>\beta}w_{\alpha}\,w_{\beta}\;\zeta_{\alpha}\left(\zeta_{\alpha}-\zeta_ {\beta}\right)-\sum_{\alpha>\beta}w_{\alpha}\,w_{\beta}\;\zeta_{\beta}(\zeta_ {\alpha}-\zeta_{\beta})\right\}\] \[= 0\]

q.e.d.

[MISSING_PAGE_EMPTY:48]

Figure 30: _Longitudinal cut through a large sector of the muon spectrometer._

Figure 29: _Longitudinal cut through a small sector of the muon spectrometer._

[MISSING_PAGE_EMPTY:50]

## Appendix A

## Appendix A

## Appendix A

## Appendix A

## Appendix AThe station BIR 0 does not get any hits with the simulation software used (DICE 3.21). From the chamber position and geometry (radial position of the chamber centre: \(r=5.8\,\)m: position of chamber centre along the beam direction: \(z=0\); chamber width: \(\Delta z=0.54\,\)m) one can infer the approximate angular range of \([-5^{\circ},+5^{\circ}]\).

## Appendix A

## Appendix A

[MISSING_PAGE_EMPTY:64]

[MISSING_PAGE_EMPTY:65]

## References

* [1] G. Viehhauser: Detector Physics of the ATLAS precision muon chambers, PhD Thesis, CERN 1996.
* [2] T. Sammer: Autokalibration von Driftrohrkammern fur das ATLAS-Myon-spektrometer, diploma thesis, LMU Munich, May 1997.
* [3] P. Creti et al.: Testbeam Results from the Calypso MDT Chamber, ATLAS Note ATL-MUON-97-196, 1997.
* [4] M. Deile, N.P. Hessey: Obtaining the Space-Time Relationship of Drift Tubes from the Drift-Time Spectrum, ATLAS Note ATL-MUON-99-002, 1999.
* [5] M. Deile: Optimization and Calibration of the Drift-Tube Chambers for the ATLAS Muon Spectrometer, doctoral thesis, LMU Munich, May 2000, available from: [http://www.etp.physik.uni-muenchen.de/atlas/](http://www.etp.physik.uni-muenchen.de/atlas/)
* a Silicon Telescope for Test Beam Experiments, System Description and User Manual for the Data Analysis, ATL-COM-MUON-99-015, CERN 1999, available on the WWW-page: [http://www.etp.physik.uni-muenchen.de/atlas/testbeam.html](http://www.etp.physik.uni-muenchen.de/atlas/testbeam.html)
* [7] M. Deile, N.P. Hessey, A. Staude: MDT Track Fitting with the Maximum Likelihood Method, ATLAS Note ATL-MUON-98-240, CERN 1998.
* [8] ATLAS Collaboration: ATLAS Technical Proposal, CERN/LHCC 94-43, LHCC/P2, 1994.
* [9] A. Cheplakov et al.: Muon Rates in ATLAS, ATLAS Note ATL-MUON-93-21, CERN 1993.
* [10] R. Veenhof, GARFIELD: Simulation of gaseous detectors, CERN, writeup: [http://wwwinfo.cern.ch/writeup/garfield](http://wwwinfo.cern.ch/writeup/garfield)
* [11] ATLAS Collaboration: Muon Spectrometer Technical Design Report, CERN/LHCC 97-22, June 1997.