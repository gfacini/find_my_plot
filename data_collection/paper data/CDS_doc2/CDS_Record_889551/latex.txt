**ATLAS Inner Detector Performance with the Rome-Initial Layout**

**Alan Poppleton**

European Organization for Nuclear Research - CERN

**Nektarios Ch. Benekos**

Max-Planck-Institut for Physik

**Roger Clifft, Stephen Dallison**

Rutherford Appleton Laboratory

**Grant Gorfine**

University of Wuppertal

The performance of the ATLAS Inner Detector with the Rome-Initial Layout has been studied for single muons using the Geant4 framework and the iPatRec software package. The results have been assessed and compared with those derived within the Geant3 framework for the DC1 layout. No significant change in performance as measured by transverse impact parameter or \(p_{T}\) resolution is visible but a small decrease in longitudinal impact parameter resolution is observed, attributed to increased pixel size.

Systematic shifts away from the truth, in the mean reconstructed track momentum were found during the studies. Some of these deviations are shown. An explanation for the problem has recently been found. The solution is discussed and some corrected results are shown.

Introduction

The performance of the ATLAS Inner Detector has been measured with single muon data sets generated using the Rome-Initial layout, within the framework of the Geant4 software package. The iPatRec algorithm[1] has been used for the study. The significance of the results is discussed and compared with previous results derived using the DC1 layout within the Geant3 framework.

An outline of the Inner Detector, with relevant layout details and geometrical parameters can be found in a previous note[2]. The layout developments since DC1 are summarised in Section 2.

A short description of the data sets and software used for these studies is given in Section 3.

Data showing the performance of the iPatRec algorithm are given in Section 4. The mean and width of the fitted track-parameter pull distributions and the track-finding efficiency are presented.

Impact parameter and transverse momentum resolutions for single muons are given in Section 5. Muons have been used throughout the study as they provide the optimum resolutions achievable. The behaviour of the resolution is presented as a function of \(|\eta|\) and \(p_{T}\), discussed in terms of detector performance, and compared with the values derived with the DC1 layout.

During the study a downward shift of up to 1.5%, was observed in the fitted value of the track momentum. Some results from an investigation into the problem are shown. Recent studies have identified Geant4 tracking tolerances to be the source of the problem. These studies are presented and some corrected results are shown.

Finally, a summary and some conclusions are given in Section 7.

## 2 The ATLAS Inner Detector

An outline of the Inner Detector[3][4], with relevant layout details and geometrical parameters has been presented in a previous note[2]

### Inner Detector Developments since DC1

The Inner Detector has been in a state of continuous evolution up to the present time. Engineering developments and cost limitations have necessitated changes to the layout geometry and detector materials. Changes since the DC1 layout with which the present results are compared include:

* removal of pixel layer 2 and pixel wheel 2;
* longitudinal pitch of the innermost pixel layer (b-layer) increased from 300 \(\mu\)m to 400 \(\mu\)m;

. increased thickness of b-layer from 200 \(\mu\)m to 250 \(\mu\)m;

. removal of C-wheels of TRT (those covering \(|\eta|>2\)).

The SCT Lorentz angle was changed to be compatible with recent testbeam measurements[5]. In the SCT barrel, the tilt angle was increased from 10\({}^{o}\) to 11\({}^{o}\), resulting in a Lorentz angle change from 8\({}^{o}\) to 6.5\({}^{o}\). A more accurate detector response model gave an increase in clustering rates to be compatible with those observed at the test beam. In principle, this should produce a slight precision increase. An Inner Detector re-optimisation has resulted in a slight shift in the position of the endcap SCT wheels. A further development since DC1 has been the change to a'slower' gas mixture in the TRT. This has improved the TRT positional resolution from 170 \(\mu\)m to 140 \(\mu\)m (rms per drift hit).

## 3 Data Sets and Software

The present study was performed using the iPatRec[1] offline reconstruction package which has been continuously evolving with significant changes since DC1. Geant4 was used for the simulation, with digitization and detector response optimised by matching to recent test-beam results. The input EDM (event data model) for the reconstruction phase consisted of RDO (raw data object) collections processed using the standard Inner Detector raw data preparation algorithms up to and including Space Point formation. Geomodel was used throughout the processing chain to provide a consistent Detector Description.

Single muon datasets were simulated and digitized using release 9.0.4 at \(p_{T}=1\) and 5 GeV/c, and release 10.0.1 at \(p_{T}=20\), 100 and 1000 GeV/c. No significant change was made to the relevant Inner Detector code between these releases. In all cases the iPatRec reconstruction was performed using release 10.0.4.

## 4 Pull Distributions, Tails and Efficiencies

The track reconstruction quality is measured from the pulls of the fitted perigee parameter distributions. The perigee is expressed with respect to the nominal beam-axis.

The pull distributions exhibit Gaussian peaks with non-Gaussian tails arising from lower quality tracks. The pull mean and sigma is obtained from a Gaussian fit to the core of the distribution (\(\pm 3\sigma\)), with the tail defined to be the fraction outside this core region.

The means and sigmas of the pull distributions for the fitted parameters, \(d_{0}\), \(z_{0}\),\(1/p_{T}\), \(\phi\) and \(cot\theta\), are shown at five representative momenta, for the barrel and end-cap regions separately, in Tables 1 to 4. All the quoted values have a statistical error of \(\pm\) 0.03. With the exception of the \(1/p_{T}\) and \(\phi\) distributions, discussed in Section 6, they are centered on zero within these errors.

\begin{table}
\begin{tabular}{|l|l|l|l|l|l|} \hline \(p_{T}(GeV/c)\) & \(d_{0}\) & \(z_{0}\) & \(1/p_{T}\) & \(\phi\) & \(\cot\theta\) \\ \hline
1 & \(0.02\) & \(-0.01\) & \(0.08\) & \(-0.02\) & \(0.00\) \\ \hline
5 & \(-0.02\) & \(-0.02\) & \(0.03\) & \(-0.03\) & \(0.01\) \\ \hline
20 & \(-0.04\) & \(-0.03\) & \(0.13\) & \(-0.06\) & \(0.03\) \\ \hline
100 & \(-0.06\) & \(-0.02\) & \(0.32\) & \(-0.09\) & \(0.02\) \\ \hline
1000 & \(0.10\) & \(0.00\) & \(0.02\) & \(-0.18\) & \(0.00\) \\ \hline \end{tabular}
\end{table}
Table 1: Mean of the Pull distributions in the barrel region (\(|\eta|<0.8\)).

\begin{table}
\begin{tabular}{|l|l|l|l|l|l|} \hline \(p_{T}(GeV/c)\) & \(d_{0}\) & \(z_{0}\) & \(1/p_{T}\) & \(\phi\) & \(\cot\theta\) \\ \hline
1 & \(-0.01\) & \(0.01\) & \(-0.04\) & \(0.01\) & \(0.01\) \\ \hline
5 & \(0.06\) & \(0.02\) & \(-0.04\) & \(-0.08\) & \(-0.02\) \\ \hline
20 & \(0.07\) & \(0.04\) & \(-0.06\) & \(-0.18\) & \(-0.04\) \\ \hline
100 & \(0.06\) & \(0.00\) & \(-0.09\) & \(-0.19\) & \(-0.01\) \\ \hline
1000 & \(0.03\) & \(-0.04\) & \(-0.04\) & \(-0.06\) & \(0.01\) \\ \hline \end{tabular}
\end{table}
Table 2: Mean of the Pull distributions in the endcap region (\(1.6<|\eta|<2.5\)).

\begin{table}
\begin{tabular}{|l|l|l|l|l|l|} \hline \(p_{T}(GeV/c)\) & \(d_{0}\) & \(z_{0}\) & \(1/p_{T}\) & \(\phi\) & \(\cot\theta\) \\ \hline
1 & \(0.96\) & \(0.99\) & \(1.03\) & \(0.94\) & \(1.09\) \\ \hline
5 & \(0.94\) & \(1.01\) & \(1.07\) & \(1.01\) & \(1.01\)

[MISSING_PAGE_FAIL:5]

momentum measurement, is also weakened. A further source of degradation going from the DC1 to the Rome-Initial simulation is a reduction of the b-layer pixel granularity

### Transverse impact parameter resolution

A precise determination of the transverse impact parameter of a track, \(d_{0}\), is important for primary and secondary vertex finding, essential for heavy flavor tagging and life-time measurements.

The resolution of the transverse impact parameter, expressed as a function of \(|\eta|\), for the Rome-Initial data set at \(p_{T}\)=1GeV/c, and at \(p_{T}\)=100GeV/c is presented in Figure 2. Also given are the equivalent distributions for the DC1 layout.

All the errors shown here and in subsequent figures are statistical, corresponding to the number of events processed.

At low momentum the barrel resolution is reduced by the large multiple scattering contribution from material up to and including the first measurement layer. There is a continuous rise with \(|\eta|\), due to the increase with \(\sin\theta\), in material thickness of the beam-pipe and b-layer. Both data sets show a similar variation with \(|\eta|\), but the resolution of the Rome-Initial data is \(10-20\%\) worse in the barrel region. This degradation is interpreted as a consequence of the increased thickness of Silicon in the b-layer.

At high momentum, the resolution remains approximately constant in the barrel region up to \(|\eta|\sim 1.8\), but then degrades in the end-cap region. This degradation is due to a reduction in the measured radial length for tracks longitudinally exiting the tracker which produces an increase in the relative distance to extrapolate back to the beam-line, and thus an increased extrapolation error. As at low momentum, the Rome-Initial data has a \(10-20\%\) worse resolution than the DC1 data but here some degradation is also seen in the endcap region.

The \(p_{T}\) dependence of the transverse impact parameter with the Rome-Initial data set, for all \(|\eta|\) and also for \(|\eta|=0\), is shown in Figure 2. The curves correspond to parameterisations of the form \(A+B/p_{T}\), introduced in a previous note[2], which fit the equivalent DC1 data. The curves are consistent with the Rome-Initial data to within \(10\%\) at all values of \(|\eta|\).

### Longitudinal impact parameter resolution

The projection of \(z_{0}\) onto the plane perpendicular to the track direction is a further important measurement for vertexing and b-tagging. The longitudinal impact parameter resolution, \(\sigma(z_{0})\times sin\theta\), for the Rome-Initial and DC1 data sets is presented in Figure 3 as a function of \(|\eta|\) for \(p_{T}=\) 1 and 100 GeV/c.

At low momentum, in the barrel region, there is an improvement of resolution with \(|\eta|\) due to increasing cluster size, but the gain is offset by a corresponding increase in multiple scattering. However, beyond \(|\eta|\sim 1\), the multiple scattering becomes dominant and the resolution decreases. As for the transverse impact parameter, the evolution of the 2 data sets with \(|\eta|\) is approximately the same. Here again the resolution of the Rome data is inferior to the DC1 resolution, being up to 25% worse in the barrel region. Some degradation is expected as a result of the increase of longitudinal pixel dimension in the Rome-Initial layout but is diluted somewhat by the effects of multiple scattering.

At high momentum the Rome-Initial and DC1 resolutions again show comparable behaviour with \(|\eta|\), with the resolution of the Rome-Initial data consistently inferior to that of the DC1 data. As stated previously, this is the result of the reduction of longitudinal pixel size, but here the decrease of resolution scales according to the increase in pixel size from 300 to 400 \(\mu\)m.

The \(p_{T}\) dependence of the longitudinal impact parameter with the Rome-Initial data set for all \(|\eta|\) and also for \(|\eta|=0\), is shown in Figure 6. There is seen to be only a small improvement of the resolution with \(|\eta|\) above 5 GeV/c.

### Inverse transverse momentum resolution

The ratio of the inverse transverse momentum resolution to the true value, expressed as a function of \(|\eta|\), for the Rome-Initial and DC1 data sets, is shown for \(p_{T}=1\) and 100 GeV/c, in Figure 6.

Multiple scattering dominates the resolution at low \(p_{T}\) where the continuous increase of material with \(|\eta|\) produces a corresponding degradation of the resolution. In addition, the material in the support/service structure at the end of the barrel adds to the effect of fewer TRT straws in that region. At high \(|\eta|\), the effects of reduced radial track length and reduced field integral are apparent, although less severe than at high momentum. The resolution of the Rome-Initial data is in close agreement with the DC1 resolution at all values of \(|\eta|\).

At high \(p_{T}\), the resolution is more constant up to \(|\eta|\sim 1.5\), except for a bump around \(|\eta|\sim 0.8\) corresponding to the TRT barrel-forward transition region where there are fewer straws. For higher values of \(|\eta|\) the resolution becomes progressively worse due to the reduction in radial track length, and the reduction in magnetic field integral resulting from the finite length of the solenoid. In the barrel region the resolution of the Rome-Initial data shows a slight improvement from the DC1 data due to increased SCT clustering and the new TRT gas mixture, but less than expected. At high \(|\eta|\) the Rome-Initial resolution shows a degradation due to the absence of TRT C-wheels.

The \(p_{T}\) dependence of the \(1/p_{T}\) resolution for the Rome data, integrated over all \(|\eta|\) and for a value of \(|\eta|=0\), is shown in Figure 6. Also shown are curves corresponding to fits to the DC1 data for the equivalent \(|\eta|\) regions which are seen to be in very good agreement with the Rome data at all values of \(p_{T}\). The curves correspond to a parametrization[2], of the the form:

\[A\oplus\frac{B}{p_{T}\times\sqrt{\sin\theta}} \tag{1}\]

Values of the A and B parameters for the DC1 data set are presented in Table 7.

## 6 Tracking Anomaly

During the present studies, reconstructed muon track momenta were found to be lower than the simulated values. For all the results presented at the Rome workshop using Geant4 data, the tracking was incorrect at the level of the inconsistency. Although an explanation of the anomaly has recently been found and is discussed below, some results showing the extent of the problem are first presented.

The ratio of the mean calculated muon resolution to the truth as a function of \(|\eta|\) and as a function of \(|\phi|\) for muons of \(p_{T}=100\) GeV/c and \(p_{T}=1\) GeV/c is shown in Figure 7. It is seen that in the barrel region, corresponding to the \(|\eta|\) range between 0 and 1.7, there is a significant shift away from zero. This shift, which has the same magnitude for positive and negative values of \(|\eta|\), also has the same magnitude for both positive and negative charges of muon, and scales with muon momentum. At \(p_{T}=100\) GeV/c, the shift is seen to be \(1-1.5\%\). In the endcap region the data are consistent with zero within the larger errors, there is even a slight shift of the opposite sign. The same muon momentum resolution ratio plotted as a function of \(|\phi|\), sees a shift away from zero as expected but shows no variation with \(|\phi|\) within errors. An additional measurement of the muon track momentum using the xKalman algorithm[7], obtained similar results. A study of momentum shifts caused by displacement of individual sub-detectors was not able to reproduce the results neither was an extensive investigation of the magnetic field.

Recent investigations of the cause of the shifts involved some checks with Geant4. Transformations between local and global coordinates of the Geant4 hits were verified to be correct, and comparisons between the hits and the cluster positions were found to give

\begin{table}
\begin{tabular}{|c|c|c|} \hline \multicolumn{3}{|c|}{Inverse transverse momentum resolution for DC1 layout} \\ \hline \hline  & \(|\eta|=0\) & all \(|\eta|\) \\ \hline \(\sigma(\frac{1}{p_{T}})(TeV^{-1})\) & \(\sigma(\frac{1}{p_{T}})=0.56\oplus\frac{12.5}{p_{T}\sqrt{sin\theta}}\) & \(\sigma(\frac{1}{p_{T}})=0.56\oplus\frac{22}{p_{T}\sqrt{sin\theta}}\) \\ \hline \end{tabular}
\end{table}
Table 7: Inverse transverse momentum resolution for DC1 for data samples with \(|\eta|=0\) and all \(|\eta|\).

distributions with mean of zero ruling out any shifts introduced at the digitization phase. The shifts were finally tracked down to be the result of an inappropriate choice of values for the Geant4 parameters used for propagation in a magnetic field.

The following procedure was used to compare the positions of the Geant4 hits with those predicted from the trajectory of the true track. When a track passes through the silicon, in general it creates several hits. The first hit in the element associated to the track was selected. A surface corresponding to this hit (generally the entrance surface of the element) was then used. The track parameters from the true track were propagated to this surface using the propagator from iPatRec and then the position of the Geant4 hit was compared with the intersect of the track with the surface. Figure 8 shows the difference between the local r-phi coordinate of the Geant4 hit and of the "true" intersect. The plot is shown for 100 GeV muons of negative charge. Shifts in r-phi of the order of 10 \(\mu\)m are seen in the four SCT barrel layers, the magnitude of the shift increasing with radius. Shifts of a few microns were also seen in the pixel detector. Simulations with opposite signed charged muons resulted in shifts with the same magnitude but in opposite direction. Checks were also made with charged geantinos, a diagnostic particle in Geant4 which only undergoes transport and so is not affected by multiple scattering and other physics processes. With charged geantinos the shifts were clearly visible for all energies investigated (1, 10 and 100 GeV).

As explained in the Geant4 documentation [8] the algorithm used to propagate tracks

Figure 7: (a)Mean fractional transverse momentum resolution as a function of \(|\eta|\) for muons of 100 GeV (+ve and -ve) and 1 GeV (+ve), (b)Mean fractional transverse momentum resolution as function of \(\phi\) for muons of 100 GeV (+ve and -ve) and 1 GeV (+ve), for Rome-Initial data set.

in a magnet field has a bias. The intersect with a volume boundary is estimated by using a chord of the trajectory. If the error on this intersect is estimated to be less than a certain parameter _DeltaIntersect_ it accepts the intersect which leads to an intersect that is always inside the curve. Such an error accumulates as more and more volumes are crossed. In all Geant4 productions up to now the default value of 1 \(\mu\)m was used for _DeltaIntersect_. After crossing several boundaries this error routinely grew to be of the order of 10 \(\mu\)m tranverse to the track. The effect of this bias can be reduced by reducing the value of _DeltaIntersect_.

Geant4 has a number of parameters that can be adjusted to control the accuracy of the propagation in a magnetic field. Simulations were carried out with two different sets of these parameters as listed in Table 8. Of all the parameters only _DeltaIntersect_ is expected to introduce any bias.

Reducing _DeltaIntersect_ to 0.01 \(\mu\)m reduces the shifts in the SCT to less than 0.1 \(\mu\)m (which should be small enough for tracking). Reducing it to 0.001 \(\mu\)m reduces the shifts even closer to zero. Reducing these values does result in an increase of simulation time

Figure 8: Difference between local r-phi coordinate of Geant4 hit and true coordinate of track - detector surface intersection for SCT barrel layers using 100 GeV muons

(around 20 - 40%) when simulating the inner detector only. The time impact on full ATLAS simulation, however, is not very significant.

Muon data sets were generated at several momenta with the _DeltaIntersect_ parameter set to 0.001 \(\mu\)m. The ratio of the mean calculated muon resolution to the truth as a function of \(|\eta|\) at \(p_{T}=100\) GeV/c for two of these data sets is shown in Figure 9.

It is seen that the momentum ratio in the barrel region, as well as the end caps, is now consistent with zero for both charges of muons. A more complete check of the optimum Geant4 parameter values will be made in due course.

\begin{table}
\begin{tabular}{|l|l|l|l|} \hline  & Default & Set 1 & Set 2 \\ \hline DeltaIntersection & 1 \(\mu\)m & 0.01 \(\mu\)m & 0.001 \(\mu\)m \\ DeltaOneStep & 10 \(\mu\)m & 0.1 \(\mu\)m & 0.01 \(\mu\)m \\ MinimumEpsilonStep & \(5\times 10^{-5}\) & \(10^{-5}\) & \(10^{-5}\) \\ MaximumEpsilonStep & \(10^{-3}\) & \(10^{-4}\) & \(10^{-4}\) \\ Miss Distance & 250 \(\mu\)m & unchanged & unchanged \\ \hline \end{tabular}
\end{table}
Table 8: Geant4 parameters that control accuracy of the propagation in a magnetic field.

Figure 9: Mean fractional transverse momentum resolution as a function of \(\eta\) for muons of 100 GeV (+ve and -ve) for DeltaIntersect = 0.001 \(\mu\)m

Conclusions

The performance of the ATLAS Inner Detector has been evaluated for the Rome-Initial layout and comparisons have been made with the results from studies with the DC1 layout. Single muons have been used throughout. The study has been carried out in order to monitor the continuous evolution of both the detector layout and the reconstruction software. No large differences have been found, apart from an expected degradation in longitudinal impact parameter consistent with the increase in pixel length. The removal of the middle pixel layer and TRT C-wheels made very little difference to the resolutions. With this data, there was no obvious benefit from the improvements to SCT and TRT detector resolutions (respectively from the increase in clustering rate and'slower' gas).

During the studies an anomaly of up to 1.5% was seen in the calculated value of the muon momentum. Extensive investigations have identified the origin of the problem as the incorrect setting of some Geant4 parameter values. After correcting these parameters, no anomalies were visible within statistical errors. For the future it is hoped that the ongoing developments with the RTT (real time tester) monitoring software will enable any such problem, if it arises, to be identified immediately.

## References

* [1] R. Clifft, A. Poppleton, _IPATREC: Inner Detector pattern recognition and track fitting_, **ATL-SOFT-94-009.**
* [2]_ATLAS Inner Detector Performance_, Inner Detector Note, **ATL-INDET-2004-002.**
* [3] Atlas Collaboration, _Inner Detector, Technical Design Report, Vol.I_, **CERN/LHCC/97-16**(1997).
* [4] Atlas Collaboration, _Pixel Detector, Technical Design Report_, **CERN/LHCC/98-13**(1998).
* [5]_ATLAS testbeam results 2005_, **ATL-TESTBEAM-2005-001.**
* [6] Requirements for an Inner Detector Event Data Model, **ATL-INDET-2002-008.**
* [7] I. Gavrilenko, _Description of Global Pattern Recognition Program (xKalman)_, **ATL-INDET-97-165.**
* [8] 'Geant4 User's Guide: For Application Developers', Section 4.3, [http://cern.ch/geant4](http://cern.ch/geant4).**