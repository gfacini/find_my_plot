**ATLAS Internal Note**

**TILECAL-NO-012**

**9 May 1994**

**Computer Models for the TILECAL Magnetic Field Distributions**

M.Nessi

CERN, Geneva, Switzerland

J.A.Budagov, S.B.Vorozhtsov, O.N.Borisov, O.V.Lomakina, G.A.Karamysheva

Joint Institute for Nuclear Research, Dubna, Russia Contents

1 FORMULATION OF PROBLEMS 2

2 DESIGN DATA 2

3 CALCULATION TECHNIQUES 5

4 EXISTING FIELD SIMULATIONS DATA 5

5 COMPUTER MODELS OF THIS STUDY 6

5.1 Model - 1 6

5.2 Model - 2 7

5.3 Model - 3 9

5.4 Model - 4 9

5.5 Model - 5 9

6 CONCLUSION 9

**FORMULATION OF PROBLEMS**

- Calculation of the ATLAS space map [1] for the field inside the magnet and for fringe fields outside the magnet [2]. Submitting calculated field map into various simulation programs.

- Calculation of 3D distribution of magnetic field of ATLAS scintillating tile calorimeter. That should include toroidal field and solenoidal field in order to quantify the PM shielding and the B-field effect on scintillators [4]:

* We need to define B on the scintillators in order to understand the calibration: B increases the light output of polystyrene scintillator which has an effect on absolute scale and cell intercalibration. Some hope that the field on the scintillator will be \(\leq 0.01T\) (desired limit) [4]
* We need to define B at PMTs position to design the PM individual shielding [4]
* Study of uniformity distortions arising from the geometric effects:
* Calculation of the effect of field flux distortion in the feet region of TILECAL ( if they are of magnetic material and not of stainless steel). What material should TILECAL feet be manufactured from? Stainless steel or iron? If it be iron then what kind of nonmagnetic spacers between TILECAL and feet should be envisaged [3]?
* Calculation of the effect of field disturbances due to studs in the tile zone. What material should be used for the rods ( or studs)? Magnetic or nonmagnetic? Would they distort locally the field in the tiles? [3]

- Estimation of pondermotive force distribution, acting on individual units of the system (iron parts and coils ):

* We need to calculate the force between barrel and extended barrel [4].
* When discussing the mechanical design of the iron yoke of the tile calorimeter it was concluded that it would be preferable to support the attractive forces between endcap toroids and barrel toroids through the yoke [5]. Calculation of these forces.
* Mechanical tolerances/forces arising from asymmetries [2]?

**2 DESIGN DATA**

The parameters of the magnetic system under consideration are given in the following:

**TABLE - 1**

 SOLENOID

Total current for the whole coil length [6] 10.6 MAt Thickness [6] 1.28 cm Inner radius [6] 1.23 m Outer radius [6] 1.2428 m Length [6] 6.3 m Central field [7] 2 TSCINTILLATING TLE HADRON CALORIMETER

\begin{tabular}{|l|l|l|} \hline BARREL & Length & [14] & 5894 mm \\  & Inner radius & [6] & 2250 mm \\  & Outer radius without support & [14] & 3810 mm \\  & Maximum radius including support & [6] & 4200 mm \\  & Radial size of the active section & [6] & 1550 mm \\  & Number of feet along Z axis & [6] & 10 \\  & Distance between feet along X axis & [6] & 5500 mm \\  & Module: & & \\  & material & [6] & steel 08 \\  & number of modules & [6] & 64 \\  & number of periods for barrel & [6] & 325 \\  & number of half-periods/sector & [6] & 651 \\  & end plates thickness & [6] & 20 mm \\  & front plate at R=225 cm & [6] & 10 mm \\  & stud (tube) diameter & [6] & 6 mm \\  & stud material & [8] & Steel Z20C13 \\  & distance of tube center from spacer edge & [6] & 16 mm \\  & long (master) plate thickness & [6] & 5 mm \\  & short plate (spacer): thickness & [6] & 4 mm \\  & height of the 1 row & [6] & 101 mm \\  & 2-3 rows & [6] & 102 mm \\  & 4-6 rows & [6] & 132 mm \\  & 7-9 rows & [6] & 152 mm \\  & 10 row & [6] & 192 mm \\  & 11 row & [14] & 221 mm \\  & (this is after the last scin)12 row & [6] & 31 mm \\  & Scintillator tile tolerable magnetic field & & \\  & level ( 1% change for light output) & [6] & 0.1 T \\  & PMT: diameter & [6] & 20 mm \\  & tolerable stray magnetic field level & [6] & 0.1 T \\ \hline EXTENDED & Geometry : & & \\ BARREL & Exactly as Barrel but less length & [6] & \\  & left and right are mirror symmetrical & [14] & \\  & Length & [14] & 2699 mm \\  & Z position of end plate & [14] & 3447 mm \\  & Distance along Z-axis between barrel & [6] & 500 mm \\ \hline \end{tabular}

\begin{tabular}{|l|l|l|} \hline \multicolumn{2}{|c|}{BARREL AIR-CORE TOROID} \\ \hline Length & [9] & 26 m \\ Coil configuration & [10] & Racetrack \\ Number of support legs & [10] & 4 \\ Peak field at bore of air core & [11] & 0.75 T \\ Number of coils, symmetrically arranged & [12] & 8 \\ Outer radius of inner legs & [13] & 5540 mm \\ Inner radius of outer legs & [13] & 8920 mm \\ Radial thickness of coils & [13] & 450 mm \\ Width of pancake & [13] & 151 mm \\ Space between pancakes of coil & [13] & 50 mm \\ Number of pancakes per coil & [13] & 2 \\ Total Ampere-turns & [10] & 24 MA \\ \hline \multicolumn{2}{|c|}{ENDCAP AIR-CORE TOROIDs} \\ \hline Length & [15] & 4950 mm \\ Forw. z pos & [15] & 7725 mm \\ Peak field at bore of air core & [11] & 3.0 T \\ Number of coils, symmetrically arranged & [12] & 8 \\ Inner radius of inner legs & [15] & 820 mm \\ Outer radius of outer legs & [15] & 5009 mm \\ Radial thickness of coils & [11] & 109 mm \\ Width of coils & [11] & 218 mm \\ Total Ampere-turns & [7] & 11 MA \\ \hline \end{tabular}

Schematically various aspects of system are shown in Figs 1-9. In these Figs there are identified the only elements of the detector which are field sources or magnetized media. And not always to scale but just very simplified structure of the system. Par example toroids configurations especially Endcap toroid coil cross section are even oversimplified. The reason for this is rather remote position of this field sources as far as the estimation of the field level in tiles and at PMTs locations concerned.

Magnetic characteristic [ B(H) dependence induction value "B" on applied field strength "H" ] for steel 08 was taken from [16], [17] and given in Fig.10 and in the following :
\begin{tabular}{|l|l|l|l|l|l|} \hline \multicolumn{5}{|c|}{**T A B L E - 2 : STEEL 08 MAGNETIC PROPERT**} \\ \hline B(T) & H(A/m) & B(T) & H(A/m) & B(T) & H(A/m) \\ \hline
0.0 & 0.0 & 1.6671740 & 3501.4087 & 1.8533932 & 11140.846 \\
0.0493226 & 39.7887 & 1.6799812 & 3819.7186 & 1.8675500 & 11936.620 \\
0.2221271 & 79.5774 & 1.6908231 & 4138.0285 & 1.8795473 & 12732.395 \\
0.4677219 & 119.3662 & 1.7016828 & 4456.3384 & 1.8918014 & 13528.170 \\
0.6443858 & 159.1549 & 1.7066988 & 4615.4933 & 1.9033305 & 14323.944 \\
0.8664074 & 238.7324 & 1.7116702 & 4774.6483 & 1.9142617 & 15119.719 \\
1.0138164 & 318.3099 & 1.7165140 & 4933.8032 & 1.9250651 & 15915.494 \\
1.1607398 & 437.6761 & 1.7213538 & 5092.9582 & 1.9354075 & 16711.269 \\
1.2340496 & 517.2536 & 1.7348483 & 5570.4230 & 1.9449435 & 17507.043 \\
1.2929994 & 596.8310 & 1.7556339 & 6366.1977 & 1.9545682 & 18302.818 \\
1.3407906 & 676.4085 & 1.7678689 & 6843.6625 & 1.9637000 & 19098.593 \\
1.4248335 & 875.3522 & 1.7748412 & 7161.9724 & 1.9738631 & 19894.368 \\
1.4854011 & 1114.0846 & 1.7922863 & 7957.7472 & 1.9810109 & 20690.142 \\
1.5676269 & 1750.7043 & 1.8091750 & 8753.5219 & 2.0132481 & 23873.241 \\
1.6135324 & 2387.3241 & 1.8248878 & 9549.2966 & 2.0334833 & 26260.565 \\
1.6466752 & 3023.9439 & 1.8396224 & 10345.071 & & \\ \hline \end{tabular}

3 CALCULATION TECHNIQUES

The following computer codes for performing magnetic field calculations are available for the study:

- Numerical calculation of the two-dimensional (2D) distribution of the field in the XOY and YOZ planes using program POISCR [18] at the JINR computers (IBM PC AT-486 and SunSPARC WS) and program PE2D [19] on the SSCVX1
- DEC VAX 6420 at SSCL via remote connection. Both codes based on the finite elements method (FEM).

- 3-dimensional (3D) computer simulations based on the integral technique for calculation of the field outside the iron core: programs MAGSYS [20] at the JINR computers.

- 3-dimensional program KOMPOT [21] based on the finite elements technique is available on Saint Petersburg computer (IBM PC AT-386/387).

- 3-dimensional computer simulations of the magnetic field with the help of the program TOSCA[22] on the PDSF (Physics and Detector Simulation Facility) [23],[24] at SSCL, on PaRC (IBM RS6000-550 Engineering Cluster) [25] at CERN and at the BNL IBM RS/6000 model 550
- ribm00.rhic.bnl.gov computer via remote Xterm mode connection.

4 EXISTING FIELD SIMULATIONS DATA

Presently there exist several attempts to attack this very difficult task [26] - [29]. The problem has an essentially 3-dimensional character of the field configuration. There is also necessity to describe a huge amount of tiny ( comparably with the overall dimensions of the configuration ) elements like tile scintillators where the field should be observed with a limited number of grid nodes.

Nevertheless some 2D and 3D simplified computer models could be used to get approximate information on the field distribution in the system. This was demonstrated in the above cited studies which still to our opinion have only qualitative character and should be improved at large extent.

We think that the drawback of the calculation in [27] is an absence of the iron magnetization in the PMT region from the return flux of solenoid which is the main source of the field in the TILECAL region.

Problem with [28] is rather high ( about 1.8 T ) fixed field assigned to the outside region boundary. As a consequence flux lines will be forced to penetrate into tile regions.

As far as the paper [29] concerned we think that in these calculations there were too few grid nodes at the tile areas ( only 6 nodes) with no node in the inner part of the tiles. This leads to the rather bad approximation of the magnetic vector potential distribution when crossing the boundary iron - air near the tile contour. As a consequence there seems to be a breakdown of boundary conditions which leads to the exaggerated field value in the tiles. There is also no field leakage from the toroids to be taken into consideration. This in addition may lead to some errors in the results.

5 COMPUTER MODELS OF THIS STUDY Before proceeding with elaborated time consuming 3D calculation it is a good habit to start with the very simple 2D computer model and then gradually enlarge and vary its parameters to get the next in the row model. Eventually we shall end with a real 3D complex configuration reflected all the characteristic features of the given magnetic system. Why should we proceed this way? Because many important distributions of the field could be approximately figured out from the pure 2D models with the minimum efforts. When changing parameters of the models we should expect to get more or less non controversial results with the preceding calculations by this way confirming and enriching our previous understating of the system. Calculations for the simplified 2D model are also compulsory for the interpretation of the complex 3D model simulation where it is very easy to get wrong unexplained results!

5.1 Model - 1 Calculation with the 2D code POISCR for the system configuration in the polar R-Z coordinates shown in Fig.1. Symmetry condition in respect to the ZOY plane has been taken into consideration. An active section has been replaced by the iron with a suitable stack factor = 0.76 accounting for the slots for tiles. No stray field from coil toroids included into calculation. We need this model to get an impression of the flux line distribution and to find out where there are places within TILECAL absorber with the maximum field values. This would give us the most critical points as far as the field lines penetration into tile region concerned. In Fig.11 one can see that such a point situated along the border, namely at the corners of Barrel and Extended Barrel contour.

We have from these calculation the total field values:

\begin{tabular}{|l|l|l|l|} \hline T A B L E-3 & & & Extended \\  & & Barrel & Barrel \\ \hline  & \(Z_{min}\) & 0.4T & 0.6T \\ \(R_{min}\) & \(Z_{max}\) & 1.6T & 0.05T \\ \hline  & \(Z_{min}\) & 0.3T & 1.1T \\ \(R_{max}\) & \(Z_{max}\) & 0.9T & 0.05T \\ \hline \end{tabular}

We can make an estimation for the lower limit of the field in the TILECAL assuming that the total flux coming out of solenoid is uniformly distributed over Barrel and Extended Barrel cylindrical surface at the \(R_{min}\). Then we shall get \(B_{average}\) about 0.13 T at this TILECAL surface. This rather low value as compared with solenoid field 2 T reflects an geometrical factor connected with the much larger cross section area for the flux in the TILECAL in relation to the cross section of solenoid. This can be compared with the Barrel field value for \(R_{min},Z_{min}\) which is equal to 0.4 T.

The principal limitation of this model is its disability to predict the field value in the tile region as there are no separate tile regions at all.

### Model- 2

It is constructed as the model-1 but with inserting the real tile structure regions into the most critical points with the maximum induction value in the TILECAL iron. These points have been found out in the previous model. The rest of the active zone is again iron with the stack factor = 0.76. With the help of this approach a lot of grid nodes would be reserved for usage in the tile regions in comparison with the situation when the whole real tile structure of the active section is described within the computation model. The purpose of the Model is to get a feeling what the maximum field value would be inside the tile regions of the TILECAL.

Firstly the real tile structure area was introduced at the Barrel corner with the \(R_{min}\) and \(Z_{max}\) values, where the maximum total field value within the TILECAL is identified according to the previous calculations with the Model-1. There are 13 R-column of tiles along Z-axis and 3, 6 or 11 tile rows along R-axis. There are from \(6\times 3\)=18 to 11 \(\times\) 3=33 grid nodes inside tile regions so that every tile region has from 4 to 9 internal nodes. This can be compared with the meshing in [29] with \(3\times 2\) = 6 nodes inside tiles and no internal nodes there.

Figs 12 - 14 show flux line maps with subsequent zooming for the case with 11 rows of real structure.

In Fig.15 field values along the 1-st from the Barrel edge ( Z= 2.9275 m) and the 2-nd ( Z=2.9175) R-columns are given. One can notice that for the region with the maximum iron field 1.6 T ( see Table 3 ) the maximum induction value in tiles does not exceed 6 mT ( 60 Gauss ) which is safely below desired limit 10 mT ( see paragraph on Formulation of Problems in this Report ). Looking at Fig.15 one could also expect ( see Table 3) the tile field increase with radius in the vicinity of the Barrel corner with \((R_{max},Z_{max}\) ). But in this region situation differs from the corner with \((R_{min},Z_{max}\) ) as there is thick solid return flux iron connecting Extended Barrel and Barrel along Z-axis and safely screening tile slots from the magnetic flux penetration.

To get an impression on how the field value in the tiles could be modified depending on various parameters of the model:

- - number of rows with the real tile structure ( 3,6,11 );

- - number of nodes within tile regions ( 18,27,33 );

- - convergence parameter TOLPOT in the POISCR code \((10^{-7},10^{-8})\)

the dependence of tile total field value on radius for above mentioned conditions is also presented in Fig.15. One can see that the uncertainty for the field value in the tiles is about 2 mT for this model. This is sufficiently accurate as to satisfy the desired condition:

\([Br_{tile}=6mT\pm 2mT]\leq[B_{tile-desired}=10\) mT ]

One can also notice that the obtained maximum tile field is much less than the one given in [29]. This result is consistent with the prediction in [29] where they wrote: "...will try to use 12 nodes for each scintillator plate, and... the field will be in 1-2 order of magnitude less."To check the effect of node number within tile regions on obtainable accuracy of field estimations it would be interesting to decrease the effective grid diameter (finer mesh) in this regions which is not an easy job with the limited number of grid points under triangulation process within POISCR code. Better opportunity in this sense would provide VF 2D software for field simulation ( program PE2D ) with its flexible grid topology and possibility to use 2-nd order FEs (there is only 1-st order FEs with fixed topology available with the POISCR code). It is also possible to proceed in opposite way to the coarser meshing to estimate the errors from above. With the latter approach one can directly compare the results from this model with the calculations from [29].

To do this we perform calculations with \(3\times 2=6\) nodes inside tiles and no internal nodes there. With that number of nodes in the tiles we got an increase in the field value on only about 50% as compared with the case of 27 nodes in the tiles (Fig.16a).

But much larger error in the field values is connected with the standard POISCR approach for field retrieving under condition of limited number of nodes. When we use the standard POISCR procedure we got tile field of order obtained in [29]. In opposite for our calculations we choose to use the total field value assigned to the centroid of the grid triangles but not the standard POISCR edit program output. Our previous experience showed us that with the limited number of grid nodes distributed near the regions with sharply changing material properties the best approach would be to use this method as far as the problem of obeying boundary conditions at the interfaces concerned. We checked it also in this specific case when crossing the boundary absorber-tile and again were pleased that we were right.

When thinking of possible systematic errors with this model one can notice in Fig.13, Fig.14 that a large amount of flux lines bypassing real tile structure along solid iron plates at minimum ( front plate ) and at maximum radius of active section. This possibly will lead to the diminishing of the flux penetration into tile structure in comparison with the real situation and as a consequence to the less field value in the tile regions than in reality.

To check this we changed the stack factor value in the rest of the Barrel excluding the real tile structure. This way we changed the ration of the flux penetrating the real tile structure and bypassing it. Decreasing the stack factor value down to situation when this part of Barrel ( and also of Extended Barrel ) would be about pure air region we can direct all the flux to the iron plates and real tile structure area. It was the limiting case to get an estimation of the maximum possible field values inside tile regions. An opposite situation was realized when the stack factor would be equal to unity. Then the tile field value would be the minimum for this configuration. Calculations with the stack factor values 0.1, 0.5, 0.76 showed rather weak ( variation of about 15%) dependence of the tile field magnitude on the bypassing process. This could be probably explained by the relatively low field value inside master and short plates (about 0.6 T) and as a consequence of it there is a good enough screening of the tile slots from the magnetic flux penetration process.

More precise answer on this and other questions could be obtained with the following more complicated and by this way more realistic computer models.

There are also possible to get other modifications of this model. One can par example simulate an additional iron magnetization from toroids by introducing into the model some current sources at suitable points as to get about the stray filed value ( but not the direction ) at the corresponding observation points.

### Model - 3

Calculation with the 2D code POISCR for the system configuration in the polar R-PH coordinates shown in Fig.4. Periodical along phi-coordinate symmetry condition has been taken into consideration. An active section again has been replaced by the iron with a suitable stack factor = 0.76 accounting for the slots for tiles. Stray field from Barrel coil toroid has been included into calculation. We need this model to get an impression of the field level at the PMTs locations. In the cause of development of the model some field source to simulate the iron magnetization from the solenoid part of flux in the PMTs area is envisaged. Fig.17 shows some first result for this model.

### Model - 4

Calculation with the 3D code KOMPOT for the system configuration shown in Figs.1,2 and 4. Periodical along phi-coordinate symmetry condition has been taken into consideration. The active section again has been replaced by iron with a suitable stack factor = 0.76 accounting for the slots for tiles. Stray field from Barrel and Endcap coil toroids will be included into calculation. Return flux from the solenoid should be calculated within the Model-4. We need this model to get an estimation of the field distribution at the PMTs locations.

### Model - 5

6 etc. could be considered in the next investigations.

6 CONCLUSION

Maximum induction value in tiles does not exceed 6 mT which is safely below desired limit 10 mT. The calculated value is much less than the one given in [29] which could be accounted for the better quality of the computer model constructed in our case. More recent studies conducted by the same group of authors [30], where they got the tile field no more than 20 mT - 30 mT, confirmed the above made statements.

## References

* [1] F Dydak. Fax to Dubna. 11 Feb 1994.
* [2] F Dydak and P. Jenni. Questions to LHCC Magnet Expert Panel. 10 Nov 1992.
* [3] M.Nessi. E-mail from 15 Mar 1994.
* collaboration meeting (31-01-94 and 2-02-94)
* [5] W. Kozanecki (MUO-TR-180). Report on the highlights of the Toroid meeting held at CERN on 27 January 1994. (see also minutes of the Toroid meeting held at Saclay on 27. Jan. 1994). In: MINUTES OF THE MUON WORKING GROUP MEETING 2 FEBRUARY 1994.
* [6] M. Nessi. E-mail from 22 Mar 1994.
* [7] 7. Letter of Intent for a General-Purpose pp Experiment at the Large Hadron Collider at CERN. CERN/LCCC/92-4, LHCC/I 2, 1 October 1992.
* [8] M. Nessi. E-mail from 1-MAR-1994.
* [9] 9. C. Daum et al. 'Recommendations of the ATLAS Magnet Panel' GENER-No-2. 18-03-1993.
* Saclay, 1992
- (DSM/DAPNIA/STCM),Cryomag/92-12 HD/GV. ( also: ATLAS Internal Note TECH-NO-06, 8 October 1992 ).
* 14 dec. 1991.
* [12] Progress Report on ATLAS Milestones. ATLAS Collaboration. CERN/LHCC/93-51. 15 October 1993. 68 p.
* [13] AIR-CORE TOROID MAGNET. Definition drawing of the coil. P1001100-d.ps 1994 Feb 10.
* [14] M.Nessi. E-mail from 11 Apr 1994.
* [15] Yu.Gornyshkin. Private Communication. 13 Apr 1994.
* [16] S.B.Vorozhtsov, V.V.Kalinichenko, O.V.Lomakina, V.I.Snyatkov. PERMEABILITY MEASUREMENTS WITH THE SYSTEMIC ERROR CORRECTION BY CALCULATION OF STAND MAGNETS. April 3, 1993. SDC-93-486.
* [17] Kukhtin V.V. Measurements of a Magnetization Curve for the Iron Samples. CERN/EP/NA-4 Note, August 21, 1984.
* [18] CERN Program Library Writeup T602.
* [19] The PE2D Reference Manual.Version 8.1.VF088924. 16August 1989.
* [20] Borisovskaja Z.V., et al., JINR, B1-9-85-232, Dubna, 1985.
* [21] N.I.Doinikov, E.A.Lamzin, S.E.Sytchevsky. 'On computation of 3-D magnetostatic fields of electrophysical apparatus magnet systems.' In: IEEE Trans. on Magnetics, vol.28, No.1, January, 1992, pp 908-911,
* [22] Tosca User Guide. Version 6.3. 1993
* Dallas, 1992
- 4 p.
- (SSCL 169).
* Dallas, 1992
- 4 p.
- (SSCL 170).
* [25] S.Masso and F.Rohner. PaRC Users Guide. CN-XX/Note nn. AT/MA Internal Note 93-59. May 4, 1993. CERN.
* collaboration meeting (31-01-94 and 2-02-94)
- collaboration meeting (31-01-94 and 2-02-94)
* collaboration meeting (31-01-94 and 2-02-94)
* [29] V.I.Klyukhin, B.I.Klochkov. Preliminary results on the ATLAS solenoid magnetic field calculations in presence of hadronic tile calorimeter IHEP, Protvino, Russia. ATLAS Internal Note TILECAL-NO-007, 17 January 1994.
* [30] M. Nessi. Report on the TILECAL activities (B-related activities). In: Minutes of the ATLAS Plenary Meeting (21-04-94 and 22-04-94)

**Fig.1 ZOY plane**

**Fig.2 XOY plane**

**Fig.3 One sector of the Barrel and Extended Barrel cross section**

**Fig.4 Computer model configuration in the XOY plane**

**Fig.5 Barrel tile structure**

**Fig.6 Barrel tile - spacer overlapping in the adjacent column**

**Fig.7 Extended Barrel tile structure**

**Fig.8 Barrel toroid simplified coil cross section**

**Fig.9 Endcap toroid simplified coil cross section**

**Fig.11 Flux line map for the Model-1 configuration**

**Fig.12 Flux line map for the Model-2**

**Fig.13 Flux line map for the Model-2, zoom at R-min**

**Fig.17 Flux line map for the Model-3 configuration**