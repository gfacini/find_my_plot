**EAGLE Internal Note**

**DAQ-NO-002**

**20.1.192**

**V.G. Goggi**

Derandomizers

_1 - Introduction_

The optimization of the derandomizer stage operating between the LVL1 and LVL2 trigger processors is closely related to the functionality and architecture of the two trigger blocks. Its depth is a critical parameter for front-end design, given the need of storing locally entire data frames for each event within the constraints imposed by size and power dissipation.

The design of a derandomizer, be it in the form of a FIFO or a mapping of a memory segment, has to be based on three types of considerations :

_a)_ it must be capable of operating at the peak input event rate, i.e. at the LHC bunch crossing frequency;

_b)_ under normal (i.e. stationary) operating conditions, it must ensure operation of the local acquisition chain with zero deadtime within a predefined confidence level over a given period of time;

_c)_ it must detect incipient overload conditions, initiating actions by the trigger processors to suspend data acquisition without loss of information.

The total depth of the derandomizer will result from a suitable combination of the requirements of points (b) and (c) above.

This note provides a first determination of lower limits to the depth of the derandomizer stage. Lacking a detailed functional model of the LVL1 and LVL2 triggers, these limits are based on basic assumptions on the architecture of the data acquisition chain and on parametrizations of its global performance.

_2 - Basic considerations_

In any given channel with Poisson distributed arrivals, let \(\lambda=1/\tau_{a}\) and \(\mu=1/\tau_{b}\) be the mean arrival and service rates, respectively. If R is the global rejection factor of the LVL1 trigger (after weighted sum of all concurrent physics trigger channels), then

\[\tau_{a}=t_{0}R\qquad\qquad\qquad(t_{0}=15\mbox{ ns}) \tag{1}\]

where \(t_{0}\) is the bunch separation time in the machine.

The simplest model of a LVL 2 trigger is given by a set of M parallel concurrent processors,

[MISSING_PAGE_FAIL:2]

This quantity is shown as dotted lines in Figs. 1 and 2 for CL = 0.99 and for periods of one day and one month. The intercepts of these lines with the curves M = const. yield the corresponding lower limits N\({}_{\mbox{\scriptsize CL}}\) on the depth of the derandomizer.

From Eq. (4) and (8) one gets a lower limit on derandomizer depth as a function of \(\rho\) for a given confidence level and observation time :

\[N_{\mbox{\scriptsize CL}}\ =\ \frac{1}{\ln(\rho)}\ \ln(\frac{\tau_{\mbox{ \scriptsize CL}}}{1-\rho}) \tag{9}\]

which, together with the dependence of \(\rho\) on M given by (3), allows to express N\({}_{\mbox{\scriptsize CL}}\) as a function of M. This is shown in Fig. 3. This plot displays the explicit dependence between minimal derandomizer depth and number of LVL 2 processors, for given rejections of LVL 1 trigger and with \(\ell=1\) ms.

Under steady state conditions, the average queue length L in the system is given by [1]:

\[L=\rho\,\frac{1-(N+1)\rho^{N}+Np^{N+1}}{(1-\rho)(1-\rho^{N+1})} \tag{10}\]

This quantity, and the resulting fractional occupancy of the derandomizer, are shown as a function of M in Figs. 4 and 5 respectively.

Since the typical depth and mean fractional occupancy of the derandomizer turn qut to be of the order of \(10^{2}\) and just a few percent respectively, the worst-case filling time of the entire buffer is of the order of a \(\mu\)s. Therefore, the requirements of condition (c) can be easily accommodated in the actual design of a derandomizer.

_4 - Conclusions_

For reasonable rejection factors and number of LVL 2 processors, moderate derandomizer depths are sufficient to provide deadatimeless operation of the front-end acquisition chain over periods of time largely exceeding the duration of a typical run.

An accurate evaluation of the actual depth will be possible when details of the overall trigger architecture will become available. In particular, a better definition of the LVL 2 architecture should allow to include explicitly the set of second-level processors in a global statistical model of the derandomizer.

_References_

1 - R. K. Bock, H. Grote, D. Notz and M. Regler, _Data Analysis Techniques for High Energy Experiments_, Cambridge University Press (1990).

Fig. 1

Fig. 2

**Fig.3**Fig. 4

Fig. 5