# Impact of Pile-up on Jet Constituent Multiplicity in ATLAS

The ATLAS Collaboration

###### Abstract

One of the biggest challenges facing jet constituent multiplicity measurements is contamination from extraneous sources of soft radiation, such as pile-up. This note studies the impact of pile-up on various definitions of multiplicity. In particular, the impact of selected pile-up suppression techniques is evaluated: soft-drop declustering and constituent subtraction. Additionally, a first study of iterative soft-drop (ISD) multiplicity in ATLAS is presented. It is found that the application of pile-up suppression counteracts the increase in the measured multiplicity values due to pile-up, as expected. As constituent multiplicity is the single most important observable for distinguishing quark-initiated from gluon-initiated jets, these studies are an important input for developing a powerful and robust quark-versus-gluon jet tagger in the future.

## 1 Introduction

Jets are collimated streams of particles arising from the Quantum Chromodynamic (QCD) evolution of high energy quarks and gluons into hadrons. The radiation pattern within jets can be useful for distinguishing the type of particle that initiated the jet, as gluons emit more radiation than quarks. One of the most powerful observables for distinguishing quark-initiated jets (quark jets) from gluon-initiated jets (gluon jets) is the number of constituents inside the jet [1]. The constituent multiplicity is not infrared (IR) safe in general, and the often-used track multiplicity is additionally not collinear safe, so one cannot predict discrimination performance of these observables from first principles [2; 3; 4]. Additionally, calorimeter-based observables are particularly sensitive to contributions from soft radiation. Traditional infrared and collinear safe (IRC) observables have been studied in the past for the purpose of quark-versus-gluon discrimination, but they are dominated by a single emission at leading-logarithmic order. Because of this, they are limited in their utility due to Casimir scaling [5; 6; 7]. Additionally, at the high instantaneous luminosities achieved at the Large Hadron Collider (LHC), an important source of contamination that can distort the jet constituent multiplicity is pile-up: multiple proton-proton (\(pp\)) collisions per bunch crossing. Vertex association renders the track multiplicity relatively insensitive to pile-up. However, measures of the full jet constituent multiplicity using calorimeter information are very sensitive to the amount of pile-up from both in-time energy deposits in the calorimeter and out-of-time residual signals. Reducing the pile-up dependence of calorimeter-based multiplicity observables increases the available information in quark-versus-gluon discrimination.

There are two generic strategies for reducing the pile-up dependence of jet substructure observables such as the constituent multiplicity. One approach is to perform local pile-up corrections that down-weight or remove certain jet constituents that are likely to be from pile-up [8; 9; 10; 11; 12]. An example of this type of mitigation technique is Constituent Subtraction (CS) [11], which has been studied previously by ATLAS in Refs. [12; 13]. The CS method overlays a uniform layer of massless, soft particles ('ghosts') throughout the event with transverse momenta which satisfy

\[p_{\mathrm{T}}^{\mathrm{g}}=A_{\mathrm{g}}\times\rho \tag{1}\]

where the area of the ghosts in \(y-\phi\) space, \(A_{\mathrm{g}}\), is set to 0.01 and the average energy density of the event, \(\rho\), is estimated per-event as the median of the \(p_{\mathrm{T}}/A\) distribution of the inclusive set of \(R=0.4\leavevmode\nobreak\ k_{t}\) jets within \(|\eta|<\)2.0. Therefore, \(p_{\mathrm{T}}^{\mathrm{g}}\) represents the average amount of pile-up contained within an area \(A_{\mathrm{g}}\) of the event, which is subtracted from the set of jet constituents by iteratively associating ghosts with nearby constituents. When a constituent energy becomes less than or equal to zero, it is removed from the jet and thus the number of constituent clusters is reduced.

A second possibility ('grooming') for reducing pile-up dependence is to systematically modify the structure of a jet to remove soft and wide-angle radiation [14; 15; 16; 17; 18; 19]. Unlike most constituent-based pile-up mitigation techniques, jet grooming explicitly modifies the structure of a jet even when there is no pile-up. This note studies the multiplicity of constituents in calorimeter jets following the application of the soft-drop algorithm [19], which is explained in more detail in Sec. 2.

Also considered is a new definition of multiplicity, which is to count the number of hard branchings of the jet, where a hard branching is one that passes the soft-drop condition. Such a scheme has resulted in an IRC-safe counting variable called Iterative Soft-Drop (ISD) multiplicity [20]. The ISD algorithm is constructed to count the number of hard emissions within a jet. A brief description of the ISD algorithm also appears in Sec. 2.

Section 2 enumerates the set of four multiplicity observables considered in this study. The pile-up dependence of the calorimeter-based observables is studied before and after the application of CS. Section 3 discusses the simulated datasets used in this note, and section 4 covers the results of the study. Lastly, section 5 provides conclusions and outlook.

## 2 Multiplicity Definitions

Jets are formed from locally calibrated (LC) clusters of topologically connected calorimeter cell signals [21] using the FastJet [22, 23, 24] implementation of the anti-\(k_{t}\) jet algorithm [25] with radius \(R=0.8\), as in the recent soft-drop mass measurement [26]. The same LC clusters with the FastJet implementation of the \(k_{t}\) jet algorithm [27] were used for the calculation of \(\rho\). In this note, four definitions of constituent multiplicity for these jets are considered.

### Calorimeter-Cluster Multiplicity - Number of Clusters

After jet finding, the raw jet constituent multiplicity is simply the number of calorimeter cell clusters inside a jet.

### Track Multiplicity

Tracks with \(p_{\mathrm{T}}>500\) MeV and \(|\eta|<2.5\) are associated to the jet via ghost association [24]. The number of badly reconstructed or combinatoric tracks is reduced while maintaining high efficiency by applying a loose selection on the number of hits on the track [28]. To reject pile-up, tracks are required to have \(|z_{0}\sin(\theta)|<3\) mm, where \(z_{0}\) is the impact parameter - the distance of closest approach to the primary vertex - along the \(z\)-axis. Additionally, the transverse impact parameter is required to be at most 2 mm.

The jet grooming techniques considered here begin by re-clustering the constituents of the jet with the Cambridge-Aachen [29, 30] (C/A) algorithm in order to create a clustering tree with greater emphasis on angular ordering. This algorithm combines proto-jets with the smallest \(\Delta R_{ij}\) until all proto-jets are separated by a set radial difference. The indices \(i\) and \(j\) refer to the proto-jets being compared. The soft-drop algorithm is then applied in two different ways, using either all of the jet constituent clusters as inputs or clusters surviving the CS algorithm.

### Soft-Drop Declustered Multiplicity - Number of Clusters after Grooming

1. Undo the last clustering step.
2. If \(z_{ij}<z_{\mathrm{cut}}(\Delta R_{ij}/R)^{\beta}\), remove the softer proto-jet and repeat on the harder proto-jet, where \(R\), the jet radius, is 0.8, and \[z_{ij}=\frac{\min(p_{\mathrm{T}i},p_{\mathrm{T}j})}{p_{\mathrm{T}i}+p_{\mathrm{ T}j}}.\]Otherwise, the algorithm terminates and both proto-jets are preserved.
3. In the end, if all other proto-jets have been dropped, the last remaining proto-jet is also removed from consideration. Thus, if the soft-drop condition is never satisfied, the multiplicity is zero. Otherwise, the soft-drop declustered multiplicity is the number of constituents inside the remaining proto-jets inside the jet.

For the soft-drop declustered multiplicity, the parameters \(z_{\rm cut}=0.1\) and \(\beta=0\) were chosen to preserve IRC safety and to follow the standard in Ref. [19].

#### ISD Multiplicity - Number of Splittings while Grooming

1. Undo the last clustering step.
2. If \(\Delta R_{ij}<\Delta R_{\rm cut}\), the algorithm terminates.
3. If \(z_{ij}>z_{\rm cut}(\Delta R_{ij}/R)^{\beta}\), increment the ISD constituent multiplicity by one and iterate on the harder proto-jet. If not, iterate on the harder proto-jet without incrementing.

The parameters \(z_{\rm cut},\beta\), and \(\Delta R_{\rm cut}\) are algorithm-specific. For the ISD Multiplicity, the parameters \(z_{\rm cut}=0.007\), \(\beta=-1\), and \(\Delta R_{\rm cut}=0\) were chosen, which are the values found to maximize the quark-versus-gluon discrimination power while maintaining calculability from Ref. [20].

## 3 Simulated Datasets

Multijet events within the ATLAS detector [31] are simulated using Pythia 8.2 [32; 33] with the A14 set of tuned underlying event parameters [34]. All simulated events have been reconstructed using a full simulation of the ATLAS detector [35] implemented in Geant 4[36], which describes the interactions of particles with the detector and the subsequent digitization of analog signals. To simulate the effects of multiple simultaneous \(pp\) collisions, minimum bias events generated using Pythia 8.1 (MSTW2008LO PDF set [34] and A2 set of tuned underlying event parameters [37]) are overlaid on the hard scatter dijet interaction in the same bunch crossing. Signal remnants from the preceding bunch crossings and fractional signal contributions from the following bunch crossing are also included in this overlay. This recreates both the effects of in-time and out-of-time pile-up contributions. The mean number of interactions per bunch crossing in these events, \(\mu\), is 33. Events were required to have at least two jets. In order to study the regime of interest for data, in which there is a jet \(p_{\rm T}>\) trigger, at least one of the jets must have \(p_{\rm T}>500\) GeV.

## 4 Results

The various jet constituent multiplicity distributions are presented in Fig. 1(a). Multiplicity definitions that involve grooming are peaked at lower values compared to the ungroomed definitions due to the systematic removal of jet constituents. While this is true too for the soft-drop declustered multiplicity, the movement of its peak is slight, and the lines for the ungroomed and groomed versions largely overlap. The main result on the pile-up dependence of the average multiplicities is shown in Fig. 1(b). In order to show the curves on the same scale, each multiplicity definition is normalized to unity at \(\mu=30\), where \(\mu\) quantifies the level of pile-up. All constituent multiplicity definitions shift towards higher values with increasing pile-up. For most definitions, the pile-up dependence is approximately linear, but calorimeter-cluster multiplicity after constituent subtraction exhibits a non-linear turn-on at low pile-up values. This may be due to poor pile-up estimation for the constituent subtraction algorithm in that regime. Prior to grooming, the track multiplicity is the most stable with respect to the level of pile-up, while calorimeter-based multiplicity is the most sensitive. With the parameters chosen here, ISD multiplicity is less robust against pile-up than soft-drop declustered multiplicity. The application of Constituent Subtraction is found to reduce the pile-up dependence of these calorimeter-based observables, which approaches or exceeds the stability of track multiplicity for the selections described here. The slopes found from fitting a line to the full range of the pile-up dependence are given in the legend of Fig. 1(b).

To illustrate the discrimination power of these multiplicity definitions, receiver operating characteristic (ROC) curves for correct quark-jet tagging are shown in Fig. 2. The figure is divided into two rows, with the top showing ROC curves for low-\(\mu\) and the bottom showing curves for high-\(\mu\) events. ISD multiplicity is shown separately from the other calorimeter-based multiplicity definitions for clarity. This was originally proposed as an IRC-safe quark-versus-gluon jet discriminant that can evade the Casimir scaling limit [20], and its performance does exceed that limit. The figure presents ROC curves for the multiplicity definitions using both raw and constituent-subtracted reconstructed jets. While performing constituent subtraction clearly improves pile-up stability, the quark-versus-gluon discrimination seems to be worsened for calorimeter-cluster based multiplicity definitions and improved slightly for ISD multiplicity. In all cases, the discrimination power is worse for the higher-\(\mu\) region.

Figure 1: (a) Pile-up-inclusive multiplicity distributions of selected counting jet-measurables; the average \(\mu\) value is 33. (b) Pile-up dependence of the measurables. Track multiplicity, raw calorimeter-cluster multiplicity, soft-drop declustered cluster multiplicity, and ISD multiplicity are shown. For the calorimeter-based multiplicity definitions, the performance is shown for nominal jet constituents as well as for constituents after the application of Constituent Subtraction. The slopes of a straight line fit to the pile-up dependence curves are presented in the legend in the format (Nominal, After Constituent Subtraction). The full pile-up range was used for the fit.

Figure 2: ROC curves for quark-versus-gluon discrimination using the considered multiplicity definitions. ISD multiplicity is separated from the other calorimeter-based definitions for visual clarity, and lines for no-discrimination (straight), the Casimir Scaling limit (curved), and track-multiplicity based discrimination (blue dashes) are provided for reference. (a) ROC curve for ISD multiplicity using both raw and constituent-subtracted reconstructed jets in low-\(\mu\) events. (b) ROC curve for calorimeter-cluster and soft-drop declustered multiplicity using both raw and constituent-subtracted reconstructed jets in low-\(\mu\) events. (c) ROC curve for ISD multiplicity using both raw and constituent-subtracted reconstructed jets in high-\(\mu\) events. (d) ROC curve for calorimeter-cluster and soft-drop declustered multiplicity using both raw and constituent-subtracted reconstructed jets in high-\(\mu\) events.

## 5 Conclusions

This note has presented the pile-up dependence of various definitions of jet constituent multiplicity - observables particularly sensitive to pile-up - and examples of the quark-versus-gluon discrimination power of these various definitions in low- and high-\(\mu\) events. Prior to performing constituent subtraction on jets, track multiplicity exhibits the most stability against pile-up and calorimeter-cluster multiplicity the least; similarly, while ISD multiplicity with the chosen parameters depends significantly on pile-up, calorimeter-cluster multiplicity after soft-drop declustering is more stable. Applying constituent subtraction significantly improves the stability against pile-up of all calorimeter-based constituent multiplicity definitions. Furthermore, constituent subtraction does not appear to have a strong effect on the quark-versus-gluon discrimination power of ISD multiplicity, though it has a mild effect on the calorimeter-cluster based definitions. Despite its pile-up dependence, ISD multiplicity surpasses the Casimir Scaling limit at moderate quark efficiency, as designed, performing better than other calorimeter-based multiplicity definitions. Grooming provides an interesting avenue for including a calorimeter-based definition of multiplicity in future quark-versus-gluon jet taggers. Traditionally, the track-based multiplicity has been used by ATLAS for quark-versus-gluon jet tagging; in the future, it may be possible to complement this information with a proxy for the neutral multiplicity as well.

## References

* [1] J. Gallicchio and M. D. Schwartz, _Quark and Gluon Tagging at the LHC_, Phys. Rev. Lett. **107** (2011) 172001, arXiv: 1106.3076 [hep-ph].
* [2] ATLAS Collaboration, _Light-quark and gluon jet discrimination in pp collisions at \(\sqrt{s}=7\) TeV with the ATLAS detector_, Eur. Phys. J. **C74** (2014) 3023, arXiv: 1405.6583 [hep-ex].
* [3] ATLAS Collaboration, _Discrimination between Light Quark and Gluon Jets in pp collisions at \(\sqrt{s}=8\) TeV with the ATLAS Detector_, ATLAS-CONF-2016-034, 2016, url: [https://cds.cern.ch/record/2200202](https://cds.cern.ch/record/2200202).
* [4] ATLAS Collaboration, _Quark versus Gluon Jet Tagging Using Charged-Particle Constituent Multiplicity with the ATLAS Detector_, ATL-PHYS-PUB-2017-009, 2017, url: [https://cds.cern.ch/record/2263679](https://cds.cern.ch/record/2263679).
* [5] A. J. Larkoski, G. P. Salam and J. Thaler, _Energy Correlation Functions for Jet Substructure_, JHEP **06** (2013) 108, arXiv: 1305.0007 [hep-ph].
* [6] A. J. Larkoski, J. Thaler and W. J. Waalewijn, _Gaining (Mutual) Information about Quark/Gluon Discrimination_, JHEP **11** (2014) 129, arXiv: 1408.3122 [hep-ph].
* [7] P. Gras et al., _Systematics of quark/gluon tagging_, JHEP **07** (2017) 091, arXiv: 1704.03878 [hep-ph].
* [8] M. Cacciari, G. P. Salam and G. Soyez, _SoftKiller, a particle-level pileup removal method_, Eur. Phys. J. **C75** (2015) 59, arXiv: 1407.0408 [hep-ph].
* [9] D. Krohn, M. D. Schwartz, M. Low and L.-T. Wang, _Jet Cleansing: Pileup Removal at High Luminosity_, Phys. Rev. **D90** (2014) 065020, arXiv: 1309.4777 [hep-ph].