ATLAS Internal Note

LARG-NO-72

April 14, 1997

**Analysis**

**of the 1995 liquid argon test beam**

**with a digital readout prototype**

**A. Castera, D. Lacour, O. Le Dortz, A. Savoy-Navarro, P.Vincent**

Laboratoire de Physique Nucleaire et des Hautes Energies

LPNHE-Paris 6 & 7 and IN2P3/CNRS

**B. Lund-Jensen**

Royal Institute of Technology

KTH-Stockholm

In September 1995, data were recorded at the CERN-SPS H8 beam, on the 2 m long liquid argon electromagnetic calorimeter prototype, with a minimal digital readout system prototype, based on the CAEN FERMI-VME boards, developed within the RD16 Collaboration. The status of the analysis of these data is presented in this paper. The main emphasis is on the techniques that have been worked out to extract the energy resolution.

###### Contents

* 1 Introduction
* 2 Basic architecture of the digital readout prototype
* 3 Data set
* 4 Calibration
	* 4.1 Pedestal calibration
	* 4.2 Test pulse calibration
	* 4.3 Geometrical corrections
* 5 Data analysis
	* 5.1 Energy estimation
	* 5.2 Linearity of the estimator with the beam energy
* 6 Energy resolution
	* 6.1 Energy resolution with only the high gains shaper
	* 6.2 Energy resolution with both high and low gains shaper
	* 6.3 Discussion
* 7 Conclusion
* A Test of the linearity of the energy estimation
* B Reconstruction of the full shape of the pulse
* C Energy resolution with 20 and 150 GeV electron beams
* D Estimation of the energy resolution
* E Energy resolution using both the low and the high gains
* F Noise study.

## 1 Introduction

In September 1995, 81 channels of the 2 m long liquid Argon (LAr) electromagnetic calorimeter prototype were equipped with a prototype digital readout system based on the CAEN FERMI VME boards developed by the RD16 collaboration. This readout system was connected to two different types of shapers and used to read out two different regions of the detector.

Very preliminary tests have been performed with a few channels of both the Tiles and the LAr calorimeter prototypes in 1994 (see [1]). They indicated for the first time the good performances of a digital readout to handle the data processing of LHC calorimeters, in terms of noise, imaging properties, robustness, etc. The September run of 1995 with the liquid argon prototype (LAr), preceded by a run with the Tiles in June 1995, confirmed these results. But the test with the LAr calorimeter also gave the opportunity, for the first time, to test the performances of such a readout in terms of energy resolution in the case of a high resolution detector.

Here, we present the status of the analysis of the data recorded with this system, but limiting ourselves to the case of the 0 T bi-gain shaper. This shaper is similar to the one that will equip the LAr calorimetry in ATLAS.

The purpose of this paper is to discuss the various analysis techniques that have been developed to study the data recorded with this special digital readout prototype. The results give some indications on the possible performances of such a readout system, but cannot be used to draw definite conclusions.

The first section briefly recalls the digital readout concept developed by the RD16 collaboration, and gives some details about the part of this system tested in 1995. The next two sections describe the electron SPS beam data sets and the calibration data. The following section describes the details of the analysis and in particular the various techniques developed to evaluate the energy. The last section presents the obtained energy resolution.

## 2 Basic architecture of the digital readout prototype

The concept of a fully digital readout system developed within the RD16 R&D collaboration was called FERMI (digital Front-End and Readout Microsystem). The main functions/components included in this readout system are sketched in Fig. 1.

In its original definition, the input signals (from 15 to 16 bits dynamic range) are compressed and digitized at sampling frequencies up to 80 MHz in the ASIC labelled as the _Analog ASIC_. The resulting 10-bit signal is then linearized and expanded to its original dynamic range by the use of a Look-Up Table (LUT) containing the inverse transfer function of the electronic chain. This function is done in the ASIC called the _Channel ASIC_, in the FERMI system. The expanded signals are stored in a pipelined memory until the decision of the first-level trigger occurs. In ad

Figure 1: An overview of the digital readout architecture as proposed by RD16.

dition, a _Service ASIC_ is used for the control of the data extraction. Through a digital filtering it provides the energy and the time information for the first-level trigger, and processes the data to the second-level trigger and readout. A full description of the FERMI project can be found in [2]

During the beam test of September 1995 only the _Analog ASIC_ part was tested together with a minimal digital processing made of FIFOs. The _Analog ASIC_ included the 4 gain-compressor and the 40 MHz-10 bit PSA-ADC as developed by the RD16 Collaboration. These channels were read out this way, by means of a VME board built by CAEN.

In June 1996, in addition to the configuration previously described, one VME CAEN board had one channel equipped with a commercial 12-bit 40 MHz ADC from Analog Device.

## 3 Data set

Electron beam data at energies ranging from 10 GeV to 300 GeV, have been recorded in two different regions of the calorimeter prototype, and with two different types of electronic chain: the charge Si preamplifiers working at the LAr temperature plus a "warm" shaper, and a "warm" preamplifier with a bi-gain shaper (the so-called "0 T" scheme). The shapers are located outside the cryostat ([3] and references therein) and therefore labelled as "warm". Pedestal and calibration run were also recorded prior to any change in the running conditions (i.e. beam energy, position in the detector or shaper type).

All 95 data were taken in _asynchronous mode_. This was no longer the case for the run in 96 where data were taken in both synchronous and asynchronous modes with respect to the trigger. The advantage of working synchronously is the possibility to digitize right at the maximum of the peak, which simplifies the estimate of the energy as it does not require a reconstruction of the full pulse shape. This can be nevertheless rather easily overcome, as discussed later in this paper.

The set of recorded data with the corresponding statistics are summarized in Table 1.

In this paper, the analysis is restricted to the data

\begin{table}
\begin{tabular}{|l|r|r|r|} \hline Energy (GeV) & Run \# & \# of events & Total \\ \hline \hline \multicolumn{4}{|c|}{First period, \(\eta=4\), \(\phi=11\)} \\ \hline
2 00 & 2 9941, 30100-2 & 6004+701 9+303 3+40 00 & 20 056 \\
1 50 & 2 9967, 30109 & 7004+7004 & 14 008 \\
1 00 & 2 9943-4, 29950, 30111 & 6004+52 49+601 7+7013 & 24 283 \\
50 & 2 9952,4-5, 30114 & 6009+6 004+1004 +7014 & 20 031 \\
20 & 2 9961-2, 30116 & 7004+12 61+7015 & 15 280 \\
1 0 & 2 9964-5 & 7004+7011 & 14 015 \\ \hline \hline \multicolumn{4}{|c|}{Second period, \(\eta=4\), \(\phi=11\)} \\ \hline \hline
3 00 & 3 051 6-91 & 3393+23 70+3 35 3+6 75 & 9 791 \\
2 00 & 31 51 4,21,24-5,27 & 10 004+60 07+24 14+3004+50 04 & 26 433 \\
1 50 & 31 547-8 & 701 8+5118 & 12136 \\
1 00 & 31 530-3 & 7009+12 35+2 36 +64 60 & 14 940 \\
50 & 31 538-40 & 2505 +70 08+7004 & 16 517 \\
20 & 31 542-5 & 1425+53 29+12 58+61 37 & 14149 \\ \hline \end{tabular} \(\dagger\)_Run stopped_

\end{table}
Table 1: Data taken with the digital readout prototype and the 0 T bi-gain shaper.

related to the use of the 0 T preamplifier and bi-gain shaper. The 0 T option with multi-gain shapers was chosen by the ATLAS collaboration for the final Very Front End Electronics (VFE) of the LAr calorimetry (a part from the Hadronic End Cap (HEC) calorimeter).

## 4 Calibration

As already mentionned, at least one run of pedestal and one run of test pulse calibrations were recorded after any change in the running conditions. The purpose of these runs was to monitor the system and to check the cabling. Moreover a set of detailed and extensive calibrations was recorded for 48 hours, at the very end of the overall running period. These calibration runs using the test pulse system developed by LAL-Orsay for calibrating the detector, were extremely important to have a detailed mapping of the LUT of each channel read out by our system.

### Pedestal calibration

The pedestal calibration runs are used to evaluate the intrinsic noise of the electronic readout and its stability as a function of time. Figure 2 shows the distribution of the dispersion of the pedestal value for each channel addressed during the run of September 1995 (81 channels in total), both in the high and the low gains of the 0T shaper. As a comparison, we give below the mean values of the pedestal data collected more recently, in June 1996. These data are under analysis.

For these two periods, the mean values of the dispersion of the pedestal are:

* September 1995 :
* Hg h gain : 2.318 \(\pm\) 0.0016
* Low gain : 1.979 \(\pm\) 0.0018
* June 1996 :
* Hg h gain : 1.860 \(\pm\) 0.0007
* Low gain : 1.204 \(\pm\) 0.0004

Figure 2: Distribution of the dispersion of the pedestal values as a function of the channel number for the high gain (upper plot) and the low gain (lower plot), using the 0 T scheme in the 95 beam test.

tions, a series of runs was recorded at the end of the test beam period. These very detailed runs, which include of the order of 50 steps and sometimes up to 140 steps in the DAC scale in order to cover the overall dynamic range, were used to build the calibration file needed to analyse the data. Indeed as the used digital readout prototype included a 4 gain-compressor, it was necessary to reconstruct the LUT of each channel. This was achieved by using the corresponding test pulse calibration files.

To produce these so-called _transfer functions_ it is necessary to estimate, for each input DAC value, a corresponding energy value. This was done with a pulse reconstruction method, which makes use of the full statistics for each DAC value. This reconstruction method is described later, in the data analysis section. In the test pulse run, as the value of the DAC is well determined, this estimator gives better results than for the beam data. With this method, the number of ADC counts is known as a function of the DAC value. If this function is then inversed and multiplied by a coefficient factor that relates the DAC value (expressed in units of DAC counts or volts) to the energy (in MeV), it then allows the absolute calibration of the electronics to be performed. For instance, the value of this coefficient is 32 MeV per DAC count for the linear siliciumshaper and 8 MeV per DAC count for the 0 T shaper.

Figures 3 and 4 show the curves determined with the _transfer files_ for high and low gain respectively; they give the correspondence between the output signal expressed in volts and the input value in DAC counts. The effect of the compression can be clearly identified. These figures show different shapes corresponding to the first three gains of the compression scheme, while the rest of the electronic chain is expected to be linear with the energy. These curves show that one _transfer function_ per channel is required. Moreover, as the transfer functions include the effect not only of the compressor but also of the rest of the VFE electronics (i.e. preamps, shaper and cabling), any variation of one of these items affects the calibration. A regular monitoring is therefore required. This puts a heavy load both on the hardware and the data processing of such a compression scheme.

For the 0 T bi-gain shaper 81 channels are needed to calibrate the high and low gain data. In Figures 3 and 4 only the _transfer functions_ corresponding to the cells of the central 3\(\times\)3 cluster in the first and the second sampling have been derived from the detailed testpulse calibration data. They correspond to the region where the beam hits the detector. For all other cells, including the third sampling for the high gain, a unique _transfer function_ has been used. For the low gain (see Fig. 4) only the first and second samplings were instrumented.

These figures show that, as expected, the low and the high gain _transfer functions_ have the same type of behaviour; in particular the knee of the transition between two different gain regions occurs at the same level of ADC count. For historical reasons, the curves of the low gain channels are expressed in units of energy instead of volts.

### Geometrical corrections

An additional effect coming from the geometry of the liquid argon calorimeter affects the energy resolution.

In this prototype, as in the future electromagnetic calorimeter of ATLAS [3], the absorber plates have an accordionshape and are arranged around the beam axis in the \(\phi\) direction. Between two absorbers, there are two liquid argon gaps of \(2\times 1.94\) mm separated by a readout electrode (300 \(\mu\)m thickness). This special shape of the detector induces a variation in the response signal and therefore in its reconstructed shape, in function of the particle impact. As these plates are arranged in the \(\phi\) direction, at the level of the uncertainty of the beam impact in the \(\eta=4\)\(\phi=11\) region, we expect to see an effect in the \(\phi\) directions. In the \(\eta\) direction, the variation of the response of the calorimeter is due to the variation of the shower containment with respect to the position of the beam impact. The efficiency of the shower reconstruction and the energy integration is higher in the center of a cell than at the boundaries.

If we plot the evolution of the reconstructed energy, with respect to the nominal energy, as a function of the beam impact along the \(\eta\) direction, we see (upper plot of Fig. 5) a bump centered in the middle of the cell number 4. The lower plot of Fig. 5 indicates the evolution of the reconstructed energy with respect to the nominal energy as a function of the beam impact in the \(\phi\) direction. Only a small range in \(\phi\) is shown in Fig. 5 and is compatible with the modulation of the signal shown in the _Liquid Argon Technical Design Report_[3].

In addition to the previous effect, a small correlation between the \(\eta\) and the \(\phi\) directions of the beam impact is observed in the data and slightly modifies the variations of the reconstructed energy as a function of these two parameters.

A weighting method is used to correct for this effect. The sample of data is divided in \(n\times n\) cells in the (\(\eta\),\(\phi\)) plane. The events contained in each cell are used to compute the deviation for the estimated event by event energy with respect to that of the overall sample. A weight per cell is extracted and the energy of each event is then corrected by properly applying the corresponding weight.

This method is valid provided there is enough events per cell for computing a weight from a Gaussian distribution. To satisfy this condition one can restrict reasonably the total number of cells in the lattice. Moreover, we removed from the sample of data the events that stand at more than one standard deviation from the mean impact value to eliminate the wings of the \(\eta\) and \(\phi\) distributions of the beam impact, where the rate of events changes drastically from one bin to another.

Figure 4: Look-up-tables for the low gain 0 T shaper. In abscissa is the ADC count value and in ordinate is the corresponding input DAC value in GeV. From top to bottom: first and second sampling transfer functions

### Geometrical corrections

Another method, probably more efficient, consists in classifying all the events in function of their \(\eta\) and \(\phi\) position values and then, for each event, scanning a fixed number \(n\) of the events that are closest to the one we want to correct. This method is still to be developed.

The effect of this correction on the energy resolution is shown in Figs. 6, as a function of the number of bins, for the samplings of data that corresponds to 20, 50, 100, 150, 200 and 300 GeV beam energy.

The distributions up and including 200 GeV clearly exhibit the same type of behaviour. Indeed, in the first part, between a cell of 1 \(\times\) 1 bin (i.e. no correction) and a cell of 10\(\times\)10 bins, there is a fast improvement (large slope value) in the energy resolution; the second slope in the energy resolution curve has a lower value, when the number of bins increases.

In the first part, for 80% of the cells, the statistics is \(\geq\) 100 events per bin. So in this region a geometrical correction can be estimated. After that, the number of events per bin is too low to compute the weights correctly. In this case, we can not scan more precisely the geometrical profile of the detector. On the other hand, the low number of events induces a statistical effect that changes the estimated value of the energy for each event, so that the resolution continues to decrease. As approximately the same number of events have been collected for each energy value (see Table 1), the separation of these two slopes occurs more or less at the same point.

Figure 5: Evolution of the signal as a function of the position of the center of the shower in the \(\eta\) and \(\phi\) directions.

Figure 6: Impact of the correction on the energy resolution as a function of the binning of the weight method for electrons of different energies.

The separation of these two regions can be seen on these distributions and, as a result of this study, a lattice defined by \(8\times 8\) bins has been chosen in order to compute the geometrical correction.

The points out of these two curves correspond to cases where the automatic fitting procedure has failed. These points are concentrated at the end of these distributions. This indicates that, in this region, the correction of the signal shape is so strong that the final shape no longer corresponds to a Gaussian distribution.

The curves showing the variation of the resolution in energy as a function of the number of bins in one lattice, at 300 GeV energy, is a different case from those previously discussed. There is no clear improvement in resolution in the first part of the corresponding plot. This seems to be due to the fact that the width of the 300 GeV beam spot was very large and that there was not enough events, in both the \(\eta\) and \(\phi\) directions, to scan the geometrical profile of the detector.

The effect of this method is shown in Fig. 7, which represents the results on the data collected at 200 GeV beam energy. It leads to an improvement of about 19% of the estimated energy resolution. In some cases this correction can reach 30%.

## 5 Data analysis

Having subtracted the pedestal value and calibrated each channel using the corresponding _transfer functions_, the last step of the analysis is to find the best _energy estimator_. Various methods to extract the energy value from the raw data have been studied. Four of them, which have the best behaviour in terms of energy evaluation and stability are discussed in the next section.

### Energy estimation

The currently used digital readout prototype was set to give, for each channel, a set of 60 digitized sampled values for the recorded pulse shape of the signal (see Fig. 8) in each cell of the detector hit by particles. To extract an energy from this information, the amplitude of the BCO-sampled signal has to be correlated to the initial energy of the electron. To do so, one needs to work out an _energy estimator_. Four different estimators of energy are described in this section, as well as

Figure 8: Digitized signal as provided by the digital prototype readout at 40 MHz with compression and 10-bit ADC.

Figure 7: Evolution of the resolution before (left plot) and after (right plot) applying the geometrical correction for 200 GeV electrons.

### Energy estimation

their performances, in particular their linearity as a function of the beam energy.

#### 5.1.a Method 1: Dispersion of the pulse

This estimator uses the fact that the dispersion of the BCO-sampled values of the digitized signal in each cell is proportional to the input voltage. This is true if there is no saturation in the _undershoot_ of the pulse. We use the following relation where the sum is applied over the 60 values recorded per pulse in each channel:

\[\sigma^{2}=\frac{1}{N-1}\sum_{i=1}^{60}(h_{i}^{2}-\langle h\rangle^{2}),\]

where \(h_{i}\) is the amplitude of the \(i^{th}\) BCO sample of the digitized shape of the pulse.

The advantage of this estimator is that it is only sensitive to an average value of the pedestal fluctuations that are thus supposed to compensate each other. However although it gives good results for the estimate of the test beam data (see below), it cannot be used for LHC, as it does not take into account the pile-up effect.

#### 5.1.b Method 2: Integration of the pulse

As can be noted from Fig. 8, a fair fraction of the signal is already contained in the four bins that correspond to the highest BCO-sampled amplitudes in the positive part of the signal. Therefore, by selecting the highest four consecutive values in the weft of the pulse shape and then summing the four corresponding pulse height values, this leads to a rough but good enough estimate of the overall integral of the pulse shape. So this integral is given by the approximate simple formula:

\[sum=max_{j=1}^{56}\{\sum_{i=j}^{j+4}h_{i}\},\]

and the integrated value of the pulse is proportional to the beam energy.

But this estimator (called peak integration method) is more sensitive to the pedestal fluctuations, as it is an average of the noise contribution of only four bins. Moreover this rather rough integration, restricted to only four bins, is applied to a curve (the positive part of the pulse shape) that varies drastically in the considered interval of integration. In the other hand, it is less sensitive to the "pile-up" noise.

#### 5.1.c Method 3: Pulse reconstruction with Fourier transformations

The reconstruction of pulses using Fourier transformations is a classical method of signal processing. It is sketched in Fig. 9.

A Fourier transformation of the signal with frequency \(F\) (upper left picture) produces in the frequency space a distribution included between \(\pm 2\pi F\) (upper right). If we now digitize the original signal (lower left plot), its Fourier transformation will produce the same shape in the frequency space but with reflections of the same distribution on its both sides.

Figure 9: Method of reconstruction of a LAr bipolar pulse, using Fourier transformations.

As the lower left distribution looks like the digitized signal as delivered with our digital prototype, one can see that by applying a Fourier transformation and by selecting the central part of it, with a gate function, one obtains the upper right distribution. Its inverse transformation will reproduce the original signal.

In practice, we can directly convolute the digitized signal with a _sine cardinal_ function (which corresponds to the inverse Fourier transformation of the gate) to reconstruct the full original signal.

This method can be used if the Shannon condition is satisfied (i.e. the frequency of the digitization should be greater than twice the frequency of the signal). This is not the case in our sample, which makes it more difficult to select the central region of its phase space image. But we have tested various _mathematical filters_ to replace the simple _sine cardinal_ function, and the best result was obtained using a set of cosine functions.

The result can be seen in Fig. 10, where the signal reconstructed with this method is shown for different pulses selected randomly in the recorded data. The black dots represent the original digitized signal, and the thin dashed line is the reconstructed pulse where only the peak part of the signal has been plotted. In addition (see plots in Fig. 11), the behaviour of this estimator is even correct in the case of channels with small signal or even no signal at all.

To estimate the energy of an event, we sum the maximum amplitudes reconstructed with this method in each channel. The proportionality of this energy estimation with the electron beam energy is studied below (see section 5.2).

5.1.d. Method 4: Pulse reconstruction from the full statistics in asynchronous data acquisition mode

In this last method, already used in [1] (and references therein), we take advantage of the fact that even if the digital readout is not synchronous with the trigger signal, the signal of each channel is digitized at more or less the same starting time.

In these conditions if, for all the events recorded with a defined beam energy, we sum the maximum of the amplitude of each channel and we distribute

Figure 11: Reconstruction of background signals using Fourier transformations.

Figure 10: Signal reconstruction using Fourier transformations.

### Energy estimation

the value for each event as a function of the trigger relative to the digital system clock (the so-called _phase_ of the event or _timing estimator_), we will be able to reconstruct an accurate shape of the pulse at each beam energy. From this distribution we can now correct the energy value of each event with its estimated phase value.

The first timing estimator that was tested is given by the formula :

\[\varphi_{i}\ =\ \frac{t_{i-1}\times h_{i-1}^{\mathrm{n}}+t_{i}\times h_{i}^{ \mathrm{n}}+t_{i+1}\times h_{i+1}^{\mathrm{n}}}{h_{i-1}^{\mathrm{n}}+h_{i}^{ \mathrm{n}}+h_{i+1}^{\mathrm{n}}},\]

where \(h_{i-1}\) and \(h_{i+1}\) are the two samples that are adjacent to the maximum \(h_{i}\) of the full sample and \(t_{i}\) are the corresponding digitization times given by the clock of the digital system.

The parameter \(n\) has been set to 1, 2 and 3, in order to improve this phase estimator and to control the systematics coming from the low digitization rate of the pulse.

A second estimator (similar to the one used in [1]) was tested, to be compared with the previous one. It was defined by the formula :

\[\psi_{i}\quad=\quad\frac{h_{i-1}\ -\ h_{i+1}}{h_{i}},\]

where \(h_{i}\) has the same definition as before.

As the digitization is performed at 40 MHz, most of the positive part of the signal is included in only 4 bins and the computation of the phase of the signal from this estimator exhibits a gap (see Fig. 12-a), which corresponds to the case where two bins takes more or less the same value. To correct this effect, as we know that we have taken more or less the same number of events in each phase value, we can integrate the previous distribution, and normalize it to the total number of events. We then extract the correction between the reconstructed phase and the real one (Fig. 12-b to 12-d).

Figure 12 shows the correlation between the phase estimators discussed above. It indicates that these estimators are strongly correlated. The rest of this study is done using the first estimator with the parameter \(n=1\).

Figure 14 shows the reconstructed pulse using this method for 20, 50, 100, 150, 200 and 300 GeV electron beam energy. The positive part of the signal and the undershoot, are represented in these plots. These distributions include all the corrections outlined above (see section 4.2). The Figures 12-12 of the Appendix B show the fitted shape of these distributions from a polynomial function of degree four for each value of the elec

Figure 12: Distribution of the number of events as a function of the reconstructed phase value (a). Real delay as a function of the estimated delay for the first phase definition with \(n\)=1 (b) and \(n\)=2 (c) and the second definition (d).

tron beam energy. As explained before these functions will be used to provide a correction on the energy value of each event as a function of its phase.

#### 5.1.e. Results on energy resolution

The comparison of the results obtained with these different estimators has been achieved with the 20 GeV and 150 GeV electron beam data. Figures C.1 and C.2 of Appendix C present the results using only the high gain channels and including the geometrical corrections described above. The estimated resolutions at these energies are summarized in Table 2. The best result comes from the third method of energy estimation (_Fourier transformations method_) where we reach 2.88% and 1.27% of resolution for respectively 20 and 150 GeV electron beam.

In the future, the analysis of the 1996 beam test data will allow us to extract the energy value directly from the digitized web of the pulse, since a large fraction of these data has been recorded in synchronous mode, which means that the maximum of each pulse is properly digitized. This will hopefully improve the present results.

### Linearity of the estimator with the beam energy

The linearity of these estimators has been tested in the data taken with beam electrons from 20 to 300 GeV. This linearity is shown in Appendix A.

In Figure A.1 the evolution of the reconstructed energy is shown as a function of the beam energy as given by the SPS. Figure A.2 presents the discrepancy between the nominal value of the beam energy and the reconstructed energy. It is another way of representing this linearity. The two curves show the limits of the error on the beam energy values; they are given by the formula :

\[\pm\quad\biggl{\{}\biggl{(}\frac{25\%}{E_{beam}}\biggr{)}\quad\oplus\quad(0.5 \%)\biggr{\}},\]

and the precise beam energy values are : 20, 50, 99.8, 149.2, 197.45 and 287.50 GeV.

A linear fit on each estimator provides the following linearity correction :

* Method 1 : \((0.9637\pm 0.0001)\times E_{beam}+(11.876\pm 0.012)\)
* Method 2 : \((1.0654\pm 0.0001)\times E_{beam}-(4.252\pm 0.012)\)
* Method 3 : \((1.0252\pm 0.0001)\times E_{beam}+(0.170\pm 0.008)\)
* Method 4 : \((1.0225\pm 0.0001)\times E_{beam}-(0.491\pm 0.007)\)

## 6 Energy resolution

The evolution of the reconstructed energy resolution as a function of the electron beam energy has been fitted with the standard relation :

\[\frac{\sigma_{E}}{E}\quad=\quad\frac{a}{\sqrt{E}}\quad\oplus\quad\frac{b}{E} \quad\oplus\quad c \tag{1}\]

However, as the considered digital readout included a compressor, the effect of the electronic noise on the second term of this formula is not so clear. Indeed, the compressor is expected to affect all three components of the resolution function (see section 6.3) and the resolution curve fitted with two parameters (\(a\) and \(c\)) has also been studied.

In a first step, the analysis of the data is done using only the high gain shaper. In a second step, the contribution of both high and low gain is taken into account as it will be in the final readout scheme.

### Energy resolution with only the high gain shaper

From the previous study we can now extract from the overall set of recorded data, the global resolution of the liquid argon electromagnetic calorimeter with 0 T preamplifier and shaper and the presently used digital readout prototype. This resolution has been estimated for the second period of the beam test for 20, 50 100, 150, 200 and 300 GeV electron beam energies.

\begin{table}
\begin{tabular}{l|c c} \hline Energy & \multicolumn{2}{c}{Beam energy (GeV)} \\ \cline{2-3} estimator & 20 & 150 \\ \hline Method 1 & 3.612 \(\pm\) 0.038 & 1.334 \(\pm\) 0.017 \\ Method 2 & 4.998 \(\pm\) 0.051 & 1.596 \(\pm\) 0.020 \\ Method 3 & 2.878 \(\pm\) 0.030 & 1.266 \(\pm\) 0.015 \\ Method 4 & 3.191 \(\pm\) 0.036 & 1.556 \(\pm\) 0.021 \\ \hline \end{tabular}
\end{table}
Table 2: Summary of the results on the energy resolution for 20 and 150 GeV electron beam energies using only the high gain channels.

Figures D.1 and D.2 of Appendix D give the measured resolution of the detector with this digital readout prototype as a function of the beam energy using only the high gains shapers. The grey zone represents the expected value as given in the technical proposal of the ATLAS experiment [3]. The dashed line corresponds to the three standard deviation limits from the fitted values. These results are summarized in Table 3.

From these distributions we can outline two points:

* The value of the constant term is high, and this is mainly due to the fact that at the present time we only use the high gain of the 0T shaper in the analysis. Under this condition, for high energy values and high gain the signal is in the lower slope of the compressorshape, and a small error on the ADC value will produce a large smearing in the estimated energy. The introduction of the low gain is expected to reduce this effect and therefore to improve the results. It will be studied in the next section.
* If we exclude the first estimator distribution, the resolution is too low to see anything, the other three distributions exhibit the same behaviour in terms of resolution for 100, 200 and 300 GeV beam energy. It seems that the evolution of the resolution as a function of the energy does not follow the standard distribution of a resolution function as described in Eq. 1, even with only the two terms \(a\) and \(c\). This will be discussed in section 6.3.

### Energy resolution with both high and low gain shaper

To improve the results presented above we introduce the energy estimated with the low gain channels of the 0T bi-gain shaper. To do this we take the low gain for the first sampling and the high gain for the second and the third ones.

Figures E.1 to E.4 of Appendix E show these distributions (black triangles) for the first and the third estimators (namely R.M.S. and _Fourier transformations method_). As a comparison, the dots represent the resolution estimated with the high gain channels only. As expected, for low energy values the introduction of the low gain channels decreases the resolution and we should reach 200 GeV to see an improvement with the introduction of the low gain.

To fit these distributions, we have selected the high gain for the 20, 50 and 150 GeV points and we introduce the low gain on the first sampling only for the 200 and 300 GeV points. For each of these two estimators we have performed a fit with two parameters in the resolution function

\begin{table}
\begin{tabular}{l|r r r r r|r r r} \hline Energy & \multicolumn{4}{c|}{Fit with 3 parameters} & \multicolumn{4}{c}{Fit with 2 parameters} \\ \cline{2-9} estimator & \multicolumn{2}{c}{a} & \multicolumn{2}{c}{b} & \multicolumn{2}{c}{c} & \multicolumn{2}{c}{(\(\chi^{2}/\delta\))} & \multicolumn{2}{c}{a} & \multicolumn{2}{c}{c} & \multicolumn{2}{c}{(\(\chi^{2}/\delta\))} \\ \hline \hline \multicolumn{9}{c}{Resolution with high gain only} \\ \hline Method 1 & 9.10 \(\pm\)0.71 & 29.54\(\pm\)6.78 & 1.25\(\pm\)0.03 & (40.9/3) & 10.50 \(\pm\)0.17 & 1.20\(\pm\)0.01 & (31.9/4) \\ \hline Method 2 & 14.53 \(\pm\)0.63 & 91.80\(\pm\)2.61 & 1.35\(\pm\)0.03 & (82.3/3) & 22.75 \(\pm\)0.18 & 0.62\(\pm\)0.05 & (141.6/4) \\ \hline Method 3 & \multicolumn{4}{c|}{Fit failed} & \multicolumn{4}{c|}{12.38 \(\pm\)0.13} & 1.02\(\pm\)0.01 & (80.1/4) \\ \hline Method 4 & 12.30 \(\pm\)0.44 & 21.83\(\pm\)5.26 & 1.39\(\pm\)0.02 & (85.0/3) & 13.14 \(\pm\)0.16 & 1.34\(\pm\)0.02 & (64.6/4) \\ \hline \hline \multicolumn{9}{c}{Resolution with both high and low gain} \\ \hline Method 1 & 11.10 \(\pm\)0.15 & (138 MeV)\(\dagger\) & 0.98\(\pm\)0.01 & (6.4/3) & 11.36 \(\pm\)0.15 & 0.97\(\pm\)0.01 & (7.0/3) \\ \hline Method 3 & 12.22 \(\pm\)0.12 & (138 MeV)\(\dagger\) & 0.80\(\pm\)0.02 & (12.4/3) & 12.54 \(\pm\)0.12 & 0.78\(\pm\)0.02 & (11.4/3) \\ \hline \multicolumn{9}{c}{_Fixed parameter_} \\ \end{tabular}
\end{table}
Table 3: Summary of the results on the fit of the energy resolution using two or three parameters

### Discussion

The evaluation of the limitations in the system accuracy as due to the electronics and quantization noise is discussed here.

One readout electronic channel (preamplifier,shaper,compressorandADC,Fig.15)) can be approximately considered as a non-linear energy-to-digital converter of the transfer function \(t(E)=f^{-1}(E)\), where \(E=f(ADC)\) is the channel lookup table presented previously. The dynamic gain \(g(E)\) of the channel, defined as the slope of the transfer function \(t(E)\) is then:

\[g(E) = \frac{dt(E)}{dE}=\left[\frac{df}{dADC}(f^{-1}(E))\right]^{-1}\] \[= \frac{1}{p(E)}\left[\text{counts per GeV}\right]\]

where \(p(E)\) is the slope of the LUT at energy \(E\). The readout chain output noise \(\sigma\) is the addition of two noise contributions:

* a constant quantization noise \(a\), intrinsic to the analogue to digital (A/D) converter,
* a variable electronics noise \(e(E)\) resulting from a constant equivalent noise \(e_{E}\) at the input of the readout chain, such that \(e(E)=e_{E}\cdot g(E)\).

As these two contributions are uncorrelated, \(\sigma\) and its equivalent input noise \(\sigma_{E}\) are:

\[\sigma(E) = a\oplus e(E)\left[\text{counts}\right]\] \[\sigma_{E}(E) = a\cdot p(E)\oplus e_{E}\text{ [GeV]}.\]

These noise parameters can be determined experimentally by using the pedestal noise \(\sigma(0)\) and the LUT of each channel produced from test pulse runs (see section4.2). The high and low gain channels of a calorimeter cell only differ by the shaper specifications. Therefore, \(a_{H}\) and \(a_{L}\) are equal. Let \(a=a_{H}=a_{L}\), \(e_{L}=e_{L}(0)\) and \(e_{H}=e_{H}(0)\), then:

\[\sigma_{H}(0) = a\oplus e_{H}\] \[\sigma_{L}(0) = a\oplus e_{L}\]

and, finally, for each energy \(E\):

\[\sigma_{H}(E) = a\oplus e_{H}\cdot\frac{p_{H}(0)}{p_{H}(E)}\] \[\sigma_{L}(E) = a\oplus e_{L}\cdot\frac{p_{L}(0)}{p_{L}(E)}\] \[\sigma_{E\ H}(E) = a\cdot p_{H}(E)\oplus e_{H}\cdot p_{H}(0)\] \[\sigma_{E\ L}(E) = a\cdot p_{L}(E)\oplus e_{L}\cdot p_{L}(0).\]

A typical estimation of the intrinsic A/D converter noise was found to be \(a\simeq 0.8\) counts [4].

Figure 15: Simplified electronics chain and noise contributionsSetting the \(a\) noise value enables us to fully determine the other noise figures. For example, the noise parameters for channels 6 and 9 (high and low channels of the same calorimeter cell) are:

\[\left\{\begin{array}{lcl}\sigma_{H}(0)&\simeq&8.25\;\mbox{counts}&(140\;\mbox{ MeV})\\ \sigma_{L}(0)&\simeq&1.36\;\mbox{counts},&(238\;\mbox{MeV})\\ \end{array}\right.\]

\[\Longrightarrow\left\{\begin{array}{lcl}\epsilon_{H}&\simeq&8.22\;\mbox{ counts}&(138\;\mbox{MeV})\\ \epsilon_{L}&\simeq&1.11\;\mbox{counts}&(193\;\mbox{MeV}),\end{array}\right.\]

yielding

\[\sigma_{EH}(E) = 138\;\mbox{MeV}\oplus\beta_{H}(E) \tag{2}\] \[\sigma_{EL}(E) = 193\;\mbox{MeV}\oplus\beta_{L}(E). \tag{3}\]

Figures F.1 and F.2 of Appendix F show the resolution of the readout system with respect to the energy collected on the cell. On these plots, the step-wise linear structure of the compressor is clearly visible through the different energy regions where the equivalent input noise \(\sigma_{E}\) is approximately constant. On the other hand, Fig. F.2 clearly reveals the accuracy differences between the high and the low gain channel:

* the high gain channel is more accurate than the low gain channel for energies below 20 GeV/cell,
* above 80 GeV/cell, the low gain channel is the most accurate, because the high gain shaper reaches saturation and the compressor operates in the low gain regions,
* while the resolutions of both channels are similar for energies between 20 and 80 GeV/cell. Indeed, in this energy region, the compressor of the high gain channel operates in the second 'linear' region while the low gain channel one remains in the highest gain region.

The total resolution is expected to be \(10\%/\sqrt{E}\oplus b/E\oplus 0.7\%\) where \(b\) is the noise brought by the electronic chain and the other parameters are set to the minimal required resolution [3].

The value of \(0.7\%\) for the constant term is the one expected for the full coverage of the ATLAS electromagnetic calorimeter [5]. Most of this constant term is attributed to known sources of non-uniformity arising both from mechanical and from calibration effects. It has been measured in the test beam by scanning a very large number of cells [5]. In the present case, the determination of the constant term is restricted to a lower number of cells and therefore it is expected to be smaller than \(0.7\%\). However due to the use of the 4-gain compression this term is also affected by the electronic noise.

The \(b\) parameter depends on the energy and is a combination of the electronic noise of each individual cell presented previously (\(\sigma_{E}(E)=a\cdot p(E)\oplus e\cdot p(0)\)). As an example the Fig. 16 illustrates a detector resolution only including the contribution of channels number 6 and 9. The electronic noise is described by the equations 2 and 3. For comparison, distributions including only the constant part of the \(b\) parameter (138 MeV and 198 MeV for high and low gain respectively) are plotted.

* For an electron energy up to 50 GeV, the energy deposited in each channel is less than 20 GeV and the high gain gives a better resolution than the low gain.
* For 100 and 150 GeV beam energy, the central cell of the first sampling sees between 20 and 60 GeV and from Fig. 16, we expect the same resolution accuracy from both the low and the high gain. Moreover, at a beam energy of 100 GeV, the central cell of the first sampling collects the highest contribution of the energy namely about 20 GeV; The high gain channel of this cell then operates in the knee between the first and the second linear region of the compressor. Therefore the resolution of this high gain channel might be degraded.

* For 200 and 300 GeV beam the analysis of the data (see section 6.2) has shown that the energy resolution estimation is better when using the low gain for the first sampling; this improvement is bigger for 200 GeV than for 300 GeV. This is confirmed by Fig. 16 (see the regions around 80 GeV/cell and 180 GeV/cell for 200 GeV and 300 GeV beam respectively).

## 7 Conclusion

For the first time, a large number of channels have been equipped with a prototype digital readout allowing the extraction of a full energy resolution curve for a high resolution electromagnetic calorimeter prototype. This digital readout prototype included a four gain compressor with a 40 MHz-10 bit PSA-ADC developed in the RD 16 collaboration.

The result obtained on the energy resolution is :

\[\frac{\sigma_{E}}{E}(\%)=\frac{(1\,2.54\pm 0.12)}{\sqrt{E}}\oplus(0.78\pm 0.02),\]

which is not that far from the required signal resolution [3]. This study demonstrates that the use of a four gain compressor affects the performance of the overall readout system and puts a heavy load on the design of the electronic chain and the processing of the data at both non-line and off-line levels. It indicates that an adequate compression scheme followed by a more performant 40 MHz ADC as the ones actually available in the market are necessary to reach the final required resolution.

## Acknowledgements

We would like to thank Irene Vichou and Daniel Fournier for useful discussions and remarks.

## References

* [1] FERMI Collaboration, _Results of the testbeams of RD16 (FERMI) with electromagnetic and hadronic calorimeter prototypes_, The FERMI collaboration, FERMI Note NO-042, ATLAS Note/DAQ NO-042, CMS/TN Note NO-95-009, 1st January 1995.
* LERB Status Report / RD-16, 24 April 1995, and references therein. H. Alexanian et al., FERMI Collaboration, _FERMI: a digital Front End and Readout MIcrosystem for high resolution calorimetry_ NIM A 357 (1995) 306-317, and references

Figure 16: Total resolution of a calorimeter cell including the calorimeter terms \(0.7\%\oplus b/E\oplus 10\%/\sqrt{E}\) (dashed line) and the readout noise for high (thick line, \(b=138\) MeV) and low gain (thin line, \(b=198\) MeV) channels.