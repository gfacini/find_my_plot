# **Atlas Note**

ATL-PHYS-PUB-2009-000

March 22, 2009

**Muon Reconstruction and Identification: Studies with Simulated Monte Carlo Samples.**

The ATLAS Collaboration1

Footnote 1: This note prepared by D. Adams, K. Assamagan, H. Bachacou, S. Behar, K.M. Black, N. Benekos, L. Chevalier, T. Cornelissen, A. Dell’Acqua, N. Van Eldik, S. Goldfarb, S. Hassani, L. Kashif, Z. Van Kesteren, P. Kluit, J.-F. Laporte, D. Levin, E. Moyse, R. Nicolaidou, K. Nikolopoulos, A. Ouraou, N. Panikashvili, W. Park, A. Poppleton, D. Rebuzzi, D. Rousseau, G. Salamanna, S. Spagnolo, J. Sunverink, S. Tarem, Z. Tarem, S. Todorova, S. Vallecorsa, S. Willocq and M. Woudstra.

_This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020._

###### Abstract

The strategy and performance for muon identification and reconstruction in ATLAS are described. Performance metrics include efficiency, fake rates and momentum resolution. Results are based on data simulated and reconstructed in 2007.

## 1 Introduction

The ATLAS experiment will detect particles created in 14 TeV proton-proton collisions produced by the CERN LHC (Large Hadron Collider). Only a tiny fraction of these collisions will correspond to interesting standard model processes and an even smaller fraction to new physics. Muons, especially those with high-\(p_{T}\) (transverse momentum) and those that are isolated (from other activity in the detector), will be much more common in these interesting events than in the background, and thus provide important means to identify such events and to determine their properties. The ATLAS detector has been designed to be efficient in the detection of muons and to provide precise measurement of their kinematics up to one TeV.

In parallel with the construction of the detector, software has been developed to reconstruct these muons, i.e., for each recorded event, to identify muons and measure their position, direction and momentum. Here we describe the strategies being pursued for this reconstruction and the current performance characterized in terms of efficiency, fake rate and precision and accuracy of measurement. The results reported here are based on simulation data generated and reconstructed in 2007.

We begin with descriptions of the detector, the reconstruction algorithms and the means by which we measure the performance. These are followed by sections documenting this performance for each of the various reconstruction strategies and finally a section summarizing results and commenting on future developments.

## 2 Detector

The ATLAS detector [1] has been designed to provide clean and efficient muon identification and precise momentum measurement over a wide range of momentum and solid angle. The primary detector system built to achieve this is the muon spectrometer, shown in Figure 1. The spectrometer covers the pseudorapidity range \(|\eta|<2.7\) and allows identification of muons with momenta above 3 GeV/c and precise determination of \(p_{T}\) up to about 1 TeV/c.

The muon spectrometer comprises three subsystems:

Figure 1: The ATLAS muon spectrometer.

* Superconducting coils provide a toroidal magnetic field whose integral varies significantly as a function of both \(\eta\) and \(\varphi\) (azimuthal angle). The integrated bending strength (Figure 2) is roughly constant as a function of \(\eta\) except for a significant drop in the transition between the barrel and endcap toroid coils (\(1.4\mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}} \mathrel{\hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}|\eta|\mathrel{ \hbox to 0.0pt{\lower 4.0pt\hbox{ $\sim$}}\raise 1.0pt\hbox{$<$}}1.6\)).
* Precision detectors are located in three widely-separated _stations_ at increasing distance from the collision region. Each station includes multiple closely-packed layers measuring the \(\eta\)-coordinate, the direction in which most of the magnetic field deflection occurs. Monitored drift tubes provide these measurements everywhere except in the high-\(\eta\) (\(|\eta|>2.0\)) region of the innermost station where cathode strip chambers are used. The measurement precision in each layer is typically better than 100 \(\mu\)m. The cathode strip chambers additionally provide a rough (1 cm) measurement of the \(\varphi\)-coordinate.
* Resistive plate and thin gap chambers provide similarly rough measurements of both \(\eta\) and \(\varphi\) near selected stations.

High-\(p_{T}\) muons typically traverse all three stations but there are \(\eta\)-\(\varphi\) regions where one, two or all three stations do not provide a precision measurement, e.g. those regions with support structures or passages for services. There are also regions where overlaps allow two measurements from a single station. Figure 3 shows the number of station measurements as function of \(\eta\) and \(\varphi\). The resolution and efficiency are degraded where one or more stations do not provide a measurement.

Figure 4 shows how contributions to the muon spectrometer momentum resolution vary as a function of \(p_{T}\). At low momentum, the resolution is dominated by fluctuations in the energy loss of the muons traversing the material in front of the spectrometer. Multiple scattering in the spectrometer plays an important role in the intermediate momentum range. For \(p_{T}>300\) GeV/c, the single-hit resolution, limited by detector characteristics, alignment and calibration, dominates.

The other ATLAS detector systems also play important roles in achieving the ultimate performance for muon identification and measurement. The calorimeter, with a thickness of more than 10 interaction lengths, provides an effective absorber for hadrons, electrons and photons produced by proton-proton

Figure 2: ATLAS muon spectrometer integrated magnetic field strength as a function of \(|\eta|\).

Figure 4: Contributions to the momentum resolution for muons reconstructed in the Muon Spectrometer as a function of transverse momentum for \(|\eta|<1.5\). The alignment curve is for an uncertainty of 30 \(\mu\)m in the chamber positions.

Figure 3: Number of detector stations traversed by muons passing through the muon spectrometer as a function of \(|\eta|\) and \(\varphi\).

[MISSING_PAGE_FAIL:5]

### Inner detector

The primary track reconstruction algorithm for the inner detector is described in Ref. [7]. Space points are identified in the pixel and microstrip detectors, these points are linked to form track seeds in the inner four layers, and tracks are found by extending these seeds to add measurements from the outer layers. This strategy is expected to give very high detection efficiency over the full detector acceptance, \(|\eta|<2.5\).

### Combined muons

Both of the muon combination algorithms, Staco and Muid, pair muon-spectrometer tracks with inner-detector tracks to identify combined muons. The match chi-square, defined as the difference between outer and inner track vectors weighted by their combined covariance matrix:

\[\chi^{2}_{match}=\left(\mathbf{T_{MS}}-\mathbf{T_{ID}}\right)^{\mathrm{T}} \left(\mathbf{C_{ID}}+\mathbf{C_{MS}}\right)^{-1}\left(\mathbf{T_{MS}}- \mathbf{T_{ID}}\right) \tag{1}\]

provides an important measure of the quality of this match and is used to decide which pairs are retained. Here \(\mathbf{T}\) denotes a vector of (five) track parameters--expressed at the point of closest approach to the beam line--and \(\mathbf{C}\) is its covariance matrix. The subscript ID refers to the inner detector and MS to the muon spectrometer (after extrapolation accounting for energy loss and multiple scattering in the calorimeter).

Staco does a statistical combination of the inner and outer track vectors to obtain the combined track vector:

\[\mathbf{T}=\left(\mathbf{C_{ID}^{-1}}+\mathbf{C_{MS}^{-1}}\right)^{-1}\left( \mathbf{C_{ID}^{-1}}\mathbf{T_{ID}}+\mathbf{C_{MS}^{-1}}\mathbf{T_{MS}}\right) \tag{2}\]

Muid does a partial refit: it does not directly use the measurements from the inner track, but starts from the inner track vector and covariance matrix and adds the measurements from the outer track. The fit accounts for the material (multiple scattering and energy loss) and magnetic field in the calorimeter and muon spectrometer.

### Tagged muons

The spectrometer tagging algorithms, MuTag [3] and MuGirl [8], propagate all inner detector tracks with sufficient momentum out to the first station of the muon spectrometer and search for nearby segments. MuTag defines a tag chi-square using the difference between any nearby segment and its prediction from the extrapolated track. MuGirl uses an artificial neural network to define a discriminant. In either case, if a segment is sufficiently close to the predicted track position, then the inner detector track is tagged as corresponding to a muon.

At present, both algorithms simply use the inner-detector track to evaluate the muon kinematics, i.e. the inner track and spectrometer hits are not combined to form a new track. This is not very important in the low-\(p_{T}\) regime that these algorithms were originally intended to address. Both algorithms are being further developed to allow extrapolation to other and multiple stations and add the capability to include the spectrometer measurements in a track refit.

There is an important difference in the way these algorithms are run in the standard reconstruction chain. MuGirl considers all inner-detector tracks and redoes segment finding in the region around the track. MuTag only makes use of inner-detector tracks and muon-spectrometer segments not used by Staco. Thus MuTag serves only to supplement Staco while MuGirl attempts to find all muons. Obviously, MuTag is part of the Staco family and most sensibly used in that context. MuGirl muons are recorded as part of the Muid family.

### Merging muons

The muon finding efficiency (and fake rate) may be increased by including muons found by multiple algorithms but care must be taken to remove overlaps, i.e. cases where the same muon is identified by two or more algorithms. To a large extent, this is done when the collections are created. Standalone muons that are successfully combined are not recorded separately. In those cases where a standalone muon is combined with more than one inner-detector track, exactly one of the muons is flagged as "best match." In the Staco collection, the tagged and combined muons do not overlap by construction. In the Muid collection, overlaps between MuGirl and Muid muons are removed by creating a single muon when both have the same inner detector track.

Analysts wishing to merge standalone and tagged muons or muons from different collections may make use of a muon selection tool to remove overlaps. It requires muons have different inner-detector tracks and merges standalone muons that are too close to one another. Closeness is defined by \(\eta\)-\(\varphi\) separation with a default limit of 0.4.

## 4 Tools for performance evaluation and classification of tracks

Simulation samples were created in the ATLAS framework by running an event generator (PYTHIA [9] or MC@NLO [10, 11]) and using GEANT4 [12] to propagate the final-state particles using ATLAS-specific code to describe the geometry and response of the detector. The data were then reconstructed using the software based on the algorithms described in the previous chapter.

### Truth matching and track classification

Muon reconstruction performance is evaluated for each event by comparing selected reconstructed muons with the true muons, i.e. those in the Monte Carlo truth record. The latter include muons created in the initial event generation as well as secondaries produced during propagation through the tracking volume. Muons produced in the calorimeter or muon spectrometer are not included in the truth record. True muons with transverse momentum below 2 GeV/c are also excluded to avoid spurious matches with candidates we do not expect to be able to reconstruct.

For each event, a one-to-one matching is performed between the selected reconstructed muons and the true muons. The matching makes use of two distance metrics: \(D_{ref}\) is the _reference_ distance measured from true muon to the reconstructed muon:

\[D_{ref}=\sqrt{\left(\frac{\varphi_{reco}-\varphi_{true}}{0.005}\right)^{2}+ \left(\frac{\eta_{reco}-\eta_{true}}{0.005}\right)^{2}+\left(\frac{\Delta p_{ T}/p_{T}}{0.03}\right)^{2}} \tag{3}\]

and \(D_{eva}\) is the _evaluation_ distance measured from the reconstructed muon to the true muon:

\[D_{eva}=\sqrt{\left(\mathbf{T_{reco}-T_{true}}\right)\mathbf{C_{reco}^{-1}} \left(\mathbf{T_{reco}-T_{true}}\right)} \tag{4}\]

In the first equation, \(\Delta p_{T}/p_{T}\) is the fractional momentum resolution:

\[\frac{\Delta p_{T}}{p_{T}}=\frac{1/p_{Treco}-1/p_{Ttrue}}{1/p_{Ttrue}}=\frac {p_{True}-p_{Treco}}{p_{Treco}} \tag{5}\]

Here \(p_{T}\) is signed (i.e. carries the charge sign), but elsewhere in the text it denotes the magnitude of the transverse momentum. In the second distance equation, **T** again denotes the vector of (five) track parameters (expressed at the distance of closest approach to the beam line) and **C** the associated covariance matrix. Note that \(D_{eva}^{2}\) is a chi-square with five degrees of freedom.

There is a maximum allowed value for each of these distances. For \(D_{eva}\) the maximum value is 1000, a very loose cut. The limit for \(D_{ref}\) is 100 and we see from equation 3 this implies the matched muons must be within a distance of 0.5 in \(\eta\) and \(\varphi\) and have the same charge sign with \(p_{Treco}>0.25\,p_{Ttrue}\) or opposite sign with \(p_{Treco}>0.50\,p_{Ttrue}\).

The matching is carried out by first examining each reconstructed muon and assigning it to the nearest true muon using the evaluation distance. The reconstructed muon is left unmatched if no distance is less than the maximum allowed value. The reference distance is evaluated for each match and the match is discarded if it exceeds the threshold for that quantity. If more than one match remains for any true muon, then only the match with the smallest reference distance is retained.

True muons that are matched are said to be _found_ and those left unmatched are _lost_. Found muons are classified as _good_ if they have \(D_{eva}<4.5\) corresponding to a chi-square probability above 0.0011.

Reconstructed muons are said to be _real_ if they are matched and _fake_ if unmatched. Note that these fakes may correspond to true muons produced outside the tracking volume (e.g. in the calorimeter) and hence not included in the truth record.

### Performance measures

Our performance measures include efficiency, fake rate, resolutions and resolution tails. The efficiency or _finding efficiency_ is defined to be the fraction of true muons that are found and is typically evaluated for some kinematic selection (applied after matching). The _good efficiency_ is the fraction of true muons that are found and classified as good (as defined in the previous section). The _good fraction_ is the fraction of found muons that are classified as good. In the sections that follow, we present the overall efficiency for various physics samples and the efficiency as a function of \(\eta\) for the primary benchmark sample.

The fake rate is defined to be the mean number of fake muons per event and it is presented for a variety of \(p_{T}\) thresholds corresponding to the values that might be chosen for different physics analyses.

Five kinematic variables characterize a track, but here we examine only the measurement of the transverse momentum. The precision and accuracy of the direction measurements are typically much better than that required for any physics analysis. The measurement of the initial position of the track (e.g. at the distance of closest approach to the beam line or vertex) is discussed in another note [13]. For the momentum, we use the fractional residual, \(\Delta p_{T}/p_{T}\), defined in equation 5. This distribution is fitted with a Gaussian and the resolution is defined to be the sigma of this fit. The tails in the distributions are often more important than the core resolution and we characterize these by evaluating the fraction of found muons in five tail categories. The first three are those for which the magnitude of this residual exceeds 5%, 10% or 30%. The last category is the fraction for which the charge sign is incorrectly measured. Finally there is an intermediate category in which either the sign is incorrect or the magnitude of the measured momentum is more than two times larger than the true value.

### Monte Carlo samples

Our primary benchmark sample is a collection of \(t\bar{t}\) events requiring the presence of at least one lepton (electron, muon or tau). The initial inclusive sample was produced using MC@NLO in conjunction with Herwig [14]. This sample provides a variety of mechanisms for producing muons and we present results for two: _direct_ muons which do not have any quarks in their ancestry and _indirect_ muons whose ancestry includes a heavy quark (b or c) but not a tau. In this sample, the former are produced directly in the leptonic decay of a W-boson.

Performance metrics are plotted as a function of \(\eta\) for \(t\bar{t}\) direct muons. In addition, we tabulate efficiencies and fake rates for these muons, for \(t\bar{t}\) indirect muons, and for muons in separate low- and high-\(p_{T}\) samples. The low-\(p_{T}\) sample is taken from direct PYTHIA \(J/\psi\) production with the \(J/\psi\) forced to decay to two muons and a filter selecting only those events where both muons have \(|\eta|<2.5\) and \(p_{T}>4\) GeV/c. Muons produced by other processes in these events are suppressed by restricting the analyzed sample to muons that have a c-quark in their ancestry. The high-\(p_{T}\) sample consists of direct muons in PYTHIA production of \(Z^{\prime}\to\mu\mu\) with a \(Z^{\prime}\) mass of 2 TeV. The generation also includes \(Z/\gamma\) and interference but a dimuon mass cut (\(m_{\mu\mu}>500\) GeV/c) ensures that the average muon \(p_{T}\) is above 500 GeV/c.

At design luminosity, ATLAS will have many interactions in each beam crossing (pileup) and there will be significant background in the muon chambers from low-energy photons and neutrons (cavern background). To get an estimate of the effect this will have on our reconstruction algorithms, we processed a \(t\bar{t}\) sample overlaid with the backgrounds expected for a reference luminosity of \(10^{33}\) cm\({}^{-2}\)s\({}^{-1}\). The cavern background was included with a safety factor of 2.0, i.e. at twice the value expected for this luminosity. In the following, this sample is called the high-luminosity \(t\bar{t}\) sample. Low luminosity refers to samples without any pileup or cavern background.

There is considerable uncertainty in the estimate of the cavern background and active development is underway to improve reconstruction in this environment, and so the results presented here provide only a rough indication of the performance we expect at high luminosity.

Figure 5 shows the \(p_{T}\), \(\eta\) and isolation energy distributions for the true muons in the samples studied in this note. The isolation energy was obtained by summing the calorimeter transverse energy in an \(\eta\)-\(\varphi\) cone of radius 0.2 about the muon. The most probable value for the muon energy loss (as discussed in reference [2]) is subtracted from these values.

Figure 5: True \(p_{T}\) (left), \(\eta\) (center) and isolation (right) distributions for the \(t\bar{t}\) direct muons (top), \(t\bar{t}\) indirect muons (second from top), \(Z^{\prime}\) (mass 2 TeV) direct muons (third from top) and \(J/\psi\) muons (bottom). Note that the \(p_{T}\) range is different in each of the plots of that variable.

## 5 Standalone muon performance

### Efficiencies and fake rates

Figure 6 shows the standalone \(t\bar{t}\) direct muon efficiencies and fake rates as functions of \(\eta\) at low luminosity (i.e. without any pileup or cavern background) and at our reference luminosity (\(10^{33}\) /cm\({}^{2}\)/sec with cavern background safety factor 2.0). Table 1 gives the integrated efficiencies and fake rates for these and other samples.

Comparing with Figure 3, we see most of the efficiency loss occurs in regions where the detector coverage is poor, i.e. for \(|\eta|\) around 0.0 and 1.2. Otherwise, the \(t\bar{t}\) muon efficiency is close to 100% for Muonboy and around 99% for Moore/Muid. The Muid good fraction is significantly higher than for Muonboy, presumably because of better handling of the material in the calorimeter. The algorithms have similar fake rates at low luminosity. At the higher luminosity, the Staco rate increases significantly (by a factor of 2-4) while the Moore/Muid rate increases dramatically (factor of 100). In the high-\(p_{T}\)\(Z^{\prime}\), the efficiency falls by a few percent for both algorithms. For the low-\(p_{T}\) (and non-isolated) \(J/\psi\) muons, the Moore/Muid efficiency degrades significantly while Muonboy remains high.

### Resolution

Figure 7 shows the \(p_{T}\) resolutions and tails as functions of \(\eta\) and \(p_{T}\). The resolution is degraded at intermediate pseudorapidity (\(1.2<|\eta|<1.7\)) because of the reduced number of measurements (figure 3), the low field integral in the overlap between barrel and endcap toroids (figure 2), and the material in the endcap toroid (figure 1). The average resolution is very similar for the two algorithms. Despite having a lower good fraction, Muonboy has fewer muons for which the charge sign is incorrectly measured. This suggests that, at least in the tails, Moore/Muid provides a better estimate of the momentum error while Muonboy provides a better estimate of its value. The Moore/Muid tails are likely due to the assignment of incorrect hits to spectrometer tracks.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c c|} \hline  & \multicolumn{3}{c|}{Efficiency} & \multicolumn{3}{c|}{Fakes/(1000 events) above \(p_{T}\) limit (GeV/c)} \\ Sample & found & good & 3 & 10 & 20 & 50 \\ \hline \hline \multicolumn{10}{|c|}{Muonboy} \\ \hline \(t\bar{t}\) direct & 0.951 (1) & 0.812 (1) & \multirow{2}{*}{24.0 (3)} & \multirow{2}{*}{4.4 (1)} & \multirow{2}{*}{1.69 (7)} & \multirow{2}{*}{0.52 (4)} \\ \(t\bar{t}\) indirect & 0.949 (1) & 0.783 (2) & & & & & \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.950 (2) & 0.809 (3) & 53 (1) & 8.2 (4) & 3.9 (2) & 1.9 (2) \\ \hline \(Z^{\prime}\) direct & 0.914 (2) & 0.781 (3) & 141 (4) & 79 (3) & 61 (3) & 37 (2) \\ \hline \(J/\psi\) & 0.959 (3) & 0.764 (6) & 51 (1) & 5.0 (4) & 1.6 (2) & 0.6 (1) \\ \hline \hline \multicolumn{10}{|c|}{Moore/Muid} \\ \hline \(t\bar{t}\) direct & 0.943 (1) & 0.861 (1) & \multirow{2}{*}{19.8 (3)} & \multirow{2}{*}{3.9 (1)} & \multirow{2}{*}{1.44 (6)} & \multirow{2}{*}{0.47 (4)} \\ \(t\bar{t}\) indirect & 0.920 (2) & 0.838 (2) & & & & \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.932 (2) & 0.836 (3) & 984 (4) & 301 (2) & 156 (2) & 61 (1) \\ \hline \(Z^{\prime}\) direct & 0.887 (2) & 0.769 (3) & 168 (4) & 102 (3) & 75 (3) & 43 (2) \\ \hline \(J/\psi\) & 0.830 (5) & 0.723 (6) & 6.7 (4) & 1.1 (2) & 0.5 (1) & 0.13 (6) \\ \hline \end{tabular}
\end{table}
Table 1: Muonboy and Moore/Muid efficiencies and fake rates for various samples (section 4.3). Efficiencies are presented both for all found muons and for those with a good truth match (\(D_{eu}<4.5\)). Both are calculated for true muons with \(|\eta|<2.5\) and \(p_{T}>10\) GeV/c. Fake rates are presented for a variety of \(p_{T}\) thresholds.

Figure 6: Standalone efficiency and fake rate as functions of true \(\eta\) for Muonboy (left) and Moore/Muid (right) for direct muons in \(t\bar{t}\) at low (top) and high (bottom) luminosity. In the efficiency plots, the upper curve (blue) is the efficiency to find the muon while the lower curve (green) additionally requires a good match (\(D_{eva}<4.5\)) between reconstructed and true track parameters. Fake rates are shown for a variety of \(p_{T}\) thresholds.

Figure 7: Standalone fractional momentum resolution (\(\Delta p_{T}/p_{T}\)) as function of \(\eta\) (top) and \(p_{T}\) (2nd row) and tails in that parameter also as functions of \(\eta\) (3rd row) and \(p_{T}\) (bottom). All are for both Muonboy (left) and Moore/Muid (right). The tail is the fraction of reconstructed muons with magnitude of \(\Delta p_{T}/p_{T}\) outside a range and is shown for a wide range of values. The last tail curve (red, “charge”) includes only muons reconstructed with the wrong charge sign. The 4th tail curve (yellow, “2X high”) includes these and those with momentum magnitude more than two times the true value.

## 6 Inner detector performance

Figure 8 shows the efficiency for \(t\bar{t}\) direct muons and Table 2 gives the integrated efficiencies for all of the samples. The efficiency is high for all \(\eta\) (within the acceptance) and all samples. There is no evidence of degradation when pileup is added.

The inner detector momentum resolution is the same as that for tagged muons, reported later: see Figure 13 in section 8.

## 7 Combined muon performance

### Efficiencies and fake rates

Figure 9 shows the combined \(t\bar{t}\) direct muon efficiency and fake rates for each algorithm as a function of \(\eta\) for both low and high luminosity. Compared with the performance for standalone muons (figure 6), Staco shows a small drop in efficiency with little reduction of the fake rate except for the lowest \(p_{T}\) threshold at high luminosity. In fact, the high-\(p_{T}\) fake rates increase at either luminosity because low-\(p_{T}\) standalone muons are matched to high-\(p_{T}\) inner-detector tracks. At low luminosity, Muid \(t\bar{t}\) shows a

\begin{table}
\begin{tabular}{|c|c|c|} \hline  & \multicolumn{2}{c|}{Efficiency} \\ Sample & found & good \\ \hline \(t\bar{t}\) direct & 0.996 (1) & 0.950 (2) \\ \(t\bar{t}\) indirect & 0.997 (1) & 0.833 (5) \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.995 (1) & 0.947 (2) \\ \hline Zprime direct & 0.993 (1) & 0.966 (1) \\ \hline \(J/\psi\) & 0.995 (1) & 0.941 (3) \\ \hline \end{tabular}
\end{table}
Table 2: Inner detector efficiencies. The samples and algorithms are described in the text. Efficiencies are presented both for all found muons and for those with a good truth match (\(D_{eva}<4.5\)). Efficiencies are calculated for true muons with \(|\eta|<2.5\) and \(p_{T}>10\) GeV/c.

Figure 8: Inner detector \(t\bar{t}\) direct muon efficiency as a function of true \(\eta\) at low (left) and high (right) luminosity. In each figure, the upper curve (blue) is the efficiency to find the muon while the lower curve (green) additionally requires a good match (\(D_{eva}<4.5\)) between reconstructed and true track parameters. The efficiency is for \(p_{T}>10\) GeV/c.

small decrease in both efficiency and fake rate. When background is added, the dramatic increase in fakes for Moore standalone is not observed in Muid combined, i.e. the matching suppresses most of the fakes and the Muid high-\(p_{T}\) fake rates are lower than those of Staco. However, the high-luminosity \(t\bar{t}\) Muid efficiency is significantly worse than that of Staco.

When matching inner detector and muon spectrometer tracks, both Staco and Muid calculate \(\chi^{2}_{match}\) (section 3.3) which serves as a discriminant for separating real and fake muons. The fakes include pion or kaon decays in or near the calorimeter. Figure 10 shows the \(\chi^{2}_{match}\) distributions for both direct found muons and fakes. We see that with a cut on this quantity, e.g. \(\chi^{2}_{match}<100\), many of the Staco high-\(p_{T}\) fakes can be suppressed with only a modest loss in efficiency. The higher Staco fake rates come from looser cuts during reconstruction and, if the \(\chi^{2}_{match}\) cuts are adjusted to give the same efficiencies, the Staco fake rate is lower.

Table 3 shows the integrated Staco and Muid muon efficiencies and fake rates for all samples including an entry showing the effect of the above cut on \(\chi^{2}_{match}\).

### Resolution

Figure 11 shows the \(t\bar{t}\) direct muon \(p_{T}\) resolutions and tails as functions of \(\eta\) and \(p_{T}\). Comparing with the same for standalone reconstruction (figure 7), we see, as expected, the combined resolution is significantly better especially in the overlap region (\(|\eta|\) around 1.5) and for \(p_{T}\) below 100 GeV/c. There are also significant reductions in the tails of momentum residuals. Misreconstruction and charge misidentification rates are around 0.01% for the combined muons instead of 0.1% for the standalone.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline  & \multicolumn{3}{|c|}{Efficiency} & \multicolumn{3}{|c|}{Fakes/(1000 events) above \(p_{T}\) limit (GeV/c)} \\ Sample & found & good & 3 & 10 & 20 & 50 \\ \hline \hline \multicolumn{8}{|c|}{Staco} \\ \hline \(t\bar{t}\) direct & 0.943 (1) & 0.875 (1) & \multirow{2}{*}{22.0 (3)} & \multirow{2}{*}{9.6 (2)} & \multirow{2}{*}{3.4 (1)} & \multirow{2}{*}{0.62 (4)} \\ \(t\bar{t}\) indirect & 0.933 (1) & 0.767 (2) & & & & \\ \hline \(t\bar{t}\) direct cut & 0.924 (1) & 0.865 (1) & 14.8 (2) & 3.1 (1) & 0.39 (3) & 0.01 (1) \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.941 (2) & 0.871 (3) & 25.9 (7) & 11.2 (4) & 4.3 (3) & 0.7 (1) \\ \hline \(Z^{\prime}\) & 0.910 (2) & 0.824 (3) & 14 (1) & 8.4 (9) & 5.2 (7) & 3.4 (6) \\ \hline \(J/\psi\) & 0.943 (3) & 0.873 (4) & 0.9 (2) & 0.24 (8) & 0.11 (5) & 0.0 (0) \\ \hline \hline \multicolumn{8}{|c|}{Muid} \\ \hline \(t\bar{t}\) direct & 0.926 (1) & 0.877 (1) & \multirow{2}{*}{15.4 (2)} & \multirow{2}{*}{2.36 (9)} & \multirow{2}{*}{0.48 (4)} & \multirow{2}{*}{0.05 (1)} \\ \(t\bar{t}\) indirect & 0.888 (2) & 0.748 (3) & & & & \\ \hline \(t\bar{t}\) direct cut & 0.917 (1) & 0.871 (1) & 14.0 (2) & 1.96 (8) & 0.33 (3) & 0.03 (1) \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.904 (2) & 0.854 (3) & 35.5 (8) & 5.0 (3) & 1.1 (1) & 0.24 (6) \\ \hline \(Z^{\prime}\) direct & 0.872 (2) & 0.811 (3) & 11 (1) & 4.5 (7) & 3.1 (6) & 2.7 (5) \\ \hline \(J/\psi\) & 0.793 (5) & 0.741 (6) & 0.8 (1) & 0.03 (3) & 0.0 (0) & 0.0 (0) \\ \hline \end{tabular}
\end{table}
Table 3: Staco and Muid efficiencies and fake rates. The samples and algorithms are described in the text. Algorithm names are followed by “cut” to indicate that reconstructed muons are required to have \(\chi^{2}_{match}<100\) for both efficiency and fake calculations. Efficiencies are presented both for all found muons and for those with a good truth match. Both are calculated for true muons with \(|\eta|<2.5\) and \(p_{T}>10\) GeV/c. The fake rates are presented for a variety of \(p_{T}\) thresholds.

Figure 9: Combined muon efficiency and fake rate for Staco (left) and Muid (right) as functions of true \(\eta\) for direct muons in \(t\bar{t}\) at low (top) and high (bottom) luminosity. In each efficiency plot, the upper curve (blue) is the efficiency to find the muon while the lower curve (green) additionally requires a good match (\(D_{\it eva}<4.5\)) between reconstructed and true track parameters. The efficiencies are for \(p_{T}>10\)\(\mathrm{GeV}/c\). Fake rates are shown for a variety of \(p_{T}\) thresholds.

Figure 10: Distributions of \(\chi^{2}_{match}\) for direct muons (top) and fakes (third from top). The fakes are shown for a variety of \(p_{T}\) thresholds. The second row shows the efficiency as function of \(\chi^{2}_{match}\) when muons above that value are rejected. The bottom row shows the fake rates as a function of efficiency as that threshold is varied. All are shown for both Staco (left) and Muid (right). The sharp drops in the Staco \(\chi^{2}_{match}\) distribution come from cuts on that quantity made during reconstruction, i.e. before filling the output muon collection.

Figure 11: Combined muon fractional momentum resolution (\(\Delta p_{T}/p_{T}\)) as function of \(\eta\) (top) and \(p_{T}\) (2nd row) and tails in that parameter also as functions of \(\eta\) (3rd row) and \(p_{T}\) (bottom). All are for both Staco (left) and Muid (right). The tail is the fraction of reconstructed muons with magnitude of \(\Delta p_{T}/p_{T}\) outside a range and is shown for a wide range of values. The last tail curve (red, “charge”) includes only muons reconstructed with the wrong charge sign. The 4th tail curve (yellow, “2X high”) includes these and those with momentum magnitude more than two times the true value.

Tagged muon performance

### Efficiencies and fake rates

ATLAS runs two tagging algorithms but only MuGirl attempts to find all muons. MuTag is run in a manner to complement Staco and the performance of the combination of these two is reported in the following section.

Figure 12 shows the MuGirl direct muon efficiency and fake rates as a function of \(\eta\) in \(t\bar{t}\) at low and high luminosity. Table 4 gives the MuGirl integrated efficiencies and fake rates for all our samples.

Comparing with the combined muon results (figure 9 and table 3), we see that MuGirl has lower efficiency and a substantially higher fake rate. We also observe that its performance degrades faster when luminosity background is added. MuGirl has higher efficiency than Muid for reconstructing the low-\(p_{T}\) muons in the \(J/\psi\) sample.

### Resolution

Figure 13 shows the MuGirl \(p_{T}\) resolution and tail as functions of \(\eta\) and \(p_{T}\). MuGirl does not refit the tracks and so this is just the resolution of the inner detector. Comparing with the standalone (figure 7) and combined (figure 11), we see how the standalone and inner measurements complement one another to give high precision over the full \(\eta\) and \(p_{T}\) range of the \(t\bar{t}\) sample.

## 9 Merged muon performance

Finally we consider merging the muons produced by different algorithms. There are many possible combinations but we restrict ourselves to two simple but important cases: merging the combined and tagged muons separately within each collection (family), i.e. we examine Staco\(+\)MuTag and Muid\(+\)MuGirl.

Figure 14 shows the corresponding direct muon efficiencies and fake rates in \(t\bar{t}\) at low and high luminosity. The integrated efficiencies and fake rates for all samples are summarized in table 5. One of the primary goals of the tagging algorithms is to reconstruct low-\(p_{T}\) muons which the standalone reconstruction misses because the energy loss in the calorimeter leaves these muons with very little momentum in the muon spectrometer. Figure 15 shows the low-\(p_{T}\) efficiency as function of \(p_{T}\) for combined alone and combined supplemented with tagged for each of the collections.

The merge provides only a small improvement in the Staco efficiencies and a substantial increase in the fake rates (factor of about four). For Muid, the efficiency gains are more substantial: the indirect

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline  & \multicolumn{2}{|c|}{Efficiency} & \multicolumn{2}{|c|}{Fakes/(1000 events) above \(p_{T}\) limit (GeV/c)} \\ Sample & found & good & 3 & 10 & 20 & 50 \\ \hline \(t\bar{t}\) direct & 0.911 (1) & 0.870 (1) & \multirow{2}{*}{105.0 (6)} & \multirow{2}{*}{23.7 (3)} & \multirow{2}{*}{7.3 (2)} & \multirow{2}{*}{1.14 (6)} \\ \(t\bar{t}\) indirect & 0.899 (2) & 0.748 (3) & & & & \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.866 (3) & 0.825 (3) & 154 (2) & 26.1 (7) & 7.6 (4) & 1.2 (1) \\ \hline \(Z^{\prime}\) direct & 0.802 (3) & 0.781 (3) & 57 (2) & 26 (2) & 15 (1) & 5.9 (8) \\ \hline \(J/\psi\)\(c\)-quark & 0.888 (4) & 0.839 (5) & 4.4 (3) & 0.11 (5) & 0 (0) & 0 (0) \\ \hline \end{tabular}
\end{table}
Table 4: MuGirl efficiencies and fake rates. The samples and algorithms are described in the text. Efficiencies are presented both for all found muons and for those with a good truth match. Both are calculated for truth muons with \(|\eta|<2.5\) and \(p_{T}>10\) GeV/c. The fake rates are presented for a variety of \(p_{T}\) thresholds.

Figure 12: MuGirl efficiency (left) and fake rates (right) as a function of true \(\eta\) in \(t\bar{t}\) at low (top) and high (bottom) luminosity. In each efficiency plot, the upper curve (blue) is the efficiency to find the muon while the lower curve (green) additionally requires a good match (\(D_{eva}<4.5\)) between reconstructed and true track parameters. The efficiency is for muons with true \(p_{T}>10\) GeV/c. Fake rates are presented for a variety of \(p_{T}\) thresholds.

Figure 13: MuGirl fractional momentum resolution (\(\Delta p_{T}/p_{T}\)) as a function of \(\eta\) (top) and \(p_{T}\) (bottom). Both the distribution (left) and tails (right) are shown for each. The tail is the fraction of reconstructed muons with magnitude of residual greater than a threshold and results are shown for a variety of thresholds. The last tail curve (red, “charge”) includes only muons reconstructed with the wrong charge sign. The 4th tail curve (yellow, “2X high”) includes these and those with momentum magnitude more than two times the true value.

Figure 14: Muon efficiencies and fake rates for Staco+MuTag (left) and Muid+MuGirl (right) as functions of true \(\eta\) in \(t\bar{t}\) at low (top) and high (bottom) luminosity. In each efficiency plot, the upper curve (blue) is the efficiency to find the muon while the lower curve (green) additionally requires a good match (\(D_{eva}<4.5\)) between reconstructed and true track parameters. The muon selection is described in the text. The efficiency is calculated for true \(p_{T}>10\) GeV/c. The fake rates are presented for a variety of \(p_{T}\) thresholds.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Sample & \multicolumn{3}{|c|}{Efficiency} & \multicolumn{3}{|c|}{Fakes/(1000 events) above \(p_{T}\) limit (GeV/c)} \\  & found & good & 3 & 10 & 20 & 50 \\ \hline \hline \multicolumn{10}{|c|}{Staco+MuTag} \\ \hline \(t\bar{t}\) direct & 0.948 (1) & 0.879 (1) & \multirow{2}{*}{49.0 (4)} & \multirow{2}{*}{14.4 (2)} & \multirow{2}{*}{4.8 (1)} & \multirow{2}{*}{0.86 (5)} \\ \(t\bar{t}\) indirect & 0.940 (1) & 0.772 (2) & & & & \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.946 (2) & 0.876 (3) & 58 (1) & 16.6 (5) & 6.1 (3) & 1.1 (1) \\ \hline \(Z^{\prime}\) direct & 0.931 (2) & 0.844 (3) & 32 (2) & 14 (1) & 7.1 (9) & 4.2 (7) \\ \hline \(J/\psi\) & 0.954 (3) & 0.883 (4) & 2.5 (3) & 0.3 (1) & 0.11 (5) & 0 (0) \\ \hline \hline \multicolumn{10}{|c|}{Muid+MuGirl} \\ \hline \(t\bar{t}\) direct & 0.955 (1) & 0.903 (1) & \multirow{2}{*}{113.1 (6)} & \multirow{2}{*}{24.9 (3)} & \multirow{2}{*}{7.6 (2)} & \multirow{2}{*}{1.17 (6)} \\ \(t\bar{t}\) indirect & 0.946 (1) & 0.790 (2) & & & & \\ \hline hi-\(\mathcal{L}\)\(t\bar{t}\) direct & 0.952 (2) & 0.898 (2) & 181 (2) & 29.8 (7) & 8.4 (4) & 1.2 (2) \\ \hline \(Z^{\prime}\) direct & 0.929 (2) & 0.866 (3) & 61 (3) & 28 (2) & 16 (1) & 7.5 (9) \\ \hline \(J/\psi\) & 0.946 (3) & 0.885 (4) & 4.7 (4) & 0.11 (5) & 0 (0) & 0 (0) \\ \hline \end{tabular}
\end{table}
Table 5: Staco+MuTag and Muid+MuGirl efficiencies and fake rates. The samples and algorithms are described in the text. Efficiencies are presented both for all found muons and for those with a good truth match. Both are calculated for truth muons with \(|\eta|<2.5\) and \(p_{T}>10\) GeV/c. The fake rates are presented for a variety of \(p_{T}\) thresholds.

Figure 15: Low-\(p_{T}\) muon finding efficiencies for combined muons alone and combined plus tagged for the Staco (left) and Muid (right) collections. Results are show for the \(t\bar{t}\) indirect selection. The other samples show similar behavior but have much poorer statistics at low-\(p_{T}\). The efficiency is calculated for muons with \(|\eta|<2.5\).

\(t\bar{t}\) efficiency increases by 6% and the \(J/\psi\) by 15%. The fake rates are increased by a factor of five, i.e. slightly above the MuGirl rates. Overall, the Muid\(+\)MuGirl performance is very similar to that of Staco\(+\)MuTag. In both cases, we see the tagging algorithms do provide the significant efficiency improvement for \(p_{T}\) below 10 GeV/c.

## 10 Summary

### Present status

The starting point for most ATLAS analyses are the combined muons, i.e. those muons constructed by combining tracks found independently in the inner detector and muon spectrometer. Their momentum resolution and fake rate (with appropriate quality cuts) are both significantly better than muons reconstructed from either the spectrometer alone or muons identified by tagging inner detector tracks. In \(t\bar{t}\) events, for muons from \(W\rightarrow\mu\nu\) with \(|\eta|<2.5\), the Staco combined muon efficiency is 94% with most of the loss coming from regions of the spectrometer where the detector coverage is thin. The efficiency falls by a few percent when the muon transverse momentum reaches the TeV scale where it is much more likely that a muon will radiate a substantial fraction of its energy. The \(t\bar{t}\) rate for fakes is a few per thousand events for \(p_{T}>20\) GeV/c and this can be reduced by an order a of magnitude (with a 2% loss in efficiency) by cutting on the muon quality (\(\chi^{2}_{match}\)). The performance of the Muid algorithm is only slightly worse for \(t\bar{t}\) but it is significantly less robust, losing additional efficiency at low-\(p_{T}\) and high-\(p_{T}\) and when luminosity background is added.

The combined muons can be supplemented with the standalone muons to extend the \(\eta\) coverage to 2.7 and to recover the percent or so efficiency loss in combination. We do not report on this merge but it is clear from the standalone results that the fake rates will increase significantly especially when luminosity background is present. In the case of Moore, the fake rate is likely intolerable.

We find that merging with MuTag provides only slight improvement to the Staco efficiency with a significant increase in fakes. This may reflect the success of Staco more than deficiencies in MuTag. MuGirl is able to improve the Muid efficiency, so that the merge Muid\(+\)MuGirl has performance similar to Staco or Staco\(+\)MuTag. By itself, the MuGirl efficiency is somewhat less than that of Staco especially for high-\(p_{T}\) muons, and the fake rates are substantially higher.

### Future

The results presented here reflect the status of the ATLAS software used to reconstruct (Monte Carlo) production data in 2007. Work continues both to improve the algorithms described here and to add new ones. The high-luminosity fake rate for Moore is being addressed by introducing timing cuts and investigating alternative approaches to the pattern recognition. The latter also has the goal of reducing the number of false hit assignments. Combined muons with large \(\chi^{2}_{match}\) are being studied to see if a second stage of pattern recognition can reduce the efficiency loss or resolution tails. Efforts are underway to improve or replace the existing spectrometer-tagging algorithms; in particular, code is already in place to extrapolate to additional stations enabling recovery of much of the standalone/combined efficiency loss near \(|\eta|=1.2\). Two calorimeter-tagging algorithms have been developed and offer the possibility of recovering much of the efficiency loss near \(\eta=0\). Improvements in modularity will make it possible to mix components from the different algorithms, (e.g. to use Muid to combine Muonboy muons) and enable algorithms to share common tools such as those being developed to calculate energy loss, refit muon tracks, and repair muons with poor fit quality.

## References

* [1] ATLAS Collaboration, G. Aad et al., The ATLAS experiment at the CERN Large Hadron Collider, 2008 JINST 3 S08003 (2008).
* [2] ATLAS Collaboration, Muons in the Calorimeters: Energy Loss Corrections and Muon Tagging, this volume.
* [3] S. Hassini, et al., NIM **A572** (2007) 77-79.
* [4] Th. Lagouri, et al., IEEE Trans. Nucl. Sci. **51** (2004) 3030-3033.
* [5] D. Adams, et al., ATL-SOFT-2003-007 (2003).
* [6] K. Nikolopoulos, D. Fassouliotis, C. Kourkoumelis, and A. Poppleton, IEEE Trans. Nucl. Sci. **54** (2007) 1792-1796.
* [7] T. Cornelissen, et al., ATL-SOFT-PUB-2007-007 (2007).
* [8] S. Tarem, Z. Tarem, N. Panikashvili, O. Belkind, Nuclear Science Symposium Conference Record, 2007 IEEE **1** (2007) 617-621.
* [9] T. Sjostrand, S. Mrenna, and P. Skands, JHEP **05** (2006) 26.
* [10] S. Frixione and B.R. Webber, JHEP **0206** (2002) 029.
* [11] S. Frixione, P. Nason and B.R. Webber, JHEP **0308** (2003) 007.
* [12] J. Allison et al., IEEE Transactions on Nuclear Science **53** (2006) 270-278.
* [13] ATLAS Collaboration, Production Cross-Section Measurements and Study of the Properties of the Exclusive \(B^{+}\to J/\psi K^{+}\) Channel, this volume.
* [14] G. Corcella et al., hep-ph/0210213.