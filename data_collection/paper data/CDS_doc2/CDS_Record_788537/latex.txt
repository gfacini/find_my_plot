# The Electrical/Optical Transition Boards For 2004 Test Beam ATLAS Calorimeter Readout

Tiankuan Liu

Physics Department, Southern Methodist University

Dallas, TX 75275, United State

Benjamin E. Wakeland

Physics Department, Southern Methodist University

Dallas, TX 75275, United State

Jingbo Ye

Physics Department, Southern Methodist University

Dallas, TX 75275, United State

###### Abstract

The Electrical/Optical Transition Boards were designed and built for the ATLAS Liquid Argon (LAr) Calorimeter readout system in the Test Beam facility. These boards translate the electrical signals from the Module-0 Front-End Boards to the optical signals needed by the Readout Driver boards. They will be used to test and calibrate end-cap calorimeter components including electromagnetic, hadronic and forward calorimeter modules.

Keywords: electrical, optical, transition, calorimeter, readout. +
Footnote â€ : journal:

SMU-HEP-04-05

8/2/2004

## 1 Introduction

During the 2004 Test Beam run of the end-cap calorimeter system [1] the data are collected by the "old style" module-0 Front-End Boards (FEB) [2]. These data are then transmitted for further processing to the Read-Out Driver (ROD) boards [3]. The module-0 FEBs have electrical outputs, while the ROD boards use optical inputs. The Electrical/Optical (E/O) Transition Boards were designed to translate the signals from the module-0 FEBs to the ROD boards. Each FEB needs one transition board. Additionally, separate boards also were designed to simulate the data sent by the FEBs and to provide parity error detection of the ROD boards. These simulation boards are used during the installation and debugging. The documentation of the E/O Transition Boards is presented in this note. The documentation of the simulation boards is described in the appendix.

## 2 The architecture of the E/O Transition Boards

The architecture of the E/O Transition Boards is shown in Fig. 1. The central component of the E/O Transition Board is a field programmable gate array (FPGA) device, EP1C6Q240C8 of the Cyclone family from Altera [4]. The functional modules indicated by the shaded blocks in Fig. 1 are all implemented in the FPGA device. In the module "Latch 1", the 32-bit input data from a FEB are latched at the rising edge of the input clock running at 40.08 MHz (the LHC/ATLAS frequency). In the module "MUX" the input clock is used to multiplex the 32-bit data into two consecutive 16-bit data and an additional flag bit. The flag bit indicates whether the high 16 bits or low 16 bits are sent. The phase-locked loop (PLL) inside the G-linkserializer "G-link Tx" generates a clock at 80.16 MHz, the double frequency of the input clock. The G-link serializer, HDMP-1022 from Agilent, is the transmitter of the commonly called G-link transmitter/receiver chip set [5]. The multiplexed data and the flag bit are latched in the module "Latch 2" at the rising edge of the delayed 80.16 MHz clock. The delay time can be adjusted to meet the setup and hold time requirements of the G-link serializer and of "Latch 2". In the G-link serializer the parallel data are serialized into a serial data stream. The serial data stream is converted into optical signals in a custom optical transmitter "OTx" and sent out through an optical fiber to a ROD board. The optical transmitter is produced in the Academia Sinica of Taiwan [6].

The parity of each word is checked in the module "Parity Detector" and the checking results are displayed with several light emitting diodes (LED). The parity error detection function is useful during the installation and debugging. The block diagram of the module "Parity Detector" is shown in Fig. 2. In the module "Frame Border", the FEB data are scanned to find out the beginning of a frame and the end of the frame. The module "Frame Border" also counts the number of frames. The parity of each word inside any frame is checked in the module "Parity Detector". The number of the parity errors is counted in the module "Error Count".

Figure 1: The block diagram of the E/O Transition Boards

A photograph of an E/O Transition Board connected to a simulation board is shown in Fig. 3. In this photograph the E/O Transition Board is on the right and the simulation board is on the left.

## 3 Level translation in the E/O Transition Boards

The output signals of the module-0 FEBs are Positive Emitter Couple Logical (PECL) signals. The FPGA device used in the E/O Transition Boards does not support PECL signals. The PECL signals have to translate into the signals supported by the FPGA device. The FPGA device supports Low Voltage Differential Signaling (LVDS) signals. The translation from PECL to LVDS signals can be implemented by using a simple resistor and capacitor network. Therefore, LVDS is chosen to be the input

Figure 3: A photograph of an E/O Transition Board (right) and a simulation board (left)

Figure 2: The block diagram of the parity error detector

signals of the FPGA device. In the following we will discuss the translation from PCEL into LVDS signals.

The translation from PECL to LVDS signals can be achieved by either a DC coupling or by an AC coupling [7]. The AC coupling is simpler and uses less power than the DC coupling. The AC coupling also provides the "hot swapping" capability [8]. The AC coupling is perfect for the transmission of return-to-zero data or of non-return-to-zero but encoded data. For un-encoded non-return-to-zero data, such as the data from the FEBs, the AC coupling may cause transmission errors. The reason is explained in the following paragraph.

The AC coupling blocks the DC path of the data lines and requires bias voltages for the receiver inputs. When the levels on the transmitter side of the coupling capacitors transits from one logical level into the other logical level, the input levels on the receiver side follow respectively. After the transition, the input levels on the receiver sides decay exponentially back to the bias voltages. The recovery time for the input levels to go back to the bias levels depends on the time constant of the AC coupling circuit. If the data have another transition before the input levels to go back to the bias levels, the input levels change again and the data will be transmitted correctly. However, if the data contain the consecutive identical digits (logical ones or zeros) lasting longer than the recovery time, after the input levels return to their bias level the receiver output depends on the bias voltages and on the random noise instead of the inputs. Thus the transition errors may happen.

The consecutive logical ones in the FEBs data will not cause any transmission error because within the data structure of the FEB transmission no consecutive logical ones last longer than the recovery time. In fact, the recovery time in the E/O Transition Boards is 5 microseconds and corresponds to 25 words. In the FEB data there is an address word or a control word before and after consecutive 8 words of waveform sampling data. Bits 13 and 12 of the address word and of the control word are defined to be logical zeros [9]. Therefore, the consecutive logical ones last no longer than 9 words.

Since the consecutive logical ones will not cause any transmission error, the only possible problem is the long consecutive logical zeros. As mentioned above, after the recovery time of long consecutive logical zeros, the receiver output, depending on the bias voltages and on the random noise, may be logical ones and thus cause transmission errors. If the bias voltages are set negative to keep the receiver output at logical zeros after the recovery time, the AC coupling will not cause any problem. Since the bias voltage is normally set to be zero or near to zero [10], we call the concept described above the customized biasing.

The customized biasing is illustrated in Fig. 4. The negative input data line (red dashed curve) is biased higher than the positive input data line (black solid curve), so that the differential bias voltage is negative (-Vb in Fig. 4.) Here, Vb is the absolute value of the differential bias voltage. The positive and negative input voltages go back to their bias voltages on the left and the right sides of Fig. 4 after long consecutive logical zeros in frame gaps, but the negative differential bias voltage keeps the receiver output at logical zeros.

A compromise has to be made when choosing the bias voltages. On one hand, the bias voltage should be big (negative) enough for the noise not to affect the receiver output after the recovery time during long consecutive logical zeros transmission. On the other hand, the bias voltages should not be too big to affect the receiver output before the recovery time during the normal data transition.

In Fig. 4, in the beginning of a frame, the voltages on the positive and the negative data lines swing on the base of their bias voltages. The differential input voltage is 2Vs-Vb for logical ones, and Vb for logical zero, where Vs is the slew amplitude. The differential noise margin, \(\Delta\)V1 in Fig. 4, is equal to Vb in the beginning of the frame. If a frame lasts long enough, and if the data are balanced between logical zeros and logical ones, in the end of the frame the voltages on the positive and negative data lines will swing centered at their bias voltages. The differential input voltage is Vs-Vb for logical one, and Vs+Vb for logical zero. The differential noise margin, \(\Delta\)V2, is Vs-Vb in the end of the frame.

With the above considerations, the optimal choice is to set the differential noise margin in the beginning of the frame equal to the differential noise margin in the end of the frame. This choice leads to Vb = Vs/2. For PECL signals coming Vs is about 800mV, and thus the optimal differential bias voltage is about 400mV.

Figure 4: The waveforms of a differential input signal on the receiver side

The schematic of the bias circuit is shown in Fig. 5. C1 and C2 are coupling capacitors. R1, R2 and Rt are the resistor network to provide the bias voltages. The bias network should meet three conditions. First, the differential input resistor should be equal to the differential impedance of coaxial transmission cables, 100\(\Omega\). Second, the differential bias voltage should be 400mV as discussed above. Finally, the bias voltages should be in the input voltage range, which is normally from the ground to the power voltage. A simple choice of the third condition is to set the average bias voltage, (Vn+Vp)/2, as a half of the power voltage, 1.25V. This choice leads to R1 = R2. Combining these three conditions, we get R1 and R2 as 316\(\Omega\) and Rt as 120\(\Omega\).

## 4 The test of the E/O Transition Boards

The E/O Transition Boards were tested in the lab. During the test the data were generated by a simulation board, passed through an E/O Transition Board and an optical fiber, and received back at the simulation board to detect the parity error. In general, the simulation board can generate a single bit error or periodic bit errors so that the error detection can be verified. All E/O Transition Boards run error free in the lab condition for more than 12 hours, corresponding to a bit error rate of less than 2\(\times\)10\({}^{\text{-14}}\).

Next the E/O Transition Boards were tested in the Test Beam environment. Each FEB worked with an E/O Transition Board plugged in. The data parity was checked in a ROD board or in a simulation board. The received data were also transferred from the simulation board to a computer and the parity was checked. All E/O Transition Boards worked well in these tests and run error free for over 12 hours. This corresponds to a bit error rate less than 2\(\times\)10\({}^{\text{-14}}\).

Figure 5: The schematic of the bias circuit

## 5 Conclusion

The E/O Transition Boards were designed and built for the ATLAS Liquid Argon Calorimeter readout system in the Test Beam facility. These boards were tested in the lab and in the experimental environment. They are used for the calorimeter readout in 2004 Test Beam run.

**Acknowledges:**

The authors would like to thank Leonid Kurchaninov of Max-Planck-Institu fur Physik for his help in the test of the E/O Transition Boards.

**References:**

[1] The ATLAS collaboration, Liquid Argon Calorimeter Technology Design Report, CERN/LHCC/96-41, December 1996. Available:

[http://atlas.web.cern.ch/Atlas/GROUPS/LIQARGEXT/TDR/Welcome.html](http://atlas.web.cern.ch/Atlas/GROUPS/LIQARGEXT/TDR/Welcome.html).

[2] "Design of the ATLAS LAr front end board", ATLAS Internal Note ATL-AL-EN-0009. Available:

[http://www.nevis.columbia.edu/](http://www.nevis.columbia.edu/)\(\sim\)atlas/electronics/Module0FEB/febdocument.ps.

[3] The Larg ROD community, "The ATLAS ALRG ROD system", Never 2002. Available: [http://wwwlapp.in2p3.fr/](http://wwwlapp.in2p3.fr/)\(\sim\)poggioli/Working_version.doc.

[4] Altera Corporation, "Cyclone device handbook", October 2003. Available:

[http://www.altera.com/literature/hb/cyc/cyclone_device_handbook.pdf](http://www.altera.com/literature/hb/cyc/cyclone_device_handbook.pdf).

[5] Agilent Technologies, "HDMP-1022/1024 - Low Cost Gigabit Rate

Transmit/Receive Chip Set with TTL I/Os", 1997. Available:

[http://cp.literature.agilent.com/litweb/pdf/5989-0352EN.pdf](http://cp.literature.agilent.com/litweb/pdf/5989-0352EN.pdf).

[6][http://www-hep.phys.sinica.edu.tw/](http://www-hep.phys.sinica.edu.tw/)\(\sim\)atlas/lar.html.

[7] Paul Lee, "Interfacing between LVDS and ECL" (version 8), Semiconductor

Components Industries, LLC. Application Note AN1568/D, October 2003. Available

[http://www.onsemi.com/pub/Collateral/AN1568-D.PDF](http://www.onsemi.com/pub/Collateral/AN1568-D.PDF).

[8] Paul Shockman, "Termination of ECL Logic Devices with EF (Emitter Follower)

Output Structure", On Semiconductor Application Note AND8020/D (Rev. 5), July 2004. Available: [http://www.onsemi.com/pub/Collateral/AND8020-D.PDF](http://www.onsemi.com/pub/Collateral/AND8020-D.PDF).