**A fast parametrization of electromagnetic and hadronic calorimeter showers**

**and hadronic calorimeter showers**

_Kambiz Mahboubi_

University of Heidelberg, Germany

_Karl Jakobs_

University of Freiburg, Germany

_28th December 2005_

Fast parametrizations of electromagnetic and hadronic calorimeter showers have been extracted from a full GEANT simulation of single particles in the ATLAS calorimeters. The response and the resolution have been determined for photons and charged pions over the momentum range from 200 MeV/c up to 200 GeV/c and for the pseudorapidity range \(|\eta|<\)4.9. Within the parametrization model, the shower energy is deposited into a matrix of calorimeter cells with a granularity of \(\Delta\phi\times\Delta\eta=\) 0.1 \(\times\) 0.1 including event by event fluctuations and correlations among the different cells. In the longitudinal shower direction only the sharing between the electromagnetic and the hadronic calorimeters is simulated. The parametrization model and tests of its performance are presented.

Introduction

Since the simulation of the calorimeter response for LHC events using a full shower simulation is very CPU time consuming, fast simulations are needed with parametrized response functions for many detector components. Such an approach is realized in the ATLAS fast simulation programme ATLFAST [1].

In ATLFAST the treatment of the calorimeter response is, however, very much simplified. The nominal energy of the particle is deposited in the hit cell and neither lateral nor longitudinal energy sharing is performed. In order to overcome these deficiencies, fast parametrizations of showers in the ATLAS calorimeters have been developed. They have been extracted from a full detector simulation of single photons and charged pions using the GEANT simulation programme [2]. The calorimeter response and resolution have been determined for all particle types over the momentum range from 200 MeV/c to 200 GeV/c and over the full pseudorapidity range \(|\eta|<4.9\). Detailed shower models have been extracted at two different pseudorapidities, at \(\eta=0.2\) and \(\eta=2.0\). These models have been used throughout the full barrel and endcap calorimeters (\(|\eta|<\)3.2) respectively. It should be noted that within the present model no lateral energy sharing is performed in the forward calorimeters, however, the response and resolution as well as the longitudinal sharing between the electromagnetic and hadronic calorimeter sections is performed correctly. In the simulation the effects of the full Inner Detector material have been included. The degradation of the response and resolution is implicitly taken into account in the parameterization model.

The present study has originally been initiated with the aim to obtain a more realistic description for the simulation of the ATLAS Level-1 trigger performance [3]. The granularity of the lateral cell size has been chosen to be \(\Delta\phi\times\Delta\eta=0.1\times 0.1\) which matches the Level-1 trigger tower granularity. Since in the Level-1 trigger the longitudinal fine structure of the ATLAS calorimeters is not used, the longitudinal shower simulation is restricted to the separation between the electromagnetic and the hadronic blocks. It should be noted that the present model cannot be simply extended to a finer cell granularity nor to include a more detailed description of the longitudinal shower development. The treatment of the correlations between energy deposits inside the shower model prevents its scalability. To obtain a more detailed fast simulation, a different approach, _e.g.,_ a GFLASH like approach [4], should be followed.

However, we do think that the present parametrization offers a strongly improved fast simulation of the ATLAS calorimeter, which may be adequat for many physics signal and background simulations. The present approach delivers cell energies as in a full simulation and allows for the implementation of additional reconstruction and identification layers for physics objects. This leads to a more realistic description of isolation energies, jet energies and missing transverse energy. Due to the coarser cell granularity and longitudinal segmentation, these layers will be different from those used in the full simulation. The differences need to be studied and need to be taken into accout in physics analyses based on ATLFAST. A first version of the model has been implemented in the ATHENA version of the ATLAS fast simulation [5].

In Section 2 of the present note the simulated data sets used to extract the parametrization and the corresponding programme versions are described. The extracted response and resolution functions for photons and charged pions are presented in Section 3. Details of the shower parametrizations are discussed in Section 4, before first validation aspects are given in Section 5.

## 2 Data samples from full simulation

The full GEANT simulation of the ATLAS detector has originally been carried out within the Fortran based DICE/ATRECON framework using the GEANT3 simulation programme. Recently, this simulation has been updated using the ATHENA 10.0.1 programme version with the _initial Rome layout_.* All response and resolution parametrizations described in the following sections have been extracted from these newly simulated data sets.

Footnote *: We thank Michael DÃ¼hrssen and Michael Heldmann for carrying out this enourmous simulation task at the GRIDKA computer center in Karlsruhe.

Large samples of single photons and charged pions have been generated over the energy range from 200 MeV/c up to 200 GeV/c and over the pseudorapidity range \(|\eta|<4.9\). Details on the event samples are given in Table 1. The simulation does not include electronic noise or pileup noise and no threshold was applied on cell energy depositions.

The electron data samples have been generated for cross checks with the photon data samples at a few \(\eta\) points.

\begin{table}
\begin{tabular}{c||c|c|c|c} \hline Particle & Energy & \(\eta\) & Nr. of events & Extracted \\ type & (GeV) & & per data point & \\ \hline \hline \(\gamma\) & 0.2, 0.4, 0.6, 0.8, & \(0.0-4.9\) & 10.000 & \\  & 1.0, 2.0, 5.0, 10. & in steps of & resolution and \\  & 20., 50., 100., 200. & \(\Delta\eta=0.05\) & & response \\ \hline \(e\) & 0.2, 0.4, 0.6, 0.8, & 0.2, 0.5, 2.0 & 10.000 & \\  & 1.0, 2.0, 5.0, 10. & & & resolution and \\  & 20., 50., 100., 200. & & & response \\ \hline \(\pi^{+}\) & 0.2, 0.4, 0.6, 0.8, & \(0.0-4.9\) & 10.000 & \\  & 1.0, 2.0, 5.0, 7.5, 10. & in steps of & \\  & 15., 20., 50., 100., 200. & \(\Delta\eta=0.05\) & & response \\ \hline \hline \(\gamma\) & 10., 20., 50., 100. & 0.2 - 0.3 & 10.000 & Lateral energy \\  & 10., 20., 50., 100. & uniformly & & sharing \\  & & 1.9 - 2.0 & 10.000 & Lateral energy \\  & & & sharing \\ \hline \hline \(\pi^{+}\) & 10., 20., 50., 100. & 0.2 - 0.3 & 10.000 & Lateral energy \\  & & uniformly & & sharing \\  & 10., 20., 50., 100. & 1.9 - 2.0 & 10.000 & Lateral energy \\  & & uniformly & & sharing \\ \hline \hline \end{tabular}
\end{table}
Table 1: _Fully simulated Monte Carlo data samples using ATHENA 10.0.1 and the Rome initial layout_.

Energy response and resolution

### Electromagnetic particles

The energy of particles in the full GEANT simulation has been reconstructed by summing the total energy deposits in the calorimeters. For the electromagnetic energy an unweighted sum of the energies in the presampler and in the three electromagnetic layers has been calculated. As an example, the distributions of the reconstructed energies normalized to the nominal energies are shown in Fig. 1 for photons with energies of 0.5, 2 and 10 GeV. The energies reconstructed in the electromagnetic and in the hadronic calorimeter as well as the sums are shown separately. For photons with energies above 10 GeV Gaussian distributions for the electromagnetic energy distribution with a mean values close to the nominal energy are found. For photon energies below \(\sim\)3 GeV non-Gaussian tails towards the low energy side are clearly visible.

The response to photons is obtained from Gaussian fits to the total energy distributions at each energy and pseudorapidity point. For small energies, _i. e._\(E_{\gamma}<1\) GeV, the fits are performed around the peak positions of the reconstructed energy distributions. In Fig. 2 the response is shown as a function of the photon energy for two \(\eta\) values, at \(\eta=0.2\) and \(\eta=2.0\). The variation of the response as a function of pseudorapidity is shown in Fig. 3 for photon energies of 5 and 20 GeV. The observed response has been parametrized as a

Figure 1: _The distributions of the reconstructed energies in the electromagnetic and hadronic calorimeter as well as of the sum for photons with energies of 0.5, 2 and 10 GeV. All energies have been normalized to the nominal photon energy. Gaussian fits for the electromagnetic and for the total energy distributions are superimposed._

function of E and \(\eta\). For photon energies above 10 GeV the response is flat and close to unity, however, it decreases significantly for lower photon energies. It should also be noted that the electromagnetic response, as implemented in the ATHENA 10.0.1 programme, is found to be significantly lower in the forward calorimeter region.

In Figure 4 the energy resolution for photons, as obtained from the Gaussian fits to the energy distributions, is plotted as a function of the photon energy for photons at \(\eta=0.2\) and \(\eta=2.0\). The energy resolution has been parametrized in the usual form \(\frac{\sigma}{E}=\frac{\alpha}{\sqrt{E}}\oplus\ \beta\), where \(\alpha\) and \(\beta\) represent the sampling and constant terms of the energy resolution. It should be noted that no noise term is considered since neither electronic nor pileup noise have been simulated. The resolution values obtained are slightly larger than those obtained in the _ATLAS Detector and Physics Performance Technical Design Report_ (TDR) [6]. In the TDR analysis the energy resolution was improved by using weight factors for the various layers in the electromagnetic calorimeter. The energy resolution as a function of pseudorapidity \(\eta\) is shown for photon energies of 5 and 20 GeV in Fig. 5. As expected, the energy resolution deteriorates in the transition region between the barrel and endcap regions.

Figure 3: _ATLAS calorimeter response to photons with energies of 5 and 20 GeV as a function of pseudorapidity \(\eta\)._

Figure 2: _ATLAS calorimeter response to photons at \(\eta=\)0.2 and \(\eta=\) 2.0 as a function of the photon energy. The parametrized response is superimposed._

Figure 4: _ATLAS calorimeter resolution for photons at \(\eta\) = 0.2 and \(\eta\) = 2.0 as a function of energy. The parametrized resolution function is superimposed._

Figure 5: _ATLAS calorimeter resolution for photons with energies of 5 and 20 GeV as a function of pseudorapidity \(\eta\)._

### Hadrons

The response and resolution for hadrons is extracted from the simulated single charged pion samples. The distribution of the deposited pion energies in the electromagnetic+ and in the hadronic calorimeters, normalized to the incident energy, are shown in Fig. 6 for pions with energies of 2, 5, and 10 GeV. The energies are reconstructed using the electromagnetic energy scale.

Footnote â : As before, the electromagnetic energy is the sum of the energies seen in the presampler and in the electromagnetic layers.

For pion energies above 2 GeV, the raw response has been determined from Gaussian fits to the unweighted sums of the electromagnetic and hadronic energies. In the low energy region the mean and rms values of the histograms have been used. The energy dependence of the pion response is shown as a function of the pion energy in Fig. 7 for two pseudorapidity values, \(\eta=0.2\) and \(2.0\). In the high energy range the normalized response is found to reach a value of about 85%. A significant drop is seen in the low energy range. This is due to the strongly non-linear calorimeter response at low energies. In addition, low momentum pions do not reach the calorimeter surface. In the response curves shown a dip is clearly visible for pion energies around 10 GeV. This response drop, which is found for all \(\eta\) values, might be related to the change of the hadron simulation model inside GEANT at 10 GeV. Further studies are necessary to understand this problem. It should

Figure 6: _The distributions of the reconstructed energies in the electromagnetic and hadronic calorimeter as well as of the sum (electromagnetic + hadronic) for charged pions with energies of 2, 5 and 10 GeV. All energies have been normalized to the nominal pion energy. Gaussian fits for the distributions of the total unweighted energy are superimposed._be noted that for pion energies below 2 GeV the mean and rms values of the histpograms rather than the Gaussian fit parameters have been plotted in the response and resolution curves. The variation of the pion response as a function of pseudorapidity is shown in Fig. 8 for pions with energies of 5 and 20 GeV.

The corresponding resolution functions are shown in Figs. 9 and 10 as a function of energy and pseudorapidity respectively.

Figure 8: _ATLAS calorimeter response to charged pions with energies of 5 and 20 GeV as a function of pseudorapidity \(\eta\)._

Figure 7: _ATLAS calorimeter response to charged pions at \(\eta\) =0.2 and \(\eta\) = 2.0 as a function of the pion energy. The parametrized response is superimposed. The drop in the response around 10 GeV might be related to the change of the hadron simulation model inside GEANT (see text)._

Figure 10: _Energy resolution for pions with energies of 5 and 20 GeV as a function of pseudorapidity._

Figure 9: _Energy resolution for pions at \(\eta\) =0.2 and \(\eta\) = 2.0 as a function of the pion energy. The parametrized resolution function is superimposed._

Implementation of the shower parametrization

The goal of the present shower parametrization model is to obtain a fast and realistic description of the energy deposition in the ATLAS calorimeters. The response and resolution, the sharing of energy between the electromagnetic and the hadronic calorimeters as well as the sharing between cells in the transverse shower direction has been implemented as obtained from the full simulation data. Before the details of the shower model are described, the main points are summarized in the following:

* The response and resolution is implemented for photons and charged pions as determined from the full simulation;
* The energy sharing between the electromagnetic and hadronic calorimeters is implemented according to the full simulation results keeping all correlations and fluctuations;
* The longitudinal fine structure of the electromagnetic calorimeter is not simulated, the energy is deposited as total electromagnetic sum including the preshower energy;
* In the lateral direction the showers are simulated with a granularity of \(\Delta\phi\times\Delta\eta=0.1\times 0.1\). The electromagnetic energy is deposited in a grid of 3 \(\times\) 2 cells around the cell where the particle enters (hit cell). The hadronic energy is deposited in a grid of 5 \(\times\) 4 cells centered around the hit cell.

It should be noted that due to the construction of the model is not easily scalable to a finer longitudinal nor to a finer lateral granularity. If this is required, an alternative approach, as realized for example in the GFLASH model [4], should be used. In the following subsections the details of the implementation of the model are presented. Most weight is given to the implementation of the lateral energy sharing for electromagnetic and hadronic showers.

### The response and resolution

As described in Section 2 high statistics samples of single photons, electrons and charged pions have been generated for a large number of points with different energies and at different pseudorapidities. The most efficient way for a proper and fast implementation of the response and resolution functions is to use the information stored in two-dimensional histograms of the normalized energy depositions for the various particles in the electromagnetic and hadronic calorimeter. For a few representative pion energies (0.5, 1, 5 and 20 GeV) the energies deposited in the two calorimeter compartments normalized to the nominal pion energy are shown in Fig. 11. The corresponding energy fractions are denoted as \(f_{em}:=E_{em}/E_{0}\) and \(f_{had}:=E_{had}/E_{0}\), where \(E_{0}\) is the nominal energy and \(E_{em}\) and \(E_{had}\) are the energies deposited in the electromagnetic and hadronic calorimeters respectively. These plots demonstrate that low energy pions (in the sub GeV range) deposit their energy predominantly in the electromagnetic calorimeter. For high energy pions the energy is shared between the two calorimeters. The width of the band in the two-dimensional distribution is a measure of the calorimeter resolution. It should also be noted that there is a significant fraction of high energy charged pions for which only a small energy fraction is deposited in the electromagnetic calorimeter. For these pions the hadronic shower starts late and they traverse the electromagnetic calorimeter as minimum ionizing particles. This effect is also visible in the energy distributions shown in Fig. 6.

Using these two-dimensional histograms, it is guaranteed that the response, the resolution and the correct sharing between the electromagnetic and the hadronic compartments is preserved. The histograms have been stored for each simulated data point. They are read in at simulation level and, for a given particle, the fractions \(f_{em}\) and \(f_{had}\) are chosen according to the distribution which is closest in energy and pseudorapidity. The energies deposited are then corrected for the response difference between the reference energy and the actual energy according to the response model parametrisation determined in Section 3. Also the resolution is scaled accordingly.

In this way the response and resolution is implemented for photons and charged pions over the full energy range (\(0.2<E<200\) GeV) and over the pseudorapidity range \(|\eta|<4.9\). For particle energies larger than \(200\) GeV, the sharing of the energies is determined from the \(200\) GeV histograms, the response and resolutions are extrapolated according to the fits discussed in Section 3.

Figure 11: _Correlations between the energy deposits in the electromagnetic and hadronic calorimeter normalized to the nominal energy for pions with energies of 0.5, 1, 5 and 20 GeV._

### Shower profiles

In this subsection the implementation of the lateral shower sharing is described in detail. The shower profiles have been determined from data samples generated at two pseudo-rapidities, at \(\eta=0.2\) and \(\eta=2.0\) as a function of the impact point of the particles in the calorimeter cells. For that purpose high statistics scans across \(\eta\) and \(\phi\) have been made (see Table 1). The two \(\eta\) values are used as representative for the barrel and endcap regions. It should be mentioned that the model can be improved by extracting shower profiles at more \(\eta\) values, if needed.

Apart from the particle energy and type, the impact point in the calorimeter cell is the most relevant parameter for the lateral energy sharing. The impact point on the front face of the electromagnetic calorimeter is calculated for each particle and the \(\eta\) and \(\phi\) coordinates \((\phi_{IP},\eta_{IP})\) are calculated. The cell containing the impact point is referred to as the hit cell with the center coordinate \((\phi_{c},\eta_{c})\). For each particle the quadrant within the cell coordinate system and the distances

\[(\Delta\phi,\Delta\eta)=(\phi_{IP}-\phi_{c},\eta_{IP}-\eta_{c})\]

are calculated. An illustration of the parameters used is given in Fig. 12. It should be noted that the deflection of charged particles in the magnetic field is taken into account for the calculation of the impact point.

#### 4.2.1 Electromagnetic showers

For electromagnetic showers the total energy is deposited in a matrix of \(3\times 2\) cells! about the hit cell. This tower size is found to be large enough to nearly fully contain electromagnetic showers. The selection of the six cells within a \(3\times 3\) cell matrix around the hit cell depends on the hit quadrant and is illustrated in Fig. 13. This figure also contains the numbering scheme for the cells in the \(3\times 3\) matrix.

#### Longitudinal shape

For electromagnetic particles only a small fraction of the shower energy is found in the hadronic calorimeter. The energy sharing between the hadronic and the electromagnetic calorimeter is determined directly from the two-dimensional histograms (\(f_{em}\) vs. \(f_{had}\)). For electromagnetic showers, the total hadronic energy is deposited in a single cell behind the hit cell.

In Fig. 14 the fractions \(f_{had}\) are shown again for various photon energies. In addition, cumulative distributions -showing the fraction of events which have leakage energies smaller that a given value- are shown.

### Lateral development

As explained above, a \(3\times 2\) submatrix is selected according to the impact point within the hit calorimeter cell. The total electromagnetic energy - as given by \(f_{em}\) which is determined together with \(f_{had}\) from the two-dimensional stored histograms- is deposited in this matrix. The sharing among the six cells, is determined according to the following procedure:

1. In a first step the energy deposited in the central \(\eta\) slice that contains the hit cell, _i. e._, the energy in the three cells numbered as 3, 0 and 7 in Fig. 13, is determined as a function of the absolute value of the distance \(\Delta\eta\). The distribution of the fraction of the electromagnetic energy deposited in this slice, denoted as \[f_{307}\ =\ \frac{E_{3}+E_{0}+E_{7}}{E_{ECAL}}\ =\ \frac{E_{307}}{E_{ECAL}}\ =\ f(|\Delta\eta|)\] is shown as a function of \(\Delta\eta\) in Fig. 15. Since the distribution is symmetric with respect to \(\Delta\eta\) only the absolute value \(|\Delta\eta|\) is relevant. The distributions of \(f_{307}\) have been fitted for many slices in \(|\Delta\eta|\) by Gaussian distributions. A few examples are shown in Fig. 16. The mean values, the standard

Figure 13: _Cell and hit quadrant numbering schemes within the \(3\times 3\) cell matrix around the hit cell._

deviations and the fraction of events in the left hand side tail of the Gaussian distributions are determined as a function of \(|\Delta\eta|\). In the next step the \(|\Delta\eta|\) dependence of the mean value, standard deviation and tail fraction is fitted with parametric functions. An example of these fits for photons at \(\eta=0.2\) with an energy of 20 GeV is shown in Fig. 17. Such fits are performed for various energies. Finally, the energy dependence of the parameters of the fit functions is parametrized. All parametrizations have been carried out separately for showers in the barrel and in the endcap calorimeters.
* The fraction of the energy deposited in the hit cell with respect to the energy in the central \(\eta\) slice is expected to depend on the distance \(\Delta\phi\) of the impact point to the neighbouring cell. The distribution of \(f_{0}/f_{307}\) is shown as a function of \(|\Delta\phi|\) in Fig. 18. Since the distribution is symmetric around \(\Delta\phi=0\), \(|\Delta\phi|\) can be used as the relevant parameter. The distributions of \(f_{0}/f_{307}\) versus \(|\Delta\phi|\) are parametrized in a similar manner as described for the \(f_{307}\) case above. As before, two different sets of parameters, for the barrel and for the endcap regions, are determined. After these steps, the fraction of the energy to be deposited in the hit cell is fully parametrized.
* The next step consists of determining the energy to be deposited within the central \(\eta\)

Figure 14: _(Top): Normalized distributions of the fractional energy deposition of photons with energies of 10, 20, 50 and 100 GeV in the hadron calorimeter. (Bottom): The corresponding cumulative distributions -showing the fraction of events which have leakage energies smaller that a given value- for the four photon energies._

slice in the nearest \(\phi\) neighbour (cell 3 or 7). The correlation between the fractional energy deposit in this cell and the central cell is shown in Fig. 19, both normalized to \(f_{307}\). This fraction is parametrized by slicing the distribution on the \(\frac{f_{0}}{f_{307}}\) axis and approximating the peaks in each slice by half Gaussians with a mean at \(\mu(\frac{f_{3}\,or\,f_{7}}{f_{307}})=1-\frac{f_{0}}{f_{307}}\) and a standard deviation parametrized as a function of \(\frac{f_{0}}{f_{307}}\). The other \(\phi\) neighbour of the hit cell gets the remaining fraction, \(i.e.,\ \frac{f_{7}\,or\,f_{3}}{f_{307}}=1-\frac{f_{0}}{f_{307}}-\frac{f_{3}\,or\,f_{7}} {f_{307}}\).
4. The remaining energy is distributed into the three cells of the adjacent \(\eta\) slice (either (2,1,8) or (4,5,6)). First the correlation between the energies in the nearest phi neighbour in the central eta slice and the corresponding \(\phi\) cell in the adjacent \(\eta\) slice is considered. In Fig. 20 this correlation is shown, after normalizing the corresponding cell energies to the energies in the respective \(\eta\) slices. (For example, if the cells (2,1,8) represent the adjacent \(\eta\) slice and cell 3 is the nearest \(\phi\) neighbour, the correlation between \(f_{2}/f_{218}\) and \(f_{3}/f_{307}\) is shown.) In order to parametrize these correlations, the same procedure as discussed above is applied. For bins along the x-axis the distribution of the y-values are fitted by Gaussian distributions, the mean and standard deviations of the Gauss distributions are parametrized as a function of the x-values \(\left(\frac{f_{3}\,or\,f_{7}}{f_{307}}\right)\) and as a function of energy. As an example, the results obtained for photons with an energy of 20 GeV at \(\eta=0.2\) are shown in the lower part of Fig. 20. At this point the energy contents of four out of the six cells of the \(3\times 2\) matrix are parametrized.
5. The remaining energy is finally distributed into the remaining two cells in the same ratio as previously determined for the corresponding cells in the central slice (307).

Figure 15: _Distribution of the energy fraction in the central \(\eta\) slice (\(f_{307}\), see text) for 20 GeV photons at \(\eta\) = 0.2 as a function of \(\Delta\eta\)._

Figure 16: _Examples of Gaussian fits to the \(f_{307}\) distributions for various \(|\Delta\eta|\) slices for 20 GeV photons at \(\eta=\) 0.2._

Figure 17: _The mean values, standard deviations and tail fractions as determined from Gaussian fits to the \(f_{307}\) distributions as a function of \(|\Delta\eta|\) for photons with an energy at 20 GeV at \(\eta=\) 0.2._

Figure 19: _The correlation between the energy fractions deposited in the nearest \(\phi\) neighbour of the hit cell and the hit cell for 20 GeV photons at \(\eta\) = 0.2. Both fractions are normalized to the \(f_{307}\) fraction._

Figure 18: _Distribution of the energy fraction deposited in the hit cell, normalized to the fraction deposited in the central \(\eta\) slice, \(f_{0}/f_{307}\), as a function of \(|\Delta\,\phi|\)._

Figure 20: _(Top): Correlation between the energy deposits in the nearest \(\phi\) neighbour of the hit cell and the corresponding \(\phi\) cell in the adjacent \(\eta\) slice (see text) for 20 GeV photons at \(\eta\) = 0.2. Both fractions are normalized to the total fractions in the corresponding \(\eta\) slices. For the cell numbering convention see Fig. 13. (Bottom): The fitted Gauss parameters (mean and standard deviation) as a function of the x-values \((f_{3}/f_{307}\) or \(f_{7}/f_{307}\)). In the lower right hand plot the distribution of the y-values (\(f_{4}/f_{456},f_{6}/f_{456},f_{2}/f_{218}\) or \(f_{8}/f_{218}\)) is shown for the first x-bin (\(f_{3}/f_{307}\) or \(f_{7}/f_{307}<0.05\))._

#### 4.2.2 Hadronic showers

Hadronic showers have been parametrized in a similar way as the electromagnetic showers, except that the energy is deposited in a \(5\times 4\) rather than a \(3\times 2\) cell matrix. The core energy of the hadronic shower itself is deposited in a similar way as described above in the central \(3\times 2\) cell matrix in both calorimeters. The halo of the hadronic shower is deposited in the ring of the 14 cells surrounding the \(3\times 2\) core.

The cell numbering system is illustrated in Fig. 21. Core cells are numbered as in the electromagnetic case discussed above. Trigger cells in the halo are numbered depending on their position relative to the hit quadrant.SS

Footnote Â§: For instance trigger cell 8 is always closest to the hit quadrant.

#### Longitudinal profile

The energy sharing between the electromagnetic and the hadronic calorimeter is determined directly from the two-dimensional histograms (\(f_{em}\) vs. \(f_{had}\)). This procedure has bed adopted to preserve in an easy and efficient way the energy response, resolution and correlations between the electromagnetic and hadronic shower parts.

Figure 21: _Numbering scheme for the \(5\times 4\) cells around the hit cell used for the energy deposition of hadronic showers._

### Lateral development

As mentioned above, the basic cluster size of a hadronic shower has been taken to be a \(5\times 4\) trigger cell matrix in both the electromagnetic and the hadronic calorimeter.

For the lateral shower development two cases are distinguished, depending on the starting point of hadronic cascade. For so called _late showers_ (see Fig. 22) for which the hadronic cascade starts in the hadronic calorimeter the total energy deposited in the electromagnetic calorimeter (mip signal) is put into the hit cell. In the hadronic calorimeter the energy is deposited in a \(5\times 4\) cell matrix. For _early showers_ the energies in both the electromagnetic and the hadronic calorimeter are deposited in a \(5\times 4\) matrix.

The energy deposited in the electromagnetic calorimeter is used to classify a shower as early or late. If the energy deposited in the electromagnetic calorimeter is below 700 MeV, a shower is classified as early shower. It should be noted that this approach does not take into account differences in shower forms for late showers depending on the location of the interaction depth in the electromagnetic calorimeter.

For late showers, different shower parametrizations have been performed, in the electromagnetic and in the hadronic calorimeters. The same method, which is decribed in the following for the hadronic part of the shower, has been adopted in both cases.

* In a first step the energy to be deposited in the central core of \(3\times 2\) cells of the \(5\times 4\) matrix is determined, _i.e._, the energy to be deposited is separated into a _core_ and a _halo_ fraction. The core fractions have been parametrized as a function of energy and particle type for two different pseudorapidity values, for \(\eta=0.2\) and \(\eta=2.0\). Again, they are taken to be representative for the shower profiles in the barrel and endcap calorimeters. As an illustration, the energy fractions in the core are shown in Fig. 23 for pions with energies of 10, 20, 50 and 100 GeV at \(\eta=0.2\) and 2.0 undergoing early showering. It should be noted that due to the large size of the

Figure 22: _Illustration of the different types of hadronic showers_.

hadronic showers no lateral impact point dependence \((\Delta\phi,\Delta\eta)\) of this fraction has been taken into acount.
* In a second step the energy in the central core of \(3\times 2\) cells is distributed among the cells. For this procedure the same parametrization method as used for the electromagnetic showers has been adopted. Separate sets of parametrizations at \(\eta=0.2\) and \(2.0\) have been extracted taking into account the impact point as well as the energy dependence.
* Finally, the halo energy is distributed in the 14 cells surrounding the central core. The fractions and the fluctuations in each of the 14 halo cells -normalized to the total halo energy- are shown in Fig. 24 for charged pions with an energy of 50 GeV in the hadronic calorimeter at \(\eta=0.2\). In many cases no or only small energies are deposited in these cells. In order to parametrize the energy sharing, the fraction of empty events, defined as energy less than 1% of the halo energy, is determined for each cell. If non-zero energy depositions are found, the mean value and its variation (r.m.s. value) has been determined for each cell. The average energy fractions are shown in the lower part of Fig. 24. In the simulation the energy is distributed in the halo according to this pattern. Based on a random number it is determined whether energy is deposited in a particular cell or not. If yes, the energy to be deposited is determined from a Gaussian distribution with mean and standard deviation as determined from the simulation. This procedure loops over the halo cells in a predefined order (the cells which have the highest average energies are treated first, _i.e._, cell 8, 7, 9,...) and stops if the total halo energy is deposited. It is clear that this procedure does not take into account correlations among the various halo cells. However, we think that this shortcoming is not critical. For hadronic jets many particles contribute to the total energy deposition and the fluctuations in the halo cells are smeared out. For tau or electron/photon identification issues the total isolation energy is more important than correlations among cell energies in the isolation ring.

Figure 23: _(Top): Distributions of the energy fraction (of the total energy in the electromagnetic calorimeter) deposited in the central core of \(3\times 2\) cells for pions with energies of 10, 20, 50 and 100 GeV at \(\eta\) = 0.2 undergoing early showering. The parametrizations are superimposed. (Bottom): The corresponding distributions for the core fractions for pions of the same energies at \(\eta\) = 2.0._

Figure 24: _The fractions of the halo energy deposited in the 14 halo cells for pions with an energy of 50 GeV. In the upper part the distributions are shown, the mean values, calculated for events with positive energy depositions, are shown in the lower part._

Validation of the implementation

### Response and resolution

The shower parametrization described in the previous Sections has been implemented in a version of the ATLAS fast simulation program ATLFAST within the ATHENA framework [5]. This programme version has been used to perform first basic validation steps.

As a consistency check, it has been validated that the global response and resolution curves, as presented in Section 3, are reproduced. As an example, the ratio of the reconstructed energies to the nominal energies is shown in Fig. 25 for photons at \(\eta=0.3\) and at \(\eta=2.2\) as a function of energy. Superimposed are the nominal response curves as extracted from the full GEANT simulation.

A similar plot is shown in Fig. 26 for pions at \(\eta=0.3\) and \(\eta=2.2\). The deposited energies and their variations (resolutions) agree with the extracted calorimeter response and resolution function.

### Shower shapes

Since the electromagnetic and hadronic energy fractions are taken from the generated two-dimensional distributions, the longitudinal energy sharing between the two calorimeter parts is correct by construction. All correlations are preserved.

The quality of the lateral shower shape can be estimated from energy flow distributions. In Fig. 27 the energy flow around the nominal photon direction, as a function of \(\Delta R=\sqrt{\Delta\phi^{2}+\Delta\eta^{2}}\), is shown for 10 and 50 GeV photons at \(\eta=0.2\) and 2.0. The distributions are shown for three cases: (i) the full GEANT simulation, based on the nominal fine ATLAS calorimeter granularity, (ii) the full GEANT simulation assuming a cell granularity of 0.1 \(\times\) 0.1 and (iii) the fast shower simulation based on a cell granularity of 0.1 \(\times\) 0.1. The effect of the coarser granularity is clearly visible. The offset seen between the maxima in the energy depositions are primarily due to the different cell granularities. For the same granularity, the energy flow obtained in the fast shower model agrees well with the results obtained in the full GEANT simulation. The resulting differences for the identification of electromagnetic objects have been studied in more detail and are reported in Ref. [7].

The corresponding energy flow profiles are shown for pions of 10 and 50 GeV at \(\eta=0.2\) and 2.0 in Fig. 28. Since the pion showers are braoder than the electromagnetic showers, the differences between the full simulation with the fine and coarse granularity are much less pronounced. For single pions, good agreement for the lateral energy flow is found between the fast shower model and the full simulation.

The shower profiles for photons and pions with energies of 10 and 50 GeV at \(\eta=0.2\) and 2.0 are shown in Figs. 29 and 30. The cell orientation has been chosen such that the impact point lies in the upper right quadrant. As can be seen from these plots, it is reasonable to deposit the energy in the fast simulation in the 3 \(\times\) 2 and 5 \(\times\) 4 calorimeter cells matrices for electromagnetic and hadronic particles respectively. The agreement between the shower profiles at cell level between the fast and the full GEANT simulation looks acceptable.

### Performance for Electrons and Jets

As already discussed in the introduction, the main goal of the present shower parametrization was to achieve a fast and more realistic description of calorimeter showers in ATLASFAST. The energy depositions should agree with those obtained in a full simulation.

This implies that additional calibration and reconstruction layers need to be added to the new ATLFAST model. The description of these layers as well as a comparison of the performance for the electron, photon, tau, jet and missing transverse energy reconstruction is beyond the scope of the present note and is presented in a separate note [7].

Figure 25: _The ratio of the reconstructed energies normalized to the nominal energies for photons at \(\eta\) = 0.3 (top) and \(\eta\) = 2.2 (bottom) in ATLFAST as a function of the nominal photon energy. Superimposed is the response curve as extracted from the full GEANT simulation (see Section 3)._Figure 26: _The ratio of the reconstructed energies normalized to the nominal energies for pions at \(\eta\) = 0.3 (top) and \(\eta\) = 2.2 (bottom) in ATLFAST as a function of the nominal pion energy. Superimposed is the response curve as extracted from the full GEANT simulation (see Section 3)._

Figure 28: _Energy flow around the pion direction for 10 GeV pions at \(\eta\) = 0.2 and 2.0 (top) and for 50 GeV pions at \(\eta\) = 0.2 and 2.0 (bottom)._

Figure 27: _Energy flow around the photon direction for 10 GeV photons at \(\eta\) = 0.2 and 2.0 (top) and for 50 GeV photons at \(\eta\) = 0.2 and 2.0 (bottom)._

Figure 29: _Comparison between the shower profiles at cell level with a granularity of \(\Delta\,\phi\times\Delta\,\eta\) = 0.1 \(\times\) 0.1 between the full GEANT and the fast simulation for 10 GeV photons at \(\eta\) = 0.2 and 2.0 (top) and for 50 GeV photons at \(\eta\) = 0.2 and 2.0 (bottom)._

Figure 30: _Comparison between the shower profiles at cell level with a granularity of \(\Delta\,\phi\times\Delta\,\eta\) = 0.1 \(\times\) 0.1 between the full GEANT and the fast simulation for 10 GeV pions at \(\eta\) = 0.2 and 2.0 (top) and for 50 GeV pions at \(\eta\) = 0.2 and 2.0 (bottom)._

Conclusions

A parametrization of electromagnetic and hadronic showers for the ATLAS calorimeters has been presented. The response and resolution of photons and charged pions are correctly described over an energy range above 0.2 GeV and over the pseudorapidity range \(|\eta|<4.9\). Longitudinally, the energy sharing between the electromagnetic and the hadronic calorimeter is correctly simulated. In the lateral direction, electromagnetic (hadronic) showers are deposited over the pseudorapidity range \(|\eta|<3.2\) in a matrix of \(3\times 2\) (\(5\times 4\)) calorimeter cells with a granularity of \(\Delta\phi\times\Delta\eta=0.1\times 0.1\) preserving the correlations between the cells. The simulated energy distributions agree well with those obtained in a full GEANT simulation and allow for a fast simulation of large physics samples. Similar calibration, reconstruction and identification steps as in full simulation can be applied.

The main shortcoming of the present model is that the lateral energy sharing is performed for a cell size of \(\Delta\phi\times\Delta\eta=0.1\times 0.1\) and that the longitudinal fine structure of the electromagnetic calorimeter (presampler, strips, longitudinal sections) is not described. To overcome this within the present model is difficult and deemed to be impractical. However, the resulting differences in the reconstruction and identification performance between the fast and full simulation are expected to be small [7] and physics analyses can be corrected accordingly. The present model has been implemented in the ATLFAST version of the ATHENA framework [5].

### Acknowledgments

We would like to express our thanks to Michael Duhrssen and Michael Heldmann for repeating the enourmous simulation task at the computer center GRIDKA in Karlsruhe with the updated ATLAS full simulation version (_initial Rome layout_) and the GEANT4 model. We also acknowledge their feedback and debugging of the programme implementation and we thank them for providing several updated plots for this note.

## References

* [1] E. Richter-Was, D. Froidevaux and L. Poggioli, _ATLFAST, a fast simulation package for ATLAS_, ATLAS note, ATL-PHYS-98-131.
* [2] R. Brun and F. Carminati, CERN Program Library Long Writeup W5013 (1993); GEANT4 Collaboration, S. Agostinelli et al., Nucl. Instrum. Methods **A506** (2003) 250.
* [3] R. Dubitzky, K. Jakobs, E.Bagheri, K.Mahboubi, M.Wunsch, _Level-1 Rates for Triggers using the ETMISS Signature_, ATLAS note, ATL-DAQ-99-011 (1999).
* [4] G. Grindhammer and S. Peters, _The parametrized simulation of electromagnetic showers in homogeneous and sampling calorimeters_, Nucl. Nucl. Instrum. Meth\(\,\)ds **A290** (1990) 488, hep-ex/0001020.

* [5] K. Mahboubi, _Implementation of the Fast Shower Model in ATLFAST / ATHENA_, ATLAS note, in preparation.
* [6] ATLAS Collaboration, _Detector and Physics Performance Technical Design Report_, CERN/LHCC/99-14 (1999).
* [7] M. Duhrssen and M. Heldmann, _Object identification using the fast shower parametrization_, ATLAS note in preparation.