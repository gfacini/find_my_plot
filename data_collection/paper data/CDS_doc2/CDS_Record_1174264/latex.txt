**ATLAS NOTE**

ATL-PHYS-PUB-2009-000

April 26, 2009

**Calibrating \(b\)-tagging using ttbar Events**

The ATLAS Collaboration1)

Footnote 1: This note prepared by H. Bachacou, G. Gorfine, R. Harrington, R. Hawkings, and M. Sandhoff.

_This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020._

**Abstract**

This note describes various studies of \(b\)-jet reconstruction and \(b\)-tagging in simulated ATLAS \(t\bar{t}\) events. The performance of several jet algorithms on \(t\bar{t}\) event \(b\)-jets is studied. Techniques for measuring the \(b\)-tagging efficiency directly from data \(t\bar{t}\) events, using both tag counting and explicit \(b\)-jet selection, are described and compared. Finally, the optimisation of \(b\)-tagging for \(t\bar{t}\) events, using both Monte Carlo and data samples, is discussed. Both semileptonic and dilepton \(t\bar{t}\) decay channels are considered, for an initial integrated luminosity of \(100\,\mathrm{pb}^{-1}\).

Introduction

The identification of \(b\)-jets is of crucial importance to many physics analyses at the LHC, including top physics and the search for new particles including Higgs bosons. The performance of \(b\)-tagging algorithms will have to be understood using real data, as Monte Carlo will only give an approximate description of the tracking and vertexing performance of the detector, at least initially. Light jet rejection factors can be measured in inclusive jet samples (where the heavy flavour content is small), but pure samples of \(b\)-jets are required to measure the \(b\)-jet tagging efficiency. One solution, already widely used at the Tevatron, exploits dijet events in which one of the jets is \(b\)-tagged using a soft lepton tag [1].

At the LHC, the large \(t\bar{t}\) production cross-section offers an alternative source of \(b\)-jets, in a distinctive topology which is relatively easy to trigger on and isolate, providing at least one of the \(W\)-bosons from the top decays leptonically. Providing the top quark is assumed to have Standard Model properties (in particular that \(\mathrm{Br}(t\to Wb)=1\)), each \(t\bar{t}\) event has two \(b\)-jets, together with at least one high-\(E_{T}\) lepton, missing energy and additional high-\(E_{T}\) jets from hadronically decaying \(W\)-bosons. The environment (high jet multiplicity, high-\(E_{T}\) b-jets) is also much closer to that which \(b\)-tagging efficiency measurements are typically needed than in dijet events.

The \(b\)-tagging efficiency can be extracted from \(t\bar{t}\) events in two ways--either by counting events with different numbers of tagged jets, or by reconstructing the \(t\bar{t}\) decay topology in order to identify a pure sample of \(b\)-jets. Both techniques are explored in this note, which is organised as follows. Section 2 briefly describes the Monte Carlo simulation samples and common event selection which is used throughout, and Section 3 discusses reconstruction of \(b\)-jets in \(t\bar{t}\) events, as an essential preliminary to studies of \(b\)-jet tagging. The counting and \(b\)-jet selection methods are discussed in Sections 4 and 5. Finally, Section 6 discusses the possibilities for optimising \(b\)-tagging performance specifically for \(t\bar{t}\) events, using both Monte Carlo and data.

## 2 Datasets and event selection

All studies were performed using ATLAS Monte Carlo production samples as discussed in more detail in [2] and [3]. Semileptonic and dileptonic \(t\bar{t}\) decays were generated with MC@NLO with Herwig hadronisation. AcerMC with Pythia hadronisation was used as an alternative. The background in the semileptonic channel is dominated by \(W\)+multijet production, which was simulated with ALPGEN (including \(Wb\bar{b}\) and \(Wc\bar{c}\)), and single top production, simulated with AcerMC. In the dilepton channel (used only for the counting method \(b\)-tagging efficiency determination), additional backgrounds from \(Z\)+jets (simulated with ALPGEN) and diboson production (simulated with Herwig) are also important. Background coming from QCD multijet events has not been studied, as this background is difficult to simulate and samples were not available. The normalisation of such background (if significant) will eventually have to be extracted from data.

Systematic errors have been evaluated following the prescriptions discussed in detail in [2] and [4] wherever possible. The sensitivity to incorrect \(b\)-tagging of non-\(b\) jets was assessed by doubling and setting to zero the corresponding jet tagging efficiencies, separately for light quark and charm jets. The jet energy scale was varied by \(\pm 5\,\%\). The Monte Carlo event generation sensitivity was assessed by using AcerMC instead of MC@NLO, including samples with modified ISR, FSR and parton shower cutoff \(Q^{2}\). The backgrounds from \(W\)+multijet events and single top production were independently doubled and set to zero. In all cases, the effect of these variations was computed without adjusting parameters of the analysis (_e.g._ acceptance factors and background estimates) to compensate for changes made to the input Monte Carlo samples.

The analyses make use of isolated high \(E_{T}\) electrons and muons (with \(E_{T}>20\,\mathrm{GeV}\)) and jets (with \(E_{T}>20\,\mathrm{GeV}\) or higher depending on the particular analysis), selected according to standard ATLASobject definitions and fiducial cuts [2]. In the semileptonic channel, events are required to have exactly one high \(E_{T}\) lepton, at least four jets and missing transverse energy of at least 20 GeV. In the dilepton channel, two leptons of opposite charge and a missing transverse energy of at least 20 GeV are required; in the \(e^{+}e^{-}\) and \(\mu^{+}\mu^{-}\) channels, the \(Z\)+jets background was further reduced by vetoing events with dilepton mass between 81 and 101 GeV and by requiring a missing transverse energy of at least 35 GeV. In both cases, at least one lepton in the event was required to pass the ATLAS level-1, level-2 and event filter triggers, using trigger signatures appropriate for the 20 GeV offline lepton \(E_{T}\) cuts. For electrons, the signatures e25i and e60 were used (the e60 trigger improves the efficiency at high lepton \(E_{T}\)), and for muons, the signature mu20i was used. Further studies of the ATLAS trigger performance on \(t\bar{t}\) events can be found in [5].

The resulting estimated event yields at various stages of the event selection are shown in Table 1 for 100 pb\({}^{-1}\). Non-\(t\bar{t}\) backgrounds are not included. The individual analyses apply further specific selection cuts as discussed below. The effects of the tighter selections used only by the tag counting analysis described in Section 4 are also shown in Table 1. The hadronic \(W\) mass window cut was applied by selecting the pair of jets with invariant mass closest to the \(W\) mass and requiring this to be within \(\pm\)20 GeV of the nominal value; a top mass cut was applied similarly by adding the jet giving a reconstructed top mass closest to the nominal, and requiring it to be within \(\pm\)30 GeV of the top mass.

All studies were performed with the default ATLAS \(b\)-tagging algorithm (IP3D+SV1), which uses a likelihood weight \(w\) constructed from the results of the IP3D impact parameter and SV1 secondary vertex-based taggers [6]. This likelihood weight is large for \(b\)-jets and small for light and \(c\)-quark jets. For jets from top decay with \(E_{T}>20\) GeV, a cut \(w>4\) gives a \(b\)-jet tagging efficiency of around 70 % per jet and a light jet rejection of 50 while a \(w>7\) cut gives an efficiency of 60 % and a rejection of 200, though these values are somewhat dependent on jet \(E_{T}\) and \(\eta\). Detailed studies of the expected \(b\)-tagging performance can be found in [6] (_e.g._ in Table 1 therein). For the purposes of comparison, \(b\)-tagging efficiency measurements have been done at reference efficiencies of 50, 60 and 70 %. Various other cut values are used internally by the selections in the individual analysis methods. When considering Monte Carlo truth information, jets have been labelled \(b\), \(c\) and light using the standard ATLAS jet matching and labelling procedures [6].

\begin{table}
\begin{tabular}{l|c c||l|c}  & Electron channel & Muon channel & & Dilepton channel \\ \(t\bar{t}\) (except all hadronic) & 45232 & 45232 & & 45232 \\ \hline Trigger & 10430 & 12116 & & 21417 \\ Lepton ID & 8350 (80.1 \%) & 11268(93.0 \%) & & \\ Isolation & 8063 (96.6 \%) & 9909 (87.9 \%) & Lepton pair selection & 1549 (7.23 \%) \\ Missing \(E_{T}>20\) GeV & 6362 (78.9 \%) & 7834 (79.1 \%) & Missing \(E_{T}\) cut & 1355 (87.5 \%) \\ \(\geq 4\) jets \(E_{T}>20\) GeV & 3651 (57.4 \%) & 4555 (58.1 \%) & \(\geq 2\) jets \(E_{T}>20\) GeV & 1160 (85.6 \%) \\ \(\geq 4\) jets \(E_{T}>30\) GeV & 2329 (63.8 \%) & 2927 (64.3 \%) & \(\geq 2\) jets \(E_{T}>30\) GeV & 1000 (86.2 \%) \\ \hline W mass window cut & 1958 (84.1 \%) & 2487 (85.0 \%) & - & - \\ top mass window cut & 1378 (70.4 \%) & 1773 (71.3 \%) & - & - \\ \end{tabular}
\end{table}
Table 1: Numbers of events from \(t\bar{t}\) production expected with 100 pb\({}^{-1}\) in the lepton+jets and dilepton channels. The cut efficiency w.r.t. the previous line is shown in parenthesis. The fully hadronic decay \(t\bar{t}\) contribution is not included but is expected to be small. Contributions from non-\(t\bar{t}\) background are not included.

\(b\) jet reconstruction in \(t\bar{t}\) events

The choice of jet reconstruction algorithm is an important issue for top physics analysis in ATLAS, where good resolution for the reconstruction of the original quark energy and direction is mandatory. These questions are explored below, using various jet algorithms and parameter choices. The analysis uses a sample of 250k semileptonic \(t\bar{t}\) events generated with MC@NLO and passed through the standard top selection as discussed in Section 2. The choice of jet algorithm also affects the \(b\)-tagging performance, as studied in detail elsewhere [6].

The standard reconstruction outputs jet collections made with the Cone (with \(\Delta R=0.4\) and \(\Delta R=0.7\)) and \(k_{T}\) (with \(D=0.4\) and \(D=0.6\)) jet algorithms, each based on either Precluster Projective Towers ('Tower') or Topological Cell Clusters ('Topo') (see [7] for more information on jet reconstruction in ATLAS). For this study, these standard jet reconstruction algorithms and parameter choices have been complemented by additional Cone and \(k_{T}\) jets with a larger variety of \(\Delta R\) and \(D\) parameters. To compare all these jet algorithm and parameter choices in a controlled environment, re-reconstruction of jets was performed at the AOD level, using 'Topological Cell Clusters' calibrated by 'Local Hadron Calibration' (see [8] and [9] for details about the different strategies used to exploit and calibrate calorimeter information). All parameters except for the \(D\) parameter (\(k_{T}\)) or \(\Delta R\) (Cone) were left unchanged with respect to the standard jet algorithms.

It should be noted that these re-reconstructed jets do not contain the calorimeter energy corrections applied in the standard calibration procedure described in [7] and [8]. Therefore a comparison of the overall performance between the different jet algorithms with different parameters is valid, but no direct comparison between corrected and non-corrected jets should be made.

### Jet energy and angle resolution

Reconstructed jets are matched to quarks from the \(t\bar{t}\) decay following the standard procedure [6]. The results are shown in Fig. 1.

The top plots of Fig. 1 show the width of the distributions \((E_{quark}-E_{jet})/E_{quark}\) (_i.e._ the energy resolution) as a function of \(E_{quark}\), for both \(k_{T}\) and Cone. To calculate the width, a Gaussian is fitted to the individual distributions. The distributions show the expected behaviour. The smallest width is obtained for the jet sizes 0.4, 0.5 and 0.6, for both Cone and \(k_{T}\). However, the differences between the different jet algorithms are small, so no strong conclusions can be drawn from them.

The two lower plots of Fig. 1 show an investigation of the angular resolution. The mean distance between the initial quark and the resulting jet in \(\Delta R\) is plotted as function of \(E_{quark}\) for Cone and \(k_{T}\). The expected behaviour is that for bigger jet sizes the deviations between the jet axis and the flight direction of the initial quark should increase; this behaviour is observed in Fig. 1. It can also be seen that for larger jets and higher quark energies, the \(k_{T}\) jet algorithm performs better than Cone.

The choice of the Cone algorithm with \(\Delta R=0.4\) that was driven by the need to reconstruct properly W hadronic decays [10] has been found to be an appropriate choice for the \(t\bar{t}\) signal. Background studies that will be performed in the near future will complete the picture.

## 4 \(b\)-tagging efficiency measurement via tag counting

Conceptually, in the absence of background, the simplest way to determine the \(b\)-tagging efficiency in \(t\bar{t}\) events is to count the number of events with different numbers of \(b\)-tagged jets; this allows both the \(b\)-tagging efficiency and the \(t\bar{t}\) production cross-section to be measured simultaneously. This method is discussed in detail below, with an emphasis on the \(b\)- (and \(c\)-) tagging efficiency measurements. More information on \(t\bar{t}\) cross-section measurement can be found elsewhere [4].

Figure 1: Studies of \(b\)-jet resolution: width of \((E_{quark}-E_{jet})/E_{quark}\) and average of \(\Delta\)R(Quark,Jet) for Cone and \(k_{T}\) with different jet sizes.

In the following analysis, the event selection has been slightly tightened from that used elsewhere, in order to reduce the background. Jets are required to have \(E_{T}>30\) GeV. In the lepton+jets channel, the single top background is significantly reduced by applying a cut on the \(W\) and top reconstructed masses, as described in Section 2.

### Method

Top pair-production events give rise to two \(b\)-jets in the final state. Assuming for pedagogical purposes that every selected event contains two \(b\)-jets in the detector acceptance and that only \(b\)-jets can be tagged, then it is clear that the expected number of events with one \(b\)-tagged jet is proportional to \(N2\epsilon_{b}(1-\epsilon_{b})\) while the expected number of events with two \(b\)-tagged jets is proportional to \(Ne_{b}^{2}\), where:

* \(\epsilon_{b}\) is the \(b\)-tagging efficiency, i.e. the probability to tag a \(b\)-jet
* \(N\) is the number of selected \(t\bar{t}\) events prior to any \(b\)-tagging requirement, which is proportional to the \(t\bar{t}\) production cross-section.

It can be seen that it is possible to estimate both the \(b\)-tagging efficiency and the \(t\bar{t}\) production cross-section from the observed number of events with one and two \(b\)-tagged jets.

In reality, \(c\)-jets and light jets (either from the hadronic \(W\) decay or from ISR/FSR) are present and contribute to the number of tagged jets in the event. Moreover not all \(b\)-jets coming from the top decays end up being selected, whilst a small number of \(b\)-jets are produced through gluon radiation. To take these effects into account, the event flavour content is estimated from Monte Carlo with a large simulation \(t\bar{t}\) sample. The factors \(F_{ijk}\) are defined as the fractions of selected events (prior to any \(b\)-tagging requirement) with \(i\)\(b\)-jets, \(j\)\(c\)-jets, and \(k\) light jets (\(i,j,k=0,1,2,3,...\)). The _expected_ number of events with \(n\) tagged jets \(<N_{n}>\) can be written as the sum over all possible combinations of \(i\)\(b\)-jets, \(j\)\(c\)-jets, and \(k\) light jets, as a function of \(b\)-, \(c\)-, and light jet tagging efficiency:

\[<N_{n}>=(L\cdot\sigma_{t\bar{t}}\cdot A_{pre-tag})\cdot\sum_{i,j,k}F_{ijk}\sum _{t^{\prime}+j^{\prime}+k^{\prime}=n}A_{i}^{t^{\prime}}\cdot\epsilon_{b}^{t^{ \prime}}\cdot(1-\epsilon_{b})^{i-t^{\prime}}\cdot A_{j}^{t^{\prime}}\cdot \epsilon_{c}^{t^{\prime}}\cdot(1-\epsilon_{c})^{j-t^{\prime}}\cdot A_{k}^{t^{ \prime}}\cdot\epsilon_{l}^{t^{\prime}}\cdot(1-\epsilon_{l})^{k-k^{\prime}} \tag{1}\]

where \(A_{i}^{t^{\prime}}\) is the number of arrangements \(i!/(i^{\prime}!\cdot(i-t^{\prime})!)\), the prime subscript corresponding to the number of _tagged_ jets of a given flavour; \(\sigma_{t\bar{t}}\) is the total production cross-section; \(A_{pre-tag}\) is the acceptance for \(t\bar{t}\) events prior to any \(b\)-tagging requirement (including trigger efficiency, lepton reconstruction and ID efficiency, _etc._) and \(L\) is the integrated luminosity. The assumption that there is no correlation between tags in a given event is discussed later and is treated as a systematic uncertainty.

Finally, the following likelihood can be written:

\[L=\Pi(Poisson(N_{n},<N_{n}>)) \tag{2}\]

where \(N_{n}\) is the _observed_ number of events with \(n\) tags. In practice only events with one, two, or three tags in the lepton+jets channel and one or two tags in the dilepton channel are taken into account in the likelihood. Events with no tag suffer from significant background, whilst there are few events with more than three (two in the dilepton channel) tags. In the lepton+jets channel, both \(b\)- and \(c\)-tagging efficiencies are allowed to fluctuate in the fit together with the \(t\bar{t}\) cross-section (hence three variables and three constraints); the light jet tagging efficiency is fixed in the fit and must be measured elsewhere. In the dilepton channel, the \(c\)-jet tagging efficiency is also fixed (hence two variables and two constraints).

Tables 2 and 3 show the \(F_{ijk}\) values for the lepton+jets and dilepton channels, estimated from a sample of 265k \(t\bar{t}\) events. It is interesting to note that the 'nominal' combination (two \(b\)-jets and two light jets for the lepton+jets channel; two \(b\)-jets for the dilepton channel) represents only about one third of the

events, due to the presence of ISR/FSR light jets and \(c\)-jets from \(W\) decays. The significant presence of \(c\)-jets in the lepton+jets channels allows the \(c\)-jet tagging efficiency to also be measured.

Figures 2 and 3 show the expected yield of events in the lepton+jets and dilepton channels for an integrated luminosity of \(100\,\mathrm{pb}^{-1}\), as a function of the number of tagged jets. A \(b\)-jet is considered tagged if its \(b\)-tagging weight \(w\) is greater than 7.

The method was applied to a sample of \(t\bar{t}\) events corresponding to about 400 \(\mathrm{pb}^{-1}\) of data and independent of those used to estimate the acceptance factors. Table 4 compares the measured efficiencies and cross-section to their true value for three different \(b\)-tagging purity levels. No bias is visible within the available statistics. The small deviation for the cross-section measurement in the dilepton channel is explained by the lack of statistics in the sample used to estimate the \(F_{ijk}\) factors; this issue is discussed later together with other systematic uncertainties. With \(100\,\mathrm{pb}^{-1}\), a statistical precision of 2.7% (4.2%) can be achieved on the \(b\)-tagging efficiency, and 2.4% (4.8%) on the \(t\bar{t}\) cross-section, respectively in the lepton+jets channel and dilepton channel. In the lepton+jets channel, the statistical uncertainty on the \(c\)-tagging efficiency is rather large, because this measurement is mostly determined by the number of events with three tagged jets.

### Backgrounds

In the lepton+jets channel, the main backgrounds are \(W\)+jets and single top. Other sources of background are \(Z\)+jets (where one lepton fails to be identified), \(WW\)/\(W\)\(Z\)/\(ZZ\)+jets, and QCD processes (which has not been studied, as discussed in Section 2). Figure 2 shows the total background due to \(W\)/\(Z\)+jets, single top, and diboson+jets production and Fig. 4 (left) shows the expected signal over background ratio as a function of the number of tagged jets. Events with one, or more than one, tagged jets have good purity, with signal over background ratios of 14.4 and 26.8 respectively, but the background does need to be taken into account. The estimated background is subtracted from each sub-sample.

\begin{table}
\begin{tabular}{l|c c c c c} Number of light jets & 1 & 2 & 3 & 4 & any \\ \hline
2 \(b\)-jets, 1 \(c\)-jet & 15.9 \% & 10.6 \% & 3.00 \% & 0.85 \% & 30.5 \% \\
2 \(b\)-jets, 0 \(c\)-jet & - & 24.4 \% & 13.8 \% & 3.74 \% & 42.8 \% \\
1 \(b\)-jet, 1 \(c\)-jet & - & 6.46 \% & 2.38 \% & 0.74 \% & 9.75 \% \\
1 \(b\)-jet, 0 \(c\)-jet & - & - & 7.60 \% & 3.21 \% & 11.6 \% \\
0 \(b\)-jet, 1 \(c\)-jet & - & - & 0.38 \% & 0.11 \% & 0.49 \% \\
0 \(b\)-jet, 0 \(c\)-jet & - & - & - & 0.46 \% & 0.65 \% \\ \end{tabular}
\end{table}
Table 2: Fractions of selected events with a certain number of \(b\), \(c\) and light jets in the lepton+jets channel for the counting method. Only the dominant contributions are shown.

\begin{table}
\begin{tabular}{l|c c c c c} Number of light jets & 0 & 1 & 2 & 3 & any \\ \hline
2 \(b\)-jets, 1 \(c\)-jet & 1.02 \% & 0.73 \% & 0.27 \% & \(<\)0.1 \% & 2.08 \% \\
2 \(b\)-jets, 0 \(c\)-jet & 35.2 \% & 20.9 \% & 6.64 \% & 1.39 \% & 64.3 \% \\
1 \(b\)-jet, 1 \(c\)-jet & 1.68 \% & 1.08 \% & 0.46 \% & 0.22 \% & 3.54 \% \\
1 \(b\)-jet, 0 \(c\)-jet & - & 18.9 \% & 6.26 \% & 1.66 \% & 27.2 \% \\
0 \(b\)-jet, 1 \(c\)-jet & - & 0.29 \% & 0.11 \% & \(<\)0.1 \% & 0.40 \% \\
0 \(b\)-jet, 0 \(c\)-jet & - & - & 1.11 \% & 0.31 \% & 1.50 \% \\ \end{tabular}
\end{table}
Table 3: Fractions of selected events with a certain number of \(b\), \(c\) and light jets in the dilepton channel for the counting method. Only the dominant contributions are shown.

Figure 3: Yield expected for an integrated luminosity of 100 pb\({}^{-1}\) in the dilepton+jets channels (left: \(ee/\mu\mu\); right: \(e\mu\)) as a function of the number of tagged jets. The expected background from Z+jets and single top is also shown.

Figure 2: Yield expected for an integrated luminosity of 100 pb\({}^{-1}\) in the lepton+jets channel as a function of the number of tagged jets. The expected background from \(W\)/\(Z\)+jets, single top, and diboson production is also shown.

In the dilepton+jets channel, the main source of background is \(Z\)+jets production (but in the \(e\mu\) channel, only \(Z\rightarrow\tau\tau\to e\mu\nu\nu\) is significant). \(WW/WZ/ZZ+\)jets and single top also contribute. Figure 3 shows the total background due to \(Z\)+jets and diboson+jets production. The purity of the dilepton+jets sample (especially of the \(e\mu\) channel) is good enough for the background estimate not to be an issue. Figure 4 shows that the expected signal over background ratio for events with exactly one tagged jet is 80 in the \(ee\) and \(\mu\mu\) channels and 175 in the \(e\mu\) channel; the background is completely negligible for events with two or more tagged jets. It is remarkable that the \(e\mu\) 0-tagged jet sub-sample is also quite pure and could be used in the fit to improve its statistical power, provided a reliable background estimate is available.

### Systematic uncertainties

Table 5 summarizes the resulting systematic uncertainties for the counting method in the lepton+jets and the dilepton channels. Some effects specific to this method are discussed in detail below.

The acceptance factors \(F_{ijk}\) depend upon the definition of jet flavour, which is arbitrary to some extent. By default, reconstructed jets are matched to the closest heavy quark (after FSR) in \(\Delta R=\sqrt{\eta^{2}+\phi^{2}}\); the jet is attributed the quark flavour if \(\Delta R<0.3\) (in case of ambiguity, \(b\) quarks have priority over

\begin{table}
\begin{tabular}{c c|c c|c c|c}  & & \multicolumn{2}{c|}{\(\varepsilon_{b}\) (\%)} & \multicolumn{2}{c|}{\(\varepsilon_{c}\) (\%)} & \multicolumn{2}{c}{\(\sigma_{\bar{t}}\) (pb)} \\  & & true & meas. & true & meas. & \\ \hline \multirow{3}{*}{Lepton+jets} & \(w>4\) & 72.1 & 71.7\(\pm\)0.7 & 22.3 & 21.9\(\pm\)1.5 & 841\(\pm\)9 \\  & \(w>7\) & 60.4 & 59.8\(\pm\)0.8 & 12.8 & 13.8\(\pm\)1.3 & 844\(\pm\)10 \\  & \(w>10\) & 48.1 & 47.4\(\pm\)0.9 & 6.7 & 8.2\(\pm\)1.4 & 832\(\pm\)13 \\ \hline \multirow{3}{*}{Dilepton} & \(w>4\) & 72.9 & 72.9\(\pm\)1.0 & - & - & 882\(\pm\)17 \\  & \(w>7\) & 61.1 & 60.5\(\pm\)1.2 & - & - & 883\(\pm\)19 \\ \cline{1-1}  & \(w>10\) & 48.4 & 47.9\(\pm\)1.3 & - & - & 883\(\pm\)25 \\ \end{tabular}
\end{table}
Table 4: Counting method: tagging effciencies and cross-section measured on a control sample and compared to their true value for three levels of \(b\)-tagging purity, for the lepton+jets and dilepton channels. The \(t\bar{t}\) production cross-section was assumed to be 833 pb. The uncertainties are statistical only and correspond to about 400 pb\({}^{-1}\) of data.

Figure 4: Signal over background ratio vs the number of tagged jets in the lepton+jets channel (left) and in the dilepton \(ee\)/\(\mu\mu\) and \(e\mu\) dilepton+jets channels (right).

quarks). Jets that are not associated to any \(b\) or \(c\) quark are considered light jets. Another possibility is to match jets with hadrons, following the same procedure. It was checked that the choice of matching hadrons or quarks has a negligible effect on the definition of jet flavour. To assess the systematic uncertainty, the cut was shifted from 0.2 to 0.5 (nominal cut: 0.3) and the \(F_{ijk}\) factors were re-estimated for each value. The shift observed on the same pseudo-experiments was taken as systematic effect.

The counting method assumes that there is no correlation between \(b\)-tags within an event, while some detector effects or the reconstructed primary vertex might induce such a correlation. To check this assumption, events with two reconstructed \(b\)-jets in the detector acceptance were selected. The covariance between the tagging of the two \(b\)-jets is:

\[cov(tag_{1},tag_{2})=\frac{N^{2b-tags}}{N}-\epsilon_{b}^{2}\]

(where \(N^{2b-tags}\) is the number of events with two tagged \(b\)-jets, \(N\) is the total number of events, and \(\epsilon_{b}\) is the true \(b\)-tagging efficiency). It was found that \(cov(tag_{1},tag_{2})=(8.8\pm 27)\cdot 10^{-4}\), which is consistent with 0; the statistical uncertainty corresponds to a bias on the measured efficiency of 0.2 %, which is conservatively taken as systematic uncertainty.

Backgrounds are subtracted in each sub-sample and a 100% uncertainty is assumed. In the lepton+jets sample, for 100 pb\({}^{-1}\), 106 events from \(W/Z\)+jets are expected to populate the lepton+jets 1-tag sub-sample and 34.6 the 2-tag sub-sample. In the dilepton channel, 4.4 events with one tagged jet are expected for all three channels (mostly in the \(ee\) and \(\mu\mu\) channels), resulting in a small uncertainty.

A 5% uncertainty on the jet energy scale, a 1% additional uncertainty on the \(b\)-jet energy scale, and a 2 GeV uncertainty on the top mass, are also taken into account.

The statistical uncertainty on the \(F_{ijk}\) factors was estimated by comparing the results given by two different training samples. It is not negligible in the dilepton+jets channel (3 %). However it could easily be reduced by employing a larger \(t\bar{t}\) sample (1M events would suffice); thus it was not included in the total uncertainty.

\begin{table}
\begin{tabular}{l|c c c|c c} Channel & \multicolumn{3}{c|}{Lepton+Jets} & \multicolumn{2}{c}{Dilepton} \\ Source & \(\epsilon_{b}\) & \(\epsilon_{c}\) & \(\sigma_{t\bar{t}}\) & \(\epsilon_{b}\) & \(\sigma_{t\bar{t}}\) \\ \hline Light \& \(\tau\) jets & \(<0.1\) & 18 & \(<0.1\) & 0.7 & 0.3 \\ \(c\)-jets & - & - & - & 0.8 & 0.8 \\ \(b\)-jet labelling & 1.4 & 12 & 0.1 & 1.4 & 0.1 \\ tag correlation & \(<0.2\) & \(<0.2\) & \(<0.2\) & \(<0.2\) & \(<0.2\) \\ Jet energy scale & 0.9 & 2.9 & \({}^{+6.8}_{-9.9}\) & 0.5 & \({}^{+1.3}_{-3}\) \\ \(b\)-jet energy scale & \(<0.1\) & 1.5 & 0.8 & 0.2 & \(<0.1\) \\ (MC statistics & 0.5 & 7 & 0.5 & 3 & 3) \\ Background & 1.2 & 3.5 & 4.8 & 0.3 & 0.4 \\ AcerMC vs MC@NLO & \(<0.1\) & 9 & (4.9) & 2 & 6 \\ ISR/FSR & 2.7 & 12.5 & 8.9 & 2 & (4) \\ top quark mass & 0.3 & - & 2.2 & 0.5 & 2 \\ Luminosity & - & - & 5 & - & 5 \\ Lepton ID/trigger/pdfâ€™s & - & - & 2.8 & - & 2.8 \\ \hline Total & 3.4 & 27 & \({}^{+12.4}_{-14.4}\pm 2.8\pm 5\) & 3.5 & \({}^{+6.6}_{-7.2}\pm 2.8\pm 5\) \\ \hline Statistical (100 pb\({}^{-1}\)) & 2.7 & 18 & 2.4 & 4.2 & 4.8 \\ \hline \end{tabular}
\end{table}
Table 5: Relative systematic and statistical uncertainties (in percent) for the lepton+jets channel for a \(b\)-tagging efficiency of \(\epsilon_{\rm true}=0.6\) and jet \(E_{T}>30\) GeV.

The cross-section measurement is very sensitive to the jet multiplicity, which is driven mostly by ISR and FSR. This uncertainty appears also in the comparison of the two MC generators since the hadronisation models (Herwig in one case, Pythia in the other) need to be tuned in data and display important differences. In order to avoid to count twice the uncertainty on jet multiplicity, only the largest of the two estimates (ISR/FSR and MC generators) was considered in the total systematic uncertainty.

Systematic uncertainties on \(\sigma_{t\bar{t}}\) that are not specific to this analysis are discussed elsewhere [4]. Uncertainties relative to integrated luminosity and event selection prior to \(b\)-tagging (namely, lepton identification efficiency, trigger efficiency and pdf's) amount to 5 % and 2.8 %, respectively.

### Tag counting results

With 100 pb\({}^{-1}\) of data, the counting method allows the \(b\)-tagging efficiency at a working point of \(\epsilon_{\rm true}=0.6\) to be measured with a relative precision of \(\pm 2.7\)(stat.)\(\pm 3.4\)(syst.) % in the lepton+jets channel, and \(\pm 4.2\)(stat.)\(\pm 3.5\)(syst.) % in the dilepton channel. A better understanding of ISR/FSR could significantly reduce the systematic uncertainty.

The uncertainty on the \(t\bar{t}\) production cross-section is somewhat larger in both channels, with \(\pm 2.4\)(stat.)\({}^{+12.7}_{-14.7}\)(syst.)\(\pm 5\)(lum.) % in the lepton+jets channel, and \(\pm 4.8\)(stat.)\({}^{+7.2}_{-7.7}\)(syst.)\(\pm 5\)(lum.) % in the dilepton channel, mostly because of the uncertainties on the jet multiplicity (ISR/FSR), jet energy scale, and background estimate, uncertainties that can be improved in the long term and have been assessed conservatively here.

The lepton+jets channel also allows the \(c\)-tagging efficiency to be measured. Unfortunately it is very sensitive to light jet contamination, and the uncertainty on light jet rejection and jet multiplicity makes any precision measurement impossible. Isolating a purer \(c\)-jet sample through some kinematic selection might help but has not been attempted here.

## 5 Selecting \(b\) jet samples in data

Going beyond the \(b\)-tagging efficiency measurement from the counting method discussed above, the kinematics and topology of semileptonic \(t\bar{t}\) events also allow pure samples of \(b\)-jets to be identified directly. Providing this selection is done without biasing any properties of the selected \(b\)-jets, they can then be used to measure the \(b\)-tagging efficiency, simply by studying the distribution of the tagging discriminant variable(s) in the selected jets. With enough statistics, this technique should also allow the measurement of the tagging efficiency as a function of other variables (e.g. jet \(E_{T}\) and \(\eta\)).

Obtaining a pure sample of identified \(b\)-jets requires full reconstruction of the \(t\bar{t}\) decay chain, assigning four jets in the event to the two \(b\)-jets coming directly from the \(t\to Wb\) decays and the jets from hadronic \(W\to qq\) decay. For any given event, many different assignments are possible, especially when spectator jets (not from the \(t\bar{t}\) decay) are also present. The correct combination can be determined by making use of kinematic information, including the reconstruction of the hadronic and leptonic top masses for each considered combination, and the classification can be further improved by requiring a \(b\)-tag for \(one\) of the jets assigned to the \(t\to Wb\) decay, providing the other presumed \(b\)-jet is left unbiased.

Three similar techniques have been explored for making this jet identification, all of which consider each combinatorial jet assignment and try to determine which one is correct:

* A 'topological' selection based on the reconstructed masses for each combination.
* A 'likelihood' selection, exploiting reconstructed top mass, jet momentum and angular information.
* A 'kinematic' selection based on applying a kinematic fit to each combination and choosing the one with the best \(\chi^{2}\) value.

All of these methods start from the selection of semileptonic \(t\bar{t}\) events discussed in Section 2, _i.e._ events with a high-\(E_{T}\) lepton, significant missing energy and at least four jets. None of the methods result in a sample which is 100 % pure in \(b\)-flavoured jets, so background subtraction techniques are needed to derive pure samples on a statistical basis. The three methods, their associated background subtraction techniques, and their application to the measurement of the \(b\)-tagging efficiency for the standard IP3D+SV1 tagger, are discussed in Sections 5.1, 5.2 and 5.3 below. Comparisons of their performance in terms of \(b\)-jet sample selection and \(b\)-tagging efficiency measurement are then given in Sections 5.4 and 5.5.

### Topological selection

The topological selection of \(b\)-jets from the basic sample has two stages: reconstruction of \(t\bar{t}\) pairs, followed by fitting the top mass distributions to extract the \(b\)-jet sample and estimate the remaining background. To improve the purity, an explicit \(b\)-tag is required on the jet from the hadronic top decay, whilst the \(b\)-jet from the leptonic top is left unbiased, and is used to form the sample of \(b\)-jets for measuring the tagging efficiency.

An attempt is made to reconstruct both hadronic and leptonic top decays in each event. First, the invariant mass of every pair of jets is calculated to look for combinations consistent with coming from the decay \(W\to jj\). Combinations satisfying \(60<m_{jj}<100\) GeV are retained, and combined with a third jet to form a candidate \(t\to bW\to bjj\) decay. One jet from the W decay and the candidate \(b\)-jet must have jet \(E_{T}>40\) GeV, and the second \(W\) decay jet must have \(E_{T}>20\) GeV. To reduce background, this candidate \(b\)-jet is required to have a \(b\)-tagging weight of \(w>3\), corresponding to an efficiency of about 74 % for genuine \(b\)-jets from top decay. Additionally, the two \(W\) jets are both required to have \(b\)-tagging weights of \(w<3\), to reduce the probability that the \(b\)-jet from the top decay is included in the \(W\). No mass requirements are placed on the hadronic top candidate at this stage.

A leptonic top is then reconstructed from one of the other jets and a reconstructed leptonic \(W\) decay. The leptonic \(W\) is formed from the identified lepton and a neutrino, whose transverse momentum (\(p_{x}\), \(p_{y}\)) is taken to be equal to the missing transverse momentum vector of the event. The longitudinal momentum of the neutrino is inferred using the constraint of the known \(W\) mass, which leads to a quadratic equation for \(p_{z}\) which has either two or no solutions. In the case of two solutions, the one with the smaller \(p_{z}\) is chosen. If there is no solution, the measured missing \(E_{T}\) is scaled down, preserving its direction, until a solution is possible. The reconstructed \(W\) is then combined with another jet which was not used in making the hadronic \(W\), which is assumed to be the \(b\)-jet from the leptonic top decay. This jet is required to have \(E_{T}>20\) GeV. No requirements are placed on the \(b\)-tagging weight for this jet, which is instead enhanced in \(b\)-flavour due to the topological reconstruction of the \(t\bar{t}\) event.

This procedure is performed for all possible combinations of jets in each event. In an event with four jets, several assignments of jets to the hadronic top \(b\)-jet, leptonic top \(b\)-jet and W decay jets are possible, constrained by the requirements made on the \(b\)-tagging weights for the jets assigned to the hadronic top decay. In events with more than four jets, some jets will be left unassigned, and are assumed to be spectator jets from initial or final state radiation or the underlying event. As the number of jets in the event increases, the number of combinations satisfying all the requirements increases very rapidly, from typically one or two combinations in events with four jets to an average of nine combinations for events with six or more jets. The combination with the largest scalar sum of the \(p_{T}\) of the two tops is retained for further analysis. In 100 pb\({}^{-1}\) of fully-simulated \(t\bar{t}\) events plus \(W\)+jets background, 3028 events are selected, of which 80 % are semileptonic \(t\bar{t}\) events with \(t\to be\nu\) or \(b\mu\nu\), with the background being dominated by \(t\bar{t}\) with \(b\to b\tau\nu\) (11 %) and \(W\)+jets (6 %), together with smaller contributions from dilepton and single top events.

#### 5.1.1 Mass fitting

After all these selections, only one assignment of jets and leptons to the hadronic and leptonic top decays remains. The resulting distributions of reconstructed hadronic and leptonic top masses are shown in Fig. 5. Clear top mass peaks are seen in both distributions, though with significant combinatorial background and a small contribution from \(W\)+jet and single top background events. Contributions from non-\(t\bar{t}\) events (denoted class 1), events where both tops are incorrectly reconstructed (class 2), events where one top (hadronic or leptonic) is correctly reconstructed and the other is not (classes 3 and 4), and events where both tops are correctly reconstructed (class 5) are shown separately. For these purposes, a top decay is considered correctly reconstructed if the associated \(b\)-jet is actually labelled as a \(b\)-jet by the Monte Carlo truth analysis, and the direction of the reconstructed top decay is within \(\Delta R\) of 0.5 (2.0) for the hadronically (leptonically) decaying top. The hadronic top mass distribution in Fig. 5 shows peaks for classes 3 and 5, and the leptonic top mass shows peaks for classes 4 and 5, though with a considerably worse mass resolution. Both distributions also show some 'peaking' structure in the combinatorial backgrounds.

The analysis aims to extract a pure sample of \(b\)-jets from the reconstructed leptonic top decay. The leptonic top is chosen since it does not suffer from combinatorial background within the top decay itself--by contrast, in the hadronic top decay with three jets combined to give the top mass, a mis-assignment of jets to \(W\) decay and \(b\) will give the same top mass, with only the reconstructed hadronic \(W\) mass changing. Since the resolution on the latter quantity is relatively poor, many reconstructed \(bj\) combinations are compatible with the \(W\) mass, and the \(W\) mass requirement gives little discrimination. In the leptonic top decay, the \(W\) has no decay jets, and this problem does not arise.

The resolution on the reconstructed leptonic top mass is poor, and there is a large combinatorial background. This is reduced by first requiring that the hadronic top mass is in the signal region (\(140<m_{\tilde{\rm{jj}}}<190\) GeV), and then dividing the sample into five sub-samples according to the recon

Figure 5: Reconstructed hadronic (left) and leptonic (right) top masses for the selected jet combination, showing the contributions from correctly reconstructed \(t\bar{t}\) events, combinatorial and non-\(t\bar{t}\) background, normalised to 100 pb\({}^{-1}\). The numbers refer to the classes discussed in the text.

structed \(E_{T}\) of the leptonic top \(b\)-jet, as the level of background depends strongly on this jet energy. The resulting leptonic top mass distributions can be seen in Fig. 6, where it can be seen that the top signal is significantly enhanced, especially for high leptonic top jet \(E_{T}\). Events from classes 4 and 5 have correctly reconstructed leptonic tops, where the leptonic top jet is pure \(b\) flavour, whilst the other events are combinatorial background, with a mixture of jet flavours (they can include \(b\)-jets from the hadronic top, and jets which are not unambiguously from a single parton, containing some particles from the decay of \(B\) hadrons).

In order to correct for this background of event classes 1-3 under the leptonic top mass peak, both its size and flavour composition must be determined. This is done on a statistical basis using the sideband region with high \(m_{b\ell\nu}\) to normalise the background contribution, and a control sample to determine the shape of its mass distribution. The control sample is generated from events where the reconstructed hadronic top mass satisfies \(200<m_{\rm jj}<400\,\)GeV, and where the leptonic top \(b\)-jet satisfies a cut on the \(b\)-tagging weight of \(w<4\). These samples are dominated by events in classes 2 and 3, and provide a reasonable model of the background shapes in the signal sample.

The amount of background under the signal is then extracted using a simultaneous fit to both signal and control sample leptonic top mass distributions. The control sample is described using a fit function \(F_{b}(m_{b\ell\nu})\) given by:

\[F_{b}(m_{b\ell\nu})=E((m_{b\ell\nu}-c_{0})/400)\,, \tag{3}\]

where \(E(x)\) is given by:

\[E(x)=\left\{\begin{array}{ll}c_{1}x^{c_{2}}\exp(-c_{3}x)&\mbox{if $x>0$}\\ 0&\mbox{if $x<0$}\end{array}\right.\,. \tag{4}\]

The signal is described by a fit function \(F_{s}(m_{b\ell\nu})\) consisting of a scaled background function plus a Gaussian representing the signal, given by:

\[F_{s}(m_{b\ell\nu})=c_{4}F_{b}(m_{b\ell\nu})+c_{5}G((m_{b\ell\nu}-c_{6})/c_{7 })\,. \tag{5}\]

The parameter \(c_{4}\) represents the ratio of class 1-3 background contributions in signal to control samples, and \(c_{5}\) the amount of top signal with fitted mean \(c_{6}\) and RMS width \(c_{7}\). All eight parameters are extracted in a simultaneous \(\chi^{2}\) fit to the signal and control sample mass distributions, thus determining the shape of the background under the signal peak from the control sample, and the normalisation of the background from the sideband of the signal distribution at high \(m_{b\ell\nu}\). Separate fits are performed in each leptonic top jet \(E_{T}\) bin, and the results are shown in Fig. 6. The fits are performed over the mass range \(b_{1}\) and \(b_{2}\), where \(b_{1}\) is set to 90, 90, 110, 120, and 130 GeV for the 20-40, 40-80, 80-120, 120-160 and 160-200 GeV jet \(E_{T}\) bins, reflecting the differing kinematic cut-off in each jet mass bin.

#### 5.1.2 Background subtraction

The sample of leptonic top \(b\)-jets is divided using the reconstructed leptonic top mass into a signal region defined by \(s_{1}<m_{b\ell\nu}<s_{2}\) where \(s_{1}=c_{6}-2c_{7}\) and \(s_{2}=c_{6}+2c_{7}\) (_i.e._\(m_{b\ell\nu}\) within \(\pm 2\sigma\) of the fitted top mass peak position) and a sideband region with \(m_{b\ell\nu}\) outside this range. The distribution of the \(b\)-tagging weight in the signal region contains contributions both from pure \(b\)-jets (events of classes 4 and 5), and from the mixture of flavours forming the combinatorial background under the signal peak. This latter mixture is well described by the jets in the sideband region, so its effect is corrected for by subtracting the \(b\)-tagging weight distribution in the sideband region, scaled according to the expected normalisation derived from the mass fit discussed in Section 5.1.1. The scale factor \(S\) is given by:

\[S=\frac{\int_{s_{1}}^{s_{2}}F_{b}(m_{b\ell\nu})\,dm_{b\ell\nu}}{\int_{b_{1}}^ {s_{1}}F_{b}(m_{b\ell\nu})\,dm_{b\ell\nu}+\int_{s_{2}}^{b_{2}}F_{b}(m_{b\ell \nu})\,dm_{b\ell\nu}} \tag{6}\]Figure 6: Reconstructed leptonic top mass distributions for different regions of the leptonic top \(b\)-jet \(E_{T}\), with hadronic top mass in the range \(140<m_{\rm jj}<190\) GeV. The points with error bars show all events, with background contributions indicated by the hatched histograms. The error bars show the full Monte Carlo statistics (\(948\,{\rm pb}^{-1}\)) whilst the event counts indicate the number of events expected for \(100\,{\rm pb}^{-1}\). The lines show fits to the signal and estimated background, and are discussed further in the text.

and varies between around 4 for the 40-80 GeV bin to 0.3 for the 160-200 GeV bin. Once this scaled background has been subtracted, the resulting \(b\)-tagging weight distribution in the signal region is statistically compatible with that expected from pure \(b\)-jets. The uncertainty on the amount of background to subtract in each bin of the \(b\)-tagging weight distribution has two components: the uncertainty on the number of background events in each bin in the sideband distribution, scaled by \(S\), and the uncertainty on \(S\) itself, which is correlated across all bins. The latter is calculated using equation 6 together with the full correlation matrix for the parameters \(c_{0}\) to \(c_{6}\) which are used in the background function \(F_{b}(m_{b\ell\nu})\).

In order to check that this selection does not introduce a bias, the \(b\)-tagging weight distribution of true \(b\)-jets in the selected signal region was checked, and found to be compatible with that of all \(b\)-jets within the \(\eta\) and \(E_{T}\) acceptance. Hence this selected sample of \(b\)-jets can be safely used to measure the \(b\)-tagging efficiency.

#### 5.1.3 Topological selection results

The results of applying this analysis procedure to full simulation events (including background) are shown as the 'Topological' entries in Table 6 in Section 5.4. For each leptonic top jet \(E_{T}\) bin, the number of jets selected in the window \(s_{1}<m_{b\ell\nu}<s_{2}\), the number remaining after subtracting the scaled sideband background, and the purity of the selected sample are given, together with the background-subtracted sample \(b\)-flavour purity, _i.e._ the fraction of the background-subtracted sample which is made up of \(b\)-flavour jets according to the Monte Carlo truth information. It can be seen that in all cases the flavour purity is compatible with unity within errors, showing that the background subtraction procedure is working well and producing a statistically pure sample of \(b\)-jets. Table 6 also shows the results integrated from 40-200 GeV. The sample size and purity in the 20-40 GeV jet \(E_{T}\) bin is not sufficient to make a sensible measurement of the \(b\)-tagging efficiency, and this bin is not considered in what follows.

Using this \(b\)-jet selection, the \(b\)-tagging efficiency corresponding to any cut on the \(b\)-tagging weight can be obtained by integration of the \(b\)-tagging weight distribution, _i.e._ calculating the fraction of the background-subtracted weight distribution above the cut value. This efficiency is shown as a function of \(b\)-tagging weight cut for each \(b\)-jet \(E_{T}\) bin in Fig. 7 as the points with error bars. The solid histogram shows the same distribution for an unbiased sample of pure \(b\)-jets in \(t\bar{t}\) events without any event selection, derived using Monte Carlo truth information. If the method is correct, the two distributions should agree within errors. The statistical errors on the measured \(b\)-tagging efficiency (which are highly correlated between bins) have two components: the binomial errors due to the fluctuations in numbers of events passing the cut for signal and background, and the uncertainty due to the background subtraction scale factor \(S\). Figure 7 also shows the difference \(\delta=\epsilon_{\rm meas}-\epsilon_{\rm true}\) between the estimated and true efficiency, which should be compatible with zero if the method is working well. This is seen to be the case except for very high \(b\)-tagging efficiencies in the two highest jet \(E_{T}\) bins, where the statistics are limited. The combined efficiency curve for \(b\)-jet \(E_{T}>40\) GeV is shown in Fig. 8(a). These results are derived by weighting the individual \(b\)-tagging efficiencies measured in each energy bin by the \(b\)-jets \(E_{T}\) distribution in \(t\bar{t}\) events.

The method has been validated using ensemble tests based on sets of Monte Carlo subsamples of various integrated luminosities, derived from a sample of 1793 pb\({}^{-1}\). Studies of the distributions of fit results, estimated uncertainties and pulls show that the uncertainty on the \(b\)-tagging efficiency returned from the fit underestimates the true uncertainty by about 20 %. They also show that the fit shows significant biases and does not always converge correctly for samples of 100 pb\({}^{-1}\). With 200 pb\({}^{-1}\) of data, the fit results are unbiased and the fit converges in 98 % of the test samples; hence this is considered the minimum amount of data for which this technique can be used.

Figure 8(b) shows the absolute uncertainty returned by the tagging measurement as a function of the efficiency itself, scaled to an integrated luminosity of 200 pb\({}^{-1}\). At \(\epsilon_{\rm true}=0.6\), the statistical error is about 0.038, corresponding to a relative error of \(\sigma_{\epsilon_{\rm true}}/\epsilon_{\rm true}=\)6.4 %.

Figure 7: \(b\)-tagging efficiency _vs._ weight cut for different \(b\)-jet \(E_{T}\) ranges, as measured by the topological \(b\)-jet analysis (upper points with error bars, statistics of full simulation sample), and compared to the true efficiency from unbiased \(b\)-jets (histogram). The difference between the two is shown as the lower points with error bars.

Figure 8: (a) \(b\)-tagging efficiency _vs._ cut on \(b\)-tagging weight \(w\), as measured from the topological \(b\)-jet selection (points with error bars), and derived from Monte Carlo truth information in all \(b\)-jets in \(t\bar{t}\) events (histogram), for 948 pb\({}^{-1}\) of simulated \(t\bar{t}\) plus background events; (b) Estimated statistical uncertainty on the measured \(b\)-tagging efficiency as a function of tagging efficiency, for 200 pb\({}^{-1}\).

Systematic uncertainties have been evaluated as discussed in Section 4.3, with the exception that no uncertainties were evaluated for \(b\)-jet labelling, Monte Carlo statistics and the top quark mass, which are not relevant for this analysis. The systematic errors are summarised in Table 7.

### Likelihood-based selection

The likelihood selection uses templates based on event and jet kinematic variables to determine the best assignment of jets to \(t\bar{t}\) decay products within an event. These same likelihoods are also used to select events for which the jet assignments are most likely to be correct.

Templates are constructed using several kinematic variables to provide discrimination between 'correct' and 'incorrect' permutations. To maximize discrimination, templates are constructed separately for each jet multiplicity. All possible permutations of assignments of jets to final-state quarks are considered, and, for each permutation within each event, the leptonic and hadronic top quark and hadronic \(W\) boson are reconstructed, using the reconstructed momenta. The permutation is labelled 'correct' if the jets used to reconstruct the particle (\(t\), \(W\), \(b\)-quark, or light quark from \(W\) decay) are correctly matched to the quarks arising from the hard-scatter vertex. To limit the number of jet-parton assignment combinations, events with more than six jets are rejected.

The 18 variables used in the likelihood are described below. The two templates based on the hadronic t-quark are shown in Fig. 9.

**1-4. hadronic \(W\) boson and top quark \(p_{T}\) and mass.**: The two light quark four-momenta are added together to obtain the hadronic \(W\) boson four-momentum. The \(b\)-quark four-momentum is then added to obtain the hadronic top quark momentum.
**5-6. leptonic top quark \(p_{T}\) and mass.**: The transverse momentum of the neutrino is taken to be the negative of the total transverse momentum of the event. The \(z\)-component of the neutrino momentum is unknown, so is determined by assuming the mass of the \(W\) boson (80.403 GeV) and solving the resulting quadratic equation. Since there are two solutions, the smaller solution is chosen. If the root is imaginary, the real part is used. The energy of the neutrino is taken from the neutrino momentum assuming the neutrino is massless. The leptonic top quark four-momentum is then determined from the lepton, neutrino and associated \(b\)-quark jet.
**7-18. hadronic and leptonic \(b\)-jets and 2 jets from \(W\)-decay: rank, \(E_{T}\), and \(\Delta\phi(b_{had},\mbox{\bf{lep}})\).**: For each of the four jets assigned to the hadronic \(W\) quarks and the two \(b\)-quark, kinematic variables are used to construct additional templates. The jets are ranked by \(E_{T}\), with rank one denoting the jet with the highest \(E_{T}\). This jet rank, along with jet \(E_{T}\) and the separation in \(\phi\) between the jet and the lepton (\(\Delta\phi(\mbox{jet,lep})\)) are used as additional templates.

#### 5.2.1 Event selection

The \(b\)-purity of the basic sample selected as discussed in Section 2 is enhanced by requiring one jet to be \(b\)-tagged, with an IP3D+SV1 weight \(w>6\). Then a discriminant value \(\mathcal{D}\) is calculated for each jet combination in the event using the templates, which are taken to be likelihood distribution functions for each variable. The 'correct combination' templates are used to get the '\(s\)' values for the \(i^{th}\) variable, and the 'incorrect combination' templates are used to get the '\(b\)' values. They are combined according to:

\[\mathcal{D}=\frac{\prod_{i}(s_{i}/b_{i})}{1+\prod(s_{i}/b_{i})}. \tag{7}\]Figure 9: Templates for the likelihood-based selection, using (a) hadronic \(t\)-quark mass and (b) hadronic \(t\)-quark \(p_{T}\).

In each event, the combination with the largest value of \(\mathcal{D}\) is retained. The resulting distributions are shown in Fig. 10, normalised to 100 pb\({}^{-1}\). The contributions from the correct combination, incorrect combinations and non-\(t\bar{t}\) events are shown separately. As can be seen from the right-hand plot, very high discriminant values are required to select a sample with high purity.

The \(b\)-jet purity is shown _vs._ the number of selected events in Fig. 11, for several ranges of jet \(E_{T}\). Higher purity samples can be obtained by tightening the cut on \(\mathcal{D}\), but at the expense of selection efficiency. A cut of \(\mathcal{D}>0.985\) was chosen for these studies assuming 100 pb\({}^{-1}\) samples, which could be raised to improve the purity once the data sample size allows.

#### 5.2.2 Background subtraction

Assuming the cuts used to discriminate between correct and incorrect jet-parton assignments reduce the background from non-\(t\bar{t}\) events to a negligible level, the primary background to be considered arises from jets incorrectly assigned to \(b\)-quarks. These jets can be from light, \(c\), or \(s\)-quarks from \(W\) decay, and from ISR/FSR jets. To estimate the effect of the background on the \(b\)-tagging efficiencies, it is necessary to determine the tagging rate of jets in background events, as well as the fraction of signal (and hence background) events in the data sample. Using Monte Carlo truth information to determine the true flavour of the jet assigned to the leptonic top decay (and assumed to be a \(b\)-jet), signal (\(S\)) and background (\(B\)) templates are formed, binned by discriminant value. Using these templates, a likelihood is constructed

Figure 10: Discrimination between correct and incorrect permutations, best permutation chosen for each event, for entire range of \(\mathcal{D}\), and for \(\mathcal{D}\geq 0.985\). Events are chosen which have at least 1 \(b\)-tagged jet.

Figure 11: Likelihood selection: \(b\)-jet purity vs. number of selected events (discriminant cut value ranging from 0.975 to 1) for each \(b\)-jet \(E_{T}\) bin.

to find the fraction \(f_{sgn}\) of signal events. The likelihood formed from data (\(D\)) and templates is:

\[\ln\mathcal{L}(f_{sgn})=\sum_{i}^{\#bins}-D_{i}\,\ln\left(f_{sgn}S_{i}+(1-f_{sgn })B_{i}\right), \tag{8}\]

where \(D_{i}\) is the number of data events in the \(i^{th}\) bin, and \(S_{i}\) and \(B_{i}\) are the values of the \(i^{th}\) bins of signal and background templates. The associated background \(b\)-tagging efficiencies are determined using events passing a looser discriminant cut (\(\mathcal{D}>0.9\)), since the tag rate for jets in the background do not depend strongly on the value of this cut. These are shown for several ranges of jet \(E_{\tau}\) in Fig. 12. The average of the \(b\)-tagging efficiencies of non-\(b\)-jets over all jet \(E_{T}\) bins is used, giving \(\epsilon_{tag}^{\text{bkgd}}=0.021\pm 0.004\). Once the \(b\)-tagging efficiencies for background events and \(f_{sgn}\) are obtained, the following equation is used to solve for \(\epsilon_{\text{btag}}^{b\text{-jets}}\).

\[\epsilon_{\text{btag}}^{b\text{-jets}}=\frac{1}{f_{sgn}}\left(\epsilon_{ \text{btag}}^{\text{all jets}}-(1-f_{sgn})\epsilon_{\text{btag}}^{\text{ bkgd}}\right) \tag{9}\]

#### 5.2.3 Results for \(b\)-tagging efficiency measurement

The \(b\)-tagging efficiencies are determined for events binned in \(b\)-jet \(E_{T}\), with bin sizes chosen to match the kinematic and topological methods. To simulate the \(100\,\text{pb}^{-1}\) sample, histograms have been scaled to the number of events expected in the sample. The sample purities are shown for the \(E_{T}\)-binned sample

Figure 12: \(b\)-tagging efficiencies for signal (\(b\)-jets), and tag rate for light and \(c\)-jets (background) for events passing a discriminant cut of 0.9. Each plot was done for a different range of jet \(E_{T}\).

in Table 6 for comparison with the other methods, and the \(b\)-tagging efficiencies are shown in Fig. 13. The average of \(b\)-tagging efficiencies for jet \(E_{T}>40\,\)GeV is 0.674 \(\pm\) 0.086, consistent with the actual value of 0.658.

Ensemble testing was done using 100 pseudo-experiments, verifying the same central value and error. The pull distribution of the 100 pseudo-experiments has a width of 0.60 standard deviations, so the error (0.086) is scaled by 0.60 to get an expected statistical error 0.05 for the 100 pb\({}^{-1}\) sample. The low pull width arises because, for some pseudo-experiments in the ensemble, likelihood fits of signal fractions are close to 0 or 1. Failing to determine asymmetric errors properly for these pseudo-experiments results in an overestimation of the error.

Systematic uncertainties are determined for the effects discussed in Section 4.3, using the full available MC statistics for all except the effect of background events in the sample. Ensemble testing was used to evaluate this error, using double the expected number of events and no background events. In general, the systematic errors are large for the cuts chosen for the 100 pb\({}^{-1}\) sample. These are expected to improve once data samples are available and the discriminants are optimised, especially once the sample size allows tighter jet \(E_{T}\) and discriminant cuts to be used in order to reduce the background from non-\(t\bar{t}\) and wrong combinations.

Figure 13: Likelihood method: simulation of \(b\)-tagging efficiencies vs. \(E_{T}\) for a 100  pb\({}^{-1}\) sample using the best permutation for events selected with a discriminant cut. The solid line shows the true \(b\)-tagging efficiencies from the full MC sample using truth information. (\(b\)-tag weight=6.0, discriminant cut 0.985)

### Kinematic selection

This section describes the selection of a high purity \(b\)-jet sample through the use of a kinematic fit and cuts based on the resulting fit \(\chi^{2}\). Other selection criteria, including the use of a \(b\)-tag on the hadronic top \(b\)-jet are also used to enhance the purity. As with the other methods described above, it is difficult to get high purity whilst maintaining sufficient statistics, and a data-based background subtraction procedure is employed to derive an effective pure \(b\)-jet sample.

#### 5.3.1 Kinematic fit and performance

The analysis uses the kinematic fit HITFIT [11], originally developed at DO. A \(W\) mass constraint is included and the two reconstructed tops are constrained to have the same mass. The top mass can also be constrained. For this study the mean top mass obtained with the unconstrained fit (172 GeV) was used as a constraint in subsequent fits. The mean top mass obtained from the fit was 172 GeV. Both neutrino solutions are considered and the one with the lower \(\chi^{2}\) is used. The fit requires calibrations of the jet energy to the parton energy and resolutions of the jets and leptons, which were determined by comparing reconstructed quantities with the Monte Carlo truth information.

Only the four largest \(E_{T}\) jets in the event were used in the kinematic fit, giving rise to 12 permutations which were each fitted. The correct combination is not always in the four leading jets. In 49 % of the events passing the basic semileptonic event selection discussed in Section 2, the four jets from the \(t\bar{t}\) system are reconstructed and pass the jet selection cuts. Out of the events where all four jets are reconstructed 44 % contain the ttbar jets in the four leading jets, rising to 92 % of events if the first six jets are used. However, this leads to a large increase in combinatorial background and was not considered further.

From the four leading jets, the permutation with the lowest \(\chi^{2}\) was chosen, and events where this \(\chi^{2}\) was below a particular cut value were retained. If the four leading jets are four jets from the \(t\bar{t}\) system, then the correct permutation is the one with the lowest \(\chi^{2}\) in 58 % of the cases. Figure 14 (left) shows the \(\chi^{2}\) distribution for the selected combination, including the contributions from correct and wrong combinations in \(t\bar{t}\) events, and from \(W\)+jets and single top backgrounds. It can be seen that the fraction of correct combinations is not high, even for low \(\chi^{2}\) values. Several addi

Figure 14: Kinematic selection: Distribution of the \(\chi^{2}\) for the permutation with the minimum \(\chi^{2}\) showing contributions of the signal and backgrounds with standard selection cuts (left plot), and with additional requirements according to selection \(S_{3}\) described in the text (right plot).

the'standard cuts' \(S_{0}\) defined above were tried in order to enhance the purity as follows. Selection \(S_{1}\) requires a \(b\)-tag with weight \(w>5\) on the jet assigned as the hadronic \(b\)-jet; the effect of this is mainly to reduce the \(W\)+multijet background. Selection \(S_{2}\) adds a \(b\)-tag veto (\(w<5\)) on both jets assigned to the hadronically decaying \(W\). Selection \(S_{3}\) also requires there are six or less jets with \(E_{T}>20\) GeV, and selection \(S_{4}\) requires that the hadronic top \(p_{T}\) satisfies \(p_{T}>150\) GeV. The relative reduction of wrong combinations and background can be seen in the \(\chi^{2}\) distribution after selection \(S_{3}\) as shown in Fig. 14 (right).

Figure 15 shows the results of these additional selections, in terms of the fraction of jets assigned as the leptonic top \(b\)-jet which are really \(b\)-jets, and the number of selected events for \(100\,\mathrm{pb}^{-1}\). Purities of up to \(90\,\%\) are reachable, but at the cost of low selection efficiency. To retain a reasonable number of events, a signal sample is defined using selection \(S_{3}\) with a cut \(\chi^{2}<10\), which leaves around 600 events for \(100\,\mathrm{pb}^{-1}\).

#### 5.3.2 Background subtraction

As for the topological method, a background control sample is used to estimate the composition of the remaining background in the sample of selected jets from data. The use of the kinematic fit excludes most events with masses outside the top mass window, so it is not possible to use top mass sidebands to estimate the background composition. However, events with high \(\chi^{2}\) are predominantly wrong combinations (see Fig. 14). The wrong-combination fraction can be enhanced by selecting events that pass the standard selection \(S_{0}\) and requiring that one of the jets assigned to the \(W\) is tagged as a \(b\)-jet (\(w>5\)). The \(\chi^{2}\) distribution of this control sample follows closely that of the wrong combination background in the selected jet sample. The shape of the \(\chi^{2}\) distribution is used to predict the amount of combinatorial background in the signal sample, normalising the two samples in the region \(30<\chi^{2}<100\). Any test distribution (_e.g._ the \(b\)-tagging weight) extracted from the signal sample can then be corrected for this contribution of background events, taking the shape of the test distribution in background from the region of the control sample with \(\chi^{2}>30\). This background subtraction method is very similar to that discussed in Section 5.1, with the high \(\chi^{2}\) region playing the role of the top mass sideband, and the control sample with a \(b\)-tagged jet from the \(W\) decay corresponding to the sample with high hadronic top mass in the topological selection.

Figure 15: Left: The purity (fraction of true \(b\) jets) of the jet assigned as the \(b\)-jet on the leptonic side as a function of the \(\chi^{2}\) cut. Right: The corresponding number of events. The different selection criteria are described in the text.

#### 5.3.3 Results for \(b\)-tagging efficiency measurement

The results of applying this selection to simulated data including background and scaling the event count to 100 pb\({}^{-1}\) are shown in Table 6. The purity in the 20-40 GeV jet \(E_{T}\) bin is rather low, and the background from the significant contribution of single top is not well-estimated. As for the topological analysis, this bin is not used for calculating the \(b\)-tagging efficiency. The combined \(b\)-tagging weight distribution for the other bins (\(E_{T}>40\) GeV) is shown in Fig. 16. The \(b\)-tagging efficiency corresponding to any given cut can be calculated by integration, and the corresponding statistical errors for various tag working points can be seen in Table 7.

### Comparison of selection methods

The performance of the different \(b\)-jet selection methods are compared in Table 6, which shows the number of jets selected as a function of jet \(E_{T}\), the effective number of jets after background subtraction procedures have been performed, the corresponding purity of the original sample, and the \(b\)-jet fraction of the final background-subtracted sample, which should be compatible with one.

The different selections have roughly similar overall performance, with the topological selection giving relatively more jets at high \(E_{T}\), and the kinematic selection more at low \(E_{T}\). All selections allow a sample of several hundred \(b\)-jets to be selected in 100 pb\({}^{-1}\) of data, although the selections of low \(E_{T}\)\(b\)-jets (20-40 GeV) suffer from large backgrounds.

### Comparison of efficiency measurements

The performance of the different \(b\)-tagging efficiency measurements is compared in Table 7, which shows the statistical and significant systematic errors for a true tagging efficiency of 0.6 for all methods. The

Figure 16: Kinematic selection: (Left): The \(b\)-tag weight distribution for the uncorrected sample (unfilled histogram), for the estimated background sample (filled histogram) and the corrected distribution calculated from the difference (data points). Right: The \(b\)-tag weight distribution for the corrected sample (data points) compared with the distribution for true \(b\)-jets (histogram). Both plots are normalised to 100 pb\({}^{-1}\), but use 967 pb\({}^{-1}\) of simulated data.

\begin{table}
\begin{tabular}{l|c c c|c} \hline Jet \(E_{T}\) & Selected & Effective & Purity & Estimated \(b\) \\ range (GeV) & jets & jets & (\%) & flavour purity (\%) \\ \hline Topological & & & & \\
20â€“40 & 144 & 51 & 54 & \(99\pm 8\) \\
40â€“80 & 340 & 189 & 67 & \(92\pm 3\) \\
80â€“120 & 223 & 138 & 78 & \(98\pm 3\) \\
120â€“160 & 122 & 92 & 84 & \(98\pm 3\) \\
160â€“200 & 75 & 54 & 86 & \(108\pm 4\) \\ \hline
40â€“200 & 819 & 515 & 60 & - \\ \hline Likelihood & & & & \\
20â€“40 & 52 & 24 & 47 & \(86\pm 6\) \\
40â€“80 & 225 & 130 & 58 & \(94\pm 3\) \\
80â€“120 & 204 & 143 & 70 & \(97\pm 3\) \\
120â€“160 & 110 & 91 & 83 & \(89\pm 3\) \\
160â€“200 & 54 & 40 & 73 & \(104\pm 5\) \\ \hline
40â€“200 & 593 & 403 & 68 & - \\ \hline Kinematic & & & & \\
20â€“40 & 164 & 102 & 53 & \(74\pm 6\) \\
40â€“80 & 284 & 182 & 73 & \(93\pm 4\) \\
80â€“120 & 113 & 78 & 88 & \(107\pm 5\) \\
120â€“160 & 38 & 30 & 90 & \(103\pm 5\) \\
160â€“200 & 17 & 13 & 94 & \(107\pm 6\) \\ \hline
40â€“200 & 451 & 302 & 79 & \(98\pm 3\) \\ \hline \end{tabular}
\end{table}
Table 6: Summary of \(b\)-jet selection method performance, showing the number of selected \(b\)-jets, the number of jets after background subtraction, the selected sample purity, and estimated \(b\)-jet purity of the final sample after background subtraction, for each selection method. The results correspond to 100 pb\({}^{-1}\) of MC@NLO \(t\bar{t}\) Monte Carlo plus backgrounds from \(W\)+jets, \(Wb\bar{b}\), \(Wc\bar{c}\) and single top production.

systematic errors have been evaluated as discussed in [2] and Section 2. The differences in systematic uncertainties reflect the different uses made of Monte Carlo information by the various methods. The expected statistical errors for other tagging efficiencies, and the simpler IP2D tagging algorithm, are shown (where available) in Table 8.

With 100 pb\({}^{-1}\) of data, the counting method can measure the overall \(b\)-tagging efficiency to a precision of better than 5 %, and, particularly as the luminosity increases through 200 pb\({}^{-1}\) several alternative approaches are possible that also enable the efficiency dependence on other variables (_e.g._ jet \(E_{T}\)) to be studied.

## 6 Optimisation of \(b\)-tagging for \(t\bar{t}\) events

The ATLAS multivariate \(b\)-tagging algorithms rely heavily on likelihood reference distributions for light- and \(b\)-quark jets derived from Monte Carlo simulation. The default reference distributions are produced using a mixture of physics processes. In principle, using reference histograms from Monte Carlo \(t\bar{t}\) events alone could lead to an improvement in tagging performance on \(t\bar{t}\) events. The selection of a pure sample of \(b\)-jets from \(t\bar{t}\) data offers an opportunity to tune the \(b\)-tagging algorithms directly on data,

\begin{table}
\begin{tabular}{l|c c|c c c} Systematic & \multicolumn{2}{c|}{Counting} & \multicolumn{2}{c}{Topological} & Likelihood & Kinematic \\  & lepton+jet & dilepton & & & \\ \hline Light jets and \(\tau\) & 0.1 & 0.7 & 0.5 & 5.2 & 0.6 \\ Charm jets & 0.0 & 0.8 & 0.7 & 4.6 & 2.2 \\ Jet energy scale & 0.9 & 0.5 & 0.5 & 2.5 & 1.1 \\ \(b\)-jet labelling & 1.4 & 1.4 & - & - & - \\ MC generators & 0.1 & 2 & 0.2 & 5.9 & 5.5 \\ ISR/FSR & 2.7 & 2 & 1 & 2.2 & 0.5 \\ \(W\)+jet background & 1.2 & 0.3 & 2.8 & 9.6 & 0.3 \\ Single top background & 0.1 & 0.1 & 1.2 & - & 1.2 \\ Top quark mass & 0.3 & 0.5 & - & 4.1 & - \\ \hline Total systematic & 3.4 & 3.5 & 3.4 & 14.2 & 6.2 \\ \hline Statistical (100 pb\({}^{-1}\)) & 2.7 & 4.2 & - & 5.0 & 7.7 \\ Statistical (200 pb\({}^{-1}\)) & 1.9 & 3.0 & 6.4 & 4.4 & 5.5 \\ \hline \end{tabular}
\end{table}
Table 7: Summary of systematic and statistical uncertainties on the measurement of the \(b\)-tagging efficiency at a true efficiency of \(\varepsilon_{\text{true}}=0.6\), for the counting method in lepton+jets and dilepton channels, and the topological, likelihood and kinematic jet selection methods. The uncertainties are expressed as relative errors (in %).

\begin{table}
\begin{tabular}{l c|c c|c c} Tag & \(\varepsilon_{\text{true}}\) & \multicolumn{2}{c|}{Counting} & \multicolumn{2}{c}{Topological} & Likelihood & Kinematic \\  & lepton+jet & dilepton & & & \\ \hline IP3D+SV1 & 0.5 & 2.8 & 4.0 & 6.2 & 8.8 & 6.1 \\ IP3D+SV1 & 0.6 & 1.9 & 3.0 & 6.4 & 5.2 & 5.5 \\ IP3D+SV1 & 0.7 & 1.4 & 2.0 & 6.7 & 5.1 & 4.9 \\ \hline IP2D & 0.5 & & & 7.4 & 4.7 & 6.2 \\ IP2D & 0.6 & & & 6.5 & 5.1 & 5.5 \\ IP2D & 0.7 & & & 5.6 & 5.1 & 5.0 \\ \hline \end{tabular}
\end{table}
Table 8: Expected statistical errors (relative errors in %) on the \(b\)-tagging efficiency for 200 pb\({}^{-1}\) measured using each technique, for IP3D+SV1 and IP2D taggers at various working points.

reducing the dependence on Monte Carlo simulation. Both these topics are discussed below.

### Using \(t\bar{t}\) specific reference histograms

For this study, reference histograms based only on \(t\bar{t}\) events (without the light jet purification procedure which discards light jets biased by nearby \(b\)-jets [6]) were created using a total of 250k events. By contrast, the default reference histograms were produced using a variety of physics processes, light jet purification, as well as different versions of the detector geometry, simulation, and reconstruction. The following comparison does not attempt to disentangle the various effects of those differences; for more details, see [6]. The resulting \(t\bar{t}\) event \(b\)-tagging weights are compared to those calculated using the default reference histograms, for the IP3D+SV1 \(b\)-tagging algorithm with the default tower-based Cone jet algorithm with \(\Delta R=0.4\). The results are shown in Fig. 17. The left plots shows the \(b\)-tagging weights for \(b\)-jets and light jets calculated with both sets of reference histograms.

The weights for both \(b\)-jets and light quark jets calculated with the top sample reference histograms are on average smaller than those from the default reference histograms. However, because the \(b\)-tagging weights are smaller for both \(b\)-jets and light jets, the performance should not change significantly. This is confirmed by the right plot in Fig. 17, showing the \(b\)-tag efficiency \(vs\) the light jet rejection. Within the statistical uncertainty there is no difference in the performance. So there appears to be no significant advantage in using special dedicated \(t\bar{t}\) reference histograms when applying \(b\)-tagging to \(t\bar{t}\) events.

### Calibrating \(b\)-tagging using data

In principle, the \(b\)-jet selection methods discussed in Section 5 should allow the reference distributions for \(b\)-jets in \(t\bar{t}\) events to be determined directly from data, removing the need for Monte Carlo \(b\)-jets completely. However, none of the methods produce a pure \(b\)-jet sample without the need for background subtraction, and hence do not identify a pure sample of \(b\)-jets from which multiple variables (and their correlations) can be extracted simultaneously on a jet-by-jet basis. Instead, background-subtracted distributions are produced. These can be used directly as reference distributions only for one-dimensional likelihoods with a single input variable. For \(n\)-dimensional likelihoods (for example the standard tagging weight which is a two-dimensional combination of IP3D and SV1 taggers), an \(n\)-dimensional background-subtracted distribution would be needed in order to properly model both the two input distributions and their correlation. For higher-dimensional distributions, the required data statistics

Figure 17: Comparison of b tagging weights and b tag performance using default and special top sample reference histograms.

would quickly become prohibitive.

At least for initial data, a more feasible approach would be to use the background-subtracted \(b\)-jet samples to check each of the likelihood input variables individually, to determine how well the Monte Carlo simulation models the data. Monte Carlo would then be used to form the likelihood reference distributions as before (including correlations between input variables), with the comparison with data being used to assess systematic uncertainties, _e.g._ by reweighting Monte Carlo events to more precisely follow the data distributions if discrepancies are seen.

This technique is illustrated in Fig. 18, which shows background-subtracted distributions of five variables related to the \(b\)-tagging weight computation, derived from the \(b\)-jet sample selected using the topological technique of Section 5.1, compared to the true distributions from Monte Carlo. The integrated luminosity is 948 pb\({}^{-1}\). The first two variables are IP3D, the weight derived from the 3D-impact parameters of all tracks in the jet; and SV1, the weight derived from the SV1 secondary vertex reconstruction algorithm. The others are all input variables used to form the SV1 secondary vertex weight: N2Track, the number of two-track vertices found; SVMass, the mass of the reconstructed secondary vertex, and SVEFrac, the energy fraction of the jets associated to the vertex. The spikes around zero for these last three variables correspond to jets where no secondary vertex was found. The variables have been transformed linearly onto the range [0,1] to simplify the subtraction procedure.

It can be seen that the background-subtracted distributions are consistent with the Monte-Carlo truth, demonstrating the validity of the method. It would be straightforward to construct reweighting factors from these distributions, to explore possible systematic variations. However, it should also be noted that the techniques discussed in Section 5.5 already allow the \(b\)-tagging efficiency to be measured with minimal dependency on the Monte Carlo--the main use of this technique would then be to understand how to improve the Monte Carlo simulation of \(b\)-jets, which could help to increase the \(b\)-tagging performance in \(t\bar{t}\) events by giving each variable its optimal weight in the likelihood.

## 7 Conclusions

The studies of jet reconstruction presented above show that the \(b\)-jet energy resolution in \(t\bar{t}\) events is not very sensitive to the jet algorithm and parameters chosen. The jet angular resolution is more sensitive, degrading in particular with large jet cone sizes.

With 100 pb\({}^{-1}\) of data, several methods are available to make useful measurements of the \(b\)-tagging efficiency in \(t\bar{t}\) events. The tag counting method can reach an overall relative precision of around 5 %, in both lepton+jets and dilepton channels. However, this method only gives an 'integrated' measurement, valid for the \(E_{T}\) and \(\eta\) distribution of \(b\)-jets selected by the \(t\bar{t}\) event selection. Monte Carlo techniques would have to be used to extrapolate this measurement for other jet \(E_{T}\) and \(\eta\) distributions, perhaps also incorporating information derived from studies of dijet samples [1].

Other techniques, based on the topology and kinematics of \(t\bar{t}\) events, can be used to select a sample of jets enriched in \(b\)-flavour, which can then be used to measure the \(b\)-tagging efficiency as a function of other variables. This requires that the remaining non-\(b\) background in the selected jet samples be estimated and removed, and a variety of techniques are available for doing that, based either on data or Monte Carlo. These techniques are less statistically powerful than the tag counting method, achieving overall \(b\)-tagging uncertainties of around 10 % with 100 pb\({}^{-1}\), but will become increasingly powerful as more data becomes available.

Calibrating the \(b\)-tagging likelihood reference distributions from Monte Carlo \(t\bar{t}\) events rather than the generic event mixture used by default does not significantly affect the performance of the standard algorithms, which demonstrates the robustness of the \(b\)-tagger. On the other hand, the \(b\)-jet selection methods discussed above also allow reference distributions from \(t\bar{t}\) data to be obtained; with moderate integrated luminosity these are likely to be more useful to cross-check the Monte Carlo description of Figure 18: Background-subtracted \(b\)-tagging variable distributions derived from the \(b\)-jet sample selected by the topological method, with \(948\,\mathrm{pb}^{-1}\) of simulated \(t\bar{t}\) plus background data. The derived distributions are shown by the points with error bars, and the Monte Carlo truth for an unbiased sample of \(b\)-jets is shown by the solid histograms.

likelihood input variables rather than as a direct input to \(b\)-tag calibration.

## References

* [1] ATLAS Collaboration, '\(b\)-Tagging Calibration with Jet Events', this volume.
* [2] ATLAS Collaboration, 'Top Quark Physics', this volume.
* [3] ATLAS Collaboration, 'Cross-Sections, Monte Carlo Simulations and Systematic Uncertainties', this volume.
* [4] ATLAS Collaboration, 'Determination of the Top Quark Pair Production Cross-Section', this volume.
* [5] ATLAS Collaboration, 'Triggering Top Quark Events', this volume.
* [6] ATLAS Collaboration, '\(b\)-Tagging Performance', this volume.
* [7] S.D. Ellis, J. Huston, K. Hatakeyama, P. Loch and M. Toennesmann, Jets in Hadron-Hadron collisions, 18th October 2007.
* [8] R. Seuster, Hadronic Calibration of the ATLAS Calorimeter, proceedings of the CALOR 2006 conference.
* [9] S. Sorgensen, Jet Reconstruction and Calibration in the ATLAS Calorimeters, proceedings of the CALOR 2006 conference.
* [10] ATLAS Collaboration, 'Jets from Light Quarks in \(\mathrm{t\bar{t}}\) Events', this volume.
* [11] S. Snyder, Measurement of the top quark mass at DO, FERMILAB-THESIS-1995-27.