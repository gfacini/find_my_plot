# Automatic Synchronization of Drift-Time Spectra and Maximum Drift-Time Measurement of an MDT

Oliver Kortner and Felix Rauscher

Ludwig-Maximilians-Universitat Munchen

Am Coulombwall 1

D-85748 Garching

Germany

###### Abstract

A method for the reliable automatic synchronization of the drift-time spectra of ATLAS monitored drift-tubes and for the determination of the maximum drift-time is presented. The Fermi function for the measurement of the maximum drift time has been adapted to the particular shape of the drift-time spectrum characteristic for Ar:CO\({}_{2}\)(93:7) at 3 _bar_ which is used in the ATLAS muon chambers.

## 1 Introduction

The monitored drift tubes used in the ATLAS muon spectrometer measure the time interval \(\tau_{d}\) between the passage of a muon through the tube and the instance of time when the electrons which are the ionization product of muon-atom collisions in the gas arrive at the anode wire of the tube. This drift time \(\tau_{d}\) is a strictly monotone function of the distance \(r\) of the muon track from the wire. In practice, \(\tau_{d}\) is not measured directly, but the time interval

\[\tau_{m}:=t_{\mu}+\tau_{d}+\tau_{\mu,electronics}-t_{trig}, \tag{1}\]

where \(t_{\mu}\) is the time when the muon hits the tube, \(t_{trig}\) the time when the trigger gives the start pulse of the TDC connected to the tube, and \(\tau_{\mu,electronics}\) is the propagation time of the MDT signal. The term \(t_{\mu}+\tau_{\mu,electronics}-t_{trig}\) is the same for all events. It can, however, slightly differ from tube to tube. It defines the position of the drift-time spectrum of the tube with respect to the event time.

If the temperature, the pressure, and the gas mixture are the same in all drift tubes of a muon chamber, they have the same r-t relation after their drift timespectra have been synchronized. In the present article, we describe an algorithm which allows a _reliable automatic_ synchronization of the spectra. We will use the leading edge of the drift time spectrum to match the spectra. Our algorithm also enables us to measure the length of the drift time spectra. The length of the spectrum is a very useful quantity, as differences in the lengths from tube to tube indicate a different operational behavior of tubes.

## 2 Phenomenological Parameterization of the

Rising and Falling Edge of the

Drift-Time Spectrum

Figure 1 shows the typical drift-time spectrum of a uniformly illuminated MDT of 3 _cm_ diameter filled with Ar:CO\({}_{2}\) (93:7) at 3 _bar_ absolute pressure and 3080 \(V\) operating voltage. The data presented in figure 1 were obtained with the MPI BOS prototype chamber in the CERN H8 beam in September 1999.

At zero drift time we see a sharp rise and, at 700 \(ns\) drift time, a fall-off, which is less steep than the rise because of the inefficiency of the tube at its wall.

We will use the step at the beginning of the drift time spectrum to synchronize the drift time spectra in a chamber. For a tube with perfect resolution the rising edge of the spectrum would have infinite slope and the initial part of the spectrum would be a step function. The resolution of the drift tube makes this rise finite. This smeared out step can quite well be described by a Fermi function \(F\),

\[F(t):=\frac{A_{0}}{1+e^{-\frac{t-t_{0}}{T_{0}}}}; \tag{2}\]

Figure 1: Drift-time spectrum of a drift tube filled with Ar:CO\({}_{2}\) (93:7) at 3 bar absolute pressure.

[MISSING_PAGE_EMPTY:3]

### Determination of the Fit Area and Calculation of the fixed Parameters

The areas which have to be selected are shown in figure 3. The fitted functions are approximately flat in the \(p_{0}\), \(A_{0}\), and \(p_{m}\) region and the function values are approximately the corresponding parameters. Therefore the mean of the bin contents in the corresponding regions is the best value for the parameters. In the region used for the determination of the parameters \(A_{m}\) and \(\alpha_{m}\) the fitted function approximates a line with these two parameters as its intersection and slope. To determine these parameters one puts a line to the spectrum in this region.

The fits are performed inside the areas marked with "\(t_{0}\) fit" and "\(t_{max}\) fit".

#### 3.1.1 The Variable Bin Width Histogram (VBH)

The pattern recognition is based on the concept of bins with equal content [3]. We will refer to that by the term "variable bin width histogram(VBH)". This histogram has a fixed number of entries (bin content) in each histogram bin. The

Figure 2: Typical fits of the leading and falling edge of the drift-time spectrumdensity of the data is represented by the width of the bin. Wide bins correspond to a low density and small bins to a high density.

It is known, that in a conventional histogram the binning should be chosen such that each bin has a certain minimum number of entries per histogram bin. A binning that is to fine, leads to a high statistical fluctuation for the number of entries in each bin, and a binning that is too coarse results in a bad resolution. The VBH performs the task of finding the ideal binwidth automatically, and for each region of the histogram seperately.

As the TDC-data comes already binned due to the digitization, and as one wants a unique assignment of a hit to a VBH-bin, the bin content has to be set higher than the biggest number of entries in a TDC-bin. The pattern recognition relies on the bin content being two times the content of the highest TDC-bin.

As the background is hopefully low, the first bin tends to cover not only the complete \(p_{0}\) area, but also part of the rising edge of the spectrum. This would prevent the pattern recognition from finding the \(p_{0}\) area. The same goes for the \(p_{m}\) area. Therefore we impose a maximum bin width. This setting is one of the values which has to be tuned to the properties of the detector gas, the tube

Figure 3: Relevant areas of the spectrum

diameter, and the TDC-digitization. In our case we use a maximum bin width of \(20ns\) for the \(t_{0}\) fit and \(40\ ns\) for the \(t_{max}\) fit.

For our one-dimensional problem the creation of this histogram is quite simple. The TDC entries are sorted by the time value. The start of the lowest VBH bin is the lowest TDC value. One walks through the sorted hits. The algorithm for creating the VBH is shown in figure 4.

In figure 5 the areas which are important for the pattern recognition are shown magnified. In addition to the spectrum in TDC-binning the bin width of the VBH histogram is shown.

#### 3.1.2 Selection of the Areas

In the upper left magnification in figure 5 one can see that the start of the slope lies in the last VBH bin which has the maximum bin width. The left border of this bin is the right border of the \(p_{0}\) area.

In the plateau region, the bin width of the VBH fluctuates between two values. This is due to the fact that the TDC-data are binned. As we have set the bin content to two times the highest TDC bin, the bin width is either two times or three times the TDC bin width. The principle of the \(A_{0}\) area selection is to select the smallest region which contains all bins which have the smallest bin width. This can lead to problems if the spectrum has spikes. A small modification of this concept makes our algorithm more robust. We sort the VBH bins by size, starting with the smallest. We memorize the width of the fifth of these sorted VBH bin. The \(A_{0}\) area is the smallest area which contains all VBH bins of this size. If the spectrum has no unusual spikes, the memorized width is the smallest bin width, otherwise the spike leads to smaller bins.

In the lower magnification in figure 5 one can see that, after the falling edge, all VBH bins have the maximum bin width. We search for the first VBH-bin which comes after the rising slope of the spectrum, which has the maximum bin width and whose right neighbour also has the maximum bin width.

The right border of this bin is the start of the \(p_{m}\) area. As the background in the left of the spectrum is flat, the \(p_{m}\) region extends to the end of the TDC range.

For the \(\alpha_{m}\)-\(p_{m}\)are a we need the part of the spectrum which decreases approximately linearly. As this area is quite large, the selection can be made quite coarse. The right border is simply set to a fixed distance from the left boarder of the \(p_{m}\) area (usually \(40\ ns\)). Its width is also set to a fixed length (\(400\ ns\) is a good value for Ar:C0\({}_{2}\)).

#### 3.1.3 Calculation of the Parameters

The parameters \(p_{0}\), \(A_{o}\), and \(p_{m}\) are the mean of the TDC-bin-content over the corresponding areas. The parameters \(\alpha_{m}\) and \(A_{m}\) are the result of a linear regression Figure 4: Filling the VBH

Figure 5: The important areas of the spectrum and the binning of the VB H

over the selected region.

### Fitting

The area for the \(t_{0}\) fit consists of the \(p_{0}\) area, the \(A_{0}\) area, and the intermediate region. The combination of the \(\alpha_{m}\)-\(A_{m}\) area, the \(p_{m}\) area and the region in between these is the \(t_{max}\) fit area.

As a start value for \(t_{0}\) and \(t_{m}\) the centers of the regions between the \(p_{0}/p_{m}\) and the \(A_{0}/\alpha_{m},A_{m}\) regions are used. The analytically calculated parameters are fixed. The fit is performed with a fitting package like MINUIT.

For the fit one does not use the VBH histogram, but the original TDC data. This has two reasons. First the maximum bin width does not represent the true density of hits in regions with a low density and second the histogram in TDC binning contains the maximum amount of information.

## 4 Test of the Pattern Recognition and Fitting Procedure

We tested the fit in about 250 cases from Monte Carlo and 50 cases from the MPI BOS prototype chamber acquired at the 1999 test beam in H8. These fits never failed unless the presence of the spectrum could not be seen by eye.

For a more quantitative study we created a big Monte-Carlo sample with 2080000 hits in one tube. We split these hits in two ways. First we made 52 sub-samples with 40000 hits each and second we made 13 subsamples each containing 160000 hits. We let the algorithm run over all these subsamples.

The results for the quantity \(t_{0}\) and the quantity \(t_{0}-2T_{0}\) are shown in figure 6. Here one can also see that the fit never failed as all results were in a \(\pm 3\sigma\) region around the mean of the distribution.

Looking at the RMS of the results one notices that, for 40000 events the fluctuation of \(t_{0}-2T_{0}\) is a little bit and for 160000 events per fit considerably smaller than \(t_{0}\). If one looks at the behavior of these quantities for an increasing statistics one gets the following:

\[\frac{\sigma_{t_{0},4000events}}{\sigma_{t_{0},160000events}}= \frac{0.44}{0.32}= 1.4,\] \[\frac{\sigma_{t_{0}-2T_{0},4000events}}{\sigma_{t_{0}-2T_{0},1600 00events}}= \frac{0.42}{0.20}= 2.1 \tag{5}\]

So \(t_{0}-2T_{0}\) follows the expected \(\frac{1}{\sqrt{N}}\) statistical scaling rule, but not \(t_{0}\).

The reason for this seems to be an uncertainty in the determination of \(A_{0}\). As the corresponding region is not completely flat, and the spectrum drops at both sides of the region, the value strongly depends on the selection of the region. This selection has a low precision.

In figure 7 one sees how \(A_{0}\) influences \(t_{0}\). This figure shows the function \(G\) with two different sets of parameters. They both approximate the same rising edge, but \(A_{0}\) is shifted. As \(t_{0}\) is the value, where

\[G(t=t_{0})-p_{0}=\frac{1}{2}A_{0}, \tag{6}\]

Figure 6: Test results for the \(t_{0}\) fit

Figure 7: Correlations in the Fermi function

\(t_{0}\) will be shifted. But the tangent of \(G\) at \(t=t_{0}\) hardly changes. The point where this line crosses the background level is at \(t=t_{0}-2T_{0}\). Therefore \(t_{0}\) is strongly correlated to \(A_{0}\), while \(t_{0}-2T_{0}\) is not. As \(A_{0}\) is an unstable parameter, \(t_{0}-2T_{0}\) is more stable than \(t_{0}\) for high statistics.

As one has less hits with a high drift time, the values for \(t_{m}\) have a higher RMS. The value corresponding to \(t_{0}-2T_{0}\) in the \(t_{max}\) fit is \(t_{m}+2T_{m}\). As the slope at the end of the spectrum is not well defined due to the low statistic it is not useful to use this value for the synchronisation of drift-time spectra.

## 5 Summary

The use of a pattern recognition using variable bin width histograms not only makes an automatic selection of the fit regions, but enables us to calculate some of the fit parameters analytically. This results in a stable and fully automatic method of synchronizing the spectra and measuring the maximum drift time.

The parameters of the pattern recognition which have to be set, namely the maximum bin width and the widths of some areas, may depend on the TDC properties and the background noise, but are the same for all tubes. So these parameters have to be set only once for a given setup.

For high statistics (more than 40000 hits) the value \(t_{0}-2T_{0}\) is more stable than \(t_{0}\) and therefore more useful for the synchronisation of the spectra.

## Acknoledgement

We would like to thank A. Staude for the fruitful discussion we had with him on our algorithm.

## References

* [1] A. Negri et al., Measurement of the maximum drift time in the Calypso MDT chamber, ATLAS internal note MUON-NO-158, 1997.
* [2] W. T. Eadie et al., Statistical methods in experimental physics, Amsterdam 1971.
* [3] O. Kortner, C. Zupancic, An Algorithm to Bin Multidimensional Event Distributions and the Method of Contrast Enhancement, Munich 2000, to be published.
* The Munich Test-Stand Simulation Programme, ATLAS internal note ATL-MUON-2000-021, 2000.