**ATLAS Internal Note DAQ-NO-017**

**27 December 1994**

**Pattern recognition at the second level muon trigger in the ATLAS barrel region**

Ornella Palamara and Sergio Petrera

Dipartimento di Fisica dell'Universita and INFN, Lecce, Italy

December 27,1994

In this note we describe an algorithm dedicated to the pattern recognition of muon tracks for the second level muon trigger, in the ATLAS barrel region. The algorithm has been implemented in ATRECON in order to study the trigger performances. We show that the method is capable to operate in the high background environment of MDT chambers. Averaging over all the muon chambers the algorithm accepts \(\sim\) 90% of muon hits with a contamination of \(\sim\) 5% of background hits.

## 1 Introduction

The purpose of the Level 2 (LVL2) muon trigger is the identification of the muon hits in MDT's and the accurate calculation of the transverse momentum. In the approach we suggest the trigger algorithm is split in two functions:

1. pattern recognition of muon tracks in MDT's;
2. transverse momentum fit.

In this note we describe only the pattern recognition function of the trigger algorithm. A description of the overall LVL2 muon trigger is given in a separate note [1].

## 2 Strategy of the algorithm

The high background enviroment in MDT chambers (see Fig. 1) imposes that the algorithm must have high capability of rejecting background hits both due to physical activity accompanying the muon track and the other sources of background (described in detail in ref.[2]). For this purpose, the hits from the fast detector of the LVL1 muon trigger (RPC), which have a very low occupancy, are used to initiate the pattern recognition through the calculation of the muon trajectory. This is done using a very simple geometrical model through 3 points. The 3 points are the superpoints (SP1, SP2, SP3) obtained from the RPC hits, in the case of a high p\({}_{T}\) LVL1 trigger. In the case of a low p\({}_{T}\) trigger, where SP3 is not available, the third point is the p-p nominal crossing point O ( see Fig. 2). The trajectory is a circle (through SP1, SP2 and SP3) in the case of a high p\({}_{T}\) trigger (where all the points are in the magnetic field region), whereas is a circle in the spectrometer region + a straight line tangent to the circle, in the region where the toroidal magnetic field is absent (R\(<\)400 cm), in the case of a low p\({}_{T}\) trigger.

This preliminary phase has the main purpose to define regions in the muon chambers ( "muon roads" ), which possibly contain all the muon hits and a minimum contamination of background. Subsequently the algorithm proceeds through the identification of muon hits within the muon roads, taking into account the contiguity of their hit patterns with respect to background.

This method turns out to be simple since it allows to define muon roads based on simple geometrical models, which make no use of the magnetic field map. It is **fast** since the road parameters are obtained through a non-recursive calculation. Finally the pattern recognition is done **at tube level** (i.e. taking into account only the centers of the hit MDT's), eliminating the ambiguity of drift times.

## 3 The simulation environment

In order to study the viability and the performance of this method we have done a simulation work based on the strategy described above.

## 2 The _A_-band (_A_-band) spectrum

Figure 1: Display of the MDT (dots) and RPC (crosses) hits in the middle and outer stations of a typical event. Muon hits are represented as back dots. Physical (dark grey dots) and uncorrelated (light grey dots) backgrounds are included as described in section 3.

Figure 2: Definition of the muon trajectory through three points. The trajectory is a circle through SP1, SP2 (RPC superpoints in the middle station) and SP3 (RPC superpoint in the outer station) in the case of a high p\({}_{T}\) LVl1 trigger, whereas is a circle through SP1 and SP2 and a straight line, tangent to it and originating from the p-p nominal crossing point O, in the case of a low p\({}_{T}\) trigger.

The pattern recognition algorithm has been implemented in ATRECON[3]. To study its performances we generated with DICE[4] single \(\mu^{+}\) data samples in the barrel region (\(|\eta|\)\(<\)1), with transverse momenta:

* 6 GeV/c\(<\)p\({}_{T}\)\(<\)20 GeV/c (low p\({}_{T}\) data sample);
* 6 GeV/c\(<\)p\({}_{T}\)\(<\)100 GeV/c (high p\({}_{T}\) data sample).

We selected the 3-D magnetic field and switched ON the GEANT simulation of the physical processes induced by muons (with cut mostly at 100 KeV). RPC strip size was assumed to be 3 cm, MDT tube diameter 3 cm. The maximum tube drift time is 500 ns[5].

We introduced in ATRECON the simulation of uncorrelated background in muon chambers (randomly extracted over their sensitive areas). Even though current estimates of uncorrelated background rates in the ATLAS barrel region suggest lower values[6], allowing a reasonable safety factor, we assumed a rate of 100 Hz/cm\({}^{2}\) in the whole region. Correlated background, originating from charged particles which cross at least two adjacent chamber layers and producing patterns of correlated hits, has not been considered in this work. The effects of this noise will be studied in further simulation studies, when a modelling of those tracks will be available in ATRECON.

Muon events have been filtered using the LVL1 muon trigger simulation. Two trigger algorithms have been used for this work: 1) the "fake" LVL1 muon trigger[7] and 2) the true LVL1 muon trigger[8]. The "fake" trigger is a simplified emulation of the true trigger, operating at particle level. This means that its logic is only based on coincidences among muon trigger layers and uses the actual p\({}_{T}\) of the simulated muon track. Each trigger is defined by a RoI (Region of Interest) identifier, the RPC hit pattern inside the RoI and the p\({}_{T}\) threshold. The total number of RoI's used in this simulation is 11 (\(\eta\)) \(\times\) 24 (\(\phi\)) with an average (\(\eta\), \(\phi\)) window of 0.18 \(\times\) 0.25.

The results reported hereafter refer to the new layout of the muon spectrometer ('OUTE' 'GEOM' 2, according ATRECON).

## 4 Results from simulation

In order to study the performances of this pattern recognition method, we analysed in the ATLAS (z, R) view, the residuals of the muon chamber hits, with respect to the calculated muon trajectory. As commented above, the algorithm operates at tube level: therefore in what follows we will refer to a _muon chamber hit_ as _the centre of the hit tube_, unregardless of the more accurate information provided by the measured drift time.

Having in mind the high value of the trajectory radius (of the order of 30 m for the lowest p\({}_{T}\)) with respect to the thickness of the muon chambers (ranging from 0.34 to 0.55 m), the muon trajectory inside each chamber can reasonably be represented by a straight line segment. The segment is the chord of the arc obtained intersecting the calculated circle with the crossed muon chamber box. The residuals are then computed as the distance of each hit from the relevant straight segment.

[MISSING_PAGE_FAIL:6]

Figure 3: Correlation between the p\({}_{T}\) estimated from the calculated muon trajectory and the actual p\({}_{T}\).

Figure 4: Distributions of the residuals at geometry level using the “fake” LV L1 muon trigger. Solid histograms: muon hits. Dashed histograms: physical background hits. Mean and r.m.s. refer to muons.

Figure 5: Same as figure 4.

Figure 6: Same as figure 4.

Figure 7: Same as figure 4.

The detector granularity also affects the distribution of the residuals on each muon chamber. In Fig. 8 these distributions are shown in the inner large chamber with (hollow histograms) and without (hatched histograms) RPC granularity are given in the case of the low and high p\({}_{T}\) triggers. From this figure a sensitive increase of the width of the residuals is visible in presence of the detector granularity, with respect to the "perfect" case.

Fig. 8 shows also that the asymmetry of the distributions, due to the magnetic field disuniformity, disappears when the trigger detector granularity is included. We can conclude that the distributions of the residuals are dominated by the detector granularity and therefore _no appreciable improvement of the pattern recognition can be achieved by changing the trajectory model_.

### LVL1 muon trigger simulation

The results presented in the previous subsections have been obtained using the "fake" LVL1 muon trigger to filter the simulated events. This was done for reasons of simplicity, since the "fake" trigger can be viewed as the ideal case of the actual

Figure 8: Comparison between the hit residuals with (hollow histograms) and without (hatched histograms) granularity, using the “fake” LVL1 muon trigger.

trigger. As a matter of fact the "fake" algorithm operates at particle level and _utilizes only the hits generated by muons_. Therefore one can expect that the true LVL1 muon trigger, which obviously does not distinguish among the different sources of the RPC hits, could affect the residual distributions, because of the possibility to generate spurious (i.e. contaminated by background hits) trigger patterns. Fig. 9 shows the distributions of the residuals in the middle large chamber for events filtered with the "fake" (hatched histograms) and true (hollow histograms) LVL1 muon triggers in the case of the low and high \(p_{T}\) triggers. The tails appearing at large absolute values of the residuals, in the case of the true LVL1 muon trigger, can be attributed to triggers contaminated by background hits or possible inefficiencies of the algorithm. On the other hand, one can easily recognize that the overall effect is rather modest, being limited to a fraction of the order of few percent.

### Insertion of the uncorrelated background

As last level of complexity we introduced the simulation of the uncorrelated background in muon chambers (as described in section 3). The distributions of the

Figure 9: Comparison of the hit residuals for events filtered with the “fake” (hatched histograms) and true (hollow histograms) LVL1 muon triggers.

residuals on each muon chamber are given in Figs. 10(12) and 11(13) for the large and small chambers separately, in the case of the low (high) p\({}_{T}\) trigger. The solid histograms refer to muon hits, the physical background is represented by the dashed histograms and the uncorrelated background by the dotted histograms. The sums over all background sources are shown by the dash-dotted histograms.

## 5 Construction of the muon roads

The dependence of the hit residuals on the muon chamber layer allows the calculation of the regions in which the muon hits have to be searched for. The Figs. 10-13 show that, in an interval around zero of the residuals (whose width depends on the muon chamber), the muon hits always emerge over any kind of background hits, with the only exception of the low p\({}_{T}\) trigger in the outer chambers, where the extrapolation of

Figure 10: Distributions of the residuals. Solid histograms: muons. Dashed histograms: physical background. Dotted histograms: uncorrelated background. Dash-dotted histograms: sums over all bkgr sources. True LVL1 muon trigger used to filter events.

Figure 11: Same as figure 10.

Figure 1: Same as figure 10.

Figure 13: Same as figure 10.

[MISSING_PAGE_FAIL:18]

of background hits for each muon hit, for the physical (a) and for the uncorrelated background (b). It can be easily seen that the content of extra hits is small only in the middle chambers (where the RPC hits strongly constrain the muon roads), but is still sizeable in the other chambers, where it can be of the same order of the muon hits or even larger (e.g. in the outer chambers at low p\({}_{T}\)).

## 6. Contiguity algorithm within the muon roads

We have shown in the previous section that inside the muon roads we get, by construction, more than 90% of muon hits and a reduced, even though not negligible, contamination of background hits. This contamination could prevent the correct calculation of the relevant space points to be used in the transverse momentum fit [1], especially in those chambers where wider muon roads are defined. On the other hand, muon hit patterns are considerably different from patterns originating from background, as can be easily recognized in Fig. 14, where the hits produced by the different sources are displayed for a typical event. This figure, referring to an inner chamber in a high p\({}_{T}\) trigger event, shows also the calculated muon trajectory ( solid line) as well as the muon road (dashed lines).

Therefore some contiguity algorithm can be envisaged to drop background hits within the muon roads. The search for contiguous patterns can be approached with several algorithms. In order to understand the viability of this search, we have adopted a very naive scheme aiming to single out contiguous hits by a comparison of the individual residuals with the average value inside the road. The method proceeds through the following steps:

* Removal of spread out hits with respect to contiguous ones. On each muon

\begin{table}
\begin{tabular}{|l|c|c|} \hline  & small chambers & large chambers \\ \hline \hline OUTER & 0.94 & 0.90 \\ MIDLE & 0.93 & 0.92 \\ INNER & 0.94 & 0.93 \\ \hline \end{tabular}
\end{table}
Table 2: Occupancies of **muon** hits (number of hits per layer) within the muon roads

\begin{table}
\begin{tabular}{|l|c|c|} \multicolumn{3}{c}{**Low pt**} \\ \hline  & small chambers & large chambers \\ \hline \hline OUTER & 0.125 & 0.076 \\ MIDDLE & 0.051 & 0.045 \\ INNER & 0.153 & 0.094 \\ \hline \end{tabular}
\end{table}
Table 3: Number of **uncorrelated background** hits for each muon hit

\begin{table}
\begin{tabular}{|l|c|c|} \multicolumn{3}{c}{**Low pt**} \\ \hline  & small chambers & large chambers \\ \hline \hline OUTER & 1.574 & 1.879 \\ MIDDLE & 0.044 & 0.106 \\ INNER & 0.192 & 0.249 \\ \hline \end{tabular}
\end{table}
Table 2: Number of **uncorrelated background** hits for each muon hitchamber the mean value \(<\)\(\Delta res\)\(>\) is computed, averaging the residuals of the hits within the muon road, and the hit with the highest \(|\Delta res\)\(<\)\(\Delta res\)\(>\)\(|\) is dropped. A new \(<\)\(\Delta res\)\(>\) is then obtained. The procedure is re-iterated if the new \(<\)\(\Delta res\)\(>\) is improved, with respect to the previous one, by more than a preset value or the remaining number of hits is greater than 8.
* Selection, on each muon chamber layer, of the hit with \(\Delta res\) nearest to \(<\)\(\Delta res\)\(>\).

At the end of the pattern recognition a "clean" muon track is defined with at most eight hits for each muon chamber.

Table IV shows the occupancies of muon hits, after the contiguity algorithm above described has been applied. Table V gives the number of background hits for each muon hit, for the physical (a) and for the uncorrelated background (b). One can easily recognize the effectiveness of the method being the number of extra hits strongly reduced, down to the level of a few percent.

## 7 Concluding remarks

We propose an algorithm for the pattern recognition of muon tracks in the barrel muon chambers based on the search of muon hits inside pre-defined muon roads and the subsequent identification of contiguous patterns within those roads.

The method is based on a simple geometrical model for the calculation of the trajectory parameters, whose input are the hits in the LVL1 muon trigger chambers. The calculation of such parameters has the merit to be very fast since it uses non-recursive formulae and does not require any knowledge of the magnetic field. The muon road sizes have been calculated simulating with DICE single muon events and processing them with a version of ATRECON, where this pattern recognition code

\begin{table}
\begin{tabular}{|l|c|c|} \multicolumn{3}{c}{**Low p\({}_{\text{T}}\)**} \\ \hline  & small chambers & large chambers \\ \hline \hline OUTER & 0.89 & 0.8l \\ MIDDLE & 0.92 & 0.9l \\ INNER & 0.92 & 0.9l \\ \hline \multicolumn{3}{c}{**High p\({}_{\text{T}}\)**} \\ \hline  & small chambers & large chambers \\ \hline \hline OUTER & 0.89 & 0.89 \\ MIDDLE & 0.92 & 0.9l \\ INNER & 0.90 & 0.89 \\ \hline \end{tabular}
\end{table}
Table IV: Occupancies of muon hits (number of hits per layer) after the contiguity algorithm 

\begin{table}
\begin{tabular}{|l|c|c|} \multicolumn{3}{c}{**Low pt**} \\ \hline  & small chambers & large chambers \\ \hline \hline OUTER & 0.009 & 0.007 \\ MIDDLE & 0.006 & 0.005 \\ INNER & 0.005 & 0.005 \\ \hline \end{tabular}
\end{table}
Table V: Number of **uncorrelated background** hits for each muon hit

\begin{table}
\begin{tabular}{|l|c|c|} \multicolumn{3}{c}{**Low pt**} \\ \hline  & small chambers & large chambers \\ \hline \hline OUTER & 0.109 & 0.151 \\ MIDDLE & 0.007 & 0.016 \\ INNER & 0.020 & 0.030 \\ \hline \end{tabular}
\end{table}
Table VI: Number of **uncorrelated background** hits for each muon hit

\begin{table}
\begin{tabular}{|l|c|c|} \multicolumn{3}{c}{**Low pt**} \\ \hline  & small chambers & large chambers \\ \hline \hline OUTER & 0.009 & 0.007 \\ MIDDLE & 0.006 & 0.005 \\ INNER & 0.005 & 0.005 \\ \hline \end{tabular}
\end{table}
Table V: Number of **uncorrelated background** hits for each muon hitFigure 14: Enlarged view around the muon track of the middle station. The dashed segments define the muon road, the muon trajectory is given by the solid line. MDTs hit by the muon are represented as black circles. White (grey) circles refer to physical (uncorrelated) background hits.

has been implemented. The hits contained in the muon roads are predominantly originating from muons, even though the contribution of background can be not negligible in some regions. Applying a search for contiguous patterns inside the muon roads it is possible to strongly reduce such background down to acceptable levels.

Averaging over all the different muon chambers the pattern recognition algorithm turns out to accept \(\sim\) 90% of muon hits with a contamination of \(\sim\) 5% of background hits.

## References

* [1] G. Ambrosini et al, ATLAS Int. Note MUON-NO-061 (1994).
* [2] ATLAS Int. Note MUON-NO-042 (1994).
* ATLAS software group.
* ATLAS software group.
* [5] ATLAS Int. Note MUON-NO-044 (1994).
* [6] G. Battistoni et al., ATLAS Int. Note MUON-NO-052 (1994); G. Battistoni et al., ATLAS Int. Note MUON-NO-060 (1994).
* [7] O. Palamara, "Fake" level 1 muon trigger, ATLAS Trigger meeting, CERN, March 25, 1994.
* [8] A. Nisati al., ATLAS Int. Note DAQ-NO-038 (1994).