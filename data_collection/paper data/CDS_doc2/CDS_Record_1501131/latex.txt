[

###### Abstract

This document is a "User's Guide and tutorial" for the PERSINT interactive detector, magnetic field, and event visualization program developed for the ATLAS collaboration. The program is well suited for event scanning and for analyzing complicated events in their most intricate detail.

1
Footnote 1: This paper is dedicated to the memory of Marc Virchaux (1953-2004), the author of the original software.

2

[.5cm] **PERSINT**

**Event Display for ATLAS**

User's Manual and Tutorial

[.5cm] Chevalier, L., Ernwein, J., Formica, A., Giraud, P-F.,

Laporte, J-F., Ouraou, A., Sizun, P., Virchaux, M. 1

Footnote 1: This paper is dedicated to the memory of Marc Virchaux (1953-2004), the author of the original software.

[.5cm] Irfu, CEA Saclay

[.5cm]

[MISSING_PAGE_EMPTY:2]

[MISSING_PAGE_EMPTY:3]

**This paper is dedicated to the memory of Marc Virchaux (1953-2004), the author of this software.**

Comments to:

laurent.chevalier@cea.fr

jean.ernwein@cea.fr

patrick.sizun@cea.fr

## History

\begin{tabular}{|l|l|l|l|} \hline
**Date** & **Version** & **Comments** & **Persint version** \\ \hline \hline
30/10/2009 & V-4.0.3 & Draft version (incomplete) & Persint-00-01-24 \\ \hline
20/11/2009 & V-4.0.4 & Draft version (incomplete) & Persint-00-01-29 \\ \hline
17/12/2009 & V-4.0.5 & Draft version (incomplete) & Persint-00-01-36 \\ \hline
15/01/2010 & V-4.1 & First complete version & Persint-00-01-41 \\ \hline
19/03/2010 & V-4.2 & Computation of invariant masses & Persint-00-01-46 \\  & & + minor corrections & \\ \hline
09/04/2010 & V-4.3 & - Export as.ps and.pdf & Persint-00-01-53 \\  & & - New feature: Save Special...: Compare geometries & \\  & & - Improved Captions & \\ \hline
19/06/2010 & V-4.3.1 & - Study of geometry and material & Persint-00-01-63 \\  & & - Improved labels and captions & \\  & & - Display vertices; 2 track shapes: ribbon, cylinder & \\  & & - Display magnetic field map & \\ \hline
19/08/2010 & V-4.3.2 & - A-lines (alignment) downloaded for each event & Persint-00-01-68 \\  & & - Histogram of \(d0\) distribution & \\  & & - Spinbox added for easy numerical settings & \\ \hline
22/10/2010 & V-4.3.3 & - Modified interface with MuonBoy & Persint-00-01-75 \\  & & - Fully implement "Preferences" menu & \\  & & - Python script available in /Persint-00-02-**/example & \\  & & for generating an OutMboyView file from ESDs & \\  & & - Updated TRT description & \\  & & - Download magnetic field maps from the Internet & \\ \hline
29/01/2011 & V-4.4 & Direct access to User Manual & Persint-00-01-83 \\  & & Clean up field maps + Display Muonboy error messages & \\  & & Histogram of integral \(\int Bdl\) & \\  & & Full-screen mode + Edit color of selected volumes & \\  & & Select particular sectors for display in an event & \\ \hline
09/03/2011 & V-4.5 & Added 1D plots of magnetic field & Persint-00-01-92 \\  & & Redesign track selection user interface & \\  & & Multi-user installation & \\  & & Appendix B rewritten (Installation) & \\  & & Optional disabling of Log console & \\ \hline
15/04/2011 & V-4.6 & Selection of solenoidal field map & Persint-00-01-98 \\  & & Redesign Generate Muons window & \\  & & 1D plots of \(\int Bdl\) & \\ \hline
14/10/2011 & V-4.7 & Added German and Italian versions of GUI & Persint-00-02-27 \\  & & Map of \(X_{0}\); map of "expected number of stations" & \\  & & Export map data as ASCII file; switch lin/log scale & \\  & & Additional AGDD/XML shapes & \\ \hline \end{tabular}

The pdf version of this manual can be found at:

[https://twiki.cern.ch/twiki/pub/Atlas/Persint2Wiki/PERSINT2_Manual.pdf](https://twiki.cern.ch/twiki/pub/Atlas/Persint2Wiki/PERSINT2_Manual.pdf)

###### Contents

* 1 Main features of Persint
* 2 Architecture
* 3 Installation on supported platforms
* 4 Starting Persint
* 5 The Graphic User Interface
	* 5.1 Items of the Graphic User Interface
	* 5.2 Online help
	* 5.3 Toolbars or Menus?
* 6 Exercise 1: Setting the stage
	* 6.1 Necessary files
		* 6.1.1 Detector description and magnetic field
		* 6.1.2 "Example" files for Event 4023
	* 6.2 Interfaces to applications
	* 6.3 Displaying detector layouts and events
	* 6.4 Save, Export, and Print views
	* 6.5 Dressing the display with captions, logos, and pictures
* 7 Exercise 2: Muon tracks in your own layout
	* 7.1 Generate muon tracks at the IP
	* 7.2 Display the detector using the AMDB interface
		* 7.2.1 Draw MDT muon chambers
		* 7.2.2 Draw RPC muon chambers
		* 7.2.3 Draw Inner Detector
		* 7.2.4 Optimizing the view: a first try at navigation
		* 7.2.5 Starting anew
	* 7.3 Place the calorimeters
	* 7.4 Save files for future use
	* 7.5 Place inert material using the AGDD interface
	* 7.6 The Dead material function
		* 7.6.1 Preparing the working view
		* 7.6.2 Use of the Dead material function
	* 7.7 Look at the event in detail
		* 7.7.1 Show ATLAS coordinate system
		* 7.7.2 View the event in the X-projection
		* 7.7.3 Zoom-in on muon chambers
* 8 Exercise 3: Practicing Navigation
	* 8.1 Preparing the working view
	* 8.2 The Default mode: a magic wand
	* 8.3 Single functions
	* 8.4 More functions
* 9 Exercise 4: Exploring more features
	* 9.1 Volume information labels
		* 9.1.1 Volume identification with information boxes
		* 9.1.2 Label maker
	* 9.2 Hide/Displace volumes or super-volumes
		* 9.2.1 Hide volumes
		* 9.2.2 Hiding volumes, the fast way
		* 9.2.3 Displacements of volumes
	* 9.3 Compare geometries
	* 9.4 Detect volume clashes
	* 9.5 Animation
	* 9.6 Wire mode
	* 9.7 Magnetic Field Interface
		* 9.7.1 Loading a Magnetic Field file
		* 9.7.2 Display B-field lines
		* 9.7.3 Display B-field maps
	* 9.8 \(X_{0}\) map: Distribution of material
	* 9.9 Map of the expected number of crossed muon stations
* 10 Exercise 5: ATLAS Physics Events (1)
	* 10.1 Input files
		* 10.1.1 Files loaded by the user
		* 10.1.2 Event dependent files
	* 10.2 Display physics events
	* 10.3 Select Sectors to be displayed
	* 10.4 Select minimum number of hits
	* 10.5 Dressing the event
	* 10.6 Save the view
	* 10.7 Changing the event file
	* 10.8 Scanning events
		* 10.8.1 Manual scanning
		* 10.8.2 Automatic scanning
		* 10.8.3 Visualization properties
		* 10.8.4 Using 2D projections
* 11 Exercise 6: ATLAS Physics events (2)
	* 11.1 Muon spectrometer data
		* 11.1.1 ATHENA reconstructed segments and tracks
		* 11.1.2 Simulated muon tracks
		* 11.1.3 Reconstructed muon tracks and invariant mass
		* 11.1.4 Interactive reconstruction with Muonboy
		* 11.1.5 Color code for MDT hits
	* 11.2 Inner Detector data and Vertex display
		* 11.2.1 Vertex display
		* 11.2.2 Histogram of \(d0\) (primary vertex)
	* 11.3 Calorimeter data
		* 11.3.1 Display calorimeter hits
		* 11.3.2 Display calorimeter hits with increased thresholds
		* 11.3.3 Histogram of calorimeter hits
	* 11.4 Physics objects
		* 11.4.1 Jets
		* 11.4.2 Missing \(E_{T}\)
		* 11.4.3 RoI (Regions of Interest from trigger)
* 12 **Persint: a versatile tool*
	* 12.1 An analysis tool
	* 12.2 Study of the geometry and dead material
* 13 **Selected event displays*
* 14 **Useful hints**

## 15 Appendices

* A Architecture
* B Installation and dependencies
* B.1 Supported platforms
* B.2 Installation
* B.2.1 Tarball (default procedure)
* B.2.2 svn
* B.2.3 Ubuntu package
* B.2.4 Pre-installed lxplus version
* B.3 Dependencies
* B.3.1 Mandatory requirements
* B.3.2 Optional features
* B.4 Platform-specific instructions
* B.4.1 Mac OS X
* B.4.2 CernVM
* B.4.3 Cygwin
* C ATLAS coordinate system
* D Files used in Persint
* D.1 File formats
* D.2 Directories for Persint files
* D.3 File description
* D.3.4 amdb_simrec.xxx
* D.3.5 Bmagatlas
* D.3.6 Description of the Out.MboyView ASCII event file readable by PERSINT
* D.3.7 Out.MboyView_Zmumu4023
* E Menu items
* E.1 File menu
* E.2 Image menu
* E.3 Navigation menu
* E.4 Volumes menu
* E.4.1 xml description of AGDD files
* E.4.2 Subroutine used for creating volumes
* E.5 Events menu
* E.5.1 Set track parameters window
* E.6 Tools menu
* E.7 Window menu
* E.8 Help menu
* E.9 persint menu (Mac OS only)
* E.10 Warning messages
* F Right-click* G Producing Event files for Persint in ATHENA G.1 Event files from raw data G.2 Event files from ESDs or dESDs G.2.1 Procedure G.2.2 Limitations G.2.3 ATHENA job options file, an example: MboyViewESD.pyList of Figures
* 1 Various views of a Persint display
* 2 Layout of the Persint display window
* 3 Online information boxes
* 4 Data manager: Volume tab
* 5 Data manager: Magnetic field tab
* 6 Magnetic field wizard (1)
* 7 Magnetic field wizard (2)
* 8 Data manager: Events tab
* 9 Warning issued by Persint
* 10 Set track parameters window
* 11 Resulting display of the exercise in section 6.3
* 12 The Specific edge color function and Persint logo of the Image menu.
* 13 The Anti-aliasing function of the Image menu
* 14 Warning issued when using the Save special function
* 15 Add caption window. The last 3 paragraphs are the Default caption when an Event is displayed
* 16 Add picture window
* 17 The four flavors of the ATLAS logos.
* 18 Inserting captions, logos and pictures
* 19 Pop-up window for muon track generation
* 20 Using the Octant and Z-half selectors of the AMDB interface
* 21 Illustration for exercise 2 (1)
* 22 Illustration for exercise 2 (2)
* 23 Illustration for exercise 2 (3)
* 24 The function: Use all dead matter/Use displayed dead matter only
* 25 Projected 2D view for exercise 2
* 26 Selections made in the Option tabs in the Selector window
* 27 Resulting X-view from manipulations in section 7.7.3.
* 28 Spinbox navigation scale
* 29 Additional selections made in the Selector window
* 30 Detector layout resulting from the additional selections made in Exercise 3
* 31 Defining the viewing perspective
* 32 Making a Default label
* 33 Making a Customised label
* 34 Custom label for an endcap MDT chamber
* 35 Hiding volumes and super volumes
* 36 Pop-up window showing displaced volumes
* 37 Selected volumes window
* 38 Modify volume window
* 39 Two "feet geometries" to be compared.
* 40 Displayes used for detecting clashes
* 41 Rotate EOL chamber by 6\({}^{\circ}\)
* 42 Compare clashes for two geometries
* 43 Generating animation window
* 44 Partial Wire Mode switched on.
* 45 Displaying the magnetic field lines
* 46 Displaying the magnetic field map (1)
* 47 Displaying the magnetic field map (2)
* 48 Displaying the magnetic field map (3)
* 49 Displaying the magnetic field map (4)* 50 Displaying the magnetic field map (5)
* 51 Map of the field integral \(\int Bdl\): selections for 2-D
* 52 Map of the field integral \(\int Bdl\): selections for 1-D
* 53 Map of the field integral \(\int Bdl\)
* 54 Displaying the map of \(X_{0}\)
* 55 Displaying the map of the Number of expected stations
* 56 Event 4023, display (1)
* 57 How to select the sectors to be displayed in an event.
* 58 Event 4023, display (2), resulting from the selection of two sectors.
* 59 Alternate method for selecting sectors for display
* 60 Event 4023, display (3)
* 61 Modifications made in the Selector window.
* 62 Final display of Event 4023
* 63 Warnings issued by Persint about loading the proper files.
* 64 "Default" files and "Current" files being used by Persint.
* 65 Various views of Event 3998
* 66 Events 3998 & 4000
* 67 X-projection of scanned events
* 68 Event 4023 (first pass)
* 69 Event 4023 (second pass)
* 70 Event 4023 (third pass)
* 71 Event 4023 (fourth pass)
* 72 Event 4023 (fifth pass)
* 73 Event 4023: Zoomed X-projection with reconstructed tracks
* 74 Event 4023: Zoomed X-projection with reconstructed segments
* 75 Event 4023 (sixth pass)
* 76 Invariant mass of two reconstructed muon tracks
* 77 Display of two candidate tracks
* 78 The Muonboy pane
* 79 The Muonboy window, with all reconstructed muons
* 80 Event 4023 without reconstruction
* 81 Event 4023: Detail of BIL chamber in the X-projection
* 82 MDT hits after reconstruction (black)
* 83 _Set track parameters_ window for displaying ID tracks.
* 84 Display primary vertex.
* 85 Histogram of primary vertex candidates
* 86 Selection made to obtain the display of figure 87
* 87 Display with calorimeter hits (low thresholds)
* 88 Selection made to obtain the display of figure 89
* 89 Display with calorimeter hits (high thresholds)
* 90 Selection of thresholds and cell envelopes to obtain the display of figure 91
* 91 Display with calorimeter hits (high thresholds) within cell envelopes
* 92 Histogram of hit calorimeter cells (low thresholds)
* 93 Selection of high thresholds in the Set track parameters window
* 94 Histogram of hit calorimeter cells (high thresholds)
* 95 File formats proposed when saving the Histogram of hit calorimeter cells
* 96 Selection made for displaying jets in event 74 566 644 (Fig. 97).
* 97 Display of an event from 2011 data where the "jet" feature is illustrated.
* 98 Display of the same event where the "Missing \(E_{T}\)" feature is illustrated.
* 99 Charge asymmetry of forward low energy muons in 900 \(GeV\) collision data
* 100 Charge asymmetry: an acceptance effect
* 101 List of muon tracks generated in figure 100* [102] Using Persint for the geometry description
* [103] Min Bias event in 900 \(GeV\) data: Run 141749, Event 113661. (December, 2009)
* [104] Min Bias event in 900 \(GeV\) data: Run 141749, Event 171059. (December, 2009)
* [105] A \(J/\Psi\to\mu\mu\) candidate in the 7 TeV collision data of 2010.
* [106] The same \(J/\Psi\to\mu\mu\): in 2D projections and details of track reconstruction.
* [107] A second \(J/\Psi\to\mu\mu\) candidate in the 7 TeV collision data of 2010.
* [108] A \(W\to\mu\nu\) candidate in the 7 TeV collision data of 2010.
* [109] The same \(W\to\mu\nu\) candidate: in 2D projections and details of track reconstruction.
* [110] A \(Z\to\mu\mu\) candidate in the 7 TeV collision data of 2010.
* [111] The same \(Z\to\mu\mu\): in 2D projections and details of track reconstruction.
* [112]\(ZZ\) candidate event (\(Z\to\mu\mu\))
* [113]\(e\mu\) event
* [114] Candidate event \(Z\to\mu\mu\) + \(Et_{miss}\)
* [115]\(t\bar{t}\to eejj\) Run 155678; Event 13304729.
* [116] Candidate event \(Z^{\prime}\to ee\)
* [117] Candidate event \(Z\to\mu\mu\)
* [118] Candidate event \(H\to ee\mu\mu\)
* [119] Candidate event \(H\to\mu\mu\mu\mu\) with \(Et_{miss}\)
* [120] The same candidate event \(H\to\mu\mu\mu\mu\) with jets.
* [121] Candidate \(J/\psi\to\mu\mu\) in Heavy Ion collisions
* [122] Heavy Ion collision: \(Z\to\mu\mu\) +??
* [123] Heavy Ion collision: \(Z\to ee\) +??
* [124] Architecture of the Persint source code
* [125] History of Persint installation
* [126] ATLAS coordinate system.
* [127] Details of some files used by Persint.
* [128] The Displaced volumes window
* [129] The Create volume window
* [130] The Set track parameters window
* [131] Edit color palette and start Animation in the Tools menu
* [132] The setting of Preferences
* [133] Special menus available through various Right-clicks
* [134] The Edit track window 

## Introduction

Persint1 is an interactive visualization program developed for ATLAS. The program has been operational for many years and was used for:

Footnote 1: [https://www.sds.org/](https://www.sds.org/)

- Designing the muon spectrometer

- Debugging the successive detector layouts, in particular resolving volume clashes

in the GeoModel

- Optimizing the reconstruction software

- Analysing cosmic ray data in the commissioning phase

- Analysing collision events (data and Monte Carlo)

The new version described in this manual retains all the functionalities of the original package [2],[3] and features a modern graphic user interface (GUI) and an easy to use file management system. The new interface, which uses the Q_t_ library from Trolltech, makes it easy to interact with objects or applications.

Persint has many remarkable features, which can be used to visualize events in their most intricate detail. It is currently running on Linux, Mac OS and Windows operating systems and is interfaced with ATHENA, the general framework for data analysis in ATLAS. The package is being used with simulated events and with real data: cosmic ray events and events from collisions.

Persint is particularly well suited for understanding complicated events, when the visual representation of the detector's response becomes crucial.

## 1 Main features of Persint

The Persint program is designed for the three-dimensional representation of objects. It visualizes detector geometries using an interface with AMDB 2, an ASCII file containing the primary numbers used to build the muon spectrometer geometry. It also accesses AGDD 3, an XML-based geometry description language for the Atlas generic detector, mainly concerned with the inert material in the spectrometer. Persint interfaces with a variety of independent applications, in a fully interactive way. These applications include visualization of active detectors, inactive material, and the magnetic field map, as well as the detection of volume clashes, the display of event hits from files of physics events (simulated or data). It is possible to display events reconstructed with any reconstruction program active in ATHENA. Furthermore it is also possible to interactively run the embedded muon reconstruction program MuonBoy, and display the results.

Footnote 2: Atlas Muon Data Base

Footnote 3: Atlas Generic Detector Description

For spatial navigation, one can set the desired perspective for the 3D-view and display 2D-projections along various axes (Fig. 1). It is possible to change the viewpoint in order to best visualize the desired region, to displace the viewed objects with operations like translation, rotation and zoom.

The remarkable features offered by Persint are:

* 3-dimentional representation of objects in full volumes or "wire mode" using the computation of hidden faces
* Spatial navigation with real time displacements
* Focal length adjustment, from isometry to wide angle
* Displays can be exported as.png,.jpg,.bmp, or.svg files.
* Highlight of volume edges; adjustable light intensity on volume faces

[MISSING_PAGE_EMPTY:16]

## 2 Architecture

Persint has been in use since 1995 and is written in Fortran90. The core code contains everything needed to parse, store transiently and generate volumes from standard XML files. Analytic calculations determine volumes with hidden faces, provide the detection of clashes, can highlight volume intersections and supports boolean volume operations.

A second layer of \(C^{++}\) wraping classes provides the liaison between the core program and the graphic interface. This layer is made of classes encapsulating the calls to Fortran routines.

The third component is the \(Qt/C^{++}\) Graphic User Interface (GUI).

Persint is a stand-alone package which uses ASCII event files as input:

1. The ASCII event files can be produced by ATHENA from raw data, with proper setting of the "properties". In this case, the full potential of Persint can be used, including the interactive reconstruction of tracks with the embedded Muonboy reconstruction package. However, results from any ATHENA reconstruction package can be chosen for display (Muonboy, Staco, Moore, Muid,...)1. Footnote 1: Muonboy, Staco, Moore, Muid are computer programs for muon track reconstruction in Atlas.
2. These ASCII files may also be produced from ESDs, using a "procedure" in ATHENA (Appendix G.2). In this case, events can be displayed but the interactive reconstruction of tracks cannot be performed.

Details of the design architecture can be found in Appendix A and in [6].

## 3 Installation on supported platforms

The necessary total disk space for installing Persint is less than 200 Mbytes. The following platforms may be used (see details in Appendix B, figure 125):

* **Ubuntu**
* **Scientific Linux**
* **Mac OS X**
* **Fedora**
* **Debian**
* **CentOS** (Ubuntu)
* **Cygwin**, the Linux-like environment tested with Windows 7
* **CernVM** via VirtualBox 4.0 (Ubuntu and Mac OS X)

Detailed instructions for installation and requirements for dependencies are given in Appendix B. An abridged HTML version of this user's manual is available at:

[https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki](https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki)

**Up to date information** on releases, installation and dependencies can be found there.

## 4 Starting Persint

* To start Persint under Linux, launch the program with the Persint icon on the desktop 1. Footnote 1: Under Linux, this icon is created on the desktop at installation time.
* Under Mac OS, launch the Persint.app application placed in the Application folder at installation time 2.

Footnote 2: Under Mac OS, an alias can be conveniently placed e.g. on the Desktop or in the Dock. It can also be launched from the Terminal by typing./start_persint.sh in the persint working directory: Persint-00-02-*** is the evolving version number of Persint, e.g. Persint-00-02-57.

In the pop-up window, choose the language: English, French, German, or Italian. Upon launching Persint, the default AMDB geometry file is loaded automatically. It is located in the directory Persint-00-02-***/AmdcData/share, where Persint-00-02-*** is the persint working directory 3 Footnote 3: Persint-00-02-*** is the evolving version number of Persint, e.g. Persint-00-02-57.

Then a window is displayed which prompts you to restore (or not) the view which is automatically saved when closing the previous session (answer \(Yes\) or \(No\)).

When launching Persint for the very first time (there is no "previous session"), answer \(Yes\) in order to display the default view (Zmumu4023.p2vf) which is created at installation time in the directory Persint-00-02-***/example. 4

Footnote 4: 2mumu4023.p2vf is located in the Persint-00-02-***/example directory.

Figure 2 shows this default display in which labels have been added to indicate the location of the various tool bars and windows. The display also contains a simulated di-muon event which has been superimposed. How this is done is explained in section 6.3.

It is always possible to retrieve the original view (or any view which was saved as a.p2vf file). This is done in the following way:

Click on the Open view icon of the File tool bar. Select and open either the default file Zmumu4023.p2vf 5, or any saved.p2vf file.

Footnote 5: Check for the latest version at: [https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki](https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki). As the version will evolve with time, the version number is given as Persint-00-02-*** in this document.

* The program's version number can be seen in the About item in the Help menu (or in the persint menu in Mac OS). The latest version is Persint-00-02-57. 6 Upon starting Persint, if your version is not up to date, a warning will tell you so and invite you to make the update. Footnote 6: Check for the latest version at: [https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki](https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki). As the version will evolve with time, the version number is given as Persint-00-02-*** in this document.
* When loading the simulated event, you may be warned to use the appropriate geometry file. Answer **Yes** to load the suggested file (see page 24, figure 9a).

## 5 The Graphic User Interface

Figure 2 shows the Persint window once the program has been launched.

### Items of the Graphic User Interface

A detailed description of menus and tool bars available in the Graphic User Interface is given in Appendix E.

* At the top are the menus: File, Image, Navigation, Volumes, Events, Tools, Window and Help. The persint menu is specific to Mac OS). These menus give access to the various operations one can perform.
* The most common operations (but not all) are also available through **Tool bars** which appear just below the menus, as repeatedly shown in Appendix E. The user can choose which tool bars to display. A right-click on any displayed tool bar will produce a pop-up list from which items can be enabled or disabled. The **Navigation tool bar** has been placed on the right hand side 1 by the user. It has a number of functions (represented by icons) which allow changing the aspect of the main display in many ways. Footnote 1: Any tool bar can be placed to a preferred location by the user.
* The _AMDB_ interface allows interactive access to the geometrical data bases of the amdb_simrec type [4] and concerns not only detector volumes like muon chambers, calorimeters and trackers, but also magnets, feet, and shielding.
* The _AGDD_ interface allows interactive access to data bases of the ATLAS Generic Detector Description type [5][9]. The AGDD interface is used to display the inert material in ATLAS.
* The _Magnetic Field_ interface provides a fully interactive 3D visualization of the Magnetic Field. The use of this interface will be described in section 9.7.
* The _X0_ interface provides a full \(\eta,\varphi\) map of the amount of material traversed by a particle originating from the interaction point. The use of this interface will be described in section 9.8.
* The detector and event **Main display** window occupies the largest area of the display. When saving or exporting a view, it is the content of this main display window which is saved. The Main display can be modified in size by dragging the lower right corner. Also, by right-clicking on the title bar of the window, a number of functions appear in a pop-up window, which you are invited to test. 2 Footnote 2: This pop-up menu also appears when right-clicking on the title bar of the Histogram of hit calorimeter cells window (section 11.3.3).
* This _Main display_ window can be made "Full screen" by using the appropriate item in the Window menu, or the short cut by typing the letter \(F\) (lower case). To exit the full screen mode, type \(F\) again.
* Finally, the _Log_ window can be opened in the Window menu (Appendix E.7) and shows comments about the successive operations when running Persint.

### Online help

The location on the screen and the size of all these windows may be changed by the user. Online information about the functions of the icons is provided in an information box which appears when the cursor is positioned on any icon. Some examples are shown in figure 3.

### Toolbars or Menus?

In the following tutorial, we will mostly use the tool bars, although using actions in the menus may be preferred by some users.

Figure 3: Examples of online information boxes, when positioning the cursor over an icon.

## 6 Exercise 1: Setting the stage

In this section, we will start using Persint and explore it's most basic features as well as the main functions proposed by the interface. It is assumed that the installation was successful and that the necessary dependencies are satisfied (see Appendix B).

### Necessary files

For proper initialization of certain applications, the program loads several databases and input files. It is possible to load any database during running time, but it is of interest to load default files, so that the program can initialize its applications when they are launched for the first time. Default files are stored, at installation time, in the Persint-00-02-\(\bullet\bullet\) directory.

This section (6.1) provides information about the files needed for running Persint, and no action is needed at this time. You may however want to create two directories for storing various files generated when operating Persint, for example:

The persint_export_files directory (or any other name) for storing files generated by the Export view function of the File tool bar (see section 6.4, item 2). These are files for presentations and publications.

The persint_working_files directory (or any other name) for saving Persint-specific files. These are files which you may want to save when interrupting your work until your next session with Persint.

#### 6.1.1 Detector description and magnetic field

Persint uses several files which concern the detector description and the magnetic field map. At installation time, they are placed in the directory Persint-00-02-\(\bullet\bullet\)1 and can be loaded by clicking on the Data manager icon of the File tool bar. In the pop-up window (Figs. 4, 5, and 8) load the necessary files as follows 2:

Footnote 1: Created at installation time and named according to the Persint version in use. Check for the latest version at: [https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki](https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki)

Footnote 2: When all the files are chosen, click on Close.

Figure 4: Volume tab: Choosing AMDB and AGDD files1. The AMDB file (of the amdb_simrec.xxx type) from which the detector volume can be displayed is loaded from the **Volumes** tab (Fig. 4). When clicking on **Load**, the files in the directory **Persint-00-02-****/amdcData/share** are made available. 1 For this tutorial, we will load the Default file by clicking on **Load Default** and checking the box: "LoadAGDD Volumes from the AMDB file". The two other buttons are used to **Reload** the current AMDB file or **Define as Default** the Current file. Footnote 1: The content of this directory is shown in Appendix D.2, Figure 127a.
2. The magnetic field files are loaded from the **Magnetic Field** tab (Fig. 5). The magnetic field map can be chosen for both the muon spectrometer (toroid) and the inner detector (solenoid). Click on **Modify...** and the Magnetic field wizard proposes several possible actions, first for the spectrometer (toroidal) field map (Fig. 6a). * **Contine** to load the default map initially proposed 2 or chosen with one of the two following actions: * **Select...** to choose from the maps proposed in the **Persint-00-02-****/BFieldData/share** directory * **Download...** to download additional files from a CERN repository to the **Persint-00-02-****/BFieldData/share** directory * Clicking the **Contine** button will load the chosen spectrometer field map, and will prompt two options for the solenoid field map (Fig. 6b): i) Use the theoretical map calculated from Biot-Savart; ii) Use the measured map which needs to be **Select...** ed or **Download...** ed. Finally you are asked if the field maps you just loaded should be your future default maps (Fig. 7). 3. Event files are loaded from the **Events** tab (Fig. 8). When clicking on **Load**, the files in the directory **Persint-00-02-****/example** are made available. Event files can be loaded from other directories. The bottom part of the window shows the Data cards file, which is used for the interactive reconstruction of tracks within **Persint**. Here again, the default file **Muonboy_collision_cards** was chosen with **Load Default**. * **The event files are loaded from the **Magnetic Field** tab (Fig. 5). The magnetic field map can be chosen for both the muon spectrometer (toroid) and the inner detector (solenoid). Click on **Modify...** and the Magnetic field wizard proposes several possible actions, first for the spectrometer (toroidal) field map (Fig. 6a). * **Contine** to load the default map initially proposed 2 or chosen with one of the two following actions: * **Select...** to choose from the maps proposed in the **Persint-00-02-****/BFieldData/share** directory * **Download...** to download additional files from a CERN repository to the **Persint-00-02-****/BFieldData/share** directory * Clicking the **Contine** button will load the chosen spectrometer field map, and will prompt two options for the solenoid field map (Fig. 6b): i) Use the theoretical map calculated from Biot-Savart; ii) Use the measured map which needs to be **Select...** ed or **Download...** ed. Finally you are asked if the field maps you just loaded should be your future default maps (Fig. 7). 3. Event files are loaded from the **Events** tab (Fig. 8). When clicking on **Load**, the files in the directory **Persint-00-02-****/example** are made available. Event files can be loaded from other directories. The bottom part of the window shows the Data cards file, which is used for the interactive reconstruction of tracks within **Persint**. Here again, the default file **Muonboy_collision_cards** was chosen with **Load Default**. * **The event files are loaded from the **Magnetic Field** tab (Fig. 5). The magnetic field map can be chosen for both the muon spectrometer (toroid) and the inner detector (solenoid). Click on **Modify...** and the Magnetic field wizard proposes several possible actions, first for the spectrometer (toroidal) field map (Fig. 6a). * **Contine** to load the default map initially proposed 2 or chosen with one of the two following actions: * **Select...** to choose from the maps proposed in the **Persint-00-02-****/BFieldData/share** directory * **Download...** to download additional files from a CERN repository to the **Persint-00-02-****/BFieldData/share** directory * Clicking the **Contine** button will load the chosen spectrometer field map, and will prompt two options for the solenoid field map (Fig. 6b): i) Use the theoretical map calculated from Biot-Savart; ii) Use the measured map which needs to be **Select...** ed or **Download...** ed. Finally you are asked if the field maps you just loaded should be your future default maps (Fig. 7). 3. Event files are loaded from the **Events** tab (Fig. 8). When clicking on **Load**, the files in the directory **Persint-00-02-****/example** are made available. Event files can be loaded from other directories. The bottom part of the window shows the Data cards file, which is used for the interactive reconstruction of tracks within **Persint**. Here again, the default file **Muonboy_collision_cards** was chosen with **Load Default**. * **The event files are loaded from the **Events** tab (Fig. 8). When clicking on **Load**, the files in the directory **Persint-00-02-****/example** are made available. Event files can be loaded from other directories. The bottom part of the window shows the Data cards file, which is used for the interactive reconstruction of tracks within **Persint**. Here again, the default file **Muonboy_collision_cards** was chosen with **Load Default**. * **The event files are loaded from the **Magnetic Field** tab (Fig. 5). The magnetic field map can be chosen for both the muon spectrometer (toroid) and the inner detector (solenoid). Click on **Modify...** and the Magnetic field wizard proposes several possible actions, first for the spectrometer (toroidal) field map (Fig. 6a). * **Contine** to load the default map initially proposed 2 or chosen with one of the two following actions: * **Select...** to choose from the maps proposed in the **Persint-00-02-****/BFieldData/share** directory * **Download...** to download additional files from a CERN repository to the **Persint-00-02-****/BFieldData/share** directory * Clicking the **Contine** button will load the chosen spectrometer field map, and will prompt two options for the solenoid field map (Fig. 6b): i) Use the theoretical map calculated from Biot-Savart; ii) Use the measured map which needs to be **Select...** ed or **Download...** ed. Finally you are asked if the field maps you just loaded should be your future default maps (Fig. 7). 3. Event files are loaded from the **Events** tab (Fig. 8). When clicking on **Load**, the files in the directory **Persint-00-02-****/example** are made available. Event files can be loaded from other directories. The bottom part of the window shows the Data cards file, which is used for the interactive reconstruction of tracks within **Persint**. Here again, the default file **Muonboy_collision_cards** was chosen with **Load Default**. * **The event files are loaded from the **Events** tab (Fig. 8). When clicking on **Load**, the files in the directory **Persint-00-02-****/example** are made available. Event files can be loaded from other directories. The bottom part of the window shows the Data cards file, which is used for the interactive reconstruction of tracks within **Persint**. Here again, the default file **Muonboy_collision_cards** was chosen with **Load Default**. * **The event files are loaded from the **Magnetic Field** tab (Fig. 8). When clicking on **Load**, the files in the directory **Persint-00-02-****/example** are made available.

Figure 8: Choosing the Event file

Figure 6: Magnetic field wizard

Figure 7: Magnetic field wizard: set map(s) as default?

[MISSING_PAGE_EMPTY:25]

### Displaying detector layouts and events (Exercise 1 starts here).

1. Start Persint (see section 4).
2. Clear the view in the main display. Use the Clear icon in the Image tool bar and choose Clear view in the proposed menu (or click directly on the brush" in the icon). With this scrolling menu one can make a selective clearing of AMDB or AGDD volumes, event hits 1, labels 2 captions or pictures 3. Footnote 1: Event hits are treated in section 10.2.
3. Display detector volumes. The desired detector volumes can be displayed using the Selector window, the operation of which will be detailed in sections 7.2. For the present exercise, we will load the "Default file" which was prepared when studying the Zmumu4023 event: Click on the Open view icon of the File tool bar. Choose and open the file Zmumu4023.p2vf in Persint-00-02-<</example of your working directory. The detector volumes are displayed 4, as shown in figure 2. Footnote 2: Labels are treated in section 9.1.2.
4. Load a \(Z\rightarrow\mu^{+}\mu^{-}\) event in the following way. Click on the Data manager icon in the File tool bar. In the pop-up window, go to the Events tab (Fig. 8) and click on Load Default to load the "Default file" Out.MboyView_Zmumu4023 which becomes the "Current file". Close the Data manager window. The Event file contains information concerning the geometry to be used. It may happen that a warning is issued, which prompts you to load the expected geometry file and/or the magnetic field files, as shown in figure 9. Answer Yes to load the expected files. It is possible to answer No, in case one wants to use files different from the default files (e.g. a misaligned geometry or an different magnetic field). Furthermore, any given file available in the Persint-00-02-<</AmdcData/share directory (see App. D.2, figure 12) can be loaded from within the Volumes tab of the Data manager window.

Click on the Next event icon of the Event tool bar: the muon chambers which are hit by reconstructed tracks are displayed.

Figure 9: Warnings issued by Persint.

[MISSING_PAGE_FAIL:27]

For this exercise, we will use a pre-defined set of parameters by loading a file prepared beforehand, which is relevant to the event under study: in the pop-up window, click on the \(\left(\begin{array}{c}\mbox{\small{\sf{Open}}}\end{array}\right)\) box, and in the \(\left(\begin{array}{c}\mbox{\small{\sf{Persint\_export\_files}}}\end{array}\right)\)/example directory choose the file \(\left(\begin{array}{c}\mbox{\small{\sf{2mumu4023.p2ts}}}\end{array}\right)\). Close the window by clicking on \(\left(\begin{array}{c}\mbox{\small{\sf{OR}}}\end{array}\right)\). To complete the loading of this "track parameter" file (\(\left(\begin{array}{c}\mbox{\small{\sf{2mumu4023.p2ts}}}\end{array}\right)\), click on the \(\left(\begin{array}{c}\mbox{\small{\sf{Compute}}}\end{array}\right)\) icon1 of the File tool bar. The parameters from this file are then displayed in the \(\left(\begin{array}{c}\mbox{\small{\sf{Set}}}\end{array}\right)\)_track parameters_ window (Fig. 10). The resulting view is shown in figure 11.

Footnote 1: The \(\left(\begin{array}{c}\mbox{\small{\sf{Compute}}}\end{array}\right)\) icon is one of the most used functions. Whenever in doubt about the status of a display, clicking on this icon will compute the most recent requests for viewing.

### Save, Export, and Print views

1. Save. By clicking on the \(\left(\begin{array}{c}\mbox{\small{\sf{Save}}}\end{array}\right)\)_view as icon in the File tool bar the view displayed in the main display can be saved as a.p2vf file to the directory of your choice, e.g. \(\left(\begin{array}{c}\mbox{\small{\sf{Persint\_working\_files}}}\end{array}\right)\). This file (e.g. \(\left(\begin{array}{c}\mbox{\small{\sf{exercise1.p2vf}}}\end{array}\right)\) can be retrieved for later use in \(\left(\begin{array}{c}\mbox{\small{\sf{Persint}}}\end{array}\right)\) via the \(\left(\begin{array}{c}\mbox{\small{\sf{Open}}}\end{array}\right)\)_view icon.
2. Export. By clicking on the \(\left(\begin{array}{c}\mbox{\small{\sf{Export\_}}}\end{array}\right)\) icon in the File tool bar the view displayed in the main display can be exported to the directory of your choice, e.g. \(\left(\begin{array}{c}\mbox{\small{\sf{persint\_export\_files}}}\end{array}\right)\). There is a choice among several formats:.png,.jpg,.bmp for matrix graphics or.svg,.ps,.pdf for vector graphics. These files can be used in publications and presentations 2. Note that the background color of the display can be chosen with the Background color function of the Image menu. The grey background in figure 21d illustrates

Figure 11: Resulting display of the exercise in section 6.3

this feature. The edges of volumes can be highlighted with the Specific edge color function of the Image menu. Figure 12 shows a display without (a) and with (b) the Specific edge color being enabled (with the "red color"). The effect of the Anti-aliasing function aimed at smoothing the edges is shown in figure 13. 
3. Print. It is straightforward to use the Print icon in the File tool bar for printing the view of the main display.
4. Save special... This function allows for comparison between two geometries. In particular, it makes it possible to use a geometry from a file amdb_simrec different from the file expected from an event file. Invoking the Save special... function produces the following action:

Figure 12: The Specific edge color function and Persint logo of the Image menu.

Figure 13: The Anti-aliasing function of the Image menu. Because the printer performs its own optimization, the effect of Anti-aliasing shown here is less apparent than on a computer screen.

* The current view is saved as a.p2vf macro file named compare_persint_views.p2vf into the $HOME/.persint directory.
* The current view is also saved as a.png image file named persint-view-000.png into the same directory.

If a compare_persint_views.p2vf file already exists because of a previous use of the Save special... function, a warning is issued which asks you if the existing file should be loaded.

* If the answer is No, the compare_persint_views.p2vf file is overwritten and the active display remains unchanged.
* If the answer is Yes, the existing compare_persint_views.p2vf file is loaded and displayed, and stays unchanged in the $HOME/.persint directory.

In both cases, the view is saved as an image in the same directory with the name persint-view-001.png1.

Footnote 1: The view number is incremented for each subsequent use of the Save special... function. If needed, the files can be deleted from the directory.

The use of the Save special... function is illustrated in section 9.3.

### Dressing the display with captions, logos, and pictures

The Export function in the Image menu is used to make displays available for presentations and publications. It is possible to insert captions, logos, and figures in the displays, as described below.

1. The Persint logo. The Persint logo can be shown/hidden by checking/un-checking the function Logo in the Image menu. The result can be seen in figure 12a (with the Persint logo in the bottom-left corner) and figure 12b (without the Persint logo), and also in figure 31a.
2. Add Caption. A caption can be inserted in the following way: position the cursor at a chosen location in the display window and right-click. In the pop-up list choose Add caption. The text of the default caption can be edited as in figure 15 by adding text anywhere. The editing is done line by line and the text format can be chosen with the options provided:

Figure 14: Warning issued when using the Save special... function

When opening a new Add Caption window, the previously entered text is displayed, ready for modifications. The following actions can be taken:

* Remove caption: Use the Clear captions function of the Clear icon; or Right-click on the caption and choose Remove caption from the list.
* Export Captions are saved when using the function Export view as a picture.

Figure 15: _Add caption_ window. The last 3 paragraphs are the Default caption when an Event is displayed

* Save view as a _.p2vf file:_ the captions are saved with this function, and can be retrieved with the.p2vf file.
* Edit caption Captions can be edited by Right-clicking on the caption and choosing Edit caption from the menu. The location of captions cannot be changed; if their location is not adequate, they need to be removed and redone. 1 Footnote 1: But remember that the text of the deleted caption is saved and appears when a new caption is added.
3. Add picture. Various logos or ad-hoc pictures can be inserted in a Persint display: position the cursor at a chosen location in the display window and right-click. In the pop-up list choose Add picture and choose from the proposed list (Fig. 16).

The ATLAS logo exists in four flavors: default, black, transparent, and without text. They are shown in figure 17. It is also possible to load any picture from an existing file with From file....

Finally, the size of the inserted picture can be adjusted with the Dimensions parameters in two ways: keeping the original aspect ratio or with independent x,y dimensions

Note two features of the Add Caption and Add picture functions:

* The location of pictures (logos) cannot be changed; if their location is not adequate, they need to be removed and redone.
* The Clear captions or Clear pictures functions of the Clear menu offer two options: erase all the captions or pictures or erase only the last. Another way of removing one particular caption or picture, is to use the Remove caption or Remove picture in the menu which appears when right-clicking on the item to be removed.

Figure 16: Add picture window

Figure 17: The four flavors of the ATLAS logos.

Figure 18: Examples of inserting various captions, logos and pictures in a display.

## 7 Exercise 2: Muon tracks in your own layout

In this exercise, we will create a custom made event from scratch. By following the instructions, you should obtain the displays shown in figures 21d and 22b with possible minor differences due to your choice of colors or navigation.

We want to start with an empty main display window: Start Persint and do not load the saved file, by answering No to the question in the pop-up window (page 16). If you answered Yes, use the Clear icon in the Image tool bar to clear the view in the main display.

### Generate muon tracks at the IP

In the Event tool bar, click on the Generate muon tracks icon. In the pop-up window (Fig. 19), click on the + Add muon box four times. Fill in the parameters of the generated four muons, for example:

1. \(\eta=0.30\); \(\varphi=90^{\circ}\); \(P_{t}=1\,000\ GeV;Xv=Yv=Zv=0\)
2. \(\eta=0.30\); \(\varphi=90^{\circ}\); \(P_{t}=100\ GeV;Xv=Yv=Zv=0\)
3. \(\eta=0.30\); \(\varphi=90^{\circ}\); \(P_{t}=4\ GeV;Xv=Yv=Zv=0\)
4. \(\eta=0.30\); \(\varphi=90^{\circ}\); \(P_{t}=-4\ GeV;Xv=Yv=Zv=0\)

This is done by double-clicking on the value to be edited and using the spinbox which opens. Values can also be entered via the keyboard.

The muon momentum can be set either with \(P_{t}\) or \(P\). The + box is used in the following way:

* \(P_{t}\)\(P\) means that only \(P_{t}\) can be edited, \(P\) being calculated accordingly. Furthermore if one changes the value of \(\eta\), \(P_{t}\) is kept fixed and \(P\) is recalculated.
* \(P_{t}\)\(P\) means that only \(P\) can be edited, \(P_{t}\) being calculated accordingly. Furthermore if one changes the value of \(\eta\), \(P\) is kept fixed and \(P_{t}\) is recalculated.

The electric charge of a generated muon is determined by the sign of the \(Pt\) or \(P\) momentum: e.g. track # 4 has negative charge.

Click on OK. The four tracks originating from the interaction point (IP) are displayed: whereas the \(100\ GeV\) and \(1\,000\) Gev tracks appear as straight and superposed, the two \(4\ GeV\) tracks show clear opposite curvatures in the magnetic field.

Let's delete the \(1\,000\ GeV\) track by selection the appropriate line number and clicking on the - Remove muon box. The pop-up window now looks like figure 19. You may want to choose specific colors for the tracks.

For future use, save the generated muon parameters as a.p2gm file by clicking on the Save box inside the Generate muon tracks window. You may want to use your persint_working_files directory as a destination.

Figure 19: Pop-up window for muon track generation

### Display the detector using the AMDB interface

The Selector window (Figs. 2, 21, and 22) gives access to the AMDB interface to select the detector volumes to be displayed by clicking on the relevant pictogram. 1 The layout of this window is determined by the two approximate symmetries of the muon spectrometer:

Footnote 1: The \(AGDD\) interface is described in section 7.5.

* The 8-fold symmetry with respect to \(\varphi\) of the toroids and the muon chambers in terms of Large and Small sectors. Thus the octant wheel selector.
* The symmetry between \(Z\geq 0\) and \(Z\leq 0\) regions. Thus the Z-halves selector.

Clicking in the center of a "wheel" selects all sectors of a given detector. Clicking again in the center erases that selection. Sectors can be selected individually by clicking in the corresponding box, but only adjacent sectors can be displayed in this way. Figure 20 shows the functioning of the selector.

#### 7.2.1 Draw MDT muon chambers

In the Selector window, click on the MDT triangle and then in the center of each of the BIL, BML and BOL "wheels". Click on the Compute icon in the Image tool bar to display the view.

Now we want to simplify the view by choosing the BIL, BML and BOL chambers of the upper (Phi=90\({}^{\circ}\)) sector:

Click on the center of each wheel (followed by a click on Compute) to erase the view

Click in the corresponding sector of each "wheel", as shown in figure 21a

Click again on the Compute icon to display the modified view

The box at the left of the wheel allows you to choose your preferred color, if the default color is not suitable. You may want to try a "pastel" color and click again on the Compute icon to display the modified view.

The Wire" box lets you choose between the full or wire modes. (sections 7.7.3 and 9.6).

#### 7.2.2 Draw RPC muon chambers

Click on the RPC triangle and choose the BML and BOL chambers of the upper (Phi=90\({}^{\circ}\)) sector by clicking on the corresponding sector of each "wheel", as shown in figure 21b. Click on the Compute icon to display the modified view. Again, you may want to choose a color.

Figure 20: Illustration of the working of the Octant and Z-half selectors

#### 7.2.3 Draw Inner Detector

In the _Selector window_, click on the ID triangle. Click in the left-most third of the horizontal box, as shown in figure 21c, to select all sectors located at \(Z<0\)[1]. Here we have kept the default color. The view which has been composed appears in the Main Display window and resembles figure 21d. Note that it is possible to click the Compute icon only once, after having made all selections in succession.

#### 7.2.4 Optimizing the view: a first try at navigation

It is appropriate, at this time, to have a preview of the Navigation tool (Fig. 2) in order to place the view at the center of the display, with the proper magnification. To do this, we use the Navigation tool bar, in particular the Default mode which is the'magic wand' used most often.

Click on the Default mode icon of the Navigation tool bar.

Figure 21: Illustration of the operations (a,b,c) resulting in the display shown in (d). The selections are highlighted inside a red ellipse.

1. Drag the view to the middle of the display with the right button of the mouse pushed down. The displacements can be in any direction in the display.
2. Rotate the central wheel of the mouse to zoom-in or zoom-out, so that the view occupies the whole display.
3. The left button of the mouse is used to rotate the view in 3-dimentional space.

The detailed description of the Navigation tool bar is in section 8 and Appendix E.3.

#### 7.2.5 Starting anew

In case the result of an operation (navigation, addition of volumes, etc.) is not satisfactory, the Previous view icon allows you to retrieve the view which was displayed before the latest Compute step. Up to \(\sim\) 100 previous steps can be retrieved.

Previous view

### Place the calorimeters

In the Selector window, click on the CAL triangle and click successively on items in the ECAL and HCAL lines. Make the selections shown in figure 1(a): select the left-most rectangle to display the \(Z<0\) part of the calorimeters and choose the colors. The resulting display is shown in figure 1(b).

Comparing figure 1(d) and figure 1(b), one notices that when the material of the calorimeters is included (Fig. 1(b)), the two low momentum tracks, generated with 4 GeV at the IP, are bent more by the magnetic field, because of the energy loss in the calorimeters (\(\simeq 3\ GeV\) on average) is now taken into account.1

Footnote 1: The energy loss is taken into account as soon as one element of the calorimeter is chosen in the Selector window even if the track does not cross the element which is displayed, as in figure 1(b).

Figure 1(a): Additional selections (a) resulting in the display shown in (b).

### Save files for future use

Let us suppose you must now interrupt your work.

In order to be able to retrieve, at any time, the view displayed in figure 22b, save it as a.p2vf file to a directory of your choice (e.g. persint-working-files, as suggested in section 6.1). This is done with the _Save view_ as icon of the _File_ tool bar.

The saved view, e.g. exercise2.p2vf, only contains the detector volumes. It is necessary to also save the generated muons as a.p2gm file from within the pop-up menu of figure 19. If not already done, open the _Muon generation_ pop-up window and save the parameters by clicking on the _Save_ box. You may again choose the persint-working-files directory to store the saved exercise2.p2gm file.

You may also want to export the view in order to use it for a presentation: use the Export icon of the _File_ tool bar to save it, e.g., as my-presentation.png to the persint-export-files directory.

### Place inert material using the AGDD interface

With the AGDD pane in the _Selector_ window, one selects the inert material to be displayed 1. In figure 23, we have displayed one of the two endcap toroids, the rail assembly, and the saddle for the barrel calorimeters.

Footnote 1: Calorimeters (ECAL, HCAL) and the inner detector (ID) are accessed with the AMDB pane.

Sections in the AGDD pane can be made at several levels of detail, according to the tree structure which is provided.

### The _Dead material_ function

The _Dead material_ function is used for taking into account dead material traversed by tracks, even when the material is not selected for display.

Figure 23: Selections made in the AGDD pane to obtain the modified display.

#### 7.6.1 Preparing the working view

If you resume work with a new session of Persint, you want to display the view of figure 22b. When starting Persint anew, the view which was in use in the previous session is reloaded, provided you answer **Yes** in the initial pop-up window (Figure on page 16). This is because the current view is automatically saved when quitting Persint. In any case, the view may be retrieved since it was saved as exercise2.p2vf in section 7.4 by clicking on the Open view icon. Using the window which opens, choose the file exercise2.p2vf in the persint-working-files directory and click on **Open**.

You must also load the file containing the generated muon tracks which was saved as exercise2.p2gm.

Click on the Generate muon tracks icon and, in the Muon generation window, click on the open box to retrieve the exercise2.p2gm file saved in your persint-export-files directory. 1

Footnote 1: If this file was not saved, it is easy to generate the muon tracks again, as indicated in section 7.1.

If necessary, click on the Compute icon. Figure 22b should now be displayed.

#### 7.6.2 Use of the Dead material function

We now have figure 22b as working display, with the detectors and the 3 generated muon tracks. Note the visible curvature of the 4 GeV tracks, as they loose energy in crossing the calorimeters.

We will now remove the calorimeters from the display: in the AMDB pane of the Selector window, in the CAL arborescence deselect ECAL and HCAL by clicking in the center of the two wheels (see Fig. 22a). When hitting the Compute icon of the Image menu, the tracks now appear less curved, i.e. without the energy loss.

The energy loss can however be restored by clicking on the Use all dead matter icon of the Events menu. With this icon one can switch to displaying the muons with or without energy loss, even though the calorimeters are not shown in the display. This feature comes in handy for showing realistic muon tracks when material must be ommitted for clarity of the view.

Figure 24: Display of figure 22b, but where the calorimeters are not selected for display. Use displayed dead matter only has been selected in a), Use all dead matter in b).

### Look at the event in detail

In this section, we will continue work with figure 22b. If necessary, restore that view as shown in section 7.6.1. We will look at the ATLAS coordinate system, produce a projected view, and finally zoom-in to look at the MDT tubes in detail.

#### 7.7.1 Show ATLAS coordinate system

The ATLAS coordinate system is shown in Appendix C (Fig. 126).

1. Click on the arrow of the Axes icon and choose Huge axes.
2. Click on the arrow of the Projection icon and choose Invert. The view is inverted with respect to the Z axis. Go back to the original orientation by repeating the Invert operation.
3. Erase the axes by clicking on the Axes icon again and choose No axes.

#### 7.7.2 View the event in the X-projection

Click on the arrow in the Projection icon and choose X.

A projection perpendicular to the X-axis is displayed, in the \((Y,Z)\) plane (Fig. 25).

Figure 25: Resulting X-view from manipulations in section 7.7.2. The energy labels have been added by hand. See section 9.1.2 for labels generated by Persint.

#### 7.7.3 _Zoom-in on muon chambers_

1. Select the Default mode in the Navigation tool bar and, with the "wheel" ("central button") of the mouse pushed down, select a region in the BML chamber including the two tracks as shown by the red rectangle in figure 25.
2. In the Selector window, choose the 'MDT options'' tab and check the boxes as shown in figure 25(a). Choose the ''RPC options'' tab and check the boxes as shown in figure 25(b).
3. Click on the Compute icon.
4. Note that the selections can be made to produce displays in the solid or wire modes.

A view similar to figure 27 should be displayed. It shows the three generated muon tracks crossing the two layers of MDT tubes and RPC Z-strips, in the BML station 1. The two colors of the tubes alternate every 8 tubes (for easier tube identification) and can be chosen in the 'MDT options'' of the Selector window (Fig. 25(a).). The red open squares represent the centers of multiple scattering used by the program.

Footnote 1: A detector station is the mechanical entity holding several layers of detector planes. For example, a BML MDT station is made of two triplets of drift tubes (see fig. 27).

The display in figure 27 can again be saved as a.p2vf file into one of your working directories (use the Save view icon). It can be retrieved with the Open view icon. The same is true for the generated tracks: they can be saved as a.p2gm file and retrieved by opening this file inside the Muon generation window opened with the Generate muon tracks icon (see section 7.7.3.

Figure 27: Resulting X-view from manipulations in section 7.7.3.

## 8 Exercise 3: Practicing Navigation

The interface to the various graphics applications of Persint is provided by the Navigation tool bar on the right hand side of the display (Fig. 2 and Appendix E.3). Its functions allow spatial navigation and modifications of the visualization properties.

The desired perspective is obtained by changing the viewing point and the viewed point, by changing the focal length of the observer eye. The view may be rotated, displaced, enlarged or made smaller (Zoom). For Zoom in/out and Rotation, the amplitude of movements can be chosen with the Navigation scale gauge.

### Preparing the working view

In this section, we will learn to use the spatial navigation tools and start with the view which was saved as exercise2.p2vf in the previous exercise (section 7.4, Fig. (b)b).

Start the Persint application and click on the Open view icon of the File tool bar. Load the exercise2.p2vf file, from the persint_working_files directory. The view of figure (b)b is now displayed.

From the Selector window, add a second adjacent large sector and one adjacent sector of small MDT chambers (fig. (a)a) and a few endcap MDT chambers (Fig. (b)b). Check the result by clicking on the Compute icon. Three barrel toroid coils 1, one of the endcap toroids, as well as the detector feet are added when the selection shown in figure (c)c are made2. When clicking on the Compute icon, the view of figure 30 is displayed.

Figure 29: Additional choices made in the Selector window to display the muon spectrometer

Figure 28: The scale can be changed by moving the cursor or by opening the spinbox with a click on the three dots (...), and setting the scale with the keyboard. The default value of 1.0000 is displayed.

Before starting with the navigation, save the view for future use: click on the Save view as icon and save the view as Exercise3.p2vf into the Persint_working_files directory.

### The Default mode: a magic wand

The Default mode is the most powerful function of the Navigation tool bar. With this icon selected, all three buttons of the mouse can be used to perform the most frequent navigation actions, as we have already seen in section 7.2.4.

1. The **left button** of the mouse is used to rotate the view in 3-dimentional space. Keep the left button pushed down and move the cursor anywhere inside the display. Start with simple movements, e.g. horizontal, vertical, and then use more complex movements. The actions and results are very much intuitive.
2. Rotate the **central wheel** of the mouse to zoom-in or zoom-out. Practice by making successive reverse zooms to the view.
3. With the **right button** of the mouse pushed down, the view can be translated in any direction inside the display.
4. By pushing the **central wheel** down (without rotating it), one selects a rectangular zone to be zoomed, as already exercised in section 7.7.3 (Fig. 25). This action is called Zoom on custom area.
5. By pushing and releasing the right button of the mouse on any detector volume, a pop-up menu is displayed from which various operations on the volumes can be performed. These operations include moving volumes, adding labels, captions, or pictures, and are described in section 9.

Figure 30: Detector layout resulting from the additional selections made in Exercise 3. The information box is obtained by positioning the cursor on the chosen volume EOLF4Z+6 (see section 9.1.1).

Note that the amplitude of the first two actions (rotation and Zoom in/out) can be tuned with the Navigation scale. Remember that the scale can also be set with the Spinbox accessible with a click on the (\(\overline{\dots}\)) of the Navigation scale icon.

### Single functions

The 5 functions described below can all be performed with the Default mode icon (the magic wand) and are in fact redundant. However, when repeating the same action many times, it may be advantageous to use a single function.

1. Translation Activate the Translation icon and use the left button of the mouse to translate the view in any direction.
2. Zoom-in Activate the Zoom-in icon and click on the left button to zoom-in on the view.
3. Zoom-out Activate the Zoom-out icon and click on the left button to zoom-out on the view.
4. Zoom on custom area Activate this icon and use the left button to select a region (red rectangle). When the button is released, the zoom of the selected rectangle is performed.
5. Rotation Activate this icon and use the left button to rotate the view around the center point of the display, with the appropriate movements of the cursor.

### More functions

The remaining functions of the Navigation tool bar are:

1. Initial Zoom Activate the Initial zoom icon with the left button to retrieve the original zoom parameters. Note that if this function is used on a projected view (e.g. X-view), the Initial zoom action brings back the 3-D view.
2. Set center Selecting the Set center icon and then clicking on a given volume centers the view on that volume 1. The point around which a view is rotated is chosen in this way.
3. Navigation scale As already mentioned, with this function it possible to change the amplitude of two navigation actions: Rotation and Zoom in/out.
4. Focal length The nominal focal length is 35 mm. It can be changed with the cursor of the Focal length icon, and set back to the nominal value with the Reset focal length icon.
5. Isometric view By clicking on this icon, one produces an isometric view (infinite focal length). To return to the previous focal length, click on the icon again.

Some results of using these functions are shown in figure 31, where the same volumes are shown with different perspectives.

The two remaining functions will be explained in the next exercise (Section 9).

1. Volume information
2. Selection mode

Figure 31: Defining the viewing perspective

## 9 Exercise 4: Exploring more features

We start with the view saved at the end of exercise 3. Click on the Open view icon and open the file Exercise3.p2vf from your Persint_working_files directory. This should display the view of figure 30.

### Volume information labels

#### 9.1.1 Volume identification with information boxes

You will have noticed that by positioning the cursor on a volume, an information box is shown which displays the identity of the volume and its geometrical parameters. It is a convenient feature to identify any volume in the layout.

#### 9.1.2 Label maker

When saving displays to be used for publications or presentations, it is useful to be able to also display the volume parameters (volume identification, position,...) and an explanatory text. This is achieved with a feature which makes labels, as explained below. 1

Footnote 1: Labels are saved when using the Export View... and Save view as.p2vf file... functions.

1. **Default labels** By right-clicking on a volume (in this case a MDT chamber) 2 and releasing the button, one produces the pop- up window of figure (a)a. Choose Add/Remove label / Add default label to obtain the default label which displays the "Hardware name" of the chosen muon chamber (BOL5C05) 3, as shown in figure (b)b. If the geometry file does not provide the "Hardware name" the "Software name" is displayed. Footnote 2: Track labels are obtained with the same procedure, by clicking on the tracks (Fig 62 in section 10.5).

Footnote 3: BOL: **Barrel Outer Large** chamber; 5: 5\({}^{th}\) chamber from \(|\)\(Z\)\(|\)=0; C side (\(Z<0\)) [A side (\(Z>0\)]; 05: sector number. **See reference [7] for conventions on chamber numbering**.

To remove the default label, repeat the operation by right-clicking on the same volume and choose Remove label. The Clear labels function of the Image menu clears all labels in the display. The Reload event function has the same effect.
2. **Customized labels** The label can be customized by clicking Add customised label (figure (a)a). In the window which opens (Fig. (a)a), the complete Volume information appears and room for Additional text is provided.

Figure 32: Making a Default labelThe Customized label has 5 lines of information:

1. Hardware name of the chamber (EOL6A07)
2. Software name of the chamber.
3. X,Y,Z coordinates of the cursor.
4. R, \(\varphi,\eta\) coordinates of the cursor.
5. Magnetic field \((B_{x},B_{y},B_{z})\)

It is possible to place the label at four different positions with respect to the cursor position (SE, SW, NW, NE). Click on [06], after having chosen "NE"; the customized label of figure 34 appears in the NE position.

To remove the customized label, repeat the operation by right-clicking on the same volume and choosing [Remove label]. The Clear labels function clears all labels in the display. The Reload event function has the same effect, if indeed an event is displayed.

Figure 34: Custom label for an endcap MDT chamber

Figure 33: Pop-up window when choosing Customised label in the window of figure 32a.

### Hide/Displace volumes or super-volumes

There are several ways to remove a volume or super-volume from the display. Technically this is done by setting the coordinates of a volume to very high values, thus the term "Move to infinity" used in the relevant functions.

#### 9.2.1 Hide volumes

The simplest way to hide a volume is to right-click on a volume, release the button and choose Move volume to infinity or Move super volume to infinity in the pop-up window (Fig. (a)a). In the following example, we proceed to hide MDT endcap chambers: 3 volumes and 2 super modules in two neighboring sector. The procedure is simply repeated for each chosen volume (5 operations). Figure 35 shows a partial display of the initial layout and the result of the hiding. 1

Footnote 1: The labels in figure (a)a are produced as explained in section 9.1.2

In order to restore the initial layout, simply click on Displaced volumes of the Volumes menu. In the pop-up window (Fig. 36), choose Reset all the displacements and click on \(\boxed{Close}\) : the initial view is restored.

It is also possible to individually select the volumes to be returned to the display by selecting each volume in the pop-up window (Fig. 36) and clicking on \(\boxed{Reset volume displacement}\). The action takes place when the Close box it clicked on.

Figure 36: Pop-up window showing displaced volumes

Figure 35: Hiding volumes and super volumes

#### 9.2.2 Hiding volumes, the fast way with Selection mode

If a number of volumes or super volumes must be hidden, there is a fast and efficient way to do so with the Selection mode of the Navigation tool bar.

Click on the Selection mode icon of the Navigation tool bar and click on the volumes or super volumes to be displaced. The list of selected items appears in the Selected volumes pop-up window, shown in figure 37.

A left-click selects a volume (in blue).

A right-click selects a super volume (in red).

Use the Move to infinity button to hide the (super) volumes listed in the window. Note that volumes to be hidden can also be selected using the functions available in the window shown in figure 32a. This window is obtained by right-clicking on a volume, the Default mode being selected in the Navigation tool bar. In this case, the list of volumes to be hidden is made by choosing Select volume or Select super volume.

The color of all selected volumes and super volumes can be changed with the Edit color button. (Un-select all) can be used to clear the entire list. With the Sectors button, one makes a selection of sectors (see also 10.3). The More button gives access to two more functions concerning "ATHENA reconstructed tracks": (Inv. mass) (see 11.1.3) and (Edit shape) (see 11.1.1 and 11.1.3).

#### 9.2.3 Displacements of volumes

It is possible to change the display parameters of volumes by selecting the Volume information icon in the Navigation tool bar and clicking on the volume to be altered.

This opens the Modify volume window shown in figure 38.

The functions used most often are:

1. Selecting a volume or super volume by clicking on the appropriate button.
2. Changing the color of the volume/super volume.
3. Hiding volume/super volume (i.e. "Move to infinity"), a function already performed by other means (section 9.2.1).

Click on OK to view the changes made to the selected volume.

The two other features (Translation and Rotation) were used extensively during the design of the muon spectrometer and during the commissioning phase with cosmic rays. The development of the reconstruction software also benefited from this tool.

Figure 38: Modify volume window

Figure 37: Selected volumes window

### Compare geometries

The comparison of displays obtained with different geometries can be performed with the Save special... function described in section 6.4. Below are two figures which illustrate its use. They were obtained with two different geometries of the supporting structure of ATLAS (the "feet"). The following exercise is done with a pre-loaded.p2vf file located in the directory Persint-00-02-\(\bullet\bullet\)/example. It can be repeated with any other.p2vf file of your choice.

1. First, using the Open view function, we display the feet structure by loading the relevant file compare_persint_views.p2vf, located in the directory Persint-00-02-\(\bullet\bullet\)/example. The expected geometry is amdb_simrec.r.04.01 and should be loaded by choosing Yes in the warning box. This geometry file is located in the Persint-00-02-\(\bullet\bullet\)/AmdcData/share directory. When the ATLAS "feet" are displayed, we perform a zoom to get figure 39a. By using the Save special... function of the File menu and answering No to the prompt, the.p2vf file is saved into the $HOME/.persint directory and an image file persint-view-000.png is written into the same directory.
2. We now change the geometry description. Click on the Data manager icon of the File menu and choose the Volumes tab. Click on Load and choose the new geometry file amdb_simrec.r.03.01.Initial.Light.EIL.BL.S13.Patch.1 Close the Data manager window. We now want to load the compare_persint_views.p2vf file again to display it with the new geometry. Proceed as above, using the Open view function. Answer No in the warning box in order to use the new geometry, and not the geometry expected by the.p2vf file. Ignore the AGDD warning. Perform a zoom to obtain figure 39b. Use the Save special... function of the File menu again, answer No to the prompt, and the new display is saved as persint-view-001.png into the $HOME/.persint directory. Footnote 1: Geometry files of the amdc_simrec type are available in the Persint-00-02-\(\bullet\bullet\)/AmdcData/share directory.
3. These two.png images are now available for comparisons. Toggling between the two images, persint-view-000.png and persint-view-001.png shows the differences: there is less material in the first.

Figure 39: Two ”feet geometries” to be compared.

### Detect volume clashes

This feature was used extensively during the building of the geometry files (GeoModel). It is not commonly used, except by developers of geometry data bases. For completeness, its functioning is explained below.

We continue working with the display of figure 35a, which should be the current view. If not, you can use one of the following three methods to get this view back:

* Use the Previous view function of the Image tool bar once or several times.
* In the pop-up window of Displaced volumes (Fig. 36) click on Reset all the displacements and then on Close.
* If the view has been saved, as indicated in section 8.1, use the Open view function to load the saved Exercise3.p2vf file.

We now want to displace a volume to produce a clash between two volumes.

In the active display (Fig. 40a), zoom on the area shown in red by using the Zoom on custom area of the navigation tool bar. We obtain figure 40b.

1. Right-click on the EOL chamber 1(the violet volume) and choose Volume information in the pop-up window 2. Footnote 1: Remember that a volume can be identified by positioning the cursor on it, in order to activate the information box (see section 9.1.1).
2. In the Modify volume window, select the Supervolume EOL_F4_Z+6 and set the Ax angle to 6 degrees, as shown in figure 41a. After performing a Zoom, we obtain figure 41b.
3. To identify the clashes resulting from the rotation, click on Clashes in the Volumes menu (down arrow) and check Show all clashes. Clashes Clashes or the Clashes triangle to open the Clashes window which lists the 5 pairs of volumes which present a clash (Fig. 42a). The list of clashes can be saved as a.txt file with Export, or stored for future comparisons within Persint with the Store box. The default name is "Backup no.1".

Figure 40: Displays used for detecting clashes

[MISSING_PAGE_FAIL:52]

### Animation

It is possible to produce an animation of a displayed view. Parameters such as amplitudes of rotation and zoom, number of iterations can be chosen. The generated frames can be used as input for video software.

You may use any view made with Persint, but for simplicity, we start with the view of figure 30. Choose the function Open view of the Image menu. Open the file Exercise3.p2vOpen View in the directory Persint_working_files where it was saved in section 8.1.

Choose Animation in the Tools menu. In the Generating animation window which opens (figure 43), choose the parameters, e.g. those indicated in the caption below.

Clicking on the OK box will start the animation. With the parameters chosen (Fig. 43), the view rotates in 36 steps of 10 degrees, for a complete revolution.

The Save images box having been checked, 36 files are saved in the specified directory for future use by video software. With the Stereoscopic mode enabled, the number of saved frames would be doubled.

Figure 43: The parameters are:

- Number of steps (iterations)

- The parameters of the motion (Direction and angle of rotation; Zoom factor)

Options:

- Save images

If the generated frames are to be saved, check the Save images box (the default is "no save"), choose the Directory, the filename and the format (extension.png,.bmp or.jpg)

- Stereoscopic mode

### Wire mode

The wire mode exists in two flavors:

1. Global Wire Mode. In the Wire mode, the program bypasses the time-consuming computation of hidden faces and volume intersections. This results in a much faster processing of the view for display and optimal fluidity in the displacements. It can therefore be advantageous to switch to the wire mode when making complex navigations, and go back to the full volume display when finished.
2. Partial Wire Mode. By checking the appropriate box in the "Wire" column in the Selector window, groups of volumes can be displayed in the full or in the wire mode. This function is used to make certain volumes "transparent" in order to get a view "inside" the detector. The partial wire mode can also be chosen in the "MDT options" and "RPC/TGC options" panes (see Fig. 26).

### Magnetic Field Interface

The Magnetic Field interface provides a fully interactive 3D visualization of the magnetic field. This application is coupled to a set of subroutines that read the field database and compute the field at any given point.

#### 9.7.1 Loading a Magnetic Field file

The muon spectrometer magnetic field map is loaded from the Magnetic field tab of the Data manager window (Fig. 5). Instruction are given in section 6.1.1, item 2, page 21. Click on Modify... and the Magnetic field wizard proposes several possible actions, first for the spectrometer (toroidal) field map (Fig. 6a):

* Continue to load the default map initially proposed 1 or chosen as follows: Footnote 1: When running Persint on kplus at CERN for the first time, there is no default map available.
* Select... to choose from maps proposed in Persint-00-02-*/BFieldData/share
* Download... to download additional files from a CERN repository to the Persint-00-02-*/BFieldData/share directory

Clicking the Continue button will load the chosen spectrometer field map, and will prompt two options for the solenoid field map (Fig. 6b):

i) Use the muon spectrometer map for the solenoid map 2;

ii) Use a specific map which needs to be Select... and or Download...)ed.

Footnote 2: All spectrometer field maps contain a generic description of the solenoid field in the inner detector region

Finally you are asked if the field maps you just loaded should be your future default maps (Fig. 7).

Figure 44: Partial Wire Mode switched on.

#### 9.7.2 Display B-field lines

The magnetic field interface is launched in the following way: in the Selector window open the Magnetic field pane (Fig. 45a) and check the Display magnetic field box.

The field is visualized by means of arrows located at a series of lattice points. The direction and length of the arrow corresponds to to the direction and magnitude of the magnetic field. The field display can be customized with the following choices:

- Color of the arrows

- Linear or logarithmic scale

- 3D or projections, at x, y, or z positions

- Lattice for field display

The vector field can be built either in a very localized region or over large distances.

Once all properties of the field visualization are defined, the display is obtained by clicking on the Compute icon.

Finally, elements of the Magnet system can be visualized through the AGDD pane of the Selector window. Figure 45 shows an example of a display of the magnetic field where one element of the cold mass of a barrel coil is shown.

Figure 45: Example of magnetic field lines displayed with a barrel toroid cold mass, selected with the AGDD interface. The parameters in (a) are used to obtain display (b).

[MISSING_PAGE_EMPTY:56]

The magnetic field can also be illustrated as 1D plots. With the selections shown in figure 48, the total field \(B_{tot}\) is shown as a function of \(R\) in figure 49 (Map 1).

The field of the central solenoid magnet can be added, as shown in figure 49 (Map 2), with the following selections (made in the panes of figure 48):

**Component\(=B_{z}\)**; **Variable\(=Z\)**, at \(\varphi=R=0\) ; **Lattice**: \(Z\in[-300,300]cm\).

With the MDI1 button, the display can be arranged to show each map separately, using the tabs, as shown in figure 50.

Figure 48: Selections for 1D plot of the magnetic field.

Figure 50: Same as figure 49, but in MDI mode, showing one plot at a time in separate tabs.

[MISSING_PAGE_FAIL:58]

### \(X_{0}\) map: Distribution of material

The amount of material (in units of radiation length \(X_{0}\)) along any chosen direction from the interaction point can be displayed in the following way.

In the Option_pane_ of the Selector window (Fig. 2), choose the \(X_{0}\) tab 1, and hit the Generate\(X_{0}\) Map button 2.

In the Select options for Map window (Fig. 54a), the lattice \((\eta,\varphi)\) and the integration range \((R,\,Z)\) can be chosen. The resulting map is shown in figure 54b. The regions with high quantities of material because of the magnet coils are clearly visible (in warm colors): at \(\varphi=22.5^{\circ}\) for the barrel region and at \(\varphi=0^{\circ}\) and \(45^{\circ}\) in the forward region (\(\eta>1.5\)).

Footnote 1: You may have to open the \(X_{0}\) tab by checking \(X_{0}\) in the Windows menu

Footnote 2: OR: Use the Tools menu: Tools/Histograms... Map of \(X_{0}\).

Figure 54: Map of \(X_{0}\).

a) The window Select options for Map allows to choose the direction \((\eta,\varphi)\) along which the amount of material - in units of \(X_{0}\) - is calculated, as well as the integration range \((R,\,Z)\).

b) Two dimentional \((\eta,\varphi)\) Map of \(X_{0}\). At the right, the color scale for the amount of material is expressed in units of radiation lengths \((X_{0})\).

Figure 53: Display of \(\int Bdl\)

### Map of the expected number of crossed muon stations

Ideally, the number of detector stations crossed by a muon is at least 3. There are regions in the spectrometer where this is not the case: e.g. in the transition region between barrel and endcap (around \(\mid\eta\mid\simeq 1.2\)), where a muon crosses fewer stations; and also at regular azimuthal angles. The tool described below makes it possible to determine the number of stations at any given \(\eta\) and \(\varphi\).

The map is obtained by generating straight tracks from the IP and propagating them through the spectrometer, counting the number of chambers on the trajectory.

In the Tools menu, choose Histograms.../Map of expected stations button 1. In the pop-up window "Select options for map", make the following selections shown in figure (a)a:

Footnote 1: OR: In the Option pane of the Selector window (Fig. 2), choose the \(X_{0}\) tab, and hit the Generate map of expected stations button

- **Lattice**: choose the desired \(\eta,\varphi\) ranges

- **Type** : select precision stations (MDT+CSC) or trigger stations (RPC+TGC)

- **Selection** : use all stations in the spectrometer or only the stations being displayed

Clicking on [0.5], produces the map of figure (b)b. The regions where only one station or none are crossed can be clearly identified (blue resp. purple).

There are also a few rare regions where the number of expected stations exceeds 3, as indicated by the regions in yellow.

By using the selection Use displayed stations only in figure (a)a, it is possible to restrict the map to the stations displayed in an event.

In any of the resulting maps (Figs. 47, 49, 50, 46b, 52c, 54b, 55b, ), several actions are possible with the tabs at the bottom of the display:

* **Range** : Set the range of the color scale for the plotted quantity.
* **Export** : Saves the map as an ASCII file (.dat format).
* **Save** : Saves the map as a picture with a choice of formats (.png,.eps,.pdf, etc.).
* **Close** window without saving or exporting.

Figure 55: Number of expected stations.

a) Options for displaying the map: \(\eta\) and \(\varphi\) ranges, type of chambers, selection of chambers.

b) Two dimentional \((\eta,\varphi)\) map of Number of expected stations. At the right, the color scale for the number of stations.

## 10 Exercise 5: ATLAS Physics Events (1)

### Input files

#### 10.1.1 Files loaded by the user

Persint allows the reading of event hit files and the visualization of these hits. It is also possible to reconstruct the event interactively 1. All this is done with the help of the Events menu (Appendix E.5).

Footnote 1: The interactive reconstruction is using the interface with the Muonboy reconstruction program.

To display event hits, the following files must be loaded:

1. A geometrical data base of the "amdb_simrec.xxx" type.
2. An input Event file containing the hits of the "OutMboyView_yyy" type. The structure of this ASCII file is given in Appendix D.3.6, and an example Event file in Appendix D.3.7.

The interactive reconstruction of events requires the loading of two additional files.

1. The Magnetic field file
2. The user's directives in the form of "Data cards"

All these files are available through the Data manager icon of the File tool bar. For details, refer to section 6.1.1, figures 4, 5, 8, and Appendix D, figure 127a. As already mentioned, these files are loaded, if available, in the working directory. The program checks if the correct files are loaded. If there is a discrepency between the loaded geometry file and the event hit file, 2 a warning is issued and the correct file(s) can be loaded (see section 6.3, item 4, and figure 9 on page 24).

Footnote 2: The event hits file ”OutMboyView_yyy” indicates the required geometry file in its header (Appendix D.3.7). The file ”Persint-00-02-**/PersintData/AtlasNode_AmdcFile_MagFieldFile.txt” indicates the magnetic field file needed for a given geometry file (Fig. 127b).

The user may change these input files at any time during the running of Persint.

#### 10.1.2 Event dependent files

The geometry file of the "amdb_simrec.xxx" type which is loaded at the beginning of a session represent the nominal geometry corresponding to the event file in use. The actual geometry, which represents the state of the detector at any given moment, must be used. Using a port 3 to a CERN data base, these files are invoked for each event displayed with Persint according to its time stamp.

Footnote 3: To get automatic access to these files, open the port with the following command:

* The "missing" file indicates the detector parts or channels which are inoperative for a given event.
* The "Corr" file provides the alignment parameters (A lines) and deformation parameters (B lines) of the precision chambers.

### Display physics events (Exercise 5 starts here)

For this exercise, we start from scratch; after starting Persint, we erase the display window with the Clear button of the Image tool bar.

Then we load the necessary files with the Data manager icon of the File tool bar:

* An amdb_simrec.xxx geometry file in the Volumes tab (Fig. 4). Check the box "Load AGDD Volumes from the AMDB file"
* A magnetic field file in the Magnetic Field tab (Fig. 5).
* The (default) Muon hits file in the Events tab (Fig. 8). Answer "Yes" if you are invited to load the "expected" AMDB file (see figure 9). Choose the magnetic field map (Fig. 9b) corresponding to the default Event file (answer "Yes" ). Finally, load the appropriate Data Cards file Muonboy_collision_simul_cards, for a simulated event.

- To display the event of the default Event file (Out.MboyView_Zmumu4023) 1 click on the Next event icon of the Event tool bar. The muon chambers which contain hits (and only those chambers) are displayed.

Footnote 1: The file ”Out.MboyView_Zmumu4023” used in this tutorial contains only one event.

- To display the reconstructed tracks, click on the Athena reconstruction icon of the Event tool bar. A second click will remove the tracks.

- The Simulated tracks icon can be used to visualize generated tracks. A second click will remove those tracks.

- The muon chambers belonging to the event can be hidden by un-selecting Chambers in the Event menu.

After having used some functions of the Navigation tool bar to change the aspect of the display, figure 56a shows the event with the two muon tracks and the chambers which contain hits.

Many different reconstructed objects can be displayed; they are selected in the Set track parameters window (Fig. 56) 2 available through the corresponding icon.

Footnote 2: See also figure 130 in Appendix E.5.1.

For instance, one can choose to display tracks reconstructed by Muonboy or Moore, Staco or Muid etc...

Besides these objects specific to the muon system, it is possible to visualize objects relevant to the calorimeters (cells) and Inner Detector (tracks). These displays will be discussed in section 11.3.

Note that the Event can be erased from the display with the Clear event function.

Figure 56: Display of Event 4023 resulting from the selections made.

### Select Sectors to be displayed

Because all chambers with hits are displayed in an event, the display may become crawded. Although this is not the case for the current event 4023, we will nonetheless clear the display of the chambers which do not have a reconstructed track.

First we identify the sectors of interest: by moving the cursor over the 6 chambers which contain the two reconstructed tracks, we find that the two sectors concerned are sectors 3 and 7, as indicated by the chamber labels. The goal is now to only display those sectors 3 and 7.

To do this, we use the function Select Sectors... of the Events menu. In the window which appears, we choose the sectors we want to display, by using the Add button shown in figure 57a. In the pop-up window, make the selections to display sectors 3, as shown in figure 57b; repeat the operation for sector 7. It is also necessary to select other options such as Barrel/endcap, Large/Small, Z+. Upon clicking on OK, the selection is displayed in the Select sector(s) window (Fig.57c). Clicking once more on OK will produce the event display of figure 57 where only sectors 3 and 7 are displayed.

Figure 58: Event 4023, display (2), resulting from the selection of two sectors.

Figure 57: How to select the sectors to be displayed in an event.

The selection of sectors remains active until another selection is made in the Select sector(s) window or until one restores the entire display, using the Reset button of that window. Note that figures 58a (default) and 58b correspond to the selections of figures 57a and 57c, respectively.

There is an alternate and faster way to select the sectors to be displayed. Instead of using Select sectors... of the Events menu and enter the sector numbers into the Edit sector window (Fig. 57b), select the volumes directly in the following way:

Starting with figure 58a, Right-click in succession on the volumes which one wants to display and choose each time Select Super-volume. When done, the Selected volumes window (Fig. 59a) shows the list of volumes. Hit the Sectors button and check the list in the Select sector(s) window (Fig. 59b).

Finally hitting OR produces again figure 58b, with only sectors 3 and 7 displayed.

### Select minimum number of hits

It is possible to restrict the display to MDT chambers which contain at least a specified "Minimum number of hits". In the simulated event of figure 58, the inner stations have 8 possible hits, whereas the middle and outer stations have 6 possible hits. In the Events menu, choose Minimum number of hits.... In the pop-up window (Top figure) set the minimum # of hits to 7. After clicking on OK, only the inner chambers are displayed (Bottom figure).

A faster way to set the minimum number of hits is to use the spinbox \(n\) Hit(s) in the Event tool bar (see figure 2 and appendix E.5).

Figure 59: Alternate method for selecting sectors for display

### Dressing the event

It is often convenient to "dress" the event with surrounding detectors in order to get a sense of orientation in ATLAS. This is particularly true for displays destined for presentations or publication. One can add the detector elements useful for orientation and change the aspect of the display at will. To do this, we use the Selector window and the Navigation tool bar as explained in section 7.

For this exercise, we will again load the predefined detector file for this event: click on the Open view icon of the File tool bar and select Zmumu4023.p2vf in the directory Persint-00-02-\(\bullet\bullet\)/example. The display now resembles figure (a)a.

We want first to change the aspect of the display. In order to ensure fast processing of each action and to get optimal fluidity in the displacements, we turn to the global Wire mode (see section 9.6, item 1) by clicking on the relevant icon in the Image tool bar. The display of figure (b)b is obtained.

We now Zoom-out and Rotate the view using the navigation tool bar as explained in section 8 to obtain a display resembling figure (c)c.

To obtain the display in full volume mode, we click again on the Wire mode icon to obtain figure (d)d.

In this view, the event itself is partially hidden. To remedy this, we will drop some elements of the detector to be displayed. First we remove the endcap toroids by un-checking the relevant item in the AMDB tab of the Selector window and we also remove the lower coil of the barrel toroid by selecting the four left-most coils. Remember that

Figure 60: Display of Event 4023 resulting from the selections made.

the color of the detector items (e.g. the barrel toroid) can be chosen in this pane. These modifications are indicated in figure 61b.

We now remove the feet and the shielding by making the appropriate selection in the AGDD pane of the Selector window, as indicated in figure 61d.

After the selections have been made, click on the Compute icon of the Image tool bar. A view similar to figure 62 is displayed.

To return to the bare event display (without the "dressing"), use elements of the Clear view function to remove AMDB and AGDD volumes.

Figure 61: Modifications made in the Selector window.

Figure 62: Display resulting from the modifications made to the selected detector elements. Track labels were produced as indicated in section 9.1.2.

### Save the view

By clicking on the Save view as icon in the File tool bar the view displayed in the main display can be saved as a.p2vf file to the directory of your choice, e.g. Persint_working_files. This file (e.g. exercise5.p2vf) can be retrieved for later use in Persint via the Open view Scave view as.

The view can also be exported or printed as explained in section 6.4.

### Changing the event file

We now want to use a different event file. In the File menu (or tool bar), choose Data manager and then the Event tab and click on Load. Choose the file "Out.MogyView_Top_evts_5" of the Persint-00-02-\(\bullet\bullet\)/example directory. Persint issues a warning and invites you to load the appropriate geometry file (Fig. 63a): answer Yes in order to load the correct file. A second warning is issued (Fig. 63b) which invites you to load the appropriate magnetic field file. Again, answer Yes.1 The loading of the appropriate files takes several seconds.

Footnote 1: It is possible to use geometry and field files different from the recommended files, by answering No. This may be needed in special cases.

The panes Events and Magnetic field now display the current files which are used, and also the default files (Fig. 64).2

Figure 64: ”Default” files and ”Current” files being used by Persint.

Figure 63: Warnings issued by Persint about loading the proper files.

### Scanning events

Persint is well adapted for scanning events. To illustrate how the scanning works, we shall load a file which contains many events (unlike Out.MboyView_Zmumu4023 which has only one event).

In the Event tab of the Data manager window (Fig. 8), click on Load in the Muon hits file part. In the pop-up window, choose Out.MboyView_1 in the Persint-00-02-\(\bullet\)/example directory, a file of simulated single muon events. Depending on the previously loaded event file, two consecutive warnings, similar to figure 63, are issued about geometry and magnetic field files. Choose the suggested files by answering Yes. Close the Data manager window.

#### 10.8.1 Manual scanning

Click on Next event to display the first event of the file.

The event number is # 3998 and is displayed in the Event number scale of the Event tool bar.

Click on Next event to display the following event.

The details of the event visualization can be defined using a series of functions of the Events menu (e.g. Athena reconstruction, Hit calorimeter cells, Strips, Tubes etc.) 1.

Footnote 1: See Appendix E.5

Any event can be chosen directly from the Event number scale. It can also be entered with the keyboard.

The Reload event icon is used to load the current event again.

#### 10.8.2 Automatic scanning

The scanning can be performed automatically with the Start autoscan icon.

The Autoscan speed icon makes it possible to choose the time between events (1, 2, 5, 10, 20, or 30 seconds). The change of speed can be made "on the fly".

If one wants to work with a given event, the automatic scanning can be interrupted with the Start autoscan icon which has now changed aspect (Stop autoscan).

#### 10.8.3 Visualization properties

By default, each visualization of a new event is done from a predefined perspective. However, when scanning events, it may be convenient to retain the current (modified from the default) visualization properties. This is done with the Store visualization properties icon.

To illustrate this feature, we go back to the first event (#3998) of the loaded event file by choosing the event number in the Event number scale. Display the reconstructed tracks using the Athena reconstruction icon (Fig. 65a).

Now we use the navigation tools to change the visualization properties. First we zoomout and display the ATLAS coordinate axes by choosing Huge axes in the Axes menu (Fig. 65b).

Let's rotate the view to obtain figure 66a. We assume that the Store visualization properties icon is enabled. Clicking on the Next event icon will display event #3999 with the stored visualization properties (i.e. the rotated view). These parameters are used until the Store visualization properties icon is disabled and the next event #4000 is displayed (Fig. 66b).

This feature of changing the visualization parameters can be used "on the fly" in the Autoscan mode.

Figure 66: Events 3998 & 4000

Figure 65: Various views of Event 3998

#### 10.8.4 Using 2D projections

For scanning purposes, it may be useful to use a two-dimentional projected view of the events:

* Stop the autoscan with a click on the Stop Autoscan icon.
* Display the X-projection by clicking on the appropriate item of the Projection menu.
* Resume the automatic scanning with the Start autoscan function. All events are now displayed in the X-projection until the Store visualization properties function is disabled to return to the initial 3D view, or the Stop autoscan function is used to end the automatic scanning.

Figure 67 shows two events captured during the automatic scanning with the X-projection enabled. Note that the display of the axes can be disabled at any time by choosing No axes in the Axes menu.

Figure 67: X-projection of scanned events

## 11 Exercise 6: ATLAS Physics events (2)

In this exercise, we will examine more features provided by the Events menu. They concern the data from the muon spectrometer, the calorimeters, and the Inner Detector. Remember that it may be convenient to save the display as a.p2vf file (e.g. in your Persint_working_files directory) if you must interrupt your work. This is done with the Save view as function, as explained in section 6.4.

### Muon spectrometer data

Again, as in exercise 5, we start from scratch. After starting Persint, we erase the display window with the Clear button of the Image tool bar.

Then we load the necessary files with the Data manager icon of the File tool bar:

* An amdb_simrec.xxx geometry file in the Volumes tab (Fig. 4). Check the box "LoadAGDD Volumes from the AMDB file"
* A magnetic field file in the Magnetic Field tab (Fig. 5).
* The (default) Muon hits file in the Events tab (Fig. 8). Answer Yes if you are invited to load the "expected" AMDB file (see section 6.3, item 4 and figure 9). Furthermore, you are invited to choose the magnetic field map (Fig. 9b) corresponding to the default Event file (answer Yes). Finally, load also the (default) Data Cards file which is needed for interactive muon reconstruction with Muonboy.

To display the event of the default Event file (Out.MboyView_Zmumu4023) 1 click on the Next event icon of the Event tool bar. The muon chambers which contain hits (and only those) are displayed in the figure to the left.

Footnote 1: The file ”Out.MboyView_Zmumu4023” used in this tutorial contains only one event.

#### 11.1.1 Athena reconstructed segments and tracks

Now we want to display the reconstructed tracks in the muon spectrometer.

1. First we choose the parameters of the tracks to be displayed by opening the Set track parameters window. We replace the default values by the following: Set track parameters

* For now, we only are concerned with the first pane (Reconstruction).
* Check "Muonboy segments" (or Moore segments)
* Check "Muonboy tracks at spectro" (or Moore segments)
* Select the "Track shape": Ribbon, Crossed ribbons, or Cylinder
* Set "Track width" to the desired value

The resulting Set track parameters window is shown in figure 68a.

Close the window by clicking on OK, then click on the Compute icon.

To visualize the reconstructed tracks, click on the Athena reconstruction icon and obtain figure 68b.

#### 11.1.2 The event

The event is a "event" event. The event is a "event" event.

2. We will now label the tracks. Select the Default mode in the Navigation tool bar. Move the cursor over the first track, right-click and choose Add customized label. In the pop-up window, un-check the two coordinate boxes and choose the SW position (Fig. 69a). Click on OK. Repeat this operation for the second track to obtain figure 69b. The labels indicate the charges and momenta (in \(GeV/c\)) of the reconstructed tracks. 
3. We may want to save the display into the directory (Persint_working_files) as a.p2vf file, for future use with Persint, using the Save view as... function. Remember that the Export view as... can be used for saving the display for presentations as a (e.g..jpg) file, with the possibility of adding captions, logos or pictures (see sections 6.4 and 6.5).

Figure 69: Event 4023 (second pass)

Figure 68: Event 4023 (first pass)

4. As can be seen in the _Set track parameters_ window, one can choose other objects to be displayed. For example, the choices: "Moore segments" and "MuID extra tracks" shown in figure 69(a) result in figure 69(b), once the customized labels have been added as before.
5. Instead of showing the tracks, one can choose to display only the segments. To do this, open the _Set track parameters_ window and select only the Muonboy or Moore segment box (or both), as shown in figure 60(a). We look now at the upper triplet of detector stations. After rotating the display and zooming-in, we obtain figure 60(b).

Figure 71: Event 4023 (fourth pass)

Figure 70: Event 4023 (third pass)

6. We now choose different settings of the "MDT options" shown in figure 61(a), we rotate the view, and we zoom-in on the BML chambers with the Zoom on custom area function discussed in section 8.3, item 4. We obtain figure 61(b), where one recognizes the hit MDT tubes (in red), the active RPC strips (in yellow) and the reconstructed segment (in red). The labels have been added as explained in section 9.1.2. 
7. We choose now the X-projection in the Image menu. In the _Set track parameters_ window, make the selection shown in figure 61(a) (Reconstructed segments and tracks). The MDT options are again shown in figure 62(a). After zooming, we obtain figure 62(b) where labels (section 9.1.2) and a caption (section 6.5) have been added. The red square is the location of a scattering center along the reconstructed track. Multiple scattering is computed at that location, using the track momentum and the average amount of surrounding material.

Figure 73: Event 4023: Zoomed X-projection with reconstructed tracks

Figure 72: Event 4023 (fifth pass)

8. Finally, selecting segments instead of tracks in the _Set track parameters_ window, according to figure 6(a), and choosing the MDT options of figure 6(a), we obtain the display of figure 6(b).

Figure 74: Event 4023: Zoomed X-projection with reconstructed segments

#### 11.1.2 Simulated muon tracks

This exercise is only valid for simulated events!

* Start with an empty main display by using the Clear view function.
* Load the previous event again (Event 4023) with the Reload event function.
* Open the Set track parameters window and make the following additional selections: Generate tracks at IP and Only muons so as to obtain the overall selections of figure 75b.
* Click on 0K to close the window.
* Validate the selections by clicking on the Compute icon.
* To visualize the generated tracks, click on the Simulation tracks icon. The simulated tracks appear (from the IP).
* Click on the Athena reconstruction icon and the reconstructed tracks appear superimposed on the simulated tracks, as expected for a successful reconstruction (Fig. 75c).

Figure 75: Event 4023 (sixth pass)

#### 11.1.3 Reconstructed muon tracks and invariant mass

As seen in 11.1.2, the reconstructed tracks are visualized with the Athena reconstruction icon (Figure 75c). It is possible to compute the invariant mass of two reconstructed muon tracks in the following way.

* Start with an empty main display by using the Clear view function.
* Load the previous event again (Event 4023) with the Reload event function.
* Click on the Athena reconstruction icon and the two reconstructed tracks appear. (Fig. 76a).
* Select the two tracks by clicking in turn on each track, so that their parameters appear on two lines in the Selected volumes window (Fig. 76b). Athena reconstruction It may be necessary to increase the width of the tracks in order to make the selections easily. The track width can be increased e.g. to 8, in the Set track parameters window (Appendix E.5.1). 
* Click on Inv. mass to compute the invariant mass of the selected muon tracks. The result is shown in figure 76c.

Figure 76: Invariant mass of two reconstructed muon tracks

#### 11.1.4 Interactive reconstruction with Muonboy

We start again with Event 4023 of the Out.MboyView_Zumumu4023 file. Make sure all necessary files are loaded by using the Data manager windows. In particular the Magnetic field file and the Data cards file need to be loaded as indicated in figures 5 and 8 on pages 21- 22. Use the default files for this exercise. Click on the Muonboy interactive reconstruction icon. Two reconstructed candidate tracks are displayed.

We now make a customized label for each candidate (see section 9.1.2) and obtain figure 77.

For each candidate track which is displayed, the Muonboy pane at the bottom left of the Persint display shows the characteristics as seen in figure 78. This pane also shows a warning if no muon could be reconstructed. 1

Footnote 1: e.g. an explicit message is issued if data such as alignment parameters of the A-lines are missing.

In the Muonboy window, the total invariant mass of all reconstructed muons is displayed.

Figure 78: The parameters of each muon candidate are shown in the Muonboy pane. They include the signed momenta of reconstructed muons, the track fitting parameters, and the invariant mass of a muon pair.

Figure 77: Display of two candidate tracksA table containing the parameters of all reconstructed muons can be obtained by clicking on the icon at the right hand side of the title bar, which makes it a floating window. When this table (Fig. 79) is displayed, a right-click on the content will offer the Copy to clipboard function which can be used to save the reconstruction data in a text file.

The boxes at the bottom of the window make it possible to calculate the invariant mass of any number of muons by making the appropriate selections. In figure 79 with one box checked, the invariant mass is the muon mass. Again, the table may be copied to the clipboard and saved.

Figure 79: The Muonboy window, with a table of all reconstructed muons. The total invariant mass is given at the top, the invariant mass of the chosen muon(s) at the bottom. The Copy to clipboard function is obtained by high-clicking on the table.

#### 11.1.5 Color code for MDT hits

The interactive reconstruction can be used to look at the reconstruction process in detail. We start again with Event 4023 of the Out.MboView.Zmumu4023 file. Make sure all necessary files are loaded by using the Data manager windows. In particular the Data cards file and Magnetic field file need to be loaded as indicated in figures 5 and 8 on pages 21 and 22. Use the default files for this exercise.

With the nominal MDT options (Fig. 80a), we obtain the display of figure 80b.

We now choose the X-projection with the Projection menu, and zoom on the BIL chamber indicated by a label to obtain figure 81b which uses the MDT options of figure 81a.

Figure 81: Event 4023: Detail of BIL chamber in the X-projection

Figure 80: Event 4023 without reconstructionThe reconstructed track is obtained by clicking on the Muonboy interactive reconstruction (Fig. 82).

The color code for MDT hits is the following: black hits are those selected by the pattern recognition, red hits do not belong to a track (all hits are selected by the pattern reconstruction in figure 82).

The interactive reconstruction can be used to act on the event characteristics to understand which role they play. For instance, a hit MDT tube or a RPC strip can be removed with the Move volumes to infinity (see section 9.2). Then, when re-running the reconstruction algorithm, the removed tube or strip will not be taken into acccount.

Figure 82: MDT hits after reconstruction (black)

### Inner Detector data and Vertex display

The primary vertex as well as secondary vertices are available for display. Histograms of primary vertices can also be produced.

The primary vertex is obtained by a fit of all reconstructed Inner Detector tracks. Likewise, the secondary vertices are obtained from an analysis of the ID tracks.

The default settings in the ATHENA job options produce the primary vertex candidate in the Persint event file OUT.MboyView_xxx, as seen in Appendix D.3.7: the line VTX appears seven lines before END EVT line.

To obtain the secondary vertices in OUT.MboyView_xxx, the proper job options need to be chosen when running the reconstruction programs in ATHENA.

#### 11.2.1 Vertex display

* Start with an empty main display by using the Clear view function.
* Load the previous event again (Event 4023) with the Reload event function.
* To best illustrate this function which displays the vertex, we will first display the Inner Detector tracks:

Open the Set track parameters window and make the selections shown in figure 83.

In particular, check the "ID tracks at IP" box.1

Figure 83: Selection made in the Set track parameters window to display Inner Detector tracks at the IP.

* Click on [OK] to close the window.
* Zoom on the vertex region and obtain figure 84, with the Primary vertex displayed.

#### Histogram of \(d0\) (primary vertex)

A histogram of the primary vertex candidates in an event is obtained by clicking on the item _Histogram of \(d0\) distribution_ in the _Events_ menu (See Appendix E.5). The histogram can be saved in various formats [.png,.gif,.ps,.eps,.pdf,.C (ROOT macro)].

Figure 84: Display primary vertex.

Figure 85: Histogram of \(d0\): distribution of primary vertex candidates for a \(7\)\(TeV\) collision event.

Each Inner Detector track has an associated \(d0\). (Run 155678, Event 13304729)

### Calorimeter data

#### Display calorimeter hits

* Start with an empty main display by using the Clear view function.
* Load the previous event again (Event 4023) with the Reload event function.
* Open the Set track parameters window and choose, in each of the four tabs, the values shown in figure 86. Make sure to select Energy as Cut-off criterion in the Calorimeter cells tab. 
* Click on 0x to close the window.
* Validate the selections by clicking on the Compute icon.
* To visualize the reconstructed muon tracks, click on the Athena reconstruction icon.
* To visualize the calorimeter cells which have a signal, click on the Hit calorimeter cells icon.
* To dress the display with some detectors, make the selections in the AMDB pane of the Selector window, as shown in figure 87a.

Figure 86: Selection made to obtain the display of figure 87Figure 87b is the result of these these selections and shows the reconstructed muon tracks, the calorimeter cells with hits and two sectors of the calorimeters and inner detector.

This display may now be saved for future use: click on the Save view as... icon and save the file as exercise6-Calo-low-thresholds.p2vf in your Persint_working_files directory.

#### Display calorimeter hits with increased thresholds

1. **Display bare calorimeter hits** Starting with the display of figure 87b 1, we now change the thresholds for displaying calorimeter hits, as they were set very low in the default settings.

Footnote 1: In case the work was interrupted, remember that the display was saved as a.p2vf file.

Open the Set track parameters window and change the values according to figure 88. Note that the thresholds may be set for Energy or Transverse energy.

Instead of setting the parameters by hand, you may load the prepared Track parameter file which we already used in section 6.1.2, item 3. Click on Open and select Zmumu4023.p2ts in the Persint-00-02-\(\bullet\)/example directory. Click on OK and then on the Compute icon. Activate the Athena reconstruction and Hit calorimeter cells icons to obtain the display of figure 89.

Note that the dressing with calorimeter and Inner detector sectors has been removed by clicking in the center of the three wheels of figure 87a.

Note also that since the "ID tracks at IP" box is checked with a \(0.5~{}GeV/c\) threshold (Fig. 88), Inner detector tracks are displayed as well.

Figure 87: Display of event 4023 with two reconstructed muon tracks, and hit calorimeter cells: electromagnetic liquid argon in red, [hadronic Tile, endcap, and forward calorimeters] in purple

2. **Display calorimeter hits inside cell envelopes** In the _Set track parameters_ window (Calorimeter Cells), check the Draw cell envelope box and increase the threshold of "LAr e.m. end-cap (EMEC)" to 0.5 \(GeV\), and to 2 \(GeV\) for "HEC" and "FCal" (Fig. 90). Save the selections as a.p2ts file with the \(\left(\text{\small Save}\right)\) box of the _Set track parameters_ window.

Figure 88: Selection made to obtain the display of figure 89

Figure 89: Display of event 4023 with increased thresholds for calorimeter hits: essentially 2 \(GeV\) in forward calorimeters. Reconstructed Inner detector tracks are also displayed

After making an X-projection and after some zooming, we obtain the display of figure 91.

Figure 91: Display of event 4023 (X-projection) with increased thresholds for calorimeter hits shown within cell envelopes

Figure 90: Selection of thresholds and cell envelopes to obtain the display of figure 91

Figure 91: Selection of thresholds and cell envelopes to obtain the display of figure 91

#### 11.3.3 Histogram of calorimeter hits

Note that the use of the Histogram facility requires that the dependency for QtROOT be satisfied (see Appendix B).

We start again with Event 4023 of the Out.MboyView_Zmunu4023 file.

Open the Set track parameters window and choose Restore defaults. Once the event is displayed, click on the Histogram of hit calorimeter cells (also available in the Tools menu). The histogram is displayed in figure 92 and shows the cell energy as a function of Eta (Pseudo rapidity \(\eta\)) and Phi (Azimutal angle \(\phi\)).

We now increase the thresholds of the cell energy in the Set track parameters window as shown in figure 93.

Figure 93: Selection of high thresholds in the Set track parameters window: energy thresholds of LAr HEC and FCal have been set to 20 \(GeV\).

Figure 92: Histogram of hit calorimeter cells (low thresholds)To display the modified histogram, close the _Set track_ parameters window by clicking on the [0.0] box and then on the _Compute_ icon.

Finally, clicking on the _Histogram of hit calorimeter cells_ icon two times, displays the modified histogram (Fig. 94).

Note that calorimeter cell thresholds may be set according to _Energy_ or _Transverse energy_. The selection is made via the _Cut-off criterion_ box in the _Set track parameters_ window.

The histogram can be resized or displaced at will by using the pop-up window obtained by _right-clicking_ on the title bar of the histogram window.

With _Maximize_, the histogram will occupy the entire area of the Main display.

With _Minimize_, the histogram is reduced to a "tab" at the bottom of the display, and can be retrieved with _Restore_.

Just as with previous maps (9.7.3, 9.8, and 9.9), the histogram can be exported as an ASCII file (.dat format) with the _Export_ button.

The histogram can be saved by clicking on the [0.5] box. A number of formats are proposed, as shown in figure 95.

Note that, when scanning events (see section 10.8), the histogram is automatically refreshed when a new event is displayed.

Figure 94: Histogram of hit calorimeter cells (high thresholds)

Figure 95: File formats proposed when saving the _Histogram of hit calorimeter cells_

### Physics objects

#### 11.4.1 Jets

Reconstructed jets can be shown as labels placed on calorimeter cells.

We will use a real event from data collected in 2011. First clear the display by clicking on Clear view in the Clear icon menu.

Open the Data manager window and load the file Out.MboyView-74566644-1 from the Persint-00-02-**/example directory. Answer "Yes" to the suggestion to load the proper geometry file.

Open the Set track parameters window and click on Restore defaults. This will result in the parameters to be set according to figure 96 which shows the parameters for Reconstruction, Calorimeter cells, and Physics. In particular, use the Physics window (Fig. 96c) to set the parameters for displaying the jets:

* check the Jets box
* set the scale (in cm/GeV) for the jet cone (box 1)
* set the scale (in cm/GeV) of the arrow of the jet axis (box 2)
* choose the number of faces of the jet cone
* choose the wire or solid mode for the jet cone

Click on OK and then on the Compute icon1.

Footnote 1: Remeber that it is usually necessary to click on the Compute icon after closing the Set track parameters window.

Figure 96: Selection made for displaying jets in event 74 566 644 (Fig. 97).

Add the default caption by right-clicking on an empty space of the display.

Add default labels by right-clicking on one of the jet axes and one of the jets cones. The result is shown in figure 97.

Note that the size (scale) of the jet cones and jet arrows, as well as the color (blue in figure 97) can easily be modified in the _Set track_ parameters window, Physics tab.

#### Missing \(E_{t}\)

A vector representing the calculated missing transverse energy (missing \(E_{T}\)) can be drawn in the following way:

Click on the _Set track_ parameters icon in the Events tool bar (or use the Events menu), and go to the Physics tab. Check the Missing \(E_{T}\) box, and hit the Compute icon. Note that the legnth of the arrow does not reflect the size of missing \(E_{T}\), but is determined by the value (in cm) given in the spin box in the Missing \(E_{T}\) line of the _Set track_ parameters window. The color of the arrow (green in figure 98) can be chosen in the Set track parameters window, Physics tab (Fig. 96c).

The value of the Missing \(E_{T}\) can be looked up in the information box which appears when placing the cursor on the arrow. The same information appears if one inserts a "label" by right-clicking on the Missing \(E_{T}\) arrow. Note that the value of the Missing \(E_{T}\) corresponds to the variable MET_RefFinal.

Figure 98 shows the same event with the Missing \(E_{T}\) arrow.

Another illustration of the "Missing \(E_{T}\)" feature can be found in figure 119.

Figure 97: Display of an event from 2011 data where the ”jet” feature is illustrated.

#### 11.4.3 RoI (Regions of Interest from trigger)

Under development

Figure 98: Display of the same event where the ”Missing \(E_{T}\)” feature is illustrated.

## 12 Persint: a versatile tool

### An analysis tool

Many features of Persint can be used for illustrating the properties of the muon spectrometer. For example, the Generate muon tracks function is a convenient tool for studying the behavior of muons in the spectrometer. In the early collision data of 2009, a charge asymmetry of low energy muons was spotted in the forward regions.

The effect has its explanation in a rather subtle acceptance property of the spectrometer for positively and negatively charged muons. Persint was used to illustrate this behavior [8].

Figure 100: Illustration of the charge asymmetry of forward low energy muons in \(900~{}GeV\) collision data. The intricate acceptance effect is illustrated with generated positive (red) and negative (blue) muons in the forward regions.

Figure 99: Scatter plot showing the \(\mu^{-}/\mu^{+}\) asymmetry: \(\mu^{-}\) are more numerous in the \(\eta>0\) region, whereas \(\mu^{+}\) are more numerous in the \(\eta<0\) region. This is true for \(900~{}GeV\) collision data and Monte Carlo events.

The muons of figure 100 have been generated with the parameters shown in the Generate muon tracks window of figure 101: \(P=10~{}GeV\) and \(\mid\eta\mid\in[2.5,3.0]\)

Figure 101: List of muon tracks generated in figure 100. Muons of momentum \(P=10~{}GeV\) have been generated at the IP and propagated through the calorimeters, using the Generate muon tracks function (section 7.1)

### Study of the geometry and dead material

Persint has been used to optimize the muon spectrometer throughout the design phase. At present it is the tool with which the most recent layout and the dead material content of ATLAS support structures are being introduced into the geometry discription used by the reconstruction software.

As an example, the latest barrel toroid cryotube structure has been introduced into the geometry. With this study using Persint the primary numbers entering the geometry data base have been updated.1

Footnote 1: The GEOMODEL in particular uses these primary numbers.

Figure 102: Using Persint for the geometry description: the modified volumes are visualized and the primary numbers are entered into the data base.

[MISSING_PAGE_EMPTY:96]

Figure 106: The same \(J/\Psi\to\mu\mu\): in 2D projections and details of track reconstruction.

Figure 105: A \(J/\Psi\to\mu\mu\) candidate in the 7 TeV collision data of 2010.

Figure 109: The same \(W\to\mu\nu\) candidate: in 2D projections and details of track reconstruction.

Figure 108: A \(W\to\mu\nu\) candidate in the 7 TeV collision data of 2010.

[MISSING_PAGE_EMPTY:102]

[MISSING_PAGE_EMPTY:103]

[MISSING_PAGE_EMPTY:104]

[MISSING_PAGE_EMPTY:106]

[MISSING_PAGE_EMPTY:107]

[MISSING_PAGE_EMPTY:108]

## Chapter 13 Selected Event Displays

## Chapter 13 Selected Event Displays

[MISSING_PAGE_EMPTY:113]

## 14 Useful hints

1. Compute The effect of the Compute icon is to make all computations necessary to display an event, after changes have been made to the parameters. Actionning Compute is not always necessary: For example, after closing the Set track parameters window by clicking on OK, it is necessary to validate further with Compute. On the contrary, after closing the Generate muon tracks window with OK, it is not necessary to use Compute. There is no general rule for using the Compute action. When in doubt, it is always prudent to use it.
2. Interrupt/resume your work It is important to realize that it is possible to interrupt and resume your work at any time. In case Persint cannot be left idle during the pause, you can save the files used by the program as specific ASCII files. The relevant files (described in Appendix D) are: * The.p2vf file It contains everything necessary 1 for displaying the current view of the Main display (see section 6.4, item 1). The file is saved with the Save view as. Footnote 1: Labels and captions are saved but pictures (e.g. the ATLAS logo) are not. Save view as. Footnote 2: The.p2gm file This file contains the parameters of the tracks generated with the Generate muon tracks icon (section 7.1). The file is saved from within the Generate muon tracks window by clicking on the Save box. * The.p2ts file This file contains the parameters of the Set track parameters window (Appendix E.5.1). These parameters define the objects chosen for display in an event (Tracks, segments, MDT, RPC, ID hits, calorimeter hits, electrons, photons, etc.), as well as their energy or momentum thresholds. The file is saved from within the Set track parameters window by clicking on the Save as.. box 3. Previous view When modifying the aspect of a view with the navigation tools, is is sometimes difficult and time consuming to go back to a previous display which seemed satisfactory. The Previous view icon makes it possible to retrieve up to \(\sim\) 100 displays backwards.

## 15 Appendices

### A Architecture

Persint, the detector and event display for the ATLAS muon spectrometer originally conceived by Marc Virchaux, now has a new Graphical User Interface developped with\(Qt\). This appendix gives a short description on how the software source code is organized.

* **Software development philosophy** 

As shown in figure 124, the source code is divided into 3 distinct parts :

1. The core corresponds to Fortran code, e.g. algorithms for computing hidden faces, routines for reading input files, and so forth...
2. The "wrapping" layer, written in \(C^{++}\), is a communication layer between the program core and the graphical interface. It is made of classes encapsulating the calls to Fortran routines.
3. The \(C^{++}\) code for the Graphical User Interface (GUI).

Thus, there is no direct call to Fortran core routines from the GUI as they are only called by the wrapping layer. Wrapper classes are organized by topics, e.g. one for views, one for AMDB volumes, etc...

* **File organization** Most source files created for the new interface are located in one of the following three directories : 1. PersintCore/persint2_core This directory contains all Fortran routines called by the "wrapping" layer. Most of theses routines have been written specifically for the new GUI and are code fragments extracted from the initial HIGZ-based version of Persint. Like wrapper classes, these routines are organized by topics. For example, all methods dealing with AMDB volumes are gathered in file wrap_amdb.FF90. Moreover, each routine name is prefixed with a string identifying its topic :

Figure 124: Architecture of the Persint source codeAMDB volume related routines start with "AMDB_", etc.... Files whose name does not start with "wrap_" only contain routines called from other Fortran routines, not directly from the wrapper classes.
2. Persint2Core This directory contains C\({}^{++}\) header (.h) and source (.cpp) files respectively defining and implementing all wrapper classes. Each wrapper class in this directory is associated with a Fortran file in the PersintCore/persint2_core directory. The only constructor in each of these classes has the "protected" attribute, so that the only way to actually instantiate a wrapper class - and to access its methods - is by creating a derived class. These wrapper classes have been implemented so that, whenever possible, they use standard C\({}^{++}\) libraries rather than \(Qt\)-specific tools. This directory also contains classes required by the GUI but without calls to Fortran routines (e.g.: ColorF, persint::Colors, FCSString,...).
3. PersintGui This directory contains all \(Qt\) classes developped for the new interface. Files with.ui extension are XML files created with the \(Qt\) designer and describing widgets. They should be edited with the designer-qt4 executable. The directory also contains.h and.cpp files implementing classes derived from \(Qt\) widgets. These classes inherit from wrapper classes as is necessary for interacting with the core of the application. For instance, the persint::AmdcVolumeTree class inherits from the persint::Amdb wrapper class in order to be able to access functions related to AMDB volumes. Files ending with _moc.cxx or _ui.h are generated automatically by \(Qt\) tools during compilation and should not be edited by hand.
* **Sample ASCII files** The various files used by Persint are listed and described in Appendix D. They include files which contain all the information about geometry, detector description, magnetic field, events, track parameters, generated muons, etc.

## Appendix B Installation and dependencies

This chapter is included in the manual for reference and for completeness.

However, for **up-to-date instructions** and **easy installation**, consult the **Twiki page**

[https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki](https://twiki.cern.ch/twiki/bin/view/Atlas/Persint2Wiki)

and use **copy-paste** operations.

The latest release of Persint is : **Persint-00-02-57**. This version number is used throughout these instructions. Check for the latest version at the link indicated above. Earlier releases can be found at:

[http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/](http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/)

The running of Persint is dependent on a number of libraries which need to be installed beforehand. Satisfying these dependencies involves procedures which depend on the platform. On the contrary, the installation of Persint proper is common to all platforms. The complete procedures 1 are described below for reference. Bugs, comments, installation problems, or questions can be reported to :

Footnote 1: When updating to a new version of Persint, it is usually sufficient to do only the installation without repeating the part concerning dependencies.

[https://groups.cern.ch/group/atlas-sw-persint-support/default.aspx](https://groups.cern.ch/group/atlas-sw-persint-support/default.aspx)

### Supported platforms

Persint is developed under the latest **Ubuntu** release. We also make sure it runs at CERN on **lxplus** machines as well as under **Fedora**. We provide best effort support for **Mac OS X**.

Figure 125: History of Persint installation

### Installation

#### b.2.1. Tarball (default procedure)

Download and install the complete source tarball (15 MB).

In the following, -00-02-** is the evolving version number of Persint, e.g. Persint-00-02-57

 wget [http://atlasinfo.cern.ch/Atlas/GROUPS/MUON/Persint/releases/00.02](http://atlasinfo.cern.ch/Atlas/GROUPS/MUON/Persint/releases/00.02).**/  src/Persint-00-02-**.tar.gz

 tar xvfz Persint-00-02-**.tar.gz

 cd Persint-00-02-**

./configure

 make -j3

./start_persint.sh

**Warning**: the above instructions assume **all dependencies** are satisfied.

#### b.2.2 svn

Download code from source repository and install, as follows.

After configuring subversion, checkout the Persint source code. From the Persint directory, run the bootstrap.sh script to download other required Atlas software components. You can then start compilation with "make".

After you are done, simply run the.start_persint.sh script, that will set your library and binary paths and run the program.

 export SVNROOT=svn+ssh://svn.cern.ch/reps/atlasoff

 svn co $SVNROOT/graphics/Persint/tags/Persint-00-02-** Persint-00-02-**

 cd Persint-00-02-**

./bootstrap.sh

make -j3

./start_persint.sh

**Warning**:

* The above instructions assume **all dependencies** are satisfied.
* **Subversion configuration**: if your local username is different from your lxplus username, you may need to specify the latter in your $HOME/.ssh/config file. For details, see: [https://twiki.cern.ch/twiki/bin/viewauth/Atlas/SoftwareDevelopWorkBookSVN](https://twiki.cern.ch/twiki/bin/viewauth/Atlas/SoftwareDevelopWorkBookSVN).

#### b.2.3 Ubuntu package

Persint is available as an **Ubuntu** package on a dedicated repository 1. However, this package provides a version of Persint without histograms (because ROOT is no longer available as an Ubuntu package). To benefit from histograms, you need to install Persint by hand.

The procedure below can be found at:

[http://sizun.web.cern.ch/sizun/persint/ubuntu.html](http://sizun.web.cern.ch/sizun/persint/ubuntu.html).

#### b.2.4 Pre-installed lxplus version

If you have an account on the **lxplus** network, you can run a version of **P**ersint pre-installed on **AFS**, though it might be a little slower.

Run the pre-installed version of **P**ersint on lxplus:

```
ssh-Xlxplus.cern.ch \ln-sf/afs/cern.ch/atlas/www/GROUPS/MUON/Persint/releases/00.02.**/slc5-x86_64-gcc34/share/Persint/start_persint.sh./start_persint.sh
```

### Dependencies

**P**ersint no longer requires either **C**ERNLIB, HIGZ or LAPACK.

#### b.3.1 Mandatory requirements

1. **Install C\({}^{++}\) compiler** * **Ubuntu** * sudo apt-get install g++ * **Mac OS X** After installing MacPorts (see B.4.1): * sudo port install gcc46 * **Fedora** With administrative privileges (su command), execute the following command line: * yum install gcc-c++ * **Debian**sudo apt-get install g++
* **CentOS 5/6** With administrative privileges (su command), execute the following command line: yum install gcc-c++
* **CernVM** After installing OpenAFS: source /afs/cern.ch/sw/lcg/external/gcc/4.3/'uname -m'-slc5/setup.sh
* **Cygwin** Update your Cygwin installation by running the setup.exe program to install the following package: gcc4-g++
2. **Install a fortran compiler** * **Ubuntu** * sudo apt-get install gfortran * **Mac OS X** After installing MacPorts: sudo port install gcc46 * sudo ln -s /opt/local/bin/gfortran-mp-4.6 /opt/local/bin/gfortran
* **Fedora** With administrative privileges (su command), execute the following command line: yum install gcc-gfortran

* sudo apt-get install gfortran
* **CentOS 5/6** With administrative privileges (su command), execute the following command line: yum install gcc-gfortran
* **Cygwin** Update your Cygwin installation by running the setup.exe program to install the following package: gcc4-fortran
3. **Install other standard utilities: wget, make, perl, pkg-config, head, sed** * **Mac OS X** After installing MacPorts : sudo port install wget pkgconfig * export PKG_CONFIG_PATH=/opt/local/lib/pkgconfig; You might want to add PKG_CONFIG_PATH to your login script.
* **Fedora** With administrative privileges (su command), execute the following command line: yum install wget pkgconfig xterm perl

* sudo apt-get install make pkg-config
* **CentOS 5/6** With administrative privileges (su command), execute the following command line: yum install gcc-gfortran

* sudo apt-get install gfortran
* **CentOS 5/6** With administrative privileges (su command), execute the following command line: yum install gcc-gfortran
* **Cygwin** Update your Cygwin installation by running the setup.exe program to install the following package: gcc4-fortran
3. **Install other standard utilities: wget, make, perl, pkg-config, head, sed** * **Mac OS X** After installing MacPorts : sudo port install wget pkgconfig * export PKG_CONFIG_PATH=/opt/local/lib/pkgconfig; You might want to add PKG_CONFIG_PATH to your login script.
* **Fedora** With administrative privileges (su command), execute the following command line: yum install wget pkgconfig xterm perl

* sudo apt-get install make pkg-config
* **CentOS 5/6** With administrative privileges (su command), execute the following command line: yum install gcc-gfortran

* sudo apt-get install gfortran
* **CentOS 5/6** With administrative privileges (su command), execute the following command line: yum install gcc-gfortran

* sudo apt-get install gfortran
* **CentOS 5/6** With administrative privileges (su command), execute the following command line: yum install gcc-gfortran
yum install wget pkgonfig xterm perl make
* **Cygwin** Update your Cygwin installation by running the setup.exe program to install the following package: wget makesed tar pkg-config
4. **Install Qt** Persint requires Nokia's _Qt_ framework (\(\geq\)4.3.4). * **Ubuntu** sudo apt-get install libqt4-dev * **Mac OS X** After installing MacPorts : sudo port install qt4-mac +debug This may take a whileddots
* **Fedora** With administrative privileges (su command), execute the following command line: yum install qt-devel
* **Debian** sudo apt-get install libqt4-dev
* **CentOS 5** The release of Qt (4.2) provided by the qt4-devel CentOS 5 package is too old for Persint. Hence, Qt needs to be installed from source. Set the PKG_CONFIG_PATH variable appropriately to indicate to Persint the location of Qt.
* **CentOS 6** With administrative privileges (su command), execute the following command line: yum install qt-devel
* **Cygwin** Update your Cygwin installation by running the setup.exe program to install the following package: qt4-devel-tools libQtCore4-devel libQtGui4-devel libQtTest4-devel libQtNetwork4-devel
* **CernVM** After installing OpenAFS, add the path of Qt on AFS to the PKG_CONFIG_PATH variable: export PKG_CONFIG_PATH=/afs/cern.ch/sw/lcg/external/qt/4.6.3/ 'uname -m'-slc5-gcc43-opt/lib/pkgonfig/:$PKG_CONFIG_PATH
* **Scientific Linux Cern*
* The release of Qt (4.2) provided by the qt4-devel SLC5 package is too old for Persint. Hence, Qt needs to be installed from source.
* lxplus The location of the Qt library on AFS will be automatically taken care of by the Persint makefile and the start up script.
* Non-lxplus machine with access to CERN AFS directories Qt is installed in the /afs/cern.ch/sw/lcg/external/qt/ directory. Choose the appropriate version and add the path of the lib/pkgonfig subdirectory to your PKG_CONFIG_PATH environment variable.
* Standalone machines Download and install Qt from source. If you do not install it into a standard location, add the path of the lib/pkgonfig subdirectory to your PKG_CONFIG_PATH environment variable.

#### b.3.2 Optional features

Install QtROOT.QtRoot is a Qt plugin of ROOT, used to display ROOT histograms within the Qt interface. The version of QtROOT you install should be compatible with your version of the Qt4 library.

1. **General instructions** * Method 1 The simplest way to get QtROOT is to install ROOT with the -enable-qt flag. You first need to install Qt and pkg-config to allow the ROOT configure script to find Qt. Then : wget [ftp://root.cern.ch/root/root_v5.30.00.source.tar.gz](ftp://root.cern.ch/root/root_v5.30.00.source.tar.gz) tar xvfz root_v5.30.00.source.tar.gz cd root export QIDIR='pkg-config --variable=prefix QtCore'./configure --enable-qt --prefix=<PREFIX> --etcdir=<PREFIX>/etc make mask install
* Method 2 To install the latest QtRoot module, you will need to use the official INSTALL_QTROOT.sh script and to follow these instructions. This method is for experts of Unix only. After installing Qt and pkg-config, you will have to download the INSTALL_QTROOT.sh script and patch the script before running it: wget [http://root.bnl.gov/QtRoot/INSTALL_QTROOT.sh](http://root.bnl.gov/QtRoot/INSTALL_QTROOT.sh) wget [http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/](http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/) INSTALL_QTROOT.sh.patch patch < INSTALL_QTROOT.sh. patch chmod u+x INSTALL_QTROOT.sh export QTDIR='pkg-config --variable=prefix QtCore'./INSTALL_QTROOT.sh The existing version of Qt package has been found under QTDIR= Do you want to use it? (yes/no) yes Do you want to proceed? (yes/no) yes Do you want to install COIN3D also? (yes/no) no After installation is complete, you need to run the QtRoot setup script:./set_environment.sh You might want to add this command to your login script.
2. **Ubuntu** In Ubuntu releases 8.10 (Intrepid), 9.04 (Jauntedy), 10.04 (Lucid) and 10.10 (Maverick), QtRoot is directly available as an Ubuntu package : sudo apt-get install root-plugin-qt libroot-dev For other releases, follow general instructions above, but set the QTDIR variable by hand to: export QTDIR=/usr/share/qt4
3. **Mac OS X** After installing MacPorts, install the qt_mac variant of the root port: yum install qt-devel4. **Fedora** With administrative privileges (su command), execute the following command line: yum install root-gui-qt root-physics
5. **CernVM** After installing OpenAFS: source /afs/cern.ch/sw/lcg/app/releases/ ROOT/5.30.00/'uname -m'-slc5-gcc43-opt/root/bin/thisroot.sh

Install SOCI library.Persint uses the SOCI library for access to the ATLAS Oracle databases, to download extra geometry files. This feature is **really optional**.

1. Install the Oracle Database Instant Client software development kit. * **Ubuntu** 1. Go to the Oracle download page, in the Instant client section and select the appropriate platform. Download the Instant Client Basic RPM package and the Instant Client SDK RPM package. You will need to create a (free) Oracle user account an to accept the license agreement. 2. Convert the RPM packages into debian packages : sudo apt-get -y install alien suda alien -d oracle-instantclient-basic-<version>-<platform>.rpm oracle-instantclient-basic-<version>-<platform>.rpm 3. Install the generated debian packages and their dependency libaio : sudo pkg -i oracle-instantclient-basic-<version>-<platform>.de oracle-instantclient-basic-<version>-<platform>.deb sudo apt-get -y install libaio1 4. Define some environment variables to notify Persint of Oracle's location: export ORACLE_LIBDIR=/usr/lib/oracle/<version>/client/lib; export ORACLE_INCDIR=/usr/include/oracle/<version>/client; (The exact name of the installation directories will depend on your platform.)
* **Mac OS X*
* Install the oracle-instantclient port: sudo port install oracle-instantclient Make sure you download the actual zip files and not an HTML error page (accept the license agreement first, and use the left mouse button). 1. Delete intermediate files created by the failed building process and create a directory /opt/local/var/macports/distfiles/oracle-instantclient: sudo port clean --all oracle-instantclient sudo port selfupdate sudo mkdir -p /opt/local/var/macports/distfiles/oracle-instantclient
2. Go to the Oracle download page, register, download manually the packages instantclient-basic-10.2.0.4.0-macosx-x64.zip and instantclient-sdk-10.2.0.4.0-macosx-x64.zip and place them into the newly created directory: /opt/local/var/macports/distfiles/oracle-instantclient

[MISSING_PAGE_EMPTY:124]

2. **Updating MacPorts ports** **sudo ports selfupdate** **sudo port upgrade outdated**

#### b.4.2 CernVM

1. **Installing CernVM** * VirtualBox ([https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)) * [http://cernvm.cern.ch/portal/downloads](http://cernvm.cern.ch/portal/downloads) * CernVM ([https://twiki.cern.ch/twiki/bin/viewauth/Atlas/CernVM](https://twiki.cern.ch/twiki/bin/viewauth/Atlas/CernVM)) * CernVMGuideSoftwareInstall ([https://twiki.cern.ch/twiki/bin/viewauth/Atlas/CernVMGuideSoftwareInstall](https://twiki.cern.ch/twiki/bin/viewauth/Atlas/CernVMGuideSoftwareInstall))
2. **Installing OpenAFS** * See CernVM release notes ([http://cernvm.cern.ch/portal/release_2.4.0](http://cernvm.cern.ch/portal/release_2.4.0)) * Do: * sudo conary update group-openafs-client openafs openafs-client * sudo conary update kernel-module-openafs-'uname-r' * sudo mkdir -p /afs * echocern.ch > /tmp/ThisCell * sudo cp /tmp/ThisCell /usr/vice/etc/ThisCell After reboot, AFS should be mounted under /afs. To authenticate use the kinit command.
3. **Installing binary distribution of Persint** * Install AFS and authenticate with kinit * Download, install and setup binary kit * wget [http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/00.02.57/Persint-00-02-](http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/00.02.57/Persint-00-02-)*-cernvm-'uname -m'-gcc43-qt463.tar.gz tar xvfz Persint-00-02-*-cernvm-'uname -m'-gcc43-qt463.tar.gz cd Persint-00-02-*- source install_cernvm.sh./start_persint.sh

#### b.4.3 Cygwin

1. **Installing Cygwin under Windows 7** Install Cygwin by running setup.exe. * In addition to the packages listed in the dependencies, select the following packages required to connect to an X server: xorg-server xinit * Before starting Persint (using the start_persint.sh script), connect to a Cygwin/X server by typing startxwin from the Cygwin shell.

## Appendix C ATLAS coordinate system

Figure 126: ATLAS coordinate system.

## Appendix D Files used in _Persint_

### File formats

Several types of files are encountered when using _Persint_. Most are specific to _Persint_, except the "exported" files used for presentations and publications.

\begin{tabular}{|l|l|l|l|} \hline
**File extension** & **Description** & **Default directory** & **Comments** \\ \hline.p2vf & Detector description file. & & & Produced by _Persint_ with the _Save_ view as function of the _File_ menu. \\  & Detector description file. & /example & Retrieved with the _Open_ view function. \\  & & & (Section 6.3, item 3) \\ \hline.p2ts & Track parameter file for displaying an event & _Persint_-00-02-\(\bullet\bullet\)/example & _Produced with _Save_ or _Save_ as, retrieved with _Open_ in the _Set_ track parameters window. \\  & & & (Section 6.3, item 6) \\ \hline.p2gm & Generated muon parameter file & _Persint_-00-02-\(\bullet\bullet\)/example & _Produced with the _Save_ action, retrieved with the _Open_ action in the _Generate muon_ tracks window. \\  & & & (Section 7.1, Figure 19) \\ \hline \hline amdb\_simrec.xxx & Detector geometry file ("primary numbers") & _Persint_-00-02-\(\bullet\bullet\)/amdcData/share_ & _Loaded from the _Volumes_ tab of the _Data_ manager window. (Section 6.1.1, item 1; figure 17) \\ \hline.Bmagatlas.data & Magnetic field file & _Persint_-00-02-\(\bullet\bullet\)/BFieldData/share_ & _Loaded from the _Magnetic Field_ tab of the _Data_ manager window. (Section 6.1.1, item 2; figure 17) \\ \hline.Out.MboyView\_yyy & Reconstructed event file & _Persint_-00-02-\(\bullet\bullet\)/example & _AcCII_ file produced by _ATHENA_. (Section 6.1.1, item 3, figure 17 and Section 6.1.2, item 2) \\ \hline \hline.png,.jpg,.bmp.svg,.ps,.pdf & File containing the _Persint_ Main Display & _User's choice_ user's choice & _Produced by _Persint_ with the _Export_ function of the _File_ menu. (Section 6.4) \\ \hline.dat & ASCII file & _User's choice_ user's choice & _Produced by the _Export_ function in the various _Tools_ menu \\ \hline \end{tabular}

### Directories for Persint files

### File description

Figure 127: Details of some files used by Persint.

[MISSING_PAGE_EMPTY:130]

[MISSING_PAGE_EMPTY:131]

[MISSING_PAGE_FAIL:132]

[MISSING_PAGE_EMPTY:133]

[MISSING_PAGE_EMPTY:134]

#### b.3.5 Bmagatlas

B-3D-R.1 ATL dtb => atlm01p  8 5.80 20500.00 20500.00  30 4 1.28 5.78 492.20 985.30 1241.00 137.90  1 4 1.25 4.30  32  122.46  498.57  825.04  1256.16  96.00  96.00  80 99 0.785398185  0.000000000 0.006000000 0.00850000 0.009000000 0.01100000 0.013900000  0.017238000 0.019000000 0.022000000 0.024070000 0.027379000 0.030670000  0.035531000 0.043423000 0.052974000 0.064359000 0.078351000 0.115947000  0.168554000 0.231067000 0.285960000 0.325066000 0.341732000 0.349282000  0.356406000 0.359997000 0.364267000 0.368445000 0.370000000 0.372000000  0.374908000 0.378033000 0.379500000 0.380000000 0.381000000 0.38200000  0.384113000 0.388406000 0.392699000 0.396685000 0.398699000 0.400670000  0.401699000 0.402500000 0.403760000 0.404000000 0.405199000 0.406800000  0.409937000 0.411699000 0.414699000 0.416769000 0.420078000 0.428230000  0.445673000 0.471050000 0.508646000 0.561253000 0.623766000 0.678659000  0.69999000 0.717765000 0.729584000 0.734431000 0.738464000 0.741981000  0.745518000 0.749105000 0.752696000 0.756966000 0.761144000 0.762699000  0.764699000 0.76760700 0.770732000 0.772699000 0.774699000 0.776812000  0.781105000 0.785398000  0.0000 38.0000 72.0000 100.0000 124.0000 145.0000  492.0000 516.0000 543.0000 566.0000 636.0000 723.0000  764.2500 791.7500 805.2619 812.8077 816.0000 818.0000

and so on...

towards end of file...

 Cy;zJzEzNzOzv=yYP+2+lz+zwztzozmzjzhzf=xJ6=yZ1!2z8!2z7z6zaz5!2z7z6!2z7!4z6z5z6g.= xrWy;=y6jyedPzu=z2m*2m*215y;y,y;y,!y,!2yyyV!2ySyQ!2yRySySyVyyyy.y.=l=-2Cy;zJzEzNzOzv=yY P+2+lz+zwztzozmzjzhzf=xJb=yZ1!2z8%2fz6?zaz5!2z7z6!2z7!5z625g:=xrLy;=y;0*1=xQ4zm= z2mzjny;*1y;y;y;y,y,!2yY!2ySyQ!2yRySySyVyyyy.y-zQy;zJzJzEzNzOzv=yYP+2+lz+wztzozmzjzhzf=xJ1y=Y21z8%2fz7z826f2z4514z7z6z7z62512z625h0=xrz*1xYNyTzzi=z2n*1y;*13y;y,y;y,!2yY!2ySySyVyyyyy.y-12y;zJzEzNzOzv=yYP+2+lz+zwztzozmzjzjzzRz13z74z625z6h200*a=xUezj=z2m*14y;y,y;y,!2yY!2yV!2ySySyVyyyyyy.y-yQy;yQ12yRySySySyVyyyyyyy.y-zQy;JzFySyVy

#### d.3.6 Description of the Out.MboyView ASCII event file readable by PERSINT

Here is an example of an event file. The first word of each line is a keyword which has to start on the first column : only the first 3 letters are mandatory, and usually case sensitive. The first part of the file contains global parameters which are optionnal.

GEO geometry : if present, it should be the first line and contains info on the geometry to be used, i.e. ATLAS-DC3-05.

RTpara integer allows to set the RT relations which will be used for MOT.

0 default, the RT will be explicitely given for each MOT of each event using the RS lines

which will be described later.

> 0 will use our "home-made" parametrization done on the first cosmic runs.

< 0 a constant value (equals to the abs of the given value, divided by 100) in cm will be used.

For nice displays, -120 is a good choice.

Then for each event.

NEW EVT eventNumber runNumber AndCHathenFlag CosmicFlag

AndCHathenFlag : hits are identified by the AndC (0) or Athena identifiers (1 = default).

CosmicFlag: 0 : at standard (collision) or 1 if cosmic

HT numberMDmits numberRPChits numberTOChits number CSChits

MTD BIL 11 12 13 14 15 X Y 2 DriftTime ADCcount Particle TDCcount digitID

11 to 15 are the Athena identifiers of the given tube/station

X Y Z are the positions of the middle of the tube. If unknow, put 0. 0. 0. and they will be

computed by AndC.

MPC BIL 11 12 13 14 15 16 17 18 X Y Z Particle digitID time

11 to 18 are the Athena identifiers of the given strip/station

X Y Z are the positions of the middle of the strip. If unknow, put 0. 0. 0. and they will be

computed by AndC.

EMD EVT last line of the event.

In addition to the muon information, we can add calorimeter or tracking information in these

files. Starting with the calorimeter cells, the format is

CAL TYP radius ten phi layer Energy(MeV) data phi dr dx dy dz

TYP indicates the type of calorimeter. It must be one of the following 3 characters words :

PSB(PreSamplerBarrel), EMB(largeEnBarrel), EME(largeEnEndcap), TIL(tile), HEC(largeHadronicEndcap), FCA(veryForwardEndcap) or PSE(PreSamplerEndcap) radius, eta and phi give the position of the center of the cell

data, dphi, dr, dx, dy, dz give the size of the cell. The parameters used are (dx, dy, dz)

for FCA, (beta, dphi, dr) for PSB, EMB and TIL and (deta, dphi, dz) for EME, HEC and PSE.

The parameters not used may be arbitrary.

Example :

CAL EME 615.1562 -2.5600 0.2495 1 722.0 0.1000 0.0982 0.0000 0.0000 0.0000 224.1685 740294660

For Egamma Objects the format is :

CAL EgammaContainerLocation X Y Z Pr Py Pz E eta phi Charge

electromagnetic objects are dumped if ://(i3EM & Q2YFP)=0 means all cuts except TRT

X,Y,Z are the track intercept at the periges, PA,Py,Pz are the gtrack momentum at the perigee

for neutral particles, X,Y,Z and Pz,Py,Pz are set to 0

E, eta, Phi are the cluster energy, pseudo-rapidity and azimuth respectively

Example :

EOA egammaCollection 0.001 -0.035 -11.853 -50455.172 -792.320 -49976.254 73027.702 -0.882 -3.117 -1

For Trackparticle and Trk::Track Objects the format is :

TRK TrackParticle TrackParticleContainerLocation dummy X Y Z Pr Py Pz Charge PDG_Code

the track representation is the perigee one

Examples

TRK McEventCollection TruthEvent dummy 0.009 0.006 23.258 -1400.825 2469.821 -6805.638 1 211

TRK CombinedMuon MboyESDMuonContainer dummy 2.488 -82.009 -591.075 -1125.241 -34.143 -7849.847 -1 0

TRK TrackRecord MuonEntryLayerFilter dummy -50.110 -52.002 -6740.000 -8.635 1.688 -125.547 -1 11

TRK CombinedMuon StacoCombinedMuonContainer dummy 0.000 0.001 84.526 31681.809 -12270.981 37905.569 1 0

TRK CombinedMuon MuidCombinedMuonContainer dummy 0.002 0.005 84.522 31454.320 -12184.459 37634.866 1 0

TRK CombinedMuon MuidExtrCombinedMuonContainer dummy -7.415 -19.176 94.293 32445.334 -12545.980 38727.635 1 0

TRK TrkTrack Tracks KalmanFitter 0.012 0.002 83.630 103.873 -670.289 -3445.807 1 0

TRK TrkTrack ConvertedMboyMuonSpectroOnlyTracks Muonboy 4021.170 -1375.752 4822.313 28616.934 -9429.886 33776.897 1 0

TRK TrkTrack ConvertedMoverTracks MooreLegacyCnv 4133.017 -1699.972 5078.248 30054.322 -11982.251 36321.348 1 0

DescriptionTRK McEventCollection TruthEvent are the generated tracks. They are drawn inside the tracker (except for muons).

TRK TrackRecord MuonEntryLayerFilter are the generated tracks at the spectrometer entrance. They are drawn starting from the surface defining this spectrometer entrance.

TRK TrkTrack ConvertedMBoyMuonSpectroOnlyTracks are the Muonboy tracks, drawn inside the spectro.

TRK CombinedMuon MboyESDMuonContainer are the Muonboy tracks, back-propagated to the interaction point.

TRK TrkTrack Tracks are the tracks from the Inner Detector.

TRK CombinedMuon StacoCombinedMuonContainer describe the Staco tracks, i.e. combination of InDet and Spectro tracks.

For Segment Objects the format is :

SEG MuonSegment TrkSegmentCollectionLocation X Y Z Dx Dy Dz Chi2 X,Y,Z are the segment position (global frame) Dx,Dy,Dz the segment direction Chi2 the segment Chi-squared Example :

SEG MuonSegment ConvertedMBoySegments -7271.419 -5869.373 -14294.539 -0.114541 -0.096927 -0.988679 8.2018

[MISSING_PAGE_EMPTY:138]

[MISSING_PAGE_EMPTY:139]

## Appendix E Menu items

### File menu

## Appendix E Menu items

### File menu

\begin{tabular}{|l|l|} \hline
**Item name** & **Action** \\ \hline
**Data manager** & Load various files: \\  & Volumes, Events, Magnetic field and others \\ \hline
**Open view**... & Open a Persint.p2vf file for display \\ \hline
**Save view** as... & Save view as a Persint.p2vf file \\ \hline
**Export view**... & Export (save) view as a local file (.png,.jpg,.bmp,.svg) \\ \hline
**Save special...** & To compare geometries (sections 6.4, and 9.3) \\ \hline
**Print** & Print current view \\ \hline
**Download**... & - Download geometry files from Oracle data base at CERN - Download data from Trac server (Not yet available) - Download additional field maps from: \\  & [https://atlas.web.cern.ch/Atlas/GROUPS/MUON/magfield/Fieldmap](https://atlas.web.cern.ch/Atlas/GROUPS/MUON/magfield/Fieldmap) \\ \hline
**Quit** & Quit Persint (for Linux only) 1 \\ \hline \end{tabular}

### Image menu

\begin{tabular}{|l|l|} \hline
**Item name** & **Action** \\ \hline \hline
**Clear** & Several options: \\  & - Clear view (completely); one can also use the "Brush" \\  & - Partial clear of AMDB or AGDD volumes \\  & - Clear event: clears the event hits and associated chambers \\  & - Clear labels: clears all labels in the display. \\  & - Clear captions: clears all captions in the display. \\  & - Clear pictures (logos): clears all pictures in the display. \\ \hline
**Compute** & Make the calculation to display the newly defined view \\ \hline
**Previous view** & Display the view defined by the previous "Compute" action. Up to 10 backward steps are possible \\ \hline
**Logo**1 & Display or hide the Persint logo at the bottom left of the display. \\ \hline
**Background color**1 & Choose the background color of the main display window \\ \hline
**Specific edge color**1 & Define the color of volume edges in the display \\ \hline
**Wire mode** & Switch the Wire mode on/off for all the displayed volumes \\ \hline
**Anti-aliasing** & Provide smooth volume edges \\ \hline
**Axes** & Display the ATLAS coordinate system in various styles \\ \hline
**Projection** & Display 3D views or 2D projections; makes axes inversion \\ \hline \end{tabular}

Footnote 1: Not present as an icon in the default tool bar.

[MISSING_PAGE_EMPTY:142]

[MISSING_PAGE_EMPTY:143]

### Volumes menu

**Create volume window**

The Create volume function is used to draw many types of volumes. The function is embedded in Persint and is used, for example, to display the dead matter structures of ATLAS. It uses the AGDD XML description.

The xml structure of the AGDD file is given below in E.4.1, and the subroutine used to create volumes is shown in E.4.2.

Figure 128: Volumes can be displaced in the X, Y, Z directions and/or rotated.

The volumes shown in this window are ”hidden” or Moved to infinity: \(X=Y=Z=1999.00\) cm. (section 9.2)
As an example, the following paragraph shows the xml description of AGDD files.

Figure 129: With the Create volume function it is possible to draw one volume at a time with chosen dimensions and color. The available shapes are:

* Box (width, length, height)
* Sphere (diameter, # of facets)
* Cone (diameter, height, # of facets)
* Frame (Diameter, length, height, thickness)

[MISSING_PAGE_EMPTY:149]

[MISSING_PAGE_EMPTY:150]

[MISSING_PAGE_EMPTY:152]

[MISSING_PAGE_EMPTY:153]

[MISSING_PAGE_EMPTY:154]

[MISSING_PAGE_EMPTY:155]

#### e.5.1 Set track parameters window

Figure 130: The two panes in the _Set track parameters_ window (**Mac OS style**).

Thresholds can be set for track momentum and calorimeter cell energy (both in GeV). The selections in the TRT pane concern cuts on timing.

\begin{tabular}{|l|l|} \hline
**Parameter** & **Description** \\ \hline \multicolumn{2}{|c|}{\(\boldsymbol{Reconstruction}\)} \\ \hline
**Muonboy segments** & Choose color \\ \hline
**Moore segments** & Choose color \\ \hline
**ID tracks at IP** & Pt threshold in \(GeV/c\); choose color \\ \hline
**Muonboy tracks at IP** & Pt threshold in \(GeV/c\); choose color \\ \hline
**Muonboy tracks at Spectrometer** & Pt threshold in \(GeV/c\); choose color \\ \hline
**Staco tracks at IP** & Pt threshold in \(GeV/c\); choose color \\ \hline
**MuTag tracks at IP** & Pt threshold in \(GeV/c\); choose color \\ \hline
**Moore tracks at Spectrometer** & Pt threshold in \(GeV/c\); choose color \\ \hline
**MuID extra tracks** & Pt threshold in \(GeV/c\); choose color \\ \hline
**MuID Combined tracks at IP** & Pt threshold in \(GeV/c\); choose color \\ \hline
**Maximum \(|\)d0\(|\)** & Maximum allowed track impact parameter (x,y plane) \\ \hline
**Maximum \(|\)z0\(|\)** & Maximum allowed track impact parameter (z direction) \\ \hline
**Track shape** & Choose shape of the track: Ribbon, Crossed ribbons, or Cylinder \\ \hline
**Jets** & Choose parameters for displaying jet cones and jet arrows \\ \hline
**Missing \(E_{T}\)** & Choose parameters for displaying the Missing \(E_{T}\) arrow \\ \hline
**Regions of Interest (RoI)** & Choose parameters for displaying the Rols (Under development) \\ \hline
**Draw scattering boxes** & Scattering centers used in the reconstruction are shown (or hidden) \\ \hline
**Track width** & Can be adjusted with ruler or spinbox \\ \hline
**Segment width** & Can be adjusted with ruler or spinbox \\ \hline
**Simulation** & \\ \hline
**Generated tracks at IP** & Pt threshold in \(GeV/c\) \\ \hline
**Generated tracks at Spectro** & Pt threshold in \(GeV/c\) \\ \hline
**Displayed tracks** & Only muons; only charged; only neutrals; all tracks \\ \hline
**Calorimeter cells** & \\ \hline
**General threshold** & General threshold on \(E\) or \(E_{T}\) for all calorimeter cells, in \(GeV/c^{2}\) \\ \hline
**LAr e.m. barrel presampler** & \(E\) or \(E_{T}\) threshold in \(GeV/c^{2}\); choose color \\ \hline
**LAr e.m. barrel** & \(E\) or \(E_{T}\) threshold in tower (\(GeV/c^{2}\)); choose color \\ \hline
**LAr e.m. end-cap (EMEC)** & \(E\) or \(E_{T}\) threshold in \(GeV/c^{2}\); choose color \\ \hline
**Tile calorimeter** & \(E\) or \(E_{T}\) threshold in \(GeV/c^{2}\); choose color \\ \hline
**LAr hadronic end-cap (HEC)** & \(E\) or \(E_{T}\) threshold in \(GeV/c^{2}\); choose color \\ \hline
**LAr forward (FCAL)** & \(E\) or \(E_{T}\) threshold in \(GeV/c^{2}\); choose color \\ \hline
**Cut-off criterion** & Choose \(E\) or \(E_{T}\) threshold \\ \hline
**Draw cell envelope** & \\ \hline \end{tabular}

\begin{tabular}{|p{142.3pt}|p{142.3pt}|} \hline
**Parameter** & **Description** \\ \hline \hline Physics objects & \\ \hline Photons & Display or hide photons \\ \hline Electrons & Display or hide electrons \\ \hline TRT & \\ \hline TRT barrel A and C & - Cuts on "time over threshold" - Choose Phi sectors (1-32) \\ \hline TRT End-Cap A and C & - Cuts on "time over threshold" - Choose Phi sectors (1-32) \\ \hline Draw tube envelope & Draw or hide \\ \hline \hline Action box & **What it does** \\ \hline \hline Restore defaults & Sets parameters back to default values \\ \hline Open & Open any.p2ts file containing saved parameters from previous work \\ \hline Save as & Save parameter file with the name of your choice to any directory \\ \hline Save & Save modified parameter file with the same name to the same directory \\ \hline \hline \multicolumn{1}{|p{142.3pt}|}{Cancel operation and leave parameter file unchanged} \\ \hline OK & Validates parameter file; to take effect, this validation must be followed by the Compute action; the file is not automatically saved \\ \hline \end{tabular}

### Tools menu

There is no default tool bar for this menu.

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 
**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 
**Edit color palette**: 

**Edit color palette**: 
**Edit color palette**: 
\begin{tabular}{}

\end{tab

**Preferences** windows:

Figure 132: The setting of **Preferences** (to be found in the Persint menu for the Mac OS environement):

a) **General** for saving track settings with view, update/no-update of view, showing magnetic field in volume information boxes, disabling/enabling Log console and warning messages for reconstruction errors

b) **Network** for choosing a ”proxy” when downloading from a CERN server (e.g. alignment constants)

### Window menu

There is no default tool bar for this menu.

\begin{tabular}{|l|l|} \hline
**Item name** & **Action** \\ \hline
**Reset window layout** & Set the default layout of the Persint display \\ \hline
**Dimensions** & Set image canvas size \\ \hline
**Full-screen** & Makes the Main display full-screen; as a shortcut, type \(F\) (lower case) to enter or quit full-screen mode \\ \hline
**1 View** & \\ \hline
**AMDB** & Enable the AMDB Selector window \\ \hline
**AMDB (v1)** & Enable a previous version of the AGDD Selector window \\ \hline
**AGDD** & Enable the AGDD Selector window \\ \hline \(X_{0}\) & Enable the \(X_{0}\) window (amount of material) \\ \hline
**Log** & Enable the Log window \\ \hline \end{tabular}

### Help menu

There is no default tool bar for this menu.

\begin{tabular}{|l|l|} \hline
**Item name** & **Action** \\ \hline Linux style & \\ \hline
**User Manual** & Opens the Persint User Manual in your web browser \\ \hline
**Report a bug** & Prompts to your mailer with the destination mail address: \\  & atlas-sw-persint-support@cern.ch \\ \hline
**About Persint**1 & Open information window about Persint; the version number is found here \\ \hline
**About Qt**1 & Open information window about Qt \\ \hline \end{tabular}

Footnote 1: In the Mac OS environment, **About Persint** and **About Qt** are found in the **Persint** menu (see section E.9)

\begin{tabular}{|l|l|} \hline
**Mac OS style** & \\ \hline
**Search** & Search for commonly used functions \\ \hline
**User Manual** & Opens the Persint User Manual in your web browser (27 Mo pdf) \\ \hline
**Report a bug** & Prompts to your mailer with the destination mail address: \\  & atlas-sw-persint-support@cern.ch \\ \hline \end{tabular}

### persint menu (Mac OS only)

There is no default tool bar for this menu.

\begin{tabular}{|p{113.8pt}|p{113.8pt}|} \hline
**Item name** & **Action** \\ \hline
**About Persint** & Open information window about Persint; the version number is found here \\ \hline
**About Qt** & Open information window about \(Qt\) \\ \hline
**Preferences...**1 & Set preferences for saving track parameters, magnetic field display, show warnings for reconstruction errors, disable Log console, as well as network parameters for access to CERN data bases \\ \hline
**Unit Persint**1 & \\ \hline \end{tabular}

Footnote 1: In the Linux environment, Preferences is found in the Tools menu (see section E.6 where the two Preferences windows are shown), and Quit is found in the File menu (section E.1)

### Warning messages

On various occasions, Persint encounters an error which is reported in a message like those shown below.

Note that for these messages to appear, the Show errors box should be checked in the Preferences window (see figure 132a, page 158).

## Appendix F Right-click

The special menu which appears depends on the location of the cursor when right-clicking. In the case of a reconstructed track, there is a menu item called Edit track illustrated in figure 134.

\(R_{max}\) and \(Z_{max}\) (both in \(cm\)) define the cylinder, centered on the IP, which contains the track.

Figure 134: Window which opens when clicking on Edit track in the special menu obtained with a right-click on a track

Figure 133: Special menus available through Right-click on various areas of the Persint display

## Appendix G Producing Event files for Persint in ATHENA

ASCII Event files for input to Persint (Out.MboyView_xxx) are produced in ATHENA from raw data. These files contain all coded information needed to display the reconstructed objects. It is possible to display tracks reconstructed by the various reconstruction packages (e.g. MuonBoy, Staco, Moore, MuID,...) by selecting the appropriate objects in the window described in figure 10 (Set track parameters).

### Event files from raw data

Inside ATHENA, Event files for Persint are produced by the MboyView package via the doPersint flag in RecExCommon:

doPersint=true

It is possible to make a selection of events to be included in the Event file by using the following parameters in the PITHON file used for running ATHENA:

 # Event Selection: EvtSelectionType and EvtSelectionThreshold  # = 1 view without Selection  # = 2 view only for evts Nber of Tracks.le. EvtSelectionThreshold  # = 3 view only for evts Nber of Tracks.ge. EvtSelectionThreshold  # = 4 view only for evts Nber of Tracks.eq. EvtSelectionThreshold  # GenEvent Selection: GenEvtSelectionType and GenEvtSelectionEta<Min/Max>  # = 1 view without Selection  # = 2 view only for evts with at least a gen track with  # GenEvtSelectionEtaMin<abs(eta)<GenEvtSelectionEtaMax  if doPersint:  MboyView = Algorithm( "MboyView" )  MboyView.EvtSelectionType = 1  MboyView.EvtSelectionThreshold = 0  MboyView.GenEvtSelectionType = 2  MboyView.GenEvtSelectionEtaMin = 0.  MboyView.GenEvtSelectionEtaMax = 2.7 The information to be included in the Events for Persint can be chosen as follows (0=no; 1=yes):

if doPersint:

 MboyView = Algorithm( "MboyView" )  MboyView.ViewDigits = 1 # dump the spectrometer digits  MboyView.ViewCalo = 0 # dump the calorimeter cells  MboyView.ViewMcEventCollection = 1 # dump the truth info  MboyView.ViewTrackRecordCollection = 1 # dump the TrackRecord  # (i.e. truth info at the spectrometer entrance)  MboyView.TrackRecordCollectionLocationForGenEventSelectionList =  [ "MuonEntryLayerFilter" ]  MboyView.TrackRecordCollectionLocationForGenEventSelectionList +=  [ "MuonEntryRecordFilter" ]

### Event files from ESDs or dESDs

The ASCII input file for Persint (Out.MboyView_xxx) can also be produced from ESD files.

#### g.2.1 Procedure

* Set up ATHENA release 15.6.3 or higher. You may follow instructions given in: [https://twiki.cern.ch/twiki/bin/view/Atlas/WorkBook](https://twiki.cern.ch/twiki/bin/view/Atlas/WorkBook), in particular in sections: Getting an Account, Setting up your Account, Running Athena HelloWorld.
* Get a job options file. A generic job options file (MboyViewESD.py) is located in the directory Persint-00-02-<</example. It is also available as an attachment to the following Twiki page [the file is listed in the next section (G.2.3)]: [https://twiki.cern.ch/twiki/bin/view/Atlas/PersintDumpESD](https://twiki.cern.ch/twiki/bin/view/Atlas/PersintDumpESD) You may want to edit the job options file for geometry and conditions tags associated with your ESD file.
* Finally, execute the following command: athena MboyViewESD.py -c 'inputFileList=["/path/to/ESD/file"]' where /path/to/ESD/file is "comme son nom l'indique".

This will create a file MboyView which can be read by Persint.

#### g.2.2 Limitations

The method described above does not re-run the reconstruction but only dumps the values already available in the ESD file. The advantage of this method is its speed. However, in the ESD file, only the TDC counts of MDT hits are stored, and not the radius returned by the RT calibration service.

An approximate radius is thus associated with MDT hits, in the following way:

1. If the MDT hit is associated with a Muonboy segment, the calibrated radius is saved in the segment and this is what is returned in the ASCII dump
2. If the MDT hit is not associated with any segment, its radius is set to 7.5 mm

This last approximation makes the ASCII dump suitable for display, but not suitable for Muonboy interactive reconstruction in Persint.

In future versions of this tool, a better radius determination may be included.

#### g.2.3 ATHENA job options file, an example: MboyViewESD.py

#----------------------------------------------------------------
# configure the input file, in a way compatible with auto-configuration
#----------------------------------------------------------------

from AthenaCommon.AthenaCommonFlags import athenaCommonFlags athenaCommonFlags.FilesInput = inputFileList

#----------------------------------------------------------------
# Include the RecExCommon flags, to force trigger the auto-configuration
#----------------------------------------------------------------

[MISSING_PAGE_FAIL:168]

# Configure the MboyView algs
#---------------------------------------------------------------- from MboyView.MboyViewConf import MboyViewDigiMaker selectionSequence += MboyViewDigiMaker("MboyViewDigiMaker") selectionSequence.MboyViewDigiMaker.ApproximateRsLine = True

from MboyView.MboyViewConf import MboyView selectionSequence += MboyView("MboyView") selectionSequence.MboyView.SwitchOff = 0 selectionSequence.MboyView.ViewDigits = 1 selectionSequence.MboyView.ViewTrackRecordCollection = 1 selectionSequence.MboyView.ViewCombinedMuonContainer = 1 selectionSequence.MboyView.ViewTrackParticleContainer = 1 selectionSequence.MboyView.ViewTrackCollection = 1 selectionSequence.MboyView.ViewTrackSegmentCollection = 1 selectionSequence.MboyView.ViewMcEventCollection = 1 selectionSequence.MboyView.ViewEgammaContainer = 1

topSequence += selectionSequence

# AthenaEventLoopMgr = Service( "AthenaEventLoopMgr" )

[MISSING_PAGE_FAIL:170]

Invert, 38

IP, 35

Isometric view, 42

Italian, 16

Jets, 88

Label (Add/Remove), 44, 45

Label (additional text), 44

Label (customized), 44, 70

Label (Default), 44, 45, 64

Language, 16

Linux, 13, 15

Load caption from..., 29

Log console (disable), 158

Log window, 18

Logo (Persint), 28

Logos (Add/remove), 28, 30

lxplus, 15, 117

Mac OS, 13, 18

Magnetic field, 18, 20, 21, 52-54, 65, 76, 78, 125, 126

Main display window, 18

MAT, 35

Maximize, 87

MboyViewESD.py, 165

MDT muon chambers, 33

MDT options, 39, 72, 78

MDT tubes, 39, 72

Menu items, 138

Minimize, 87

Minimum number of hits, 62

Missing-ET, 89

Modify volume, 50

Modify volume window, 47, 49

Moore, 15

Move volumes to infinity, 46, 47, 79

Muid, 15

Multiple scattering, 39

Multiple scattering center, 72

Muonboy, 13, 15

Navigation, 34, 40

Navigation menu, 140

Navigation scale, 40, 42

Navigation tool bar, 18, 34, 35, 41

Necessary files, 20

Next event, 24, 60, 66, 69

Octant wheel selector, 33

Online help, 19

Open view, 24, 26, 40, 49, 65

Out.MboyView, 23, 24, 60, 65, 66, 69, 125, 134, 136

Persint menu, 161

Physics objects, 88-90

Picture (Add/remove), 28, 30

Platforms (supported), 15, 115

Port (open port to data base), 59

Preferences, 157, 158, 161

Previous view, 35, 49, 112

Print, 27

Projection, 38, 39, 43, 68, 72, 78, 85

Proxy, 158

Qt, 15

Range, 58

Raw data, 15, 164

Reconstructed tracks, 75

Reconstruction (interactive), 76, 79

Releases (Earlier), 115

Releases (Version number), 15, 16

Reload event, 44, 45, 66, 74, 75, 80, 82

Reset displacements, 46

Restore, 87

Right-click, 18, 28, 44, 47, 49, 70, 77, 87, 163

RoI, 90

Rotation, 41, 42, 47

RPC muon chambers, 33

RPC options, 39

RPC strips, 39, 72

Run number, 29

Save (automatic), 37

Save caption as..., 29

Save histogram, 87

Save special, 27, 48

Save view as, 18, 26, 36, 65, 70

Scanning (autoscan), 66

Scanning events, 66, 87

Sector (Small/Large), 33, 40

Segments, 69

Select Sectors, 61

Selected volumes window, 47

Selection mode, 43, 47

Selector window, 18, 24, 33-37, 39, 40, 52, 53, 63, 82

Set center, 42

Simulation tracks, 25, 74

Software name, 45

Spinbox, 40, 42, 155

Staco, 15

[MISSING_PAGE_EMPTY:172]

## References

* [1] Persint was originally developed and maintained by the Saclay Muon Software Group: L. Chevalier, F. Gaillot, J.-F. Laporte, A.Ouraou, D. Pomarede, P. Sizun. M. Virchaux (1953-2004) was the principal developer.
* [2] The Persint visualization program for the ATLAS experiment, D. Pomarede, M. Virchaux: Conference for Computing in High Energy and Nuclear Physics, La Jolla, California, March 24-29, 2003. (arXiv: cs/0305057v1, 29 May 2003)
* [3] The Users' manual of the original Persint is on "[http://atlas.web.cern.ch/Atlas/GROUPS/MUON/persint.html](http://atlas.web.cern.ch/Atlas/GROUPS/MUON/persint.html)"
* [4] AMDB documentation: L. Chevalier et al., ATLAS Internal Note, ATL-MUON-97-148 (1997). "[http://muondoc.web.cern.ch/muondoc/Software/DetectorDescription/amdbdoc/amdbmanual.ps](http://muondoc.web.cern.ch/muondoc/Software/DetectorDescription/amdbdoc/amdbmanual.ps)"
* [5] M. Virchaux et al., ATLAS Internal Note ATL-MUON-97-198 (1997).
* [6] "[http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/doc/index.html](http://atlas.web.cern.ch/Atlas/GROUPS/MUON/Persint/releases/doc/index.html)" and: "Rapport de stage F. Gaillot et documentation for developers"
* [7] Section 5.6 in the AMDB Documentation: "[http://muondoc.web.cern.ch/muondoc/Software/DetectorDescription/amdbdoc/amdbmanual.ps](http://muondoc.web.cern.ch/muondoc/Software/DetectorDescription/amdbdoc/amdbmanual.ps)"
* [8] ATL-COM-PHYS-2010-045 [http://cdsweb.cern.ch/record/1236325/files/ATL-COM-PHYS-2010-045.pdf](http://cdsweb.cern.ch/record/1236325/files/ATL-COM-PHYS-2010-045.pdf)
* [9] Jochen Meyer, "[https://cdsweb.cern.ch/record/1456446](https://cdsweb.cern.ch/record/1456446)"

**Acknowledgments**

Jochen Meyer has written a guide to the AGDD XML dead material files, and operations on volumes.

Oliver Kortner and Angelo Graziosi have provided the German and Italian translations for all the windows, dialogue boxes, and help items in the GUI.

Eric Lancon has helped implementing the use of calorimeter data, and we would like to acknowledge the work of Daniel Pomarede with the original Persint.