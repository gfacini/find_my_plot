Analysis of test beam data of ATLAS Pixel Detector production modules with a high intensity pion beam

Gianluca Alimonti\({}^{6)}\), Attilio Andreazza\({}^{6)}\), Magdalena Bazalova\({}^{8)}\), Roberto Beccherle\({}^{4)}\), Patrick Breugnon\({}^{2)}\), Delia Brueser\({}^{9)}\), Diego Cauz\({}^{10)}\), Jean-Claude Clemens\({}^{2)}\), Marina Cobal-Grassmann\({}^{10)}\), Daniel Dobos\({}^{3)}\), Kevin Einsweiler\({}^{5)}\), Tobias Flick\({}^{11)}\), Guido Gagliardi\({}^{4)}\), Claudia Gemme\({}^{4)}\), Peter Gerlach\({}^{11)}\), Igor Gorelov\({}^{7)}\), Joern Grosse-Knetter\({}^{1)}\), Fabian Huegging\({}^{1)}\), Martin Imhauser\({}^{11)}\), Susanne Kersten\({}^{11)}\), Reiner Klingenberg\({}^{3)}\), Markus Kuhn\({}^{9)}\), Tommaso Lari\({}^{6)}\), German Martinez\({}^{1)}\), Martin Mass\({}^{3)}\), Frank Massmann\({}^{1)}\), Andrea Matera\({}^{6)}\), Markus Mathes\({}^{1)}\), Chiara Meroni\({}^{6)}\), Paolo Morettini\({}^{4)}\), Dmitriy Naumov\({}^{7)}\), Polina Netchaeva\({}^{4)}\), Francesco Ragusa\({}^{6)}\), John Richardson\({}^{5)}\), Leonardo Rossi\({}^{4)}\), Alexandre Rozanov\({}^{2)}\), Lorenzo Santi\({}^{10)}\), Carlo Schiavi\({}^{4)}\), Joachim Schultes\({}^{11)}\), Petr Sicho\({}^{8)}\), Thorsten Stahl\({}^{9)}\), Duc Bao Ta\({}^{1)}\), Daniel Tieman\({}^{1)}\), Lukas Tomasek\({}^{8)}\), Clara Troncon\({}^{6)}\), Sven Vahsen\({}^{5)}\), Jan Valenta\({}^{8)}\), Joe Virzi\({}^{5)}\), Vaclav Vrba\({}^{8)}\), Jens Weingarten\({}^{1)}\)

###### Abstract

Beam tests of ATLAS Pixel Detector production modules were performed with a high intensity pion beam at the SPS H8 test beam facility. Several of the modules had been previously irradiated to the fluence of \(10^{15}\) n\({}_{\rm eq}\)cm\({}^{-2}\). Data were taken at different beam intensities, up to the value foreseen for the innermost pixel layer at the design LHC luminosity of \(10^{34}\) cm\({}^{-2}\)s\({}^{-1}\). At each intensity, data were taken with different configurations of the front-end chip. This note describes the analysis of the high intensity run of August 2004. The particle trajectories were reconstructed using the pixel detectors under test and the detection efficiency was measured as a function of beam intensity. With the standard ATLAS B-layer configuration and at the B-layer expected column-pair hit occupancy of 0.17 pixel hits per bunch crossing, the measured readout efficiency is 98%, which is the same value found at low intensity. Efficiency losses are observed only when the column pair occupancy exceeds 0.24 hits per bunch crossing.

Introduction

When the LHC will operate at the design luminosity of \(10^{34}\) cm\({}^{-2}\)s\({}^{-1}\), the average pixel occupancy of the innermost pixel layer (B-layer) will be about \(5\cdot 10^{-4}\). This number can be obtained by rescaling the simulation results documented in the Pixel Detector TDR [1] to take into account the change in the B-layer pixel longitudinal pitch from 300 \(\mu\)m to 400 \(\mu\)m and it has been confirmed by simulation studies performed with the updated geometry layout and pixel pitch [2].

The readout of the ATLAS Pixel modules has been designed to ensure that the detectors will be able to detect the particle hits with high efficiency up to occupancies well in excess of those expected for the B-layer. In order to study the performances of the detectors at high occupancy, in 2003 and 2004, production pixel modules were tested at the SPS H8 area with a high intensity beam.

In this note, we report the analysis of the high intensity test beam data taken in 2004. Data were taken with the final production modules, some of which have been irradiated up to a fluence of \(10^{15}\) n\({}_{\rm eq}\)cm\({}^{-2}\). This is the value of integrated fluence expected for the B-layer after 3-4 years of high luminosity operation.

Tracks were reconstructed with the pixel modules themselves, and the efficiency was measured as a function of the pixel occupancy (up to \(8\times 10^{-4}\), well above the value expected for the B-layer) and for different configurations of the front-end electronics settings [3].

The paper is organized as follows. In Section 2 the test-beam setup and tested devices are described. In Section 3 the track reconstruction and data analysis are described. In Section 4 the results are presented and discussed.

## 2 Tested devices and test beam setup

The ATLAS Pixel detector modules and the test beam setup are described in detail elsewhere [1, 4, 5, 6, 7]. Here, a brief description of the aspects relevant for the analysis described in this note is given.

### ATLAS Pixel detector modules

A module is composed by a \(n^{+}/n\) diffusion oxygenated silicon sensor [8, 9], 16 readout rad-hard electronics chips using 0.25 \(\mu\)m technology [3, 10, 11], and a flexible hybrid supporting a Module Controller Chip (MCC) [12], signal interconnection and power distribution lines, and passive components such as temperature sensors, resistors, and capacitors. The sensor has an active area of \(16.4\times 60.8\) mm\({}^{2}\) and a thickness of 250 \(\mu\)m. The pixel implants have a pitch of \(50\times 400\)\(\mu\)m\({}^{2}\) and are connected via bump-bonding to matching cells in the read-out chip, each featuring an electronics chain. Interconnection between sensors and FE-chips is made using either solder [13] or indium [14] bonds.

In each front-end chip, 2880 channels are arranged into 18 columns by 160 rows. The chip is operated with a 40 MHz clock. Each clock cycle corresponds to one LHC bunch crossing. Each channel is equipped with its own 7-bit DAC for channel-to-channel threshold adjustments. The tested modules were tuned to a threshold of 4000 e\({}^{-}\) with a dispersion lower than 200 e\({}^{-}\) rms. An 8-bit charge measurement capability is provided using time-over-threshold (TOT). The available dynamical range is set by the time between the physical event and the readout of pixel data (Level-1 trigger latency). In ATLAS, this is anticipated to be about 130 bunch crossings. The charge-sensitive preamplifiers feature a DC feedback scheme with a tunable current providing control over the shaping time for a given input charge. A discrimination stage sits behind the preamplifier in each channel,which is sensitive to the leading edge and trailing edges of pulses.

When the charge induced on the pixel electrode is low, the signal reaches the discriminator threshold later, so that the hit may be assigned to the wrong clock period. This mechanism is known as time-walk. In order to reduce the hit losses due to the time-walk, an option is provided, to generate a duplicate hit with a time stamp lower of one unit when the TOT is below a tunable threshold.

The pixel readout architecture is described in detail in Ref. [10]. It is organized in nine column pairs of \(160\times 2\) pixel each. When the trailing edge of a pulse is detected, the hit information is stored in end-of-column (EOC) buffers with a capacity of 64 hits per column pair. The transfer rate can be varied by setting the column readout clock at 10, 20, or 40 MHz. If the 64 locations of the EOC are full, an OVERFLOW bit is added to the output data flow in order to flag possible missing data. After the trigger latency is elapsed, the hits are either deleted or transmitted off chip, if a trigger signal is received. At high luminosity, the B-layer average column pair occupancy within a latency of 130 clock cycles will be about 22 hits.

The Module Controller Chip distributes configurations and trigger signals to the front-end chips, collects the hits, and performs event building. The hits received from each front-end chip are stored in a 128-words deep FIFO memory. After event building, the event is sent out of the module. Simulations of the MCC operation [12] show that no efficiency loss is expected at the B-layer rates. In case one of the receiver FIFOs is saturated, the MCC adds a warning word to the event.

### Irradiations

Assembled modules were irradiated at the CERN PS using 24 GeV/\(c\) protons. The proton fluence was \(2\times 10^{15}\) cm\({}^{-2}\), corresponding to a 1 MeV neutron equivalent fluence of \(10^{15}\) cm\({}^{-2}\) and a dose of 600 kGy. The detectors were biased during irradiation. During subsequent storage and test beam operation the modules were cooled to -7\({}^{\circ}\)C or below.

### Test beam setup and data set

The test beam was performed at the CERN SPS using a pion beam of 180 GeV/\(c\) momentum. During the August 2004 high intensity run, four modules were placed in the beam. Three of them (with ID number 510689, 510852, and 510910) had been irradiated and one was not irradiated (with ID number 510929). The setup also included a beam telescope composed of 8 planes of ATLAS Pixel sensors sized to be connected to a single front-end electronics chip each.

The four modules had the same orientation, with the short side of the pixel cell (local \(x\) direction) in the horizontal plane and the long side (local \(y\) direction) in the vertical plane. The modules could be rotated around the vertical axis. The data were taken with either a normal beam incidence or a tilt angle of \(15^{0}\).

The high intensity data were taken with a random trigger. This allowed an unbiased measurement of the beam intensity and efficiency. Some data were taken with a low intensity beam, and the trigger was provided by the coincidence of two scintillators ("physics trigger"). The low-intensity runs provided a large statistic of events with a single track and were used for the alignment of the pixel modules. Upon every trigger, eight consecutive beam crossings were read out.

In order to identify the origin of possible inefficiencies at high intensity, data were taken with different front-end electronics configurations. The reference configuration had the preamplifier feedback current tuned, so that the most probable value of TOT was 15clock periods, the latency set to 130 clock periods, a column readout frequency of 40 MHz, and no hit duplication. Data were also taken with configurations obtained varying one of these settings, as follows:

* The TOT peak was tuned to 30 clock periods in order to measure the inefficiency related to the pixel cell dead time: the passage of a second particle can not be registered before the signal induced by the first particle has fallen below the discriminator threshold.
* The latency set to 230 clock periods. This variation increases the inefficiency due to the saturation of the EOC buffers.
* A reduced column readout frequency of 20 MHz. This setting increases the inefficiency due to failure of transferring the hits of a column pair to the EOC buffers within the latency.
* Duplication of the hits with a TOT below 10 clock periods. Since the TOT peak is about 15 clock periods, this setting increases significantly the occupancy of the EOC buffers.

## 3 Event reconstruction and selection

### Event reconstruction

The following global system of coordinates will be used: the \(z\) axis is along the beam, the \(x\) axis is horizontal and the \(y\) axis is vertical. For each module, the local \(x^{{}^{\prime}}\) axis is along the short side of the pixel cell and it is nominally in the \(xz\) plane, the local \(y^{{}^{\prime}}\) axis is along the long side of the pixel cell and it is nominally coincident with the \(y\) axis.

The clustering of pixel hits and the event building are performed by the program _h8_, which is described in detail in [15]. The alignment constants of the pixel modules were determined using the data taken at low intensity. The first module along the beam line was used as a reference plane. The alignment constants of the other planes were determined considering the differences \(\Delta x\) and \(\Delta y\) between the positions of the hits in the reference plane and in the plane being aligned as a function of the \(x\) and \(y\) hit coordinate. The tilt angles in the \(xz\) and \(yz\) planes and the \(z\) position of the modules were assumed equal to the nominal values, while the angle in the \(xy\) plane and the \(x,y\) positions of the detectors were determined by a linear fit of \(\Delta x\) vs \(y\) and \(\Delta y\) vs \(x\). The resulting alignment precision is better than the detector resolution.

After alignment, tracks are reconstructed as follows. A pixel module is selected for the measurement of the efficiency and the other three modules are used for reconstructing tracks. Pixel clusters are built from adjacent pixel hits (with a side in common). Track candidates are built using cluster pairs from the first and the last (along the beam line) of the tracking planes. Ambiguities are solved selecting the cluster pairs which give the smaller angle between the track direction and the \(z\) axis. The cluster of the third plane which is closer to the track extrapolation is then associated to the track and the track is refitted.

### Event selection for the efficiency measurements

The following selections are made on the tracks used for the efficiency measurement:

* The track \(\chi^{2}\) is computed using an \(x\) resolution of 14 \(\mu\)m and an \(y\) resolution of 115 \(\mu\)m and the \(\chi^{2}\) probability is required to be greater than 0.01 in both the \(xz\) and \(yz\) views.
* On all the four module planes, the track is required to extrapolate within the area covered by the front-end chip on which the beam is centered.

All the hits associated to the track on the three tracking planes are required to have a beam crossing ID between 1 and 6, excluding the extremal values of 0 and 7.

The efficiency of the module under test is computed requiring a cluster close to the track extrapolation. The acceptance window is \(\pm 0.2\) mm in the \(x\) direction and \(\pm 0.6\) mm in the \(y\) direction. No requirement is made on the bunch crossing ID of the hits, so time-walk losses do not contribute. The probability to associate to a track a hit from another track is about 15% at the highest intensity studied (so inefficiency is slightly underestimated, by a factor of 0.85).

### Definition of occupancy

The pixel occupancies obtained with different possible definitions are compared in Table 1. The first two columns report the beam intensity (intermediate or high) and the detector tilt angle. The occupancy increases with both beam intensity and detector tilt angle, and the entries reported in the table are representative of the range of occupancy studied at the test beam (excluding the alignment runs taken with a low intensity beam).

The third column reports the occupancy obtained without any event selection (that is, without the selection cuts described in the previous section, which define the sample used for all the efficiency measurements reported in the paper). We call this figure the "minimum bias" occupancy. It is expressed in pixel hits per column pair per clock cycle, where an average over the 8 clock cycles read at the test beam is implied.

In the fourth column the occupancy is reported for the events which pass the selection cuts described in the previous section. This value of occupancy is also measured by averaging over the 8 clock cycles read at the test beam. The value of occupancy obtained after the track selection is larger than the minimum bias value, since the track selection criteria imply that at least one track is crossing the area of the front-end chip. These selections define the sample used to perform the measurements of efficiency. However, the possible hit losses are expected to depend on the occupancy averaged over either the latency or the duration of the TOT pulse, depending on the hit loss mechanism. In both cases, it is a period longer than the eight bunch crossings read out at the test beam. The additional (not read out at the test beam) clock cycles are expected to have an occupancy

\begin{table}
\begin{tabular}{||c|c|c|c|c|c||} \hline Beam intensity & Tilt & Occupancy & Occupancy & Occupancy & Occupancy \\  & & min bias & selected & sel15 & sel230 \\  & [\({}^{\circ}\)] & [hits/cp/bx] & [hits/cp/bx] & [hits/cp/bx] & [hits/cp/bx] \\ \hline intermediate & 0 & 0.0426 & 0.0524 & 0.0478 & 0.0429 \\ high & 0 & 0.0842 & 0.0958 & 0.0904 & 0.0846 \\ high & 15 & 0.1970 & 0.2288 & 0.2140 & 0.1981 \\ \hline \end{tabular}
\end{table}
Table 1: Column pair occupancy, measured for any triggered event (“minimum bias”) and for events with satisfy track quality cuts (“selected events”). The values are reported for different beam intensities and pixel tilt angles, so that the quoted occupancies are representative of the range of values measured with the high intensity data. The values of the third and fourth column are averaged over the eight bunch crossings which were read out after every trigger. The values reported in the last two columns are the occupancy for the selected events averaged over 15 and 230 bunch crossings respectively, assuming that the bunch crossing which are not read out have the same occupancy as minimum bias events.

equal to the minimum bias value, hence the average over this longer period is expected to be less affected by the requirement that at least one track passes through the chip under study.

In order to illustrate this, we report in the fifth column of the table the occupancy computed after the track selection cuts, but averaging over 15 clock cycles, which is the time relevant for losses due to pixel overwriting when the TOT peak is tuned to 15 bunch crossing. Since only 8 clock cycles are available in the data, it is assumed that the occupancy of the additional 7 clock cycles is the minimum bias value. The last column reports the occupancy after track selection, computed averaging over 230 clock cycles - this the time scale relevant for losses due to the end-of-column filling when the latency is set to this value. The value of occupancy of these last two column is closer to the minimum bias value than the average over 8 clock cycles only.

Depending on the hit loss mechanism and the value of TOT and latency settings the relevant occupancy is expected to be a value between those of these last two columns. This is larger by at most 10% than the minimum bias occupancy. In order to quote a value independent from the assumed hit loss mechanism, the minimum bias occupancy is quoted throughout the article, even if all the efficiency measurements are performed after the track selection criteria.

### Validation of the analysis

The reconstruction based on pixel module tracking and the analysis described here have been developed specifically for the measurement of efficiency with the high intensity data taken in 2004. In order to validate the new analysis procedure, the efficiency for the low intensity runs was compared to the values [16] obtained with an analysis procedure [17, 6, 18, 19, 20] which has been used since several years to measure the efficiency of ATLAS Pixel detectors with a low intensity beam.

The older analysis was based on the reconstruction of single tracks with a telescope (BAT telescope [21]) made of four double-sided microstrip planes and required a low intensity beam and physics trigger. When the requirement that the pixel hits have to be detected within one particular bunch crossing is dropped, the results of the traditional analysis are expected to be the same as those of the new analysis using low intensity runs with the physics trigger.

The efficiency obtained with BAT telescope tracking is reported in the first row of Table 2, while the efficiency with pixel module tracking is reported in the second row. A good agreement is found for the three irradiated modules. A discrepancy of about 1% is found for the not irradiated module. It is due to the fact that this module was the last in the beam line, at some distance from the others. As a result, the extrapolation of the track reconstructed with the other three modules is affected by an error that sometimes exceeds the width of the window used to associate a hit to a track. The missing hits are in fact observed just outside the acceptance window. They can be recovered by enlarging the acceptance window, but this would result in an overestimation of the efficiency with high intensity data. The fraction of hits lost because of the tracking extrapolation uncertainty is not expected to depend on beam intensity and thus it does not affect the sensitivity of the analysis to detect an inefficiency arising from readout losses.

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c|c|c|c|} \hline Occupancy & \(\epsilon_{510689}\) & \(\epsilon_{510852}\) & \(\epsilon_{510910}\) & \(\epsilon_{510929}\) & tot & lat. & read. & hit dupl. \\ \([\text{hits}/\text{cp}/\text{bx}]\) & & & & & [bx] & [bx] & [MHz] & \\ \hline BAT & 0.980 & 0.986 & 0.983 & 1.000 & 30 & 250 & 40 & NO \\ low & 0.980 & 0.986 & 0.985 & 0.989 & 15 & 130 & 40 & NO \\
0.030-0.043 & 0.981 & 0.984 & 0.986 & 0.988 & 15 & 130 & 40 & NO \\
0.069-0.084 & 0.981 & 0.984 & 0.985 & 0.986 & 15 & 130 & 40 & NO \\
0.100-0.124 & 0.980 & 0.982 & 0.983 & 0.983 & 15 & 130 & 40 & YES \\
0.069-0.084 & 0.978 & 0.981 & 0.982 & 0.984 & 30 & 130 & 40 & NO \\
0.069-0.084 & 0.980 & 0.982 & 0.983 & 0.984 & 15 & 250 & 40 & NO \\
0.069-0.084 & 0.980 & 0.981 & 0.983 & 0.980 & 15 & 130 & 20 & NO \\ \hline \end{tabular}
\end{table}
Table 2: Measurements of detection efficiency performed with data taken at normal incidence. The first column reports the average occupancy for the readout chip selected for the analysis. The range corresponds to the fact that due to the different position of each module relative to the beam, the occupancy varies slightly from module to module. The lines labeled “BAT” and “low” correspond to runs performed with a low intensity beam and a scintillator trigger. The tracking was performed with a microstrip telescope (BAT) or with the pixel modules under test (low) as in the high intensity runs. The second to the fifth columns report the measured detection efficiency of the four tested modules (the six-digits numbers are the module IDs). The first three modules were irradiated to \(10^{15}\) n\({}_{\text{eq}}\)cm\({}^{-2}\), the fourth was not irradiated. The last columns report the front-end electronics settings, in this order: the TOT peak tuning value and the latency, the column readout frequency, and whether hit duplication was on.

Figure 1: The upper pictures report the column pair occupancy as a function of column number. The lower pictures report the detection efficiency as a function of column number. The pictures on the left are for irradiated module 510910 and the pictures on the right for not irradiated module 510929. Data were taken at normal incidence. The TOT peak was tuned to 15 bunch crossings, the latency was 130 bunch crossings, the column readout frequency was 40 MHz and hit duplication was active with threshold TOT\(>10\) bx.

Results

### Normal incidence

The efficiency measured with the data taken at normal incidence is reported in Table 2. The first column reports the average occupancy for the chip on which the beam was centered, expressed in units of hits per column pair (cp) per bunch crossing (1 \(\mathrm{bx}=25\) ns). "low" refers to the alignment run at low intensity, which was taken with physics triggers. All the other data were taken with random triggers. The second to the fifth columns report the efficiency for the four tested module (the last was the not irradiated module) and the last four columns report information on readout electronics configuration settings.

Regardless of the front-end configuration, the efficiency measured with the data taken with random triggers at a greater intensity is the same within a fraction of one per cent as the value measured at low intensity. No significant data losses are thus observed up to the maximum occupancy reached with the runs at normal incidence.

The largest value of the chip-averaged occupancy is 0.12 hits/cp/bx, which is about 70% of the value expected for the B-layer at the nominal LHC luminosity. However, the column pair occupancy is actually different on different column pairs, because of the beam not uniformity across the area covered by a front-end chip. Hence a single run can be used to measure the efficiency for a range of beam intensities by performing the analysis separately for each column pair. In Fig. 1 the column pair occupancy and the detection efficiency are reported as a function of the column number for the run with the highest beam intensity and with hit duplication. The plots on the left are for an irradiated module, and those on the right for the not irradiated module. The occupancy varies by more than a factor of two over the chip area but the efficiency profile is flat. This is a further evidence that no hit losses are present, a statement which is valid up to the occupancy of the column pair where the beam was most intense, which is 0.13 hits/cp/bx.

### Data at 15\({}^{\circ}\) incidence angle

The intensity of the beam was limited by radiation security issues. However, a larger occupancy could be obtained by taking data with tilted detectors. The number of pixel hits generated by a particle increases from 1.30 at normal incidence to 1.68 at 15\({}^{\circ}\) incidence angle. The configuration with tilted detectors is also a better approximation of the data-taking conditions in ATLAS1.

Footnote 1: In ATLAS, for the modules of the barrel layers the cluster size in the \(R\phi\) direction will depend on the difference between the particle incident angle and the Lorentz angle. The latter depends on the bias voltage [22]. At a bias voltage of 600 V, which is the standard value used for irradiated detectors, the average value of the effective incident angle will be 15\({}^{\circ}\)[23].

#### 4.2.1 Efficiency with standard front-end configuration

The column pair occupancy and the detection efficiency are reported as a function of the column number in Fig. 2, for the highest beam intensity and the standard set of front-end electronics settings. The plots on the left are for an irradiated module, and those on the right for the not irradiated module. The latter reaches a larger occupancy because the number of hits produced by a particle at 15\({}^{\circ}\) incidence angle is larger for a not irradiated detector due to the larger amount of charge collected. No efficiency losses are observed up to the maximum column pair occupancy of 0.24 hits/cp/bx, which exceeds the maximum value expected for the B-layer in ATLAS.

Figure 2: The upper pictures report the column pair occupancy as a function of column number. The lower pictures report the detection efficiency as a function of column number. The pictures on the left are for irradiated module 510910 and the pictures on the right for not irradiated module 510929. Data were taken at \(15^{\circ}\) incidence angle. The TOT peak was tuned to 15 bunch crossings, the latency was 130 bunch crossings, the column readout frequency was 40 MHz, and hit duplication was off.

Figure 3: The upper pictures report the column pair occupancy as a function of column number. The lower pictures report the detection efficiency as a function of column number. The pictures on the left are for irradiated module 510910 and the pictures on the right for not irradiated module 510929. Data were taken at 15\({}^{\circ}\) incidence angle. The TOT peak was tuned to 15 bunch crossings, the latency was 130 bunch crossings, the column readout frequency was 40 MHz, and hit duplication was on.

#### 4.2.2 Efficiency with hit duplication

The results change when hit duplication is activated, allowing to reach an even larger occupancy (Fig. 3). The column pairs on which the beam is more intense have a lower detection efficiency. For the irradiated module the detection efficiency is 94.4% for the column pair with the largest occupancy of 0.273 hits/cp/bx, while for the not irradiated module the efficiency is 89.8% for the column pair with the largest occupancy of 0.306 hits/cp/bx. For both detectors, the hit loss becomes significant when the mean occupancy is larger than about 0.24 hits/cp/bx, or 30 hits per column pair in the latency.

There is strong evidence that the origin of this inefficiency is related to the filling of the end-of-column buffers. The hit duplication is performed in logic at the bottom of the column, just as hits are being written in the end-of-column buffers. Therefore, enabling the hit duplication increases the effective occupancy in the EOC buffers, but not in the column-pair itself. Furthermore, in 21.5% and 75.9% of events, for the irradiated and not irradiated module respectively, the front-end error flag related to the filling of the end of column buffer is on. If events with this error flag are excluded from the analysis, the efficiency dip disappears. Conversely, if no flag is set, then the low-intensity value of hit loss is the correct one.

#### 4.2.3 Efficiency with increased latency

A further confirmation that the filling of the end of column buffers is indeed the origin of the losses is provided by the fact that the occupancy above which hit losses appear scales with the latency. When the latency is increased, this increases the time

Figure 4: The upper pictures report the column pair occupancy as a function of column number. The lower pictures report the detection efficiency as a function of column number. The pictures on the left are for irradiated module 510910 and the pictures on the right for not irradiated module 510929. Data were taken at 15\({}^{\circ}\) incidence angle. The TOT peak was tuned to 15 bunch crossings, the latency was 250 bunch crossings, the column readout frequency was 40 MHz, and hit duplication was off.

that hits stored in the EOC buffers must wait until their trigger arrives, or (if there is no matching trigger), they are reset. Therefore, doubling the latency increases the average occupancy in the EOC buffers, without changing the occupancy in the column pair itself.

When the latency is set at 250 clock cycles, the losses are observed on the column pairs with an occupancy larger than 0.12 hits/cp/bx, or 30 hits per column pair in the latency (Fig. 4). About 74.2% and 94.1% of events, for the irradiated and not irradiated module respectively, have the front-end error flag set.

#### 4.2.4 Efficiency at a lower readout frequency

Efficiency losses are also observed when the readout frequency is lowered to 20 MHz (Fig. 5). However, for this run the front-end error flag due to the filling of EOC buffers is always off, as it is in the run at lower intensity. These losses have a different origin than the ones in the runs with hit duplication or with a longer latency: because of the low column scan frequency, the hits are not transferred from the pixel matrix to the EOC buffers within the latency. The hit losses appear at an occupancy larger than 0.14 hits/cp/bx. It is thus expected that at a readout frequency of 40 MHz, the same hit loss mechanism would be active at an occupancy larger than 0.28 hits/cp/bx. This occupancy is much larger than the one foreseen for the B-Layer at the nominal LHC luminosity and was never reached at the test beam.

#### 4.2.5 Summary of efficiency measurements at \(15^{\circ}\)

The efficiency measured for the irradiated module 510910 is reported in Table 3. For every data-taking run, the occupancy and detection efficiency are reported for the

Figure 5: The upper pictures report the column pair occupancy as a function of column number. The lower pictures report the detection efficiency as a function of column number. The pictures on the left are for irradiated module 510910 and the pictures on the right for not irradiated module 510929. Data were taken at \(15^{\circ}\) incidence angle. The TOT peak was tuned to 15 bunch crossings, the latency was 130 bunch crossings, the column readout frequency was 20 MHz, and hit duplication was off.

column pair on which the beam is most intense. The fraction of events with a front-end chip error word is also reported.

Similar results were observed for the other modules. The summary of the efficiency measurements performed at 15 degrees is reported in Table 4.

#### 4.2.6 Efficiency and TOT tuning

An efficiency difference at the level of a fraction of per cent is expected between the two TOT tunings (a nominal value of 15 and 30 clock cycles). The anticipated hit loss mechanism is the following. If a particle crosses a pixel cell before the signal due to a previous event has fallen below the discriminator threshold, only one hit will be recorded, with a longer TOT and with the time stamp of the first particle. Since this time stamp will most likely be outside the narrow window of consecutive clock cycles read out at the test beam, the pixel hits will be lost. The resulting hit loss is

\[\Delta\epsilon=\alpha\mathrm{Occupancy}\times\mathrm{TOT} \tag{1}\]

where Occupancy is the single pixel occupancy, TOT is the average of the TOT distribution, and \(\alpha\) is expected to be of the order of -1. For a pixel occupancy of \(5\times 10^{-4}\) per clock cycle (the value expected for the B-layer) and an average TOT of 15 clock cycles, an efficiency loss of about 0.75% is expected, which should increase to about 1.5% for an average TOT of 30 clock cycles.

A systematic comparison between the efficiency measured with the two TOT tunings is reported in Table 5. For each incidence angle, beam intensity, and module, the following information is provided:

* The actual value of the average of the pixel TOT distribution for the two TOT peak tunings. The tuning value is the value of TOT corresponding to the charge released by a minimum ionizing particle (about 25000 electrons). However, the charge collected by a single pixel is often lower, because of charge sharing between pixels. As a result, the average of the TOT distribution is actually smaller than the tuning value. Unsurprisingly, lower values are observed for the irradiated detectors and for the data taken at 15\({}^{\circ}\) incidence angle.
* The single pixel occupancy. This is equal to the column pair occupancy reported before, divided by the number of pixels in a column pair (320).
* The efficiency difference between the data taken with the two TOT tunings (15 and 30). At high intensity, the data taken with the longer TOT tuning have indeed a smaller efficiency, and the difference is of the order of a fraction of per cent, as expected. The relation between the efficiency difference and the product Occupancy\(\times\Delta(TOT)\), where \(\Delta TOT\) is the increase in the average TOT, is reported in Fig. 6. The data are consistent with a linear relation, and the slope of the linear fit, which is \(\alpha=-0.78\pm 0.17\), is consistent with -1 as expected.

## 5 Conclusions

Test beam data were used to study the data detection efficiency at high rate of ATLAS Pixel detector production modules. Before the test beam, three of the four detector studied at the test beam had been irradiated to the full LHC lifetime fluence expected for ATLAS Pixels (\(10^{15}\) n\({}_{\mathrm{eq}}\)cm\({}^{-2}\)).

With standard front-end electronics settings, the detector efficiency of irradiated detectors remains close to 98% up to an occupancy of 0.24 hits per clock cycle per column 

\begin{table}
\begin{tabular}{||c|c|c|c||c|c||c|c|c||c||} \hline Occupancy & \(\epsilon\) & \(\epsilon\) & \(\epsilon\) & Occupancy & \(\epsilon\) & tot & lat. & read. & hit \\ irradiated & \({}_{510689}\) & \({}_{510852}\) & \({}_{510910}\) & not irr. & \({}_{510929}\) & & & dupl. \\ [hits/cp/bx] & & & & [hits/cp/bx] & & [bx] & [bx] & [MHz] & \\ \hline
0.199-0.202 & 0.978 & 0.982 & 0.985 & 0.239 & 0.984 & 15 & 130 & 40 & NO \\
0.184-0.185 & 0.956 & 0.956 & 0.951 & 0.203 & 0.918 & 15 & 250 & 40 & NO \\
0.197-0.198 & 0.932 & 0.918 & 0.889 & 0.217 & 0.688 & 15 & 130 & 20 & NO \\
0.269-0.282 & 0.964 & 0.967 & 0.944 & 0.306 & 0.898 & 15 & 130 & 40 & YES \\
0.191-0.200 & 0.974 & 0.979 & 0.981 & 0.233 & 0.981 & 30 & 130 & 40 & NO \\ \hline \end{tabular}
\end{table}
Table 4: Measurements of detection efficiency performed with data taken at 15\({}^{\circ}\) incidence angle. The first column reports the average occupancy of the irradiated modules for the column pair on which the beam was most intense. The range corresponds to the fact that due to the different position of each module relative to the beam, the occupancy varies slightly from module to module. The second to the fourth columns report the measured detection efficiency of the three modules irradiated to 10\({}^{15}\) n\({}_{\rm eq}\)cm\({}^{-2}\). The fifth and the sixth column report, respectively, the occupancy and the efficiency of the not irradiated module. The last columns report the front-end electronics settings, in this order: the TOT peak tuning value and the latency, the column readout frequency, and whether hit duplication was on.

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c|c||} \hline Angle & Occupancy & \(\epsilon\) & error words & tot & lat. & read. & hit dupl. \\  & [hits/cp/bx] & & & [bx] & [bx] & [MHz] & \\ \hline
0 & 0.031 & 0.983 & 0.000 & 30 & 130 & 40 & NO \\
0 & 0.032 & 0.985 & 0.000 & 15 & 130 & 40 & NO \\
0 & 0.090 & 0.984 & 0.000 & 15 & 130 & 40 & NO \\
0 & 0.089 & 0.983 & 0.017 & 15 & 250 & 40 & NO \\
0 & 0.088 & 0.983 & 0.000 & 15 & 130 & 20 & NO \\
0 & 0.130 & 0.985 & 0.003 & 15 & 130 & 40 & YES \\
0 & 0.085 & 0.981 & 0.000 & 30 & 130 & 40 & NO \\
15 & 0.200 & 0.985 & 0.002 & 15 & 130 & 40 & NO \\
15 & 0.184 & 0.951 & 0.742 & 15 & 250 & 40 & NO \\
15 & 0.197 & 0.887 & 0.000 & 15 & 130 & 20 & NO \\
15 & 0.274 & 0.944 &pair. This value exceeds by about 40% the maximum occupancy foreseen for the innermost layer of the ATLAS Pixel Detector at the LHC design luminosity of \(10^{34}\) cm\({}^{-2}\)s\({}^{-1}\)[1, 2].

At larger occupancies, a small inefficiency arises from saturation of the end-of-column buffers of the front-end electronics chip. This saturation is properly flagged by the FE Buffer Overflow flags. Removing the events with the error flag restores the hit efficiency to its value at a lower intensity. The maximum value of column pair occupancy reached at the test beam was 0.27 hits per clock cycle for irradiated modules, and 0.30 hits per clock cycle for the not irradiated module. The corresponding efficiencies were about 96% for irradiated modules and 89.8% for the not irradiated module.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline Angle & Module & TOT(15) & TOT(30) & Occupancy & \(\Delta\epsilon\) \\ \([^{\circ}]\) & & [ \(\mathrm{bx}\) ] & [ \(\mathrm{bx}\) ] & [ \(\mathrm{hits/bx}\) ] & meas. \\ \hline
0 & 510689 & 10.2 & 13.8 & \(1.1\times 10^{-4}\) & 0.0019 \\
0 & 510852 & 11.1 & 17.1 & \(1.4\times 10^{-4}\) & 0.0006 \\
0 & 510910 & 10.9 & 17.0 & \(1.0\times 10^{-4}\) & -0.0021 \\
0 & 510929 & 13.8 & 26.0 & \(1.3\times 10^{-4}\) & -0.0009 \\
0 & 510689 & 10.3 & 13.9 & \(2.9\times 10^{-4}\) & -0.0010 \\
0 & 510852 & 11.1 & 17.0 & \(3.3\times 10^{-4}\) & -0.0030 \\
0 & 510910 & 10.9 & 16.9 & \(2.8\times 10^{-4}\) & -0.0030 \\
0 & 510929 & 14.0 & 26.1 & \(3.2\times 10^{-4}\) & -0.0032 \\
15 & 510689 & 8.2 & 10.8 & \(6.2\times 10^{-4}\) & -0.0012 \\
15 & 510852 & 9.7 & 14.6 & \(6.3\times 10^{-4}\) & -0.0027 \\
15 & 510910 & 8.8 & 13.3 & \(6.3\times 10^{-4}\) & -0.0046 \\
15 & 510929 & 10.2 & 18.3 & \(7.5\times 10^{-4}\) & -0.0027 \\ \hline \end{tabular}
\end{table}
Table 5: Measurements of the variation of detection efficiency with the TOT tuning values. The incidence angle, module number, actual value of the average pixel TOT for the two tunings, the pixel occupancy and the difference in efficiency between the two TOT tunings are reported.

Figure 6: Variation of efficiency when the TOT tuning is increased from 15 to 30 clock cycles, as a function of the single pixel occupancy.

Non-standard settings of the front-end electronics were also studied. When the latency is increased from 130 to 250 clock cycles, the intensity at which hit losses are observed is reduced by the same factor, as expected.

The reduction of the frequency of the column pair readout clock from 40 MHz to 20 MHz results in a sharp efficiency loss when the occupancy exceeds 0.14 hits per clock cycle per column pair, because some pixel hits are not transferred to the end-of-column buffers within the latency of 130 clock cycles. With the usual 40 MHz operation, hit losses due to this mechanism are not expected unless the occupancy is larger than twice this value (0.28 hits per clock cycle per column pair).

The efficiency also decreases when the amplifier feedback current is changed, so that the peak of the Time-Over-Threshold distribution increases. The effect is due to the passage of a second particle through a pixel cell before the signal produced by the first event has fallen below the discriminator threshold. The efficiency loss is compatible with expectations and it is very small. For an average TOT of 15 clock cycles and the nominal B-layer occupancy, the efficiency loss due to this effect is 0.75%.

The test beam results demonstrate that at the hit rates expected for the B-Layer at the design LHC luminosity the pixel detector modules have an efficiency larger than 98%. However, it should be noted that the testbeam did simulate the high rate of hits in the modules, but did not simulate the high Level-1 rate and data trasmission rate that would be expected at LHC, so it is only a partial simulation of operation at the highest luminisities.

Also, the B-layer hit detection efficiency may be reduced by a few per cent if the occupancy significantly exceeds the nominal value. This may occur for several reasons, such as track loopers at low momenta, a \(pp\) cross section at the LHC energy larger than the current estimate, or a machine luminosity exceeding the design value. Very large values of occupancy will also be reached during the heavy ion runs.

## Acknowledgements

The production of the ATLAS Pixel Detector modules and their study at the test beam are the results of an effort involving the entire Pixel Collaboration. We want to thank the large number of collaborators who contributed to the success of the project and made these studies in a test beam possible.

## References

* (1) The ATLAS Pixel Detector collaboration, Pixel Detector Technical Design Report, CERN/LHCC 98-13 (1998).
* (2) V. Kostyukhin, Update on rates in B-layer, presentation at the Pixel Week Software meeting, CERN, February 2004.
* (3) L. Blanquart et al., IEEE Trans. on Nucl. Sci. 51 (2004) 1358.
* (4) C. Gemme, Nucl. Instr. and Meth. A501 (2003) 87.
* (5) M. G. Sciveres, The ATLAS Pixel Detector, ATLAS Communication, ATL-COM-INDET-2004-004.
* (6) A. Andreazza, Nucl. Instr. and Meth. A535 (2004) 357.
* (7) F. Huegging, The ATLAS Pixel Detector, arXiv:physics/0412138 (2004).
* (8) M.S. Alam et al., Nucl. Instr. and Meth. A456 (2001) 217.
* (9) I. Gorelov et al., Nucl. Instr. and Meth. A489 (2002) 202.