# Single Track Performance of the Inner Detector New Track Reconstruction (NEWT)

T. Cornelissen, M. Elsing, I. Gavrilenko

CERN

W. Liebig

NIKHEF, Amsterdam, The Netherlands

A. Salzburger

Leopold Franzens Universitat Innsbruck, Austria & CERN

Corresponding author: Andreas.Salzburger@cern.ch

for the ATLAS Inner Detector Software Group

###### Abstract

In a previous series of documents we have presented the new ATLAS track reconstruction chain (NEWT) and several of the involved components. It has become the default reconstruction application for the Inner Detector. However, a large scale validation of the reconstruction performance in both efficiency and track resolutions has not been given yet. This documents presents the results of a systematic single track validation of the new track reconstruction and puts it in comparison with results obtained with different reconstruction applications.

Introduction

In a previous document [1] we have presented a newly established track reconstruction application (NEWT) that recently became the default reconstruction strategy for the ATLAS _Inner Detector_ (ID). NEWT is characterised by a component model architecture and is based on a common event data model (EDM), which is together with other key parts of the new track reconstruction program described in another series of documents to very detail (see [2] to [5]). However, a global performance overview of NEWT has been missing in this context. Recently, a large scale validation of the ATLAS ID performance using single track events has been carried out for the existing reconstruction programs in preparation for an exhaustive document [6] that describes the setup and performance of the entire ATLAS detector just before data taking starts in 2008. The large scale validation has been initially performed with the ATLAS offline release 13.0.30, and revealed several problems that have been -- at least partly -- solved in the meantime. This document aims to fulfill a two-folded purpose: it marks the first large scale validation of the NEWT reconstruction chain, but should also show points of weakness or potential problems to be revised towards first data taking. It presents various performance figures of NEWT and puts them also in comparison to the second, powerful track reconstruction iPatRec [7] that has been a reference for ATLAS ID track reconstruction for many years.

Many modules of NEWT have currently spread out into realms of combined reconstruction and track reconstruction in the _Muon Spectrometer_ (MS). Being immature in comparison to the well established NEWT chain in the ID, this document will restrict itself to the inner tracking devices and leave similar considerations for the MS to the future. The presented performance figures will also be restricted to single particle events and will cover only the first sequence -- the inside-out track search -- of NEWT. Vertex reconstruction, particle identification and heavy quark tagging will not be covered, since they are not particular to one reconstruction program1.

Footnote 1: Thanks to the nowadays fully established common EDM, these modules can be performed regardless of the used track reconstruction program.

### Document Structure and Typesetting

The structure of this document reflects the task of track reconstruction, which can be -- in a classical picture -- divided into pattern recognition and track fitting. Section 2 focusses on the reconstruction efficiencies that reflect to a large extent the quality of the pattern recognition modules. Section 3 covers in the following the final track parameter resolutions that usually incorporate several more aspects: the reconstruction material model, the quality of the measurement description and outlier handling. It should be remarked that this strict division of pattern recognition and track fitting is usually not valid when dealing with full physics events. For single track events, however, such a factorised investigation is indeed useful and can be done without compromising either of the two parts. Blocks written in Courier face refer to actual software implementations.

### Used Event Samples

Single particle events with large statistics and constant transverse momentum \(p_{\mathrm{T}}\) (50 000 single particle events per \(p_{\mathrm{T}}\) value ) have been produced for the presented validation of NEWT. The transverse momentum values spread in discrete steps from 1 GeV to 2 TeV; very large transverse momenta are used for charge misinterpretation studies. The production vertex for the single particles has been smeared according to standard ATLAS primary vertex smearing, i.e. Gaussian smearing with \(\sigma_{xy}=15\)\(\mu\)m in the transverse plane and \(\sigma_{z}=56\) mm in the longitudinal plane. The single tracks have been produced according to flat distributions in a pseudorapidity range of \(|\eta|<3.0\) and uniformly spread over the entire azimuthal angle of 2 \(\pi\).

Event simulation and digitisation have been done with ATLAS software release 13.0.30; the reconstruction has been using release 13.0.30 for iPatRec and 13.2.0 for NEWT2. The default track fitter for this release has been the KalmanFitter implementation. The event digitisation has been restricted to simulate electronic noise hits only on detector modules that had recorded hits from primary or secondary tracks from the full detector simulation; for single track events, this simplification is totally valid3 and speeds up the digitisation process significantly. The used detector layout was CSC-02-00-00. The authors would also like to emphasise that the presented results are in consideration of the most optimistic scenario that includes perfect alignment and exact knowledge of the inert detector material and calibration. In this sense, the given performance figures should be regarded as the _potential_ performance of the ID track reconstruction, while it is clearly recognised that these performance numbers will not be met with initial data.

Footnote 3: There is little chance that a bunch of noise hits can be misidentified as a track, in particular when applying track quality cuts that have been used in this study, see Sec. 2.1.

#### 1.2.1 Statistical Uncertainties and Method Description

The quoted results are produced with 50000 events per given momentum range and in the pseudorapidity of \(|\eta|<3\), with the implicit restriction of the ID acceptance region up to a pseudorapidity value of \(|\eta|<2.5\). Efficiencies, fake rates and resolutions are either given for the full \(\eta\) range and rely thus on a statistic of 40 000 events, or they are quoted for either 10 or 20 equidistant \(|\eta|\) bins. The single bins contain consequently about 4000 or 2000 generated single particle events, respectively.

Resolutions are given as the root mean square (RMS) of the residual distributions. The boundaries for the according distributions are estimated, such that 99.7 % (i.e. an equivalent of 3 \(\sigma\) of a Gaussain distribution) of all entries are included in the RMS calculation. It should be remarked that this definition includes most of the significant tails that are present in e.g. the tack parameter residuals of pions and that a Gaussian fit to the core of the distribution would lead to improved resolution figures. The method chosen should, however, guarantee compatibility with the resolution calculation as presented in [6], but should also allow for the non-Gaussian character of some distributions to be respected while guaranteeing one consistent definition throughout the document. Quality cuts are applied on the reconstructed tracks, and described in more detail in Sec. 2.1. Hit pulls and residuals are given as the unbiased quantities on the associated reference frames (i.e. the primary vertex or measurement surfaces). This means that if a measurement has been present in the very same examined track frame, it has not been used for the residual or pull calculation.

The relative uncertainty for the RMS of track parameter residuals is thus about 0.5 % for the total sample and either 1.6 % or 2.2 % for each \(|\eta|\) bin. For hit residuals, the statistical error is even smaller since the event statistic is multiplied by the according hit multiplicities per track. Errors on efficiencies and fakes are calculated using the method given in [8]. In general, if errors are not shown or visible in figures, they are within the regime of the marker size and thus omitted for convenience.

## 2 Reconstruction Efficiencies

The definition of any reconstruction efficiency is controversial itself; it relies on the definition of what is regarded as to be _successfully_ reconstructed on the one hand, but also on the definition of the signal on the other hand. In some sense, this is remains a decision of taste, and -- when analysing future taken data with the detector, this question is anyway impossible to answer. Keeping latter in mind, the authors tried to impose quality cuts as they may be used in future analyses of ATLAS data rather than relying on stringent truth matching criteria. The reconstructed tracks are as such not matched by an identifier to the generated particle, only a hit matching probability to one particle is required; even if this particle is a secondary particle (e.g. coming from an interaction at the beampipe or an innermost layer), it would be regarded as a successfully reconstructed particle as long as the quality cuts are fulfilled. It should be mentioned that it is not always possible in this context to separate detector effects from the pure software performance. The authors will, however, try to identify the contributing effects to the overall track reconstruction efficiencies and resolutions.

### Cut and Efficiency Definitions

The applied cuts on generator level are mainly targeted at providing a clean signal sample that is characterised by prompt tracks within the geometrical acceptance region of the detector. Ensuringonly prompt tracks is respected on two levels: a generator identifier number, the so-called _barcode_ is used to restrict the signal to primary particles is used together with a restriction in the transverse and longitudinal displacement to the primary vertex (expressed though the perigee parameters \(d_{0}\), \(z_{0}\) and \(\theta\), which are in more detail described in Sec. 3.1). The latter restriction is superfluous for single track events, since it is inert to the barcode requirement. As it is part of a common set of generator cuts that has been applied, it is however mentioned here for completeness. On reconstruction level, on the other side, the impact parameter restriction is indeed needed to identify prompt tracks.

The following cuts on generator level have been applied for tracks:

* _tracker acceptance region:_\(|\eta^{gen}|<2.5\)
* _prompt tracks:_ barcode \(<100000\)
* _primary vertex:_\(|d_{0}^{gen,PV}|<2\) mm, and \(|z_{0}^{gen,PV}|\cdot\sin\theta^{gen}<10\) mm

They define the set of tracks which should have been recorded by the detector and reconstructed by the tracking algorithms to later fulfill the some quality cuts. These quality cuts are mainly motivated by the interest to use the found tracks in context of meaningful physics analyses:

* _tracker acceptance region:_\(|\eta^{rec}|<2.5\)
* _primary vertex:_\(|d_{0}^{rec,PV}|<2\) mm, and \(|z_{0}^{rec,PV}|\cdot\sin\theta^{rec}<10\) mm
* _hit quality cut silicon:_ a number of minimum 7 hits in the silicon detector is required;

Both generator and reconstruction cuts rely on the impact parameters \(d_{0}\) and \(z_{0}\) to be expressed with respect to the generated primary vertex (PV). In the data taking scenario, quality cuts on the impact parameters will be applied, when the point of closest approach is expressed w.r.t. the reconstructed primary vertex; in single track events this is clearly not applicable, since vertex reconstruction can not be performed. The choice of the generated vertex in the presented study helps in addition to cancel the influence of vertex reconstruction algorithms on efficiency calculations and track parameter resolutions.

When momentum resolutions are quoted, an additional constraint of a successful extension of the silicon track candidate into the TRT is required. This is because the TRT contributes significantly to the momentum resolution. A successful track match is defined if at least 80 % of the hits contributing to the track fit (i.e. outliers are omitted) correspond to one particle trajectory4. The reconstruction efficiency is henceforth defined as

Footnote 4: The definition of such a matching criteria to the truth trajectory is not always trivial. This is due to the fact that during the full simulation strong interaction processes of the particle with detector material (such as the emission of a hard brem photon) change the particle identification. The track matching has therefore to be done with an entire truth trajectory collection that follows the original generated particle during these changes.

\[\epsilon^{rec}=\frac{N_{match}^{rec}}{N^{gen}}, \tag{1}\]

where \(N_{match}^{rec}\) denotes the number of tracks that comply with the reconstruction cuts and are matched to a generated prompt particle, and \(N^{gen}\) is the number of tracks that are within generator cuts. Contrary to successfully matched tracks, _poor_ and _fake_ tracks are defined as the number either poorly matched tracks \(N_{poor}^{rec}\) or unmatched tracks \(N_{unmatched}^{rec}\) that have still passed the reconstruction quality cuts. The matching criteria are then defined as:

* _poorly matched_: more than 50 %, but less then 80 % of hits match with one generated particle trajectory;
* _unmatched_: less than half of the hits originate from one particle.

Consequently, the _fake rate_\(\zeta\) and _poor rate_\(\xi\) are defined as

\[\zeta=\frac{N_{unmatched}^{rec}}{N^{rec}}\text{ and }\xi=\frac{N_{poor}^{ rec}}{N^{rec}} \tag{2}\]where \(N^{rec}\) is the number of all tracks that have been successfully reconstructed within the quality cuts. Clearly, by broadening the reconstruction quality cuts, higher efficiencies can be achieved. However, the risk of contaminating the track output sample with fake or poorly measured tracks increases.

Reconstruction efficiencies and fake rates are strongly dependent on the particle type, since they are highly sensitive to the interaction process between the particle and the detector material. Minimum ionising particles yield the highest reconstruction efficiencies (in the given momentum range of final state particles this is close to 100 % over the entire acceptance region of the ID, see Sec. 2.1.1). Hadronic particles5 are degraded by nuclear interactions with the detector material and show lower reconstruction efficiencies. Finally, electrons suffer strongly from radiation loss and lead to the lowest reconstruction probability for a large part of the investigated momentum range, in particular when reconstruction quality cuts are applied.

Footnote 5: In the ATLAS track reconstruction, only three types of particles are considered: muons, electrons and pions. No distinction between different hadrons is done, the particle identification is carried out at a later stage in the event reconstruction process.

The reconstruction efficiencies for single \(\pi^{+}\) and \(e^{-}\) tracks are shown for NEWT and iPatRec in Fig. 1. It can be seen that under application of the given reconstruction and matching cuts NEWT yields slightly higher reconstruction efficiencies than iPatRec for the major part of the momentum range. Only for particles with \(p_{\mathrm{T}}\) higher than 100 GeV iPatRec tends to be similarly efficient (pions) or even slightly superior (electrons). One other aspect is revealed in this picture: while electron tracks at low momenta have a relatively low reconstruction efficiency compared to single pion tracks, the situation is flipped for high momentum tracks. The reason for this is that bremsstrahlung effects are

Figure 1: Reconstruction efficiencies and for prompt pions and electrons in single track events for different particle momenta. The closed markers represent the NEWT performance, while the open ones show in comparison the obtained results for iPatRec. The plots to left shows the reconstruction efficiencies in dependence of the pseudorapidity for certain transverse momenta; right: total reconstruction efficiency and fake rate depending on the \(p_{T}\) value is shown.

most pronounced at lower momenta, while they lose importance the stiffer the track gets. In addition, when hadrons undergo nuclear interactions which can effectively lead to a loss of the original particle. Hence, there is a maximum limit for pions to be reconstructed in the ID.

Fake and Poor RatesNo significant fake rates could be observed for the three different particle types and the two reconstruction strategies. However, tracks with poor hit matching are present in small but measurable quantities in pion and electron samples and they appear more likely at higher initial particle energies, see Fig. 2. This may be due to the fact that induced secondary particles are mostly collinear to the initial particle direction and their hits are thus more likely to be (falsely) associated to the initial track.

Both iPatRec and NEWT show a very small rate of poorly associated tracks that stays well below 1 % for the momentum range up to \(100\leavevmode\nobreak\ \mathrm{GeV}\). A slightly lower poorly associated track rate for NEWT can be observed.

#### 2.1.1 Single Component Performance

In the previous section, the _global_ performance statistics of NEWT has been quoted; these numbers represent the results from the main sequence of the NEWT ID tracking, the inside-out track search. The NEWT inside-out sequence is build from two main parts: the silicon track finding and the extension of tracks into the outer _Transition Radiation Tracker_ (TRT). The modular design of NEWT allows to split the performance validation into individual software components. Reconstruction efficiencies and fakes or poor rates can thus also be given independently for the track candidates found in the silicon detector, the resolved track collection after the first ambiguity solving and final track after extension into the outer tracker. In this situation, the advantage of the component module design of NEWT is revealed: since the EDM objects that are passed between the several steps are well defined objects, common validation algorithms can work on any of the given steps: the independent validation modules can be plugged in at several places into the algorithm flow, or even be called on an on-demand basis. A further description of this mechanism can be found in the original reference [1], where the NEWT philosophy is explained to very detail.

Figure 3 shows the reconstruction efficiencies for single muon tracks of high and low transverse momenta for NEWT in the two main stages of the inside-out reconstruction chain: the candidate track collection built from seeds in the silicon detector and the track collection after passing the ambiguity solver and extension into the TRT. The latter can -- under the given matching conditions -- increase the efficiency since they may overrule a misidentified silicon cluster (this can be either through an increase in the matching probability or simply by removing the fake cluster from the track fit in the outlier logics). The efficiency drop at a pseudorapidity of about 1.4 could be identified as a significantly increased number of failed track fits in comparison to other \(|\eta|\) bins, however, the candidate track is provided in these cases by the pattern recognition process.

Figure 2: Rates for poorly matched tracks that have passed the reconstruction quality cuts for single pions and electrons comparing NEWT and iPatRec.

It could be shown in a recent study that the exchange of the standard KalmanFitter with the GlobalChi2Fitter[9] successfully recoveries the loss of efficiency in the given pseudorapidity ranges. Figure 4 shows a comparison of reconstruction efficiencies for low and high transverse momentum muon tracks with both fitting techniques as the standard fitter used in the NEWT reconstruction chain. This study has been carried out with a development release that is close to the expected performance of the ATLAS 14.0.0 release. It can be seen that also the efficiency of single muon tracks when using the default KalmanFilter implementation has increased due to a modified track scoring approach in the ambiguity solving process.

There are few more striking arguments for the component software model of NEWT than this simple example: since both fitter types implement the same ITrackFitter interface and can be loaded independently at run-time, the change from one to yet another fitter type is simply a one-line change in the job configuration. It reveals how the component model helps to react rapidly when a problem in one single part is found.

TRT ExtensionIn the track extension from the silicon detectors to the TRT, the hit statistics of the entire track can be changed; since the track fit is performed on a new, expanded hit collection outlier definitions can be changed and thus even reconstruction efficiencies may be modified slightly, see Fig. 3. On the other hand, the TRT extension is not capable of rejecting a track that has survived the ambiguity solving process6. A highly efficient TRT extension is required, since the longer lever arm and the additional precise measurements further along the track contribute significantly to the momentum resolution. Figure 5 shows the extension efficiency for NEWT depending on different particle types at a transverse momentum \(p_{\mathrm{T}}=100\) GeV, such as the effect of the TRT extension on the momentum resolution.

Figure 4: Reconstruction efficiencies for single muon tracks with two different fitter types being used in NEWT. The current KalmanFilter implementation in release 13.2.0 shows an increased number of failed track fits, while the GlobalChi2Fitter recuperates many of these tracks and yields almost 100 % reconstruction efficiency over the entire acceptance range. An updated version of the KalmanFilter is currently worked on to be integrated in the next ATLAS software release.

Figure 3: Reconstruction efficiencies for single muon tracks with low and high transverse momenta as they are processed by the two main parts of the NEWT inside-out reconstruction sequence. The filled symbols show the global efficiencies after the entire reconstruction process, while the open symbols represent the efficiency for the candidate track collection at the given transverse momenta. The efficiency drop at \(|\eta|\approx 1.4\) indicates a problem in the track fitting, a more detailed investigation has identified a significantly increased number of failed track fits in this region.

There are three regions where the extension probability into the TRT is slightly degraded, all of which have a geometrical reason: at the centermost bin there is a small gap between straws on the positive and negative side of the TRT barrel, leaving the possibility that a particle can pass through without interaction with any (or with too few) sensitive detector parts; at \(|\eta|\approx 0.75\) there is a lower number of hits on track due to the transition from the TRT barrel straws to the endcap discs; this region also marks the highest material distribution in the Inner Detector. This effect is also reflected in a change of momentum resolution in this particular area. Finally, at large pseudorapidity values the geometrical acceptance region of the TRT is exceeded.

## 3 Track Parameter Resolutions

The track parameter resolutions are the ultimate quantities to describe the reconstruction quality: they accumulate many effects that can not always be easily disentangled. Material effects integration (and thus the quality of the reconstruction material description) contributes alongside to effects from the pattern recognition (through wrong or missed hit assignments), but also calibration data and clusterisation algorithms.

### Used Track Parameterisation

The track parameterisation in the ATLAS EDM [2] is slightly modified w.r.t. the helix-based track expression that has been widely used in many former high energy physics experiments. This is, because the tracking EDM should serve the track reconstruction algorithms of both ATLAS tracking devices, the Inner Detector and the outer Muon System. Since only one global reference frame can be chosen while the magnetic field setup of the ID and MS are somewhat perpendicular (a solenoidal field _aligned_ with the beam line in the ID and a toroidal field in the MS), a helical parameterisation bound to the solenoid field would leave the Muon Spectrometer with an almost meaningless choice of parameters. For this reason, a parameterisation has been chosen that is closely bound to the constants of motion in both tracking devices. A perigee representation in the Inner Detector, that is used to express the closest approach to the nominal interaction point, is described by

\[\tau_{i}=(d_{0},z_{0},\phi,\theta,q/p). \tag{3}\]

The following comparison, however, is entirely based on ID tracks and for the convenience of backward comparison with formerly published performance figures [10], a purely helical based track parameter

Figure 5: Extension efficiency into the TRT for single particle types of \(p_{\mathrm{T}}=100\) GeV; a successful TRT extension is hereby defined by finding at least 10 TRT hits; the end of the TRT acceptance region at a pseudo-rapidity slightly higher than 2 can be seen. The plot to the right compares the momentum resolution for tracks fitted in the silicon detector parts (triangles) with tracks after the TRT extension process (closed circles) without explicitly requiring a successful TRT extension. The result of the iPatRec default track collection is displayed as open circles.

isation is chosen, which yields

\[\tau_{i}=(d_{0},z_{0},\phi,\cot\theta,q/p_{\rm T}), \tag{4}\]

keeping in mind that within NEWT the common tools act on the EDM parameters as given in Eq. (3). The track parameters are often divided into the strongly correlated transverse parameters (\(d_{0},\phi,q/p_{\rm T}\)) and their longitudinal counterparts (\(z_{0},\cot\theta\)).

It should also be mentioned that for investigations of the longitudinal impact parameter a necessary transformation from the global frame to the helical frame at the point of closest approach has to be applied; taking account of this, the longitudinal component of the impact parameter in three dimensions is given as \(z_{0}\times\sin\theta\) and will be used as such in the following. iPatRec uses an internal event data model, the output is finally converted into the tracking EDM.

### Parameter Resolutions

The following parameter resolutions are obtained for muon and pion tracks, respectively, and refer to the RMS of the residual distribution, accounting for 99.7 % of all tracks that have passed the tracking quality cuts. No further hit truth matching is applied in this context. While muons yield the best track parameter resolutions as they leave the cleanest trace in the detector, pion resolutions are of particular interest, since an overwhelming fraction of tracks in a typical event will be regarded as hadrons. Pions suffer mainly from one additional effect: they undergo nuclear interactions with the detector material, which may either effectively shorten the track length, or adds an additional deflection to the coulomb multiple scattering. The following section will summarise the results obtained for single muon and pion tracks, an exhaustive table for the different pseudorapidity bins can be found in the Appendix, Sec. A.2.

Impact Parameter ResolutionsA precise impact parameter estimation is crucial for vertex reconstruction and quark flavor tagging. Figure 6 shows the transverse and longitudinal impact parameter resolutions for single muon tracks of certain momenta reconstructed with NEWT and iPatRec.

In general, NEWT yields a slightly better impact parameter resolution than iPatRec, in particular for lower momenta. This indicates a better description of the detector material, that is in NEWT handled through a dedicated reconstruction geometry, the so-called _TrackingGeometry_[4]. For high momenta, the transverse impact parameter resolution approaches rapidly an asymptotic limit which is given through the intrinsic detector resolution (see, for more details, Sec. 3.3). In the high momentum limit, the results obtained with NEWT and iPatRec are almost identical, since they share the same common cluster descriptions. It can be demonstrated that the main discrepancy between the resolutions obtained with NEWT and iPatRec results from the different tail contributions that are present in the residual distributions. A brief comparison for the \(d_{0}\) distribution at low momenta can be found in the appendix, Sec. A.1.

Figure 6: Transverse and longitudinal impact parameter resolutions for single muons tracks with transverse momenta \(p_{T}=1,5,100\) GeV reconstructed with NEWT and iPatRec.

For single muon tracks the resolution of the transverse impact parameters \(d_{0}\) is significantly less than 10 \(\mu\)m for the high momentum limit in the central region, and increase only slightly at higher pseudorapidity values. For single pions, the situation is worse: hadronic interactions with the detector material add significant tails to the impact parameter resolutions and in particular the longitudinal impact parameter component is heavily disturbed. This effect gets more pronounced at higher pseudorapidity values, since it is enhanced by the back propagation to the nominal vertex position. For large \(|\eta|\) values, the longitudinal propagation distance grows accordingly fast, while the transverse projection stays roughly the same7.

Footnote 7: Since the transverse and longitudinal track parameters can be close to the center of the solenoid regarded as uncorrelated quantities, such a division between longitudinal and transverse components is indeed valid.

Figure 7 shows a comparison between the impact parameter resolutions obtained for single muon and pion tracks with NEWT.

Angular ResolutionsThe angular track resolutions play an important role in vertex reconstruction and via constraint fitting and their essential component to the momentum determination to any mass measurement. In a solenoidal field setup, where the trajectory of a charged particle follows closely a helix, there is a strong correlation amongst both the transverse and longitudinal track parameters, respectively. The characteristics of the angular resolutions follow thus very closely the results obtained for the impact parameter resolutions. Figure 8 shows the corresponding angular track parameter resolutions for low and high momentum single muon tracks. Again, when comparing results obtained with NEWT and iPatRec, the new tracking chain yields a higher resolution for low momentum tracks due to the improved material description of the ID.

Momentum ResolutionsObtaining an accurate momentum estimation is of similar importance as the impact parameter resolution. A correct momentum estimation is crucial for every kinematic analysis of the underlying event. In particular for electrons that are subject to significant radiation loss, this is a non-trivial task that requires dedicated fitting algorithms; electron fitting, however, is usually performed in a later stage of the event reconstruction and the following results are thus obtained for muon tracks to illustrate the potential performance of the ID tracker, see Fig. 9. At momentum resolution at high momenta is dominated by geometrical effects of the TRT detector that are reflected in both reconstruction programs: the end of the acceptance region, the barrel-endcap

Figure 7: Comparison of the impact parameter resolutions for single muon and pion tracks with \(p_{\mathrm{T}}=5~{}\mathrm{GeV}\). Hadronic interactions disturb the clean minimal ionising signature for pions and lead to an increased impact parameter resolution; this effect is most prominently pronounced for the longitudinal impact parameter resolution for high-\(\eta\) tracks. The strong spread and scattering structure at higher \(\eta\) is somewhat coincident with the endcap structures of the silicon detector. For the convenience of the reader, a simplified \(r-z\) view of the pixel detector is added to the right, indicating the same \(|\eta|\) boundaries as given in the left illustration.

crack, and the gap between the barrel straws at positive and negative side of the TRT detector can be identified similarly to the previously discussed TRT extension efficiency.

A new measurement handling in the TRT that was recently introduced in combination with a flexible decision about the drift sign has led to a gain in the momentum resolution for NEWT in comparison to iPatRec results.

In contrast to the impact parameter and angular resolutions, which improve with higher momenta due to the vanishing multiple scattering effects, the momentum resolution degrades with increasing momenta, since the track become stiffer and the influence of the intrinsic cluster error becomes more pronounced. For very large momenta, there is even a possibility that the curvature sign of the track can not be clearly determined in the track fit. This can lead to an effective misidentification of the particle charge and will be in more detail discussed in Sec. 3.4. In the following section, Sec. 3.3, it will be shown that the impact parameter resolutions are dominated by the measurements close to the vertex, while for the momentum resolutions all measurements are equally important.

The momentum resolution can be improved when constraining the track in addition to the assigned hits to the beam spot (or nominal interaction point). In fully deployed physics analyses, this constraint for prompt tracks will be with respect to the reconstructed primary vertex. For the simulated single track events, a simple constraint to the smeared generated vertex has been used to demonstrate this effect. First tests with a modified refit algorithm have shown an improvement of the momentum resolution from 1 % at 1 GeV increasing to about 5 % at 100 GeV. When applying optimised track seeding in case of a beam constraint, this numbers may even be slightly increased.

Figure 8: Angular track parameter resolutions for single muons tracks with transverse momenta \(p_{T}=1,5,100\) GeV reconstructed with NEWT and iPatRec.

Figure 9: Relative momentum resolution for single muon tracks of different momenta in the Inner Detector. The results obtained with NEWT and iPatRec are shown in comparison and indicate a better momentum resolution of NEWT in the high momentum limit.

### The \(\boldsymbol{A\oplus B}\) Model

The resolution of a track parameter \(\tau\) can be expressed as a function of the transverse momentum \(p_{\mathrm{T}}\). This is due to the fact, that -- in general -- multiple scattering is the dominant process noise in track fitting at low momenta, while it vanishes at high momenta and the parameter resolution is dominated by the intrinsic detector resolution. In a simplified model, the track parameter resolution can be expressed in the form

\[\sigma_{\tau}(p_{\mathrm{T}})=A_{\tau}\oplus B_{\tau}/p_{\mathrm{T}}. \tag{5}\]

This expression is approximate, working well at high \(p_{\mathrm{T}}\) (where the resolution is dominated by the intrinsic detector resolution) and at low \(p_{\mathrm{T}}\) (where the resolution is dominated by multiple-scattering), respectively. It originates from a simplified two layer detector model, and is often referred to as \(A\oplus B\)_model_. It is thus not applied as a fit to the parameter resolutions of different momenta, but rather estimated at the high and low end of the momentum spectrum. Equation (5) can also be expressed through the asymptotic resolution at _infinite_ momentum \(\sigma_{\tau}(\infty)\), which yields

\[\sigma_{\tau}(p_{\mathrm{T}})=\sigma_{\tau}(\infty)(1\oplus p_{\mathrm{T}}^{ c}/p_{\mathrm{T}}), \tag{6}\]

when \(p_{\mathrm{T}}^{c}\) marks the critical momentum where the contribution of the intrinsic measurement error and the multiple scattering is equal. Figure 10 shows the critical momentum for the impact parameters (\(d_{0},z_{0}\times\sin\theta\)) and the momentum estimate \(q/p_{\mathrm{T}}\) when reconstructing muon tracks with NEWT. The according collection of tables for NEWT can be found in the Appendix, Sec. A.2, of this document, where also the angular parameter resolutions are included.

### Charge Misidentification

In Sec. 2.1.1 -- Fig. 5 -- it can be seen that the relative momentum resolution degrades with increasing transverse momentum. This can be straight-forwardly understood when regarding the momentum measurement as a _sagitta_ measurement at several discrete localisations8. Since at very high transverse momenta the tracks appear as stiff straight lines in the tracking device, there is a possibility (evoked by the intrinsic localisation uncertainty of the detection devices) that the curvature of particle estimated in the track fit carries the wrong sign, i.e. the charge of the particle has been misidentified. Figure 11 shows the obtained inverse transverse momentum estimation for muon and electron tracks at \(p_{\mathrm{T}}\) = 2 TeV. The charge misidentification probability for muons is lower than for electrons for the major part of the shown momentum range. In the very high momentum limit, however, both values seem to approach an asymptotic limit and there is almost no difference between muon and electron tracks. This observations are at first sight quite surprising: one would expect that the loss of energy due to bremsstrahlung pulls the momentum distribution towards lower momenta and thus towards a higher probability to estimate the correct sign of the track curvature. A more detailed investigation, however, reveals the nature of this unexpected behavior; electron tracks suffer from an additional effect that contributes to the charge misidentification rate: radiated bremsstrahlung photons are at

Figure 10: The critical momentum \(p_{\mathrm{T}}^{c}\) at which the intrinsic measurement error contributes equally to the track parameter resolution than the multiple scattering effects for the impact parameters and the momentum parameter for NEWT. It is remarkable to see how the transverse momentum resolution reassembles the shape of the material distribution in the Inner Detector.

very high energies collinear to the track direction. If they convert into an electron-positron pair also the conversion products continue in the original track direction. These particles can cause fake hits that are falsely assigned to the track and thus disturb the momentum resolution. When restricting the track collection to tracks that have a very stringent requirement of 99 % truth matching on hit level, the charge misidentification for electrons indeed falls below the rate for muons with the _help_ of bremsstrahlung effect. Figure 12 shows the integrated charge misidentification for muons and pions at two different hit truth matching values, the lower bound of 80 % is hereby almost identical to no truth matching at all, since the reconstruction quality cuts already clean the track collections from the main part of a potential contamination through poor or fake tracks.

The charge misidentification probability is not only dependent on the transverse momentum, but also on the pseudorapidity. The dominant effect is that the TRT detector only spans over a limited pseudo-rapidity range and thus particles at \(|\eta|>2.0\) have significantly shorter track lengths, which in turn results in a worse momentum resolution -- and thus to a higher charge misidentification probability. Figure 12 shows the charge misidentification probability for muons and electrons starting from 100 GeV to 2 TeV, and presents in addition the \(\eta\) dependency for both particle types at a fixed transverse momentum of \(p_{\rm T}=2\) TeV.

## 4 Error Description

The correct handling of the track reconstruction error is of great importance in conjunction with an accurate track parameter estimation. This is inevitable for almost any successive event reconstruction -- beginning with vertex reconstruction and b-tagging that rely on correct covariance matrices. It is also necessary for quality and consistency checks in the reconstruction process. A stringent test in this respect is to investigate the parameter pull distributions

\[\mbox{pull}(\tau)=\frac{\tau^{rec}-\tau^{true}}{\sigma_{\tau}}, \tag{7}\]

that should -- if \(\sigma_{\tau}\) is correctly estimated -- lead to unbiased Gaussian distributions with a width of \(\approx 1\). Figure 13 shows the RMS of the pull distributions for the five track parameters for different transverse momenta and integrated over the entire pseudorapidity range.

Both, iPatRec and NEWT, incorporate a good error description for the impact parameters and the directional parameters of the perigee representation. The \(q/p_{T}\) distribution, however, shows a significant deviation from an RMS value of 1, an effect that is similarly pronounced for iPatRec and

Figure 11: Fraction of misidentified (shaded area) particle charge for high \(p_{\rm T}\) electrons and muons. For a large momentum range, the charge misidentification rate for muons is lower than for electrons. In the limit case of transverse momenta \(\approx 2\) TeV, electrons charge misidentification becomes slightly lower than for muons, since the energy loss contribution pulls the electrons towards lower momenta, which then feel a stronger bending power; this leads to the significantly bigger tail contributions in the electron \(q/p_{\rm T}\) distribution. A hit truth matching requirement of 80 % has been applied for the track selection.

NEWT, but appears less pronounced in Silicon only tracks. It leads to the assumption that it is either related to cluster error assignments in the TRT, or maybe caused by different propagation precision in simulation and reconstruction. Differences in the precision of the underlying propagation engines have been observed (in particular at larger extrapolation distances), but no conclusive evidence favoring one of the used transport engines has been found yet [12].

Pull Distributions on Measurement LevelThe correct description of the intrinsic measurement error contributes alongside to the accuracy of the applied material effects integration to the overall quality of the error description. A proper description of the intrinsic measurement error is less trivial than it first sounds: for Silicon detectors there is, in general, a strong dependency of the cluster sizes on the relative incident angle of the track with the detection devices; on the other hand, additional aspects such as the Lorentz-force dependent drift corrections or characteristics of the clustering and readout systems have to be understood for a correct estimation of the expected cluster errors. In NEWT, an entire layer of post-measurement calibration has been included to allow for an independent scaling of the measurement errors. This will be in particular necessary for first data taking, when misaligned detector elements will fake huge measurement uncertainties and disregarding this effect would stop any successful track fit from happening. Since the ID alignment approach is entirely built on a track-based alignment procedure, this situation would be unacceptable. A progressive approach starting

Figure 12: Fraction of misidentified particle charge for muons and electrons depending on their transverse momenta (left). Right: dependency of the charge misidentification fraction on the pseudo-rapidity for a fixed transverse momentum of \(p_{\mathrm{T}}=2~{}\mathrm{TeV}\). The upper plots show the misidentification probability for tracks with a minimum hit truth matching of \(80~{}\%\). The bottom plots, on the other hand, show the rates for a very stringent hit truth matching of \(99~{}\%\). In this case, electron tracks are less likely to be falsely tagged, since bremsstrahlung effects help to determine the correct curvature sign. For less _clean_ tracks this effect is shadowed by fake hit contributions to the overall momentum resolution.

from highly inflated measurement errors towards more realistic cluster description is therefore needed in parallel to the iteratively carried out alignment of the ID tracker. In the present tests, however, the scaling of the cluster errors has been set to 1.

Figure 14 shows the unbiased pull distributions of Silicon clusters and TRT measurements for single muon tracks at 1 GeV and 100 GeV for the overall acceptance range of the ID. The RMS of the distributions are highly compatible with 1, which indicates a good overall error description (and a high quality reconstruction material description). It can be seen that the cluster shapes and drift time distributions are in the high momentum limit deviated from Gaussian distributions, while this effect is smeared out at lower momenta, when the material effects dominate the measurement errors.

While the overall error description seems to be reasonably good, some anomalies are visible when investigating the cluster errors as a function of the pseudorapidity. A strong \(\eta\)-dependence of the pull distributions on hit level could be observed, which indicates a wrong error estimation in several \(|\eta|\) bins. These findings have been reported to the according communities [11] and an updated model is expected to be delivered with ATLAS release 14.0.0. Figure 15 shows the \(|\eta|\)-dependence of the Silicon cluster

Figure 13: RMS of the pull distributions for the five track parameters at the point of closest approach to the beam axis obtained for NEWT, NEWT (Silicon only) and iPatRec. The distributions are shown for single muon tracks of different transverse momenta. A significant deviation from the anticipated value of \(\approx~{}1\) is observed for the momentum error estimation. This effect is way less pronounced for the Silicon only tracks, and indicates a non-optimal error handling in the TRT, or a connection to longer propagation distances.

errors for high momentum muons with \(p_{\rm T}=100\) GeV and their associated reconstruction biases.

## 5 Conclusion and Outlook

The performance of reconstruction software is a moving target and thus difficult to conclude. We have presented the first large scale single track validation of the new track reconstruction NEWT in the full awareness that the presented picture is not more than a snapshot in time. However, it could be shown that NEWT has become a highly performing reconstruction strategy for the ATLAS Inner Detector. It is comparable in speed and track reconstruction quality with iPatRec and benefits from the component software model and the established event data model. In particular the use of the new reconstruction geometry, that has an automated procedure to adapt itself to changing detector descriptions results in a high quality track reconstruction over the entire momentum range of final state particles that are subject of track reconstruction.

In the process of this performance validation, several problems have been revealed and many of those have already been successfully addressed, which e.g. already resulted in a strong improvement of the transverse momentum resolution and a better error description during the latest major release cycle of the ATLAS offline software. Other findings such as the non-optimal description of cluster errors in the Silicon detector or the poor momentum error description are currently investigated or have been solved in order to achieve full functionality and performance for first data taking in 2008.

Figure 14: Unbiased pull distributions for Silicon cluster and TRT measurements for single muon tracks with low and high transverse momenta. The upper two plots show the pull distributions of the pixel detector in both local coordinates. For the SCT and TRT, only the actually measured cluster coordinates are shown. While the cluster shapes at high momenta are non-Gaussian, they tend to Gaussian distributions at lower momenta, since multiple scattering contribution gain importance.

Figure 15: Silicon cluster hit pulls widths and biases for single muon tracks of high transverse momentum \(p_{\rm T}=100~{}{\rm GeV}\). The width of the pull distributions is given as the RMS over the full distribution or the \(\sigma\) of a Gaussian distribution fitted a central part of 99 % of all entries. For pixel modules, pull widths and biases are given for both local coordinates \(l_{1}\) and \(l_{2}\), while for SCT measurements only the measured coordinate transverse to the strip is illustrated. A clear dependence of the hit pull distributions could be observed with release 13.2.0. An updated description is planned to be integrated into the next major ATLAS offline release 14.0.0.

Appendix

### Tail Comparison

In Sec. 3.2, the resolutions for the transverse impact parameter \(d_{0}\) has been given as the RMS over 99.7 % of all reconstructed tracks. In particular at lower momenta, a higher resolution for NEWT could be observed, dominated by a better handling of the tail contribution. Figure 16 illustrates this fact in two ways: it shows the impact parameter resolution \(\sigma(d_{0})\) for different transverse momenta, when the resolution is obtained with a core fit including a \(2-\sigma\) equivalent of all reconstructed tracks. NEWT and iPatRec are much more compatible within this definition. The plot to the right shows the fraction of entries above the Gaussian curve defined by the fitted \(\sigma(d_{0})\) for \(p_{T}=1\) GeV.

### Resolution Tables

The following tables, Tab. 1 and Tab. 2, show the track parameter resolutions parameterised with the \(A\oplus B\) model for single muon and pion tracks, respectively. The results are given in 20 equidistant \(|\eta|\) bins with a statistic of about 2000 entries per bin. The big discrepancy between the muons and pions at very high momenta is due to tail distributions that contribute strongly in the RMS calculation; these tails are mainly caused by effectively shorter tracks or misidentified secondary tracks, both caused by nuclear interactions.

## References

* [1] A. Salzburger (Editor) et al, _The new ATLAS Track Reconstruction (NEWT)_, ATLAS Public Note, ATL-SOFT-PUB-2007-007, 2007.
* [2] F. Akesson et al, _The ATLAS Tracking Event Data Model_, ATLAS Public Note, ATL-SOFT-PUB-2006-004, 2006.
* [3] T. Cornelissen et al., _Updates of the ATLAS Tracking Event Data Model_, ATLAS Public Note, ATL-SOFT-PUB-2007-003, 2007.
* [4] A. Salzburger, S. Todorova and M. Wolter, _The ATLAS Tracking Geometry Description_, ATLAS Public Note, ATL-SOFT-PUB-2007-004, 2007.
* [5] A. Salzburger, _The ATLAS Extrapolation package_, ATLAS Public Note, ATL-SOFT-PUB-2007-005, 2007.

Figure 16: Left: Transverse and longitudinal impact parameter resolutions for single muons tracks with transverse momenta \(p_{T}=1,5,100\) GeV reconstructed with NEWT and iPatRec obtained from a core fit including an equivalent of a 2-\(\sigma\) fraction of all entries (\(\approx 95.4\) %). Right: fraction of entries above the Gaussian curve resulting from the 2-\(\sigma\) fit for \(p_{T}=1\) GeV.