###### Abstract

The time reconstruction of the events in the Tile Calorimeter using a differential algorithm is discussed in this note. The laser pulses acquired during August 2001 and June 2002 test beam periods, have been used to extract the corrections due to the effect of the propagation of the TTC clock signal. The delay introduced by each digitizer board on the TTC clock propagation turns out to be about 2-3 ns, while the precision of the time reconstruction after the correction of the TTC clock propagation is about 0.5 ns. This timing algorithm is then applied to muon events. The comparison of the speed of a muon impinging on the barrel module at 90 degrees (the speed of the light) and the speed computed using the timing algorithm can be used as a check for the timing of all the channels of the barrel module. The computed speed of the muons turns out to be compatible with \(c\).

July 29, 2003

**DRAFT 2**

**The Timing of the Tile Calorimeter using laser events**

T. Del Prete\({}^{(1)}\), I. Vivarelli\({}^{(1),(2)}\)

\({}^{(1)}\)_Istituto Nazionale di Fisica Nucleare, Pisa, ITALY_

\({}^{(2)}\)_Scuola Normale Superiore, Pisa, ITALY_Introduction

The main aim of this work is to verify the feasibility of a good time reconstruction of the Tile Calorimeter. The time associated with one event can be calculated with many algorithms, some of which are discussed in sec. 2. The differential algorithm is the most reliable, as it is quite insensitive to the noise.

In section 3 it is discussed the use of the laser [1] events to compute the corrections to be applied for the delays introduced by the propagation of the TTC clock signal. In fact, once the corrections for the different path length of the light [2] have been applied, the light on the PMTs is expected to be synchronous and only the electronic effects have to be evaluated.

The effectiveness of the time corrections has been checked with the test beam data of muons impinging at 90 degrees on the barrel module. The muons travel through a full row, and the time of flight can be calculated in each cell of a row. Therefore the speed of the muons can be calculated and compared with \(c\), the speed of the light in vacuum.

## 2 The Timing Algorithm

In the Tile Cal standard test beam ntuples, each signal is sampled in 9 bins of 25 ns each, and several approaches were investigated to extract the time information from the 9 samples; the algorithm should be fast, linear, low dependent of the noise and the pulse shape.

The first attempt has been made calculating the derivative of the buckets of the sampling. In fact if the signal was a continuous function, the maximum of the signal could be found by imposing the derivative of the signal to be zero. For each time bin \(j\), one can compute the difference \(\Delta S=S_{j+1}-S_{j}\) between the values of the sampling in the \(j+1\)-th and the \(j\)-th bin. The value of the crossing point (\(T_{\sigma\,oss}\)) can be easily evaluated considering the straight line passing through \(T_{i}\), the center value of the bin of the maximum sample \(S_{i}\), and \(T_{i}+\Delta T\) (\(\Delta T=25\) ns), the center of \(S_{i+1}\), and turns out to be:

\[T_{cross}=T_{i}+\frac{R}{1+R}\Delta T\qquad R=\frac{S_{i}-S_{i-1}}{S_{i}-S_{i+ 1}} \tag{1}\]

This procedure has been checked using the pulse shape available in ref. [3]. According to this shape 9 bins of 25 ns have been generated. The difference between the maximum of the pulse shape (the true time \(T_{0}\)) and the reconstructed time (\(T_{rec}\)) is plotted in fig. 2 as a function of \(T_{rec}\). The points on the plots are obtained varying the phase between the the pulse shape and the beginning of the sampling.

The finite bin width of 25 ns produces \(\pm 2\) ns wiggles that can be partially removed fitting the plot of fig. 2 with a function of the form:

\[f(x)=K\sin(aT_{rec}+b) \tag{2}\]The black points show the dependence of the difference between \(T_{0}\) and \(T_{rec}\) from \(T_{rec}\) before the correction obtained with the fit is subtracted, while the white points show the result once the correction is applied.

A second possibility for the timing algorithm is to consider a value for the reconstructed time \(T_{rec}\) given by the weighted time average over a number of the sampling bins (average algorithm). In this case, \(T_{rec}\) is given by

\[T_{rec}=\frac{\sum t_{i}S_{i}}{\sum S_{i}} \tag{3}\]

where \(t_{i}\) is the time of the \(i\)-th bin of the sampling. Because of the way to calculate the \(T_{rec}\), this algorithm can be sensitive to the noise.

In order to compare the sensitivity of the two algorithms to the noise, a signal+noise simulation has been performed. The experimental noise has been measured using pedestal events. The same level of white noise has been added to the pulse shape. The phase difference between the sampling and the beginning of the signal has been changed, and the RMS of \(T_{rec}\) has been computed as a function of the pulse area for the differential algorithm and for the average algorithm with different choices of the number of samplings to include in the computing (all the 0-9 samples, only the 1-7 samples, or five samples

Figure 1: _In the differential algorithm, the difference \(\Delta S_{j}=S_{j+1}-S_{j}\) is computed for each bin of the sampling. In the top plot the sampled signal is shown, the bottom one shows the \(\Delta S_{j}\) and the crossing point._

around the maximum, from the one before the maximum to the third after). The results are shown in fig. 3.

The differential algorithm turns out to be the less sensitive to the noise, especially in the range of the muon signal, which has a pulse shape between 20 and 100, depending on the cell considered.

Based on these results, in the following the differential algorithm is adopted for the analysis.

## 3 The laser pulse data

The laser data of the barrel modules of August 2001 and June 2002 test beam periods have been used to check the algorithm.

The laser system [1] allows to monitor the timing of all the PMTs of a Tile Cal module. In the test beam configuration, the laser light is transferred from the control room to the modules by liquid fiber, and it is then distributed to the PMTs with clear fibers of different lengths. The trigger of the laser is independent of the 25 ns TTC clock, hence the time phase between the trigger and the beginning of the sampling is not fixed.

As the lengths of the clear fibers are different from cell to cell, in order to equalize the time response of the PMTs it is necessary to apply a correction which takes into account the differences of path length of the light. Table 1 shows the length of the clear fibers as

Figure 2: _The difference \(T_{0}-T_{rec}\) as a function of \(T_{rec}\) is shown before (black dots) and after (white dots) the sinusoidal correction is applied._

they have been summarized in [2] and the corresponding corrections assuming the speed of the light in the fibers of 18 cm/ns.

The timing algorithm has been applied to the laser events of run 110447 (for August 2001) with laser flag 1 and to the laser events of run 200322 (for June 2002) with laser flag 2. The reason for the different choice in the laser flag (i.e. in the level of laser light) is explained in sec. 3.2.

For each PMT one histogram has been created. To remove the jitter of the laser, the time difference between the \(i\)-th PMT and the PMT D0Up of the positive side of the barrel module is computed event by event, and the corresponding \(i\)-th histogram is filled with this value. The average of the \(i\)-th histogram has been taken as the time of the \(i\)-th tube.

Figure 4, left side, shows the timing of the 90 PMTs of the barrel module obtained using laser data of August 2001 test beam period, while the right side shows the same results obtained in June 2002. The corrections for the different fiber lengths are applied in both cases. It is important to point out that during August 2001 and June 2002, two different modules of the barrel calorimeter, with different electronics, have been tested.

The plots clearly show the same structure, with still some effects which have not been removed by the previous corrections. First of all, the digitizer structure [5] (six PMTs per digitizer board) is clearly visible.

The modulation of the timing of the PMTs due to the propagation of the TTC clock, not yet taken into account, is responsible for the double peak structure of the plot. The TTC clock fibers are in fact connected in the middle of each superdrawer, between the fourth and the fifth digitizer board. Then, the TTC clock signal propagates from the center to the sides of the superdrawers. Each digitizer board is claimed to introduce

Figure 3: _The RMS of the time reconstruction as a function of the pulse area for various algorithms. For comparison, the muons pulse area goes from 20 to 100, depending on which sample is taken into account._

between 2 and 3 ns of delay in the propagation of the TTC clock.

Finally, there is a shift of about 3 ns between the positive and the negative side of the barrel module. This can be caused by a different length of about 50 cm of the liquid fibers which take the laser light from the control room to the test beam table.

### The sensitivity to the noise

To cross check the considerations that have been done in sec. 2 about the sensitivity to the noise of the differential algorithm with respect to an algorithm based on a weighted average of the time of the samples (as it is, for example, in the standard test beam ntuples of the Tile Cal community), the RMS of the timing histograms described above have been considered.

The laser data in the standard test beam ntuples provide three different level of light, namely indicated with laser flag 1,2 and 4. There is a factor ten in intensity between laser flag 1 and 2, and again a factor ten between laser flag 2 and 4.

\begin{table}
\begin{tabular}{|c|c|c||c|} \hline Cell (up) & Cell (down) & Length (cm) & Correction (ns) \\ \hline A10 & A10 & 329.6 & 9.02 \\ B9 & B9 & 317.9 & 8.37 \\ D3 & X & 306.3 & 7.73 \\ BC8 & BC8 & 294.7 & 7.08 \\ A9 & D3 & 283.1 & 6.44 \\ A8 & A9 & 271.5 & 5.8 \\ BC7 & BC7 & 259.9 & 5.15 \\ X & A8 & 248.3 & 4.51 \\ A7 & X & 236.7 & 3.86 \\ BC6 & BC6 & 225.1 & 3.22 \\ D2 & A7 & 213.5 & 2.57 \\ A6 & D2 & 201.9 & 1.93 \\ BC5 & A6 & 294.7 & 7.08 \\ A5 & BC5 & 283.1 & 6.44 \\ A4 & A5 & 271.5 & 5.8 \\ BC4 & BC4 & 259.9 & 5.15 \\ D1 & A4 & 248.3 & 4.51 \\ BC3 & D1 & 236.7 & 3.86 \\ A3 & BC3 & 225.1 & 3.22 \\ A2 & A3 & 213.5 & 2.57 \\ BC2 & BC2 & 201.9 & 1.93 \\ A1 & A2 & 190.3 & 1.28 \\ BC1 & BC1 & 178.7 & 0.64 \\ D0 & A1 & 167.1 & 0.0 \\ \hline \end{tabular}
\end{table}
Table 1: _Values of the clear fiber lengths for the barrel modules. The last column is the time correction applied (calculated supposing a speed of 18 cm/ns for the light into the fibers)._Figure 6 shows the RMS of the timing histogram for each channel for three levels of light for the differential algorithm (in white) and for the standard test beam ntuple variable (in black). The plot has been made using August 2001 test beam data. Comparing the plot relative to the laser flag 1 and 2, it can be concluded that, as predicted in sec. 2, the standard ntuple timing become less precise as the signal to noise ratio decrease. Its RMS changes by a factor 4 (only 2 for the differential algorithm) with a change of a factor 10 in the light signal.

Figure 4: _Timing of the 90 PMTs of the barrel module obtained using laser data (corrections for the fiber lengths applied. The left plot refers to August 2001 test beam period, while the right plot refers to June 2002._

Figure 5: _The difference in time between high and low gain signal for the 90 PMTs channel of barrel in the double gain run 200630._

Figure 6: _The RMS of the timing histograms for each channel and for the three different levels of light._

While laser flag 1 and 2 have been acquired using the low gain, laser flag 4 has been acquired using the high gain, so the signal to noise ratio is increased with respect to laser flag 2.

Concerning with the plot relative to laser flag 1, the channels with an RMS much bigger than the others correspond to saturated channels, i.e., channels where at least one sample has saturated the entire dynamic range of the ADC. In this case, the timing of the differential algorithm is much worse than the standard ntuple one. That is because algorithms based on some weighted average are less sensitive to the shape of the signal, and therefore less sensitive to saturation.

### The time shift between high and low gain

The two plots of fig. 4 have been made using events with a different level of light.

The timing study of the PMTs of August 2001 has been made using the maximum level of light, i.e., laser flag 1, while that of the June 2002 data has been made using laser flag 2. The reason of this choice lies on the fact that the level of the laser light for laser flag 1 is much lower in 2002 test beam data than it was in 2001. The laser flag 1 level of light is just at the threshold of the saturation for the high gain ADC [4]. The consequence is that the laser flag 1 data from June 2002 were collected with either the high gain and low gain configurations, while the laser flag 1 events from August 2001 have been recorded with only the low gain configuration.

The presence of differences in timing between the electronic chains of high and low gain configurations has been checked using the double gain run 200630, collected during the June 2002 test beam. The algorithm has been applied to laser events with laser flag 1. Saturated events, i.e., events with one of the 9 samples greater than 1000 ADC counts, have not been included in the analysis. For each PMT one histogram has been created and filled with the time difference in high and low gain configuration. Figure 5 shows the mean values of the histograms. There is a difference of 2.4 ns (on average) in time between the high and low gain signal.

It has been verified that, using the laser flag 1, the June 2002 laser data have events either at high and at low gain, while the laser flag 2 has only high gain events. Therefore, the timing of the June 2002 test beam data has been made using laser events with laser flag 2.

### The TTC clock modulation

In order to synchronize all the cells of Tile Cal barrel modules, the modulation due to the TTC clock signal propagation must be removed. The TTC clock is a digital signal for the TTC-rx chip [6] which is present in each digitizer board. The TTC-rx chip provides the 25 ns clock to the ADC. Therefore, the effect of the TTC signal propagation is related to the digitizer structure. There is a group of six PMTs for each digitizer board. The timing of each digitizer board has been assumed as the average over the times of the six PMTs obtained as described in sec. 3.

Fig. 7 shows the results of the timing once the average on each digitizer board has been computed. The error on each point is computed as the RMS of the average, i.e., the RMS divided by the square root of six. The four different slopes are the modulation due to the TTC clock propagation. The TTC signal is in fact picked up in the middle of each superdrawer and then distributed. If the laser signal is synchronous (as it is supposed to be once the corrections for the fiber lengths have been applied), the difference in time between the beginning and the crossing point of the derivative of the sampling will decrease as the distance of the digitizer board increase. Therefore a maximum of the timing is expected in correspondence with the middle of the two superdrawers, as indeed it is shown in fig. 7.

Figure 7: _The timing averaged on each digitizer board for August 2001 (left) and June 2002 (right) laser data._To subtract the effect of the TTC clock propagation, the four different slopes of fig. 7 have been fitted either for the August 2001 and for the June 2002 test beam data. Four

Figure 8: _The fits of the four different slopes of the laser timing for August 2001 (up) and June 2002 (down) laser data._

different linear functions of the form

\[f(x)=P_{0}+P_{1}x \tag{4}\]

where \(x\) is the number of the digitizer, have been used. The results of the fit are shown in fig. 8.

The delay introduced by each digitizer board turns to be slightly dependent on the drawer (half a superdrawer), and it is within 1.7 and 3 ns per digitizer board.

The TTC clock modulation is then subtracted from the laser data using the parameterizations defined by the fits. The result is reported in fig. 9 (June 2002 test beam data, analogous result is obtained for August 2001 test been data). Once the modulation is removed all the PMTs are synchronized in a window of \(\pm 1\) ns, as shown in the right plot of fig. 9. A gaussian is used to fit the results. In a conservative approach, the sigma of the histogram (\(\sigma\simeq 0.5\) ns) will be used in the following as a systematic error on the timing of the single PMT.

## 4 A check of the timing using muons

The rightness of the synchronization of the PMTs of the barrel module can be easily checked using muons impinging on the module at 90 degrees. Considering a muon traveling through the calorimeter, the time of the crossing in each cell of one sample can be evaluated using the timing algorithm discussed above. Therefore the speed of the muon (\(c\), the speed of light in the vacuum) can be checked.

Actually, the definition of the effective length of a barrel module is not a trivial task. Considering, for example, the D cells, the timing algorithm provides 7 values of the timing, corresponding to the dimension of 6 cells. In general, the 90 degrees muons impinging on a row of \(n\) cell, can provide \(n\) values of the timing, corresponding to an effective length

Figure 9: _Left: the timing of the PMTs of the barrel module once the TTC clock modulation is subtracted (June 2002 test beam data). Right: the values of the left figure have been put in a histogram and fitted with a gaussian._

of \(n-1\) cells. This is true if all the cells in a row have the same dimension, but it is not the case of the barrel tile cal module, as the cell dimension has been chosen following a pseudo-projective pattern.

However, the muon data analysis only aims to verify the effect of the corrections of fiber length and clock propagation, and the uncertanty on the barrel length will cause a systematic error on the calculated muon speed.

The effective length of the calorimeter has been made keeping the dimension of a given cell (A,B,C and D) constant from one cell to another. The resulting effective length is:

\[l_{eff}=l\frac{n_{i}-1}{n_{i}} \tag{5}\]

where \(i\) can be A,B,C or D, depending on which row is traveled by the muons, and \(n_{i}\) is the number of cells in the row (\(n_{A}=20\), \(n_{B}=18\), \(n_{C}=16\), \(n_{D}=7\)) and \(l=564\) cm is the total length of one barrel module [1].

In the August 2001 runs, the muons have been selected as \(\mu\) contamination on a beam of nominal electrons with an energy of 180 GeV. Runs 110447,110445,110442,110437 have been considered. The selection has been made imposing \(Trig=1\) in the standard ntuples, and considering only the events with an energy deposition lower than 5 GeV and higher than a threshold different from row to row (see tab. 2) in the last cell downstream the beam.

For the June 2002 test beam period, runs 200313,200316,200319,200322 have been considered. They are muons of 180 GeV impinging on the negative side of the barrel module on, respectively, A,B,C and D cells.

The timing algorithm has been applied to the selected sample of data, and the corrections for the propagation of the TTC clock signal (see sec. 3.3) have been applied. Also in this case, the average of the time of the single PMT with respect to the timing of one PMT taken as reference has been considered as the timing of the PMT. The timing of one cell is obtained taking the average over the two PMTs. The error bar is computed taking into account the systematic error on the timing of the PMTs of sec. 3.3 and the statistic error on the mean value of the timing due to the spread of the time distribution of the single PMT.

The two plots on the top of fig. 10 show the results obtained for C (left) and D (right) cells using June 2002 test beam data, while the bottom plots show the results obtained using August 2001 test beam data for C (left) and A (right) cells. It is important to point out that the timing on the A cells is difficult: since the dimensions of the cells is small, the energy release of a muon is also small, therefore the signal to pedestal ratio is poor. Nevertheless, as discussed in sec. 2, the differential algorithm is less dependent than the others on the noise. This makes the measurement of the timing of the muons in A cells

\begin{table}
\begin{tabular}{|c||c|c|c|c|} \hline Row & A & B & C & D \\ \hline Threshold (GeV) & 0.5 & 0.6 & 0.6 & 1.0 \\ \hline \end{tabular}
\end{table}
Table 2: _Values of the low threshold in energy deposition into the last cell going downstream the beam for the selection of muons._reliable.

The results obtained for the speed of light are summarized in tab. 3.

## 5 Conclusions

The timing of the Tile Calorimeter using a differential algorithm, the least sensitive to the noise, has been discussed in this note. The laser test beam data of August 2001 and June 2002 has been used to calculate the corrections due to the propagation of the TTC clock

\begin{table}
\begin{tabular}{|c||c|c|c|c|} \hline Row & A & B & C & D \\ \hline Aug 2001 & \(32\pm 1\) & \(30\pm 1\) & \(31\pm 1\) & \(32\pm 2\) \\ Jun 2002 & \(29.5\pm 0.5\) & \(30.0\pm 0.5\) & \(30.4\pm 0.5\) & \(31\pm 1\) \\ \hline \end{tabular}
\end{table}
Table 3: _Table of the results of the calculation of the speed of light in the different rows. The results are computed both for the August 2001 and for the June 2002 test beam data (the unit is cm/ns)._

Figure 10: _Up: The timing of the muons in C (left) and D (right) cells obtained using June 2002 test beam data. Down: the same in C (left) and A (right) cells using August 2001 test beam data._

signal. As expected, the delay introduced by each digitizer board is between 2 and 3 ns. A difference in the timing of about 2.4 ns between the high and low gain laser events has been found using the double gain run 200630. Once the TTC clock propagation effect is removed, the PMTs are synchronized with an RMS of 0.5 ns.

After the corrections have been applied, the timing of the whole calorimeter has been checked using muons impinging at 90 degrees. The results for the speed of light are in fair agreement with \(c\), the speed of the light in vacuum.

All the results presented in this work show an internal consistency, which leads to the conclusion that the time response of the PMTs of the Tile calorimeter can be synchronized at the level of 0.5 ns.

## References

* [1]_ATLAS Tile Calorimeter Technical Design Report_, CERN/LHCC/96-42, ATLAS TDR 3, 15 December 1996.
* [2] Agostinho Gomes, private communications.
* [3][http://t.home.cern.ch/t/teuscher/www/opflit.html](http://t.home.cern.ch/t/teuscher/www/opflit.html)
* [4] K. Anderson _et al._, _Front-end Electronics for the ATLAS Tile Calorimeter_, available at [http://hep.uchicago.edu/atlas/electr/Writeups/Rome_Paper.pdf](http://hep.uchicago.edu/atlas/electr/Writeups/Rome_Paper.pdf).
* [5] S.Berglund _et al._, _The ATLAS Tile Calorimeter Digitizer_, open-2002-056, 29 October 1999.
* [6][http://www.cern.ch/TTC/intro.html](http://www.cern.ch/TTC/intro.html).