[MISSING_PAGE_EMPTY:1]

## 1 Introduction

A performant reconstruction of charged particle tracks inside dense hadronic environments is critical for a wide variety of analyses with the ATLAS detector. Charged particle reconstruction inside jets is used to improve the jet energy and mass resolutions [1; 2] as well as determine the systematic uncertainty on the bias of the measured jet energy and substructure observables [3; 4]. Tracks are also used to differentiate quark jets from gluon jets [5; 6], boson jets from generic quark and gluon jets [7; 8], electrically positive from negative (or neutral) [9; 10], and light jets from bottom and charm quark jets [11; 12; 13]. Hadronically decaying tau lepton reconstruction also relies heavily on track reconstruction inside a high density environment [14; 15]. All of these topologies are a significant challenge to the pattern recognition because energy deposits (_hits_) in the ATLAS silicon detectors can become too close to be individually resolved. This note presents studies of both the losses in charged particle reconstruction efficiency as well as increases in the rate of tracks built from hits resulting from multiple charged particles (_fake_) in these dense environments.

In order to mitigate the degradation in charged particle reconstruction performance inside dense environments, a neural network acts on clusters of hits (_clusters_) in the pixel detector to identify merged clusters. This procedure significantly improves the track reconstruction efficiency inside jets and hadronically decaying tau leptons [16]. Early studies comparing hits on successive layers indicated that the neural network algorithm is well-modelled by simulations of the ATLAS detector [17]. A measurement of the efficiency using the measured pixel cluster charge distribution was first performed using the 2015 dataset [18; 19]. This note presents a further measurement of the efficiency using the full 2016 dataset using two additional methods: one based on the ratio of the track to calorimeter energy [20] and a second measurement that exploits the asymmetry of the pitch of the pixels. In addition to the efficiency measurements, a first upper limit of the rate of fake tracks inside the core of jets is presented, along with systematic uncertainties. This suite of measurements provides an updated and expanded set of constraints on charged particle reconstruction inside dense hadronic environments.

This note is organised as follows. After a brief overview of the ATLAS detector in Section 2, Section 3 presents the data and Monte Carlo (MC) simulation samples used for these studies, Section 4 describes the efficiency measurements and Section 5 documents the fake rate measurement. The note ends with a brief conclusion in Section 6.

## 2 ATLAS detector and object reconstruction

The ATLAS detector is a multi-purpose particle detector [21] with nearly \(4\pi\) coverage in solid angle.1 The tracks of charged particles are measured in a 2 T axial field generated by a solenoid magnet which surrounds the inner detector (ID) consisting of silicon pixels, silicon micro-strips tracker (SCT), and a transition radiation tracking detector (TRT). One significant upgrade for the \(\sqrt{s}=13\) TeV running period is the presence of the insertable B-layer (IBL) [22], an additional pixel layer close to the interaction point.

This innermost layer is composed of more radiation hard technology, in order to cope with the higher dose delivered closer to the interaction point.

Charged-particle tracks are reconstructed using all three ID subsystems with a full coverage in \(\phi\), \(|\eta|<2.5\) and \(p_{\mathrm{T}}>400\) MeV. Tracks are reconstructed using a fit with five parameters: the transverse (\(d_{0}\)) and longitudinal (\(z_{0}\)) impact parameters, \(\phi\), \(\theta\), and \(Q/p\), where \(Q\) is the charge and \(p\) is the track momentum. To suppress the impact of multiple overlapping \(pp\) collisions (pileup), tracks are required to originate from the primary collision vertex (PV), which is defined as the vertex with the largest \(\sum p_{\mathrm{T}}^{2}\) computed from its associated tracks. A series of additional criteria improves the quality of the selected tracks [23]. The Loose track selection corresponds to the default track requirements applied during 'inside-out' track reconstruction [24] and aims to obtain highly efficient charged particle reconstruction (\(\sim\)90% for pion tracks with \(p_{\mathrm{T}}\geq 5\) GeV) at the cost of a non-negligible fraction of fake tracks. The Tight Primary quality criteria are designed and optimized for selecting primary tracks and rejecting fake tracks at the cost of a reduced track reconstruction efficiency (\(\sim\)85% for pion tracks with \(p_{\mathrm{T}}\geq 5\) GeV).

Jets are clustered [25] using the anti-\(k_{t}\) jet algorithm [26] with radius parameter \(R=0.4\). Topological calorimeter-cell clusters [27] are used as inputs. An overall jet calibration corrects the detector-level jet to the particle-level jet [3]. Jets are required to have \(|\eta|<2.5\), and tracks are matched to jets using the ghost-association technique [28].

## 3 Data set and simulated event samples

The data used in this analysis were collected during 2016 with a peak instantaneous luminosity of \(L=1.4\times~{}10^{34}\) cm\({}^{-2}\)s\({}^{-1}\). The average number of \(pp\) interactions per bunch crossing in the dataset is 24. After the application of beam, detector and data-quality requirements, the integrated luminosity considered corresponds to 32.9 fb\({}^{-1}\). The uncertainty in the 2016 integrated luminosity is 3.4%. It is derived, following a methodology similar to that detailed in Reference [29], from a preliminary calibration of the luminosity scale using \(x\)-\(y\) beam-separation scans performed in August 2015 and May 2016.

The data are compared to a leading-order dijet MC sample generated with Pythia 8.186 [30] with the A14 tuned parameter set [31] and the NNPDF2.3LO parton distribution function (PDF) set [32]. MC samples generated with Herwig++ 2.7.1 [33], and Sherpa 2.1 [34; 35; 36] are also studied. For Herwig++, the UE-EE5 [37] tuned parameter set is used with the CTEQ6L1 PDF set [38] and for Sherpa parameters corresponding to the CT10 PDF set [39] are used. The ATLAS detector response is simulated [40] using the Geant 4 framework [41], with a configuration equivalent to the 2015 detector conditions. The expected contribution from additional proton-proton interactions in each bunch crossing is accounted for by overlaying minimum-bias events simulated with Pythia 8, at a rate corresponding to the 2015 running conditions.

## 4 Efficiency

The performance of charged track reconstruction can be quantified by four metrics: the reconstruction efficiency, the fake rate, and the defining parameter biases and resolutions. The reconstruction efficiency is the probability for a charged particle to be reconstructed as a track while the fake rate is the probability that the majority of hits used for a reconstructed track are not from any single charged particle. Section 5investigates the fake rate inside dense environments in detail. The track parameter biases and resolutions are not studied in this note.

There are two contributions to an inefficiency in the track reconstruction. First, multiple scattering and other effects related to material interactions, the readout chips and the silicon sensors can distort tracks such that they do not pass the selection. Lower \(p_{\mathrm{T}}\) particles are more susceptible to multiple scattering and this is a bigger effect at higher \(|\eta|\) where charged particles must traverse more material in the inner detector. This effect is relevant for all tracks, regardless of what activity is nearby, and defined as the _inclusive_ charged particle reconstruction inefficiency.

A second contribution to the track reconstruction inefficiency, and the focus of this section, is due to a high local density of charged particles. When charged particle trajectories are close enough in space, the hits they leave can result in a single reconstructed, a merged, cluster. Clusters that are shared by too many tracks, and tracks that share too many clusters, are generally a sign of fake tracks and are therefore not allowed. However, inside energetic jets, or the decays of energetic \(\tau\) leptons, the probability to have very nearby charged particles is high, resulting in tracks that share clusters (_shared clusters_) and a resulting inefficiency.

Figure 1 shows the track reconstruction efficiency inside jets as a function of the jet \(p_{\mathrm{T}}\). There is no unique way to define the track reconstruction efficiency; in Figure 1, it is the ratio of the number of tracks inside jets that are matched to truth charged particles to the number of charged particles inside the matched particle-level jet2. Matching between tracks and truth charged particles is based on associating pixels, strips, and tubes that contributed to the track fit that also had energy deposited by the particle in simulation (from Geant4). Outside of the jet core where the charged-particle density is relatively low, the efficiency is above 90% and largely independent of jet \(p_{\mathrm{T}}\). In contrast, in the jet core, the efficiency can be much lower than 90% and strongly depends on jet \(p_{\mathrm{T}}\) as the density increases.

Footnote 2: Particle-level jets are clustered using the same algorithm as detector-level jets, using all detector-stable (\(c\tau>30\) ps) charged particles except for muons and neutrinos.

For context, in a jet with \(p_{\mathrm{T}}=500\) GeV, charged particles with \(p_{\mathrm{T}}>10\) GeV have a 40% chance of having no other charged particle with \(\Delta R<0.015\) (angular size of a pixel in the innermost pixel layer) while the same charged particles inside a jet with \(p_{\mathrm{T}}=2\) TeV have only a 20% chance. In addition, these charged particles inside a jet with \(p_{\mathrm{T}}=500\) GeV have a negligible chance of being within \(\Delta R=0.015\) of 8 or more particles while this jumps to 10% at 2 TeV in jet \(p_{\mathrm{T}}\). Similar trends hold for \(\Delta R(\mathrm{track},\mathrm{jet})\); in particular, the number of charged particles nearby a given charged particle is much higher when the \(\Delta R\) to the jet axis is small.

The next sections describe methods to study the ability of simulations to model this inefficiency.

### \(\boldsymbol{r_{\mathrm{track}}}\) and \(\boldsymbol{\zeta}\) methods

This section presents two methods for validating the efficiency measurements presented in References [18; 19]. The first method uses the observation that at particle-level, the ratio of the charged to neutral energy inside a jet is independent of \(p_{\mathrm{T}}\). If jets were composed only of pions, at particle-level, the charged-to-total energy fraction would be \(2/3\) due to isospin. In practice, the ratio is slightly lower due to QED radiation and hadronic resonances with equal numbers of charged and neutral states (e.g. kaons). The left plot of Figure 2 shows the average charge to total energy ratio (\(r_{\mathrm{track}}\)) measured inside jets, as a function of jet \(p_{\mathrm{T}}\). The charged energy is measured by the sum of the \(p_{\mathrm{T}}\) of tracks inside the jet at detector-level and by the sum of the charged particle \(p_{\rm T}\) at particle-level. As expected, the particle-level average is just below \(2/3\) and is independent of jet \(p_{\rm T}\). In contrast, the detector-level version significantly decreases with \(p_{\rm T}\) due to the loss of efficiency in the core of jets due to pixel cluster merging.

The right plot of Figure 2 allows a direct comparison of the \(p_{\rm T}\) dependence between the 2016 data and simulation by normalising the values to unity in the first \(p_{\rm T}\) bin. There is approximately a 20% degradation between 500 and 2500 GeV in jet \(p_{\rm T}\), which is slightly worse in data, consistent with the results presented in the previous section as higher \(p_{\rm T}\) tracks also tend to be near the center of the jet. For reference, the \(p_{\rm T}\)-weighted track reconstruction efficiency is also plotted:

\[p_{\rm T}\]

-weighted track reconstruction efficiency \[=\frac{\sum_{i}p_{\rm T,i}\delta(\text{charged particle $i$ is reconstructed as a track})}{\sum_{i}p_{\rm T,i}}\] (1)

The average charged ratio in simulation is not exactly the same as this weighted efficiency because of the contribution from momentum resolution effects, which introduce a slight bias in the track \(p_{\rm T}\) to higher values. Beyond about 1.5 TeV in the jet \(p_{\rm T}\), this corresponds to a \(\lesssim 5\%\) difference between the normalised \(r_{\rm track}\) and the \(p_{\rm T}\)-weighted track reconstruction efficiency. In the same jet \(p_{\rm T}\) range, the inefficiency itself is between 10 and 20%. The contribution from fake tracks (see Section 5) is negligible.

A second method for measuring the efficiency exploits the asymmetry in the pixel dimensions. In the (innermost) pixel layer, the most common pitch in the direction transverse to the beam is 50 \(\mu\)m while it is 400 (250) \(\mu\)m in the direction parallel to the beam. As a result, clusters from pairs of tracks that are a fixed distance apart are more likely to be merged if separated in the long direction compared to the short direction. The quantity \(\zeta\) is defined as \(\zeta=|\text{tan}^{-1}(\Delta\phi/\Delta\eta)|\), where \(\Delta\phi\) and \(\Delta\eta\) are the distances between pairs of tracks. The radiation pattern inside a jet is approximately symmetric about the jet axis

Figure 1: The track reconstruction efficiency inside jets (see text for details) as a function of jet \(p_{\rm T}\). The black solid line is the efficiency for charged particles with \(p_{\rm T}>10\) GeV outside of the jet core while the red dashed line is for charged particles inside the core (\(\Delta R<0.02\)).

and so at particle-level, \(\zeta\) follows a uniform distribution between 0 and \(\pi/2\). Inside the core of a dense jet, the distribution of \(\zeta\) will be higher at \(\pi/2\) and lower at 0 due to lost pairs of tracks that are too close together. The construction of \(\zeta\) is illustrated in Figure 3. To enhance the non-uniformity in \(\zeta\), only tracks with \(p_{\mathrm{T}}>10\) GeV and \(\Delta R\leq 0.02\) to the jet axis are considered. Tracks with \(\Delta R>0.1\) are also used for reference.

The distributions of \(\zeta\) in two representative \(p_{\mathrm{T}}\) bins are shown in Figure 4 for pairs of tracks inside and

Figure 3: A schematic diagram of a jet core in \(\eta\)-\(\phi\) coordinates. The \(\zeta\) angle is defined by \(|\mathrm{atan}(\Delta\phi/\Delta\eta)|\).

Figure 2: Left: the distribution of the average ratio of the sum of the track or charged-particle \(p_{\mathrm{T}}\) in the jet to the calorimeter or all-particles \(p_{\mathrm{T}}\) in the same jet as a function of the reconstructed jet \(p_{\mathrm{T}}\). Right: the jet track-to-calorimeter \(p_{\mathrm{T}}\) ratio as a function of \(p_{\mathrm{T}}\) normalised to one at 500 GeV. Also plotted are the \(p_{\mathrm{T}}\)-weighted track reconstruction efficiency and the track-to-calorimeter \(p_{\mathrm{T}}\) ratio with the track momentum resolution removed (but the inefficiency is preserved). The resolution is removed by replacing the momentum of tracks matched to truth particles with the \(p_{\mathrm{T}}\) of the truth particles.

outside of the jet core. As expected, the distribution is uniform for pairs of tracks outside the jet core. For tracks inside the jet core, there is a significant slope that increases with jet \(p_{\mathrm{T}}\) and is slightly higher for data than simulation. This indicates that there is a larger inefficiency due to cluster merging in data relative to the MC.

Figure 5 summarises the \(p_{\mathrm{T}}\) evolution of the \(\zeta\) distribution. The left plot of Figure 5 shows the fitted slope of the \(\zeta\) distribution (using a linear fit). Outside the jet core (\(\Delta R>0.1\)), the distribution is nearly uniform so the slope, \(\partial N/\partial\zeta\) is nearly zero. Inside the jet core, the slope is significantly non-zero and increases with jet \(p_{\mathrm{T}}\). The \(p_{\mathrm{T}}\) dependence of \(\partial N/\partial\zeta\) is similar in data and simulation, though there is a clear offset, which means that the cluster merging and/or the incorrect assignment of clusters to tracks starts happening in data before it happens in simulation. In the limit of no cluster merging, \(\partial N/\partial\zeta\to 0\).

Since the inefficiency =1-efficiency inside jets from cluster merging is a relatively small effect (\(\lesssim 10\%\)), it is sensible to hypothesise that \(\partial N/\partial\zeta\to 0\) can be well-approximated by linear function for \(p_{\mathrm{T}}\lesssim 2.5\) TeV. In order to show the validity of this conjecture, the right plot of Figure 5 shows \(\partial N/\partial\zeta\) normalized to unity at 500 GeV in jet \(p_{\mathrm{T}}\). Even though \(\partial N/\partial\zeta\) is higher in data than in MC, the \(p_{\mathrm{T}}\) dependence is higher for MC, though this is convoluted with the offset discussed above. For comparison, the inefficiency inside the jet core computed in simulation using truth information directly is also shown in the right plot of Figure 5. Since \(\partial N/\partial\zeta\) is not sensitive to the inclusive charged particle reconstruction inefficiency, the inefficiency measured outside the jet core is subtracted when computing the inefficiency only due to charged particle density effects (labeled 'CTIDE'). In particular,

\[\mathrm{CTIDE~{}efficiency}=\epsilon_{|\Delta R|<0.02}-\epsilon_{|\Delta R|>0.1}, \tag{2}\]

where \(\epsilon\) is the probability for a truth particle to be matched to a track with \(p_{\mathrm{T}}>10\) GeV. While there is a clear difference between the direct and \(\partial N/\partial\zeta\) results in simulation, the \(p_{\mathrm{T}}\) dependence is similar, suggesting that there is nearly a linear relationship between \(\partial N/\partial\zeta\) and the inefficiency inside jets.

## 5 Fake rate

This section presents a first measurement of the rate of fake tracks inside the core of jets. First, a MC simulation-based study aiming to understand the origin of the fakes tracks is presented in Section 5.1. Second, the method used to measure the fraction of fake tracks in the core of the jet is described in Section 5.2, as well as the results and the final uncertainties in Section 5.3.

The track and jet pre-selections are performed as follows. All selected tracks should have \(|\eta|<2.5\) and \(p_{\mathrm{T}}>500\) MeV and satisfy the Loose operating point [23]. Only the tracks inside the leading jet are further used, and this selection is ensured by applying a minimum \(\Delta R\) requirement of 0.4 between the leading jet and the track. The leading jet must be central (\(|\eta|<2.5\)) and have a transverse momentum (\(p_{\mathrm{T}}^{\mathrm{jet}}\)) inside the [400, 580] GeV interval. This requirement ensures the selection of same type of di-jet events both in data and MC simulation3. The lower \(p_{\mathrm{T}}^{\mathrm{jet}}\) cut is driven by the trigger choice, while the upper bound is needed because of the skimming applied to obtain the samples used for this study.

Footnote 3: The MC sample is a di-jet sample obtained with a filter of \(400<p_{\mathrm{T}}^{\mathrm{jet}}<800\) GeV.

### Origin of the fake tracks

Fake tracks are usually defined as reconstructed tracks that do not have a majority of their hits associated with a single charged particle. If not in a high density environment, the fake tracks are mostly due to

Figure 5: Left: The \(p_{\rm T}\) dependence of the slope of the \(\zeta\) distribution: \(\partial N/\partial\zeta\) inside (\(\Delta R<0.02\)) and outside (\(\Delta R>0.1\)) of the jet core in data and simulation. Right: \(\partial N/\partial\zeta\) normalised to unity in the first \(p_{\rm T}\) bin for data and simulation inside jets as well as the charged particle reconstruction inefficiency inside jets, computed directly with truth information and also normalised in the first bin. In order to make the comparison fair, the inclusive charged particle reconstruction inefficiency is removed from the charged particle reconstruction inefficiency inside jets.

random combinations of hits, and their multiplicity increases with pileup. However, in the jet core the rate of fake tracks due to associating wrong hits from nearby high \(p_{\mathrm{T}}\) charged particles inside the core of jets is significant. Indeed, the origin of the fake tracks in the core of a jet is a mixture of randomly overlapping tracks (such as from pileup) and nearly collinear tracks in the jet core. As can be seen in Figure 6 (left) the rate of fake tracks increases from 0.9% to 1.1% when \(\left\langle\mu\right\rangle\) goes from 0 to 40 and \(\Delta R\left(\mathrm{track,jet}\right)<0.4\); when tightening the \(\Delta R\left(\mathrm{track,jet}\right)\) selection a similar trend is observed. The rate of fake tracks goes from 0.2% up to 1% when looking at its distribution versus the number of tracks forming the jet (Figure 6, right), for a \(\Delta R\left(\mathrm{track,jet}\right)<0.4\) selection. When going even more in the jet core (after applying a \(\Delta R\left(\mathrm{track,jet}\right)<0.2\) selection) the rate of fake tracks increases significantly, up to 1.4%, showing that the close-by-tracks merging processes dominate in this region.

In MC simulation, the fraction of real or fake tracks is evaluated using a hit-based track-to-truth particle association to match reconstructed tracks to primary particles [42]. Each of the clusters is associated to the truth particle which has the largest energy deposition in the MC simulation. The clusters are then weighted according to their importance in the track reconstruction: if the clusters are from the pixel detector including IBL, the weight is set to 10 for each cluster. If they are from the SCT, the weight is set to 5 and if they are from the TRT, the weight is set to 1. A weighted matching probability \(\mathrm{P_{match}}\) can be defined using the ratio of the number of hits which are common to a given track and the corresponding truth particle (\(\mathrm{N^{common}_{Pixel;SCT;TRT}}\)) and the number of hits which form the track (\(\mathrm{N^{track}_{Pixel;SCT;TRT}}\)) [23]:

\[\mathrm{P_{match}}=\frac{10\times\mathrm{N^{common}_{Pixel}}+5\times\mathrm{ N^{common}_{SCT}}+1\times\mathrm{N^{common}_{TRT}}}{10\times\mathrm{N^{track}_{Pixel}}+5\times\mathrm{N^{track}_{ SCT}}+1\times\mathrm{N^{track}_{TRT}}} \tag{3}\]

The hit-matching technique is robust since it exploits the relation between tracks and truth particles at the Geant 4 energy deposition level and is mostly independent of the detector resolutions. If the \(\mathrm{P_{match}}\) exceeds 50%, the track associated to that particle is classified as real otherwise as fake.

Figure 6: Left: the rate of fake tracks in the jet core as a function of the average number of interactions per bunch crossing, \(\left\langle\mu\right\rangle\). Right: the rate of fake tracks in the jet core as a function of number of tracks forming the jet. Distributions obtained in MC simulation for several \(\Delta R\)(jet, tracks) intervals, where the leading jet fulfils the \(400<p_{\mathrm{T}}^{\mathrm{jet}}<580\)\(\mathrm{GeV}\) condition. Only the statistical uncertainties are shown.

With such a characterization, reconstructed track parameters (momentum, impact parameter) for real tracks are typically consistent with the associated truth particle trajectory within the uncertainties determined by the track fitting procedure, while for fake tracks, these parameters differ significantly; for such tracks, the actual resolution of the impact parameter or the polar angle is about three worse than what would be expected from the track fit uncertainties, while the reconstructed transverse momentum is in average larger by about nine standard deviations than the associated truth particle \(p_{\mathrm{T}}\). This illustrates that fake tracks tend to combine hits from different origins.

### The control region method

To estimate the rate of fake tracks in real data, a fit is performed in a control region (CR) enriched in fake tracks. To optimize the CR, dedicated studies using MC simulation are performed to identify variables able to discriminate the fake tracks among the selected ones. As a result of the optimization, the fake tracks enriched CR is defined with the following variables and requirements:

* Track transverse impact parameter, \(d_{0}\). This variable is found to remove a large fraction of real tracks if required to be higher than 0.1 mm (as shown later in Table 1).
* \(\sin\theta\times|z_{0}^{PV}|\), where \(z_{0}^{PV}\) is the track longitudinal impact parameter computed with respect to the PV. This variable is required to be above 0.2 mm because the real tracks are predominant in the \(\sin\theta\times|z_{0}^{PV}|<0.2\) mm region.
* Track \(\chi^{2}/\)DOF, where DOF stands for the number of degrees of freedom. This distribution is very sensitive to the amount of fake tracks, since mis-associated hits affect the quality of the track fit. It is required to be greater than 1.4.
* Number of SCT hits (\(n_{\mathrm{SCT}}\)). It can be at most 7, since the fake tracks are shorter.
* Number of TRT hits (\(n_{\mathrm{TRT}}\)). It cannot have values above 35.

Variables like the track \(\eta\) or track \(p_{\mathrm{T}}\) are known to be very discriminant between fake and real tracks. However, in order to reduce the physics dependence of this study, these variables are not used to define the CR.

The distribution of the truth-reco track matching probability after the pre-selection and after each requirement used to define the CR is shown in Figure 7. Just after the pre-selection the sample is clearly dominated by real tracks (black dots), while the CR is significantly enriched in fake tracks (light blue diamonds). The obtained CR has the ratio between fake and real tracks around 40%. The statistics in data as well as the (similar) selection efficiencies in data and MC simulation for each CR criterion are shown in Table 1. The efficiencies in data and MC agree reasonably well.

Figure 8 left and right show the leading jet transverse momentum and the selected tracks pT distribution in the CR. Figures 9 and 10 show the distributions of the variables used to define the CR. Generally, a good agreement is observed between data and MC simulation for all distributions obtained just after the pre-selection and in the CR. This demonstrates that the MC simulation models well the data in the CR, which represents a small corner of the track phase space (0.99% according to data). In Figures 9 and 10, the MC distributions are also plotted separately for real and fake tracks, demonstrating the discrimination power of the selected variables. These results give confidence in relying on the MC distributions in the CR to fit the fraction of real and fake tracks.

### Results

The fraction of fake and real tracks are fitted to the data histograms in the CR through a standard likelihood fit using Poisson statistics, as implemented in the TFractionFitter function of ROOT[43]. Figure 11 (left) presents the results after fitting the distribution of the track \(\chi^{2}/\)DOF variable; the fit results match very well the observed data in the CR. Alternative estimates of the fraction of fake tracks are obtained by fitting instead the distributions of the track \(d_{0}\) or the number of TRT hits (inclusively or after requiring \(|\eta|<2.0\)). The discriminating power of these different variables to distinguish fake from real tracks is further illustrated in Figure 11, right, which quantifies the compatibility of the MC simulation to data (with a \(\chi^{2}\) test) when varying arbitrarily the fraction of fake tracks in MC simulation from 0 to 100%. The obtained results are shown in Table 2. The fitted fraction of fake tracks (further denoted with \(f_{\rm CR}^{\rm fakeTrk}\)) is found to vary between 20% and 29%, depending on the variable used for the fit. The mean value is \(0.24\pm 0.04\).

\begin{table}
\begin{tabular}{c|c|c|c c} \hline \hline  & N\({}^{\rm data}_{\rm tracks}\) & \(\frac{F_{trk}}{R_{trk}}\) [\%] & \(\varepsilon\) data [\%] & \(\varepsilon\) MC [\%] \\ \hline \hline pre-selection & 13061068 & 0.7 & - & - \\ \(+|d_{0}|>0.1\) & 2418009 & 3.7 & 18.5 & 16.5 \\ \(+\sin\theta\times|z_{PV}^{0}|>0.2\) & 1166999 & 5.1 & 48.3 & 47.9 \\ + track \(\chi^{2}/\)DOF \(\geq 1.4\) & 447776 & 13.0 & 38.4 & 35.9 \\ \(+n_{\rm SCT}<8\) & 140819 & 36.6 & 31.4 & 29.9 \\ + \(n_{\rm TRT}<36\) (final CR) & 130175 & 40.6 & 92.4 & 90.9 \\ \hline \hline \end{tabular}
\end{table}
Table 1: Number of tracks in data (N\({}^{\rm data}_{\rm tracks}\)), ratio between the number of fake and real tracks (\(\frac{F_{trk}}{R_{trk}}\)) and the selection efficiency of each criterion (\(\varepsilon\)) in data and MC simulation.

Figure 7: The distribution of the truth-reco track matching probability after the pre-selection (black dots), and after each requirement used to define the CR enriched in fake tracks (coloured markers). Distribution obtained in MC simulation. Only the statistical uncertainties are shown.

These results are cross-checked by studying the \(\chi^{2}\) computed between the data and MC histograms. The fraction of fake tracks in MC is "manually" modified from 0 to 1 and the \(\chi^{2}\) between the data and MC histograms is simultaneously computed. The resulting values of \(\chi^{2}/\)DOF as a function of the fraction of fake tracks is shown in Figure 11, right. The minima are in good agreement with the ones obtained with TFractionFitter (and shown with colored dots on Figure 11, right).

Finally, the fitted fraction of fake tracks in data is compared to the fraction of fake tracks in the MC simulation. In the CR, 29% of tracks are fake in the MC simulation, which agrees with the fitted fraction within 30%. However, this number is subject to potential mis-modelling of the variables used to define the CR. Indeed, the CR selects only a small fraction of all tracks. Therefore, the final result is presented by extrapolating the fraction of fake tracks to the pre-selection sample. This is done by assuming that the CR acceptance for fake tracks is the same in data and MC (and about 32% according to MC simulation). The fraction of fake tracks in data, in the pre-selection sample, can be computed with the following formula :

\[\frac{1}{32\%}\times(f_{\rm CR}^{\rm fakeTrk}\times N_{\rm tracks,CR}^{\rm data })/N_{\rm tracks,pre-selection}^{\rm data} \tag{4}\]

\begin{table}
\begin{tabular}{c|c} \hline \hline Selected variable & \(f_{\rm CR}^{\rm fakeTrk}\) [\%] \\ \hline \hline \(\chi^{2}/\)DOF & 22 \(\pm\) 1 \\ \(n_{\rm TRT}\) & 29 \(\pm\) 1 \\ \(n_{\rm TRT}\), track \(|\eta|<2\) & 21 \(\pm\) 1 \\ track \(d_{0}\) & 20 \(\pm\) 1 \\ \hline \hline \end{tabular}
\end{table}
Table 2: Fraction of fake tracks (\(f_{\rm CR}^{\rm fakeTrk}\)), and the associated statistical uncertainty obtained, after fitting the selected distributions.

Figure 8: Left: the distributions of the leading jet transverse momentum in the \(400<p_{\rm T}^{\rm jet}<580\) interval (used to define the CR enriched in fake tracks) after the pre-selection, in data (black dots) and MC simulation (green up-triangles). Right: selected track \(p_{\rm T}\) in the defined CR, in data and MC simulation. Distributions of the \(p_{\rm T}\) of the real (blue down-triangles) and fake (magenta squares) tracks are shown separately. Last bin includes overflow. Hashed magenta area in the lower pad stands for the MC statistical uncertainty.

where \(N_{\text{tracks,CR}}^{\text{data}}\) and \(N_{\text{tracks,pre-selection}}^{\text{data}}\) stand for the number of tracks in data, in the CR and at pre-selection level, respectively; the exact values can be taken from Table 1. The fraction of fake tracks in data is found to vary between 0.62% and 0.90% depending on the \(f_{\text{CR}}^{\text{fakeTrk}}\) variable, while in MC simulations it is 0.69%. Given this set of results, the difference between the fraction of fake tracks in data and in MC is below 30%.

The agreement between data and MC results is studied also in two \(\langle\mu\rangle\) bins, and the difference is found to be below 20%. For completeness, it is also checked how the conclusions change when loosening the requirements on the \(d_{0}\) and \(\sin\theta\times|z_{0}^{PV}|\) parameters, in order to design a region dominated with sources of fake tracks closer to the real analyses. The obtained results are showing a maximum difference between

Figure 9: The distributions of the track transverse impact parameter, \(d_{0}\) (top-left), sinus of the theta angle multiplied with the track longitudinal impact parameter computed with respect to the PV (top-right), and the track \(\chi^{2}/\text{DOF}\) parameter (bottom) in the defined CR, in data (black dots) and MC simulation (green up-triangles). Distributions for the real (blue down-triangles) and fake (magenta squares) tracks are shown separately. Last bin includes overflow. Hashed magenta area in the lower pad stands for the MC statistical uncertainty.

the fraction of fake tracks in data and in MC, after the pre-selection, of 20-27%. Finally, same conclusions are reached also when the track-to-truth particle association probability used to classify a track as real or fake in MC simulations is varied between 30% and 60%.

Figure 11: Left: the good performance of the fit (red line) in the CR enriched in fake tracks. Data (back dots), MC real tracks (blue down-triangles) and MC fake tracks (magenta squares) distributions are also shown. Last bin includes overflow. Only the statistical uncertainties are considered. Right: data&MC simulation \(\chi^{2}/\)DOF when varying the fraction of fake tracks in the CR (see text for details). For completeness, the fit results (MLE of fraction of fake tracks) are also shown with colored dots.

Figure 10: The distributions of the number of SCT hits (left) and number of TRT hits (right) in the defined CR, in data (black dots) and MC simulation (green up-triangles). Distributions for the real (blue down-triangles) and fake (magenta squares) tracks are shown separately. Last bin includes overflow. Hashed magenta area in the lower pad stands for the MC statistical uncertainty.

With the method discussed here, the difference between the fraction of fake tracks in data and in MC is found to be at most 27%. These results motivate a conservative uncertainty of 27% on the rate of reconstructing the fake tracks in dense environments which is assumed to be independent of track \(p_{\mathrm{T}}\), \(|\eta|\), and \(\Delta R(\mathrm{jet},\mathrm{track})\). This number is consistent with the uncertainty on the fake-rate derived for inclusive tracks [23].

## 6 Conclusion

This note describes new methods to determine the charged particle reconstruction efficiency and fake rate in dense environments, as well as studies of the ATLAS data recorded in 2016. The \(r_{\mathrm{track}}\) and \(\zeta\) methods are used to measure the track reconstruction inefficiency. They exploit the independence of the calorimeter and tracker energy measurements and the asymmetry in the pixel geometry, respectively. The relationship between \(\zeta\) (\(r_{\mathrm{track}}\)) and the (\(p_{\mathrm{T}}\)-weighted) track reconstruction efficiency shows how to compare these methods to other procedures. Generally there is a slightly lower efficiency in data than in simulation.

A new method to determine the rate of fake tracks in data is also presented. A control region is defined by inverting track quality requirements, leading to enhanced fake rates. The fraction of fake tracks in this control region is determined in data by a template fit, using real and fake track templates derived from MC simulation. It is found to be between 20-29%, depending on the distribution being fitted. This fraction is further extrapolated outside the control region using the control region acceptance (\(\sim 32\%\)) determined in MC simulation. The fraction of fake tracks in the full data sample, after the pre-selection, is found to be between 0.62 and 0.9%, while in MC simulations it is 0.77%. A conservative uncertainty of 27%, accounting for the differences between data and MC simulations results, is assigned based on the spread of fitted values and the impact of varying the control region definition.

## References

* [1] ATLAS Collaboration, _Jet global sequential corrections with the ATLAS detector in proton-proton collisions at sqrt(s) = 8 TeV_, ATLAS-CONF-2015-002 (2015), url: [https://cds.cern.ch/record/2001682](https://cds.cern.ch/record/2001682).
* [2] ATLAS Collaboration, _Jet mass reconstruction with the ATLAS Detector in early Run 2 data_, ATLAS-CONF-2016-035 (2016), url: [https://cds.cern.ch/record/2200211](https://cds.cern.ch/record/2200211).
* [3] ATLAS Collaboration, _Jet energy measurement and its systematic uncertainty in proton-proton collisions at \(\sqrt{s}=7\) TeV with the ATLAS detector_, Eur. Phys. J. **C75** (2015) 17, arXiv: 1406.0076 [hep-ex].
* [4] ATLAS Collaboration, _Identification of boosted, hadronically decaying W bosons and comparisons with ATLAS data taken at \(\sqrt{s}=8\) TeV_, Eur. Phys. J. **C76** (2016) 154, arXiv: 1510.05821 [hep-ex].
* [5] ATLAS Collaboration, _Discrimination of Light Quark and Gluon Jets in pp collisions at \(\sqrt{s}=8\) TeV with the ATLAS Detector_, ATLAS-CONF-2016-034 (2016), url: [https://cds.cern.ch/record/2200202](https://cds.cern.ch/record/2200202).