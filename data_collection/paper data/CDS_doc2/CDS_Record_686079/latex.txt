###### Abstract

This note summarizes a study of the simulation of the effect of pile-up on the measurement of the energy in the Liquid Argon calorimeter both for a single electromagnetic cell and for a electromagnetic (e.m.) cluster. This study is performed in order to understand whether the contribution from pile-up could be extracted from the multiple samples of the pulse shape; particular attention is given to high energy tails induced by the pile-up.

Position of the problem

We try to estimate the contribution from pile-up and electronics noise on the energy measurement with the LAr calorimeter, in the context of the ATLAS readout. The chain from the calorimeter to Level 2, can be summarized naively by:

Signal \(\rightarrow\) preamp \(\rightarrow\) Shaper \(\rightarrow\) pipeline \(\rightarrow\) filter \(\rightarrow\) LV 2

. The study of what could be done in the _filter_ is the subject of [8].

To build a solution to this problem, we need to know:

* the luminosity: we consider three luminosities: \(0.5\times 10^{33}\), \(1\times 10^{34}\) and \(2.5\times 10^{34}\)\(cm^{-2}s^{-1}\); for a total inelastic _pp_ cross-section of 70 \(mb\)[1], this means that there are in average 1, 20 and 50 events superimposed per bunch crossing respectively. In the following we call low, nominal and high, these three luminosities.
* the bunch-crossing frequency: 25 \(ns\).
* the MB events: we have studied different ways of generating the pile-up ; the results do not depend too much on the model.
* the calorimeter segmentation: we have considered the energy coming from pile-up inside one electromagnetic (e.m.) cell (\(\Delta\eta\times\Delta\phi=0.025\times 0.025\)) and inside an e.m. cluster, a \(nonet\)\(3\times 3\) cells: \(\Delta\eta\times\Delta\phi=0.075\times 0.075\), over the 3 samplings (i.e. summing 3 and 27 cells respectively).
* the shaping function: it is plotted on Fig. 1; it corresponds to \(t_{max}=45\)\(ns\) (time when the response of the shaper to a triangular current is maximum) and to \(t_{dr;\#}=441\)\(ns\) (the drift time in a LAr gap of 1.9 \(mm\) with drift velocity of 4.3 \(10^{-6}m/ns\)).
* the electronic noise: we use a gaussian noise with \(\sigma=40\)\(MeV\) (for one e.m. cell in the barrel); details about this number are given in section 3. This is the noise in term of transverse energy; it is constant all across the barrel
* the local calorimeter energy resolution: \(\frac{10\%}{\sqrt{E(GeV)}}\oplus 0.5\%\); for a 50 \(GeV\) photon or electron, the precision is therefore 750 \(MeV\). In the following, numbers will always refer to the transverse energy, except when otherwise specified.

## 2 Minimum bias events

### generator

We have tried to compare different ways to generate minimum-bias events using the PYTHIA Monte-Carlo program. In the study described in [6], it is clearly stated that for PYTHIA 5.5,the multiplicity in the events is too small. In order to understand how sensitive the level of pile-up is to the description of MB events, we have generated:

* minimum-bias events using the PYTHIA datacards from DICE-ATLAS;
* mini-jets with \(p_{t}\geq~{}5~{}GeV/c\).

The processes considered to generate minimum-bias events in PYTHIA are: low \(p_{t}\) scattering and _semi-hard_ QCD 2 \(\rightarrow\) 2 processes. The total cross-section for these processes is 55 \(mb\) in PYTHIA 5.7. The mini-jets are therefore a subsample of the minimum-bias events, as only the _semi-hard_ QCD 2 \(\rightarrow\) 2 part is generated. The mini-jets events are more active, but have a lower cross-section (47 \(mb\) in PYTHIA 5.6); in the ATLAS-TP, \(\sigma_{pp}=70~{}mb\). Using the mini-jet events and \(\sigma_{pp}=70~{}mb\) gives certainly a _pessimistic_ description of the pile-up ; it can nevertheless gives an upper limit on the level of pile-up.

In the analysis that follows, the description of the pile-up will be done with PYTHIA 5.7 and the DICE-ATLAS datacards. We shall refer to the mini-jets, only to give an upper limit.

For completness, the datacards used in PYTHIA and a summary of their meaning are given in Table 1.

In Table 2 are summarized numbers for 2 versions of PYTHIA, 5.6 and 5.7, and for the 2 ways to simulate MB.

In Table 3 are also listed, for comparison, the extrapolations from existing data, taken in [7].

The conclusion of this study is that the multiplicity and the average \(p_{t}\) in minimum-bias events generated with the PYTHIA 5.7 monte-carlo program and the ATLAS datacards are in agreement with the extrapolation from existing data. On Fig 2 are shown the multiplicity distributions for neutral and charged particles. On the same figure, the distributions of multiplicity weighted by \(p_{t}\) are also shown. For all the distributions, there is a plateau up to \(|\,\eta\,|\leq 2.5\). In this study, no detailed detector simulation has been done.

\begin{table}
\begin{tabular}{|c|c||c|c|} \hline \multicolumn{2}{|c||}{MB-ATLAS} & \multicolumn{2}{|c|}{Minijets} \\ \hline \hline MSEL=1 & jet production & MSEL=1 & jet production \\  & \(2\rightarrow\) 2 process & & \(2\rightarrow\) 2 process \\ \hline MSTP(2)=2 & \(2^{nd}\) order running \(\alpha_{s}\) & CKIN(3)=5 & \(\hat{p_{t}}\geq 5~{}GeV\) \\ \hline MSTP(33)=3 & K-factor & CKIN(4)=-1 & no upper limit on \(\hat{p_{t}}\) \\ \hline MSTP(81)=1 & multiple interactions with & & \\ MSTP(82)=4 & varying impact point & & \\ \hline MSTJ(22)=2 & particle decays only if \(\tau\geq 10mm\) & & \\ \hline \end{tabular}
\end{table}
Table 1: _Datacards used to generate pile-up events_.

### results

The number given is this section are obtained by superimposing an average of 20 MB events. We assume that the hadrons deposit all the energy in the e.m. calorimeter. This hypothesis is clearly a weakness of this study. The detailed simulation of the detector response to particles should be performed and the result confronted to this hypothesis. On the other hand, and in particular for the central region, as the average transverse momentum is around \(\simeq 500\ MeV\), the hadrons indeed deposit most of their energy in the e.m. calorimeter.

A study of pile-up, with the DICE detector simulation, has been done recently [9], leading to a narrower pile-up distribution.

The transverse energy spectrum in one e.m. cell, \(\Delta\eta\times\Delta\phi=0.025\times 0.025\), and in a _nonet_ (e.m. cluster), \(\Delta\eta\times\Delta\phi=0.075\times 0.075\) are shown in Fig 3; it is assumed that the energy is contained in the 3 samplings in depth. Both are highly non-gaussian. In order to assess the effect of pile-up we have looked at the probability to have more than \(E_{t}^{min}\) in the considered area; the 2 distributions are also shown on Fig. 3. In Table 4 are summarized, for two areas, the probabilities to get more than 0.250, 0.500 and 1 GeV in the cases of low and nominal luminosities. The probability to get more than 0.5(1) \(GeV\) of transverse energy in a nonet is 7.2(2.4)%, for a pile-up of 20 MB events. We shall see in the following, that the shaping and electronics noise will increase this probability to 19(3.5)%. The effect of the magnetic field has been checked to be negligeable, in the central region. This check has been done rather naively by applying a cut \(p_{t}\geq 420\ MeV\), removing tracks that would not reach the calorimeter.

\begin{table}
\begin{tabular}{|r|c|c|c|c|} \hline  & Charged & Neutral & \(<p_{t}>\) & \(<E_{t}>\) \\ \hline Mini-jets 5.6 & 1.23 & 1.48 & 398 & 44 3 \\ Mini-jets 5.7 & 1.76 & 2.04 & 387 & 434 \\ MB-ATLAS 5.6 & 0.84 & 1.02 & 360 & 407 \\ MB-ATLAS 5.7 & 1.19 & 1.42 & 375 & 420 \\ \hline \end{tabular}
\end{table}
Table 2: \(\frac{dn}{d\eta\cdot d\phi}\) _(charged and neutral) in the region \(|\eta|\leq\ 2.5\) with no cut on momentum; average \(p_{t}\) and \(E_{t}\) in MeV, for neutral and charged together._

### Transverse energy flow

Using the results presented in 2.2, we have built a function _pile-up_ which returns the amount of transverse energy left in an area for an average number of events per crossing. For each crossing, the number of events is chosen according to a Poisson distribution. Then the average numbers of neutral and charged particles are computed according to the aera. The number of charged and neutral particles are then chosen according to a Poisson distribution. For each particle (charged and neutral separatly) the transverse energy is chosen according to the \(E_{t}\) spectrum obtained with PYTHIA. It is assumed that the transverse energy flow is independant of \(\eta\), for \(\mid\eta\mid\leq 2.5\); this is justified by Fig. 2. It is also assumed that the effect of correlation is negligeable.

This _pile-up_ function is used in the rest of the analysis, as an input to study the effect of the electronics.

## 3 Simulation of the shaper

In this section we describe how we have simulated the electronics, the preamplifiers noise and the shaper. This program allows to study the response of a given aera of the calorimeter to incident energy, for a succession of N beam-crossings. The electronic noise is simulated as an impulse every ns, whereas the energy deposit happens every beam-crossing. As the shaping function is spread over \(\simeq\) 20 beam-crossings, the signal measured at a given beam-crossing is the sum of the contribution of the preceeding ones.

### Shaping function

On Fig. 1 one can see the superposition of the 3 functions that will be used in the simulation: the response to a triangular current of the shaping function, its derivative (used to compute weights in the optimal filtering technique) and the derivative of the impulse response(used to

\begin{table}
\begin{tabular}{|l|c|c||c|c|c||c||} \hline  & \multicolumn{2}{|c|}{one event} & \multicolumn{2}{|c|}{20 events} & \multicolumn{2}{|c|}{50 events} \\ \hline \hline  & \(.025\times.025\) & \(.075\times.075\) & \(.025\times.025\) & \(.075\times.075\) & \(.025\times.025\) & \(.075\times.075\) \\ \hline \(P(E_{t}\geq\) 250 \(MeV)\) & \(0.05\) & \(0.5\) & \(1.3\) & \(11.0\) & \(3.2\) & \(25.4\) \\ \hline \(P(E_{t}\geq\) 500 \(MeV)\) & \(0.03\) & \(0.3\) & \(0.8\) & \(7.2\) & \(2.1\) & \(17.6\) \\ \hline \(P(E_{t}\geq\) 1 \(GeV)\) & \(0\) & \(0.01\) & \(0.2\) & \(2.4\) & \(0.7\) & \(6.8\) \\ \hline \end{tabular}
\end{table}
Table 4: _Probability(in %) for the transverse energy deposited in 2 areas (\(\Delta\eta\times\Delta\phi\)) to be above 250, 500 MeV and 1 GeV (before any simulation of the shaper and without any electronics noise). Three luminosity are considered: low, nominal and high luminosity i.e. an average of 1, 20 and 50 events per crossing respectively. The error on \(1\%\) is \(0.03\%\). The effect of the magnetic field has been included._compute the electronics noise as described in Appendix A) as a function of time. The relevant parameters used in this study are summarised here:

* \(t_{max}=45ns\), the time when the response to a triangle is maximum.
* \(t_{drift}=441ns\), the drift time (\(v_{drift}=gap/v_{drift}\), \(v_{drift}=4.3\ 10^{-6}m/ns\) and the gap thickness is \(1.9mm\)).
* \(\Delta t_{BX}=25ns\).

### Electronic Noise

The electronic noise is generated in the following way: every nanosecond, a value of the noise is taken from a gaussian distribution with \(\sigma=0.0129\ GeV.ns^{-0.5}\). (see Appendice A for the details about this value). This value has been chosen to match the EM calorimeter preamps characteristics [1]. Each of these values is convoluted with the derivative of the impulse response and at each BX the responses are added. The resulting noise is shown on Fig.4; it has a gaussian shape with \(\sigma=0.220\ GeV\) which is the expected for a nonet. In the following, when we study the signal in a nonet (\(\Delta\eta\times\Delta\phi=0.075\times 0.075\)), we compute the noise, in terms of transverse energy, \(\sqrt{3\times 9}\times\ 0.042GeV\simeq 0.220\ GeV\) for the 3 samplings. This figure is constant all accross the barrel.

### pile-up

At each bunch crossing, the signal coming from the pile-up is convoluted with the shaping function and the noise is added. On Fig. 4 are plotted the noise and pile-up spectra together with the signal as a function of time (for 1000 bunch crossings). The width of the pile-up distribution, after shaping but without electronics noise, is \(RMS(E_{t})\simeq 400\ MeV\) for a nonet at nominal luminosity; with the electronics noise the width becomes \(460\ MeV\)[8]. The two distributions b) and c) of Fig. 4 are very different: before shaping, the transverse energy distribution is highly non gaussian; the peak at zero contains \(\simeq 85\%\) of the events. After shaping, the contributions of \(\simeq 20\) events have been added on top of each other by the effect of the shaper, and the distribution is much closer to a gaussian; the peak at zero has been washed away.

This program allows to study algorithms to reconstruct the energy in a given cell (algorithm that could be used for pulse shape analysis in the _filter_). For the time being, we assume that the timing is perfect and call energy the value of the pulse corresponding to the maximum of the pulse (\(3^{rd}\) arrow of Fig 1). The study of more sophisticated algorithms, as decribed in [4], is detailed in another note [8].

Results after shaping

On Fig 5 are shown the two distributions of the probability to get more than \(\mid E_{t}^{min}\mid\) in one e.m. cell and in a nonet, having taken into account the electronic noise, 20 MB events and the shaping function. In Table 5 are summarized the equivalent numbers of Table 4, but after shaping and with the electronics noise.

Inside a nonet, at nominal luminosity, the probability to get more than 500 MeV(1 GeV) is 19.%(3.5%). These numbers can be compared to the probability to get more than 500 MeV(1 GeV) coming from the noise: 2.5%(0%) and to the probability to mismeasure a 50 GeV e.m. particle by more than 500 MeV(1 GeV): \(\simeq 40\%(\simeq 25\%)\).

If the pile-up was decribed by mini-jets (\(p_{t}\geq 5\ GeV\)), the probability would be increased (cf Table 5) to 27%(5.9%) for 500 MeV(1 GeV). These numbers stay at the level of the calorimeter resolution for energies above \(\simeq 50\ GeV\).

### Negative versus positive

As one can see from Fig. 4 the transverse energy distribution after shaping has negative values (coming from the _negative plateau_ shown on Fig. 1). The numbers given in Table 5 were obtained considering \(\mid E_{t}\mid\). This is justified by the fact that the electronics noise being gaussian, fluctuations are positive or negative. But, on the other hand, it may be possible to detect negative pedestal and to correct for them (by using and algorithm able to reconstruct the energy above a pedestal). The difference, in terms of probability, between considering \(E_{t}\) or \(\mid E_{t}\mid\) depends on the cut. In Table 6 are given the probabilities to get more than \(E_{t}^{min}\) in a nonet considering \(E_{t}\) and \(\mid E_{t}\mid\).

### Could the effect of the tails in the pile-up be corrected?

We are trying to establish whether the effect on the energy due to pile-up could be corrected for; its contribution comes from the crossing itself and from previous events.

In order to separate the 2 effects, we have run the program described previously, but removing the signal from the particular bunch-crossing and looked again at the probability to have the energy above a given threshold. The probability to have more than 250(500) MeV is not affected much, becoming 44%(14%) compared to the nominal 48%(19%), in a nonet, at nominal luminosity. However the probability to be above 1 GeV decreases by a factor of 2. The probability distribution (for a nonet at high luminosity) is shown on Fig 6 and compared to the non-suppressed distribution. The probability to be above a threshold is more affected at high cuts than at low cuts. This indicates that the contribution to large pile-up (\(\geq 1GeV\)) is dominated by _intime_ events. Therefore, no shape analysis can be used to measure and subtract the contribution of such events. It may however be possible to flag an event with a large pile-up contribution by looking at the activity of the all event (in particular in the forward region).

## 5 Conclusions

Using a simulation program, we have looked at the effect of pile-up events on top of the electronic noise, for a nonet (\(\Delta\eta\times\Delta\phi=0.075\times 0.075\) over 3 samplings) in the LAr electromagnetic calorimeter. No detailed shower simulation has been applied on the pile-up events. With this description, the R. M. S. of the transverse energy of pile-up events, at the LHC nominal luminosity, is \(\simeq 400\)\(MeV\), the R. M. S. of the electronics noise is 200 \(MeV\) all accross the barrel. The probability for the total noise (electronics + pile-up) in a nonet to be above \(750MeV(=\Delta E_{calo}(50\ GeV))\) is 7% at the nominal LHC luminosity, most of it coming from the beam crossing itself (and not from previous beam crossings). This study gives a bigger contribution from pile-up events than what is described in [9], where detailled shower simulation was performed; the difference between the two results may be explained by this only fact. More work in needed to understand the difference.

\begin{table}
\begin{tabular}{|l|c|c||c|c|} \hline  & \multicolumn{2}{|c|}{one event} & \multicolumn{2}{|c|}{20 events} \\ \hline \hline  & \(E_{t}\) & \(E_{t}\) & \(E_{t}\) & \(E_{t}\) \\ \hline \(E_{t}^{min}=250\ MeV\) & \(13.3\pm 0.1\) & \(26.9\pm 0.2\) & \(20.6\pm 0.2\) & \(48.1\pm 0.2\) \\ \hline \(E_{t}^{min}=500\ MeV\) & \(1.8\pm 0.1\) & \(3.3\pm 0.1\) & \(10.4\pm 0.1\) & \(18.7\pm 0.1\) \\ \hline \(E_{t}^{min}=1\ GeV\) & \(1.5\pm 0.01\) & \(1.6\pm 0.01\) & \(3.2\pm 0.02\) & \(3.5\pm 0.03\) \\ \hline \end{tabular}
\end{table}
Table 6: _Probability(in %) for \(E_{t}\) and \(|E_{t}|\) (in a nonet) to be above \(250,\ 500\ MeV\) and \(1\ GeV\). Two luminosity are considered: low luminosity (one event per crossing) and high luminosity (20 events per crossing)._

## Appendix A: Electronic noise

The formula used for the _equivalent noise on input_ is:

\(N_{electrons}^{equiv.}=\frac{1}{\sqrt{2}}\times e_{n}\times C_{d}\times I\) where \(I=\sqrt{f_{0}^{\infty}\,h^{\prime 2}\ dt}\ h\) being the response to an impulse, \(h^{\prime}\) its derivative.

\(N_{electrons}^{equiv.}\) is the number of electrons equivalent to 1 GeV.

In the program, the time unit is the _nanosecond_. We have used

* \(e_{n}=0.33\ nV/\sqrt{Hz}\) for the GaAs preamplifier intrinsic noise [1].
* \(C_{d}=900pF\) for the detector cell capacitance (average value across \(\eta\) for the middle and back samplings).

\(N_{electrons}^{equiv.}(1GeV)=1(GeV)\times G_{fi}\times f_{samp}\times 0.5=3.23\ 10^{6}\ electrons\)

where \(G_{fi}=3.8\ 10^{7}\ electrons/GeV\) and \(f_{samp}=0.17\), the sampling fraction. The factor 0.5 comes from the triangle.

\(\sigma_{bruul}(GeV)=\frac{1}{\sqrt{2}}\times e_{n}\times\ C_{d}\times\ I\ /Q_{eq}\)

\(\sigma_{bruul}(GeV)=I\times\frac{1}{\sqrt{2}}\times\ 0.33\frac{10^{-9}}{\sqrt{10 -9}}\times\ 900\ 10^{-12}\times\ \frac{1}{3.23\ 10^{6}\times 1.6\ 10^{-19}}\)

\(\sigma_{bruul}(GeV)=I(\sqrt{ns})\times 0.01285\ GeV\sqrt{ns^{-1}}\)List of Figures
* 1_a) Pulse after the Shaper (CR2-RC3) (full line) and the 5 measurements (arrows). The timing has been adjusted so that the maximum of the pulse is sampled (3rd point)._\(t_{max}^{triangle}=45\)ns; \(t_{dri;t}=441\)ns; \(t_{BX}=25\)ns. Also plotted is the derivative (dashed line) and the response to a derivative of an impulse (dotted line); these three functions are used in the simulation.
* 2_Multiplicity distributions from MB events using PYTHIA 5.7 for charged (a)) and neutral (b)) particles. Weighted distribution (p\({}_{t}\)) for charged (c)) and neutral (d)) particles.
* 3_Transverse energy spectrum is one electromagnetic cell (a)) and in a nonet (b)), for a pile-up of 20 superimposed minimum-bias events. Probability to collect more than_\(E_{t}^{min}\) _in one e.m. cell (c)) and in a nonet (d))._
* 4_a) Noise distribution in GeV. b) Pile-up distribution before shaping, in a nonet for an average of 20 interactions per crossing; the hole around 400 MeV comes from the cut on the momentum of the charged tracks, to simulate the effect of the magnetic field. c) Pile-up distribution after shaping in a nonet (\(\Delta\eta\times\Delta\phi=0.075\times 0.075\)). d) Noise and pile-up (in GeV) as a function of time (in ns) when measured at every bunch-crossing.
* 5_Probability to get more than_\(E_{t}^{min}\) _in a nonet, for three luminosities: low, nominal and high after shaping; the probability for the electronic noise is also shown._
* 6_Probability to get more than_\(E_{t}^{min}\) _in a nonet, for a pile-up of 20 superimposed minimum-bias events, after shaping (the electronic noise has been taken into account) BUT having suppressed the contribution from the considered crossing. For comparison, the non-affected distribution has been superimposed (dashed curve)._

## References

* [1] ATLAS Technical Proposal for a General-Purpose pp Experiment at the LHC at CERN. CERN/LHCC/94-43; LHCC/P2
* [2] Front-End Electronic for the ATLAS electromagnetic Calorimeter System Specifications.
* [3] N. Launay, C. de la Taille and L. Fayard: Noise improvement with multiple samples, ATLAS Internal Note/CAL-NO-024/12 July 1993.
* [4] W.E. Cleland and E.G. Stern: Signal processing considerations for liquid ionization calorimeters in a high rate environment, NIM A338(1994)467-497.
* [5] W. Hellman, A. Nisati, G. Polesello and A. Watson: First Level Trigger Rates. EAGLE Internal Note/DAQ-NO-004/24-03-92.
* [6] P. Battaglia and L. Perini: Study of the pile-up due to Minimum Bias events in the LAr calorimeter of Atlas. ATLAS Internal Note/CAL-No-018/02-02-93.
* [7] G. Ciapetti and A. di Ciaccio: Monte-Calo simulation of minimum bias events at the LHC energy. proc. Aachen vol.II, CERN 90-10.
* [8] I. Wingerter-Seez: Study of energy reconstruction using optimal filtering with the LAr electromagnetic calorimeter. ATLAS Internal Note/LARG-N0-19/April 1995.
* [9] L. Serin and V. Tisserand: Study of pileup in the ATLAS electromagnetic calorimeter. ATLAS Internal Note/CAL-NO-73/7 February 1995.