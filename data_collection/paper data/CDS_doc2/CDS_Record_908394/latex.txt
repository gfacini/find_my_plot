# Quality Control of Optical Transmitters for the ATLAS Liquid Argon Calorimeter

Tiankuan Liu

 Cheng-An Yang

 Yuping He

 Benjamin E. Wakeland

 Jingbo Ye

Physics Department

 Southern Methodist University

 Dallas

 Texas 75275

###### Abstract

A quality control test is performed on nearly 2000 custom optical transmitters for use in the Liquid Argon Calorimeter of the ATLAS detector. More than 90% of these optical transmitters passed the test and have been installed in the calorimeter readout system. The acceptance criteria, measurement procedure, and results of the quality control test are presented in this note.

optical transmitter, quality control, ATLAS. +
Footnote â€ : preprint: SMU-HEP-04-010

## 1 Introduction

Signals from the ATLAS Liquid Argon Calorimeter [1] are amplified, shaped, and digitized on the front-end boards [2] located on the detector. The digital data are then transferred through over 1700 optical links to the back-end electronic system located about 120 meter away for further processing. In each optical link, optical transmitter (OTx) converts the signals from electrical into optical form, and sends them out through optical fiber. The optical transmitter is placed in a high radiation environment [3] and must fit into limited space on the front-end board. A custom optical transmitter design [4] has been developed at Academia Sinica of Taiwan. Academia Sinica produced all optical transmitter modules.

Figure 1 is the schematics of the custom optical transmitter. The key component is a Vertical Cavity Surface Emitting Laser (VCSEL) laser diode (LD1) TTR-1A42-000/43-000 [5] produced by the TrueLight Corporation. A current source circuit consisting of two discrete transistors (Q1 and Q2) provides laser diode bias current, which can be adjusted via resistor R1. A Micrel laser diode driver (U1) SY-88922V [6] generates the modulation current, which is ac-coupled to the laser diode and can be adjusted via resistor R12. Inputs to the optical transmitter are a pair of differential Positive Emitter Coupled Logic (PECL) signals which are ac-coupled from the front board and biased by four resistors R2, R3, R4, and R5. The optical transmitter is packaged and shielded in a small steel box. A multimodegraded-index (GRIN) optical fiber can be attached onto a standard ST receptacle. A photo of two such transmitters is shown in Figure 2.

All front-end board components and subassemblies must fulfill strict quality and reliability requirements since the access to the electronics for repairs and replacement will be limited. An initial functional test procedure has been conducted on each optical transmitter during their production in Taiwan. Next, an extensive quality control test has been done at SMU to screen for performance failure. Finally, a system test has been performed at Nevis Laboratory of Columbia University after the optical transmitters were mounted onto the front-end boards. The procedures, acceptance criteria, and results of the performance tests are presented in this note.

## 2 Test Parameters and Acceptance Criteria

Eleven parameters are specified for performance test of every optical transmitter shipped to SMU. The test procedures are described in detailed in section 3. Test results, statistics and failure modes are listed in section 4. For each parameter, a maximum and a minimum value are set for acceptance. The reasons for each parametric test and for the acceptance criteria are explained in the following.

Average optical power (AOP) measures how much light is transmitted through the optical fiber. For safety reason, the upper limit of average optical power is set

Figure 1: The schematic of the custom optical transmitters

as -3.5 dBm because larger optical power might cause damage to human eyes. The sensitivity of the optical receivers in the optical links is required to be better than -17.0 dBm. Therefore, we set the lower limit of average optical power at -7.5 dBm to preserve a 9.5 dB margin for transmission degradation and coupling loss.

Extinction ratio (r\({}_{\text{c}}\)) is the ratio of the optical high power over the optical low power, corresponding to the optical power of logical "1" and "0". Given the extinction ratio and average optical power, we can derive the absolute value of optical high power and optical low power. For a set system thermal noise, the lower the extinction ratio, the higher average power is needed to maintain the same target error rate. The extinction ratio lower limit is set to be 6.

Rise time (t\({}_{\text{r}}\)) and fall time (t\({}_{\text{f}}\)) are the transition time required for a pulse to change from one logic level to the other, passing specific thresholds usually defined as 20% and 80% of the pulse height. Rise time and fall time describe how

Figure 2: The photo of two custom-made optical transmitters

fast an optical transmitter can work. The lower limits for both rise and fall times are set to be 220 ps.

Jitter is the deviation in time of an actual signal from the ideal signal at certain amplitude [7, 8]. Jitter may cause the receiver to interpret the received data incorrectly, consequently causing data transmission error. Jitter is divided into two fundamental types, random jitter (RJ) and deterministic jitter (DJ). Random jitter is generated by non-systematic causes, e.g. random noise, and can be characterized by a Gaussian distribution. Deterministic jitter is generated from a variety of systematic causes such as limited bandwidth. It has a non-Gaussian distribution. The amplitude of random jitter is un-bounded and we measured its RMS value. Deterministic jitter always has upper and lower bound and we measure its peak-to-peak value. The acceptance criteria are set to be no more than 125 ps (peak-peak) for DJ and no more than 10.24 ps (RMS) for RJ. These requirements are the same as for commercial optical transmitters of Gigabit Ethernet Standard [9], but adjusted to the custom data rate of our optical links.

Reference voltage (VRef) is an output voltage of the driver chip SY-88922V used to adjust the modulation current. The operating range from 1.7 V to 2.3 V is specified on the manufacturer's datasheet.

V-I curve of an optical transmitter module describes the dependence of total supply current on the supply voltage. V-I curve reflects the characteristics of the internal components, dominated by the laser diode, the driver chip, and interconnections. Change on the overall transmitter V-I curve may be traced back to the failure of its internal components and interconnections and may help screen out these potential failure modes.

Eye diagram is a display of many overlapped waveforms that resembles the shape of an eye. Eye diagram test is a comprehensive way to measure the quality of a high-speed communication system. A variety of signal parameters, such as noise, jitter, rise and fall times, high and low levels, overshooting and ringing, can be observed from an eye diagram. To enhance the eye diagram test, an eye mask, which is one or several polygons with specific scales, is used to define a set of keep-out regions within which waveforms must not intrude.

The fundamental performance of a digital communication system is how accurately its receiver can determine the logic state of each bit received. This characteristic is measured by bit error rate, defined as the ratio of the number of bits received in error to the total number of bits received. In the ATLAS liquid argon calorimeter readout system, the optical power loss from the optical transmitter to the optical receiver is no more than 10 dB. Therefore, the bit error rate test is performed at both full optical power (BER\({}_{0}\)) and at 10 dB attenuation (BER\({}_{10}\)). In both cases we use the same criterion as the industrial standard, 10-12.

Table 1 summaries the test parameters and acceptance criteria and serves as a specification sheet of optical transmitter for system integration by other institutions.

## 3 Test Procedure

### Average Optical Power, Extinction Ratio, Rise and Fall Time

Test setup to measure average optical power, extinction ratio, rise time, and fall time is shown in Figure 3. Pattern generator provides differential electrical signals of specific patterns. The OTX evaluation board hosts one optical transmitter. The digital sampling oscilloscope receives the optical signal through an optical sampling module. The pattern synchronous output signal of the pattern generator triggers the oscilloscope.

According to the Optical Channel Standard, the pattern of signal used in the test shall be a repeating 10-bit K28.7 (1, 1, 1, 1, 1, 0, 0, 0, 0, 0) series. This is a clock-like square wave at one tenth of the serial data rate. Because there is a 1000-bit minimum length constrain required by the pattern generator, we form a pattern by repeating the K28.7 series 100 times. The pattern synchronous signal outputs one pulse every 100 K28.7 series.

\begin{table}
\begin{tabular}{|l|l|c|c|} \hline \multicolumn{2}{|c|}{Parameters} & \multicolumn{2}{|c|}{Acceptance criteria} \\ \hline Name & Unit & Min. & Max. \\ \hline Average optical power & dBm & -7.5 & -3.5 \\ \hline Extinction ratio & & 6.0 & \\ \hline Rise time & Ps & & 220 \\ \hline Fall time & Ps & & 220 \\ \hline Deterministic jitter (peak-peak) & Ps & & 125 \\ \hline Random jitter (RMS) & Ps & & 10.24 \\ \hline Reference voltage & V & 1.7 & 2.3 \\ \hline I-V Curve & & \multicolumn{2}{|c|}{Decided by the operator} \\ \hline Eye diagram test & & No points falls in the prohibition regions \\ \hline BER w/ 0 dB attenuation & & \multicolumn{2}{|c|}{10-12} \\ \hline BER w/ 10 dB attenuation & & \multicolumn{2}{|c|}{10-12} \\ \hline \end{tabular}
\end{table}
Table 1: The test parameters and acceptance criteria Some optical transmitters have overshooting and ringing on the optical waveforms which reduce the accuracy of measurement. A commonly recommended method is to use a fourth-order Bessel-Thomson low pass filter. Bandwidth of such a low pass filter is determined by data rate. Although the optical links works at a custom data rate (1.6 Gb/s), the standard low pass filter for 2.125 Gb/s Fiber Channel is chosen in our test. The response time measured includes the effect of the low pass filter.

Figure 4: The screenshot of optical power and response time test

Figure 3: The setup for the optical power and response time measurements

All parameters are directly derived from the Oscilloscope measurement panel, except that extinction ratio is calculated as the ratio of high power to low power. Averaging and maximum record length are chosen to maximize measurement accuracy at the expense of longer testing time. The screenshot of optical power and response time measurement is shown in Figure 4. In this example, the rise time of 230 ps is larger than the required time. Therefore, this module failed rise time test.

### Random Jitter

The same setup outlined in Figure 3 is used to measure random jitter. Repeating K28.7 series is used because data dependent jitter does not exist in this pattern. RMS value of random jitter is the standard deviation of the histogram taken at the horizontal (time) direction at a specific edge around 50% level [10]. In order to measure the random jitter accurately, we follow the following steps:

* A fourth-order Bessel-Thomson low pass filter for 2.125 Gb/s Fiber Channel is used to prevent the waveform from overshooting and ringing, thus to improve the accuracy of measurement.
* Choose the maximum record length.

Figure 5: A screenshot of random jitter test

* Zoom in the waveform with shortest delay because the time base precision is not accurate at large delay. The whole screen should display only one crossing point as full as possible.
* Set the vertical limits of the histogram to be 1% of the whole screen height, which centers at the average optical power measured in parameter measurement section and the horizontal limits of the histogram to be the whole screen width.
* Acquire enough waveforms (\(>\)2000).

The random jitter measured is the jitter of the whole test system, which includes the pattern generator, the optical sampling module, and the oscilloscope. A screenshot of the random jitter test is shown in Figure 5.

### Deterministic Jitter

#### 3.3.1 Measurement Principle

Deterministic jitter always causes a definite deviation of a specific edge from its ideal edge, depending on the previous data and the transition type. We measure all edge positions at the threshold of 50% level and compare them with their ideal edge positions. The difference is deterministic jitter, whose peak-to-peak value is the difference between the minimum and the maximum [11].

Pattern selection will affect deterministic jitter measurement. We should choose a pattern that demonstrates the worst-case deterministic jitter. K28.5 ("11111 01011 00000 10100") is a pattern commonly specified for deterministic jitter measurement in Fibre Channel standard and Gigabit Ethernet standard. However, this is a pattern specified for 8B/10B encoding system. It contains 5 consecutive "1" and 5 consecutive "0", the longest run of consecutive digits in 8B/10B encoding system. It also contains one isolated "1" and one isolated "0", the shortest run of consecutive digit in 8B/10B encoding system. The optical data link uses CIMT encoding system in the G-link serializer/deserializer chipset [12]. It may contain 20 run of consecutive digits (for example, the previous control field 1011, the current data field 16-bit "1", and the current control field 1101). Therefore, we modify the K28.5 pattern to reflect this feature.

The pattern used in jitter test is a 1000-bit pattern containing 20 repeating g-link "comma" series. The g-link "comma" series is defined below (a space is put after each five digits for easy view)

11111 11111 11111 11111 01011 00000 00000 00000 10100.

This series contains a string of 20 consecutive logic "1", a string of 20 consecutive logic "0", one isolated logic "1", and one isolated logic "0". Therefore, this pattern contains the worst cases to cause the deterministic jitter. It is similar to K28.5 (commonly called "comma") series in 8B10B encoding system, except that the longest consecutive logic "1" and "0" run length is 20 in g-link encoding system instead of 5 in 8B/10B encoding system.

#### 3.3.2 Test Procedure

Again, we use the setup in Figure 3 to acquire a g-link "comma" waveform, as shown in Figure 6(a). Heavy averaging and maximum record length are chosen to improve the measurement accuracy.

Interpolation can also improve time resolution of crossing point position calculation. The horizontal resolution of the sampling oscilloscope is set to be 12.5 ps in order to take a whole pattern. After 15 points are interpolated between the consecutive sampling points the time resolution increases to 0.78 ps, that is, 12.5 ps / 16. The sinc interpolation [13] in our calculation process implies the periodic boundary condition. Therefore, the original waveform needs to crop to have only one period.

Crossing point of each waveform t\({}_{\text{real}}\)(i) (i = 1, 2, 3,..., 10) is then calculated using linear interpolation at 50% of the averaged threshold. The processes of the interpolation and finding crossing points are shown in Figure 6(a).

In an ideal waveform, the crossing points are located at t\({}_{\text{ideal}}\)(i) = T\({}_{0}\) + n(i) * UI, where UI (unit interval) is the ideal length of a bit, T\({}_{0}\) is the position of the first crossing point, and n(i) = 0, 1, 2, 3, 5, 25, 26, 27, 28, 30. UI and T\({}_{0}\) are derived through linear least square regression, which is shown in Figure 6(b)

The deviation t\({}_{\text{jitter}}\)(i) = t\({}_{\text{real}}\)(i) - t\({}_{\text{ideal}}\)(i) is the jitter at each edge. The peak-peak value of deterministic jitter is the difference between the maximum and the minimum of t\({}_{\text{jitter}}\)(i). The result of this process is shown in Figure 6(c).

**(a)** The cropped waveform, the interpolation and crossing points

**(b)** The linear fit of the positions of crossing pointsAgain the deterministic jitter measured includes the effect of the whole test system, that is, the pattern generator, the optical sampling module, and the oscilloscope.

### Eye Diagram

The setup for the eye diagram test shown in Figure 7 is similar to the setup used for previous measurement, except that clock synchronous signal instead of the

Figure 6: The procedure of the deterministic jitter calculation

Figure 7: The setup for eye mask test.

[MISSING_PAGE_FAIL:12]

BER test setup diagram is shown in Figure 9 [14]. The pattern generator generates 32-bit parallel data at 40 Mb/s, each bit of which is a 2\({}^{32}\)-1 pseudo-random serial bit. The multiplexer (Mux) converts 32-bit data into 16-bit data at the double speed. The g-link serializer HDMP-1022 then converts the parallel data into a serial bit stream. The optical transmitter, the device under test (DUT), translates the electrical signal into optical signal and transmits the signal through optical fiber. Adjustable optical attenuator attenuates the optical power. The optical receiver translates the optical signal into the electrical signal. The g-link deserializer HDMP-1024 converts the serial bit stream to parallel 16-bit data at 80 MHz. The demultiplexer (DeMux) converts 16-bit data back into 32 bit data at the

Figure 9: The setup diagram for BER test.

original speed of 40 Mb/s. The error detector examines if there is any error in the data received. The bit error number is sent to a PC through a RS-232 interface. The pattern generator, Mux, DeMux, and error detector are implemented in a field programmable gate array (FPGA) chip.

BER test is performed at two conditions, 0 dB attenuation and 10 dB attenuation. At each condition the test takes 11 minutes. If there is no error during this period, the corresponding BER is less than 10-12.

### Reference Voltage

The reference voltage is measured by using a digital multimeter.

### V-I Curve

The setup for V-I curve measurement is shown in Figure 10. A programmable voltage source generates the power supply voltage of the device under test (DUT), an optical transmitter module, and a digital multimeter measures the current. A PC controls the voltage sweeping and current measurement. Figure 11 is the V-I curve of OTX #0986.

Figure 10: The setup for V-I curve measurement

[MISSING_PAGE_EMPTY:15]

\begin{tabular}{|l|l|l|} \hline BER0 & 0 & \\ \hline BER10 & 0 & \\ \hline Total & 161 & \\ \hline \end{tabular}

Among the 31 modules failing the eye diagram test, 15 modules had erroneous waveforms, and 16 modules had correct waveforms with some points falling in the central or in the upper eye mask region. Figure 12 is the eye diagram of OTX 2131 with erroneous waveforms.

All modules failed the eye diagram test passed bit error rate tests. It was easily understandable that the modules with only a few points falling in the central or in the upper eye mask regions passed the eye diagram test. And these modules may still be usable in specific systems. However, it was surprising to notice that all modules with erroneous waveforms also passed the bit error rate tests. This phenomenon could be explained by the following hypothesis. Inside an optical transmitter, there was a pair of biasing resistors, 300 \(\Omega\) and 1 k\(\Omega\) respectively. In the eye diagram test board, the external biasing resistors were 12.4 k\(\Omega\) and 4.2 k\(\Omega\). On the bit error rate test board, the external biasing resistors were much

Figure 12: The eye diagram of OTX 2131

[MISSING_PAGE_FAIL:17]

[MISSING_PAGE_FAIL:18]

Figure 16: The histogram of extinction ratio

Figure 15: The histogram of Averaged Optical Power

Figure 17: The histogram of rise time

Figure 18: The histogram of DJ

## 5 Conclusion

A quality control test is performed on nearly 2000 custom optical transmitters for use in the liquid argon calorimeter of the ATLAS detector. More than 90% of these optical transmitters passed the test and have been installed in the calorimeter readout system.

## Acknowledgements:

The authors would like to thank Ming-Lee Chu and Ping-Kun Teng at Academia Sinica of Taiwan, Stefan Simon and John Parsons at Nevis Laboratory of Columbia University for useful discussions.

## References

[1] The ATLAS collaboration, _Liquid Argon Calorimeter Technology Design Report_, CERN/LHCC/96-41, December 1996. Available: [http://atlas.web.cern.ch](http://atlas.web.cern.ch) /Atlas/GROUPS/LIQARGEXT/TDR/Welcome.html.

[2] J. Ban, S. Negroni, J. Parsons, et al, "Design and Implementation of the ATLAS LAr Front End Board". Available: [http://www.nevis.columbia.edu/](http://www.nevis.columbia.edu/)\(\sim\)atlas/electronics/ATLASFEB/FEBnote.pdf.

Figure 19: The histogram of RJ