**Hadronic Interactions**

**in Pixel Detectors**

Dario Barberis, Mario Cervetto, Bianca Osculati

_Universita di Genova and INFN, Genoa, Italy_

18 April 2002Introduction

The planning and understanding of the last generation High Energy Physics experiments must rely on a Monte Carlo simulation as realistic as possible. Large efforts have been dedicated to develop the Geant4 toolkit, and it is important to validate its behaviour. One of the hottest topics is the validation of the models of hadronic interaction processes. In this note we compare the hadronic interactions in the pixel detector, measured in a dedicated test-beam run, with the Geant4 simulated hadronic interactions, generated using two different simulation models, the parametric model and the Quark-Gluon String model [1].

## 2 Experimental apparatus

The telescope used in the August 2001 pixel test-beam period [2], consisting of four microstrip planes, two single-chip pixel detectors and a scintillator counter, was rearranged to collect events in a run dedicated to the study of hadronic interactions. The microstrip apparatus consisted of four double-sided 50 \(\mu\)m pitch detectors. The area covered by each microstrip plane was 32\(\times\)32 mm\({}^{2}\); the sensor thickness was 300 \(\mu\)m.

The two pixel detectors were positioned with the 50 \(\mu\)m pitch in the \(x\) (horizontal) direction and the 400 \(\mu\)m pitch in the \(y\) (vertical) direction. The total area covered by each detector was 8.2\(\times\)7.4 mm\({}^{2}\) and the sensor thickness was 280 \(\mu\)m. The pixel plane in the upstream position (Pix1) was equipped with prototype front-end electronics of type D (FE-D, [3]) and the downstream one (Pix2) with prototype electronics of type B (FE-B, [4]). A scheme of the telescope layout for this run can be seen in Fig. 1.

The trigger required an energy deposition in the scintillator corresponding to the passage of at least 3 minimum-ionising particles. A total of \(\sim\)800000 interaction events were collected, running with a 180 GeV/\(c\)\(\pi^{+}\) beam.

Exactly the same apparatus was described in Geant4, with a careful representation of the geometry and of the materials in the beam. A digitisation model derived from the

Figure 1: _Layout of the pixel test-beam telescope for the interaction run._

algorithm used for the full ATLAS simulation in Geant3 was implemented for the pixel hits, while the strip hits were grouped directly to form the equivalent of reconstructed clusters.

## 3 Real and simulated data

In order to apply exactly the same analysis to the real and simulated interactions, we produced n-tuples to be read by the same analysis program. Only events with at least three clusters in each of the three microstrip planes downstream of the pixel detectors were selected for this analysis.

Figure 2: _Residuals with respect to the fit values of the beam track x coordinate as functions of the y coordinate for the microstrip planes: a) Plane1, b) Plane 2, c) Plane 3, d) Plane 4._

### Real data

Before analysing the real data, a precise alignment of the telescope planes was performed using two beam trigger runs, taken just before and just after the interaction trigger run. An accurate analysis showed small and different rotation angles in the transverse (\(xy\)) coordinate system of the microstrip planes, as can be seen in Fig. 2; these rotation angles were taken into account in the following analysis.

The Pixel detectors were aligned and their energy release signals, evaluated from the Time-over-Threshold (ToT) 7-bit read-out, were individually calibrated. The evaluation of calibration constants was also performed using the beam trigger data. The procedure consisted in selecting single-pixel clusters, evaluating the mean ToT value for each pixel, equalising them, and finally applying the global calibration, i.e. translating from the ToT to the energy loss scale. This last step includes the external calibration with pulse injection and the normalisation with radioactive sources. After alignment and calibration, the microstrip and pixel digit information was saved in an \(n\)-tuple.

### Simulated data

Two samples of simulated n-tuples were produced, a first one with the Geant4 parametric model ("Geisha") for hadronic physics (_param-data_), version 4.0 of the Geant4 toolkit, and the second one with the Quark-Gluon String physics model (_theor-data_), using the updated version 4.0.ref3 of the Geant4 toolkit. A total number of \(\sim 1.2\times 10^{6}\) 180 GeV pions were generated with each of the two models implemented for hadronic physics. The fraction of interactions generated in the material of the pixel detectors (including

Figure 3: _Simulated Pixel detector in Geant4. From left to right the rectangular plastic cover (3 mm thick) of the detector, followed, at a distance of a few mm, by the silicon sensor (280 \(\mu\)m thick), the Front End read-out chip (150 \(\mu\)m thick) and the PCB (1 mm thick), all contiguous. The interaction is in the sensor._the plastic covers) is 1.5% of the total number of generated events, independently of the model. This number is in good agreement with the expectation, evaluated using the thickness of the different materials and the cross-sections of high-energy pions in these materials.

Fig. 3 shows a simulated hadronic interaction in the pixel sensor. The complete pixel device consists of a plastic cover and the detector itself, i.e. the sensor, the Front End read-out chip and the Printed Circuit Board. Hadronic interaction events generated by Geant4 in the material of the detector (including the plastic cover) were saved into a \(n\)-tuple, where the detailed pixel digit information was stored. As already said, the microstrip hits were not fully digitised in our simulation, therefore we submitted them to a combined digitisation and clustering: after grouping together all hits separated by less then 100 \(\mu\)m (the two-track resolution of the microstrip detector), we smeared the cluster position according to a 10 \(\mu\)m sigma gaussian distribution, corresponding to the real detector resolution. The values of the energy releases in the \(x\) and \(y\) projections were also smeared, in order to reproduce the real-data distributions for the \(x\) and \(y\) read-out of the four microstrip planes.

## 4 Reconstruction and Analysis

The analysis procedure was developed as a sequence of four main steps:

* track reconstruction in the three microstrip planes downstream of the pixel planes;
* interaction point (vertex) reconstruction;
* selection of the interactions in the silicon sensor;
* study of the pixel cluster corresponding to the reconstructed vertex coordinate.

### Track reconstruction

The track reconstruction had to take into account the rotation angles of the test-beam microstrip planes, which prevented accurate independent single-projection reconstruction. The following method was used to overcome this difficulty:

* pattern recognition of three strip points roughly aligned in one projection (100 \(\mu\)m tolerance);
* search in the other projection of an associable track, i.e. three points roughly aligned, connected to the points in the first projection by compatible deposited energies;
* rotation in every plane of the associated \(x^{\prime}\) and \(y^{\prime}\) points to the \(x\),\(y\) common coordinate system;
* straight line fit in the \(xz\) plane;
* straight line fit in the \(yz\) plane;* definition of the track quality, as a function of the fit probabilities (prob(\(\chi^{2}_{xz}\)) and prob(\(\chi^{2}_{yz}\))) and the energy release difference of the two projections;
* choice of the best quality tracks.

This procedure was applied also to simulated data, skipping only the rotation step as there is no misalignment in the simulation. The mean number of reconstructed tracks per event was 3.8 tracks in the _theor-data_, 3.7 tracks in the _param-data_ and 3.1 in the real data.

### Interaction vertex reconstruction

We implemented a very simple algorithm to reconstruct the interaction vertex coordinates, evaluating the mean of all two-by-two track intersections (elementary vertices), weighted by the product of the \(\chi^{2}\) probabilities of the two tracks divided by their relative opening angle. This algorithm was applied separately in the two projections. In a very small fraction of events only one track was reconstructed, therefore no vertex could be reconstructed.

In Fig. 4 the transverse vertex resolution is shown separately for the two pixel planes: in a) and b) the \(x\) and \(y\) vertex resolution respectively are

Figure 4: _Transverse vertex resolution: Pix1 plane: a) x resolution, b) y resolution; Pix2 plane: c) x resolution, d) y resolution_

pixel plane (Pix1), and in c) and d) the same quantities for the downstream plane (Pix2). As expected, the resolution of Pix2 is considerably better, since the outgoing particles traverse less material and the opening angle (limited by the geometrical acceptance of the most downstream microstrip plane) is on average larger. As the longitudinal resolutions (Fig. 5) confirm this point, and in addition the pixel detector in the second position performed much better than the one in the first position, we chose to study only the interactions originated on the Pix2 plane.

Fig. 6 reports the \(z\) position of simulated and reconstructed interaction vertices in the Pix2 plane. The upstream quasi-rectangular simulated distribution corresponds to the simulated interactions on the plastic cover of the detector, while the second one to the interactions on the detector itself, i.e. the sensor, the Front End chip and the Printed Circuit Board. Fig. 7 shows the \(z\) distance from the center of the silicon sensor of the interaction vertices reconstructed in the region of the Pix2 plane for simulated and real data. Here again, the interactions produced in the plastic cover of the detector are quite distinct from the interactions on the detector itself. All figures in this section (except Fig. 7) refer to data simulated with the parametric model, perfectly equivalent to the data simulated with the theoretical model for what concerns the resolution.

Figure 5: _Longitudinal vertex resolution: Pix1 plane: a) z resolution from the xz projection, b) z resolution from the yz projection, c) z resolution from the mean z coordinate; Pix2 plane: d) z resolution from the xz projection, e) z resolution from the yz projection, f) z resolution as from mean z coordinate._

Figure 6: _Simulated and reconstructed (hatched) z vertex coordinate in the Pix2 region._

Figure 7: _z distance between the reconstructed vertices and the z position of the center of the sensor: a) param-data, b) theor-data, c) real data._

### Identification of interactions in the Pixel sensor

The \(z\) resolution (\(\sigma_{z}=2.2\) mm) is not sufficient to identify hadronic interactions produced in the silicon pixel sensor, in order to select them from the interactions in the complete detector, i.e. upstream in the plastic cover, and downstream in the Front End chip and in the PCB.

Hadronic interactions with break-up of the nucleus in the sensor can be distinguished by a very large local energy release due to the nucleus evaporation (the "black tracks" in the old emulsion and bubble chamber language), associated with the transverse position of the reconstructed vertex, and by a considerable number of digits produced by higher energy tracks emerging from the interaction point. In order to associate the correct pixel signals to the interactions, we clustered the adjacent digit signals, and associated to the reconstructed vertex the cluster having the smallest transverse distance from the reconstructed interaction point. The energy loss in the pixels as a function of the \(z\) distance of the reconstructed vertex from the sensor and the energy loss per digit (_Eloss/Ndig_) as a function of the same quantity are reported respectively in Fig. 8 and in Fig. 9 for simulated and real data.

We identified the interactions in the sensor by selecting events with the \(z\) coordinate of the reconstructed vertex closer than 4 mm from the center of the sensor and with

Figure 8: _Released energy, measured in number of ionised electrons, as a function of the \(z\) distance between the reconstructed vertex and the sensor (Pix2) position: a) param-data, b) theor-data, c) real data._Figure 9: _Released energy normalised to the number of digits, as a function of the \(z\) distance between the reconstructed vertex and the sensor (Pix2) position: a) param-data, b) theor-data, c) real data._

normalised energy loss larger than 56000 electrons in the case of simulated events and 100000 for real events. The cuts were set analysing the normalised energy loss for events with interaction vertices reconstructed in the plastic cover, far enough from the sensor to be resolved by our \(z\) resolution (see Fig. 10). The different cut values derive from the calibration curve employed to scale the ToT read-out in the real data. We rejected events whose associated cluster contained digits on the chip border (rows or columns), so as to avoid dealing with potentially incomplete clusters.

In order to have a comparable interaction statistics in simulated and real events, we generated \(0.5\times 10^{6}\) additional events with the parametric and the same number with the theoretical model. Pix1 was removed to speed up the Geant4 tracking. We obtained the expected fraction of 0.7% of beams interacting in the entire Pix2 material (including the plastic cover). The plots of simulated data in the following refer to these enlarged samples.

### Analysis of interactions in the Pixel sensor

In order to compare the features of the interactions originated in the sensor for the real data and the events simulated with the two different models, we study for the selected events the number of emerging tracks which have been reconstructed in the microstrip detectors (Fig. 11) and the following variables concerning the cluster identified as originated from the interaction:

* the total energy release in the cluster (Fig. 12);
* the maximum single-pixel energy release (Fig. 13);

Figure 10: _Released energy normalised to the number of digits in the cluster for events originated in the detector plastic cover (double-logarithmic scale): a) param-data, b) theor-data, c) real data._

* the ratio between the the maximum single-pixel energy release and the total energy release in the cluster (Fig. 14; as already said, because of the calibration curve employed to scale the ToT read-out in the real data, the energy losses are on slightly different scales for simulated and real data, but this variable is independent of the energy scale);
* the cluster width (\(\sigma\)), evaluated taking into account the distances of all digits from the cluster barycenter, weighted with the corresponding fractions of energy release (Fig. 15);
* the number of digits in the cluster (Fig. 16);
* the distance from the cluster barycenter of the farthest digit in the cluster (Fig. 17).

The interaction features look rather different in the real and in the simulated events. The theoretical model produces and deals with the heavy nuclear fragments, which are not managed separately by the parametric model. The "black" tracks are better represented by the theoretical model, as can be inferred from Fig. 14: the ratio between the energy released in the pixel directly hit by the the interacting pion, energy mostly due to nuclear fragments, and the total released energy, gives a measure of the energy distribution within the cluster.

On the other hand, more energetic tracks seem to be somewhat better represented by the parametric model, see Fig 11 and Fig 16, even if in this last figure there is a rather evident discrepancy between the real and the parametric cluster size.

We looked for possible correlations between the analysed variables, especially between the forward part of the interaction (i.e. the number of reconstructed outgoing tracks) and

Figure 11: _Number of reconstructed tracks in the interaction: a) param-data, b) theor-data, c) real data._

Figure 12: _Logarithm of the total energy released in the cluster: a) param-data, b) theor-data, c) real data._

Figure 13: _Logarithm of the maximum energy released in a pixel: a) param-data, b) theor-data, c) real data._

Figure 14: _Ratio of the maximum energy released in a pixel and the total cluster energy: a) param-data, b) theor-data, c) real data._

Figure 15: _Width of the cluster associated to the interaction: a) param-data, b) theor-data, c) real data._

Figure 16: _Number of digits in the cluster associated to the interaction: a) param-data, b) theor-data, c) real data._

Figure 17: _Distance of the farthest digit from the cluster barycenter: a) param-data, b) theor-data, c) real data. The peak structure corresponds to the 400 \(\mu\)m pixel length._

the characteristics of the local energy deposition. No significant non-trivial correlations are evident either in the real or in the simulated data.

From an overview of all the figures, some global indication emerges in favour of the theoretical model, which anyway still looks too schematic in reproducing high energy pion interactions in silicon.

Since the time this work was done, new versions of the Geant4 hadronic physics models have been released. Furthermore, new test beam data will be collected in Summer 2003. A new set of comparison studies between data and simulation will therefore be performed in the near future.

## Acknowledgements

The authors would like to thank J. Richardson and the Pixel test beam group for their help in collecting the data used for this analysis. We also thank L. Vacavant, D. Calvet, H.-P. Wellisch and A. Dell'Acqua for their contributions to the Pixel test beam simulation in Geant4.

## References

* [1] Geant4 Physics Reference Manual, version 4.0, [http://wwwinfo.cern.ch/asd/geant4](http://wwwinfo.cern.ch/asd/geant4) /G4UsersDocuments/UsersGuides/PhysicsReferenceManual/html/PhysicsReference Manual.html, December 2001.
* [2][http://siliconlab.physik.uni-bonn.de/telescope/telescope.htm](http://siliconlab.physik.uni-bonn.de/telescope/telescope.htm)
* [3] J.Richardson, Nucl. Inst. Meth. **A 473** (2001) 157.
* [4] P.Fischer, Nucl. Inst. Meth. **A 465** (2001) 153.