ATLAS Internal Note

LARG-N-0-61

13 December 1996

**Study of quantization noise for multi gain systems**

**Serge Nicoleau**

LAPP, Annecy-le-Vieux, France

The conversion from analog to digital introduces a quantization error, and its r.m.s. is called quantization noise. The problem is to evaluate the quantization noise for a typical cluster in the electromagnetic liquid argon calorimeter and to check if it does not degrade significantly the detector resolution. This note presents results of this step for some possible readout electronics of the ATLAS electromagnetic calorimeter and concludes that a three gains system with 12 bits ADC and a four gains system with 10 bits ADC do not degrade significantly the detector resolution even in presence of a small amount of coherent noise injected at the conversion stage level.

General approach

Considering the readout electronics of the ATLAS calorimeter, there are three different stages : the detector at the beginning symbolized by a capacitor, then the preamplifiers, then a conversion stage which takes as input an analog signal and delivers a digital signal (see figure 1).

Electrons with energies from 1 GeV/c2 to 2 TeV/c2 have been simulated by the DICE9.5 package at \(\eta=0.4\), and their energies reconstructed in the 81 cells of a 3x7 tower1 centered on the most energetic cell in the second sampling. For one cell2 of the target cluster, we call \(e\) the signal after preamplifiers and \([e]\) the measured value by the readout electronics. The introduced quantization error \(\epsilon_{q}^{\not{q}}\) is the difference between them. As \(\epsilon_{q}\) is a random variable, we note its r.m.s. by \(\sigma_{q}^{\not{q}}\) and call it quantization noise.

Footnote 1: (\(\eta\),\(\phi\)) tower description : 24x2 = 48 cells in the first sampling, 3x7 = 21 cells in the second one and 3x4 = 12 cells in the third one.

Footnote 2: that we denote with the \(\not{e}\) symbol.

\[\epsilon_{q}^{\not{q}}=e-[e] \tag{1}\] \[\sigma_{q}^{\not{q}}=\sqrt{Var(\epsilon_{q}^{\not{q}})} \tag{2}\]

For instance, let us consider a perfect one gain system. If \(e\) is the input value expressed in GeV and \(G\) the gain expressed in ADC/GeV, the \(ADC\) result will be :

\[ADC=int(G.e+0.5) \tag{3}\]

where \(int\) is the mathematical integer part, and 0.5 is added to define a rounding error. To obtain the measured value \([e]\), we have to express \(ADC\) in GeV units :

\[[e]=\frac{AD\,C}{G}=\frac{1}{G}int(G.e+0.5) \tag{4}\]

If the input value \(e\) is a uniformly distributed variable, the quantization noise is well known :

\[\sigma_{q}^{\not{q}}=\frac{1}{2\sqrt{3}G} \tag{5}\]

Figure 1: schematic overview of calorimeter readout electronics

In the case of the 3x7 tower assuming that the quantization process introduces no correlation between cells in the cluster, the total quantization error \(\epsilon_{q}\) is the sum over all cells of the quantization error \(\epsilon_{q}^{\not{q}}\), and the total quantization noise \(\sigma_{q}\) is the r.m.s. of \(\epsilon_{q}\) :

\[\epsilon_{q} =\sum_{3x7\,\mathrm{for}\,er}\epsilon_{q}^{\not{q}} \tag{6}\] \[\sigma_{q} =\sqrt{Var(\epsilon_{q})} \tag{7}\]

## 2 Multiple sampling and definition extensions

A method of optimal filtering of multiply-sampled signals to obtain amplitude from calorimeter signals in environment with pile-up and electronics noise has been implemented according to the original way developed in [4]. When an electron comes through the liquid argon calorimeter, the shaper delivers a signal which corresponds to its response to the triangular current induced by ionization electrons. This shape is sampled every beam crossing (25 ns), and the third sample occurs at the max of the response. For a drift time of 400 ns, a preamplifier time constant of 30 ns and a shaping time of 15 ns, the normalized triangular response \(g(t)\) of a CR-RC\({}^{2}\) shaper is shown in figure 2 (see [1]) :

The undershoot (minimum of the triangular response) which reaches -23 % of the peak allows us to measure the electrons drift time. In this way, the minimum energy of the modeled multi gain system is not 0 GeV but minus one fifth of the maximum deposited energy in one cell (sampling dependent).

A coefficient \(c_{i}\) is associated at each sample, and the sum of all weighted samples give us the incident energy. Coefficients computation is based on the noise correlation matrix between the samples, whose elements (\(C_{i,j}\)) can be expressed as :

\[C_{i,j}=R_{p}(t_{i}-t_{j})+R_{t}(t_{i}-t_{j}) \tag{8}\]

where:

* \(\{t_{i}\}\) is the set of sampling times.

Figure 2: triangular response of a CR-RC\({}^{2}\) shaper

* \(R_{p}\) is the pile-up noise autocorrelation function in 3x7 tower, which can be parameterized as (see [2] for values) : \[R_{p}(t)=(57.7\,Me\,V/\sqrt{ns})^{2}\frac{\mathcal{L}}{\mathcal{L}_{0}}\sum g(t+t _{i})g(t_{i})\times 25ns\] (9) where \(\mathcal{L}_{0}=10^{34}cm^{-2}s^{-1}\) is the nominal luminosity, \(g\) is the normalized shaper triangular response shown in 2. The calculation of the pile-up noise is given by :
* \(\sigma_{pu}=\sqrt{R_{p}(0)}\) for a track & hold system.
* \(\sigma_{pu}=\sqrt{c_{i}R_{p}(t_{i}-t_{j})c_{j}}\) for multiple sampling system.
* \(R_{t}\) is the thermal noise autocorrelation function in 3x7 tower at \(\eta=1.2\), which can be parameterized as (see [2] for values) : \[R_{t}(t)=(4\,22\,MeV)^{2}\frac{\int h^{\prime}(t+u)h^{\prime}(u)du}{\int h^{ \prime}(u)^{2}du}\] (10) where \(h\) is the normalized shaper impulse response. In the same way as above, the electronics noise can be computed for different systems through the formulae:
* \(\sigma_{el}=\sqrt{R_{t}(0)}\) for a track & hold system.
* \(\sigma_{el}=\sqrt{c_{i}R_{t}(t_{i}-t_{j})c_{j}}\) for a multiple sampling system.

The behavior of \(R_{p}\) and \(R_{t}\) is shown in figure 3.

Figure 3: Normalized autocorrelation functions : thermal one (\(R_{t}\)) in dotted line and pile-up one (\(R_{p}\)) in solid line.

Note that \(R_{t}(25\,\,\mathrm{ns})\simeq 0\), which means that the thermal noise in consecutive samples is nearly uncorrelated. Computation leads to these sets of eight optimum coefficients for two luminosities :

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|} \hline  & \(c_{1}\) & \(c_{2}\) & \(c_{3}\) & \(c_{4}\) & \(c_{5}\) & \(c_{6}\) & \(c_{7}\) & \(c_{8}\) & \(\mathcal{N}=\sqrt{\sum c_{i}^{2}}\) \\ \hline \(\mathcal{L}=\frac{c_{8}}{10}\) & \(0.11\) & \(0.31\) & \(0.44\) & \(0.37\) & \(0.24\) & \(0.11\) & \(0.02\) & \(-0.03\) & \(0.72\) \\ \hline \(\mathcal{L}_{0}\) & \(-0.21\) & \(0.18\) & \(0.58\) & \(0.34\) & \(0.1\) & \(-0.04\) & \(-0.08\) & \(-0.1\) & \(0.75\) \\ \hline \end{tabular}

\(\mathcal{N}\) corresponds to the Euclidean norm of the coefficients vector. We will see in the last section the incidence of this number.

We have summarized in the next table the different noise values for a track & hold system and a multiple sampling one at different luminosities :

\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline  & \multicolumn{4}{|c|}{expected at \(\frac{c_{8}}{10}\)} & \multicolumn{4}{|c|}{expected at \(\mathcal{L}_{0}\)} \\ \hline  & el. noise & p.u. noise & tot. noise & el. noise & p.u. noise & tot. noise \\ \hline track & hold & \(422\) MeV & \(147\) MeV & \(447\) MeV & \(422\) MeV & \(464\) MeV & \(627\) MeV \\ \hline multiple sampling & \(181\) MeV & \(190\) MeV & \(262\) MeV & \(296\) MeV & \(460\) MeV & \(547\) MeV \\ \hline \end{tabular}

The introduction of multiple sampling leads us to redefine precisely the quantization error. For one cell, we obtain the new definition :

\[\epsilon_{q}^{\notin}=e-\sum_{i=\,1}^{n\,samples}c_{i}[e\,g(t_{i})] \tag{11}\]

where \([\,]\) corresponds to the digitization part. For the 3x7 tower, the original definition (6) of \(\epsilon_{q}\) is conserved.

## 3 The multi gain options and their associated noises

Some options for the ATLAS electromagnetic calorimeter readout electronics (2 gains, 3 gains, 4 gains and compressor) are schematically described as below in figure 4 :

The signal created in liquid argon by ionization is represented as a current generator. The different kind of noises have been symbolized by waving arrows : pile-up noise, preamplifier noise, analog pipeline noise and at the end of the conversion stage, the ADC noise.

Figure 4: 2 gains, 3 gains, 4 gains and compressor with associated noises.

* The pile-up in a 3x7 tower is a function of the LHC luminosity and of the rapidity. It has not been simulated.
* The preamplifier noise has been calculated for 0T design. According to reference [2], the noise values expressed in energy at3\(\eta=1.2\) are : Footnote 3: If we consider a barrel with gains set to the same values at every position, then the dynamic range is fixed at the end of the barrel, where the electronics noise is higher. For this reason, we have taken into account noise at the end of the barrel, even if simulations have been performed at lower \(\eta\).
* The preamplifier noise has been calculated for 0T design. According to reference [2], the noise values expressed in energy at3\(\eta=1.2\) are : Footnote 4: acronym for SCA = Switch Capacitor Array = analog pipeline.
* For a 3x7 tower, the total electronics noise is 422 MeV (\(=\sqrt{R_{t}(0)}\)).
* The analog pipelines store signals as charge and the imperfections of the pipeline lead to an addition of unwanted charge to the original inputs. Expressed in volt, this addition is estimated to be less than about 1 mV for a 4 volt range. In the following, we then assume a 12 bits precision SCA4. The conversion from noise expressed in volts to noise expressed in energy units will depend on the gain. This conversion is detailed in the next section, however we present already here the analog pipeline noise for each of the gains of linear systems5 : Footnote 5: the two gains system with gains ratio (32,1) and a 12 bits ADC is used for the table.
* Coherent noise due to the conversion stage and not to the preamplifiers stage has only been considered. This noise is coherent over all cells, for instance a noise related to addresses in the pipeline memory which is common to all cells. Thus the same random variable is added to the energies of the 81 cells of a 3x7 tower. We used three different values of coherent noise : 100 \(\mu\)V, 250 \(\mu\)V and 500 \(\mu\)V for a 4 V maximum signal at the input of the SCA.
* The actual ADCs do not correspond perfectly to an integer mathematical function and various imperfections can affect their performances : differential non linearity, noise of the comparators, a.s.o. For example, if we consider a modern ADC (see [5]), thermal noise at \(+25^{o}\) corresponds to one third of ADC unit6. To model all these effects, we add a random Gaussian noise with an r.m.s. of 0.41 \(\mathrm{lsb}\), _id est_ the quantization error for one cell \(\sigma_{\theta}^{\mathrm{f}}\) has an r.m.s. of 0.5 \(\mathrm{lsb}\). Footnote 6: which is called normally \(\mathit{lsb}\) for least significant bit.

## 4 Modeling of 2,3,4 gains and compressor options

The n=2,3,4 gains systems are linear and can be easily described by the set of the gains7, the energy range and ADC maximum value, while a compressor is a little bit more difficult to describe due to its non linearity. Figure 5 summarizes their description : Footnote 7: In fact the ratios of gains over the lowest one are considered.

For linear multi-gain systems, the gains have been chosen in order to smooth the quantization noise curve and to optimize the separation from the calorimeter resolution curve. For the 2 gains system, a special analysis has been performed with different value for the gains ratio (see 6.1 for details). For the 3 gains system, a short analysis at high luminosity (see 14) led us to choose the (96,8,1) model, which presents the best separation with the calorimeter resolution at low energies without deteriorating its characteristic at high energies. The pedestals correspond to one fifth of the ADC range to enable drift time measurement using the negative lobe of the pulse.

In figure 5 we can see two undefined parameters :

* \(e_{max}\), maximum deposited energy in one cell.
* \(e_{min}\) lower limit of the energy range.

\(e_{max}\) is determined by physics requirements ; in fact, we want to be able to detect and reconstruct a massive gauge boson Z' of 5 TeV/c\({}^{2}\) mass, which decays in two electrons of 2.5 TeV/c of transverse momentum (see [3]). At the end of the electromagnetic barrel (\(\eta=1.2\)) it corresponds to two electrons of 5 TeV/c\({}^{2}\) energy.

The same 5 TeV maximum energy applies to the electromagnetic end-cap. So, to determine the maximum deposited energy in cells of each sampling, electrons of 5 TeV incident energy must be simulated and reconstructed in the calorimeter. 5 TeV electrons require a long computer time to simulate. Extrapolation from lower energy are used. In figure 6 is shown the percentage of incident energy deposited in each sampling and in figure 7 are plotted for each sampling the value of \(e_{max}\) versus the incident energy \(e_{inc}\).

The two axes are in log scale and the used parameterization for \(e_{max}\) is :

\[e_{m\,az}=e_{m\,az}^{0}*exp(\alpha*(log(\frac{e_{inc}}{e_{inc}^{0}}))^{2})\]

The fit to the data, extrapolated at 5 TeV, gives the set {140 GeV in S1, 2.7 TeV in S2, 1.47 TeV in S3 }. But to have a safety margin which avoids statistical overflow, the final choice of \(e_{max}\) is :

\begin{tabular}{|c|c|c|} \hline S1 & S2 & S3 \\ \hline
300 GeV & 3 TeV & 1.5 TeV \\ \hline \end{tabular}

With this last values, we can conclude that the dynamic range in the second sampling is :

Figure 5: 2 gains, 3 gains, 4 gains and compressor modelisation with the set of gains’ ratios.

\(e_{min}\) should be negative to measure the undershoot8 and thus drift time. The amplitude of the negative lobe is \(\simeq\frac{1}{5}\) of the positive one. In addition, a safety margin of 50 ADC count has been assumed at the high end of the ADC range to avoid overflow. In the next table, values of \(e_{min}\) for linear multi-gains system are presented for the highest gain :

Footnote 8: the negative part of the triangular response of a CR-R C\({}^{2}\) sharp er corresponds to one fifth of the positive part (see 2).

\begin{tabular}{|c|c|c|c|} \hline  & S1 & S2 & S3 \\ \hline
2 gains & -2 GeV & -20 GeV & -10 GeV \\
3 gains & -1 GeV & -8 GeV & -4 GeV \\
4 gains & -1 GeV & -6 GeV & -3 GeV \\ \hline \end{tabular}

## 5 Test criterion

We want that the quantization noise does not affect significantly the total calorimeter resolution. This is achieved by requesting the calorimeter resolution be degraded by less than 5 % (or 11.8 %) :

\[\frac{\sigma_{q}}{E}\leq\frac{1}{3}\frac{\sigma_{E}}{E}\ (\mbox{or}\ \frac{\sigma_{q}}{E}\leq\frac{1}{2}\frac{\sigma_{E}}{E}\ ) \tag{12}\]

\(\frac{\sigma_{E}}{E}\) is the calorimeter resolution parameterized as :

Figure 6: Percentage of incident energy deposited in each sampling.

\[\frac{\sigma_{E}}{E}=\frac{n}{E}\oplus\frac{s}{\sqrt{E}}\oplus c \tag{13}\]

where :

* \(n\) is the noise term and has been defined as the electronics noise. We used for \(n\) the values presented in the last table of the section 2.
* \(s\) is the sampling term linked to the calorimeter geometry. The fit of simulated data gives a 10 % value.
* \(c\) is the constant term which represents calorimeter imperfections (geometry, calibration, etc...). The chosen values for \(c\) in our criterion are 0.7% (see [6]) and 0.5%.

For all simulated energies, we have computed for each multi-gain system with each sampling system (track and hold, multiple sampling at low luminosity, multiple sampling at nominal luminosity) the calculated quantization noise and compared it to one third (or one half) of calorimeter resolution.

Figure 7: Black stars represent the maximum deposited energy in one cell for 95% events versus electron incident energy, while white stars represent the mean of the maximum deposited energy in one cell.

## 6 Analysis results

Electrons of 1, 5, 10, 20, 50, 100, 200, 500, 1000 and 200 GeV at \(\eta=0.4\) have been simulated with the DICE9.5 package. A special ntuple of 150 GeV energy has been constructed9 from 100 GeV and 200 GeV simulation ntuples to study especially the two gain system. The energy of each cell is treated by a program which implements the different models. Two treatments can be done :

Footnote 9: Let us call \(e_{100}\) and \(\sigma_{100}\) (resp. \(e_{200}\) and \(\sigma_{200}\)) the measured energy and resolution in a 3x7 tower for 100 GeV (resp. 200 GeV) electrons. Using energy and resolution fits, we calculate the expected \(e_{150}\) energy and \(\sigma_{150}\) resolution for 150 GeV incident electrons. Then we determine \(\alpha\) and \(\beta\), the weights for 100 GeV and 200 GeV ntuples in such a way :

\[\left\{\begin{array}{l}\alpha e_{150}+\beta e_{200}\equiv e_{150}\\ \alpha\sigma_{100}\oplus\beta\sigma_{200}\equiv\sigma_{150}\end{array}\right.\]

 The energy of each cell for the 150 GeV ntuple are obtained by weighting and summing energies of corresponding cell in the 100 and 200 GeV ntuples. For example, we obtain \(\alpha=1.35\) and \(\beta=0.077\).

* **Track & Hold system**: preamps noise (Gaussian) is added to energy. The result is input to the conversion stage. Then the appropriate gain is determined and analog pipeline noise (Gaussian, whose r.m.s. is gain dependent) is added. ADC noise (Gaussian) and coherent noise are finally added before digital conversion. The result is then converted back into energy units by the inverse of the gain and compared to the input.
* **Multiple sampling system**: the triangular response of the CR-RC\({}^{2}\) shaper is sampled eight time. Preamps noise (Gaussian and uncorrelated between samples) is added to each sample. This set of results is input to the conversion stage. Then the appropriated gain is determined by looking at the peak sample and analog pipeline noise (Gaussian and uncorrelated between samples) is added. ADC noise and coherent noise are added to each element of the set, which are converted into energy units in the same way as above. Finally, the weighted sum is calculated using final set of values and optimum coefficients. The result is compared to the weighted sum of the input set.

 The sum of all comparisons gives us 3x7 tower quantization error \(\epsilon_{q}\) for one event. Note that the quantization process is supposed to introduce no correlation between cells and/or samples. When considering all simulated events of fixed energy we obtain the r.m.s. of this variable which corresponds to the absolute quantization noise \(\sigma_{q}\).

 In the following figures 8- 29 results are presented for each model with each sampling system (track & hold, multiple sampling at low \(\frac{\mathcal{L}_{q}}{10}\) and high \(\mathcal{L}_{0}\) luminosities) and with three values of coherent noise (100 \(\mu\)V, 250 \(\mu\)V and 500 \(\mu\)V for a 4 V range).

### Two gains detailed analysis

The two gains model has been fully investigated by varying the ratio of the two gains and by using two types of ADC. We have tested the following sets of gains ratios : (16,1) (32,1) (48,1) (64,1), with 12 bits and 14 bits ADC type.

 According to the figures 8, 9 and 10, the ratio which fits at best our criterion over the full energy range with two different constant terms is 32 (1 \(\mathrm{lsb}=23\) MeV for the highest gain in the second sampling with a 12 bits ADC). A 14 bits ADC, provides just an small enhancement of 20 %. Indeed the ADC contribution to the noise is small compared to the SCA one. The study of the effect of a coherent noise is done only for a 12 bits ADC with (32,1) as gains ratios at high luminosity (\(\mathcal{L}_{0}\)). The results are presented in Figures 12 and 13. We concluded that such a two gains system satisfies barely our criterion.

### Quantization noise behavior at low energies

At low incident energies, all cells of the 3x7 tower are in the higher gain for every kind of multi-gains system. In this region, this gain does not vary, so the quantization noise has a behavior \(\frac{\sigma_{q}}{\mathrm{E}}\) in \(\frac{1}{\mathrm{E}}\). In this region, the detector resolution is dominated by the preamplifiers noise. The next table shows a comparison of the noise term and \(\sigma_{q}\) at 20 GeV electron energy at nominal luminosity with multiple sampling systems :

\begin{tabular}{|c|c|c|c|c|c|} \hline  & 2 gains (32,1) 12 bits & 2 gains (32,1) 14 bits & 3 gains & 4 gains & compressor \\ \hline \(\sigma_{q}\) (MeV) & 118 & 91 & 40 & 60 & 201 \\ \hline noise term (MeV) & \multicolumn{5}{|c|}{296} \\ \hline \end{tabular}

### Multiple sampling effect

At low energy, the multiple sample method leads to a decrease in electronics noise as well as in quantization noise. But this effect is not symmetric : the weighting method correct better the electronics noise than the quantization one, especially at low luminosity. For this reason, the test criterion is harder to be validated.

At higher energy, the weighting effect leads to an improvement. Indeed the calorimeter resolution becomes equivalent to the sampling term and then to the constant term, whose values are independent of coefficients. But the quantization noise is affected by weighting samples, so that it decreases as \(\mathcal{N}\). Example : quantization noise of compressor system at 1 TeV :

\begin{tabular}{|c|c|c|c|} \hline  & \(\sigma_{q}\) & \((\sigma_{q})/(\sigma_{q})_{track\&h\,d\,d}\) & \(\mathcal{N}\) \\ \hline track \& hold & 3.57 GeV & 1 & 1 \\ \hline multiple sampling @ @ \(\frac{\sigma_{q}}{10}\) & 2.74 GeV & 0.77 & 0.72 \\ \hline multiple sampling @ \(\mathcal{L}_{0}\) & 2.83 GeV & 0.79 & 0.75 \\ \hline \end{tabular}

### Coherent noise effect

In order to summarize and understand the results extracted from the figures 11-13, 18-20, and 24-26, let we perform few calculations.

We have considered a coherent noise which is shared by all cells of a 3x7 tower, with 48 cells in the first sampling, 2l in the second one and 12 in the third one. We have assumed that this coherent noise is uncorrelated between samples. At low energy, all the cells are in the highest gain which correspond to \(R\) times the lowest one. If we express the coherent noise as a fraction \(F\) of the 4 V range, its total contribution \(\sigma_{c}^{tot}\) to the quantization noise can be expressed as :

\[\sigma_{coh}^{\,tot}=\frac{F\mathcal{N}}{R}(48e_{max}^{\,S_{1}}+21e_{m\,ax}^{ \,S_{2}}+12e_{max}^{\,S_{3}}) \tag{14}\]

in case of a multiple sampling system at \(\mathcal{L}_{0}\). It gives numerically :

* for the 100 \(\mu\)V option : \(\sigma_{coh}^{\,tot}=\frac{1.79}{R}\) GeV.
* for the 250 \(\mu\)V option : \(\sigma_{coh}^{\,tot}=\frac{4.47}{R}\) GeV.
* for the 500 \(\mu\)V option : \(\sigma_{coh}^{\,tot}=\frac{8.94}{R}\) GeV.

We can now predict the total quantization noise in presence of coherent noise from the simulated quantization noise without coherent noise by the simple formula :

\[\sigma_{q}^{\,brtcoh}=\sigma_{q}^{\,nobrtcoh}\oplus\sigma_{coh}^{\,tot}\]

In the next table, a comparison between the simulated quantization noise and the predicted one is presented for each value of the coherent noise :

\begin{tabular}{|c|c|c|c|} \hline  & \multicolumn{3}{c|}{\(\mathcal{L}_{0}\)} \\ \hline system & coherent noise & simulated quantization noise & predicted quantization noise \\ \hline
2 gains & 0 \(\mu\)V & 119 MeV & \\  & 100 \(\mu\)V & 127 MeV & _131 MeV_ \\  & 250 \(\mu\)V & 174 MeV & _184 MeV_ \\  & 500 \(\mu\)V & 290 MeV & _304 MeV_ \\ \hline
3 gains & 0 \(\mu\)V & 40 MeV & \\  & 100 \(\mu\)V & 44 MeV & _44 MeV_ \\  & 250 \(\mu\)V & 60 MeV & _61 MeV_ \\  & 500 \(\mu\)V & 97 MeV & _100 MeV_ \\ \hline
4 gains & 0 \(\mu\)V & 59 MeV & \\  & 100 \(\mu\)V & 60 MeV & _61 MeV_ \\  & 250 \(\mu\)V & 66 MeV & _69 MeV_ \\  & 500 \(\mu\)V & 87 MeV & _91 MeV_ \\ \hline \end{tabular}

Under the assumption that the coherent noise is uniformly shared by the cells of a 3x7 tower, we can conclude that :

* the influence of the coherent noise on the quantization noise is independent of the ADC type (number of bits).
* the highest is the ratio between the highest and the lowest gains, the lowest is the influence of the coherent noise.
* a simple calculation give a good estimation of the final quantization noise in presence of coherent noise.

## 7 Conclusion

We have seen that if we want that the quantization noise worsens by less than 5% the energy resolution in a 3x7 electromagnetic tower, we need multi-gain system which provides a quantization noise less than the third of the calorimeter resolution. Such a criterion has led us to classify multi-gains systems :

* the compressor as modeled in this analysis defines too a high quantization noise at low and high energies.
* an optimized two gains system with a 12 bits ADC validates barely our criterion with no coherent noise. A small addition of coherent noise leads to a very fast degradation of the quantization noise at low energy which can not be compensated by using a 14 bits ADC instead of 12 bits ADC.
* a three gains system with a 12 bits ADC and a four gains system with 10 bits ADC fit our criterion even if a small amount of coherent noise injected at the conversion stage level.

In actual readout system, there might exist other sources of noise : correlations between cells, sample to sample correlated noise, more ADC imperfections, sampling clock jitter, etc. For these reasons, results presented in this note probably underestimate the reality.

## References

* [1] A fast monolithic shaper for the ATLAS E.M. calorimeter, R.L. Chase, C. de la Taille, J.P. Richer, N. Seguin-Moreau
* [2] New noise figures for the ATLAS E.M. Calorimeter, C. de la Taille
* [3] The maximum energy deposition to the ATLAS E.M. calorimeter, H. Gordon, M. Leltchouk, M. Seman