**ATLAS Muon Note**

**1 September 2003**

**Study of the MDT drift properties computed with the Garfield program**

P.Bagnaia, C.Bini, G.Ciapetti, E.Solfaroli

_Dipartimento di Fisica dell'Universita "La Sapienza" e INFN, Roma, Italy_

## 1 Introduction

The performances of the MDT chambers of the Atlas Muon Spectrometer are, for a large extent, dependent from the behavior of the gas filling mixture. The baseline choice, _Ar-CO\({}_{2}\)_ 93/7%, has been dictated from considerations on the aging properties of the detector under high irradiation conditions, even if the drift characteristics are not the ideal one for achieving high resolution with a cylindrical detector. Therefore a very good knowledge of the drift properties of this gas mixture at the chosen working point is essential for understanding the detector behaviour and for optimizing its tracking capabilities.

In this note we present the results of a Montecarlo study of the drift properties of the _Ar-CO\({}_{2}\)_ mixture around the chosen conditions for the MDT using the Garfield simulation code. We have investigated the space-time relation, the creation of \(\delta\)-rays in the gas, the time distribution of signals produced by muons near the wire, the resolution that can be achieved and the influence of the various parameters (pressure, HV, fraction of \(CO_{2}\),...) on the _r-t_ relation. A similar study has been already performed in reference [1]. The aim of the present note is to revisit the subject with an improved version of Calib program and with emphasis on the space-time relation.

In SS 2 we summarize the main characteristics of the simulation; in SS 3and 4 we have studied the \(r\)-\(t\) relation and the resolution; in SS 5 the result of the study of the efficiency is shown; finally, the resolution dependence from the working point is shown in SS 6.

## 2 The simulation program

The detector response is simulated with the program Garfield [2].

Garfield (currently version 7.04) uses the program Heed to simulate the ionization of the gas molecules by the muons which cross the tubes, then has an interface to the program Magboltz to compute the electron transport properties in the gas. Therefore it simulates the electron and ion drift in the gas, the avalanche, the signal creation and detection, and the front-end electronics1. For each muon the program simulates the time measures by the TDC and the amplitude of the charge, as recorded by the Wilkinson ADC.

Footnote 1: For the reproduction of the electronics setup we have followed the method of the reference [3].

The relevant gas and detector parameters can be changed by the user. Table 1 lists those parameters, together with their _standard_ value2, which corresponds to the current Atlas baseline.

Footnote 2: For the values of the gas composition see the discussion below.

The fluctuations are included in the computation. We explicitly mention some of them:

* the position and size of the ionization;
* the possible creation of energetic \(\delta\)-rays (see figure 1);

\begin{table}
\begin{tabular}{||c|c||} \hline \hline parameter & standard value \\ \hline HV & 3080 \(V\) \\ temperature & 293 \(K\) \\ gas composition & _Ar-CO\({}_{2}\)_ 93-7 \\ gas impurities & _none_ \\ pressure & \(3bar(abs)\) \\ gain & \(2\cdot 10^{4}\) \\ threshold & 25 \(e\) \\ electronic noise & \(ENC=4\,200\) \\ \hline \hline \end{tabular}
\end{table}
Table 1: The relevant gas and detector parameters for the Garfield program; standard value corresponds to the current Atlas baseline.

* the electron and ion diffusion in the gas;
* the size of the avalanche, i.e. the gain fluctuation;
* the noise of the electronics, i.e. the discriminator fluctuations.

It is possible to measure the different contributions to the detector response by switching them on and off alternatively.

We have produced many sets of data, with different choices of the gas and fluctuation parameters, using two modes:

1. with a random choice of the distance between the primary muon track and the tube wire. By choosing a flat distribution for this distance between zero and the tube radius, we should reproduce the time spectrum of a single tube, e.g. during a test beam run;
2. with a suitable number (usually \(1,000\)) of tracks for consecutive distances from the wire (e.g. at \(1,\ 2,\ldots,14\ mm\) from the wire); this second method, which is much faster, has been used to compute the detector performances as a function of the drift distance.

It is worth mentioning some differences between the present simulation and the real events, e.g. in the test beam data taking:

* the _time_ measured by the real electronics contains an additive constant, which depends on the cable length, the trigger electronics,...; this constant, although in principle known, in practice can only be measured by fitting the time spectra (_measuring_\(t_{0}\)); on the contrary, in Garfield, the time \(t=0\) is given by the primary muon; this allows to compute the delay between the muon passage and its recorded signal, due to the crossing of the threshold, i.e. the drift time of the electron that will allow the threshold crossing;
* no \(\delta\)-ray produced in the tube walls is generated in Garfield; therefore, the efficiency of the detector, especially for muons at \(r\simeq R_{tube}\) is somewhat overestimated;
* the noise, both due to the cavern radiation and to the correlated and uncorrelated electronics pickup, is absent; its inclusion is possible, but beyond the scope of the present study.

In figure 2 the spectrum simulated by Garfield, using the mode 1, is compared with the time spectrum of a MDT tube from the test beam data. For this sample, the gas composition has been chosen to be \(Ar\)-\(CO_{2}\) 93.33/6.67%, which gives the best reproduction of the maximum drift time. With the limitations mentioned above, the agreement with the data is acceptable.

Figure 1: \(\delta\)-ray: an energetic electron drifts from the track towards the wire (Garfield simulation).

Figure 2: The simulated spectrum is compared with the time spectrum from the data. They are normalized respect to the area.

Drift time versus radius

The drift time as function of the radial distance of the track from the wire for the sample of figure 2 is shown in figure 3.

The \(r\)-\(t\) band is clearly visible with a tail towards shorter drift time due to \(\delta\)-rays produced in the gas; the number of tracks with measured drift times in excess of 5 standard deviations above the average amounts only to 3 out of \(10,000\). For \(r=0\) the corresponding drift time is peaked around 23 \(ns\); this is a measure of the average time needed, for a track hitting the wire, to collect the 25 electrons required to reach the discriminator threshold and of the response time of the electronics (\(\sim\!6\)\(ns\) in our simulated setup).

Figure 3: The drift time as function of the radial distance of the track from the wire for the simulated sample.

### The \(\delta\)-rays

The Garfield simulation allows to study the probability that the presence of a \(\delta\)-ray in the gas may decrease the time required to cross the threshold (see figure 3). The signal is attributed to a \(\delta\)-ray when its difference respect to the average drift time is greater than 3 standard deviations. In figure 4 this limit is represented by the full line.

We divided the tube radius in \(n\) bins and computed for each bin the fraction of \(\delta\)-rays. This fraction is shown in figure 5: it increases with the radius up to 3.4% at \(r=14\ mm\).

### Drift time versus radius

The average drift time as a function of the radial distance of the track from the wire, in slices of \(\Delta r=50\ \mu m\), after removal of the \(\delta\)-rays, is shown in figure 6; the error bars correspond to the r.m.s. of the time distribution, calculated after the \(\delta\)-ray cut. At small values of \(r\) the electron collection

Figure 4: Drift time versus drift path. The full line defines the region of the signals attributed to \(\delta\)-rays.

Figure 5: Fraction of signals due to \(\delta\)-rays as a function of the true drift distance (see text).

time is dominant over the radial drift time; as a consequence up to \(\sim\!0.5\ mm\) the average drift time is almost independent from the track radial distance.

The shape of the distributions (see figure 7) in each slice is compatible with a Gaussian distribution for \(r>1\ mm\); at smaller radii the distributions are wider and exhibit a small tail towards high radii3. At very large values

Figure 6: The average drift time as function of the radial distance of the track from the wire, in slices of \(\Delta r\); the error bars correspond to the r.m.s. The \(\delta\)-rays have been removed.

of \(r\) (\(r>10\)\(mm\)) the width of the distributions increases again, mainly due to the diffusion.

The r.m.s. of the time distribution (\(\sigma(t)\)) versus \(r\), is shown in figure 8; from a value of \(10\)\(ns\) for \(r=0\), \(\sigma\) decreases up to \(\sim 3.5\)\(ns\) at \(r=5\)\(mm\), increasing again slowly up to \(\sim 5\)\(ns\) at the edge of the tube. The various contributions to the resolution, as predicted by Garfield, are also shown.

Figure 8 shows also the expected individual contributions to the resolution, as a function of the drift path. Since some of the effects are correlated, the _individual contributions_ are not unambiguously defined. In order to achieve an understandable picture of the effects, we have arbitrarily used two different approaches:

* the contribution of the diffusion is computed as the overall resolution when all the other effects are switched off, i.e. by neglecting the correlations, which in this case are small;

Figure 7: The drift time distributions at different distances between the track and the wire: on the top \(r=25\)\(\mu m\) (left) and \(r=1\)\(mm\) (right) and on the bottom \(r=10\)\(mm\).

Figure 8: Time resolution (\(\sigma(t)\)) as a function of the drift path. The individual contributions are also shown.

Figure 9: The space resolution (\(\sigma(r)=v_{drift}\cdot\sigma(t)\)).

* all the other numbers are the difference in quadrature between the complete computation and the resolution obtained by switching off the effect under study.

Finally, in figure 9 the corresponding space resolution \(\sigma(r)=\sigma(t)\cdot v_{drift}\) as a function of the radius is plotted. The resolution decreases from \(\sim\!500\)\(\mu m\) near the wire to \(\sim\!50\)\(\mu m\) at the edge of the tube. The computation is in good agreement with the overall resolution measured in test beam data [4].

Figures 8 and 9 show that the most important contribution to the resolution comes from the ionization mechanism (cluster fluctuation and size), while the diffusion plays an important role only near the tube wall, for \(r>12\)\(mm\). The avalanche and electronic components are negligible in the full range. The figures show also that the dependence of the resolution on the drift path is mainly due to the variation of the drift velocity; in fact the resolution in time, apart from the first 2 \(mm\) near the wire, is rather constant.

## 4 Radial distance from drift time

The use of a drift detector implies that the measurement of the radial distance of the track from the wire is based on the drift time information. Therefore the space-time relation that we obtain from the auto-calibration procedure of the MDT chambers [5] and its uncertainty come from the behavior of the \(r\) distributions in slice of time.

We have studied the \(r\) distributions in bins of 4 \(ns\) drift time. The average distance \(r\) as a function of the drift time is listed in table 2. As can be seen from figure 10 the \(r\) distributions up to 60-80 \(ns\) are very asymmetric due to the transversal slicing of the space-time relation. At larger times (\(>100\)\(ns\) equivalent to \(r>5\)\(mm\)), the shape starts to be Gaussian-like with a \(\sigma\) decreasing from 150 \(\mu m\) to \(\sim\!50\)\(\mu m\) at the edge of the tube, in good agreement with the results of figure 9. The average radial distance as function of the drift time is shown in figure 11; as expected there is almost no \(r\) dependence for times up to 20 \(ns\). Note also that for \(t<20\)\(ns\) the r.m.s. of the distributions decreases, as expected from the \(r\)-\(t\) plot of figure 10.

In figure 12 we compare the \(r\)-\(t\) relation obtained with the slicing in time with the one coming from the study of \(t\) in slice of radial distance; below \(\sim\!0.5\)\(mm\) the two \(r\)-\(t\) relations are quite different, the discrepancy disappearing at large radii.

The corresponding \(\sigma\) (defined as the r.m.s. of the distributions in radius), even for non-Gaussian like distributions, as function of the average \(r\), is shown in figure 13 and compared with the measured resolution using the test beam 

[MISSING_PAGE_FAIL:13]

Figure 10: The \(r\) distributions at different drift time: \(t=10\)_ns_ on the top, \(t=34\)_ns_ in the middle on the left and \(t=320\)_ns_ in the middle on the right. The bottom figure show the drift path versus the drift time.

Figure 11: The average radial distance as function of the drift time.

Figure 12: The \(r\)-\(t\) relation obtained with the slicing in time (open squares) is compared with the one coming from the study of \(t\) in slice of radial distance (full dots).

Figure 13: The resolutions from the \(t\) slicing (continuous line) and from the \(r\) slicing (little dots) are compared with the one obtained from the auto-calibration (big dots).

data and with the result of the figure 9. The agreement with the data is acceptable in the limit due to the large binning of the experimental data. The large discrepancy below \(\sim\!2\)_mm_ respect to \(\sigma(r)=\sigma(t)\cdot v_{drift}\) is clearly due to peculiar behavior of the \(r\)-\(t\) relation near the wire induced by the electron collection time.

## 5 Efficiency

In the Garfield program the attachment losses over a drift path and the electron diffusion in the gas are estimated. These effects reduce the detector efficiency at the edge of the tube.

Because of the electron attachment it is possible that for a track near the edge the signal height results lower than the threshold, even if the number of primary electrons is greater than 25.

As it is shown in the figure 8, at large values of \(r\) (\(r\geq 10\)_mm_) the contribution of the electron diffusion to the resolution is not negligible. For \(r=R_{tube}\) the average fluctuation of the drift path is \(\Delta r>200\)_mm_, that corresponds to \(\Delta t>7\)_ns_ in drift time (\(v_{drift}\sim 30\)_mm_/_ns_ averaged on whole radius). Since the average peaking time of the preamplifier is 15_ns_[6], the delay due to drift time fluctuation can cause a decrease of the signal height.

Figure 14 shows the tube efficiency \(\varepsilon\) as a function of the true muon position (on the left) close to the edge of the tube. The value of the efficiency is reduced at \(\varepsilon=0.5\) when the distance between the muon track and the tube

Figure 14: Efficiency as function of the true muon position (on the left) and as a function of the average number of primary ionization electrons (on the right).

edge is \(\sim 30\)\(\mu m\). At this distance a muon releases \(\sim 50\) primary electrons on average (see the right figure 14), which corresponds to two times the threshold.

## 6 Changing the operating conditions

In the following paragraphs, we will show the dependence of the resolution, as a function of the drift path, on the main gas and electronics parameters:

1. the threshold, expressed in number of equivalent electrons (\(n_{e}\));
2. the HV and its consequence, the gas gain;
3. the gas pressure;
4. the fraction of \(CO_{2}\) contained in the \(Ar\)-\(CO_{2}\) gas.

The method is to consider the standard working point (set 3 on table 3) and to vary one parameter at the time.

The data samples are simulated by Garfield program using the mode (2) (see SS 2).

Table 3 shows the value of the gain, the threshold, the \(t_{\it tot}\) and the _average resolution_\(\overline{\sigma}\) (defined as the average in quadrature of the resolution for \(r\geq 2\)\(mm\)) for some gas parameters sets.

For the study of the resolution in SS 3.2, we have modified the gas parameters in such a way to keep the gain constant: the pressure variation study is made with sets n. 5, 6, 3, 7 and the mixture variation with sets 12, 14, 3. The threshold variation uses sets n. 15, 16, 17, 3, 18, 19.

In summary, the sets which have a \(Y\) in the last column have been used for the study of the parameters variation of SS 3.2.

Note also the total drift time in the table. Another different problem, which is not explicitly discussed here, is the necessity of a fast gas, to avoid pile-up problems at high luminosity.

### The resolution as a function of the threshold

We have generated samples of tracks, with a different choice of the threshold. In our study \(n_{e}\) varies in the range4 between 1 and 50.

Footnote 4: Since the noise corresponds to \(n_{e}\approx 4\), part of this range in threshold in unphysical, and is shown only to discuss the effects of the change.

Figure 15 shows the value of the resolution, as a function of the drift path, for different thresholds. The dependence on the drift path and threshold can

[MISSING_PAGE_EMPTY:19]

Figure 16: Resolution as a function of the HV and gas gain.

Figure 15: Resolution as a function of the threshold.

be understood. For short drift paths, the cluster size and position are the dominant effects, and therefore a smaller threshold improves the resolution. On the other hands, when the diffusion is dominant, the fluctuations on single electrons compensate each other, and a higher threshold fluctuates less.

The former effects is more important than the latter. So, in average (see table 3) a lower threshold offers a better resolution.

### The resolution as a function of the HV and gas gain

Figure 16 shows the resolution for different values of the gas gain and HV (see table 3). As clearly visible, a higher gain produces a better resolution. The main difference between this set and the one shown in figure 15 (threshold variation) is in the different gas properties in the two cases: while a change in threshold does not modify the electron drift, a change in HV and gain affects both the drift properties and the current on the wire.

### The resolution as a function of the gas pressure

Figure 17 shows the resolution for different values of the gas pressure. Keeping the gain constant means a different value of the HV in each case.

With these assumptions, the dependence of the pressure is very intuitive: more density offers more ionization and less fluctuations.

### The resolution as a function of the gas mixture

Finally, figure 18 shows the resolution for three values of the gas mixture. The better resolution of the mixture with less \(Ar\) comes from its small velocity. These mixtures are not possible in practice because of their long \(t_{tot}\).

## 7 Conclusions

A complete simulation of the ionization, drift and signal properties of the MDT allows the study of the detector response. We have applied this method to cases which cannot be investigated with real data, for basic or practical motivations:

* the creation of \(\delta\)-rays in the gas;
* the response of the tube to muons near the wire, as a function of the _true_ muon position;Figure 17: Resolution as a function of the gas pressure.

Figure 18: Resolution as a function of the gas mixture.

* the variation of the gas and electronics parameters in a wide range of values.

For each of these situations, the simulation of the detector response is a useful complement of the test beam data. The results agree when the comparison is possible (e.g. the overall time distribution and the resolution for the standard working point). Therefore, we are quite confident in the method when the simulated data are the only source of information.

## References

* Non-Linear MDT Drift Gases like \(Ar/CO_{2}\), Atlas note ATL-MUON-98-268 (1998).
* GARFIELD: a drift chamber simulation program, CERN program library W5050.
* Limits to Drift Chamber Resolution, Thesis (1997), [http://atlasinfo.cern.ch/Atlas/documentation/thesis/riegler/thesis.ps.Z](http://atlasinfo.cern.ch/Atlas/documentation/thesis/riegler/thesis.ps.Z).
* First results of the 2001 MDT chambers beam test, Atlas note ATL-MUON-2003-001 (2003).
* Autocalibration of high precision drift tubes, Atlas note ATL-MUON-97-135 (1997).
* MDT-ASD, CMOS front-end for ATLAS MDT, Atlas note ATL-MUON-2002-003 (2002).