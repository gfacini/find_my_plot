[

###### Abstract

This note describes in detail the algorithms used to identify jets in the ATLAS trigger system. Results from performance studies of these jet algorithms are presented. An initial trigger menu using jets and proposed strategy to adapt to increases in luminosity are also discussed.

1]ATLAS NOTE

ATL-PHYS-PUB-2009-000

[1.5cm] March 19, 2009

[1cm] The ATLAS Collaboration1]

Footnote 1: This note is prepared by I. Aracena, P. Conde Muino, D. Damazio, M.-A. Dufour, S. Eckweiler, J. Ferland, C. Santamarina Rios, M. Schram, B. Vachon, A. Watson.

[1cm] _This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020._

[1cm]

Introduction

A critical component of the ATLAS trigger system is the ability to efficiently identify hadronic jets in an event. The performance of the jet reconstruction depends on the trigger jet energy resolution and scale. In this note we discuss the algorithms at the different trigger levels and evaluate their performance.

## 2 L1 jet trigger algorithm

A detailed description of the L1 jet trigger algorithm can be found in [1]; however, for completeness, a summary of the relevant features of this algorithm is presented below.

The ATLAS electromagnetic and hadronic calorimeters are segmented into approximately 7200 trigger towers, with granularity of approximately \(0.1\times 0.1\) in \(\eta\times\phi\) space. The granularity varies slightly in different sub-detector systems, for further details see [1]. Analog signals from these trigger towers are transmitted directly to the L1 system. The L1 hardware digitises the trigger tower signals, associates them with a bunch crossing and performs pedestal subtraction. The L1 system also applies a noise suppression threshold and transverse energy calibration. The electromagnetic tower \(E_{T}\) response is calibrated at the EM scale and the hadronic tower \(E_{T}\) response is calibrated for jets.

The L1 trigger constructs "jet elements" made of the sum of \(2\times 2\) trigger towers in the electromagnetic (EM) calorimeter added to \(2\times 2\) trigger towers in the hadronic calorimeter which gives a granularity of \(0.2\times 0.2\) in \(\eta\times\phi\) space. The jet reconstruction algorithm consists of a sliding window of programmable size that could be either \(2\times 2\), \(3\times 3\) or \(4\times 4\) jet elements. A jet is reconstructed if the total transverse (EM+Hadronic) energy within the window is above a given threshold. The step size for the sliding window is 0.2 in both \(\eta\) and \(\phi\) which implies significant overlap of the window in neighbouring positions. To prevent the L1 algorithm from identifying overlapping jets, the transverse energy of a cluster, defined as a region spanned by \(2\times 2\) jet elements, is required to be a local maximum within \(\pm 0.4\) units in \(\eta\) and in \(\phi\). The L1 jet algorithm identifies jets within the region of \(|\eta|<3.2\). Figure 1 shows a schematic diagram of the jet reconstruction algorithm at L1.

In contrast to the other calorimeters, the L1 forward calorimeter (FCAL) trigger towers have a granularity of approximately \(0.4\times 0.4\) in \(\eta\) and \(\phi\). The forward jet trigger electronics was originally designed to only be used for the calculation of missing \(E_{T}\) at L1, and not to identify in addition jets in the forward regions of the detector. As a consequence, limited granularity of the FCAL data is available at L1. A jet element in the FCAL is formed by summing calorimeter towers in \(\eta\). Therefore, the FCAL jet elements have a \(\phi\) granularity of 0.4 with only a single \(\eta\) bin at each end. This has an impact on how the HLT forward jet reconstruction algorithm is implemented, as discussed in Section 5.

In the tentative menu proposed for early data taking, a sliding window size of \(4\times 4\) jet elements has been chosen for almost all thresholds; the exception is the algorithm used to reconstruct b-jets which has a proposed transverse energy threshold of 5 GeV and uses a window size of \(2\times 2\) to minimise the identification of fake jets associated with possible calorimeter noise.

## 3 L1 performance

Dijet events were used to study the performance of the L1 jet trigger algorithm. Table 1 provides a summary of the simulated data samples used along with their respective cuts on the hard scatter parton and cross-section. These simulated dijet event samples, together, span the whole \(E_{T}\) jet spectrum relevant for jet identification in the trigger.

The transverse energy scale of L1 jets is defined as the ratio between the transverse energy measured in L1 divided by the truth jet \(E_{T}\). Each jet identified by the L1 trigger was matched to a truth jet found using the cone algorithm with \(R=0.4\). The matching criterion consists in searching for the closest truth jet in the \(\eta-\phi\) plane, where the distance is defined as \(\Delta R=\sqrt{(\eta_{L1}-\eta_{Reco})^{2}+(\phi_{L1}-\phi_{Reco})^{2}}\). The L1 jet transverse energy scale as function of truth jet \(E_{T}\) is shown in Fig. 2(a). The transverse energy scale at L1 varies from about 70% to 90%, increasing with the transverse energy of the jet. There are several effects that contribute to this behaviour. The first one is the noise suppression mentioned in Section 2. The lower the transverse energy of the jet, the larger is the number of trigger towers that do not satisfy this noise suppression threshold leading to an underestimation of the jet transverse energy. In addition, each L1 trigger tower signal must be associated with a particular Bunch Crossing Identification number. The efficiency of this requirement is approximately 50% for 1 GeV trigger tower signals, reaching nearly 100% for 3 GeV trigger tower signals. Again, this inefficiency particularly affects lower transverse energy jets that will tend to contain a larger fraction of trigger towers with low energy signals. The most important reason for the lower jet transverse energy scale with respect to truth jets comes from the different \(e/\pi\) response of EM and hadronic towers. For presentation purposes, a common conversion factor is used to translate the number of counts measured in an EM or hadronic tower into units of transverse energy. This results in an apparent lower jet transverse energy scale compared to truth jets. It is important to note that thresholds in the L1 are applied in terms of the internal L1 quantity "counts" and not in units of transverse energy. In Fig. 2(b), the L1 jet transverse energy scale is also shown as a function of the pseudo-rapidity (\(\eta\)) of the truth jet. The response of the different calorimeter sub-detectors can be identified. Figure 3(a) shows the L1 transverse energy resolution as function of truth jet \(E_{T}\). The transverse energy resolution is defined as the width of the \(E_{T}^{\rm L1}-E_{T}^{truth}\) distribution in each \(E_{T}^{truth}\) bin, divided by the \(E_{T}^{truth}\) of that bin.

Figure 3(b) shows the L1 jet trigger efficiency as function of offline reconstructed jet \(E_{T}\) for different L1 jet trigger thresholds. The limited jet transverse energy resolution of the L1 system particularly affects the higher L1 energy thresholds.

The effect of pile-up on the performance of the L1 jet trigger reconstruction was also studied. At a luminosity of \(10^{33}\)s\({}^{-1}\)cm\({}^{-2}\), an average of approximately 2 inelastic collisions are expected per bunch

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|} \hline Event Sample & J0 & J1 & J2 & J3 & J4 & J5 & J6 & J7 & J8 \\ \hline Cross-section (mb) & 17.6 & 1.4 & 9.3E-2 & 5.9E-3 & 3.14E-4 & 1.3E-5 & 3.6E-7 & 5.3E-9 & 2.22E-11 \\ \hline \(E_{T}\) Range (GeV) & 8-17 & 17-35 & 35-70 & 70-140 & 140-280 & 280-560 & 560-1120 & 1120-2240 & \(>2240\) \\ \hline \end{tabular}
\end{table}
Table 1: Simulated dijet event samples used to study the performance of the jet trigger algorithms. The last row gives a summary of the cuts applied on the hard scatter parton in the event.

Figure 1: Schematic diagram of the L1 jet algorithm showing a window of \(4\times 4\) jet elements spanning the electromagnetic and hadronic calorimeter in depth, and a local maximum transverse energy cluster of \(2\times 2\) jet elements.

Figure 3: L1 jet transverse energy resolution as a function of truth jet transverse energy (a) and the L1 jet trigger efficiency as function of the offline reconstructed jet \(E_{T}\) for different L1 energy thresholds (b).

Figure 2: The L1 jet transverse energy scale as function of truth jet transverse energy (a) and pseudorapidity (b).

crossing. Simulated dijet events including this level of pile-up were generated. The effect of increased occupancy in the calorimeters will have some impact on the reconstructed transverse energy of the jet. Figure 4 shows the impact of this pile-up on the L1 jet transverse energy scale and jet trigger efficiency. The transverse energy scale increases due to the additional energy deposited in the calorimeter from pile-up events. The L1 transverse energy resolution also worsens as seen on Fig. 4(b). The effect is clearly more important for low energy jets where the contribution of pile-up energy can be of the same order of magnitude as the jet energy itself.

## 4 HLT jet algorithms

The HLT object reconstruction is guided by the result of the L1 system. HLT algorithms typically only access data from a limited region of the detector in the vicinity of an RoI provided by L1. The position of this RoI is successively updated and refined by the HLT algorithms.

HLT algorithms are classified in two types:

* "Feature Extraction algorithms": Algorithms that retrieve and unpack detector data and create simple classes composed of useful physics observables. These algorithms consume most of the available time.
* "Hypothesis algorithms": Algorithms that retrieve the physics information produced in the preceding Feature Extraction algorithms, and validate a specific hypothesis (e.g. \(E_{T}\) threshold). These algorithms have a very fast execution time.

This separation between Feature Extraction and Hypothesis algorithms optimises the overall execution time since the data retrieved by a single Feature Extraction algorithm can be used to provide input to several fast Hypothesis algorithms to test various physics signatures, and hence avoids multiple data access and unpacking.

Figure 5 shows a schematic diagram of the sequence of algorithms used to reconstruct jets in the HLT. The Hypothesis algorithms for jets reconstructed at L2 and EF compare the energy of the jet candidates to some predefined \(E_{T}\) thresholds. The next few sections describe in detail each Feature Extraction algorithm appearing in Fig. 5.

Figure 4: The L1 jet transverse energy scale as function of truth jet transverse energy (a) for simulated dijet events with pile-up. The L1 jet trigger efficiency as function of offline reconstructed jets (b) for a 35 GeV L1 trigger threshold, with and without taking into account pile-up.

## 5 L2 jet algorithm

Standard L2 jets are defined within the \(|\eta|<3.2\) region and are reconstructed using the electromagnetic and hadronic calorimeter data. Forward jets are defined within the range \(3.2<|\eta|<5\) and are reconstructed using data from the forward calorimeters. As described below, the forward jet reconstruction is different than the standard jet algorithm due to the limited \(\eta\) position resolution of L1 jets.

The output of the L2 Feature Extraction algorithm is a reconstructed jet with a given energy and position in \(\eta\) and \(\phi\). The algorithm contains three distinct parts described below: data preparation, jet finding and calibration.

### L2 jet data preparation

The data preparation for the L2 jet trigger is a critical part of the algorithm chain. It provides the collection of data from the detector readout drivers (ROD) to the L2 processing units and the conversion from the raw data into bytestream files readable by the HLT algorithms. The RODs receive data from the calorimeters front-end boards (FEB) via optical fibres. The FEBs are installed on the detector and contain the electronics for amplifying, shaping, sampling, pipelining, and digitising the signals [2, 3].

Figure 5: Schematic diagram of the sequence of algorithms used to reconstruct jets in the HLT. The ovals and diamonds represent Feature Extraction algorithms and Hypothesis algorithms, respectively.

The ATLAS calorimeters consist of more than \(10^{5}\) individual readout channels; therefore, in order to meet the L2 timing performance goals of 40 ms total processing time per event, the amount of data unpacked must be kept to a minimum while simultaneously maximising the physics performance of the algorithm.

The L2 jet trigger algorithm accesses calorimeter data that lies in a rectangular region centred around the L1 jet RoI position with a width \(\Delta\eta\) and \(\Delta\phi\) that can be defined to have any size. The widths \(\Delta\eta\) and \(\Delta\phi\) are parameters that are specified at trigger configuration time. Figure 6 shows a schematic diagram of the L2 jet reconstruction algorithm.

The position and transverse energy of each detector element that falls into the chosen (\(\Delta\eta\), \(\Delta\phi\)) window is read out by the algorithm. As a result the calorimeter read out region can be regarded as partitioned into a grid of elements with associated energies and \((\eta,\phi)\)-coordinates as shown in Fig. 6. Therefore, the amount of data accessed is equivalent to the number of grid elements.

Two different data unpacking approaches are implemented and described below. One of the methods, the cell-based approach, has finer granularity and hence produces more accurate energy and transverse energy reconstruction, but is more time consuming. The other method, the front-end board approach, is faster but the coarser granularity produces a less precise reconstruction. Both methods are, as we will see in section 6, reasonably within the L2 time budget limits. The final decision of what approach should be used will be made depending on the final High Level Trigger setup.

#### 5.1.1 The cell-based approach

This method uses the full granularity of the calorimeters [1]. Each grid element in Fig. 6 corresponds to a calorimeter cell with a given transverse energy and \((\eta,\phi)\)-coordinate provided by the ROD. In the following discussions, jets reconstructed using this data unpacking approach are referred to as "cell-based jets".

Figure 6: Schematic diagram summarising the L2 jet algorithm. The data unpacking step reads in the necessary calorimeter data within a predefined window size and defines a grid of calorimeter elements each with an associated energy and position. The size of grid elements depends on the calorimeter data unpacking method used. The dark (red) boxes in the diagram represent grid elements with substantial energy deposition. The algorithm is seeded by the L1 position as shown on the left. The final jet is found after a given number of iterations. The position of the jet is calculated as the energy weighted average of the grid elements position within a given cone size. The energy of the jet is calculated as the sum of the energy of each grid elements falling within the given cone size.

#### 5.1.2 The front-end board approach

This method uses a coarser granularity than the cell-based data unpacking. Instead of reading out every cell over a specified region of the liquid argon (LAr) calorimeters, only information from the LAr calorimeters front-end boards is used. There are 128 readout channels per FEB and two FEBs are connected to one ROD. For the tile calorimeter, the full cell granularity is still used.

In the RODs, the sums of the Cartesian components of the cell energies are calculated for each FEB:

\[E_{\mathrm{x}} = \sum_{\mathrm{i=1}}^{128}E_{\mathrm{i}}\frac{\cos\phi_{\mathrm{i} }}{\cosh\eta_{\mathrm{i}}} \tag{1}\] \[E_{\mathrm{y}} = \sum_{\mathrm{i=1}}^{128}E_{\mathrm{i}}\frac{\sin\phi_{\mathrm{i} }}{\cosh\eta_{\mathrm{i}}}\] (2) \[E_{\mathrm{z}} = \sum_{\mathrm{i=1}}^{128}E_{\mathrm{i}}\tanh\eta_{\mathrm{i}} \tag{3}\]

where \(E_{\mathrm{i}}\) is the energy and \(\phi_{\mathrm{i}}\), \(\eta_{\mathrm{i}}\) the position of each cell. This sum is computed per FEB and runs over all channels with an energy \(E_{\mathrm{i}}>2\cdot\sigma_{\mathrm{noise}}\). The noise cut value, which is a configuration parameter, has been determined from performance studies with QCD dijet events, such as to give the similar jet energy scale as obtained with the cell-based approach, which will be presented in the next section. The total energy of the cells connected to a FEB is then obtained from the quadratic sum of the three components, \(E_{\mathrm{tot}}=\sqrt{E_{\mathrm{x}}^{2}+E_{\mathrm{y}}^{2}+E_{\mathrm{z}}^ {2}}\). The corresponding \(\eta\) and \(\phi\) coordinates are calculated as

\[\eta=\mathrm{atanh}(E_{\mathrm{z}}/E_{\mathrm{tot}}),\]

\[\phi=\mathrm{atan2}(E_{\mathrm{y}}/E_{\mathrm{x}}),\]

where the function \(\mathrm{atan2}\) returns the angle \(\phi\in[-\pi,\pi]\). The resulting values for the energy and the (\(\eta\), \(\phi\))-coordinate are then used to define the grid of elements in a region around the L1 RoI position, as is illustrated in Fig. 6. In the following text, jets reconstructed using this data unpacking method are referred to as "FEB-based jets".

### L2 jet finding algorithm

Jets are defined as a cone-shaped object in the (\(\eta,\phi\))-space with a given radius \(\Delta R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\). The value \(\Delta R\) is a parameter of the algorithm that is defined at trigger configuration time. The jet energy and position are found through an iterative procedure with the following steps:

* The L1 jet RoI is used as a seed for the algorithm. A reference jet is created, labeled \(j_{0}\), defined by the L1 jet RoI position with the pre-defined cone radius \(\Delta R\) (see left-hand side of Fig. 6). Note that the possible positions of the reference jet \(j_{0}\) are discreet due to the L1 granularity.
* Grid elements that fall within the (\(\eta\), \(\phi\))-region encompassed by the reference jet \(j_{0}\) are used to recalculate the jet energy and position according to: \[\eta_{\mathrm{j_{i}}} = \frac{\sum_{\mathrm{i=1}}^{\mathrm{k}}E_{\mathrm{i}}\eta_{\mathrm{ i}}}{\sum_{\mathrm{i=1}}^{\mathrm{k}}E_{\mathrm{i}}},\] (4) \[\phi_{\mathrm{j_{i}}} = \frac{\sum_{\mathrm{i=1}}^{\mathrm{k}}E_{\mathrm{i}}\phi_{\mathrm{ i}}}{\sum_{\mathrm{i=1}}^{\mathrm{k}}E_{\mathrm{i}}}.\] (5)The sum runs over the \(k\) grid elements that are contained in the cone defined by the reference jet \(j_{0}\). A grid element is included in the sum if its centre falls within the region spanned by the cone radius \(\Delta R\). The total energy and coordinates (\(\eta_{\rm j_{1}}\), \(\phi_{\rm j_{1}}\)), computed in Equations (4) and (5), are used to define the new reference jet \(j_{1}\).
* The previous step is repeated with \(j_{0}\) replaced by \(j_{1}\) in Equations (4) and (5), which results in updated coordinates \(\eta_{\rm j_{2}}\) and \(\phi_{\rm j_{2}}\) to define the updated jet \(j_{2}\). This algorithm can be repeated N times to create jet \(j_{\rm N}\).
* A predetermined fixed number of iterations are executed. The energy of the final jet is calculated as the sum of the energy of all the grid elements falling within the cone radius. The position of the jet is obtained as the energy weighted average of the position of each grid elements within the cone, as shown in Fig. 6.

The outcome of this algorithm is a jet defined by its (\(\eta,\phi\)) position and total energy. The calorimeter energy scale, at this point, is set at the electromagnetic scale which does not provide an accurate measure of the jet energy. The next Section describes the calibration weights applied to correct the total jet energy for non-electromagnetic shower components.

### L2 jet calibration

The ATLAS calorimeter response to the electromagnetic component of a hadron shower is not equal to the response to the non-electromagnetic component. In general, the hadronic response (\(h\)) is smaller than the electromagnetic response (\(e\)),

\[e/h>1.\]

This effect is mainly due to the energy lost in the breakup of nuclei or in nuclear excitation. In order to correct for it, a weight is applied to each element that makes up a jet. Depending on the calibration method used, a jet can be regarded as composed, for example, of individual calorimeter cells or of energy deposits in calorimeter samplings. The calibrated jet energy can then be written as:

\[E_{\rm jet}^{\rm rec}=\sum_{\rm i=1}^{\rm n}w_{\rm i}E_{\rm i} \tag{6}\]

where the sum runs over the n constituents of the jet.

The weights \(w_{\rm i}\) in Equation (6) are extracted using simulated event samples by minimising the function:

\[S=\sum_{\rm m=1}^{\rm N_{\rm res}}\left[\frac{(E_{\rm m}^{\rm truth}-E_{\rm m} ^{\rm rec})}{\sigma_{\rm m}}\right]^{2} \tag{7}\]

The sum runs over all the jets in the events. The true energy of the m-th jet in the event is labeled \(E_{\rm m}^{\rm truth}\) and is obtained from the Monte Carlo (MC) truth information, running a cone jet algorithm with radius \(\Delta R=0.4\) over the MC truth particles and finding the truth jet that is closest to the m-th jet. A truth jet is made up of all particles generated, excluding neutrinos and muons which have their own observables, missing transverse energy for neutrinos and reconstructed tracks for muons. By minimising \(S\) with respect to the true jet energy, an improvement of the jet energy scale and resolution is obtained.

Different calibration methods can be applied, which differ in the partitioning of the jet energy into calorimeter components (e.g. cells, layers). The calibration method used here is the so-called sampling technique [4]. In this method, individual weights can be applied to the energy deposited in each of the electromagnetic (EM) and hadronic (HAD) calorimeter sampling layers. The energy dependence of the weights is chosen to be:\[w_{\rm i}=a+b\log(E). \tag{8}\]

In the implementation used for L2 jets, only two weights are calculated and applied to calibrate the reconstructed jet energy; one weight for the total energy deposited in the EM calorimeter, and one weight for the total energy deposited in the hadronic calorimeter. Furthermore, the \(\eta\) range is split in 32 bins with a size of 0.1 in the region \(0<|\eta|<3.2\). This procedure assumes an azimuthally symmetric response. This assumption will need to be validated with real data. A fit to Equation (8) is performed using the MINUIT2 package [5]. It yields the values of the two parameters of Equation (8) for each \(\eta\)-bin and for the electromagnetic and hadronic calorimeter sampling. The computed weights are then stored in a configuration file, which serves as input to the L2 jet algorithm that applies the weights to each identified jet.

### L2 jet parameters

In the configuration of the L2 jet trigger algorithm, the values of the following parameters need to be set:

* the data unpacking method: cell-based or FEB-based,
* the calorimeter window size \(\Delta\eta\) and \(\Delta\phi\), where data need to be unpacked,
* the radius of the cone \(\Delta R\) used in the jet finding algorithm,
* the number of iterations used in the jet finding algorithm,
* the calibration constants used.

A set of parameter values which yields the optimal balance between short execution times and adequate physics performance must be chosen.

## 6 L2 performance

The performance of the L2 jet algorithm was studied using the simulated dijet event samples described in Table 1.

The parameters used in the reconstruction of the L2 jets are summarised in Table 2. These parameters were found to be a good compromise between the physics performance (e.g., energy resolution and scale) and the algorithm execution time.

The first parameter studied was the number of iterations of the jet finding algorithm. The variation in the jet (\(\eta,\phi\)) coordinate and transverse energy after each iteration of the jet reconstruction algorithm is shown in Fig. 7. The largest variation in \(E_{T},\eta\) and \(\phi\) happens after the first iteration and thus it has the

\begin{table}
\begin{tabular}{|l c c|} \hline Parameter & Standard Jets & Forward Jets \\ \hline Number of iterations & 3 & 3 \\ Cone radius & 0.4/0.4/0.4 & 1/0.7/0.4 \\ \(\Delta\eta\) window size & 1.4 & \(3<|\eta|<5\) \\ \(\Delta\phi\) window size & 1.4 & 1.4 \\ \hline \end{tabular}
\end{table}
Table 2: Parameters used in the L2 jets reconstruction. The value of the cone size radius is defined for each iteration.

largest impact on the measurement precision. This suggests that the number of iterations could possibly even be reduced to 2 without losing too much precision on this measurement.

In order to study the effect of the window size used to unpack calorimeter data, the total time spent by the jet algorithm running with different sizes was studied. Windows with dimensions of \(1.0\times 1.0\) (in \(\eta\times\phi\)) and \(1.4\times 1.4\) were studied. A window size of \(1.0\times 1.0\) is only slightly larger than the diameter of a jet with \(\Delta R=0.4\). The maximum initial displacement of a jet with respect to a truth jet is approximately 0.2 in \(\Delta\eta\) or \(\Delta\phi\), as can be seen in Fig. 7. Therefore, a window size of \(1.0\times 1.0\) should be adequate for the jet reconstruction. The total time spent by the L2 jet algorithm for two different window size and using three iterations is shown in Fig. 8. A reduction of the window size from \(1.4\times 1.4\) to \(1.0\times 1.0\) results in a considerable reduction (of order 30%) in the processing time. As shown in the next section, the energy scale and resolution is not significantly affected by this reduction of the size of the window.

### Performance for cell-based reconstruction

The calibration constants used to reconstruct cell-based jets in L2 were extracted using dijet events simulated with pythia[6] and following the approach described in Section 5.3. The L2 jet transverse energy scale and resolution for cell-based jets after calibration are presented in Fig. 9. The transverse energy scale is defined as the L2 jet transverse energy divided by the truth jet \(E_{T}\). Truth jets are identified by applying the cone algorithm with \(R_{\rm cone}=0.4\) on the collection of truth final state particles. The transverse energy scale is close to unity for all the \(\eta\) coverage of the L2 jet trigger and all the transverse energies studied, demonstrating that the transverse energy is correctly measured within 2%. The jet transverse energy resolution decreases from 12% for the lowest transverse energies to 4% for transverse energies above 1000 GeV. The resolution curves were fitted with the following expression that includes a stochastic term convoluted with a constant term:

\[\frac{\sigma(E)}{E}=\frac{A}{\sqrt{E}}\oplus B \tag{9}\]

Table 3 shows the result of the fits for all the \(\eta\) bins, before and after calibration. A few percent improvement in the resolution is obtained with the current calibration method. A further improvement can be achieved in the future by exploiting the correlation between the fraction of electromagnetic energy and the calibration weights [7].

In another study, two different window sizes were used in order to study the effect on the jet energy scale and resolution. L2 jets were reconstructed using a window size of \(0.7\times 0.7\) (in \(\eta\times\phi\)) which was chosen to be slightly smaller than the jet cone diameter (\(2\times\Delta R=2\times 0.4=0.8\)) such that some of the energy of the jet may lie outside the window considered. Results were compared with the performance obtained using the window size dimension of \(1.4\times 1.4\). The jet energy calibration constants were calculated independently in both cases and the resulting jet energy scale and resolutions were compared. In

\begin{table}
\begin{tabular}{|c|c c|c c|} \hline \(\eta\) region & \multicolumn{2}{c|}{Before calibration} & \multicolumn{2}{c|}{After calibration} \\  & A & B & A & B \\ \hline (0.0,0.7) & 1.03 \(\pm\) 0.03 & 0.059 \(\pm\) 0.001 & 0.96 \(\pm\) 0.02 & 0.039 \(\pm\) 0.001 \\ (0.7,1.5) & 1.28 \(\pm\) 0.03 & 0.064 \(\pm\) 0.001 & 1.18 \(\pm\) 0.03 & 0.041 \(\pm\) 0.001 \\ (1.5,2.5) & 1.53 \(\pm\) 0.04 & 0.046 \(\pm\) 0.001 & 1.37 \(\pm\) 0.03 & 0.025 \(\pm\) 0.002 \\ (2.5,3.2) & 1.86 \(\pm\) 0.13 & 0.063 \(\pm\) 0.003 & 1.46 \(\pm\) 0.08 & 0.040 \(\pm\) 0.003 \\ \hline \end{tabular}
\end{table}
Table 3: Results of the jet energy resolution fit as a function of the truth jet energy, before and after applying the calibration. The fit was done using Equation (9).

Figure 7: Variation in the (a) transverse energy, (b) \(\phi\) position and (c) \(\eta\) position of jets as function of number of iterations performed by the L2 jet reconstruction algorithm. The area of the boxes is proportional to the number of entries in each bin.

Figure 8: Time spent by the L2 jet reconstruction algorithm for two different window sizes: \(1.4\times 1.4\) (dashed line) and \(1.0\times 1.0\) (solid line).

Figure 9: Jet energy scale for the L2 jets as a function of the truth jet \(E_{T}\) (a), for four different bins in \(\eta\). Jet energy resolution as a function of the truth energy of the jet (b), for four different bins in \(\eta\). These results are obtained after calibration.

both cases, the jet energy scale was found to be within 2% of unity. The resolution of the jets was also found to be similar for both window sizes. This means that the calibration algorithm can adequately correct for a small fraction of the jet energy lost outside the window considered. Therefore, using a window size of \(1.0\times 1.0\) will reduce processing time while keeping essentially the same physics performance as the larger window (\(1.4\times 1.4\)).

The jet energy measured in the calorimeter may be sensitive to the shower development and the hadronisation mechanism that was introduced in the MC simulation. In order to test the sensitivity of the calibration procedure to the simulation, a set of dijet event samples generated with herwig[8] was used. Calibration constants were extracted with the pythia dijet samples and used in the reconstruction of the herwig dijet events. The jet energy scale and resolution obtained in this way with the herwig data sample was compared, in different \(\eta\) regions and \(E_{T}\) values, with the one obtained for pythia. Figure 10 shows, as an example, such a comparison in one particular \(\eta\) region. Differences between the two generators were found to be smaller than 2%, for all regions of \(\eta\) and jet \(E_{T}\), suggesting that the L2 jet energy scale is relatively insensitive to the hadronisation model used in MC generators.

Figure 11 shows the L2 trigger efficiency as function of offline jet \(E_{T}\) after calibration has been applied for four different L2 thresholds. The L1 threshold of 15 GeV was chosen to be significantly smaller than that for L2 in order to avoid a mixture of resolution and jet energy scale effects from the two different trigger levels. The limited sharpness of the curves shown on Figure 11 is, therefore, dominated by the resolution of the L2 jet energy.

Initially, the detector simulation is not expected to provide an exact model of the real detector. The energy measurement will be mainly affected by an incomplete knowledge of the dead material distribution in front of the calorimeters. To study the effect that the limited knowledge of the detector geometry may have on the performance of the trigger and reconstruction algorithms, dedicated MC dijet event samples were produced. They were reconstructed with a geometry where detectors were slightly displaced from their nominal positions and extra dead material was added. This accounted for 7-10% of a radiation length in the inner detector and a few percent of one radiation length in front of the calorimeter. The knowledge of the dead material distribution is assumed to be worst at the interface between different calorimeter subsystems.

The calibration constants obtained assuming a perfect geometry were used to identify L2 jets in the misaligned samples. Hence, the resulting jet transverse energy scale and resolution can serve as an estimation of how much the performance of the L2 jet reconstruction may be degraded due to the limited knowledge of the detector geometry and dead material distribution at the beginning of the data

Figure 10: Comparison of the L2 jet energy scale and resolution obtained for two different MC generators, pythia ( blue circles) and herwig (red triangles), for jets in the region \(0<\eta<0.7\).

taking period. Figure 12 shows the jet transverse energy scale and resolution obtained for dijet events reconstructed with this mismatch of calibration constants. For most of the pseudo-rapidity region, the linearity with energy is within 3-4%, slightly worse than before. In the region (\(1.5<|\eta|<2.5\)) the jet energy scale drops to about 94% due to the extra dead material. The transverse energy resolution is also degraded, as shown in Table 4. The performance of the calibration at the beginning of data taking can be improved using in-situ calibration procedures used to extract the calibration constants directly from the data or to correct the detector response in the MC. Several different procedures are currently under study.

The reconstructed jet position is another parameter used to measure the algorithm performance. Currently no selection on jet position is made at the trigger level, but this may prove useful in the future for some physics channels. The position resolution is shown in Fig. 13. This figure is also included for completeness to compare with the FEB unpacking approach that uses a coarser granularity of data.

Figure 11: Trigger efficiency as function of offline jet transverse energy for L2 jets after calibration, for four different thresholds (35 GeV, 42 GeV, 70 GeV and 100 GeV). The statistical uncertainty on each point is smaller than the symbols.

Figure 12: Jet transverse energy scale for L2 jets as a function of the truth jet transverse energy (a), for four different \(\eta\) regions. Jet transverse energy resolution as a function of the truth jet transverse energy (b), for four different \(\eta\) regions. Both plots were obtained using dijet event samples reconstructed assuming a limited knowledge of the detector’s dead material distribution.

\begin{table}
\begin{tabular}{|l|c c|} \hline \(\eta\) region & \multicolumn{2}{c|}{After calibration} \\  & A & B \\ \hline (0.0,0.7) & 1.04 \(\pm\) 0.02 & 0.038 \(\pm\) 0.002 \\ (0.7,1.5) & 1.24 \(\pm\) 0.03 & 0.055 \(\pm\) 0.001 \\ (1.5,2.5) & 1.95 \(\pm\) 0.04 & 0.018 \(\pm\) 0.004 \\ (2.5,3.2) & 1.66 \(\pm\) 0.09 & 0.039 \(\pm\) 0.002 \\ \hline \end{tabular}
\end{table}
Table 4: Results of the jet energy resolution fit as a function of the truth jet energy for the event samples where a limited knowledge of the detector’s dead material is assumed. The fit was done assuming Equation (9).

Figure 13: The \(\eta\)-resolution (a) and \(\phi\)-resolution (b) of L2 cell-based jets with respect to the truth jet energy. The mean and standard deviation of a Gaussian fit of (a) is 0.0006 and 0.03, while the mean and standard deviation of a Gaussian fit of (b) is 0.00005 and 0.01.

### Performance for FEB-based reconstruction

Studies were done to evaluate the performance of the L2 jet reconstruction using the FEB-based method of data unpacking. For comparison with results presented in Fig. 12, dijet event samples that assume a limited knowledge of the detector dead material were used to study the transverse energy scale and resolution of FEB-based jets. The transverse energy of jets reconstructed using the FEB-based data unpacking approach was weighted using the default L2 calibration constants obtained using the cell-based method.

Figure 14 shows the jet transverse energy scale and resolution. The energy scale stays within 5% of unity for most of the pseudorapidity range. The transverse energy resolution distribution was fitted using Equation (9) and the results are presented in Table 5. The transverse energy resolution of FEB-based jets is comparable to that of cell-based jets presented in Table 3. The transverse energy scale and resolution of the FEB-based jets depend strongly on the energy cut-off introduced in Equation (3). It was found that using a cut-off at \(2\cdot\sigma_{\rm noise}\) gave the best result in terms of transverse energy scale and resolution.

Figure 15 shows the \(\eta\) and \(\phi\) resolution. These distributions were obtained from the difference between a L2 FEB-based jet and its nearest MC truth jet. These results are comparable with those obtained using the cell-based method as shown in Fig. 13.

The L2 trigger efficiency for different thresholds as function of reconstructed jet transverse energy for FEB-based jets is presented in Fig. 16. The initial slope of these efficiency curves is similar to the results obtained with the cell-based method shown in Fig. 11. This indicates that FEB-based jets have a selection efficiency that is comparable to the cell-based one. The FEB-based jet reconstruction significantly reduces the amount of data to be unpacked at L2 compared to the cell-based approach. The impact of the unpacking choice on the processing time of the jet reconstruction algorithm is presented in Section 6.4.

### Forward jets

The implementation of L2 forward jet reconstruction must consider constraints on the precision of the L1 forward jet RoI position. Since each L1 FCAL trigger tower spans the entire \(\eta\) range of the FCAL detector, a dedicated optimisation of the jet reconstruction algorithm is required. In order to properly account for the overlap region between the FCAL and endcap calorimeters, a window size of

Figure 14: (a) Jet energy scale for the L2 FEB-based jets as a function of the truth jet \(E_{T}\) for four different bins in \(\eta\). (b) Jet energy resolution as a function of the truth energy of the jet for four different bins in \(\eta\). Both plots were obtained using dijet event samples reconstructed assuming a limited knowledge of the detector’s dead material distribution.

Figure 16: L2 trigger efficiency as function of reconstructed jet transverse energy for FEB-based jets after calibration, for four different thresholds (35 GeV, 42 GeV, 70 GeV and 100 GeV).

\begin{table}
\begin{tabular}{|l|c|c|} \hline \(\eta\) region & \multicolumn{2}{c|}{After calibration} \\  & A & B \\ \hline (0.0,0.7) & 0.93 \(\pm\) 0.05 & 0.02\(\pm\) 0.01 \\ (0.7,1.5) & 1.18 \(\pm\) 0.05 & 0.03\(\pm\) 0.01 \\ (1.5,2.5) & 1.56 \(\pm\) 0.04 & 0.05\(\pm\) 0.01 \\ (2.5,3.2) & 1.93 \(\pm\) 0.01 & 0.01\(\pm\) 0.01 \\ \hline \end{tabular}
\end{table}
Table 5: Results of the jet energy resolution fit as a function of the truth jet energy for FEB-based jets after applying the default calibration constants obtained using the cell-based data unpacking method. The fit was performed assuming Equation (9).

Figure 15: The \(\eta\)-resolution (a) and \(\phi\)-resolution (b) of L2 FEB-based jets with respect to the truth jet energy. The mean and standard deviation of a Gaussian fit of (a) is 0.002 and 0.03, while the mean and standard deviation of a Gaussian fit of (b) is -0.00007 and 0.009.

\(|\eta|<5\) was chosen. The cone size (\(\Delta R\)) must also be modified in order to remove any bias from the initial L1 Rol seed position. Similar to the standard jet reconstruction, three iterations of the jet finding algorithm are performed. An initial cone size of \(\Delta R=1\) is used to collect sufficient data to remove the L1 bias. In the second and third iteration of the jet finding algorithm, the cone size is reduced to 0.7 and subsequently to 0.4. Calibration constants for forward jets are derived using the method described in Section 5.3.

The L2 forward jet trigger efficiency was determined with respect to truth jet. Reconstructed jets were matched to truth particle jets using the requirement that \(\Delta R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}<0.2\). In addition, truth jets were required to satisfy \(p_{T}\)\(>\)25GeV. Results from this study are presented in Table 6.

### L2 jet timing

The time budget of approximately 40 ms per event and the strong rejection power needed at the L2 trigger impose strong constraints on the L2 algorithms speed and physics performance.

During the commissioning of the ATLAS Trigger/DAQ system, dedicated Technical Runs are performed in order to test HLT algorithm performance. In these runs all the detector Read Out Systems (ROS) and the full Trigger/DAQ infrastructure are dedicated to exercising the data acquisition system and the trigger. Bytestream files2 containing a mixture of events close to that expected in LHC collisions (mainly QCD jets, mixed with a few \(Z\) and \(W\) decays to leptons, \(t\bar{t}\) events, etc.) are preloaded into the ROS. These events, which contain the RoIs obtained from the L1 simulation, are then processed by the HLT system. The measurements presented here were made during the Technical Run that took place in November 2007.

Footnote 2:)Files with the same format as the raw data that will come out of the ATLAS detector.

In order to compare the difference between the cell-based method and the FEB-based method, two data-collection runs were recorded, one with L2 jets reconstructed using the cell-based approach, and one with L2 jets reconstructed using the FEB-based method. The timing distributions obtained from the cell and the FEB-based methods are shown in Fig. 17(a). Both distributions have a similar shape with peaks corresponding to the number of RoIs per event. The FEB-based approach is however almost 50% faster than the cell-based method.

The distribution of the total processing time shown in Fig. 17(a) includes the data unpacking, jet finding algorithm and calibration, as well as the data collection time from the detector Read Out System (ROS) to the L2 processors, which is shown in Fig. 17(b). The data collection time contributes significantly to the total L2 processing time, about 30% for the cell-based method and about 50% for the FEB-based approach. A detailed description of the data preparation methods and performance can be found in [9].

The processing time distribution per RoI for the different steps involved in the L2 jet reconstruction are shown in Fig. 18(a) and (b) for the cell-based and FEB-based method, respectively. These measurements show that the algorithm execution time is dominated by the data unpacking step. The small features observed in the unpacking time distributions outside the main peak come from RoIs that point

\begin{table}
\begin{tabular}{|l|c|c|} \hline \multirow{2}{*}{Tagged Objects} & \multicolumn{2}{c|}{Data unpacking method} \\  & cell-based jets (\%) & FEB-based jets (\%) \\ \hline Highest \(p_{T}^{\mathrm{truth}}\) forward jets & 98\(\pm\)1 & 98\(\pm\)1 \\ All forward jets & 97\(\pm\)1 & 91\(\pm\)1 \\ \hline \end{tabular}
\end{table}
Table 6: L2 trigger efficiency for L2 forward jets with respect to truth jets with \(E_{T}>25\) GeV.

in regions where less data needs to be unpacked.

Timing measurements of the L2 forward jet algorithm were also performed. A comparison of the reconstruction time between cell-based and FEB-based jets is presented in Table 7. Due to the limited time available during dedicated Technical Runs, these measurements were obtained by running the L2 jet algorithms on offline computing resources rather than making use of the full Trigger/DAQ infrastructure. Although the absolute values of reconstruction time should only be taken as an approximate indication of the performance to be expected on the online trigger system, the relative comparison of each measurement is nevertheless informative. For example, although the L2 forward jet algorithm uses a larger \(\eta\times\phi\) window than the standard L2 jet algorithm, it requires less than 25% of the total time used to reconstruct standard L2 jets. This is due to the larger granularity of the forward calorimeter, as compared to the liquid Argon barrel and endcap calorimeters, which results in a smaller amount of data being unpacked on average.

Figure 17: The total processing time per event (a) for the L2 jet algorithm. The solid line is the processing time measured using the FEB-based method (mean 13 ms). The dashed line is the processing time measured using the cell-based method (mean 22 ms). The total data collection time per RoI (b) for both the cell-based and FEB-based data unpacking methods.

Figure 18: L2 jet algorithm processing time per jet RoI for the cell-based method (a) and FEB-based method (b). The total processing time is shown together with the execution time of the individual steps involved in the L2 jet reconstruction.

## 7 The event filter jet algorithms

The jet reconstruction in the Event Filter (EF) can be divided into two tasks: the input data preparation and the jet finding. These two tasks are carried out by algorithms used in the offline reconstruction but adapted to run in the online trigger environment. Once an EF jet has been identified, it is passed on to a Hypothesis algorithm which validates whether or not the reconstructed jet satisfies a predefined transverse energy threshold.

### Input data preparation

There are three calorimeter data preparation algorithms which, respectively, unpack the calorimeter cell information, build trigger towers and construct calorimeter clusters. The implementation of these data preparation algorithms in the EF has been adapted to allow the running of a subset of the algorithms thereby reducing computing time.

The first data preparation algorithm unpacks calorimeter cell information in a predefined window around the position of the jet found at L2. The size of the window where data needs to be unpacked is a parameter that can be adjusted and is configured at trigger initialisation. The energy of each calorimeter cell, at this point, is set at the EM scale [2, 3]. Although not currently used, this unpacking algorithm provides the ability to apply calibration weights to the energy of individual calorimeter cells.

The second data preparation algorithm performs the calorimeter tower reconstruction. A calorimeter tower is an array of calorimeter cells within an \((\Delta\eta,\Delta\phi)=(0.1,0.1)\) region. The EF calorimeter trigger towers granularity is four times finer than that of the L1. Calorimeter trigger towers are the inputs to the jet finding algorithm described in the next Section.

A third data preparation algorithm, currently being studied, is also available in the EF. This algorithm constructs three-dimensional calorimeter clusters instead of towers. These clusters can alternatively be used as input to the jet finding algorithm instead of calorimeter towers.

### Jet finding algorithm

The EF jet reconstruction uses the offline reconstruction algorithms [10] adapted for the EF. It takes as input any \(E_{T}\) ordered list of calorimeter objects (cells, towers or clusters). The jet reconstruction consists of the following steps:

* Removal of negative energy towers (or clusters) by combining them with adjacent ones. A list of proto-jets is also constructed using a simple pre-clustering algorithm.
* Removal of proto-jets with transverse energy smaller than a given threshold.
* Running of a jet finding algorithm (cone or fast \(\mathrm{K_{T}}\) algorithm [11]).
* Jet calibration

\begin{table}
\begin{tabular}{|l|c|c|} \hline \multirow{2}{*}{Tagged Objects} & \multicolumn{2}{c|}{Data unpacking method} \\  & cell-based jets & FEB-based jets \\ \hline Forward Jets & 0.9 & 0.5 \\ Standard Jets & 6.1 & 2.1 \\ \hline \end{tabular}
\end{table}
Table 7: Comparison of the average L2 jet reconstruction time between the standard and forward jet algorithms in units of ms. Different data unpacking methods are also compared.

* Removal of reconstructed jets below a given transverse energy

Many different parameters can be modified as part of the jet reconstruction. The parameters used for the configuration of the EF jet reconstruction are summarized in Table 8. Unless specified explicitly, performance studies described subsequently use this configuration.

All calibration methods available for the offline jet reconstruction can be used by the EF jet algorithm. The default method used in the EF is an "energy density"-based cell calibration described in details in [12].

## 8 Event filter performance

The performance and parameter optimisation of the EF jet reconstruction algorithms were made using the simulated dijet event samples summarised in Table 1.

The window size defining how much data is unpacked was chosen by studying the position difference between offline reconstructed jets and jets found by the L2 system. A distribution of the distance \(\Delta R=\sqrt{(\eta_{\mathrm{L2}}-\eta_{\mathrm{offline}})^{2}+(\phi_{\mathrm{ L2}}-\phi_{\mathrm{offline}})^{2}}\) is shown in Fig. 19. Most L2 jet RoI are well within \(\Delta R<0.2\) of offline reconstructed jets using a cone algorithm with \(\Delta R=0.7\). A window size of \(1.6\times 1.6\) in \(\eta\times\phi\) was therefore chosen to ensure that data is unpacked at the EF in a calorimeter region of sufficient size to reconstruct correctly a jet similar to an offline jet while ensuring complete overlap with the L1 RoI. Additional studies could include the optimization of a variable window size as function of the jet transverse energy as measured by L2.

\begin{table}
\begin{tabular}{|l|c|} \hline Parameter & Value \\ \hline Window size (\(\eta\times\phi\)) & \(1.6\times 1.6\) \\ Input objects & towers \\ Proto-jet \(E_{T}\) cut & \(E_{T}>2\) GeV \\ Jet finding algorithm & cone \\ Jet finding parameter & \(R_{\mathrm{cone}}=0.7\) \\ Calibration scheme & “Energy density”-based cell calibration \\ Final jet \(E_{T}\) cut & \(E_{T}>10\) GeV \\ \hline \end{tabular}
\end{table}
Table 8: Parameter values for the EF jet reconstruction.

The EF jet energy scale and resolution were assessed using the same technique as described in Section 6.1. The results are shown in Fig. 20 as a function of the truth jet \(E_{T}\). In general, the energy scale improves with increasing truth jet \(E_{T}\). For truth jet energies larger than 200 GeV, the EF jet energy scale is within 2% of unity. The limited window size within which the jet reconstruction takes place in the EF results in some energy leakage that is not corrected for by the offline calibration used in the EF. These results nevertheless suggest that offline calibration are adequate for use in the EF jet reconstruction.

The effect of pile-up corresponding to a luminosity of \(10^{33}\mathrm{s}^{-1}\mathrm{cm}^{-2}\) on the jet energy scale and resolution was also studied. Figure 21 shows a comparison of (a) the EF jet transverse energy scale and (b) the EF resolution for simulated dijet event samples with and without pile-up. The effect of pile-up on the overall energy scale is observed to be insignificant, however, a noticeably worse resolution is observed for events with pile-up. The effect is clearly more important for low jet energies where the contribution of pile-up energy can be comparable to the total jet energy.

The EF jet trigger efficiency as function of offline jet energy is shown in Fig. 22 for two different signatures. For an EF trigger threshold close to the L1 threshold, the trigger selection performance is limited by the L1 energy resolution. For EF trigger thresholds significantly higher than the L1 threshold, the excellent EF energy scale improves slightly the performance of the trigger selection as compared to the current L2 capability. These plots emphasize the importance of correctly optimizing the jet trigger thresholds used for each jet signature.

Figure 21: The EF jet transverse (a) energy scale (b) and resolution as a function of truth jet \(E_{T}\) for simulated dijet event samples with and without pile-up.

Figure 20: The EF jet transverse energy scale (a) and resolution (b) as function of truth jet \(E_{T}\).

### Event filter jet algorithm timing

The timing performance of the EF jet reconstruction algorithm has been measured in the November 2007 Technical run described in Section 6.4. Figure 23(a) shows the execution time per RoI for the two EF data preparation steps: the unpacking of calorimeter cell data and the construction of calorimeter towers used by the jet algorithm. Figure 23(b) shows the execution time of the different steps involved in the jet reconstruction described in Section 7.2. The EF jet reconstruction total time per RoI is of order 100 ms. Assuming approximately 4 to 5 jet RoI per event implies a total processing time of order half a second per event which falls within the design budget of approximately one second per event.

## 9 Jet trigger menu

Jet triggers will be used to record many different types of events. Single and multi-jet signatures will identify useful events for various Standard Model QCD measurements. This event sample will also be valuable to study the properties of background events for other analyses and to measure the misidentification efficiency of different offline reconstruction algorithms. Jet trigger requirements are also important when combined with other trigger criteria to identify rare signal events with well-defined topologies.

Figure 23: Execution time per RoI for different steps in the EF data preparation (a) and the jet reconstruction (b).

Figure 22: EF trigger efficiency as function of offline jet transverse energy for two different signatures consisting of a set of L1, L2 and EF trigger thresholds: (a) \(E_{T}^{\rm L1}>10\) GeV, \(E_{T}^{\rm L2}>30\) GeV, \(E_{T}^{\rm EF}>50\) GeV; and (b) \(E_{T}^{\rm L1}>70\) GeV, \(E_{T}^{\rm L2}>150\) GeV, \(E_{T}^{\rm EF}>255\) GeV.

The trigger strategy adopted is to define a set of single and multi-jet signatures that, together, will select events with approximately uniform rates over the entire jet energy spectrum. Table 9 shows the set of L1 single and multi-jet signatures and associated L1 prescale factors optimised for this purpose, assuming an initial luminosity of 10\({}^{31}\) cm\({}^{-2}\)s\({}^{-1}\). The trigger rates were calculated using close to 7 million simulated non-diffractive inelastic events, with an estimated cross-section of 70 mb. These large simulated event samples result in a statistical uncertainty of approximately 0.1 Hz for the rates of unprescaled triggers. Note that a maximum of 8 different jet thresholds can be defined in the L1 system. The L1 thresholds and prescale factors for the single-jet signatures were chosen to significantly limit the L1 output event rate thereby initially avoiding the need to use the HLT at the beginning of data-taking. The L1 jet trigger menu was also designed to be compatible with a luminosity of up to 10\({}^{32}\) cm\({}^{-2}\)s\({}^{-1}\) without any changes. Figure 24 shows the differential distribution for the number of events selected by the L1 trigger menu as function of offline reconstructed jet transverse energy for 1 fb\({}^{-1}\) of recorded data.

For commissioning purposes, it is foreseen that the L2 and EF jet algorithms will be initially run for the single-jet signatures in so-called pass-through mode where the result of the HLT selection is recorded with the event data but no events are rejected based on the result of the algorithm selection. The rate of the multi-jet signatures listed in Table 9 will be reduced by using L2 and EF jet requirements. Table 10 summaries the expected rate out of the HLT for all jet signatures foreseen to be run at the beginning of data-taking. In addition to the single and multi-jet signatures discussed above, forward jets signatures are also foreseen. These are also shown in Table 10.

It should be noted that, due to the very large prescales used for the lower threshold jet triggers, the overlap between individual triggers is greatly reduced. This implies that the cumulative rates will rapidly grow, as can be observed in Table 10. The total rate of the entire jet menu has been approximated to be

Figure 24: Differential number of events selected as function of the offline reconstructed transverse energy of the leading jet in the event for 1 fb\({}^{-1}\) of data. The dashed and solid lines show the expected distributions before and after applying the L1 jet trigger menu criteria described in Table 9.

\begin{table}
\begin{tabular}{|l||c|c|c|c|c|c|c|c||c|c|c|c|c|} \hline
**Trigger threshold** & J5 & J10 & J18 & J23 & J35 & J42 & J70 & J120 & 3J10 & 3J18 & 4J10 & 4J18 & 4J23 \\ \hline \hline Prescale factor & 300000 & 42000 & 6000 & 2000 & 500 & 100 & 15 & 1 & 150 & 1 & 30 & 1 & 1 \\ \hline Level 1 rate (Hz) & 1 & 4 & 1 & 1 & 1 & 4 & 4 & 8 & 40 & 140 & 40 & 20 & 8 \\ \hline \end{tabular}
\end{table}
Table 9: Summary of the L1 single-jet and multi-jet triggers optimised for the initial data taking period. The L1 prescale factors and expected rate at a luminosity of 10\({}^{31}\)cm\({}^{-2}\)s\({}^{-1}\) for each threshold are also presented.

\begin{table}
\begin{tabular}{|l|l||c c|c c|} \hline  & \multicolumn{2}{c||}{**Overall**} & \multicolumn{2}{c|}{**Cumulative**} \\
**Trigger** & **Prescale** & \multicolumn{2}{c|}{**Rate (Hz)**} & \multicolumn{2}{c|}{**Rate (Hz)**} \\ \hline \hline
4j23 & 1 & 6.9 & (\(\pm\) 0.8) & 6.9 & (\(\pm\) 0.8) \\
4j18 & 100 & 0.14 & (\(\pm\) 0.01) & 7.0 & (\(\pm\) 0.6) \\
4j10 & 300 & 0.045 & (\(\pm\) 0.004) & 7.0 & (\(\pm\) 0.6) \\
3j18 & 100 & 0.92 & (\(\pm\) 0.03) & 7.9 & (\(\pm\) 0.3) \\
3j10 & 1500 & 0.061 & (\(\pm\) 0.002) & 7.9 & (\(\pm\) 0.2) \\ \hline Total Multi-Jets & \multicolumn{2}{c|}{7.9} & \multicolumn{2}{c|}{(\(\pm\) 0.2)} \\ \hline \hline j120 & 1 & 8.7 & (\(\pm\) 0.9) & 15.3 & (\(\pm\) 0.5) \\ j70 & 15 & 4.2 & (\(\pm\) 0.2) & 18.7 & (\(\pm\) 0.5) \\ j42 & 100 & 3.73 & (\(\pm\) 0.06) & 22.3 & (\(\pm\) 0.3) \\ j35 & 500 & 1.37 & (\(\pm\) 0.02) & 23.6 & (\(\pm\) 0.3) \\ j23 & 2000 & 1.37 & (\(\pm\) 0.008) & 24.9 & (\(\pm\) 0.2) \\ j18 & 6000 & 1.02 & (\(\pm\) 0.004) & 26.0 & (\(\pm\) 0.1) \\ j10 & 42000 & 3.9 & (\(\pm\) 0.003) & 29.9 & (\(\pm\) 0.02) \\ j5 & 300000 & 0.9470 & (\(\pm\) 0.0004) & 30.8 & (\(\pm\) 0.01) \\ \hline Total Single-Jets & \multicolumn{2}{c|}{24.40} & \multicolumn{2}{c|}{(\(\pm\) 0.01)} \\ \hline \hline
2fj70 & 1 & 0 & & 30.8 & (\(\pm\) 0.01) \\
2fj35 & 1 & 1.7 & (\(\pm\) 0.4) & 32.5 & (\(\pm\) 0.01) \\
2fj18 & 100 & 0.94 & (\(\pm\) 0.03) & 33.4 & (\(\pm\) 0.01) \\ \hline Total Multi-Fjets & \multicolumn{2}{c|}{2.65} & \multicolumn{2}{c|}{(\(\pm\) 0.09)} \\ \hline \hline fj120 & 1 & 0.9 & (\(\pm\) 0.3) & 34.1 & (\(\pm\) 0.01) \\ fj70 & 20 & 1.16 & (\(\pm\) 0.08) & 35.2 & (\(\pm\) 0.01) \\ fj35 & 700 & 0.68 & (\(\pm\) 0.01) & 35.8 & (\(\pm\) 0.01) \\ fj18 & 7000 & 1.04 & (\(\pm\) 0.004) & 36.9 & (\(\pm\) 0.02) \\ \hline Total Single-Fjets & \multicolumn{2}{c|}{3.74} & \multicolumn{2}{c|}{(\(\pm\) 0.01)} \\ \hline \end{tabular}
\end{table}
Table 10: Estimated trigger rates for jet signatures foreseen at the beginning of data-taking with a luminosity of \(10^{31}\) cm\({}^{-2}\)s\({}^{-1}\).

37 Hz, which represents a little over 18% of the overall trigger output rate budget of 200 Hz.

## 10 Summary

A detailed description of the algorithms used to reconstruct jets in the L1, L2 and Event Filter was presented. The performance of each of these algorithms was shown. The physics performance and algorithm timing has been shown to be within the design targets. Nevertheless, optimisation studies to further improve the performance of these algorithms are ongoing. An example trigger menu for jet signatures proposed for the beginning of data-taking was presented. The overall trigger strategy for selecting events based on jet signatures was also described.

## References

* [1] R. Achenbach _et al._, The ATLAS Level-1 Calorimeter Trigger, ATL-DAQ-PUB-2008-001 (2008).
* [2] ATLAS Collaboration, Liquid Argon Calorimeter Technical Design Report, CERN/LHCC/96-041 (1996).
* [3] ATLAS Collaboration, Tile Calorimeter Technical Design Report, CERN/LHCC/96-042 (1996).
* [4] A. Gupta, M. Wood, Jet Energy Calibration in the ATLAS detector using DC1 samples, CERN-ATL-COM-CAL-2005-002 (2005).
* A System For Function Minimization And Analysis Of The Parameter Errors And Correlations, Comput. Phys. Commun. **10** (1975) 343.
* [6] T. Sjostrand, L. Lonnblad, S. Mrenna and P. Skands, PYTHIA 6.3: Physics and manual, arXiv:hep-ph/0308153.
* [7] A. Gupta, F. Merritt and J. Proudfoot, Jet Energy Correction Using Longitudinal Weighting. CERN-ATL-COM-PHY-2006-062 (2006).
* [8] G. Corcella, I.G. Knowles, G. Marchesini, S. Moretti, K. Odagiri, P. Richardson, M.H. Seymour and B.R. Webber, HERWIG 6.5, JHEP 0101 (2001) 010.
* [9] ATLAS Collaboration, Data Preparation for the High-Level Trigger Calorimeter Algorithms, this volume.
* [10] ATLAS Collaboration, Jet Reconstruction Performance, this volume.
* [11] S.D. Ellis and D. Soper, Phys. Rev. **D48**, 3160 (1993).
* [12] ATLAS Collaboration, Detector Level Jet Corrections, this volume.