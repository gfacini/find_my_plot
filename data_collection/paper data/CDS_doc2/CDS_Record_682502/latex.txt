**SCT module testing system**

**at Charles University in Prague**

Zdenka Broklova1, Jan Broz, Zdenek Dolezal, Peter Kodys,

Petr Kubik, Pavel Reznicek

Footnote 1: Zdenka.Broklova@matfyz.cz

Institute of Particle and Nuclear Physics,

Charles University, Prague

**Abstract**

Detector control system (DCS) is built up to ensure adequate environment conditions during mass testing of silicon strip modules for ATLAS Inner Detector. DCS protects modules against damage and simplifies the whole testing procedure as well. In the automatic mode, the system measures several environmental parameters and checks them. In case of accident or unexpected situation, it alerts operator of the system (for example via email). It can safely stop all testing. The system also contains components for remote observation plus control of the testing status.

## 1 Introduction

A Semiconductor Tracker is a part of the Inner Detector of ATLAS. It will be composed of modules based on silicon detectors. The mass production of the endcap modules started recently. Metrology and electrical functionality of each module will be tested very thoroughly [1]. The Charles University at Prague (Institute of Particle and Nuclear Physics) is one of the institutes that are preparing the testing procedure (for about 200 ATLAS SCT endcap middle modules). The whole procedure and parameters indicating that the module is good are given.

Data aquisition (DAQ) hardware and software for module electrical testing are the same for all testing laboratories. On the other hand, system of the environmental control (DCS - Detector Control System) may differ. It depends on every laboratory equipment and experience. DCS must protect modules from damage and must provide required environment conditions. Detaileddescription of the whole DCS is in [2]. Beside this, there are some other supporting programs taken from collaborating institutes and adapted for our setup: automatic HTML generation using Perl scripts [3], programs for uploading results to the SCT production database and for preparing reports and statistics [4].

One of the goals is to prepare a flexible system built up of smaller components. It provides adaptability for new improvements of the procedure and also possible changes during the mass testing. More information is available at Prague CU laboratory web page [5].

## 2 Electrical test in Prague

Only second part of the whole QA sequence takes place in Prague CU laboratory. The testing sequence realized in Prague consists of three parts: the reception test (visualization and basic electrical confirmation), 24-hour long term stability test and final characterization.

Prague is responsible for electrical tests of modules and final verification of required module properties before moving to storage in NIKHEF Amsterdam and in next mounting to sector SCT.

## 3 DAQ system

DAQ system is a standard SCT module readout system (fig. 1, right) which consists of several VME cards (Mustard, SLOG, CLOAC, SCT LV3, SCT HV, AERO), with a PC interface (NI PCI-VME) [6]. Program for data acquisition SCTDAQ [7] runs under Windows 2000 and provides management for all electrical tests as well as creation of the test results report suitable for automatic upload to the SCT database [8]. The software consists of libraries (compiled in MSVC++) and macros running in ROOT [9] - C++ based data analysis framework. Minimal duration of one module electrical stability and characterization testing is more than 24 hours. Safety of the modules and required conditions must be assured during this time.

## 4 DCS system

### Hardware description

The scheme of the whole setup is displayed at fig. 2. It shows necessary power and data cables. There are two computers. Both run on Windows 2000 platform and are connected via data switch to outer network. The ethernet connection via data switch remains operational also in case of the institute network breakdown (i.e. because of power cut).

Modules are tested in the clean room (class 10.000, fig. 1, left). There is a standard temperature and humidity monitoring and logging system in the clean room. DAQ system is in the same room as \(\beta\)-source test and laser test setup. The largest part of the detector control system is located in the grey room (fig. 3). Thus DAQ and DCS are physically separated.

Detector control system sets and monitors environmental parameters for module testing. It is controlled independently by DAQ software, however, both systems communicate via shared disk files. This allows the system proceed an automatic safe shutdown of module testing procedure (detector bias voltage ramp down, hybrid low voltages off, etc.) whenever the required environmental conditions (temperature, humidity) are not met, or if there was a power cut.

**Test-box**

In the clean room there is 6-module test-box (designed and built by CTU in Prague) [10] with 6 Valencia module boxes in (see fig. 4). It

Figure 1: Clean room and detail of readout systemcontains dry air and coolant manifold. In this box there is humidity and temperature sensor NH232 (COMET System [11]) connected to DCS computer via RS232 serial port.
**Cooling**: Chiller Julabo F34-MD [12] assures keeping defined working temperature. A non-freezing alcohol based mixture is used as a coolant. This equipment can be operated by manual panel or remotely by computer which is connected via RS232 serial port. In DCS, chiller is switched to remote control and DCS computer sets its working temperature, switches on/off circulator and reads coolant temperature. Chiller error messages are also sent to computer which assures that the system will react correctly.

The system checks the coolant temperature in two ways - directly in chiller (to make sure that chiller works properly, cooling down was finished, etc.) and using other sensor on the coolant outlet from the test-box. This sensor (Ni1000 COMET System [11]) converts measured

Figure 2: Basic scheme of Prague DAQ and DCS setup

temperature to an electrical current and is connected to National Instrument AD card (PCI-6023E) in DCS computer.
**Dry air system**: Because of the requirement of low humidity and dew point during testing sequence, the module boxes and 6-module test-box are being flushed with dry air. Dry air system consists of oil free compressor Schneider Profimaster 200-25, HIROSS HFN005S super fine filter and HIROSS condensation dryer Starlette SGB002 [13]. It is not possible to connect this equipment to computer, so it must be set by operator manually. DCS monitors incoming air overpressure (sensor Cressto TMG 238 N47 [14] connected to AD card). Appropriate value indicates that dry air system works properly.
**Independent temperature sensor**: The test-box must be closed carefully before testing. There is one more temperature sensor (standard digital thermometer) inside, not dependent on any other devices (including power supply). In case of accident this sensor informs operator about conditions in the test-box and that the test-box might be opened.
**Power backup and checking**: System includes two power backup batteries (UPS) - one for each computer with other instruments (Back-UPS CS 500 for DCS computer, ethernet data switch and sensors, Smart UPS 1000 for DAQ computer

Figure 3: Grey room and detail of DCS system

and VME crate with testing electronics, [15]). Power supply is continuously being checked by measuring the voltage on an external power source connected to National Instruments (NI) AD card in DCS PC). In case of power supply failure DCS computer sends a signal to DAQ PC which cause the measuring to stop. The UPS capacity is great enough to supply the whole system in full operation for more than half an hour. The chiller circulator is unable to be connected to UPS, so in case of power problem, there is no active cooling. Passive module cooling is safe only for few minutes.

The table 1 summarizes monitored environment parameters. There is some additional hardware equipment including light alarm or internal faxmodem enabling emergency phone calling. The whole DCS setup is more clearly shown at fig. 2.

### Software - brief overview

One main plus several supporting applications were prepared for DCS. The main program is called DCS monitor. It measures and analyzes all environmental parameters and initiates other programs, which for example provide sending emergency messages to an operator, updating the web page or data backuping. DCS monitor also decides about DAQ system shutting down in case of problem. All tasks that need multiprocessing are solved via executing independent programs. Communication between programs (including SCTDAQ) goes through flag or text files.

Figure 4: Test-box – interior (left) and cooling and dry air manifold detail (right)

Another program - DCS config - is nearly independent of previous ones. It takes care about all config files with default parameters. It is not necessary, because all config files can be edited in any text editor but we find this very helpful.

LabWindows/CVI from National Instruments [16] was used as a main developing environment. It simplifies the graphic user interface programming and communication with sensors or other instruments.

The whole system uses three freeware programs - pscp ([17], for file upload via ssh protocol), gzip ([18], for postscipt file compression) and VNC ([19], for partial remote control).

### Standard operation mode

Before starting any operation in DCS monitor, the operator must log in the system using his/her name and password. After this, the main panel (see fig. 5) appears on a screen. In the upper left corner there are buttons for managing the whole program (start/stop monitoring, change operation mode, changing setting, etc.) Measured values and checked conditions are displayed on corresponding indicators, placed in the right upper corner of the panel. Also hybrid temperatures are indicated there. These values are taken from the SCTDAQ (see 4.5 for details). Problems or unexpected events are signalled with red LEDs which are also placed there.

Each operator's automatic action and all measured parameters are written to logbook. The logbook is a common text file. Every record is labelled by internal code (used by macro DCS history for creating history plot), date

\begin{table}
\begin{tabular}{|l|l|l|} \hline
**parameter** & **shortcut** & **method** \\ \hline test-box inner temperature & Tin & sensor NH232 via RS232 \\ \hline test-box inner humidity & H & NH232 sensor via RS232 \\ \hline outgoing coolant temperature & Tout & sensor connected to NI card \\ \hline incoming dry air overpressure & Dp & sensor connected to NI card \\ \hline coolant temperature in chiller & Tjul & RS232 \\ \hline power supply & & power source connected to NI card \\ \hline  & & semaphore files on shared discs, \\ connection between computers & & time flag indicate correct running \\  & & of DCSmonitor program \\ \hline \end{tabular}
\end{table}
Table 1: Monitored parametersand time of record. Records from different days are stored in separate files and they are located in logbook subdirectory of main DCS directory.

After operator logges into the system, he/she can choose the predefined setting or make necessarily changes in it. Panel with all parameters can be called up with the button View setting (fig. 8). There are two limits for each monitored parameter - warning and critical. If the value is out of warning limit the system sends an emergency message (more in section 4.4) to the operator but this situation has no effect on testing. This feature can be used also as a message service. When any parameter exceeds critical range the testing is immediately but safely shut down (high voltage is ramped down, power is switched off). A message to operator is sent too. Also frequencies of measurements, data backuping and web page refreshes as well as chiller parameters can be set on the same panel. If some setting changes are made, the setting file must be reloaded (by Reload setting button on the main panel) to affect system behaviour.

After all parameters are set and all devices are switched on, it is possible to start monitoring. Except for measure regime there is a simulation regime which can be used to prepare the whole system when the hardware is not built up. After pressing the start button all automatic services are initialized. Flag file with actual time is being continuously updated to enable SCTDAQ to recognize wheather DCS monitor works correctly.

There are two modes of monitoring - manual and automatic. In manual mode DCS has no effect on testing and no alarm messages are sent in case of a problem. Problems are indicated on the panel only. Automatic environment

Figure 5: Screen shot of panel (left) and graph panel (right) of DCS monitor

checking and message sending are available only in the automatic mode. Operator can start this mode by pressing button on panel. Moreover, if the operator is not proceeding any command, the system goes to the automatic mode after several minutes by itself. This mode substitutes operator presence at testing place during very long testing procedures.

In automatic mode almost all buttons on panel are inactivated to protect the whole system against accidental action of trespasser person. Before switching back to manual mode operator must enter his/her login name and password again. Two buttons in the right lower corner of the main panel are active persistently. They are designed for immediate sending message to operator and for test stopping in case of an accident.

### DCS services

For easy inspection of measured parameters history (kept in the memory) there is a panel with recent history graphs. This panel can be displayed by pressing button (Show graphs) on the main panel. The macro converting logbook text to graphs is now in development (this will allow viewing finished measurement).

Data files created by SCTDAQ can be automatically backuped on DCS computer and DCS files are backuped on DAQ computer. It prevents data loss in case of disk crash. Data disks of both computers are shared and main directory of DCS or DAQ computers are mirrored. Technically this is solved by recursive back-tracking of directory structure and copying files which have changed. Number of copied files and free space on disks are written into logbook. In addition, it is possible to copy files from SCTDAQ to linux PC so they are easily available for other people. Program pscp is used for this purpose. It enables data transfer via ssh protocol. In both cases, postscript files are compressed by using gzip. Independent executable programs execute these time consuming tasks so the environment monitoring is never stopped. The main program DCS monitor runs them periodically according to the setting.

Operator can observe system status on regularly refreshed web page. The page contains: DCS main panel and graph panel, config files, logbooks and module result files (current plus two days old), longterm test postscipt file and DCS information from SCTDAQ. The program DCS monitor saves main panel and graph panel as bitmap images and calls WWWRefresh, one of small programs. It checks for required files, collect them, constructs the HTML code of the web page according to present files and config files contents. Thenit uploads them using pscp to web server. Screenshot of this web page is at fig. 6.

As a complement, partial remote control via VNC is enabled. It is very useful not only for a real remote control (from other building for example) but it also enables operator to control DCS from clean room. Thus the operator does not have to go out of the clean room and change a suit.

In case of any problem or unexpected situation the system alerts operator via light alarm, email, SMS, phone call. Light alarm is connected to a digital output on NI card in DCS PC. This is the only alarm that turns on even thout the system is in manual mode. The rest is activated only in automatic mode. Mail sending is provided by one of small programs also. It connects

Figure 6: DCS online monitoring web page

to mail server using TCP protocol and goes through the dialog according to SMTP protocol [20].

### Necessary changes in standard SCT DAQ

To ensure safe operation of the module tests, standard SCTDAQ must be able to react on DCS events. For this purpose, several macros were added and slight modifications were made on the SCTDAQ software. Because the DCS and DAQ run on different computers, communication is made through flag files in shared directories.

The basic feature, ensured by additional macro in SCTDAQ, is to check, whether the program on (or connection to) the other computer is running. The signal that everything runs correctly is a pair (DCS and SCTDAQ) of periodically refreshing files containing the time of last regeneration. If the SCTDAQ finds the times difference greater then acceptable range, DCS (or connection) is considered to be out of order and as a consequence the bias voltage is ramped down, low voltages are switched off and the SCTDAQ is closed.

Analogically, if the DCS finds some possibly dangerous conditions, a flag is set in a file periodically checked by the DAQ software. Depending on the seriousness of the situation, the DAQ is stopped or safely shut down.

To complete the DCS-DAQ chain, SCTDAQ was modified to write out the standard module control system information (hybrid temperature and power, detector voltage and current) into a file read by DCS.

To automatize the test results visualization, modified Perl-scrips ([3], [21]) were added to the SCTDAQ macros. The scripts generate HTML pages containing all the test results.

### Program DCS config

The program DCS config (fig. 7 left) takes care of the text config files. All config files are placed in the subdirectory called config. We can divide them into three different groups. In the first group there are files with global parameters like serial port parameters (for correct chiller and sensor connection), NI card setting, paths to main parts of both systems, necessary values for connection to mail and web server, etc. One of the corresponding panels is displayed on fig. 7 (right). The second group of config files is composed of files with different measurement setting (panel is shown on fig.

8 right, particular parameters have been described above). Last group of config files contain operator's individual setting (fig. 8 left). Everyone can set own email address, phone number and also password there. To make our system more safe we encrypt all passwords before saving them in the config files. So password changing is possible only with DCS config application.

## 5 Tests of functionality, stability

and reliability

During the past six month, the DCS system has been running continually for several hundred hours at the lowest cooling temperatures. Several modules, including two pre-qualification modules, were tested under defined conditions including long-term tests with testing one or more modules together. The system reactions were appropriate also in unpredicted situations, such as the switch off of DCS computer during the measurement (mistake of the operator), decrease of coolant level and the chiller switch off after the temperature decrease to -23\({}^{\circ}\)C.

The measured humidity was held constantly under the dew point also at -23\({}^{\circ}\)C, and there has not been observed any condensation either inside the test-box or on unpowered or unbiased modules. The temperature of the outer test-box surface during cooling to -23\({}^{\circ}\)C was similar to the clean room temperature, and therefore the thermo-isolation properties of the test-box are satisfactory. Manipulations inside the box (e.g. replacing a cable, visual

Figure 7: Main panel of DCS config (left) and panel for global parameters changing (right)

inspections) are possible and do not increase humidity over dew point at the given temperature.

The system reaches required temperature 10\({}^{\circ}\)C on the powered hybrid (i.e. about -15\({}^{\circ}\)C coolant temperature) in several hours. The cooling effectiveness of the whole system also proved to be satisfactory for 6 thermal dummy modules. The cooling time in this case did not increase significantly because the thermal capacity of the whole system is what influences the cooling speed the most.

Temperature variations in clean room between 19\(-\)23\({}^{\circ}\)C, and humidity changes between 25\(-\)85% (possible testing range) have no influence on the conditions inside the test-box.

Sending email, SMS emergency and warning messages has been tested several times.

Details of these tests could be found in [2].

## 6 Outlook

We have to find appropriate setting of our system to reach correct reaction on various accidents. Enabling phone emergency calls is another important

Figure 8: Panel with operator’s setting (left) and panel for measuring parameters changing (right) – this panel is available from both DCS monitor and DCS config

task. We expect that we will have to make some changes on our system and tune the system behaviour under the boundary conditions during the first few weeks of mass testing but due to the system modularity no principle modifications are expected.

## 7 Conclusion

We have tested stability of the whole system and its reaction to unexpected situations (simulating accidents, e.g. power cut or cooling problems). System recognized these situations correctly in a short time and reacted appropriately to chosen setting. Based on the test results we performed we believe that our module QA system is ready for production modules testing.

## Acknowledgment

The authors wish to express their thanks to Peter W. Phillips for his instant asistence with SCTDAQ and to Michael Solar for his help with setting the system up.

## References

* [1]Dolezal, Z.: _The Quality Assurance of the ATLAS SCT Endcap Detector Modules_. Internal ATLAS Note ATL-IS-QA-0004, 2002 <[http://www-ucjf.troja.mff.cuni.cz/](http://www-ucjf.troja.mff.cuni.cz/) sct/QA/docs/module_FDR_QAv8.pdf>
* [2]Broklova, Z.: _Vyhodnoecniucinnosti a kvality polovodicovych stripovych detektoru pro detektor ATLAS LHC CERN_), diploma thesis, supervisor P. Kodys, 2003 (in czech)
* [3]Charlton, D.: _Electrical test result archival_ <[http://www.ep.ph.bham.ac.uk/exp/ATLAS/sct/elec_results.html](http://www.ep.ph.bham.ac.uk/exp/ATLAS/sct/elec_results.html)>
* statistics of production and metrology_ : [http://m.home.cern.ch/m/moed/www/sct_stat.html](http://m.home.cern.ch/m/moed/www/sct_stat.html)>
* Production_ <[http://www-ucjf.troja.mff.cuni.cz/](http://www-ucjf.troja.mff.cuni.cz/) sct/prod/>
* [6]Eklund, L. et al.: _ATLAS SCT Module/Hybrid Test DAQ_ <[http://atlas.web.cern.ch/Atlas/GROUPS/INNER_DETECTOR/SCT/testdaq/](http://atlas.web.cern.ch/Atlas/GROUPS/INNER_DETECTOR/SCT/testdaq/)>