Performance of ATLAS Pixel Detector and Track Reconstruction at the start of Run 3 in LHC Collisions at \(\sqrt{s}=\) 900 GeV

The ATLAS Collaboration

This note presents a first characterisation of the response of the ATLAS Pixel detector and of track reconstruction obtained from the analysis of 900 GeV \(pp\) collisions recorded by the ATLAS detector at the LHC in June 2022 at the start of Run 3. Data are compared to two sets of simulation, accounting or not for non-ionising radiation damage to the pixel detector sensors. Some projections of the expected pixel detector performance throughout LHC Run 3 obtained with the radiation damage simulation are also discussed.

###### Contents

* 1 Introduction
* 2 ATLAS detector
	* 2.1 The Pixel detector
* 3 Radiation damage to pixels and modeling in ATLAS simulation
	* 3.1 Radiation damage to pixel sensors
	* 3.2 Radiation damage modelling in ATLAS Monte Carlo simulation
* 4 Event reconstruction, data and simulation samples
* 5 Pixel performance
	* 5.1 Pixel Detector Response
	* 5.2 Pixel Hit-on-Track rates and spatial resolution
* 6 Tracking performance
	* 6.1 Inner Detector alignment
	* 6.2 Tracking and Vertexing Results
* 7 Conclusion

## 1 Introduction

The LHC Run 3 is expected to bring the highest energy \(pp\) collisions delivered so far with a data sample more than double the total statistics collected so far. The Run 3 dataset is of great importance for the ATLAS physics program in its investigations of the high energy frontier through searches for new phenomena and precision measurements of the properties of the Higgs boson and other particles.

Run 3 will not only be characterised by large data sets at high energy, large particle fluxes induce significant radiation damage effects in the detectors, in particular those located closest to the LHC interaction region. The innermost layer of the ATLAS Pixel detector has already sustained a fluence 1\(\geq 6\times 10^{14}\) n-eq/cm\({}^{2}\). By the end of Run 3 in 2025, this is expected to grow to values in excess of \(\simeq 2\times 10^{15}\) n-eq/cm\({}^{2}\). Radiation damage to the detectors will become a parameter of relevance in evaluating performance for the Pixel detector and related physics objects in Run 3. The lessons learned in Run 3 are also of special importance in the perspective of the LHC high luminosity program and the upgraded ATLAS tracker.

Footnote 1: The particle fluence, expressed in (1 MeV) n\({}_{\rm eq}\)/cm\({}^{2}\), is a weighted sum of the flux of particles integrated over time, rescaled to the damage produced by neutrons of 1 MeV energy

Radiation damage affects the pixel charge collection efficiency and the uniformity of its response to charged particle ionisation. ATLAS has developed a radiation damage simulation based on realistic maps of the electric field in the Si bulk at difference fluences, now implemented in the official simulation software and adopted for Run 3 ATLAS physics sample simulation. This represents a valuable tool to understand and predict these effects and their relation to performance of physics object reconstruction. Furthermore, the degradation of this performance due to radiation damage can be, not only modelled, but also mitigated using Monte Carlo (MC) samples processed with radiation damage simulation. Tuning the track reconstructionalgorithms on these samples makes it possible to partially recover the performance loss caused by charge collection inefficiencies.

The restart of LHC operation for Run 3 with early collisions at a centre-of-mass energy \(\sqrt{s}\) = 900 GeV provides an excellent opportunity to evaluate the ATLAS pixel detector performance and its relation to tracking and vertexing.

This note presents a first characterisation of the response of the ATLAS Pixel detector and of track reconstruction obtained from the analysis of the 900 GeV \(pp\) collisions in the LHC recorded in June 2022. Following a brief description of the ATLAS detector in section 2, the radiation damage effects and their modelling in the ATLAS simulation are presented in section 3. Section 4 summarises data reconstruction, data sets and the simulation samples used in the analysis. The pixel detector performance is discussed in section 5, in comparison to the radiation damage ATLAS simulation predictions. Performance of tracking and primary vertex reconstruction are given in section 6. Section 7 has the conclusions.

## 2 ATLAS detector

The ATLAS experiment [1] at the LHC is a multipurpose particle detector with a forward-backward symmetric cylindrical geometry and a near \(4\pi\) coverage in solid angle.2 It consists of an inner tracking detector, electromagnetic and hadron calorimeters and a muon spectrometer. The inner tracking detector covers the pseudorapidity range \(|\eta|<2.5\). The reconstruction of charged particle trajectories is performed in three sub-detectors: a high granularity silicon Pixel Detector, the silicon microstrip Semi-Conductor Tracker detector (SCT) and the Transition Radiation Tracker (TRT). These are contained in a thin superconducting solenoid providing a 2 T axial magnetic field.

Footnote 2: ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point (IP) in the centre of the detector and the \(z\)-axis along the beam pipe. The \(x\)-axis points from the IP to the centre of the LHC ring, and the \(y\)-axis points upwards. Cylindrical coordinates \((r,\phi)\) are used in the transverse plane, \(\phi\) being the azimuthal angle around the \(z\)-axis. The pseudorapidity is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan(\theta/2)\). Angular distance is measured in units of \(\Delta R\equiv\sqrt{(\Delta\eta)^{2}+(\Delta\phi)^{2}}\).

Electromagnetic (EM) energy depositions are measured with high granularity in the lead/liquid-argon (LAr) sampling calorimeters, particularly in the azimuthal angular region corresponding to the ID coverage. A steel/scintillator-tile hadron calorimeter covers the central pseudorapidity range (\(|\eta|<1.7\)). The endcap and forward regions are instrumented with LAr calorimeters for both the EM and hadronic energy measurements up to \(|\eta|=4.9\).

The muon spectrometer surrounds the calorimeters and is based on a system of precision gaseous tracking chambers and fast detectors for triggering inside the magnetic field provided by three large superconducting air-core toroidal magnets with eight coils each.

A two-level trigger system is used to select events and reduce the incoming data rate [2]. The first-level trigger is implemented in custom-built hardware and uses a subset of the detector information to accept events up to a rate of 100 kHz. This is followed by a software-based trigger that reduces the accepted event rate to 1 kHz on average depending on the data-taking conditions.

### The Pixel detector

Of particular importance for this study is the Pixel Detector. Its barrel section is equipped with four concentrical layers, Insertable B-Layer (IBL) [3], B-Layer (BL), Layer 1 (L1) and Layer 2 (L2), located at average radial positions of 3.3 cm, 5.1 cm, 8.9 cm and 12.3 cm, respectively. The transverse \(r-\phi\) coordinate of charged particle passage is measured along the pixel rows (\(X\) coordinate in the detector local reference frame), on a 50 \(\upmu\)m pitch, and the longitudinal \(z\) coordinate along the columns (\(Y\) coordinate in the detector local reference frame), on a 250 \(\upmu\)m pitch in the IBL and 400 \(\upmu\)m pitch in the other layers. The detector staves are arranged with overlaps between adjacent modules in \(\phi\). Two endcap sections complement the barrel part and consist of three double disks located at \(\pm\)50 cm, \(\pm\)58 cm and \(\pm\)65 cm from the centre of the detector. The IBL was installed at the beginning of Run 2 in 2015, while the other layers operate since the start of ATLAS data taking at LHC.

IBL modules consist of 200 \(\mu\)m-thick Si slim edge planar sensors, in the central part of the stave, and 230 \(\mu\)m-thick Si sensors in 3D technology, on both stave ends, read out with 2 and 1 FE-I4 front-end chips [4], respectively. The other pixel modules consist of 250 \(\mu\)m silicon sensor read out with 16 FE-I3 front-end chips [5]. Each readout cell features an analog block performing signal amplification and discrimination and a digital block computing the Time over Threshold (ToT), which is proportional to the detected charge and expressed in units of bunch crossing periods (1 BC = 25 ns). For every pixel that exceeds an "analog threshold", the ToT value is stored. A "ToT threshold" is further applied to remove noise hits. The ToT value is coded on 4 bits (up to 15) for the FE-I4 and on 8 bits (up to 255) for the FE-I3 chips. The limited dynamic range on FE-I4 is mitigated by a different ToT-to-charge conversion. Hits having ToT higher than 15 are stored in the highest ToT bin and receive an overflow tag. Due to limitations in the FE-I3 internal buffers, during Run 2 the B-Layer latency was reduced (lowering it from 255 to 150). The limited dynamic range of the B-Layer ToT was compensated by choosing a different tuning point.

Front-end chips are individually calibrated in scans where the ToT value corresponding to a given amount of injected charge on reference capacitors in the FE chips is recorded. The calibration tuning points for Run 3 are 16 k\(e^{-}\) at ToT=10 for IBL, 20 k\(e^{-}\) at ToT=18 for B-Layer and 20 k\(e^{-}\) at ToT=30 for the other layers. ToT-to-charge scans are regularly conducted for each front-end chip to provide a conversion of the pixel ToT response into units of collected charge. The IBL charge calibration is corrected using the response to Am\({}^{241}\) source scans performed before installation. A suitable correction is applied to simulated IBL charge in MC samples.

## 3 Radiation damage to pixels and modeling in ATLAS simulation

Radiation damage affects the response of detectors, in particular those located closest to the interaction region. The ATLAS pixel sensors installed in the two innermost layers, report a charge collection efficiency reduced by \(\sim\)20% during Run 2. This is expected to further decrease by a factor of more than two, compared to the original response, by the end of Run 3. This decrease requires a careful optimisation for the detector operating conditions and reliable tools to predict the evolution of the sensor performance with fluence and its impact on event reconstruction.

This section presents a short summary of radiation damage effects on the pixel sensors and their modelling in the digitisation step of the ATLAS MC simulation [6] using a dedicated algorithm whose inputs are taken from detailed silicon device simulations.

### Radiation damage to pixel sensors

The intense flux of particles resulting from the LHC \(pp\) collisions - and their interactions with the detector material - creates dislocation of atoms from lattice sites in the bulk of silicon detectors. The combination of interstitial silicon and lattice vacancies generates the basic defects induced by radiation leading to the generation of states in the forbidden Si band-gap. These can charge up, by capturing/emitting charge carriers. This mechanism induces important changes in pixel detector operations and performance. In the following, a brief description of the basic phenomena is presented. For more information, the reader is referred to the reviews in [7, 8]. At the macroscopic level, the main effects of the accumulation of radiation damage defects are the increase of sensor leakage current, a change of the depletion voltage, due to a change of the electric field profile, and, most important to physics performance, a reduction in signal amplitude.

Defects can create electron and hole pairs, leading to a linear increase of the leakage current \(I\) with the radiation damage fluence \(\Phi\). For example, the IBL sensors showed a current density of several mA cm\({}^{-3}\)[9] at the end of Run 2, as shown in Figure 1, to be compared to a fraction of \(\mu\)A for a non-irradiated module [10]. The observed discrepancy between measurements and simulation predictions in the levels of leakage currents can be due to the numerical values of the scale factors used to convert the contribution of different particle species to standardised 1 MeV-equivalent neutron fluences. This is corrected by rescaling the predictions to match the observed average leakage current.

As defect sites charge up, they alter the bulk charge distribution, which implies a change in the electric field in the silicon substrate. As a result, larger and larger bias voltages are needed to deplete the Si bulk. The bias voltage of IBL planar sensors needed to be raised from 80 V at the beginning of Run 2 to 400 V at its end.

Figure 1: Measured and predicted leakage currents for IBL sensors, normalised to zero degree Celsius for four groups of modules located at longitudinal positions of \(|z|<8\) cm, \(8<|z|<16\) cm, \(16<|z|<24\) cm and \(24<|z|<32\) cm. Modules in the highest \(|z|\) region are equipped with sensors in 3D technology, the others are equipped with planar sensors. Overall scale normalisation factors are obtained through a fit to data, for each \(|z|\) region. The lower panel shows the ratio of the prediction to the data for the innermost module group (from [9]).

Defects can also trap carriers created by ionising particles, leading to a reduction of the collected signal amplitude. The trapping phenomena are characterised by a trapping time \(\tau\) inversely proportional to the fluence \(\Phi\): \(\tau_{e,h}^{-1}=\beta_{e,h}\Phi\), where the values of the trapping coefficients \(\beta\) are larger for electrons than holes [11].

### Radiation damage modelling in ATLAS Monte Carlo simulation

The reduction in signal amplitude is the most evident effect of radiation damage in pixel sensors. This degradation may induce changes to the hit efficiency and spatial resolution as well as to the efficiency for identifying clusters generated by the charge deposition of multiple charged particles.

Therefore, it is important to model these effects in simulations, and tune track reconstruction algorithms on radiation-aware MC event samples. For the start of Run 3 it is possible to simulate radiation damage effects in the digitisation step of pixels with the "radiation damage digitiser". In this digitiser module, the induced signal on electrodes by the carriers produced by ionising particles in Geant4 [12] is calculated using precise electric field, Lorentz angle and weighting potential [13; 14] maps, taking into account carriers trapping and diffusion effects. Details of their implementation can be found in Ref. [11]. Most of the inputs to the radiation damage digitiser are taken from detailed TCAD 3 simulations which predict the electric field distribution for a given applied bias voltage after irradiation at a given fluence. The sensor modifications due to radiation damage are modelled by the addition of deep defects [15]. Examples of the electric field profile predictions at different fluences are shown in Figure 2.

Footnote 3: Technology Computer Aided Design

This predicted electric field is used to calculate the expected time spent by charge carriers to reach the collecting electrode, via the carrier-mobility relation. Electric field and mobility values are also used to calculate the expected average Lorentz angle for charge produced at one position and subsequently trapped at another one [16]. All these

Figure 2: The simulated electric field magnitude in the \(z\) direction along the Si bulk depth, averaged over the \(x\) and \(y\) coordinates for an ATLAS IBL sensor biased at -150 V for various values of the fluence (from [11]).

quantities are precalculated and stored as numerical maps. The weighting potential map, used to determine the final induced signal on all pixels, is also precalculated using TCAD tools.

Upon initialisation, the digitiser receives global information about the detector geometry and conditions, including the sensor bias voltage, operating temperature and fluence. For the calculation of individual charge deposits within the pixel sensor, the digitiser takes as input from Geant4 the magnitude and location of energy deposited by a charged particle, and outputs a digitised encoding of the measured charge. Charge carriers are grouped and both drift and diffusion effects are applied collectively. For each charge group, a fluence-dependent trapping probability is applied to the carriers. The induced charge on the pixels is calculated from the initial and trapped positions using the weighting potential map and including charge sharing effects. The total induced charge is finally converted into a ToT value used for clustering.

This procedure was demonstrated to provide a realistic simulation of the detector behaviour after irradiation through a detailed program of validation using Run 2 data. For Run 3 it is adopted for the production of MC samples as the default digitiser for the planar sensors in the IBL and the other pixel barrel layers.

As the radiation damage fluence grows with integrated luminosity, the predictions on electric field and all other derived quantities have to be updated as the LHC run progresses. For Run 3, it has been decided to prepare four different conditions in terms of average fluence on the barrel layers, bias voltage, thresholds and temperature corresponding to the midpoint of each data taking year. Event samples simulated with radiation damage effects for these conditions have been used for the retraining of the neural networks that determine the pixel hit positions and the number of particles contributing to pixel clusters [17].

The IBL charge collection efficiency variation as a function of the integrated luminosity measured in data and that predicted by the radiation damage from the start of Run 2 is presented in Figure 3. The charge collection efficiency is obtained by computing the most probable value of the cluster charge normalised to that measured at the beginning of 2015 for IBL planar sensors. The comparison of data and radiation damage simulation shows the good modelling provided by the MC within its parametric uncertainties. The charge collection efficiency has already reduced by more than 20% on the IBL planar sensors at the end of Run 2, despite the increase in bias voltage. The radiation damage simulation is used to make predictions on the evolution of the IBL charge collection efficiency for Run 3 with bias voltage increasing from 450 V, used in 2022, up to a maximum viable value of 1000 V. The availability of the first Run 3 data makes it possible to conduct a more detailed validation of these predictions.

## 4 Event reconstruction, data and simulation samples

The data sample used for the following studies corresponds to events recorded during the special LHC operation at a centre-of-mass energy of 900 GeV in June 2022 at the start of Run 3. The total integrated luminosity of this data set, recorded with two colliding bunches, amounts to \(\sim\) 2.5 mb\({}^{-1}\). Proton-proton collisions were collected with a minimum bias trigger, requiring at least one hit in the Minimum Bias Trigger Scintillators (MBTS) [18]. Data taking periods used for ID operational tuning are not included. A total of 82 k events have been selected for this study from \(\sim\) 0.85 mb\({}^{-1}\) of integrated luminosity. The recorded data in fills with only two colliding bunches is characterised by events consisting in general of only one proton-proton collision. An extensive software suite [6] is used in the reconstruction and analysis of real and simulated data, in detector operations, and in the trigger and data acquisition systems of the experiment.

Simulation samples have been generated for minimum-bias [19] and multi-jet [20] events at \(\sqrt{s}\) = 900 GeV both with and without the radiation damage charge digitisation discussed above. These samples are in the following referred to as "Radiation Damage MC" and "Constant Charge MC", respectively. Samples including the radiation damage effects use electric field maps corresponding to the fluences expected in the 2022 run after 12.5 fb\({}^{-1}\) of data collection, corresponding to estimated average fluences of 7.5 \(\times 10^{14}\) (1 MeV) n\({}_{\rm eq}\)/cm\({}^{2}\) on the IBL and 6.8 \(\times 10^{14}\) (1 MeV) n\({}_{\rm eq}\)/cm\({}^{2}\) on the B-Layer.

Pixel hit positions are determined from the matrix of charges collected on the pixels associated to each cluster using a neural network. In Run 3 this task is accomplished by a Mixture Density Network (MDN) based on probabilistic learning that simultaneously estimates the hit position and its uncertainty [21]. The MDN provides an improved interpolation of charge shared in pixel clusters for position determination compared to the network in use during Run 2. This results in an improvement in the predicted spatial resolution along cluster projections with more than one fired pixel of approximately 10%.

Charged particle tracks are selected applying the following quality cuts: track pseudorapidity \(|\eta|<2.5\), the sum of the number of hits in the pixels and SCT N\({}_{\rm Si}\geq 8\), at least one hit in the pixel detector, track impact parameter \(|d_{0}|<2\) mm and \(|\Delta z_{0}\sin\theta|<3\) mm and transverse momentum, \(p_{\rm T}>0.5\) GeV. These general cuts are modified for some of the studies, as detailed below.

Figure 3: Charge collection efficiency as a function of integrated luminosity for IBL planar sensors for data and the ATLAS radiation damage simulation from the beginning of Run 2. The points represent the data and the bands the simulation predictions. The parametric uncertainty on the simulation defining the width of the bands includes variations in the radiation damage model parameters as well as the uncertainty in the luminosity-to-fluence conversion. Horizontal error bars on the data points due to the luminosity uncertainty are smaller than the size of the markers. In Run 2 the bias voltage was increased from 80 V in 2015 to 400 V in 2018. Predictions for Run 3 are shown for bias voltages ranging from 450 V in 2022 to 1000 V in 2025. Sudden increases in charge collection efficiency at the beginning of each year are due to changes in the operational parameters (bias voltage and thresholds).

## 5 Pixel performance

The upgrades of the readout electronics and the optimisation of the operating parameters resulted in a stable and performant pixel data taking throughout Run 2. Several improvements have been deployed in preparation for Run 3.

Following the optimisation strategy adopted for the last year of Run 2, pixel thresholds have already reduced for the start of Run 3. The analog thresholds for IBL have been set to 1500 \(e^{-}\), down from 2000 \(e^{-}\). Those for the B-Layer have been modulated according to their longitudinal position along the stave in an "hybrid" setup. The central section, more exposed to radiation but less affected by occupancy, where particles traverse a smaller path in the active Si thickness, has analog thresholds set at 3500 \(e^{-}\), down from 4300 \(e^{-}\), while the modules covering the larger \(\eta\) range have analog thresholds set at 4300 \(e^{-}\), down from 5000 \(e^{-}\). The corresponding increase in occupancy is estimated to be acceptable for the available readout bandwidth.

The bias voltage of all the sensor layers have also been raised for the start of Run 3. This allows to gain charge collection efficiency in the regime above depletion voltage, where the higher electric field reduces charge trapping effects in the damaged Si lattice.

Finally, the ToT calibration procedure for IBL has been modified in order to avoid the fitting step of the charge and ToT values that may cause biases at low and high charge values. Figures 4 present a typical example of the ToT response to the injection charge for IBL and B-Layer modules.

The new IBL calibration procedure implements look-up tables instead. These look-up tables use the average of the injected charge values on the pixels of a FE chip corresponding to each ToT calibration point. This method is only feasible for IBL given that the FE-I4 has a dynamic range of 15; the other pixel layers have a dynamic range of 150 or 255, making the implementation of such large look-up tables impractical. The look-up-tables for charge to ToT conversion are constructed and stored in the calibration database. In simulation, the ToT is extracted by linear interpolation of the input charges and rounded to an integer value. These changes were tested using cosmic rays in the course of 2021 and early 2022 and their effects on the pixel detector response are now evaluated on the 900 GeV data.

### Pixel Detector Response

The pixel response is characterised in terms of the charge collected, the pixel multiplicity and the charge sharing between these pixels in clusters associated to reconstructed particle tracks. Data are compared to simulation predictions obtained with both the radiation damage MC and the constant charge MC discussed above. In this note we focus on the response of the two innermost barrel pixel layers, IBL and B-Layer, having the largest weight in the track extrapolation resolution to the primary vertex and where radiation damage effects are more prominent.

Pixel clusters associated to selected particle tracks are used in this study. Tracks are requested to have \(p_{\mathrm{T}}\)\(>\)0.7 GeV to select minimum ionising particles with almost constant energy deposition. In comparing data to simulation, MC tracks are re-weighted to match the distribution of the particle incidence angle \(\alpha\) on the silicon surface observed for data.

The charge collected in pixel clusters is the first measure of the detector response and its sensitivity to radiation damage. Figure 5 shows the distribution of the cluster charge for the two innermost pixel layers,the IBL and B-Layer. The two MC samples show the effect of radiation damage and the good description of data obtained by the radiation damage simulation. However, differences between data and MC still remain. These can be explained, at least in part, in terms of uncertainties in the radiation damage model parameters, as well as the uncertainty in the luminosity-to-fluence conversion, as estimated in Figure 3, and front-end threshold simulation.

The second measure of the pixel detector response is the distribution of the number of pixels in clusters associated to tracks. This distribution depends on the incidence angle of the particle and the position

Figure 4: Example of charge-to-ToT calibration for the IBL (left) and the B-Layer (right) modules with the response of the injection charge to ToT correspondence as well as the calibration fitting function. In Run 3, the IBL calibration uses a look-up-table instead of the fitting function that does not correctly model the saturation and overflow effects in the large ToT region, due to the limited dynamic range of the FE-I4 chip. This is not observed in the FE-I3 in the range of injected charge values used for calibration and relevant for data reconstruction.

Figure 5: Cluster charge corrected by the particle path in the Si for IBL (left panel) and B-Layer (right panel) planar sensors. Points represent data, the histograms the MC predictions obtained with radiation damage (continuous line histogram) and constant charge (dashed line histogram) simulation

of impact of the particle on the detector plane but also on the charge diffusion and the pixel thresholds. The distributions in the projection transverse (\(r-\phi\) or local \(X\)) and longitudinal (\(z\) or local \(Y\)) to the beam axis are shown in Figure 6 for the IBL and the B-Layer. Also, here it is evident how the radiation damage simulation improves the modelling of the cluster shape. Remaining discrepancies are related to differences in the collected charge and in the spread of pixel thresholds in simulation compared to data and in aspects not related to radiation damage such as the track finding algorithm itself and the detector alignment. Differences between the two MC models in the transverse projection are due to the change in the collected charge but also in the calculated Lorentz angle that drives the cluster multiplicity along the small pixel pitch projection [22], as for the case of the B-Layer.

Figure 6: Distributions of the number of pixels in clusters in the projections transverse (\(r-\phi\), or local \(X\), at small pixel pitch) and longitudinal (\(z\), or local \(Y\), at large pixel pitch) to the beam axis for the IBL (left panels) and B-Layer (right panels) planar sensors. Points represent data, the histogram the MC predictions obtained with radiation damage (continuous line histogram) and constant charge (dashed line histogram) simulation

### Pixel Hit-on-Track rates and spatial resolution

The efficiency for pixel clusters to be associated to tracks and the pixel hit spatial resolution are the two detector performance figures most important for particle track reconstruction. Appropriate changes in pixel operating parameters have so far ensured a rather uniform performance through Run 2. The start of Run 3 brings the promise of some improvements compared to the end of Run 2.

The fraction of particle tracks reconstructed with associated pixel detector hits in a given layer gives an indication of the detector efficiency for tracking purposes. Its definition differs from that of hit efficiency, due to the contributions from module overlaps and particles not traversing the layer under study as well as disabled modules and the result depends cuts applied. This fraction is computed for the two innermost layers and compared to the simulation predictions. For this study, reconstructed tracks are required to have hits on the two layers closest to the layer under study, i.e. on the B-Layer and Layer 1 when studying the rate of hits on the IBL and on the IBL and Layer 1 when studying that on the B-Layer. This requirement reduces the rate of tracks originating at a radial position larger than that of the layer under study or with a poor extrapolation to it.

The fraction of tracks with IBL and B-Layer hits-on-track is studied as a function of the pseudorapidity, \(\eta\), of the track. Tracks with small azimuthal incidence angles on the pixel layers deposit, on average, less charge per pixel than those at larger angles. This increases the probability that the collected charge is below the pixel threshold resulting in a possible pixel hit inefficiency.

The distributions obtained for the IBL and B-Layer are shown in Figure 7. The fractions obtained for the data agree generally well with their MC predictions. The higher efficiency registered on data for the B-Layer for central tracks is due to the "hybrid" threshold setting adopted in Run 3, that is not yet included in the MC. A comparison of the predictions from the two MC samples shows that radiation damage effects on the efficiency for associating pixel hits to tracks are well manageable for the fluences integrated so far.

Figure 7: Average fraction of tracks with an associated hit in the IBL and B-Layer as a function of the track pseudorapidity, \(\eta\), comparing the Run 3 900 GeV data to MC (left) and the Run 2 data (right). The fraction is computed for fraction of selected tracks with \(p_{T}>1.0\) GeV, \(|\eta|<2.1\) and pixel hits in the two neighbouring layers having an associated hit in the layer under study.

This analysis indicates that the fraction of tracks with hits in the two innermost pixel layers at the start of Run 3, 0.971\(\pm\)0.003 on IBL and 0.950\(\pm\)0.003 on the BL integrated over \(\eta\), are higher than those registered at the end of 2018, 0.958\(\pm\)0.002 and 0.914\(\pm\)0.002, respectively. This performance improvement owes to the optimisation of the pixel operating conditions, with the increase of the bias voltage and the reduction of the analog and ToT thresholds, and to the reduction of the number of inactive modules after the LHC Long Shutdown 2 (LS2) interventions.

The second performance figure studied on the data is the IBL spatial resolution. Owing to its position closest to the interaction region and its smaller pixel pitch along \(z\) compared to the sensors equipping the other layers, the IBL carries the largest weight in determining the extrapolation of tracks to the primary vertex for particles of low-to-moderate transverse momenta.

The IBL spatial resolution has been studied using the active region of adjacent module overlaps in \(\phi\), that are approximately 1.5 mm wide, using a technique already exploited by ATLAS [23]. In these regions, particles traversing the IBL layers generate hits on two neighbouring modules. The spatial resolution can be extracted from the distribution of the corrected difference \(\Delta_{r-\phi}\) and \(\Delta_{z}\) of the transverse and longitudinal positions of these hits, respectively. Corrections are applied to the \(\Delta\) values to account for geometrical effects due to the different radial position of the modules traversed by the particle track and the particle incidence angle.

The width of the \(\Delta\) distribution is \(\sqrt{2}\) times larger than the hit resolution that we intend to measure, under the assumption that the two hits have the same spatial resolution. This method has the advantage of depending only weakly on the reconstructed track parameters and their uncertainties and on detector alignment. The overlap technique for the determination of the pixel spatial resolution has been validated using simulation [23].

For this study, tighter selection criteria are applied. In addition to the track quality criteria listed at the end of section 4, only tracks having two associated hits in the IBL, within the module overlap fiducial region defined along \(\phi\), at least two hits on the other pixel layers, to ensure accurate extrapolation, and \(p_{\mathrm{T}}>3\) GeV, to reduce multiple scattering effects, are considered. Clusters including pixels located at the edge of a module, where the charge interpolation may be inefficient, are also discarded. A total of \(\sim\)2400 reconstructed tracks with two hits in the IBL overlap regions is selected.

The resolutions \(\sigma_{\mathrm{point}}=\sigma_{\Delta}/\sqrt{2}\), where \(\sigma_{\Delta}\) are obtained from the fitted Gaussian widths of the \(\Delta\) distributions, shown in Figure 8. The dependence of the measured spatial resolution on the variables most relevant to the two projections, the number of pixels in the cluster for \(r-\phi\) and the track azimuthal incidence angle for \(z\), is shown in Figure 9 for data and simulation.

The observed behaviours of the pixel spatial resolution with these two variables can be explained as follows. In IBL pixel clusters, the deposited charge is generally contained within one or two pixels along the \(r-\phi\) projection. Single pixel clusters are typically generated by tracks passing within approximately \(\pm\)15 \(\mu\)m along the local \(X\) coordinate (\(r-\phi\) projection) from the pixel centre according to simulation. Two-pixel clusters are due to tracks closer to the pixel edge than to the centre and benefit from charge interpolation for determining the hit position. Clusters that are broader that two pixels in \(r-\phi\) exhibit a degraded hit spatial resolution, mostly due to the effect of \(\delta\)-rays displacing the centre-of-gravity of the charge released by the primary particle. Along the \(z\) coordinate (or local \(Y\)), the evolution of the measured resolution can be interpreted as the combined effect of the improvement of charge interpolation with the increase of the number of fired pixels followed by a degradation due multiple scattering effects at larger incidence angles.

The pixel detector spatial resolution evolves also with the reduction in collected charge due to radiation damage effects. However, their impact on pixel spatial resolution is rather small because the determination of the pixel hit position depends mostly on relative quantities, such as fraction of cluster charge shared between neighbouring pixels. This degradation is modelled by the radiation damage MC that predicts a \(\simeq\)25% increase from the start of Run 2 to the end of Run 3 under the current operating parameter assumptions. This degradation is now mitigated by the improvement in the spatial resolution of pixel hits obtained with the MDN introduced for Run 3 and by training the network on radiation damage MC

Figure 8: Difference between the corrected positions of reconstructed IBL clusters in the \(r-\phi\) (left) and \(z\) (right) projections. The distributions are obtained from samples of reconstructed particle tracks traversing the overlapping IBL modules and having two IBL hits associated, \(|\eta|<2\) for \(r-\phi\) and \(<1\) for \(z\), in 900 GeV collision events (filled circles with errors bars) and simulation (histogram). The curves represent the Gaussian fit to data.

Figure 9: Measured IBL hit resolution in the \(r-\phi\) (left) and \(z\) (right) projections as a function of the cluster width along \(\phi\) and the track \(|\eta|\), respectively, in 900 GeV collision events (filled circles with errors bars) and simulation (open circles).

samples. The spatial resolution estimated on the 900 GeV data agrees with the radiation damage simulation predictions. For comparison, constant charge simulation yields spatial resolution values that are lower by \(\simeq\)5% in both coordinates, compared to those predictions.

## 6 Tracking performance

The pixel performance drives the tracking extrapolation accuracy to the primary vertex. This section discusses the ID alignment and characterises the track reconstruction through the number of hits in the ID detectors associated to particle tracks, the primary vertex reconstruction and the track extrapolation resolution as a function of the particle transverse momentum.

A total of \(\sim\)850 k tracks are reconstructed in the first Run 3 data from the sample described in Section 4.

### Inner Detector alignment

Possible vibrations during the LS2 may have caused a significant movement of the Inner Detector components with respect to their position determined at the end of Run 2. Therefore, an updated description of the detector geometry is needed prior to \(pp\) collision data-taking at \(\sqrt{s}\)=13.6 TeV. The ATLAS Inner Detector alignment aims at the description of the detector geometry at the highest level of precision possible by means of the minimisation of the track-hit residuals [24]. These residuals are computed in the local coordinate system with the local coordinate in the direction of the small pixel pitch and local \(Y\) in the direction orthogonal to it on the sensor plane.

Reconstructed tracks from these first \(pp\) collisions have been used to quantify the movements of the detector during LS2. In order to minimise multiple scattering effects, similarly to what done for the IBL spatial resolution study, only tracks with \(p_{\mathrm{T}}>3\) GeV are considered. A rigid rotation of the IBL of approximately 0.3 mrad with respect to the position determined in the last LHC fill of Run 2 [25] is observed, corresponding to a movement of the mean of the residual distribution in the IBL coordinate around 10 \(\mu\)m, as shown in Figure 10(a). This rotation of the IBL is reflected in the track-hit residuals in the \(X\) projection in the B-Layer (see Figure 10(c)), as reconstructed tracks are systematically biased from the displacement of the IBL, providing non-zero residuals of opposite sign in the B-Layer. An additional movement of the IBL of around 13 \(\mu\)m along the beam axis is also observed as shown in Figure 10(b), reflected also in the track-hit residual along the local \(Y\) coordinate in the B-Layer (Figure 10(d)). No other significant displacements with respect to the geometry at the end of Run 2 have been observed.

These global movements of the IBL have been corrected by the alignment procedure, in which only global movements of the IBL detector are included as degrees-of-freedom for the track-hit residual minimisation. This procedure resulted in a preliminary description of the detector geometry in preparation for the Run 3 high-energy collision data, with almost negligible track-hit biases, as shown in Figure 10. The slightly degraded position resolution with respect to that of Run 2 indicates a still sub-optimal description of the detector geometry, due to the limited number of degrees-of-freedom included in the alignment procedure so far. This was due to the limited statistics available and the relatively low \(p_{\mathrm{T}}\) of particle tracks from the 900 GeV data.

### Tracking and Vertexing Results

Track reconstruction is characterised by studying the number of hits in the three ID detectors, Pixel, SCT and TRT, associated to particle tracks, the primary vertex reconstruction and the track extrapolation resolution as a function of particle transverse momentum, comparing data to simulation predictions. The number of hits on track observed in data and simulation are compared for tracks passing the track selection criteria given at the end of Section 4. Figure 11 shows the distributions of pixel hits and their average as a function of the track pseudorapidity, \(\eta\). Figure 12 shows the average number of SCT and TRT hits again as a function of the track pseudorapidity. Data and MC simulation agree well for such an early stage of data taking.

The primary vertex (PV) reconstruction in Run 3 uses a new algorithm developed by ATLAS based on an Adaptive Multi-Vertex Filter (AMVF) and a Grid Seed Finder for vertex candidate search. The AMVF [26] was deployed through the A Common Tracking Software (ACTS) framework [27] obtaining a reduction of the average PV reconstruction time by more than a factor of 1.5 while delivering identical physics results as the previous non-ACTS version. This is adopted as the default PV reconstructor for Run 3 [28].

The AMVF extends the functionality of the single vertex fitter by allowing tracks to contribute to multiple

Figure 10: Track-hit residuals in the IBL in the local \(X\) (a) and \(Y\) (b) coordinates and in the B-Layer in the local \(X\) (c) and \(Y\) (d) coordinates.

vertices with appropriate weights. The algorithm processes several vertices at once, recalculating a track-to-vertex contribution weight for every track together with the vertex positions at every iteration, until they stabilise. This approach is able to provide a good vertex-vertex resolution together with a precise single vertex position determination. The event PV is reconstructed by imposing the average position and width of the colliding beams as "beam-spot" constraints. The data used in this study, recorded in fills with only two colliding bunches, have no pile-up. The distributions of the position of the reconstructed PV in one LHC fill are shown in Figure 13. The number of tracks used in the PV fit and the fit \(\chi^{2}\) normalised on the number of degrees of freedom are shown in Figure 14. The estimated PV resolution from the fit covariance matrix is \(\sim\)30 \(\mu\)m in the \(x\) and \(y\) coordinates, reflecting the larger beamspot transverse size compared to high energy collisions, and \(\sim\)60 \(\mu\)m in \(z\).

Figure 11: Distributions of the number of pixel hits associated to selected particle tracks (left panel) and its average value as a function of the pseudorapidity, \(\eta\), of the tracks in data (filled points with error bars) and radiation damage simulation (continuous line).

Figure 12: Distributions of the average number of SCT (left panel) and TRT (right panel) hits associated to selected particle tracks as a function of the pseudorapidity, \(\eta\), of the tracks in data (filled points with error bars) and simulation (continuous line).

The distance of closest approach of tracks to the PV, generally referred to as "impact parameter", measures the track extrapolation resolution. This is a crucial tracking performance figure, in particular for vertexing and flavour tagging. The impact parameter resolution depends on the hit spatial resolution of the ID detectors, in particular that of the pixel layers closest to the beam pipe, and scales as \(1/p_{\mathrm{T}}\), due to the multiple scattering effects. The resolution of the impact parameter projection in the plane transverse to the beam axis, denoted with \(d_{0}\), is studied for a subset of reconstructed tracks as a function of the track transverse momentum. In order to avoid biases, the vertex position is updated before computing the impact parameter of each individual track by removing that track from the vertex fit. In order to extract the \(d_{0}\) resolution from the width of the measured distribution of the track \(d_{0}\) parameter at the PV, the contribution of the PV resolution must be subtracted. This subtraction is performed by applying an iterative deconvolution of the PV resolution [29]. The procedure is based on the principle that the core

Figure 14: Distributions of the number of tracks included into the primary vertex fit (left) and \(\chi^{2}\) normalised on the number of degrees of freedom of the fit (right).

Figure 13: Distributions of the position of the reconstructed primary vertex in 900 GeV collision data recorded for an LHC fill. The MC was generated with different beam spot conditions and therefore cannot be compared to data.

of the measured \(d_{0}\) resolution can be modelled by a Gaussian function with a width corresponding to the convolution of the track and PV resolutions integrated over the range of PV resolution values. The deconvolved distribution can be obtained by multiplying the measured \(d_{0}\) value by appropriate scaling factors. This procedure is performed in two steps. In the first step, a track scaling factor changes iteratively to approximate the value of the track resolution \(\sigma_{d_{0},\mathrm{trk}}\). Then, a PV scaling factor is introduced, to take into account possible differences between the actual resolution of the PV and that estimated from the covariance matrix of the fit. This iterative procedure is repeated until the resulting \(\sigma_{d_{0},\mathrm{trk}}\) reaches a stable value. The unfolding is repeated in bins of the track \(p_{\mathrm{T}}\) to study the impact parameter resolution evolution with the track transverse momentum. Only central tracks, in the pseudorapidity range of \(|\eta|<\)0.8, are chosen for this study, in order to minimise the effect of the change of the \(d_{0}\) resolution with the track polar angle.

The transverse impact parameter resolution is measured as the Gaussian r.m.s. extracted from an iterative fit on the central portion of the unfolded \(d_{0}\) peak contained within a \(\pm\)1.5\(\sigma\) interval centred at the maximum value of the distribution. The \(d_{0}\) unfolded distribution obtained for tracks in the 2\(<\)\(p_{\mathrm{T}}<\)3 GeV transverse momentum interval is shown in Figure 15 with the Gaussian fit overlaid. The results extracted from data are compared to MC predictions. For MC, the \(d_{0}\) is directly obtained from the distribution of the \(d_{0}\) residuals, defined as the difference between the reconstructed \(d_{0}\) value and that of the distance of closest approach of the trajectory of the simulated charged particle to the simulated point of primary \(pp\) interaction for tracks passing the same selection as the data. Results are shown in Figure 16 as a function of the track \(p_{\mathrm{T}}\). The agreement between data and simulation is rather good, considering the preliminary stage of detector alignment and limited span of the \(p_{\mathrm{T}}\) distribution of tracks in 900 GeV collisions. The measured impact parameter resolution is close to that obtained with 13 TeV collision data at the start of Run 2 [30]. The predictions by the radiation damage and the constant charge MC setups are close, to underline the limited impact of radiation damage effects on the tracking performance for the fluence integrated so far by the

Figure 15: Unfolded distribution of the \(d_{0}\) impact parameter in the transverse plane for tracks with \(|\eta|<\)0.8 and 2\(<\)\(p_{\mathrm{T}}\)\(<\)3 GeV with the fitted Gaussian function used to extract the \(d_{0}\) resolution.

ATLAS Pixel detector.

## 7 Conclusion

The restart of LHC operation with collisions at a centre-of-mass energy \(\sqrt{s}\) = 900 GeV has provided a valuable opportunity to perform a first evaluation of the ATLAS pixel detector and tracking performance at the start of Run 3, ahead of collisions at \(\sqrt{s}\)=13.6 TeV.

The ATLAS pixels started operating in Run 3 with parameters optimised to mitigate the effects of radiation damage. The ATLAS simulation and reconstruction software underwent several improvements to deliver optimal performance in the new LHC run at higher energy. ATLAS simulation includes by default a new radiation damage pixel digitiser accounting for the radiation effects in the Si bulk through electric field maps computed for the corresponding values of fluence and bias voltage. A Mixture Density Network has been trained on simulated samples generated with this radiation damage MC and it is used for the determination of the spatial position of pixel hits and their resolution in track reconstruction.

Figure 16: Unfolded transverse impact parameter, \(d_{0}\), resolution measured in data as a function of the track \(p_{\mathrm{T}}\) for \(|\eta|<\)0.8 in comparison to the predictions of radiation damage and constant charge simulation. The lower panel shows the ratio of the resolution measured in data to the MC predictions. The uncertainties associated to the MC points account for statistics and the difference between the resolution values obtained with the residual and the unfolding methods.

First performance results from the analysis of a subset of the data collected in June 2022 have been compared to predictions from MC simulation samples including the radiation damage effect in pixels and those using constant charge collection. The new radiation damage MC gives an overall good description of the pixel response. In track reconstruction, where radiation damage effects are still tiny, the new Run 3 pixel operational parameters and the adoption of the MDN have makes it possible to achieve overall performances that are better than those obtained at the end of Run 2.

While these results are essential for the physics perspectives of the next quadrennial, the LHC high luminosity program will set an even higher target in terms of managing the detector radiation effects. The new ATLAS Inner Tracker (ITk) system [31, 32], currently under construction, entirely based on Si sensors and set to replace the current ID detector system after the end of Run 3, will have to withstand a particle fluence that will be more than one order of magnitude larger. Given the size of this challenge, incorporating radiation damage effects in the ITk detector simulation becomes mandatory. This makes the lessons learned in Run 3, and their implications, of crucial importance for the longer term future.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003 (cit. on p. 3).
* [2] ATLAS Collaboration, _Performance of the ATLAS trigger system in 2015_, Eur. Phys. J. C **77** (2017) 317, arXiv: 1611.09661 [hep-ex] (cit. on p. 3).
* [3] ATLAS Collaboration, _ATLAS Insertable B-Layer: Technical Design Report_, ATLAS-TDR-19; CERN-LHCC-2010-013, 2010, url: [https://cds.cern.ch/record/1291633](https://cds.cern.ch/record/1291633) (cit. on p. 4), Addendum: ATLAS-TDR-19-ADD-1; CERN-LHCC-2012-009, 2012, url: [https://cds.cern.ch/record/1451888](https://cds.cern.ch/record/1451888).
* [4] M. Garcia-Sciveres et al., _The FE-I4 Pixel Readout Integrated Circuit_, Nucl. Instr. Meth. A **636** (2011) S155, url: [http://www.sciencedirect.com/science/article/pii/S0168900210009551](http://www.sciencedirect.com/science/article/pii/S0168900210009551) (cit. on p. 4).
* [5] I. Peric et al., _The FEI3 Readout Chip for the ATLAS Pixel Detector_, Nucl. Instr. Meth. A **565** (2006) 178, url: [http://www.sciencedirect.com/science/article/pii/S0168990206007649](http://www.sciencedirect.com/science/article/pii/S0168990206007649) (cit. on p. 4).
* [6] ATLAS Collaboration, _The ATLAS Collaboration Software and Firmware_, ATL-SOFT-PUB-2021-001, 2021, url: [https://cds.cern.ch/record/2767187](https://cds.cern.ch/record/2767187) (cit. on pp. 4, 7).
* [7] M. Moll, _Displacement Damage in Silicon Detectors for High Energy Physics_, IEEE Transactions on Nuclear Science **65** (2018) 1561 (cit. on p. 5).
* [8] I. Dawson, _Radiation effects in the LHC experiments: Impact on detector performance and operation_, CERN Yellow Reports: Monographs, Geneva: CERN, 2021, url: [https://cds.cern.ch/record/2764325](https://cds.cern.ch/record/2764325) (cit. on p. 5).