Version 2.0 ATLAS-PHYS-NO-106

Particle Level Study of \(\mathbf{W\to q\bar{q}}\) and Jet Algorithms

S. Kuhlmann\({}^{a}\), S. Bettelli\({}^{b}\), A. Bocci\({}^{b}\), D. Costanzo\({}^{b}\), R. Paoletti\({}^{b}\), S. Lami\({}^{c}\)

\({}^{a}\)Argonne National Laboratory,

\({}^{b}\)INFN, University and Scuola Normale Superiore of Pisa, Italy,

\({}^{c}\)Rockefeller University, and INFN Pisa, Italy.

We present to the ATLAS Collaboration a detailed study of the effect of jet algorithms and physics effects on the dijet mass resolution. Most of this study, developed for CDF, applies universally to any jet analysis at hadron collider experiments. We have studied the process \(W\to q\bar{q}\) at the particle level with the PYTHIA and HERWIG monte carlos. New event display and event reconstruction tools were developed which simplify this kind of study. The confusing issue of out-of-cone corrections is clarified for the non-expert. Comparisons of the kt and cone algorithms are made. Extra jet merging and extra jet cuts are investigated. A likelihood analysis of signal+background is described as an example of optimizing the jet cuts.

###### Contents

* 1 Introduction
* 2 The Physics Effects That Contribute To Di-Jet Mass Resolutions
* 3 Our Reconstruction Method and a New Paw-Based Event Display
* 4 Out Of Cone Corrections
* 5 Improving the Low Mass Tails From FSR
	* 5.1 \(K_{T}\) Algorithm Description
	* 5.2 Comparison of Kt and Cone Algorithms
	* 5.3 Variation of Kt Algorithm Parameters
	* 5.4 Merging In Extra Jets With The Cone Algorithm
	* 5.5 A More Sophisticated Method of Merging Jets
	* 5.6 The ABC Jet Algorithm
	* 5.7 Applying Extra Jet Cuts
* 6 Conclusions

## 1 Introduction

Many new physics signatures are expected to appear as multi-jet mass bumps. The best example of this is the process \(W+H\to W+b\bar{b}\). The TeV2000 study of this process concluded that improving the di-jet mass resolution was important in observing the Higgs in this channel. An example of this is Fig. 1, where the signal +background distributions are shown for the nominal CDF resolution and with a resolution improved by 30%. The figure demonstrates that for a marginal signal, such an improvement in resolution can make an important difference in the significance of the excess.

The di-jet mass resolution comes from many sources, but for now we will group these sources into two categories: 1) detector effects such as calorimeter resolution, and 2) algorithm effects such as fluctuations in the energy outside a clustering cone. This is illustrated in Fig. 2, where both histograms come from a \(W\to q\bar{q}\) simulation. The solid histogram is the particle level mass distribution using a cone algorithm with a radius 1.0, no detector effects included. The dashed histogram is the mass distribution with only CDF detector effects, the algorithm effects are removed by using the known particle list. One can see that the two distributions are quite different, with the detector effects tending to dominate the central core of the distribution (\(\sigma=9\) GeV compared to \(\sigma=4\) GeV), while the algorithm effects dominate the tails. Thus both categories of resolution need to be addressed in detail, this note is a first step to study algorithm effects in a general way. Algorithm effects are very physics-dependent, thus in this note we endeavor to present general guidelines and develop the tools needed for any physics analysis to address these issues.

[MISSING_PAGE_EMPTY:3]

Figure 2: The \(W\to q\,\overline{q}\) mass distribution is shown with pure algorithm effects (solid), and pure detector effects (dashed).

The Physics Effects That Contribute To Di-Jet Mass Resolutions

In this section we'll show the four different physics effects that contribute to di-jet mass resolutions. They are: 1) the natural width of the object in question, 2) underlying event fluctuations, 3) final state gluon radiation (FSR), and 4) misidentified jets from initial state gluon radiation (ISR). Fig. 3 shows the effect of the natural width of the W (after FSR is turned off). In some cases this natural width can be the dominant source of tails. Since we are only interested in the true jet algorithm effects, and in the future we will be comparing to Higgs decays which have a negligible width, we will turn off the W width in Pythia for all the remaining plots in this note. After removing the W width, the main cause of the width in fig. 3 are the underlying event fluctuations. They mainly give a gaussian contribution with a width \(\approx 2\) GeV. Since the nominal gaussian width from detector effects (discussed earlier) is much larger than this, the underlying event fluctuations will not be studied in detail in this note.

Fig. 4 shows (now with the W width removed) the effect of FSR. It is the dominant physics effect to be considered, and it is also the effect that is universal to all analyses.

Figure 3: The di-jet invariant mass distribution is shown without final state radiation. The dashed curve is with the nominal W width, and the solid curve is with the W width essentially set to zero.

Figure 4: The di-jet invariant mass for cone 0.4 is shown with the W width set to zero in both curves. The solid curve is the nominal mass distribution, while the dashed curve is with FSR turned off.

Therefore this will be the emphasis of this note.

The final physics effect to be considered is misidentification of the main jets from the W. To illustrate this we select the reconstructed events with mass\(>100\) GeV, and then use the Pythia particle lists to determine what fraction of energy the two jets have coming from the W decay products. We plot the minimum of the two W energy fractions, this is shown in fig. 5. We see that most of these events are coming from one of the two leading jets being from ISR, not the W. It is well known that this can be reduced by either increasing the jet Pt cutoffs, or decreasing the jet \(\eta\) limits. Since this is very physics-analysis dependent we have not pursued this further, but will concentrate on the universal issue of final state radiation.

Finally there is always the issue of Monte Carlo dependence of the radiation. We have compared HERWIG and PYTHIA and find identical mass distributions for cone 0.4, as shown in fig. 6. Therefore the rest of the note will use PYTHIA.

Figure 5: The minimum W energy fraction for the two leading jets is shown, for the reconstructed events with mass\(>100\) GeV.

## 3 Our Reconstruction Method and a New Paw-Based Event Display

* Events are generated with a MonteCarlo (PYTHIA 5.7 or HERWIG 5.9) which accounts for the matrix element of the physics process, PDF, gluon radiation, and parton fragmentation. In our version we enable the decay of all the non-stable particles 1. The calorimeters are simulated as a grid in the coordinates \(\eta\) and \(\phi\) with a granularity similar to the CDF hadron calorimeter. (see figure 7) Footnote 1: For stable particle we intend particles whose mean free path is bigger than detector size, for example pions or muons.
* At this point the energy of each stable particle produced on output by MonteCarlo is deposited in a cell of the grid according to its coordinates \(\eta\) and \(\phi\).
* The information contained in the grid is then used for jet reconstruction.

Note that we are considering just one interation per crossing and we don't have B field effects.

The nominal di-jet invariant mass distributions have been obtained by using the two leading jets with a transverse energy above 15 GeV and within a pseudorapidity interval of \(\pm\) 2.0.

In addition to the reconstruction tools described above, a new Paw-based event display has been developed in order to study pathologies and tails. Fig. 8 is an example of such a display, in this case the results of the cone 0.4 clustering are also shown. You cannot see it

Figure 6: The invariant mass distribution using a cone 0.4 is shown for PYTHIA and HERWIG.

in this note, but the towers with energy from the W are colored blue, while the other towers are red.

Figure 7: Sketch of CDF hadron calorimeter segmenta-

Figure 8: An example of the new Paw-based event display.

## 4 Out Of Cone Corrections

In order to compare the di-jet invariant mass distributions obtained with different jet algorithms we have to rescale the di-jet peaks to the world average W mass. High statistics Pythia \(W\to\overline{q}q\) samples have been produced for different cone size algorithms. As shown in fig. 9, the shift in the peak from the energy loss due to FSR results in out of jet cone leakage which becomes more evident with smaller cone sizes. We fitted the peak region of each distribution with a gaussian and the mean value for the invariant mass together with the \(\sigma_{peak}\) are reported in tab. 1 for a cone size of 0.4, 0.7 and 1.0.

The out-of-cone correction has been studied for each cone size. We first asked for a

Figure 9: Di-jet invariant mass for cone 0.4 (solid), cone 0.7 (dashed), and cone 1.0 (dotted).

[MISSING_PAGE_EMPTY:12]

Figure 10: For cone 0.4, 0.7, 1.0, the mean values of E\({}_{T}\) parton - E\({}_{T}\) jet as a function of E\({}_{T}\) parton (on the left) and E\({}_{T}\) jet (on the right).

Figure 11: The E\({}_{T}\) parton - E\({}_{T}\) jet distributions for cone 0.4 and for four different slices of E\({}_{T}\) jet.

Figure 12: The invariant mass distribution for cone 0.4, 0.7, 1.0, after out-of-cone corrections.

Improving the Low Mass Tails From FSR

In this section we will try to improve the low mass tails visible with all three cone sizes in fig. 12. We will begin by using the \(K_{T}\) algorithm, which has been advocated to improve dijet mass resolution in the past (usually for more complicated events than we are considering, however). We will describe the \(K_{T}\) algorithm in the next subsection, then do a direct comparison between it and the cone algorithm for all three cone sizes. Then we will address the issue of merging in extra jets with the cone algorithm, since the FSR effects that cause the low mass tail will give rise to extra jets. Finally we will take the more specialized case of a relatively high-statistics signal sample, and study extra jet cuts and whether one can further improve the signal significance.

### \(K_{t}\) Algorithm Description

A detailed description of the \(K_{T}\) algorithm can be found in [1]. We briefly summarize here the main steps of the algorithm:

1. Define a list of jets. This is just a list of the four-momenta of hit calorimeter cells.
2. For each jet, \(i\), define: \[D_{i\,B}=p_{i}^{2}\] (1) and for each pair of jets, \(i\), \(j\), define: \[d_{ij} =min(p_{i},p_{ij})^{2}R_{ij}^{2}/R_{cut}^{2},\] (2) \[R_{ij}^{2} =(\eta_{i}-\eta_{j})^{2}+(\phi_{i}-\phi_{j})^{2}.\] (3) \(p_{i}\), \(\eta_{i}\) and \(\phi_{i}\) are, respectively the transverse momentum, rapidity and azimuth of jet \(i\). \(R_{cut}\) is a parameter somehow related to the cluster dimension.
3. Find the smallest number of \(\{d_{ij},D_{i\,B}\}\), and call it \(d_{n}\), where n is the number of jets remaining.
4. If \(d_{n}=d_{ij}\), then merge jets \(i\) and \(j\) to give a single jet with four momentum \[p_{(ij)}=p_{i}\oplus p_{j}\] (4) where \(\oplus\) is some operation defining the recombination criterium which can be chosen in different ways: 1. The covariant E-scheme (the four-momenta of the two jets are summed up) \[p_{(ij)}=p_{i}+p_{j}\] (5) 2. The \(p_{t}\) weighted scheme \[p_{t(ij)}=p_{i}+p_{tj},\] (6) \[\eta_{(ij)}=(p_{i}\eta_{i}+p_{tj}\eta_{j})/p_{t(ij)},\] (7) \[\phi_{(ij)}=(p_{i}\phi_{i}+p_{tj}\phi_{j})/p_{t(ij)}.\] (8)3. The monotonic \(\frac{p_{i}^{2}}{p_{i}^{2}}\)-weighted scheme with \[R_{(i\,j)k}^{2}=\frac{p_{i_{i}}^{2}R_{k}^{2}\,+p_{i_{j}}^{2}R_{jk}^{2}}{p_{i}^{2} +p_{i_{j}}^{2}}\] (9)
5. If \(d_{n}\) = \(d_{B}\) then merge jet \(i\) with the "beam jets" and the jet \(i\) is removed from the list of jets used in further part of the procedure
6. Decide if another iteration is needed. If yes go back to step 2, otherwise the algorithm can stop. Sometimes this uses another parameter _dcut_ to decide whether to end iterations. In a later section we'll see the effect of different _dcut_ values.

[MISSING_PAGE_EMPTY:18]

Figure 14: Comparison of Kt and Cone algorithms with effective cone size 0.7.

Figure 15: Comparison of Kt and Cone algorithms with effective cone size 1.0.

Figure 16: Comparison of various resolution parameters for the Kt and Cone algorithms.

### Variation of Kt Algorithm Parameters

As described earlier, the Kt algorithm has different choices in how to merge jets, as well as different ways to decide to stop iterating. We have compared these choices to see if another set of Kt algorithm parameters would improve its performance significantly. In fig. 17 we compare the 4-vector merging with the pt-weighted merging and see no difference. In terms of deciding to stop iterating, we have not in the previous sections used a _dcut_ parameter to stop iterations. In fig. 18 we compare two different choices of _dcut_ with our default choice of no cut (\(dcut=\infty\)). The changes in mass resolution are small, and our choice is intermediate between the other two choices.

Figure 17: Comparison of different merging schemes within the Kt algorithm.

### Merging In Extra Jets With The Cone Algorithm

Since the \(K_{T}\) algorithm did not provide an improvement in the low mass tails due to FSR, we will return to the cone algorithm with cone size 0.4. We will attempt to improve this tail by merging in extra jets and forming the multi-jet mass. We will only consider the five highest Pt jets, we have found that there are almost no cases where a total of six or more jets are merged. To illustrate the potential usefulness of such merging, we show in fig. 19 the 2-jet and 3-jet mass distributions, and also the multi-jet mass distribution when all the jets are known to have come from the W. Clearly there is a big improvement if one can determine the optimal way to find the correct jets.

There are two main parameters in deciding whether to merge an extra jet, the energy of that extra jet and the distance from the main jet. In order to determine the energy cutoff for merging, we plot in fig. 20 the Et of the jet closest to the second jet (requiring the second jet to have come from the W), for both the cases that the extra jet is from the W and also from ISR. The extra jet from the W is usually harder than ISR, with a transition at 3 GeV. In the following we'll only merge jets above 3 GeV.

In order to decide the distance cut for which jets should be merged, we have investigated the fraction of energy coming from the W. This is shown in fig. 21 for the leading three jets. Clearly the W energy fraction drops as one considers the less energetic jets. We then define two classes of events based on the third jet W energy fraction, those with W energy fraction greater than 80%, and those with W energy fraction less than 20%. The \(\Delta R\) separation between the leading two jets and the third jet is shown in fig. 22 for these two classes, as well as all events. Clearly a merging radius of 1.0 is optimal based on this plot.

In fig. 23 we compare the basic cone 1.0 algorithm with the cone 0.4 algorithm, but now

Figure 18: Comparison of different ways to stop iterating within the \(\,\mathrm{Kt}\) algorithm.

Figure 19: The 2-jet and 3-jet mass distributions are shown, as well as the multi-jet distribution if all the jets come from the W.

Figure 20: The transverse energy of the jet closest to the second jet is shown for ISR jets as well as jets from the W.

Figure 21: The fraction of energy from the W is shown for each of the first three jets.

Figure 22: The delta-R separation between the third jet and the closest leading jet, for the two cases of a large W energy fraction and a small W energy fraction.

with the cone 0.4 jets merged if within \(\Delta R<1.0\). The distributions are almost identical. Notice also that the peak of the merged cone 0.4 algorithm is still at the W mass. This is further evidence that the new type of out-of-cone corrections described earlier is probably best for this kind of analysis.

Finally we would like to understand what effective cone size is really optimal. To do this we will construct a test-case situation with 400 W signal events, and 100000 dijet backgrounds with Pt\(>10\) GeV. We will then perform a likelihood analysis under two hypotheses: 1) background only, 2) signal+background. We will form the \(\Delta\)Log-Likelihood for each case, and look for the best value. This is probably the most quantitative way to answer which cone size is best. We will do this with the cone 0.4 sample, so the events will not change as we systematically change the merging radius of the extra jets. This exercise is shown in fig. 24, with the four cases: 1) no merging, 2) merging within 0.7, 3) merging within 1.0, and 4) merging within 1.3. The best \(\Delta\)Log-Likelihood is with the merging within R=1.0, consistent with the W energy fraction plot showed before. This figure shows there is a qualitative improvement in merging with either R=1.0 or R=1.3 over that with no merging or with merging within 0.7, at least for this physics. The difference between using R=1.0

Figure 23: A comparison of the mass distributions for the cone 1.0 algorithm and the cone 0.4 algorithm (after merging extra jets within \(\Delta\)R=1.0).

and R=1.3 merging is actually quite small.

Figure 24: A test-case signal versus background example is shown. In each case 400 signal events were used, and cone 0.4 clustering was performed. The merging of extra jets around the leading two jets is varied in the four plots. The best change in log-likelihood comes with merging jets with R=1.0.

### A More Sophisticated Method of Merging Jets

As a further attempt to reduce the low mass tail due to final-state radiation, we investigate using the fractional energy of the extra jet rather than a fixed 3 GeV cutoff, and a variable merging radius. The fractional energy is shown in fig. 25 for the extra jets from ISR and from the W, and as was shown earlier the W typically produces more energetic jets. A better way to merge jets should be to expand the merging radius if the energy fraction is large. An algorithm to do this was developed, which is shown as the inset in fig. 26. The resulting mass distribution is shown in the main part of this figure, and indeed it does give a slightly better resolution than the simpler merging of \(\Delta\)R=1.0, but the improvement is small.

Figure 25: The jet energy fraction of the extra jet closest to the second jet is shown for the case where the extra jet comes from the W, and also from ISR.

Figure 26: The more sophisticated merging described in the text (which uses a variable merging radius depending on energy fraction), is compared to the simpler merging of \(\Delta\)R=1.0 described in the last section.

[MISSING_PAGE_FAIL:30]

### Applying Extra Jet Cuts

So far we have attempted to improve the low mass tail while keeping full efficiency for the signal. Now we will turn to the case where we have enough signal events to consider third jet cuts, to further improve the signal to background ratio. We will use the same 400 signal events described above. Fig. 28 shows the effect of applying third jet cuts. It shows the percentage of events in the tails of the mass distribution plotted versus the third jet cut efficiency, for several different values of the third jet cut. The best \(\Delta\)Log-likelihood between signal and background comes with a fairly tight third jet cut of 7 GeV, even though more than half of the signal events are lost. This demonstrates the importance of reducing the tails in these mass distributions.

Figure 28: The percentage of events in the tails of the mass distribution are plotted versus the third jet cut efficiency, for several different values of the third jet cut.

Conclusions

We have motivated the improvement in dijet mass resolution with the TeV 2000 Higgs study, where a 30% improvement in resolution made a large impact in the signal significance. The physics effects and detector effects were directly compared, and the physics effects were shown to dominate the tails. The four different physics effects that contribute to dijet mass resolutions were separated and quantified. The dominant effect is final state gluon radiation, which causes a significant low mass tail. New reconstruction tools and event display tools were developed which greatly simplify this kind of study. The subject of out-of-cone corrections is clarified for the non-expert. We then have done an exhaustive study to improve the low-mass tail. We started by implementing the \(K_{T}\) algorithm, but found it was slightly inferior to the cone algorithm for this physics. Then we returned to the cone algorithm and merged in extra jets, and found the merging radius of 1.0 to be optimal. We then quantified the effect of third jet cuts in improving the signal to background even further.

## References

* [1] M. H. Seymour Zeit. fur Phys. **C**62 127 (1993)