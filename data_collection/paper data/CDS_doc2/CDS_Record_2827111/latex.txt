**Reconstruction, Identification, and Calibration of hadronically decaying tau leptons with the ATLAS detector for the LHC Run 3 and reprocessed Run 2 data**

The ATLAS Collaboration

This document describes the reconstruction algorithms employed by the ATLAS experiment for Run 3 of the LHC to reconstruct, identify, and calibrate hadronically decaying \(\tau\) leptons. The same algorithms are also used for the reprocessed data from Run 2 of the LHC. All algorithms have been improved and optimised with respect to the ones employed during Run 2 data-taking. The energy calibration relies on Monte Carlo simulation samples with hadronic tau lepton decays, and applies a Boosted Regression Tree based on calorimetric energy and tracking momentum measurements. The tau reconstruction and identification algorithms, as well as the electron rejection algorithm, employ Recurrent Neural Networks. The decay mode classification algorithm, based on DeepSet Neural Networks, is used to discriminate among the five main decay topologies. The performance of the deployed algorithms is assessed using Monte Carlo simulations.

## 1 Introduction

The \(\tau\) lepton is the heaviest known lepton and decays with a lifetime of about \(2.9\cdot 10^{-13}\) s [1] and charge equal to \(-1\,e\). The branching ratio of \(\tau\) leptons in final states with hadrons is approximately 65% of the total and these decays display characteristic displacement, multiplicity and kinematic properties. The identification and reconstruction of the hadronically decaying \(\tau\) leptons is important to many LHC measurements [2; 3; 4] and searches [5; 6; 7; 8].

This note describes the updates in the reconstruction, identification and energy calibration of hadronically decaying \(\tau\) leptons in the ATLAS detector [9], introduced for the beginning of the Large Hadron Collider (LHC) Run 3 data-taking. Additionally, the data recorded during the LHC Run 2 has been reprocessed using the same improved algorithms such that future results using data from both data-taking periods will benefit from these improvements. The changes with respect to the methods designed at the beginning of Run 2 [10] are described and the expected performance based on Monte Carlo (MC) simulation are presented. The performance of the \(\tau\) lepton algorithms is evaluated with simulation using Run 2 conditions. Performance improvements regard mainly novel algorithms used for the track classification, \(\tau\) identification, discrimination against electrons and decay mode classification.

After a description of the ATLAS detector in section 2, the simulated samples used for the optimization and determination of performance are summarised in section 3. Reconstruction of the visible component of hadronic \(\tau\) decays (in the following indicated as \(\tau_{\text{had-vis}}\)) is outlined in section 4. The discrimination of \(\tau_{\text{had}}\) decays from the main backgrounds, hadronic jets and electrons are discussed in sections 5 and 6, respectively. Section 7 outlines the classification of the different \(\tau_{\text{had}}\) decay modes, while section 8 presents the \(\tau_{\text{had}}\) energy calibration and resolution.

## 2 ATLAS detector

The ATLAS detector [9] at the LHC covers nearly the entire solid angle around the collision point.1 It consists of an inner tracking detector surrounded by a thin superconducting solenoid, electromagnetic and hadron calorimeters, and a muon spectrometer incorporating three large superconducting air-core toroidal magnets.

Footnote 1: ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point (IP) in the centre of the detector and the \(z\)-axis along the beam pipe. The \(x\)-axis points from the IP to the centre of the LHC ring, and the \(y\)-axis points upwards. Cylindrical coordinates \((r,\phi)\) are used in the transverse plane, \(\phi\) being the azimuthal angle around the \(z\)-axis. The pseudorapidity is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan(\theta/2)\). Angular distance is measured in units of \(\Delta R\equiv\sqrt{(\Delta\eta)^{2}+(\Delta\phi)^{2}}\).

The inner-detector system (ID) is immersed in a 2 T axial magnetic field and provides charged-particle tracking in the range \(|\eta|<2.5\). The high-granularity silicon pixel detector covers the vertex region and typically provides four measurements per track, the first hit normally being in the insertable B-layer (IBL) installed before Run 2 [11; 12]. It is followed by the silicon microstrip tracker (SCT), which usually provides eight measurements per track. These silicon detectors are complemented by the transition radiation tracker (TRT), which enables radially extended track reconstruction up to \(|\eta|=2.0\). The TRT also provides electron identification information based on the fraction of hits (typically 30 in total) above a higher energy-deposit threshold corresponding to transition radiation.

The calorimeter system covers the pseudorapidity range \(|\eta|<4.9\). Within the region \(|\eta|<3.2\), electromagnetic calorimetry is provided by barrel and endcap high-granularity lead/liquid-argon (LAr) calorimeters, with an additional thin LAr presampler covering \(|\eta|<1.8\) to correct for energy loss in material upstream of the calorimeters. The electromagnetic (EM) calorimeter is segmented in three longitudinal layers, preceded by a preshower layer. The first layer is finely segmented in the \(\eta\) direction to provide \(\gamma-\pi^{0}\) separation, and is about 4-5 radiation lengths tick. The middle layer collects most of the electromagnetic shower energy. The last layer is used to correct for leakage behind the electromagnetic calorimeter. Hadron (HAD) calorimetry is provided by the steel/scintillator-tile calorimeter, segmented into three barrel structures within \(|\eta|<1.7\), and two copper/LAr hadron endcap calorimeters in the region \(|\eta|<3.2\). The solid angle coverage is completed with forward copper/LAr and tungsten/LAr calorimeter modules optimised for electromagnetic and hadronic energy measurements, respectively.

The muon spectrometer (MS) comprises separate trigger and high-precision tracking chambers measuring the deflection of muons in a magnetic field generated by the superconducting air-core toroidal magnets. The field integral of the toroids ranges between 2.0 and 6.0 T m across most of the detector. Three layers of precision chambers, each consisting of layers of monitored drift tubes, covers the region \(|\eta|<2.7\), complemented by cathode-strip chambers in the forward region, where the background is highest. The muon trigger system covers the range \(|\eta|<2.4\) with resistive-plate chambers in the barrel, and thin-gap chambers in the endcap regions. Before the start of Run 3 of the LHC, two New Small Wheels [13] replaced the innermost stations of the endcap muon spectrometer, in the range \(1.3<|\eta|<2.7\). While the basic geometry is the same for the two detectors (consisting of 16 pie-shaped sectors), the detector technology has been substantially upgraded. Monitored drift tube, cathode strip and thin gap chambers have been replaced by the novel micromegas (Micro-mesh gaseous structures) detector technology, in combination with small strip thin gap chambers. Moreover, the number of detection planes increased from 4 (in the present cathode strip region) or 8 (in the monitored drift tube region) to 16.

An extensive software suite [14] is used in the reconstruction and analysis of real and simulated data, in detector operations, and in the trigger and data acquisition systems of the experiment.

## 3 Monte Carlo simulation samples

MC simulations are used to develop the \(\tau\) lepton reconstruction methods, to train Multivariated Analysis (MVA) algorithms, and evaluate their performance.

The signal sample consists of \(\gamma^{*}\to\tau\tau\) events generated with Pythia 8.212 [15]. The Pythia 8.212 generator is used for the matrix-element calculation, as well as the simulation of parton shower, hadronisation, underlying event, and \(\tau\) lepton decay. The A14 [16] set of parameters tunes and NNPDF2.3lo[17] as the PDF. The decays of bottom and charm hadrons are performed by EvtGen 1.2.0 [18]. The \(\gamma^{*}\to\tau\tau\) events use a biased phase space sampling to populate the generated spectrum towards high invariant masses (\(m_{\gamma^{*}}\)) to provide a sufficient statistics of high-\(p_{\mathrm{T}}\)\(\tau_{\mathrm{had-vis}}\) up to 1 \(\mathrm{TeV}\). In addition, the absence of amplitudes mediated by a \(Z\) boson provides a more uniform sample of \(\tau\) leptons in terms of helicity as a function of \(\tau_{\mathrm{had}}\)\(p_{\mathrm{T}}\). All \(\tau\) leptons in the simulated \(\gamma^{*}\to\tau\tau\) events are forced to decay hadronically.

The algorithms are optimised using background samples of dijet events, simulated using Pythia 8.230 [15] with leading-order matrix elements for dijet production which are matched to the parton shower. The renormalisation and factorisation scales were set to the geometric mean of the squared transverse masses of the two outgoing particles in the matrix element, \(\hat{p}_{\mathrm{T}}=\sqrt{(p_{\mathrm{T},1}^{2}+m_{1}^{2})(p_{\mathrm{T},2}^ {2}+m_{2}^{2})}\). The NNPDF2.3lo PDFset is used in the ME generation, the parton shower, and the simulation of the multi-parton interactions. The A14 set of tuned parameters is used. To populate the inclusive jet \(p_{\mathrm{T}}\) spectrum efficiently, the sample used a biased phase-space sampling which was compensated for by a continuously decreasing weight for the event. Specifically, events at a scale \(\hat{p}_{\mathrm{T}}\) scale were oversampled by a factor of \((\hat{p}_{\mathrm{T}}/10\,\mathrm{GeV})^{4}\).

Furthermore, the \(Z\to ee\) and Drell-Yan \(e^{+}e^{-}\) samples were generated with Pythia 8.212. The latter samples cover the high-\(p_{\mathrm{T}}\) part of the spectrum.

For all the simulated samples, the effects of simultaneous proton-proton collisions in the same and nearby bunch-crossings to the collision of interest are included. The beam spot weights [19] are considered to account for the difference of the beam spot width in data and simulated samples. A full simulation of the ATLAS detector [20] based on Geant4[21] was used to reproduce the detector response. The detector simulation traces the energy loss of particles with a signficant life time, such as \(\tau\) leptons, originating from the interaction point when crossing the detector. This effect is particularly important for high-\(p_{\mathrm{T}}\)\(\tau\) leptons that can leave energy signatures in the detector before decaying.

## 4 Reconstruction

The \(\tau_{\mathrm{had-vis}}\) candidates are seeded by jets formed using the anti-\(k_{t}\) algorithm [22], with a distance parameter of 0.4. Three-dimensional clusters of calorimeter cells called TopoClusters [23], calibrated using a local hadronic calibration (LC), serve as inputs to the jet algorithm. Jets seeding \(\tau_{\mathrm{had-vis}}\) candidates are required to have a transverse momentum \(p_{\mathrm{T}}>5\,\mathrm{GeV}\) and \(|\eta|<2.5\). The transverse momentum requirement is applied on LC energy of the jet, before any jet energy scale corrections.

The performance of the efficiencies and calibration in this note are evaluated for \(\tau_{\mathrm{had-vis}}\) candidates with \(|\eta|<2.5\), outside the transition region \(1.37<|\eta|<1.52\) between the barrel and forward calorimeters, and with a reconstructed \(p_{\mathrm{T}}>20\,\mathrm{GeV}\), after the calibration described in Section 8.

### Vertex association

During the \(pp\) collisions, multiple simultaneous interactions occur and several interaction vertices are reconstructed. Most particles are assumed to originate at the primary vertex, defined as the vertex with the highest sum of the squared transverse momenta of the associated tracks, \(\Sigma p_{\mathrm{T}}^{2}\)(tracks associated with the vertex). As \(\tau\) leptons travel away from the primary vertex before decaying, a dedicated \(\tau\) vertex association algorithm (TJVA) [24] is implemented to identify the correct production vertex for each \(\tau_{\mathrm{had-vis}}\) candidate. The \(\tau\) production vertex is used in the \(\tau_{\mathrm{had-vis}}\) reconstruction instead of the primary vertex. It is important to choose the correct vertex since quantities such as the impact parameter are calculated relative to the chosen vertex and it can affect which tracks are associated with the \(\tau_{\mathrm{had-vis}}\) candidate. The parameters of the tracks associated to the \(\tau_{\mathrm{had-vis}}\) candidates are recalculated relative to the \(\tau\) production vertex.

In preparation for Run 3, the vertexing algorithm [25] used in ATLAS has been updated to deal with the high pile-up environment, therefore, the TJVA was retuned. The overall method is based on the \(p_{\mathrm{T}}\) fraction of a given vertex \(f_{p_{\mathrm{T}}}\):

\[f_{p_{\mathrm{T}}}=\frac{\Sigma p_{\mathrm{T}}(\mathrm{tracks\ associated\ with\ the\ vertex})}{\Sigma p_{\mathrm{T}}(\mathrm{all\ tracks})}, \tag{1}\]where all tracks within \(\Delta R\) < 0.2 of the seed jet are considered. For Run 3, the tracks associated with the vertex are determined by a different method based on the output of the Adaptive Multi-Vertex Reconstruction (AMVF) algorithm [26]. The vertex with the highest \(f_{\mathrm{PT}}\) fraction is chosen as the \(\tau\) production vertex and is used in the following to determine the \(\tau_{\mathrm{had-vis}}\) direction, to associate tracks and to build the coordinate system in which identification variables are calculated. The efficiency for choosing the correct \(\tau\) production vertex compared to the primary vertex is shown in Fig. 1 as a function of \(\tau_{\mathrm{had-vis}}\)\(p_{\mathrm{T}}\) and the average number of simultaneous \(pp\)-collisions for the 1-prong and 3-prong \(\tau_{\mathrm{had-vis}}\) candidates. The \(\tau\) production vertex performance is compared to the primary vertex and is found to give a better efficiency throughout, particularly at low \(p_{\mathrm{T}}\).

The \(\tau_{\mathrm{had-vis}}\) four-momentum is calculated by first computing \(\eta\) and \(\phi\) of the barycentre of the TopoClusters of the seed jet, calibrated at the LC scale, assuming a mass of zero for each constituent. The four-momenta

Figure 1: The efficiency to select the correct \(\tau\) production vertex using TJVA or the default primary vertex with \(\Sigma p_{\mathrm{T,tracks}}^{2}\) in \(\gamma^{*}\to\tau\tau\) events. The efficiency is shown as a function of the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\) (top) and \(p_{\mathrm{T}}(\tau_{\mathrm{had-vis}})\) (bottom), for truth 1-prong \(\tau_{\mathrm{had}}\) decays (left) and truth 3-prong \(\tau_{\mathrm{had}}\) decays (right).

of all clusters in the region \(\Delta R\) < 0.2 around the barycentre are recalculated using the \(\tau\) production vertex coordinate system and summed, providing the momentum magnitude and direction of the \(\tau_{\text{had-vis}}\).

### Track to \(\tau\) lepton association and track classification

Tracks are associated with the \(\tau_{\text{had-vis}}\) if they are in the core region \(\Delta R\) < 0.25 around the \(\tau_{\text{had-vis}}\) direction and satisfy the following criteria: \(p_{\text{T}}\) > 1 GeV, at least two associated hits in the pixel layers of the inner detector, and at least seven hits in total in the pixel and the SCT layers. Furthermore, association requirements are imposed on the distance of closest approach of the track to the \(\tau\) production vertex (vertex chosen by TJVA) in the transverse plane, \(|d_{0}^{\text{TJVA}}|\) < 1.0 mm, and longitudinally, \(|z_{0}^{\text{TJVA}}\sin\theta|\) < 1.5 mm. Tracks in the region 0.25 < \(\Delta R\) < 0.4 are associated as well to the \(\tau_{\text{had-vis}}\) if either they are matched to the seeding jet by a ghost-particle association technique [27, 28, 29] or if the closest jet to the track in terms of \(\Delta R\) distance is the \(\tau_{\text{had-vis}}\) seeding jet.

To correctly establish the charge and the number of charged decay products of a \(\tau\) lepton, the tracks that are associated with the \(\tau\) decay need to be correctly distinguished from the rest. Using a track classifier, tracks that have passed the \(\tau\) jet association requirements are classified into four categories:

* **Tau Tracks (TT)**: Tracks originating from charged \(\tau\) lepton decay products, i.e. \(\pi^{\pm}\). These are used to determine the charge and the number of charged decay products of the \(\tau\) lepton.
* **Conversion Tracks (CT)**: Tracks from electrons and positrons that are created from photon conversion in the detector. These are used in the reconstruction and identification of \(\pi^{0}\) mesons and in the rejection of truth electrons that are reconstructed as \(\tau_{\text{had}}\) candidates.
* **Isolation Tracks (IT)**: Tracks which are likely originating from quark or gluon jets arising from the remnants of the hard scattering interactions. These tend to have higher track multiplicities, a wider opening angle and a softer \(p_{\text{T}}\) spectrum than tracks from \(\tau_{\text{had}}\) decays.
* **Fake Tracks (FT)**: Tracks that don't belong to the previous categories, mainly misreconstructed tracks and pile-up tracks.

A novel approach for the \(\tau\) lepton track classification using a recurrent neural network (RNN) has evolved from a BDT-based method that was used during Run 2. RNNs are specifically chosen amongst other types of neural networks because, using Bi-directional Long Short Term Memory (BLSTM) cells, they allow information to be backpropagated through time resulting in the forward and backward correlation in a sequence of tracks belonging to the \(\tau\) lepton decay to be exploited. Additionally, RNNs have a

\begin{table}
\begin{tabular}{l l l} \hline \hline Layer & Number of nodes & Activation \\ \hline Dense Layer 1 & [70, 80, 90] & ReLU [30] \\ BLSTM Layer 1 & [20, 30, 40] & ReLU \\ BLSTM Layer 2 & [20, 30, 40] & ReLU \\ BLSTM Layer 3 & [20, 30, 40] & ReLU \\ Dense Layer 2 & [35, 45, 55] & ReLU \\ Dense Layer 3 & 4 & Softmax [31] \\ \hline \hline \end{tabular}
\end{table}
Table 1: Architecture of the track classification RNN.

flexible architecture which allows for tracks to be treated dynamically as an input of variable length per \(\tau\) candidate.

The RNN network architecture is given in Table 1 and uses three connected dense layers. The first dense layer is connected to the variable input i.e. the tracks of the \(\tau_{\text{had-vis}}\) candidate. The three BLSTM layers are configured between the first two dense layers. The size and number of nodes of the dense and BLSTM layers are optimised to provide the best performance in terms of loss and accuracy of the model. The output layer comprises four nodes each associated with a track classifier category. All the layers except the final dense layer are connected with Rectified Linear Units (ReLU) [30]. A schematic of the full RNN architecture can be seen in Fig. 2.

The RNN is trained using Keras[32] and TensorFlow[33], and is applied to the sequence of \(p_{\text{T}}\)-ordered tracks associated with each \(\tau_{\text{had-vis}}\) candidate. The maximum number of tracks per \(\tau_{\text{had-vis}}\) candidate is set to 30, this number is sufficient to include the majority of tracks that are of interest. The output of the RNN is a class probability assigned to each track. The signal and background training data sets used are \(\gamma^{*}\to\tau\tau\) and dijet, respectively, and only \(\tau_{\text{had-vis}}\) candidates with \(p_{\text{T}}>5.5\) GeV are considered. The dijet sample is divided into 8 regions of \(p_{\text{T}}\) and additionally divided into hard scatter jets and pile-up jets. This differentiation allowed for better discriminating power between the four categories by restricting the number of pile-up jets that the RNN was exposed to. The training data set size corresponds to 1 million signal candidates and 200,000 background per \(p_{\text{T}}\) region. Both samples are split into three sets: input for the training, validation throughout the training and performance evaluation.

The RNN utilises several input variables which describe the kinematic, geometric and detector hit distribution of the tracks. These variables have been chosen to either provide separation power between the four resulting classes (e.g. \(\eta^{\text{track}}\)) or to parameterise the network (e.g. \(p_{\text{T}}^{\text{seed-jet}}\)). The variables and their definitions are listed in Table 2.

Figure 2: Schematic of the track classification RNN architecture, the configurations of the first dense layer, BLSTM layer and second layer are chosen using a hyperparameter scan. The last dense layer configuration is fixed and results in 4 output probabilities for each input track. The classification category with the highest probability is then assigned to the track.

The two primary measures to evaluate the performance of the track classifier are the \(\tau_{\text{had-vis}}\) reconstruction efficiency and confusion matrix of the classification categories. The confusion matrices are 2-dimensional matrices that compare the classification of a track by the RNN and its truth classification are shown in Fig. 3. These are normalised to the truth track type and give the probability that a track belonging to a given truth type gets classified in a particular category.

Figure 4 shows the number of reconstructed tracks for truth \(\tau\) leptons decaying into one and three charged particles. The efficiencies of correctly classifying 1- or 3-tracks originating from truth 1-prong and 3-prong \(\tau\) leptons, respectively, is shown in Fig. 5 as a function of the \(p_{\text{T}}(\tau_{\text{had-vis}})\) and the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\). The reduction of efficiency for truth 3-prong \(\tau\) leptons of high-\(p_{\text{T}}\) is related to the smaller curvature and angular separation of the \(\tau\) lepton decay products. Compared to the algorithm deployed at the beginning of Run 2 [10], the average track association efficiency for 1-prong \(\tau\) leptons improved from about 70% to more than 90%, and for 3-prong \(\tau\) leptons from 65% to about 75%.

\begin{table}
\begin{tabular}{l l} \hline \hline Variable & Description \\ \hline \(\ln\) (\(p_{\text{T}}^{\text{track}}\)) & Logarithm of the transverse momentum of the track \\ \(\ln\) (\(p_{\text{T}}^{\text{seed-jet}}\)) & Logarithm of the transverse momentum of the seed jet \\ \(\frac{p_{\text{T}}^{\text{track}}}{p_{\text{T}}^{\text{seed-jet}}}\) & Ratio between the transverse momentum of the track and seed jet \\ \(\eta^{\text{track}}\) & Pseudo-rapidity of the track \\ \(z_{0}^{\text{TIVA}}\sin\theta\) & Tau vertex longitudinal impact parameter \\ \(\ln(r^{\text{Conv}})\) & Logarithm of the radius of track conversion \\ \(\tanh\left(\frac{r^{\text{Cont}}}{500}\right)\) & Hyperbolic tangent of the radius of track conversion \\ \(\Delta R\)(track,seed-jet) & Radial distance of the track and seed jet axis \\ \(\tanh\left(\frac{d_{0}^{\text{TIVA}}}{10}\right)\) & Hyperbolic tangent of the transverse impact parameter \\ \(\frac{q^{\text{track}}}{p_{\text{T}}^{\text{track}}}\) & Ratio of the transverse momentum and the charge of the track \\ \hline Detector hit variable & Definition \\ \hline \(N_{\text{IBL}}\) & Number of hits in the innermost layer of the pixel detector \\ \(N_{\text{shared Pixel}}\) & Number of hits in the pixel detector shared by multiple tracks \\ \(N_{\text{shared SCT}}\) & Number of hits in the SCT shared by multiple tracks \\ \(N_{\text{Pixel}}\) & Number of hits in the pixel detector \\ \(N_{\text{TRT}}\) & Number of hits in the TRT \\ \(N_{\text{SCT}}\) & Number of hits in the SCT \\ \(q^{\text{track}}\) & Charge of the track \\ \(p_{e}^{\text{IHT}}\) & Electron probability determined from high-threshold (HT) hits in the TRT, \\  & that originate from transition radiation caused by highly relativistic particles traversing the radiator material around each straw \\ \hline \hline \end{tabular}
\end{table}
Table 2: Input variables to the RNN Track Classifier.

## 5 Identification

During Run 2, a novel \(\tau_{\rm had}\) identification algorithm [34] was introduced to separate truth \(\tau_{\rm had-vis}\) and misidentified \(\tau_{\rm had-vis}\) originating from quark- and gluon-initiated jets. This algorithm is based on a RNN and employs information from reconstructed charged-particle tracks and clusters of energy in the calorimeter associated to \(\tau_{\rm had-vis}\) candidates as well as high-level discriminating variables. Compared to the BDT identification algorithm deployed at the beginning of Run 2 [10], the improvement in rejection of

Figure 3: Probabilities to reconstruct a given truth track type as a certain track type, for truth 1-prong \(\tau_{\rm had}\) decays (left) and truth 3-prong \(\tau_{\rm had}\) decays (right) with the RNN track classifier in the \(\gamma^{*}\rightarrow\tau\tau\) events. \(\tau\) lepton tracks, conversion tracks, isolation tracks and fake tracks, are denoted as TT, CT, IT and FT, respectively. The values along each column sum 100%, such that the RNN track classification efficiencies are given for each individual truth track type. The diagonal efficiency is defined as the weighted average of the correctly identified truth track types.

misidentified \(\tau_{\rm had}\) candidates for the same identification efficiency is in the range 75-100%, depending on the \(\tau_{\rm had-vis}\)\(p_{\rm T}\) and the number of tracks. The RNN algorithm has not been changed for the Run 2 data reprocessing, except that it has been retrained with the \(\tau_{\rm had-vis}\) candidates described in Section 4. The training procedure as well as the \(\tau_{\rm had}\) identification performance are discussed below.

The RNN architecture is the same as in Ref. [34], and it has three input branches, one for track variables, one for cluster variables and one for high level jet variables.

The RNN-based \(\tau\) identification algorithm is trained using simulated samples of \(\tau_{\rm had-vis}\) candidates introduced in Section 3. Reconstructed \(\tau_{\rm had-vis}\) candidates from \(\gamma^{*}\to\tau\tau\) are required to be geometrically matched to \(\tau_{\rm had-vis}\) at the truth level and correctly reconstructed as 1-prong or 3-prong decays. Reconstructed \(\tau_{\rm had-vis}\) candidates not originating from \(\tau_{\rm had}\) decays are taken from simulated di-jet samples and are required to be reconstructed as 1-prong or 3-prong \(\tau_{\rm had-vis}\) candidates. Due to the distinct signatures of 1-prong and 3-prong \(\tau_{\rm had}\) decays, the training is performed separately for 1-prong and 3-prong \(\tau_{\rm had-vis}\) candidates. The input variables used for the respective 1-prong and 3-prong RNNs are listed in Table 3. The sample of background \(\tau_{\rm had-vis}\) candidates is reweighted, separately for 1-prong and 3-prong candidates, in bins of \(\tau_{\rm had-vis}\)\(p_{\rm T}\) to match the \(p_{\rm T}\) distributions of truth \(\tau_{\rm had-vis}\) in \(\gamma^{*}\to\tau\tau\) events. This procedure ensures that no \(p_{\rm T}\)-dependent bias is introduced in the trained classifier as the dijet \(\tau_{\rm had-vis}\) candidate \(p_{\rm T}\) distribution is softer when compared to the signal \(\tau_{\rm had-vis}\) sample.

The available sample of \(\tau_{\rm had-vis}\) candidates consists of approximately 14 million signal candidates and 83 million background candidates after selection. The sample is split into dedicated samples for training of the network (50%), monitoring of training progress (10%) and performance evaluation (40%).

The RNN training is performed in the same way as in Ref. [34], using Keras and TensorFlow. The output score of the RNN-based \(\tau\) identification for truth \(\tau_{\rm had-vis}\) in \(\gamma^{*}\to\tau\tau\) samples is transformed to be uniform in [0, 1] in bins of reconstructed \(\tau_{\rm had-vis}\)\(p_{\rm T}\) and average number of interactions per bunch-crossing \(\langle\mu\rangle\). The working points of the \(\tau\) identification are then defined by a requirement on the transformed (flattened) score. This procedure removes the dependency of the truth \(\tau_{\rm had-vis}\) efficiency on the reconstructed \(\tau_{\rm had-vis}\)\(p_{\rm T}\) and \(\langle\mu\rangle\).

Figure 5: Efficiency to reconstruct and identify the correct number of \(\tau\) lepton tracks for truth \(\tau_{\rm had}\) decays in \(\gamma^{*}\to\tau\tau\) events as a function of \(p_{\rm T}(\tau_{\rm had-vis})\) (left) and the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\) (right).

The RNN uses a combination of low-level input variables for individual tracks and clusters that are associated to the \(\tau_{\text{had-vis}}\) candidate as well as several high-level observables calculated from track and calorimeter quantities. All the input variables introduced in Ref. [34] were used in the training, except of the seed-jet, \(p_{\text{T}}^{\text{seed-jet}}\), the transverse and longitudinal impact parameters, \(d_{0}^{\text{track}}\) and \(z_{0}^{\text{track}}\sin\theta\), respectively. Instead, the following variables were used: transverse momentum of the \(\tau_{\text{had-vis}}\) candidate, \(p_{\text{T}}^{\tau_{\text{had-vis}}}\), the transverse and longitudinal impact parameters, \(d_{0}^{\text{TIVA}}\) and \(z_{0}^{\text{TIVA}}\sin\theta\), together with their significances \(S(d_{0}^{\text{TIVA}})\) and \(S(z_{0}^{\text{TIVA}}\sin\theta)\), where TIVA is introduced in Section 4.1.

The performance of the RNN \(\tau_{\text{had}}\) identification algorithm is evaluated on statistically independent test samples of \(\gamma^{*}\rightarrow\tau\tau\) (signal) and dijet (background) events as discussed in Section 3. Figure 6 shows the rejection of misidentified \(\tau\) candidates, defined as the inverse of the background selection efficiency, for misidentified \(\tau_{\text{had-vis}}\) depending on the truth \(\tau_{\text{had-vis}}\) selection efficiency, independently for 1-prong and 3-prong \(\tau_{\text{had-vis}}\) candidates.

\begin{table}
\begin{tabular}{c l c c} \hline \hline  & Variable & Description & 1-prong & 3-prong \\ \hline \multirow{10}{*}{**Night**} & \(p_{\text{T}}^{\text{Trad-vis}}\) & Transverse momentum of the \(\tau_{\text{had-vis}}\) candidate & ✓ & ✓ \\  & \(p_{\text{T}}^{\text{track}}\) & Transverse momentum of each associated track & ✓ & ✓ \\  & \(\Delta\eta^{\text{track}}\) & Angular distance between the track and \(\tau_{\text{had-vis}}\) axis & ✓ & ✓ \\  & \(\Delta\phi^{\text{track}}\) & Angular distance between the track and \(\tau_{\text{had-vis}}\) axis & ✓ & ✓ \\  & \(N_{\text{IBL}}\) & Number of hits in the innermost layer of the pixel detector & ✓ & ✓ \\  & \(N_{\text{pixel}}\) & Number of hits in the pixel detector & ✓ & ✓ \\  & \(N_{\text{SCT}}\) & Number of hits in the SCT & ✓ & ✓ \\  & \(z_{0}^{\text{TJVA}}\sin\theta\) & Tau vertex longitudinal impact parameter & ✓ & ✓ \\  & \(d_{0}^{\text{TJVA}}\) & Tau vertex transverse impact parameter & ✓ & ✓ \\  & \(S(z_{0}^{\text{TJVA}}\sin\theta)\) & Tau vertex longitudinal impact parameter divided by its uncertainty & ✓ & ✓ \\  & \(S(d_{\text{TJVA}}^{\text{TJVA}})\) & Tau vertex transverse impact parameter divided by its uncertainty & ✓ & ✓ \\ \hline \multirow{10}{*}{**Night**} & \(p_{\text{T}}^{\text{Trad-vis}}\) & Transverse momentum of the \(\tau_{\text{had-vis}}\) candidate & ✓ & ✓ \\  & \(E_{\text{T}}^{\text{cluster}}\) & TopoCluster transverse energy & ✓ & ✓ \\  & \(\Delta\eta^{\text{cluster}}\) & The angular distance between the TopoCluster and the \(\tau_{\text{had-vis}}\) axis & ✓ & ✓ \\  & \(\Delta\phi^{\text{cluster}}\) & The angular distance between the TopoCluster and the \(\tau_{\text{had-vis}}\) axis & ✓ & ✓ \\  & \(\langle\lambda_{\text{centre}}\rangle\) & Mean distance of the cluster shower centre from the calorimeter & ✓ & ✓ \\  & & front face measured along the shower axis. & & \\  & \(\langle\lambda^{2}\rangle\) & Mean distance of a cell from the shower centre along the shower axis & ✓ & ✓ \\  & \(\langle r^{2}\rangle\) & Second moment in the radial distance of cluster cells from the cluster axis. & ✓ & ✓ \\ \hline \multirow{10}{*}{**Night**} & \(p_{\text{T}}^{\text{Trad-vis}}\) & Transverse momentum of the \(\tau_{\text{had-vis}}\) candidate & ✓ & ✓ \\  & \(f_{\text{Cant}}^{\text{Cant}}\) & Fraction of transverse energy at EM scale deposited in the region & ✓ & ✓ \\  & & \(\Delta R<0.1\) with respect to all energy deposited in \(\Delta R<0.2\) & & \\  & & around the \(\tau_{\text{had-vis}}\) candidate axis & & ✓ \\  & \(f_{\text{lead-track}}^{-1}\) & The transverse energy sum, calibrated at the EM energy scale, deposited in all & ✓ & ✓ \\  & & cells belonging to TopoClusters in the core region, divided by the & \\  & \(\Delta R_{\text{max}}(\text{track},\tau_{\text{had}})\) & The maximum \(\Delta R\) between a core track associated with & ✓ & ✓ \\  & & the \(\tau_{\text{had-vis}}\) candidate and the \(\tau_{\text{had-vis}}\) direction. & & \\  & \(S_{\text{T}}^{\text{flight}}\) & The decay length of the secondary vertex in the transverse plane, calculated & & ✓ \\  & & with respect to the \(\tau\) vertex, divided by its estimated uncertainty & \\  & \(f_{\text{track}}^{\text{iso}}\) & Scalar sum of the \(p_{\text{T}}\) of isolation tracks associated with the \(\tau_{\text{had-vis}}\) candidate & ✓ & ✓ \\  & \(f_{\text{track}}^{\text{EM}}\) & Ratio of the sum of cluster energy deposited in the electromagnetic part of & ✓ & ✓ \\  & & the TopoClusters (pre-sampler, first and second layers of the LAr calorimeter) & & \\  & \(p_{\text{T}}^{\text{EM+track}}/p_{\text{T}}\) & Ratio of the \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\), estimated using the vector sum of core track & ✓ & ✓ \\  & & momenta and up to two most energetic EM clusters in the core region to & \\  & & the calorimeter-only measurement of \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\). & \\  & & Invariant mass of the system composed of the core tracks and up to two most & ✓ & ✓ \\  & & energetic EM clusters in the core region and the four-momentum of an EM & \\  & & cluster is calculated assuming zero mass and using TopoCluster seed direction. & \\  & & Invariant mass calculated from the sum of the four-momenta of all core & & ✓ \\  & & and isolation tracks, assuming a pion mass for each track & \\ \hline \hline \end{tabular}
\end{table}
Table 3: Variables used as input in the \(\tau_{\text{had}}\) identification RNN. The last two columns indicate if a given variable was used in the 1-prong and/or 3-prong case.

The residual dependencies of the reconstruction and identification efficiencies as a function of \(p_{\mathrm{T}}\) and \(\langle\mu\rangle\) after applying the score flattening procedure are shown in Fig. 7 for 1-prong and 3-prong \(\tau_{\mathrm{had-vis}}\). Also displayed is the combined reconstruction and identification efficiency of the \(\tau\) lepton candidates. Signal efficiencies are summarised in Table 4 for each working point. Tighter working points are chosen for 3-prong \(\tau_{\mathrm{had-vis}}\) to reduce the rate of misidentified \(\tau_{\mathrm{had}}\) candidates from dijet events.

Inverse of the efficiency (rejection) for misidentified 1-prong and 3-prong \(\tau_{\mathrm{had}}\) candidates from dijet events are shown in Fig. 8 as a function of \(p_{\mathrm{T}}\) and \(\langle\mu\rangle\). The rejection of misidentified \(\tau_{\mathrm{had}}\) candidates increases towards high \(p_{\mathrm{T}}\) and decreases toward high numbers of pile-up interactions, especially for the Tight working point.

\begin{table}
\begin{tabular}{l c c} \hline \hline  & Truth \(\tau_{\mathrm{had}}\) efficiency \\ Working point & 1-prong & 3-prong \\ \hline Tight & 60\% & 45\% \\ Medium & 75\% & 60\% \\ Loose & 85\% & 75\% \\ Very Loose & 95\% & 95\% \\ \hline \hline \end{tabular}
\end{table}
Table 4: List of defined working points with fixed truth \(\tau_{\mathrm{had-vis}}\) selection efficiencies for the RNN classifier.

Figure 6: Inverse of the efficiency (rejection) for misidentified 1-prong and 3-prong \(\tau_{\mathrm{had}}\) candidates from dijet background events as a function of the efficiency for truth \(\tau_{\mathrm{had}}\) originating from \(\gamma^{*}\rightarrow\tau\tau\) events. The two lines refer to 1-prong and 3-prong \(\tau_{\mathrm{had}}\) candidates and markers demonstrate individual working points (Very Loose, Loose, Medium, Tight).

Figure 7: Efficiency for \(\tau_{\text{had-vis}}\) identification (full symbols) and combined reconstruction and identification efficiency (open symbols) as a function of the \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\) (left) and of the average number of interaction per bunch-crossing, \(\langle\mu\rangle\), (right) for 1-prong (top) and 3-prong (bottom) \(\tau_{\text{had-vis}}\) candidates using the \(\gamma^{*}\to\tau\tau\) events. Values for Loose, Medium and Tight working points are shown.

Figure 8: Inverse of the efficiency (rejection) for misidentified 1-prong and 3-prong \(\tau_{\text{had}}\) candidates from dijet events as a function of \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\) (left) and of the average number of interaction per bunch-crossing, \(\langle\mu\rangle\), (right) for 1-prong (top) and 3-prong (bottom) \(\tau_{\text{had-vis}}\) candidates using dijet events. Values for Loose, Medium and Tight working points are shown.

## 6 Electron discrimination

Electrons can be misidentifed as \(\tau_{\text{had-vis}}\) objects. In some analyses, electrons can be a significant background contribution after all the jet-related backgrounds are suppressed via kinematic, topological and \(\tau_{\text{had-vis}}\) identification criteria. Despite the similarities of the electron signature, especially with 1 prong \(\tau_{\text{had-vis}}\), there are several properties that can be used to discriminate them, like the transition radiation that is emitted by highly relativistic particles -in particular electrons- when traversing the radiator material that surrounds the straws of the TRT detector, or the shape of the calorimetric energy deposits in combination with the track information. These properties have been used to define a new electron veto algorithm (eVeto) specialised in the rejection of electrons misidentified as \(\tau_{\text{had-vis}}\).

The BDT-based eVeto used during Run 2 [10] has been replaced by a novel approach based on RNN. A specific training for 3-prong \(\tau\) leptons has been added and the number of working points has increased from one to three. The RNN algorithm uses track and calorimeter information in a recurrent neural network to separate electrons from \(\tau_{\text{had-vis}}\). The internal state of recurrent layers allows processing of sequences of _a-priori_ unknown length. Reconstructed tracks and clusters of the \(\tau_{\text{had-vis}}\) object are processed as a \(p_{\text{T}}\)-ordered sequence.The eVeto algorithm is trained using simulated samples of \(\tau_{\text{had-vis}}\) candidates. Truth \(\tau_{\text{had-vis}}\) candidates from \(\gamma^{*}\rightarrow\tau\tau\) are required to be geometrically matched t \(\tau_{\text{had-vis}}\) at generator level and correctly reconstructed as one or three prong decays. For the background sample, reconstructed \(\tau_{\text{had-vis}}\) candidates from \(Z\to ee\) processes described in Section 3 are used. In both cases, the \(\tau_{\text{had-vis}}\) are required to pass the Medium \(\tau_{\text{had}}\) identification working point. Dedicated neural networks are trained for the 1-prong and 3-prong cases, respectively. The reconstructed \(p_{\text{T}}\) of the \(\tau_{\text{had-vis}}\) is used to reweight separately the two cases. This procedure ensures that no \(p_{\text{T}}\)-dependent bias is introduced in the trained classifier. The RNN is trained using Keras and TensorFlow. The training is performed by minimising the binary cross-entropy loss function, measuring the classification performance, with respect to the randomly initialised weights of the network. For the minimization stochastic gradient descent (SGD) is used. The convergence of the optimisation is improved by the use of momentum [35] and a stepwise reduction of the optimiser's learning rate when the loss on the monitoring sample stopped decreasing. The RNN employs both the features of the \(\tau_{\text{had-vis}}\) object, as well as the properties of the tracks and clusters associated to it. Figure 5 and 6 show respectively the list of the RNN variables of the \(\tau_{\text{had-vis}}\) and of the tracks and clusters associated to it. Figure 9 shows the distribution of selected variables of the \(\tau_{\text{had-vis}}\) candidates for \(\gamma^{*}\rightarrow\tau\tau\) signal and \(Z\to ee\) background, used in the RNN training.

The input variables described in Table 5 and 6 are transformed by using the logarithm function to observables spanning multiple orders of magnitude, and are normalised to values between 0 and 1. This procedure makes them more suitable for the SGD minimization process. The output score of the algorithms is transformed in order to provide a uniform efficiency w.r.t \(p_{\text{T}}\) and \(\eta\) of the truth \(\tau_{\text{had-vis}}\). Figure 10 shows the \(\tau\) lepton efficiency and electron rejection factor as a function of the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\) and of the \(p_{\text{T}}\) of 1-prong \(\tau_{\text{had-vis}}\) for the provided working points. For 3-prong \(\tau_{\text{had-vis}}\), the \(\tau\) lepton efficiency and electron rejection factor as a function of \(\langle\mu\rangle\) and of \(p_{\text{T}}\) are shown in Fig. 11. Figure 12 shows the rejection of misidentified \(\tau_{\text{had-vis}}\) candidates, defined as the inverse of the background selection efficiency, as a function of the truth \(\tau_{\text{had-vis}}\) selection efficiency for 1-prong and 3-prong \(\tau_{\text{had-vis}}\) candidates. Three independent working points are defined for for 1-prong and 3-prong \(\tau_{\text{had-vis}}\) candidates. A rejection factor of about 300 (200) for electrons background is achieved while retaining a signal efficiency of 95% for 1-prong (3-prong) \(\tau_{\text{had-vis}}\). The algorithm provides about a factor three better rejection for the same \(\tau_{\text{had-vis}}\) efficiency with the respect to the previous BDT-based eVeto [10].

\begin{table}
\begin{tabular}{l l c} \hline \hline Variable & Description & 1 prong & 3 prong \\ \hline \(p_{\mathrm{T}}^{\mathrm{seed\_jet}}\) & Transverse momentum of the seed jet & ✓ & ✓ \\ \(|\eta^{\mathrm{lead\_track}}|\) & Pseudo-rapidity of the highest track associated to the \(\tau_{\mathrm{had\_vis}}\) & ✓ & ✓ \\ \(|\Delta\eta^{\mathrm{lead\_track}}|\) & Angular distance between the highest track and \(\tau_{\mathrm{had\_vis}}\) axis & & ✓ \\ \(|\Delta\phi^{\mathrm{lead\_track}}|\) & Angular distance between the highest track and \(\tau_{\mathrm{had\_vis}}\) axis & & ✓ \\ \(E_{\mathrm{EM}}/E_{\mathrm{EM+HAD}}\) & Fraction of energy deposited in the EM calorimeter divided & & ✓ \\  & the total energy deposited in the EM and HAD calorimeters & & \\ \(E_{\mathrm{T}}^{\mathrm{HotShor}}/p_{\mathrm{T}}^{\mathrm{lead\_track}}\) & The maximum \(E_{\mathrm{T}}\) deposit in a \(0.012\times 0.1\) window around & ✓ & ✓ \\  & the extrapolated track position divided & & \\  & by the \(p_{\mathrm{T}}\) of the highest track & & \\ \(f_{\mathrm{cent}}^{\Delta R<0.2}\) & Fraction of transverse energy deposited inside & & ✓ \\  & a \(\Delta R<0.2\) cone around the \(\tau_{\mathrm{had\_vis}}\) axis & & ✓ \\  & with respect to all energy & & \\ \(E_{\mathrm{T}}/p_{\mathrm{T}}^{\mathrm{lead\_track}}\) & Transverse energy \(E_{\mathrm{T}}\) of the \(\tau_{\mathrm{had\_vis}}\) candidate divided by & ✓ & ✓ \\  & the transverse momentum of the track with highest \(p_{\mathrm{T}}\), \(p_{\mathrm{T}}^{\mathrm{lead\_track}}\) & & \\ \(E_{\mathrm{HAD}}/p_{\mathrm{T}}^{\mathrm{lead\_track}}\) & Energy deposited in the hadronic calorimeter divided by & & ✓ \\  & the transverse momentum of the highest-track & & \\ \((E_{\mathrm{presampler}}+E_{\mathrm{strip}})/E_{\mathrm{EM}}\) & Energy deposited in the EM presampler and strip layers & ✓ & ✓ \\  & divided by the total energy deposited in the EM calorimeters & & ✓ \\ \(\left<r^{2}\right>\) & Second moment in the radial distance of & & ✓ \\  & cluster cells from the shower axis & & ✓ \\ \(\left<\lambda_{\mathrm{centre}}\right>\) & Mean distance of the cluster shower centre & & ✓ \\  & from the calorimeter front face measured along the shower axis & & \\ \(\log(\left<\rho\right>)\) & Logarithm of the mean of the clusters energy density & ✓ & \\ \(E_{\mathrm{presampler}}/E_{\mathrm{EM+HAD}}\) & Mean of clusters energy deposited in & ✓ & ✓ \\  & the EM presamplers divided by the energy & & \\  & deposited in the EM and HAD calorimeters & & \\ \(E_{\mathrm{EM\_cluster}}/p_{\mathrm{T}}^{\mathrm{core\_tracks}}\) & Ratio of the sum of cluster energy deposited & ✓ & ✓ \\  & in the track electromagnetic part of the TopoClusters & & \\  & (presampler, first and second layers of the EM calorimeter) to & & \\  & the sum of the momentum of the core tracks & & \\ \(\Delta R_{\mathrm{max}}(\mathrm{track},\tau_{\mathrm{had}})\) & The maximum \(\Delta R\) between a core track associated with & & ✓ \\  & the \(\tau_{\mathrm{had\_vis}}\) candidate and the \(\tau_{\mathrm{had\_vis}}\) direction. & & ✓ \\ \(\Delta R_{\mathrm{avg}}(\mathrm{track},\tau_{\mathrm{had}})\) & The average \(\Delta R\) between a core track associated with & & ✓ \\  & the \(\tau_{\mathrm{had\_vis}}\) candidate and the \(\tau_{\mathrm{had\_vis}}\) direction. & & \\ \(P_{e}^{\mathrm{HT}}\) & Electron probability determined from high-threshold (HT) hits in the TRT & ✓ & ✓ \\ \hline \hline \end{tabular}
\end{table}
Table 5: Variables of the \(\tau_{\mathrm{had\_vis}}\) used as input in the eVeto RNN and related to the \(\tau\)-jet. The last two columns indicate if a given variable is used in the 1 prong and/or 3 prongs case.

\begin{table}
\begin{tabular}{l l c c} \hline \hline Variable & Description & 1-prong & 3-prong \\ \hline \(p_{\text{T}}^{\text{track}}\) & Transverse momentum of the track & ✓ & ✓ \\ \(|\Delta\eta(\text{cluster},\text{track})|\) & \(\eta\) distance of the track and the nearest calorimeter cluster & ✓ & ✓ \\ \(|\Delta\phi(\text{cluster},\text{track})|\) & \(\phi\) distance of the track and with the nearest calorimeter cluster & ✓ & ✓ \\ \(N_{\text{IBL}}\) & Number of hits in the innermost layer of the pixel detector & ✓ & ✓ \\ \(N_{\text{pixel}}\) & Number of hits in the pixel detector & ✓ & ✓ \\ \(N_{\text{SCT}}\) & Number of hits in the SCT detector & ✓ & ✓ \\ \(E_{\text{T}}^{\text{cluster}}\) & Cluster transverse energy & ✓ & ✓ \\ \(p_{\text{cluster}}^{\text{cluster}}\) & Cluster transverse momentum & ✓ & ✓ \\ \(|\Delta\eta^{\text{cluster}}|\) & The angular distance between the cluster and the \(\tau_{\text{had-vis}}\) axis & ✓ & ✓ \\ \(|\Delta\phi^{\text{cluster}}|\) & The angular distance between the cluster and the \(\tau_{\text{had-vis}}\) axis & ✓ & ✓ \\ \(\lambda^{2}/\langle\lambda^{2}\rangle\) & Distance of a cell from the shower centre & ✓ & ✓ \\  & along the shower axis divided by the corresponding mean & & \\ \(\lambda_{\text{centre}}/\langle\lambda_{\text{centre}}\rangle\) & Distance of the cluster shower centre from & ✓ & ✓ \\  & the calorimeter front face, measured along & & \\  & the shower axis divided by the corresponding mean & & \\ \(\rho^{1}/\langle\rho^{1}\rangle\) & The first moment in the cluster energy density, \(\rho=E^{\text{cluster}}/\nu^{\text{cluster}}\), & ✓ & ✓ \\  & divided by the corresponding mean & & \\ \hline \hline \end{tabular}
\end{table}
Table 6: Variables of the \(\tau_{\text{had-vis}}\) used as input in the eVeto RNN and related to the tracks and cluster variables. The last two columns indicate if a given variable was used in the 1-prong and/or 3-prong case.

Figure 9: Distribution of input variables of \(\tau_{\text{had-vis}}\) objects for \(\gamma^{*}\rightarrow\tau\tau\) signal and \(Z\to ee\) background, used in the RNN training. For 1-prong \(\tau_{\text{had-vis}}\) objects, transverse energy of the \(\tau_{\text{had-vis}}\) divided by the transverse momentum of the highest-\(p_{\text{T}}\) track is shown in (a), and the energy deposited in the EM presampler and strip layers divided by the total energy deposited in the EM calorimeters (b). For 3-prong \(\tau_{\text{had-vis}}\) objects, the energy deposited in the hadronic calorimeter divided by the transverse momentum of the highest-\(p_{\text{T}}\) track is shown in (c), and the fraction of energy deposited in the EM calorimeter divided by the total energy deposited in the EM and hadronic calorimeters of the \(\tau_{\text{had-vis}}\) candidates is shown in (d).

Figure 10: Efficiency of the electron veto algorithm for 1-prong \(\tau\) lepton as a function of (a) the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\) and (b) \(p_{\mathrm{T}}\) of 1-prong \(\tau_{\mathrm{had-vis}}\) candidates. Electron rejection factors of the electron veto algorithm are shown as a function of (c) \(\langle\mu\rangle\) and (d) \(p_{\mathrm{T}}\) of 1-prong \(\tau_{\mathrm{had-vis}}\) candidates. Values for Loose, Medium and Tight working points are shown.

Figure 11: Efficiency of the electron veto algorithm for 3-prong \(\tau\) lepton as a function of (a) the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\) and (b) \(p_{\mathrm{T}}\) of 3-prong \(\tau_{\mathrm{had-vis}}\) candidates. Electron rejection factors of the electron veto algorithm are shown as a function of (c) \(\langle\mu\rangle\) and (d) \(p_{\mathrm{T}}\) of 3-prong \(\tau_{\mathrm{had-vis}}\) candidates. Values for Loose, Medium and Tight working points are shown.

Figure 12: Inverse of the efficiency (rejection) for misidentified 1-prong and 3-prong \(\tau_{\text{had-vis}}\) candidates from \(Z\to ee\) background events as a function of the efficiency for truth \(\tau_{\text{had-vis}}\) originating from \(\gamma^{*}\to\tau\tau\) events. The two lines refer to 1-prong and 3-prong \(\tau_{\text{had}}\) candidates and the markers correspond to individual working points (Loose, Medium, Tight).

## 7 Decay mode classification

This section describes a DeepSet neural network (DeepSet NN) [36] algorithm used to classify the decay mode of the \(\tau\) lepton and to calculate the visible four-momentum of the reconstructed \(\tau\) lepton candidates, significantly improving the energy calibration of the reconstructed \(\tau_{\rm had}\) candidates. The algorithm exploits the reconstruction of individual charged and neutral hadrons of the \(\tau\) lepton decays. The performance of the decay mode algorithm is optimised and evaluated using simulated \(\gamma^{*}\to\tau\tau\) events.

The standard \(\tau_{\rm had}\) reconstruction only reconstructs the number of charged hadrons in the \(\tau_{\rm had}\) decay. However, various physics analyses [37, 38] rely on the identification of the \(\tau_{\rm had}\) decay mode, as well as the energy and direction of possible \(\pi^{0}\) mesons in the decay. The \(\tau_{\rm had}\) decay modes are listed in Table 7.

The \(\tau_{\rm had}\) Particle Flow (TPF) reconstruction [39] method was developed during Run 1 to reconstruct individual charged hadrons, \(\pi^{\pm}\) or \(K^{\pm}\) labelled as \(h^{\pm}\), and neutral hadrons, \(\pi^{0}\), identified from the presence of photon clusters in the \(\tau_{\rm had}\) decay. This method, later referred to as counting-based, is based on counting of \(h^{\pm}\) and photon clusters from \(\pi^{0}\) decays and reconstructs the momentum of \(\tau_{\rm had}\) using these reconstructed hadrons. It significantly improves the energy resolution of \(\tau_{\rm had}\) with \(p_{\rm T}\) lower than 100 GeV with respect to the previously used particle flow method [40].

However, approximately 50% of \(\tau_{\rm had}\) in \(h^{\pm}\geq 2\pi^{0}\) mode are misidentified as \(h^{\pm}\pi^{0}\), when the photons from a \(\pi^{0}\) decay can not be resolved, and they are identified as a single photon. The previously used BDT-based decay mode classification algorithm [39] combines the kinematic and \(\pi^{0}\) identification information from the selected \(h^{\pm}\) tracks, \(\pi^{0}\) candidates and local maxima in EM1 layer of EM calorimeter. It utilises three BDTs to discriminate \(h^{\pm}\) against \(h^{\pm}\pi^{0}\), \(h^{\pm}\pi^{0}\) against \(h^{\pm}\geq 2\pi^{0}\) and \(3h^{\pm}\) against \(3h^{\pm}\geq 1\pi^{0}\).

The BDT-based decay mode classification outperforms the counting-based approach by about 3.8% in terms of diagonal efficiency2, however, it does not exploit the information from all the relevant objects that are associated with the \(\tau_{\rm had}\). To further improve this, a DeepSet NN has been developed for Run 3 data-taking and reprocessed Run 2 data. The DeepSet NN is able to consider all the objects associated with the \(\tau_{\rm had}\) and process their information in a permutation invariant manner.

Footnote 2: The diagonal efficiency is defined as the weighted average efficiency of the diagonal terms of the matrix.

According to the TPF reconstruction, four sets of objects that are associated with \(\tau_{\rm had}\) are important in the decay mode classification:

\begin{table}
\begin{tabular}{l l c} \hline \hline Decay mode & Label & \(\mathcal{B}\) (w.r.t total \(\tau\) lepton decays) \\ \hline \(h^{\pm}\) & 1p0n & 11.5\% \\ \(h^{\pm}\pi^{0}\) & 1p1n & 25.9\% \\ \(h^{\pm}\geq 2\pi^{0}\) & 1pXn & 10.6\% \\ \(3h^{\pm}\) & 3p0n & 9.46\% \\ \(3h^{\pm}\geq 1\pi^{0}\) & 3pXn & 5.09\% \\ \hline \hline \end{tabular}
\end{table}
Table 7: Five major decay modes of \(\tau_{\rm had}\) and the corresponding branching ratio (\(\mathcal{B}\)) with respect to total \(\tau\) lepton decays [41]. \(h^{\pm}\) stands for \(\pi^{\pm}\) or \(K^{\pm}\) (the latter contributes about 3%). Neutrinos are omitted. Decays with neutral kaons are neglected as they correspond to a branching ratio of \(<\) 1%. The labels are in a form of ‘ApBn’, where ‘A’,‘B’ are the number of prongs (the ‘p’) and neutral pions (the ‘n’) and ‘X’ stands for more than one or more than zero accordingly.

* The \(h^{\pm}\) in \(\tau_{\rm had}\) decay, obtained from the \(\tau_{\rm had-vis}\) tracks (reconstructed \(\tau_{\rm had}\) tracks);
* The selected \(\pi^{0}\) candidates that can come from the \(\tau_{\rm had}\) decay or \(h^{\pm}\) remnants, pile-up, etc (referred to as \(\pi^{0}\) candidates or Neutral PFOs);
* The local energy maxima in the EM1 layer of EM calorimeter associated with a photon from the \(\pi^{0}\) candidate decay (referred to as photon shots or shot PFOs);
* The reconstructed conversion tracks produced by \(\gamma\to e^{+}e^{-}\).

Hereafter, an 'object' refers to a \(\tau_{\rm had}\) track, \(\pi^{0}\) candidates, photon shots or conversion track. For all four categories of objects, the kinematic variables are considered as input features and are summarised in Table 8.

The variables can be visualised by a \(\tau_{\rm had}\) decay display as shown in Fig. 13 for \(\Delta\eta({\rm object},\tau_{\rm had})\) and \(\Delta\phi({\rm object},\tau_{\rm had})\)3. The objects represents the relative position of the object in the \(\Delta\eta^{\prime}\)-\(\Delta\phi^{\prime}\) plane, with radius proportional to \(\sqrt{\frac{p_{\rm T}({\rm object})}{p_{\rm T}(\tau_{\rm had})}}\), and different colours correspond to different types of objects. As a reference, the grey rings demonstrate the original \(\Delta R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\) at several values. The DeepSet NN is able to learn the structure of the objects as displayed and it is found that the preliminary DeepSet NN which only takes into account the kinematic variables already outperforms the BDT model by about 3% in terms of diagonal efficiency.

Footnote 3: The prime in \(\Delta\eta^{\prime}\) and \(\Delta\phi^{\prime}\) indicates that the variables are transformed from the original \(\Delta\eta\) and \(\Delta\phi\) for better visualisation, where \(\Delta\nu^{\prime}=\sqrt{0.4^{2}-(0.4^{2}-x^{2})}\),\((x=\eta,\phi)\).

For the \(\tau_{\rm had}\) and conversion tracks, the impact parameters \(|d_{0}^{\rm TIVA}|\), closest distance of the track to the \(\tau_{\rm had}\) vertex in the transverse plane, and \(|z_{0}^{\rm TIVA}\sin\theta|\) the \(z\) position of the point of closest distance in \(x\)-\(y\) plane, are utilised. The corresponding impact parameter significance \({\rm Sig}(d_{0})\) and the longitudinal closest distance significance \({\rm Sig}(z_{0}\sin(\theta))\) are also exploited, which correspond to the ratios of the impact parameters and their resolutions. Including aforementioned variables results in about 2% improvements in the diagonal efficiency.

For the \(\pi^{0}\) candidates, the variables which distinguish clusters dominated by electromagnetic and hadronic interactions [42] are exploited. In particular, the energy density and shower shape of the topo-cluster of the \(\pi^{0}\) candidates are added to distinguish the \(\pi^{0}\) originating from the \(\tau_{\rm had}\) decay and from the other

\begin{table}
\begin{tabular}{l l} \hline \hline Variable & Description \\ \hline \(p_{\rm T}(\tau_{\rm had})\) & \(p_{\rm T}\) of the \(\tau_{\rm had}\) (using calorimeter based \(\tau_{\rm had-vis}\) energy scale) \\ \(p_{\rm T}({\rm object})\) & \(p_{\rm T}\) of the object \\ \(\Delta\phi({\rm object},\tau_{\rm had})\) & Distance between the object and \(\tau_{\rm had}\) in \(\phi\) \\ \(\Delta\eta({\rm object},\tau_{\rm had})\) & Distance between the object and \(\tau_{\rm had}\) in \(\eta\) \\ \(\Delta\phi({\rm object},{\rm trackECal})\) & Distance between the object and the extrapolation of highest-\(p_{\rm T}\)\(\tau_{\rm had}\) track to EM calorimeter in \(\phi\) \\ \(\Delta\eta({\rm object},{\rm trackECal})\) & Distance between the object and the extrapolation of highest-\(p_{\rm T}\)\(\tau_{\rm had}\) track to EM calorimeter in \(\eta\) \\ \hline \hline \end{tabular}
\end{table}
Table 8: Name and description of the kinematic variables and angular distances used as input features to the DeepSet NN decay mode classification. ‘Object’ refers to a \(\tau_{\rm had}\) track, \(\pi^{0}\) candidate, photon shot or conversion track. The \(\tau_{\rm had}\) is the one that the objects are associated to by the TPF reconstruction. ‘TrackECal’ refers to the extrapolation of highest-\(p_{\rm T}\)\(\tau_{\rm had}\) track to EM calorimeter.

sources. Definition of these variables are outlined in Table 9, where the cluster moment of a degree \(n\) for an observable \(x\) is defined as

\[\langle x^{n}\rangle=\frac{1}{E_{\text{norm}}}\sum_{\{i\,|E_{i}>0\}}E_{i}x^{n},E_{ \text{norm}}=\sum_{\{i\,|E_{i}>0\}}E_{i}, \tag{2}\]

in which \(i\) represents the sum over the EM calorimeter cells with positive energy.

In summary, DeepSets NN input features consist of kinematics, track impact parameters and cluster properties for \(\tau_{\text{had}}\) tracks (10 variables), conversion tracks (10 variables), \(\pi^{0}\) candidates (22 variables) and photon shots (6 variables). For each type of objects, only the leading \(n\) objects are considered, ordered in \(p_{\text{T}}\). The maximum number of objects is three, four, eight and six for \(\tau_{\text{had}}\) tracks, conversion tracks, \(\pi^{0}\) candidates and photon shots, respectively.

The implementation and training of the DeepSet is powered by deep learning library Keras with TensorFlow as backend. The architecture and training parameters are summarised in Fig. 14, where the number of nodes and training parameters are optimised. Only the \(\tau_{\text{had}}\) with truth and reconstructed \(p_{\text{T}}\) greater than 15 GeV, and geometrically matched to the truth-level visible decay products of \(\tau\) leptons are

Figure 13: Visualisation of the angular distances in displays of various truth \(\tau_{\text{had}}\) decay modes with the simulated \(\gamma^{*}\to\tau\tau\) sample. The area of the circles is proportional to the momentum (energy) of the tracks (calorimetric objects). Detailed explanation of the figure can be found in the text.

used in for the training. The output NN score is a vector of five probabilities corresponding to each decay mode.

The decay mode with largest probability in the DeepSet output and has a reconstructed number of prong consistent with that based on the \(\tau_{\text{had}}\) track classification 4 is assigned as the reconstructed decay mode. The performance of decay mode classification is evaluated with independent simulated \(\gamma^{*}\to\tau\tau\) samples against the samples for training. The \(\tau_{\text{had}}\) for evaluation need to pass the \(p_{\text{T}}\), \(\eta\) and number of prong (for both truth-level and reconstruction-level variables) requirements and the Medium\(\tau_{\text{had}}\) identification working point. The performance of BDT decay mode classifier is evaluated with the same samples and selections. The efficiency matrices are shown in Fig. 15 comparing the performance of BDT and DeepSet NN. The DeepSet NN outperforms the BDT by 9% on the diagonal efficiency, showing a significant improvement in all decay modes.

Footnote 4: The fraction of \(\tau_{\text{had-vis}}\) for which the result is different is around 1%.

Figure 16 summarises the efficiency of identifying the correct decay modes as functions of the \(p_{\text{T}}(\tau_{\text{had-vis}})\) and the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\). They correspond to the diagonal and elements in the efficiency matrix for the reconstructed DeepSet NN decay mode (right plot in Fig. 15).

\begin{table}
\begin{tabular}{l l} \hline \hline Variable & Description \\ \hline \(\langle\eta^{1}\rangle\) & First moment in \(\eta\) in cluster shower axis \\ \(\log(\langle r^{2}\rangle)\) & Second moment in the radial distance of cluster cells from the shower axis \\ \(\Delta\theta\) & Distance in \(\theta\) between the EM shower axis and the vector pointing \\  & from the primary vertex to the centre of the shower \\ \(\log(\lambda_{\text{centre}})\) & Distance of the cluster shower centre from the calorimeter front face \\  & measured along the shower axis \\ \(\langle\lambda^{2}\rangle\) & Mean distance of a cell from the shower centre along the shower axis \\ \(\log(\langle\rho^{2}\rangle)\) & Second moment in the cluster energy density, where \(\rho=E^{\text{cluster}}/\nu^{\text{cluster}}\) \\ \(f_{\text{core}}\) & Sum of energy fractions in the most energetic cells per sampling \\ \(f_{\text{EM1}}\) & Same as \(f_{\text{core}}\) but only consider EM1 \\ \(N_{\text{pos,EM1}}\) & Number of cells with positive energy in EM1 \\ \(N_{\text{pos,EM2}}\) & Number of cells with positive energy in EM2 \\ \(E\text{EM1}\) & Energy in the EM1 layer \\ \(E_{\text{EM2}}\) & Energy in the EM2 layer \\ \(\left\langle\eta^{1}_{\text{EM1}}\right\rangle\) w.r.t. cluster & First moment in \(\eta\) in EM1 with respect to the cluster \\ \(\left\langle\eta^{1}_{\text{EM2}}\right\rangle\) w.r.t. cluster & First moment in \(\eta\) in EM2 with respect to the cluster \\ \(\log(\langle\eta^{2}_{\text{EM1}}\rangle)\) w.r.t. cluster & Second moment in \(\eta\) in EM1 with respect to the cluster \\ \(\log(\langle\eta^{2}_{\text{EM2}}\rangle)\) w.r.t. cluster & Second moment in \(\eta\) in EM2 with respect to the cluster \\ \hline \hline \end{tabular}
\end{table}
Table 9: Name and description of the cluster classification variables for \(\pi^{0}\) candidates as input features to the DeepSet NN decay mode classification. The ones with log are transformed to the logarithm values (\(\log_{10}\)) in training and evaluation. More details are described in Ref. [42].

Figure 14: Architecture and training parameters of the DeepSet NN decay mode classifier. \(\rho\), \(\phi\) and the layers after merging are feed forward NNs. The numbers indicate the number of nodes in each layers. The epoch and learning rate represent the maximum values, more details are provided in text. _Adam_ is a stochastic gradient descent (SGD) optimisation algorithm, which is self adaptive in terms of estimating first and second order moments. \(\beta_{1}\) and \(\beta_{2}\) are the decay rates for first and second order moment estimates. More information about the parameters can be found in Keras documentation [32].

Figure 15: Efficiency matrix for reconstructing the same \(\tau\) lepton decay mode as the truth decay mode with BDT-based (left) and DeepSet NN (right) classifier in \(\gamma^{*}\rightarrow\tau\tau\) events. Only \(\tau_{\text{had-vis}}\) candidates with \(p_{\text{T}}\) > 20 GeV and which pass Medium \(\tau_{\text{had}}\) identification working point are considered. The values along each column sum 100%, such that reconstruction efficiencies are given for each individual truth tau decay mode. The diagonal efficiency is defined as the weighted average of the correctly identified truth decay modes.

## 6 Summary

Figure 16: Efficiency of identifying the correct decay modes with the DeepSet NN classifier as functions of the \(p_{\mathrm{T}}(\tau_{\mathrm{had-vis}})\) and the average number of simultaneous \(pp\)-collisions \(\langle\mu\rangle\) (right) in \(\gamma^{*}\rightarrow\tau\tau\) events. Only \(\tau_{\mathrm{had-vis}}\) candidates with \(p_{\mathrm{T}}\) > 20 GeV and which pass Medium \(\tau_{\mathrm{had}}\) identification working point are considered.

## 8 Energy calibration

At the seeding step, the energy of the \(\tau_{\text{had-vis}}\) candidates is calibrated using the local cell signal weighting (LC) method [23, 43], designed to give the correct energy scale for charged pions produced in the interaction point. The LC aubration reduces the fluctuations for the calorimeter non-compensation and for the energy deposited in the dead material or outside TopoClusters. Further corrections are derived using simulations to improve the response and the energy resolution.

The strategy for the baseline \(\tau_{\text{had-vis}}\) energy scale (TES) calibration is described in [10]. For the baseline TES estimate, \(p_{\text{T}}^{\text{LC}}\), LC-calibrated sum of energy of all TopoClusters within \(\Delta R<0.2\) of the \(\tau_{\text{had-vis}}\) candidate, subtract the energy contribution originating from pileup interactions (linearly versus the number of primary vertices) and afterwards apply the detector response correction.

Another estimate of the TES relies on the TPF objects. Reconstructed tracks are used to identify charged pions and subtract their deposit in the calorimeters. This leads to a momentum measurement of the charged component of the \(\tau_{\text{had-vis}}\) from the tracking system that is combined to a calorimetric measurement of the neutral component. The two estimates of the TES are then combined using a weighted average of the baseline \(p_{\text{T}}\), \(p_{\text{T}}^{\text{LC}}\), and substructure (TPF), \(p_{\text{T}}^{\text{TPF}}\). As the resolution of \(p_{\text{T}}^{\text{TPF}}\) is better than \(p_{\text{T}}^{\text{LC}}\) at low \(p_{\text{T}}\), and vice-versa at higher \(p_{\text{T}}\), the weights used to parametrised the combined transverse momentum, \(p_{\text{T}}^{\text{Comb}}\), as a function of the resolution of the respective TES calibrations. The weight gives priority to the calibration with best expected energy resolution. The combined TES is parametrised versus \(p_{\text{T}}\), five bins in \(\eta\), and the five \(\tau_{\text{had}}\) decay modes. When no parametrisation is available (e.g. 2-prong \(\tau_{\text{had-vis}}\) candidates), \(p_{\text{T}}^{\text{Comb}}\) is set to be equal to the \(p_{\text{T}}^{\text{LC}}\).

The final TES calibration employs a Boosted Regression Tree (BRT) whose target is truth \(p_{\text{T}}^{\text{vis}}/p_{\text{T}}^{\text{Comb}}\), where truth \(p_{\text{T}}^{\text{vis}}\) is the \(p_{\text{T}}(\tau_{\text{had-vis}})\), which includes possible initial state radiation and final state radiation photons in the cone. The BRT algorithm was first developed at the beginning of Run 2 of the LHC [44], and further improved before the beginning of Run 3. It exploits, among its inputs, the aformentioned TES calibration output to further refine the energy calibration accuracy. The input variables used in the BRT are listed and described in Table 10.

Figure 17 shows the \(\tau_{\text{had-vis}}\) energy resolution of the calorimeter, substructure, combined and the final (BRT-based) \(\tau_{\text{had-vis}}\) energy calibration for 1-prong (left) and 3-prong (right) \(\tau_{\text{had-vis}}\) candidates which pass Medium \(\tau_{\text{had}}\) identification working point. The BRT-based \(\tau\) energy calibration provides the best resolution over the full \(p_{\text{T}}\) range.

\begin{table}
\begin{tabular}{l l} \hline \hline Variable & Description \\ \hline \(n_{\text{PV}}\) & Number of primary vertices in the event. \\ \(\mu\) & Average number of interactions per bunch crossing. \\ \(\left\langle\lambda_{\text{centre}}\right\rangle\) & Mean distance of the cluster shower centre from the calorimeter \\  & front face measured along the shower axis \\ \(\left\langle\lambda^{2}\right\rangle\) & Mean distance of a cell \\  & from the shower centre along the shower axis \\ \(\left\langle\rho^{1}\right\rangle\) & Mean of the first moment in the cluster energy density, \\  & \(\rho=E^{\text{cluster}}/\text{$\mathrm{v}$}^{\text{cluster}}\), where \(E^{\text{cluster}}\) and \(\text{$\mathrm{v}$}^{\text{cluster}}\) represent \\  & the energy and volume of the cluster, respectively \\ \(f_{\text{presampler}}\) & Mean fraction of cluster energy deposited in \\  & the barrel and endcap presamplers \\ \(P_{\text{EM}}\) & Classification probability of the cluster to be EM-like, \\  & as described in Ref. [45] \\ \(n_{\text{track}}\) & Number of tracks associated with the \(\tau_{\text{had-vis}}\) \\ \(n_{\pi^{0}}\) & Number of reconstructed neutral pions associated with the \(\tau_{\text{had-vis}}\) \\ \(\gamma\pi\) & Relative difference of the total charged pion energy, \\  & \(E_{\text{charged}}\), and the total neutral pion energy, \(E_{\text{neutral}}\): \\  & \(\gamma_{\pi}=(E_{\text{charged}}-E_{\text{neutral}})/(E_{\text{charged}}+E_{ \text{neutral}})\) \\ \(\eta_{\text{calo}}\) & Calorimeter-based (baseline) pseudorapidity \\ \(P_{\text{T}}^{\text{Comb}}\) & Transverse momentum interpolated from calorimetric \\  & corrections to energy measurement and TPF reconstruction \\ \(p_{\text{T}}^{\text{EM}}/p_{\text{T}}^{\text{LC}}\) & Ratio of the calorimetric energy at the EM scale \\  & to the local hadron calibration transverse momentum \(p_{\text{T}}^{\text{LC}}\) \\ \(p_{\text{T}}^{\text{LC}}/p_{\text{T}}^{\text{Comb}}\) & Ratio of the local hadron calibration transverse \\  & momentum to \(p_{\text{T}}^{\text{Comb}}\) \\ \(p_{\text{T}}^{\text{TPF}}/p_{\text{T}}^{\text{Comb}}\) & Ratio of the TPF reconstruction transverse momentum, \\  & \(p_{\text{T}}^{\text{TPF}}\), to \(p_{\text{T}}^{\text{Comb}}\) \\ TPF BDT Values & BDT values of the TPF algorithm for 1p0n vs 1p1n, 1p1n vs 1pXn, \\  & and 3p0n vs 3pXn discrimination \\ \hline \hline \end{tabular}
\end{table}
Table 10: List of input variables used in the boosted regression tree for \(\tau_{\text{had-vis}}\) energy calibration. The cluster variables are the energy weighted averages over the jet seed constituents within the \(\tau\) lepton cone, as described in detail in Ref. [45].

Figure 17: The resolution of the calorimeter, substructure, combined and final (BRT-based) \(\tau_{\text{had-vis}}\) energy calibration shown for 1-prong (left) and 3-prong (right) \(\tau_{\text{had-vis}}\) candidates which pass Medium \(\tau_{\text{had}}\) identification working point using the \(\gamma^{*}\rightarrow\tau\tau\) events. The resolution, shown as a function of the truth \(p_{\text{T}}(\tau_{\text{had-vis}})\) (top) and \(\langle\mu\rangle\), is defined as half of the 68% central intervals of the ratio of the calibrated \(p_{\text{T}}\) to the truth visible \(p_{\text{T}}\). Only the statistical uncertainties are shown.

## 9 Conclusions

The reconstruction, identification and energy calibration of hadronically decaying \(\tau\) leptons has been updated for the beginning of Run 3 data-taking and for Run 2 reprocessed data of the Large Hadron Collider. The algorithms have been tuned on simulated samples using Run 2 conditions and provide nominal identification operation points with increasing background rejection. Significant improvements over the previously employed methods are achieved in the reconstruction, identification and reconstruction of hadronically decaying \(\tau\) leptons. The track classifier efficiency for \(\tau\) lepton tracks is expected to be 95% (93%) for 1-prong (3-prong) \(\tau_{\text{had-vis}}\). The average track association efficiency for 1-prong (3-prong) \(\tau\) leptons improved from about 70% to more than 90% (from 65% to about 75%) for 1-prong (3-prong) \(\tau\) leptons compared to the algorithm deployed at the beginning of Run 2. The identification efficiencies for the chosen operating points are 95% (95%), 85% (85%), 75% (60%), and 60% (45%) for 1-prong (3-prong) \(\tau_{\text{had-vis}}\). The improvement in rejecting misidentified \(\tau_{\text{had}}\) candidates is in the range 50-100% with respect of the RNN identification algorithm deployed by the end of Run 2. Rejection against electrons is achieved using three working points providing efficiency in the range of 85%-95% (90%-98%) for 1-prong (3-prong) \(\tau_{\text{had-vis}}\) and the inverse background efficiency is expected to be between 2000-300 (200-90), representing a factor three improvement with the respect to the previous BDT-based algorithm. The decay mode classification, based on a Neural Network algorithm, achieves a diagonal efficiency of about 82%, about 9% higher than BDT algorithm used during Run 2. Finally, the \(\tau_{\text{had-vis}}\) energy scale calibration, based on a Boosted Regression Tree algorithm, has been retuned, and the \(\tau_{\text{had-vis}}\) energy resolution ranges between 4.5%-6% (4%-5%) for 1-prong (3-prong) \(\tau_{\text{had-vis}}\) for an average number of interactions per bunch crossing in the range 1-70.

## References

* [1] Belle Collaboration, _Measurement of the \(\tau\)-lepton Lifetime at Belle_, Phys. Rev. Lett. **112** (2014) 031801, arXiv: 1310.8503 [hep-ex] (cit. on p. 2).
* [2] ATLAS Collaboration, _Measurement of \(\tau\) polarisation in \(Z/\gamma^{*}\to\tau\tau\) decays in proton-proton collisions at \(\sqrt{s}=8\,\text{TeV}\) with the ATLAS detector_, Eur. Phys. J. C **78** (2018) 163, arXiv: 1709.03490 [hep-ex] (cit. on p. 2).
* [3] ATLAS Collaboration, _Measurements of Higgs boson production cross-sections in the \(H\to\tau^{+}\tau^{-}\) decay channel in \(pp\) collisions at \(\sqrt{s}=13\,\text{TeV}\) with the ATLAS detector_, (2022), arXiv: 2201.08269 [hep-ex] (cit. on p. 2).
* [4] ATLAS Collaboration, _Observation of the \(\gamma\gamma\to\tau\tau\) process in Pb+Pb collisions and constraints on the \(\tau\)-lepton anomalous magnetic moment with the ATLAS detector_, (2022), arXiv: 2204.13478 [hep-ex] (cit. on p. 2).
* [5] ATLAS Collaboration, _Search for Heavy Higgs Bosons Decaying into Two Tau Leptons with the ATLAS Detector Using \(pp\) Collisions at \(\sqrt{s}=13\,\text{TeV}\)_, Phys. Rev. Lett. **125** (2020) 051801, arXiv: 2002.12223 [hep-ex] (cit. on p. 2).
* [6] ATLAS Collaboration, _Search for resonant and non-resonant Higgs boson pair production in the \(b\bar{b}\tau^{+}\tau^{-}\) decay channel using \(13\,\text{TeV}\)\(pp\) collision data from the ATLAS detector_, ATLAS-CONF-2021-030, 2021, url: [https://cds.cern.ch/record/2777236](https://cds.cern.ch/record/2777236) (cit. on p. 2).