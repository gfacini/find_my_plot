ImprovementstotheLevel-1muon triggergivingincreasedrobustness againstbackgrounds

ATLASLevel-1muontriggergroup

July1999

Abstract

The contribution to the rate seen in the ATLAS Level-1 muon trigger arising from soft charged particles was identified and discussed in the ATLAS Level-1 Trigger Technical Design Report. A background from muons having momentum \(\sim\)100 MeV was identified as being potentially problematic in terms of the induced Level-1 muon rate contribution. This note discusses progress in the understanding of such backgrounds since publication of the TDR, and describes modifications to the Level-1 muon trigger scheme, relative to the design described in the TDR, that increase the robustness of the trigger. These improvements in the trigger design allow a trigger to be built that suppresses this background rate even assuming the worst case with regard to current uncertainties.

## 1Introduction

The total output rate of Level-1 triggers (calorimeter as well as muon triggers) is constrained by the front-end electronics of the ATLAS detector to be less than 75 kHz (upgradable to 100 kHz). It must be demonstrated that the design of the Level-1 trigger can satisfy this absolute constraint, without compromising trigger efficiency. The Level-1 muon trigger has been designed to offer high efficiencies to inclusive muons of \(p_{\rm T}\)\(>\)6 GeV at low luminosity, primarily for B physics, and to muons of \(p_{\rm T}\)\(>\)20 GeV at high luminosity, primarily for search physics. Studies in the Level-1 trigger Technical Design Report (TDR) [ref. 1] demonstrated that rates from prompt muons and muons produced in meson decays in flight are far below this upper rate limit for the indicated \(p_{\rm T}\) thresholds that are appropriate for the physics goals, Table 1.

Detailed studies of cosmic muons (in the barrel) and beam-halo muons (in the end-cap) have confirmed that rate contributions from such sources are negligible [ref. 1], [ref. 2].

Studies [ref. 1] have also been made of the flux of soft particles in the ATLAS cavern. Particles of energies below 2 MeV (generally originating from soft Compton electrons and neutron-induced soft protons) are produced in the chamber wall or detector gas and are absorbed in the material of the same detection unit. Such background thus produces hits with no correlation between different muon counters, and makes a negligible contribution to trigger rate. Harder charged particles (harder Compton electrons with energy above 2 MeV, and soft protons) are able to cross closely-spaced planes of a trigger station and produce correlated hit patterns in trigger counters of the same trigger station. Again the rate contribution is negligible. The trigger rate produced by random coincidences of these charged particles with very soft (\(E<\)2 MeV) particles has also been confirmed to be negligible.

In the Level-1 TDR a class of background was identified that is potentially problematic in terms of its contribution to the total Level-1 muon trigger output rate. Muons, protons and pions ofmomentum \(\sim\)100 MeV are able to cross not only neighbouring trigger planes within a station, but can traverse closely spaced planes of a trigger station, such as the two stations of the low-\(p_{\mathrm{T}}\) system. Such a particle can produce a correlated hit pattern that fires the trigger. Studies using the FLUKA [ref. 3] Monte Carlo and the ATLAS detector and trigger simulation programs predict that such backgrounds can produce a trigger rate that equals or exceeds that expected from primary muons from the interaction point, [ref. 1]. In the Level-1 TDR [ref. 1] a commitment was made to address this issue with respect to performing further simulation studies, making improvements to the shielding of the detector and improving the trigger scheme to make it more robust against such background. Here, the results of these studies are presented.

Charged particles with momentum \(\sim\)100 MeV (in particular muons) have been studied using Monte Carlo simulations to understand their source as well as the response of the trigger chambers and trigger logic to them. Modifications of the Level-1 muon trigger scheme are presented that increase the robustness of the trigger to such backgrounds. These improvements in the trigger design allow a trigger to be built that will be robust against the most pessimistic of current estimates of the flux of such charged particles.

## 2Simulationools

The results reported in this document are based on two simulation packages: the DPMJET event generator code [ref. 4], is used to simulate inelastic pp collisions, and the FLUKA code [ref. 3] is used to transport the particles produced in the pp interaction through the material and the magnetic field of the ATLAS apparatus. The FLUKA package has been widely used in ATLAS to estimate particle fluxes in the Inner Tracker and the muon system. It has also been used to understand data taken with prototypes of the electromagnetic and hadronic calorimeters in test-beam experiments. FLUKA has also been used to study the problems of radiation protection in ATLAS. Results from FLUKA have been compared with the predictions of similar codes, notably GCALOR [ref. 5]; it should be noted, however, that in GCALOR particles of energy above 10 GeV are transported using an old version of the FLUKA code [ref. 6]. Checks with experimental data have been performed [ref. 7],[ref. 8]. In particular with regard to the neutron and photon flux, agreement between data and prediction is good to 30% or better, where the geometry and material composition are known and simulated accurately in the Monte Carlo program. A similar consistency has been found between FLUKA and GCALOR. Despite this agreement, however, it should be anticipated that overall uncertainties on calculated counting rates in the Muon Spectrometer will be large; this point is discussed below in more detail.

Unless otherwise stated, all instantaneous particle rates are normalized to L =10\({}^{34}\) cm\({}^{-2}\)s\({}^{-1}\) and to an inelastic pp cross section \(\sigma\)=80 mb.

### MinimumBiaseventisimulation

The DPMJET code can be used to simulate pp inelastic collisions and hadron-hadron, hadron-nucleus and nucleus-nucleus interactions at cosmic ray energies, according to the Dual Parton Model. DPMJET has been compared with PYTHIA and with the results of a study based on existing data at the pp colliders [ref. 9].

The DPMJET program can include in the event simulation the production of diffractive events, which is the main difference from other event generators such as PYTHIA. Diffractive events can have consequences on the level of radiation background in LHC experiments. This is apparent in the distribution of the charged particle multiplicity. The average multiplicity in DPMJET differs from the predictions of PYTHIA by about 10% in the rapidity range \(\mid\eta\mid<\)2.5.

The transverse momentum distributions predicted by both PYTHIA and DPMJET are slightly harder than that in [ref. 9], and in reasonable agreement with each other. One important aspect for background studies is the simulation of particles produced at very high rapidity since the average energy of such particles is high. Both DPMJET and PYTHIA predict a similar shape for d\(\sigma\)/d\(\eta\); the differential cross-section is half of the plateau value at around \(\mid\eta\mid=\)6. However DPMJET predicts a tail that extends down to \(\mid\eta\mid=\)10 while in PYTHIA this tail stops at about \(\mid\eta\mid=8\).

### Particletransport

FLUKA is a Monte Carlo code designed for studying the interaction of hadrons, photons and leptons with matter. It is interfaced with a combinatorial geometry package which allows the use of complex 3D geometries.

The simulation of electron and photon interactions and transport, originally based on EGS4 [ref. 10], has been extensively improved. All discrete processes, from Compton scattering, the photoelectric effect and bremsstrahlung, have been revised and refined, taking into account binding corrections, polarization effects, electron positron differences and so on. Photon-induced nuclear interactions have also been implemented in the code. Furthermore, a detailed multiple scattering model based on the Moliere theory is used to transport charged particles through materials. Ionization energy losses are calculated according to the most recent tabulations including a treatment of statistical fluctuations. Muon transport includes an accurate treatment of catastrophic energy losses due to pair production, bremsstrahlung and photo-nuclear interactions.

Particular attention is given to hadronic interactions. At high energies a model based on DPM and Glauber cascade is adopted, while at low and intermediate energies a very detailed intra-nuclear cascade plus pre-equilibrium model has been developed. This latter energy range is of particular importance for background calculations. In this model, nuclear effects such as the nuclear well potential and Fermi motion, coherence effects, reflections and refractions at a nuclear boundary are considered. Nuclear evaporation with consequent emission of neutrons, production of protons and heavy fragments from excited nuclei is implemented. Pion interactions, including pion absorption, are treated in detail.

This detailed treatment allows FLUKA to simulate inelastic nuclear collisions down to 20 MeV hadron energy. Neutrons can be propagated down to thermal energies. This is accomplished by using a new multigroup neutron cross section library [ref. 11] based on the JEF-2.2 compilation [ref. 12], that includes data on photon production. The low energy neutron transport is based on an algorithm similar to the one used in the MORSE [ref. 13] code. Photons produced in low energy neutron interactions are transported by the electromagnetic sector of the code.

There is some physics that is not simulated in great detail by FLUKA. In particular, whilst kaons are transported accurately down to energies as low as 10 GeV, kaon transport at lower energies is not fully satisfactory and experimental data to benchmark the code are quite scarce. There are still some approximations in the kaon cross sections, in the nuclear effects on \(\overline{\mathrm{K}}\) interactions with matter and in kaon production. Furthermore, \(\mathrm{K_{s}}\)-\(\mathrm{K_{l}}\) regeneration is performed neglecting interference terms. All this results in large uncertainties on the kaon rate. An effort to improve all these points is in progress and will allow improvement in the physics transport of these mesons through matter.

### 2.3UseofFLUKAinATLAS

The ATLAS detector, the machine elements present in the experimental hall and the cavern structure have been simulated in FLUKA. Particular care has been given to a detailed description of the elements at large rapidity in the shielding system, the beam pipe, the collimator and the forward toroids. The detector elements located at low rapidity have been described in an approximate way, in particular the Inner Detector and the Muon System. Care has been taken, however, to faithfully reproduce the outer dimensions and the material composition. The barrel muon system has been simulated as a concentric structure of three cylinders surrounding the calorimeter and the central tracker. Each cylinder radius matches the average position of the inner, middle and outer muon stations (large and small). A similar approach has been adopted to describe the end-cap muon detector using three disks placed in the position of the end-cap muon chambers. Each station in both barrel and end-cap has been simulated as a single piece of homogeneous material that represents, on average, the structure and different materials that constitute the chamber. In each station a scoring plane has been inserted to perform the particle counting rate. No simulation of the barrel air-core toroid has been performed. Furthermore, elements such as the vacuum pumps that will be installed along the beam line in the ATLAS hall have not been considered.

FLUKA is a Monte Carlo package that uses bias techniques to speed up the program execution. For example some processes are forced to occur and appropriate weights are calculated for the correct use of the results in the analysis phase. The bias can be optimized on the basis of the particular processes of interest. For the ATLAS system simulation the program has been optimized to efficiently access neutron fluxes down to thermal energies and photon fluxes with energy above 10 keV.

The same program has been used to extract the rate of muon, pion and proton production; the energy threshold used was 10 MeV. It should be stressed, however, that the biasing technique adopted is not particularly optimized for muon rate predictions. This results in a distribution of weights in the final muon sample that covers a large range; whilst the mean weight is close to 0.01, the FLUKA sample contains a few muons with weights in excess of 10. This large spread in the weight has the potential to create problems since high weight events can reduce the statistical power of the generated sample. Studies are continuing to determine the validity of this type of event and to investigate ways to reduce the statistical error arising from such weight effects.

With independent FLUKA-based simulations, muon detector sensitivities to neutrons and photons have been evaluated. This has been done with samples of neutrons and photons with the energy spectrum as predicted by the ATLAS system simulation and assuming an isotropic flux around the muon chambers that, in this case, has been simulated in detail. This has been done for all ATLAS muon technologies, and checked with measurements taken with prototype chambers [ref. 14]. The convolution of neutron and photon fluxes with the detector sensitivities allows the evaluation of the detector counting rate.

### 2.4Checksmadebetweenalternativecodesandwithexperimentaldata

Many checks have been performed to verify the level of reliability of the FLUKA program. In particular measurements have been made of the spatial variation of hadron and low-energy neutron fluence and absorbed dose in the cascade induced in iron and lead calorimeter structures irradiated with 24 GeV to 200 GeV hadron beams. These measurements have been compared with the Monte Carlo predictions [ref. 7]. In most cases the results agree with measured data to better than 20%. Neutron fluxes produced in systems of complex geometry and with large attenuation factors involved have also been investigated. Neutron fluxes over a large range of energies, down to thermal energies were measured.

Measurements have been made using a 205 GeV hadron beam at CERN. The experimental apparatus consisted of an iron dump surrounded by concrete shielding blocks. Measurements have been taken in seven different positions and depths with traditional Andersson-Braun counters and also with a BF\({}_{3}\)-based neutron detector that is most sensitive at thermal energies, [ref. 15]. The FLUKA estimation agreed with data to a 30-40% accuracy at thermal energy and much better at higher energies.

Checks have also been made on charged particle production in hadron cascades. The study has been performed by comparing existing data on atmospheric muons taken at various heights above sea level and at different directions. The FLUKA program has been used to propagate cosmic protons as predicted by a NASA code [ref. 16] having used a simplified atmospheric model in fifty horizontal layers of different density. Figure 1 shows the negative muon flux at different heights in the atmosphere as predicted by the Monte Carlo and as measured by MASS [ref. 17]. The muons contributing to this plot are products of hadronic showering, as are the 100 MeV muons seen in ATLAS. However the material and field conditions are somewhat different and the resulting muon transport and production mechanisms are not identical in these data and in the ATLAS cavern. These results are nevertheless a confirmation of the ability of FLUKA to predict muon fluxes in hadronic showers. The agreement is remarkably good, typically better than 50%. Data from the DEIS spectrometer [ref. 18] have also been use to verify the FLUKA predictions; in this case horizontal muons have been checked at sea level. Again an encouraging consistency has been found. Unfortunately the available data allow the comparison for muon energies down to only about 0.5 GeV. More checks are needed to validate the predictions of muons with momentum around 100 MeV resulting from K\({}^{0}\) decays that are of primary importance for the ATLAS Level-1 muon trigger.

### Backgrounduncertainties

Several factors contribute to the uncertainty on the background estimate for the muon system. The uncertainties affect all rates except those for sail-through and primary meson decays, which are however subject to significant uncertainties on production cross-sections.

* The pp inelastic cross section and minimum-bias event properties: the pp inelastic cross section could be as high as 100 mb compared to the 80 mb assumed in the MC studies; an uncertainty of \(\pm 30\%\) is considered.
* Shielding hermeticity: attenuation factors of 100-300 can be achieved with the proposed shielding scheme provided technical cracks and openings, not accounted for in the ATLAS shielding system simulation, are kept well below 1% of the solid angle. An overall 1% aperture would result in at least a factor two higher background rate. Similar effects could originate even from smaller apertures in the case that they are located close to the main sources of background.
* Material composition: most background in the hall comes from neutrons and their capture photons. Neutron cross-sections, particularly in the thermal region where most captures occur, are very different even from one isotope to another, with variations up to four orders of magnitude. As a consequence, the material composition must be known to better than 10-3.

* Photon production: data on photon production in the low energy neutron libraries are often unsatisfactory and even absent for some isotopes. This leads to an overall 2.5 uncertainty factor on the photon flux;
* Particle transport: as discussed above, showering processes in absorbing materials are well described, allowing reproduction of experimental data at the 30% level. However the large number of interaction lengths involved suggests an overall uncertainty factor on the neutron flux of 1.4;
* Chamber sensitivity: the comparison of simulation results with laboratory measurements on chamber photon sensitivity suggests a conservative estimate on the uncertainty of about 1.5;

Figure 1: Measurementsofmuonfluxaturiausheightsabovesealevel,comparedwiththepredictionsofthe FLUKAprogram,asafunctionofmuonmomentum.ThemeasurementsaretakenfromMASSandareshown bypoints,thehistogramsrepresentheFLUKApredictionwiththeshadedregionshowingtheuncertaintyonthe MonteCarloprediction.Theheightsareshowningcmâ€“2ontheplot.

* Neutral kaon transport: this is the hardest uncertainty to quantify. An underestimation of the neutral meson production rate by a factor three is possible. A reduction of this uncertainty factor will be possible once an improved simulation of kaon transport is available in the Monte Carlo.

The overall uncertainty on detector counting rates depends on the flavour of the particle responsible. The rate of Compton electrons, responsible for most of the detector counting rate, is affected by all the above uncertainties, except the kaon sector simulation; this leads to an overall factor of about 7. Similarly pions and muons originating from kaons are affected by all effects except for photon sensitivity and material composition. In this case, a global uncertainty close to 7.5 should be considered.

## 3Level-1triggersimulation

The studies discussed here have been made using two independent simulations of the ATLAS muon trigger chambers and the Level-1 muon trigger logic. One simulation uses the full ATLAS detector and trigger simulation framework, the other is a stand-alone simulation that uses the full geometry and magnetic field, but a simplified simulation of the Level-1 muon trigger logic. The use of these two independent simulations permits a cross-checking of results, and a comparison of the different features of each simulation.

### Thefullsimulation

In order to understand the performance of the ATLAS Level-1 muon-trigger detailed simulations of both the ATLAS detector and trigger have been made. These include modelling of the passive material of the detector, of the active volumes and detector response of the muon-trigger counters, and detailed simulation of the logic of the muon-trigger itself [ref. 1]. This has been done in the framework of the standard ATLAS simulation packages, using GEANT 321 [ref. 21] to describe the detector geometry in the DICE [ref. 19] program, and the ATRIG [ref. 20] package to simulate the trigger response.

#### 3.1.1 Materialofthedetectorandmagneticfield

The material through which muons pass prior to traversing the trigger counters plays an important part in determining the acceptance of the trigger coincidence windows due to the contribution of multiple scattering to the measured residual in the trigger chambers. All this material is included in the DICE simulation package. Material arising from cables, cooling components and other elements of the detectors that have yet to be finalized are not included in the simulation. These constitute an amount of material that can be neglected relative to that present in the current detector model.

A precise map is made of the three-dimensional magnetic field arising from the barrel and end-cap toroids as well as the field of the central solenoid, including the Tile hadron calorimeter which acts as the return yoke. This enables the path of charged particles in the simulation to be accurately tracked. The magnetic configuration used to calculate the field map is described in [ref. 22].

#### 3.1.2 Thetriggerchambers

In the ATLAS detector simulation particular care has been taken in describing the different technologies of the muon spectrometer: resistive plate chambers (RPC) and thin gap chambers (TGC), forming the trigger system, are all simulated in detail with regard to the geometry and material composition. Cathode strip chambers (CSCs) provide the precision measurement of muon position and momentum for \(|\eta|>\)2, in the first muon station. The CSCs are not modelled in the present simulation; a single doublet of TGCs has been simulated in their place for the purposes of studying the possible use of the CSCs in the end-cap muon trigger. Trigger signals for the Level-1 muon-trigger are provided by: RPCs in the barrel and TGCs in the end-cap. In order to understand the many triggering issues raised by the performance of the trigger chambers these chambers have been modelled in detail within the DICE package. For the TGC a detector response is assumed such that hits are produced on only a single wire. In the RPC cluster size is modelled with an upper limit of two hit strips per track. Full hit efficiency for charged particles traversing active volumes is assumed in both subsystems. Within the active volumes spacers within the gas gaps are modelled. Effects that cause the chambers to deviate from their nominal geometry, such as temperature related effects and chamber displacement or deformation are not simulated.

This simulation reproduces the currently envisaged configuration of the chamber layout. For each subdetector in the simulation one layer of strips or one layer of wires is defined as a sensitive plane and digitisation is modelled using the GEANT tracking of particles through the simulated detector volumes to determine the hit position.

#### 3.1.3 Simulationofthetriggerlogic

The digits from the simulation of the trigger chambers are passed to a detailed simulation of the hardware containing the trigger logic. The full logic of the trigger, including the coincidence matrices in which coincidences are formed, is modelled. The details of the trigger electronics and the modelling of the logic in the simulation are discussed in [ref. 1].

The only significant aspects of the trigger that are not included in the simulation used for these performance studies are the timing information (which is included in the stand-alone simulation discussed in Section 3.2) and some simulation of expected noise. Dedicated GEANT simulations and numerical calculations have been performed to evaluate the effect on trigger rates and performance from these phenomena [ref. 24], [ref. 25].

### 3.2Thestand-alonesimulation

In addition to the full simulation using DICE and ATRIG, it has been found useful to have an alternative simulation framework that can be run in a stand-alone mode. This simulation uses a full GEANT simulation of the detector, covering the active volumes of the muon trigger chambers and the passive material of the support structures and other detector volumes. It uses a the official ATLAS magnetic field map.

The logic of the Level-1 trigger has been modelled in a simplified way. Window sizes on the relevant trigger planes have been parametrised from the calculated values and applied as a function of \(\eta\) and \(\phi\) position in the trigger chambers. Otherwise the trigger algorithm is applied in an identical fashion to that of the full simulation.

A simulation of the timing properties of the trigger has also been implemented in the stand-alone program. This allows the application of a realistic timing coincidence between hits in successive planes of the trigger chambers, something not yet implemented in the full simulation. This allows the quantification of the rate reduction achieved with the application of such a coincidence in comparison with the simple geometric coincidence.

### 3.3InterfaceoftheFLUKAdatatotheATLASSimulation

The FLUKA simulation discussed in Section 2 contains a full model of the material of the ATLAS detector and is thus able to accurately simulate the effect on particle trajectories of interactions with the material and the magnetic field of the detector. However only the GEANT-based simulations discussed in Sections 3.1 and 3.2 can provide a description of the detector response to such particles. In particular since there is a need to know the response of the ATLAS trigger chambers and trigger logic to the 100 MeV background, the FLUKA data must be interfaced to the full and stand-alone simulation programs.

The output of the FLUKA simulation is a set of particle types and momenta after their interaction with the material and magnetic field of the ATLAS detector. For input to the GEANT-based simulation packages, the 4-vectors of all muons in the FLUKA sample are calculated at a point just prior to their impact on the trigger chambers. This requires a small approximation in the extrapolation of tracks from their location in the FLUKA scoring plane situated at the middle MDT station. This is performed assuming an infinite momentum path. For particles coming from the direction of the interaction point the relevant trigger station will be RPC 1 or TGC 1, whilst for those travelling in the opposite direction this will be RPC 3 or TGC 3. These 4-vectors are then input to the ATLAS detector and trigger simulation programs.

## 4Triggerschemes

### 4.1TheTDRscheme

The so-called 'TDR scheme' is that discussed in detail in the ATLAS Level-1 trigger TDR [ref. 1] and only a brief summary is given here. The Level-1 muon trigger is based on the measurement of muon trajectories in three different detector planes (called stations). Muons are deflected by the magnetic field generated by the toroids; the angle of deflection depends on their momentum and the field integral along their trajectory. Coulomb scattering in the material traversed, and for low-\(p_{\mathrm{T}}\) triggers, energy loss fluctuations are also of importance.

The differences compared to the straight-line trajectory of an infinite-momentum particle originating at the nominal interaction point are measured using three trigger stations, (Figure 2). The trigger plane farthest from the interaction point in the end-cap, and the one nearest to the interaction point in the barrel, is called the pivot plane. The two different lever arms from the pivot to the other two trigger planes provide two different measurements of the size of the deflection due to the field. The two different lever arms allow trigger thresholds to cover a wide range of transverse momenta with reasonably good resolution: the shorter lever arm (the pivot and station 2) covers a lower-momentum range and the longer one (the pivot and station 1 for the end-cap, the pivot and station 3 for the barrel), a higher-momentum range.

Each hit found in station RPC 1 (TGC 3) is extrapolated to station RPC 2 (TGC 2) along a straight line through the nominal interaction point. A coincidence window is then defined around this point, where the window size depends upon the required \(p_{\mathrm{T}}\) threshold. The low-\(p_{\mathrm{T}}\) trigger condition is satisfied if, for both projections

* there is at least one hit within the coincidence window, and
* at least one of the two low-\(p_{\mathrm{T}}\) stations has hits in both trigger planes, to satisfy the three-out-of-four logic

A similar procedure is performed for the high-\(p_{\mathrm{T}}\) trigger, where the planes of RPC 3 (TGC 1) together with the pivot plane are used. The high-\(p_{\mathrm{T}}\) trigger is satisfied if

* the track passes the low-\(p_{\mathrm{T}}\) criteria, and * in the barrel at least one hit in the two trigger planes of RPC3 are in coincidence, and in the end-cap if at least two of the three planes of TGC 1 in the \(\eta\) view, and one of the two planes of TGC 1 in the \(r\)-\(\phi\) view, are within the appropriate coincidence window.

The muon-trigger is divided into regions in \(\eta\)-\(\phi\) where independent trigger windows can be used. The size of the coincidence window defines the \(p_{\mathrm{T}}\) threshold applied in the trigger - the wider the window, the lower the threshold. Windows are defined such that efficiency at the quoted \(p_{\mathrm{T}}\) threshold is 90%. A time coincidence among hits is also required, to identify the bunch crossing.

### 4.2Extensionstoincreasetherobustnessofthebarreltrigger

#### 4.2.1 Useofthebarrelouterstationinthelow- \(p_{\mathrm{T}}\)trigger

In the barrel trigger the principle of operation of the high-\(p_{\mathrm{T}}\) trigger can be adopted also for low \(p_{\mathrm{T}}\) thresholds through the use of all three trigger stations. The confirmation from the third plane is made by demanding a loose spatial coincidence at the Sector Logic level. Due to the presence of significant field in the region between RPC 2 and RPC 3, this additional requirement in the trigger is very effective in reducing background from softer charged particles, without degrading efficiency for muons of \(p_{\mathrm{T}}\) above 6 GeV. The details of the implementation of this scheme are described in Section 6.1.1.

#### 4.2.2 UseofsignalsfromtheTileCalorimeter

The ATLAS Tile Calorimeter [ref. 26] is located inside the Muon Spectrometer with an outer radius of 4.23 m, and covering a geometrical region (with full depth), \(|\eta|<\)1.2. Muons with sufficient \(p_{\mathrm{T}}\) to traverse all the material of the calorimeter, typically \(>\)3 GeV, leave a significant energy deposit in the third sampling, well separated from noise from the electronics and pile-up effects.

The Level-1 barrel muon trigger electronics and logic are being designed such that signals from the Tile Calorimeter can be input to the trigger and used in coincidence with track candidates from the barrel muon trigger chambers (Section 6.1.2). This allows the trigger to be robust against the most pessimistic estimates of potential background (Section 5.2). Such a demand maintains an efficiency for muons of \(\sim\)99% with backgrounds at the 1% level.

In the Tile Calorimeter an analogue sum of Photo-multipliers in the third and final depth compartment is made. This requires additional cabling to carry the \(\sim\)1000 summed signals to USA15, beyond the cavern. A discriminator system to provide inputs to the Sector Logic will be added only if the addition of the TileCal signals to the barrel trigger is established as being necessary.

## 4.3Extensionstoincreasetherobustnessoftheend-captrigger

#### UseoftheTGC1stationintbelow- \(p_{\rm T}\)trigger

In the end-cap trigger, the principle of operation of the high-\(p_{\rm T}\) trigger can be adopted also for low-\(p_{\rm T}\) thresholds through the use of all three trigger stations in the same way as for the high-\(p_{\rm T}\) trigger. The comparatively long lever arm between the pivot plane (TGC 3) and the high-\(p_{\rm T}\) plane (TGC 1) of the end-cap trigger chambers results in large trigger windows being required for a 6 GeV trigger in the full system. In some regions the window size exceeds the limits that are set by the dimension of the original design of the coincidence matrices (15 units in the primary bending (\(\eta\)) direction and 7 units in the \(\phi\) direction). In order to accommodate these large windows without significantly increasing the cost and complexity, non-linear coincidence matrices are introduced (i.e. the wire and strip ganging becomes a function of the position in the coincidence matrix). Using such coincidence matrices enables a 6 GeV threshold to be set with high efficiency without affecting the high-\(p_{\rm T}\) trigger performance. The implementation is discussed in Section 6.2.1.

#### UseoftheEIandFITGCstation

In the Muon Spectrometer design of [ref. 22] and [ref. 1], the inner TGC station (EI and FI in Figure 2) was not expected to provide input to the trigger. (It was included to provide second co-ordinate information to complement the radial hit information from the MDTs in the Inner Station.) However, the incorporation of the hit information from the EI and FI doublets into the Level-1 end-cap muon trigger is simplified by the fact that these are similar chambers to those in the outer three TGC stations, with similar on-detector electronics. This solution provides excellent robustness against soft charged particles due to the very large field integral produced by the forward toroids located between the trigger system and the innermost muon station.

The layout of the EI and FI chambers is shown in Figure 3. The FI chambers cover the full azimuthal acceptance and are situated approximately 6.9 m in z from the interaction point.

The EI chambers are situated farther from the beam-line; in azimuth they are positioned around the eight-fold structure of the barrel toroid and thus cover only about 70% of the azimuthal acceptance. Inclusion of a hit demand in the EI chambers in the trigger will thus somewhat reduce the acceptance of the trigger. The EI and FI chambers cover the region 1.0\(<|\eta|<\)1.9.

There are several choices of coincidence between the inner TGC chambers and the three (or two) stations beyond the end-cap toroid. Since the EI and FI chambers are doublets, 1 or 2 hits can be demanded for each muon trigger candidate, and both options will be available. A local (ratherthan chamber-wide) coincidence will be used. As for the full system 6 GeV trigger, windows in the EI/FI station are large for low-\(p_{\rm T}\) thresholds. The robustness of a trigger including such coincidences is limited by the occupancy of the trigger windows in EI/FI station, that give rise to accidental coincidences with tracks in the outer three stations. However, a preliminary study suggests that such accidental coincidences are rare (Section 6.2.2).

#### 4.3.3 PossibleesoftheCathodeStripChambers

Multi-wire proportional chambers with cathode strip read-out are used for the inner measurement station in the very forward region (\(\,\)1\(\,\)\(\eta\)\(\,\)\(\,\)\(\,\)\(>\)\(\,\)2), where high counting rates are expected. These provide precise muon hit information at high pseudorapidity to complement that from the MDTs. In principle it is possible to use signals from the Cathode Strip Chambers (CSCs) in coincidence with the outer three TGC stations in the same way as is envisaged with the EI and FI TGC chambers. Such a coincidence would provide additional coverage with a very robust trigger in the very high rapidity region. However the differing technologies and electronics of the CSC and TGC systems make this a more complex option than the integration of the inner TGC station.

Preliminary studies have been made of the \(\eta\) structure of the rate seen in the end-cap trigger arising from the 100 MeV background, but the low Monte Carlo statistics prevent any firm conclusions from being drawn yet about the necessity of including the CSCs in the trigger. These studies are continuing. To date no detailed design work incorporating CSC signals in the Level-1 end-cap trigger has been performed, but work is continuing to determine the feasibility of such a design in the event that additional robustness in the very forward region is required.

## 5Simulationresults

Particles generated and transported through the ATLAS detector and magnetic field in FLUKA have been used to determine what contributions there are to the muon trigger rate from charged particles and the sources of these charged particles. Charged particles simulated in FLUKA that are seen to traverse the trigger planes have been passed through the two independent simulations of the ATLAS trigger chambers and trigger logic (Section 3.1 and 3.2). The TDR muon trigger scheme and the extensions to it discussed in Section 4 have been studied. This allows the calculation of the trigger probabilities and thus the trigger rates expected in each of the trigger schemes, from their response to charged particles of momentum \(\sim\)100 MeV that are predicted by the FLUKA Monte Carlo program. The efficiency of the various trigger schemes for muons of \(p_{\rm T}\)= 6 and \(p_{\rm T}\)=20 GeV has also been calculated.

### Chargedparticlebackgroundinthemuonsystem

The FLUKA Monte Carlo has been used to study the charged particle backgrounds present in the muon system, and in particular the characteristics of those particles traversing the region of the muon trigger chambers.

#### 5.1.1 Muons

Background muons can be divided into two categories: muons from in-flight decays of primary pions and kaons and those from all other physics processes.

The muon rate seen in the trigger chambers from in-flight decays of hadrons is smaller than that arising from other sources (see Table 2), and is dominated by muons with momentum in the range a few hundred MeV to 1 GeV. Such muons are produced largely in the central cavity from decays of primary \(\pi\)/K mesons. The efficiency of the trigger for such muons has been evaluated by passing a sample of single muons generated at the interaction point and covering a wide \(p_{\mathrm{T}}\) range, through the full ATLAS detector and trigger simulation, [ref. 1]. The expected rate has been extracted by convolving this efficiency as a function of \(p_{\mathrm{T}}\) with the calculated cross-section of muons from in-flight \(\pi\)/K decays. This cross-section is the result of a high statistics study using both the PYTHIA and DPMJET Monte Carlo programs, [ref. 28]. The expected rate from in-flight decays is summarised in Table 1.

Muons are also produced via nuclear reactions. For example they may result from decays of charged pions and kaons produced in hadron showers in the detector material. The FLUKA Monte Carlo program has been used to study the nature of muons produced in such processes and the implications for the muon trigger. The hit rate from such muons in the muon trigger chambers is 7 MHz in the barrel and 8 MHz in the end-cap (Table 2). The momentum spectrum of these muons is shown in Figure 4. In both the barrel and the end-cap the flux is dominated by muons of momentum close to 100 MeV.

The production point of muons that traverse the trigger chambers is shown in Figure 5, and can be seen to be dominated by muons that are produced rather close to the trigger chambers. These muons are almost all produced by neutral kaons, either through semi-leptonic decay, or indirectly through K\({}^{0}\) decay to charged pions. The strong magnetic field beyond the innermost muon station is responsible forthe reduction of punch-through muons in the trigger chambers. Thus only muons transported by neutral particles (i.e. K\({}^{0}\)) can reach the trigger stations.

The angular distribution of muons produced via decays of K\({}^{0}\) mesons and impacting on the trigger chambers is shown in Figures 7 & 7. It can be seen that in the barrel the distribution is rather symmetric about zero, indicating that muons are arriving at the trigger chambers from both in- and out-going directions. In the end-cap the presence of the end-cap toroids and their associated field removes much of the out-going soft muon flux; most of the hit rate is therefore due to muons arriving from the direction of the shielding.

The calculated overall hit rate in the trigger chambers due to muons produced via \(\mathrm{K^{0}s}\) arising from nuclear processes is twice that from muons arising from in-flight decays of \(\pi/\mathrm{K}\) mesons. The former is, however, potentially much more serious due to the very large uncertainties in the flux calculation. These uncertainties are discussed in Section 2.5.

#### 5.1.2 Othercharged particles

The flux of charged particles other than muons also contributes to the trigger rate. The hit rate arising from charged particles of different kinds is shown in Table 2. The pions are produced almost exclusively in \(\mathrm{K^{0}}\) decays. Nuclear reactions of primary hadrons with detector material make some contribution, whilst the background arising from primary pion sailthrough (i.e. traversing of the calorimeter with no interaction) is negligible. The momentum of such pions is in the range 50-300 MeV, similar to the muons of Section 5.1.1. Pions from the FLUKA Monte Carlo sample that impinge on the trigger chambers have been passed through the ATLAS detector and trigger simulation and their mean trigger probability calculated in the same way as for the muons. The low-\(p_{\mathrm{T}}\) trigger probability of pions in the TDR scheme is comparable to that of muons, whilst the trigger probability in the low-\(p_{\mathrm{T}}\) full system scheme is considerably lower. No high-\(p_{\mathrm{T}}\) triggers in the TDR scheme were seen. Given that the flux of pions in the trigger chambers is somewhat lower than that of muons (Table 2), it is expected that the trigger rate seen from pions will be comparable to that from muons at low-\(p_{\mathrm{T}}\) in the TDR scheme and lower at high-\(p_{\mathrm{T}}\) and in the improved low-\(p_{\mathrm{T}}\) trigger schemes.

Protons are produced in nuclear reactions of neutrons, and in particular through neutron spallation, with the material of the detector. Anti-proton production is thus negligible. These protons have a mean momentum close to 400 MeV. Protons produced using the FLUKA Monte Carlo that impinge on the trigger chambers have also been passed through the detector and trigger simulation. It is found that the trigger probability of such protons is less than that of muons in the barrel and somewhat higher that that of muons in the end-cap. The higher average momentum of the protons also makes them more likely to give a trigger in the robust trigger schemes than the muons.

Work with charged particles other than muons is continuing and detailed results will be available in the future.

### 5.2Triggerrates

The most detailed studies performed so far have been done for the background due to muons. Monte Carlo tracks representing the '100 MeV' muon background have been passed through the ATLAS detector and trigger simulation programs to determine the mean probability of such muons giving a trigger in each trigger scheme. The calculation of this trigger probability takes into account the individual weights assigned by FLUKA to each muon in the sample (Section 2.3). The calculation is performed taking the (weighted) number of triggers relative to the number of (weighted) hits in each plane of the trigger chambers. The expected trigger rate is then obtained by multiplying the average trigger probability by the expected flux of muons. The calculation of the muon flux at the trigger chambers is also provided by the FLUKA MonteCarlo: the value used is the flux predicted in the middle MDT station of the muon spectrometer (corresponding approximately to the positions of trigger stations TGC 1 and 2, and RPC 1 and 2). This flux is averaged over each of the barrel and end-cap systems, which are treated independently, and multiplied by the total area of each system. The total muon impact rates, i.e. the total rate of muons over the entire surface of the trigger chambers, are shown in Table 2. These hit rates are for the nominal luminosity and so for the low-\(p_{\mathrm{T}}\) trigger should be divided by 10 to represent conditions in low luminosity running.

The rates expected for all trigger schemes are tabulated in Table 3.

These include various combinations of the robust triggers (such as using the full system _and_ the inner TGC and CSC chambers) which are quite possible given the programmable nature of the improved trigger schemes. In some cases low expected rates and limited Monte Carlo statistics necessitate the quoting of upper limits rather than estimates of the expected rate. Systematic uncertainties on these rate estimates are discussed, in terms of a safety factor, in Section 5.3.

The stand-alone and full simulation results can be compared subject to consideration of the effect of the application of the time coincidence, which is absent from the full simulation. Applying such a coincidence in the stand-alone simulation is seen to reduce the trigger probability, and thus expected rates, by a factor of 0.44 in the barrel and 0.73 in the end-cap. One would thus expect this to introduce a discrepancy of this order between the two sets of results in Table 3 independent of other effects. The observed differences between the results are everywhere less than a factor two, but in the opposite direction from that expected given the effect of the demand of a time coincidence in the stand-alone simulation. It is however to be expected that the stand-alone simulation does not exactly reproduce the full simulation results since in the stand-alone simulation conservative approximations are made in the treatment of the geometry and trigger logic (Section 3.2). Generally uncertainties arising from the detector and trigger simulation are expected to be small relative to those coming from the FLUKA Monte Carlo simulation.

#### 5.2.1 Thebarreltrigger

In the barrel trigger the TDR scheme is seen to give rise to estimated rates at the low-\(p_{\mathrm{T}}\) threshold of the order one tenth of the maximum total Level-1 output rate, and considerably less than this at high-\(p_{\mathrm{T}}\). The use of the third station for confirmation of the trigger for the low-\(p_{\mathrm{T}}\) 6 GeV threshold reduces the expected rate in the barrel from the 100 MeV muons by a factor >50. The large area of the chambers covered by the single Sector Logic board where the coincidence is demanded suggests that the occupancy of the trigger logic should be investigated. Studies made using the stand-alone simulation imply that occupancy levels in the outer RPC chambers, applying the Sector Logic granularity, are less than 1%, even using 1-out-of-2 logic in the outer station. This extension to the trigger in the barrel, whilst requiring only minor modification of the trigger electronics, thus adds considerable robustness to the trigger A second study has looked at confirmation of the Level-1 muon signal in the Tile Calorimeter, using a simulation of the TileCal response to muons that is independent of the trigger simulation. This suggests that an efficiency of 99% can be achieved in muon identification with a fake probability of 1%, see Figure 8. This results in an extremely robust trigger; expected rates from this study are shown in Table 3.

#### 5.2.2 Theend-captrigger

In the end-cap TDR scheme, rates are estimated to approach 10 kHz at the low luminosity, low-\(p_{\mathrm{T}}\) threshold and slightly less at high luminosity and high-\(p_{\mathrm{T}}\). The use of the full (three station) logic of the trigger for the low-\(p_{\mathrm{T}}\) 6 GeV threshold trigger reduces the expected rate in the end-cap by a factor 4.

The addition of a requirement in the end-cap trigger of a coincidence with the TGC chambers of the EI/FI station prevents any triggers from muons with momentum too low to penetrate the end-cap toroid, and thus removes any triggers purely from 100 MeV muons. In the full simulation using the FLUKA muon sample no triggers are seen. The occupancy in the EI/FI chambers then determines the expected trigger rate from accidental coincidences; this has been studied using the stand-alone simulation. Since the EI/FI TGC chambers are doublets, the trigger will be able to use either 1-out-of-2 ('OR') or 2-out-of-2 ('AND') logic to confirm a coincidence, where this logic can be performed locally i.e. within a single detector unit. Depending on the exact form of coincidence demanded, the probability to validate a fake trigger is in the range 0.05-1.0 % in low luminosity running and 0.05-0.6% at nominal luminosity. These ranges in clude the application of a safety factor (ten for neutrons and photons, and two for other particles). Such probabilities translate to very low trigger rates. (See Tables 3 and 4; here the local OR logic, giving the higher rate, is quoted.)

The coincidence window occupancy as a function of pseudorapidity for both the AND and OR logic is shown in Figure 9. The EI/FI station TGC detectors occupy the region 1.05\(<\) 1 \(\eta\)! \(<\)1.92,

whilst the outer stations of the end-cap trigger chambers extend to 1 \(\eta\)! \(<\)2.4. For the CSCs, cal culations have proceeded on the assumption that at least two of the available four layers will be used to form an AND coincidence. The redundancy offered by the additional layers makes possible occupancy values in the trigger windows even lower than those in the inner TGC station.

The numbers shown in Table 3 exclude the rate arising from the single event of very large weight discussed in Section 2.3. Table 4 shows the rates from the 100 MeV background expected in the end-cap trigger at the low- threshold if this one event is considered a valid part of the Monte Carlo sample. Only the low-\(p_{\mathrm{T}}\) rates are affected since this event is not seen to pass any of the high-\(p_{\mathrm{T}}\) triggers. The inclusion of this event increases the rate seen in the TDR trigger scheme at low-\(p_{\mathrm{T}}\) by a factor greater than 2, since its weight is a factor of 1000 larger than the mean in the sample. Since this event does not pass the trigger demanding a coincidence with the EI/FI station, and in view of the large B.\(d\)l of the toroid, one can assume that this trigger configuration is robust against the background represented by the event. Indeed no rate from 100 MeV muons is expected in this scheme owing to the material and field of the end-cap toroid.

It is believed that the large distribution of weight values seen in the muon sample arises from the optimization of the FLUKA code for neutron studies. There are, however, thought to be no systematic problems associated with using such code for the extraction of muon fluxes [ref. 29]. This procedure thus introduces only a large statistical error which can be considered by comparing the rates seen in the end-cap low-\(p_{\mathrm{T}}\) trigger with and without this event. Investigations are continuing into the weighting procedure to optimise FLUKA for muon flux calculations, and in due course high statistic samples will be produced to minimise any remaining statistical error.

### Uncertaintiesintriggerrates

When calculating the rates that any one trigger scheme is likely to yield, the uncertainties are considered by multiplying the calculated rate by a so-called safety factor, representing the uncertainty on the rate calculation. The rate containing the safety factor then represents an upper limit on what might be expected taking the worst case for each of the assumptions made in the error calculation. This safety factor is dominated by contributions arising from the Monte Carlo model. These arise largely from uncertainties in the particle production and transport modelling in FLUKA, as well as from purely statistical uncertainties arising from the track weighting procedure used in the production of the FLUKA event sample. The total uncertainty in the Monte Carlo has been estimated (Section 2.5) to be somewhat less than a factor of 10 for muons.

Additional uncertainties arise from the ATLAS detector simulation and modelling of the trigger logic. However, these are estimated to be small (see [ref. 1], 14.6.1.2) in comparison with uncertainties arising from the Monte Carlo. Thus the total safety factor applied for the rate contribution from muons is 10. It is possible that, as understanding of the processes contributing to the cavern background increases, this uncertainty will decrease. Additionally the contribution from other charged particles should be considered. Preliminary studies of pionsand protons (Section 5.1.2) suggest the total rate contribution from each particle type is likely to be similar to that from the muons, and so an additional factor of three should be considered to account for these. However the Level-1 trigger is designed to operate assuming the full safety factor, i.e. on the most pessimistic assumptions. In the event that backgrounds are seen to be as predicted by the Monte Carlo it will be sufficient to use only the full system low-\(p_{\mathrm{T}}\) trigger (i.e. that which includes in the coincidence logic, hits from all three trigger planes) scheme in both barrel and end-cap to ensure a rate that is unproblematic. The possibility to include the EI/FI coincidence in the end-cap and the TileCal coincidence in the barrel provides a very robust trigger, sufficient even given the worst case assumptions with regard to the Monte Carlo uncertainties.

### Efficiency

The efficiency of the trigger for the different schemes has been evaluated by generating single muons over a wide range of momenta and passing these through the full ATLAS detector and trigger simulation. The barrel and end-cap systems have been studied independently, since the robust trigger schemes differ in these two regions, and the efficiency evaluated as a function of the initial \(p_{\mathrm{T}}\) of the muon. In the end-cap where the window size and trigger efficiency have significant \(\eta\) dependence the efficiency has been calculated as a function of \(\eta\), integrating over \(\phi\). The efficiency is given simply by the ratio of the number of triggered muons to the number generated within the \(\eta\) fiducial interval.

Trigger windows are calculated in all trigger schemes to give 90% efficiency at the quoted \(p_{\mathrm{T}}\) threshold. Only in those schemes where there is a constraint arising from the geometry of the detectors contributing to the trigger is this efficiency reduced. The efficiency of the TDR scheme in the end-cap, and the two extensions to it are shown in Figures 10 and 11. The full system, low-\(p_{\mathrm{T}}\) 6 GeV trigger demonstrates a slightly lower efficiency than the TDR scheme due to the lack of overlapping of chambers adjacent in \(\phi\) in the triplet. There is no exchange of signals between such chambers, resulting in an inefficiency which increases with window size as \(\eta\) becomes smaller.

In the end-cap scheme requiring a coincidence with EI and FI a local 2-out-of-2 ('AND') coincidence in the EI/FI station has been demanded. It should also be noted that the CSCs have been included in this simulation modelled as a TGC doublet and used in the trigger in the same way as the EI/FI station. The absence of EI chambers in those regions of azimuth where the barrel toroids are located results in reduced efficiency relative to the TDR scheme in the range \(0.9<|\eta|<1.25\).

Figure 12 shows the efficiency of the full system in the barrel as well as the TDR scheme for the 6 GeV threshold. Efficiency loss due to the introduction of the third station confirmation is small. Efficiency of the TDR scheme for the high-\(p_{\mathrm{T}}\) 20 GeV threshold is shown in Figure 13.

The efficiency of a coincidence with the TileCal in the barrel trigger has been investigated using a simulation independent of the trigger simulation. This suggests that muons can be identified in the TileCal with an efficiency of about 99%. Thus any efficiency losses will arise only where the geometrical coverage of the TileCal is less than that of the trigger chambers. Such inefficiency will be small, but remains to be studied in detail.

## 6Updatestothedesignoftherapyfarndware

### TheLevel-1barreltrigger

#### 6.1.1 UseofRPCouterstation

Including the full three-station logic in the low-\(p_{\mathrm{T}}\), 6 GeV threshold barrel trigger requires modifications to both on-detector and off-detector logic, the coincidence matrix (CM) ASIC and the PAD and Sector Logic.

In the Level-1 TDR barrel trigger design [ref. 1], three low-\(p_{\rm T}\) and three high-\(p_{\rm T}\) thresholds were foreseen. The logic for one of these three high-\(p_{\rm T}\) thresholds (THR2) can be used to flag low-\(p_{\rm T}\) muon candidates reaching the third station, but not satisfying the high-\(p_{\rm T}\) algorithm. In this scheme THR2 signals the presence of 1-out-of-2 or 2-out-of-2 hits in the outer RPC doublet, where this choice is programmable. A low-\(p_{\rm T}\) trigger will be validated by the presence of THR2 within the corresponding Sector Logic.

The detailed modifications required in the CM are the following:

* each of the three possible threshold settings must be independently capable of forming the 1-out-of-2 or 2-out-of-2 majority coincidence;
* each of the three thresholds must have independent masking logic, in order to generate a high-\(p_{\rm T}\) trigger even if the corresponding low-\(p_{\rm T}\) CM does not find any candidates.

The PAD logic will not treat the THR2 trigger as a normal high-\(p_{\rm T}\) trigger but will set a flag (OPL) and send it to the Sector Logic. This is necessary to avoid a single hit on the outer station over-riding a low-\(p_{\rm T}\) candidate. This operation will be done in the three programmable LUTs of the PAD. The additional OPL flag will be sent to and used by the Sector Logic. This operation does not increase the PAD logic latency.

The Sector Logic will be modified to validate low-\(p_{\rm T}\) triggers only if at least one OPL flag is found within the sector. The validation will be programmable independently for each low-\(p_{\rm T}\) trigger threshold. The addition of one clock period to the latency of the RPC trigger is necessary to accomplish the new Sector Logic processing, although this will not affect the overall Level-1 trigger latency.

In this context the use of the outer RPC station will be a programmable option of the muon trigger system. It should be emphasised that this additional request will limit the number of high-\(p_{\rm T}\) thresholds to two, when the robust logic is in use.

#### 6.1.2 UseofTilecalssignals

In order to accommodate a coincidence between energy deposition in the TileCal and tracks in the Level-1 barrel muon trigger, it is foreseen that TileCal signals will be input to the Sector Logic. If and when they are implemented, the off-detector TileCal discriminator electronics will shape and fan-out the detector signals to the Sector Logic boards. The mapping of the TileCal signals to PADs will be done within the Sector Logic. The possibility of including the TileCalinformation in the muon decision will be programmable individually for each threshold.

A muon candidate within a PAD will be confirmed only if a corresponding TileCal signal is present within the corresponding bunch crossing. The addition of one clock period in the RPC trigger latency is necessary to accomplish this new task (overall Level-1 latency is unaffected). The logic which maps the TileCal signals belonging to a Sector to PADs will also be implemented in the Sector Logic, using fully programmable logic.

Figure 15: BlockdiagramoftheSectorLogicofthebarreltrigger,includingprovisionofconfirmatorsignals fromtheTileCalorimeter.

### 6.2TheLevel-1end-captrigger

#### Useofthefullsystem forthelow-\(p_{\rm T}\)trigger

The design change relative to the TDR design [ref. 1] to allow use of the full three-station system for the low-\(p_{\rm T}\) trigger (thresholds down to 6 GeV) is to introduce an enlarged coincidence matrix with non-linear \(\delta\)R/\(\delta\phi\) signal information on the High-\(p_{\rm T}\) Board. The High-\(p_{\rm T}\) Board, shown in Figure 16, receives track information from sets of four Doublet Slave Boards and hit information from a projectively-matching set of Triplet Slave Boards, and performs a two-fold coincidence on these input signals to form low-\(p_{\rm T}\) trigger signals in addition to the high-\(p_{\rm T}\) trigger signals. The coincidence operation is performed by a 256x296 two-fold coincidence matrix that is enlarged to accept low-\(p_{\rm T}\) muons down to 6 GeV. Figure 17 shows in more detail the internal structure of \(1/32^{\rm nd}\) of the matrix. Hits in each matrix element (coincidence unit) are OR'ed in a diagonal line for the high-\(p_{\rm T}\) trigger and are OR'ed in two diagonal lines for the low-\(p_{\rm T}\) trigger, resulting in 31-bit wide \(\delta\)R information (\(\delta\)R in the range -15 to +15, non-linear). The track with the smallest \(\delta\)R is selected from each \(1/8^{\rm th}\) of the matrix and the information on the hit position and \(\delta\)R is sent to the track selector, where up to four track candidates (those with the lowest \(\delta\)R values) are selected and then sent to the Sector Logic. The High-\(p_{\rm T}\) board for strips is similar to that for wires.

#### 6.2.2 UseoftheEI/FIstation

Figure 18 shows an overview of the signal processing scheme for the EI/FI TGC chambers in the Level-1 muon trigger. The total numbers of wire signals from an EI TGC doublet unit and an FI TGC doublet unit are 16 and 32 per layer respectively. The total number of strip signals per layer is 32 for both the EI and FI TGC units. A single EI/FI Slave Board takes care of signals from both an EI and an FI doublet.

The EI/FI Slave Board has a very similar structure to the Triplet Slave Board, as shown in Figure 20. The additional functionality of the EI/FI Slave Board that increases the trigger robustness is coincidence logic that provides hit-signals to the Sector Logic Boards. The Slave Board performs the 1-out-of-2 (or optionally 2-out-of-2) coincidence operation. (The relative robustness of the OR and the AND schemes is shown in Section 4.3.2 and the choice is programmable) Since the trigger window size in the EI/FI station is larger than 50 cm (in the bending plane), fine granularityin the provision of hit-signals is not necessary. The segmentation for the EI TGC unit is defined to be two segments in the R-direction and four segments in the \(\phi\)- direction. The FI TGC unit is subdivided into four segments in both the R and \(\phi\)-directions. Each segment provides a hit signal using the coincidence logic shown in Figure 19.

The total number of hit signals sent to the Sector Logic is 336 bits at 40 MHz for each of the two end-caps.

All the functions of the Slave Boards (two doublets, triplet and EI/FI) and the high-\(p_{\mathrm{T}}\) Boards can be incorporated in a single ASIC chip. In the Sector Logic, most functions are implemented in FPGA so that incorporation of the hit signals from the EI/FI station is relatively straightforward. Figure 21, shows details of the revised design of the Sector Logic. Hit signals from the EI/FI station are fed to each matrix element, where \(\delta\)R and \(\delta\phi\) information is combined and a muon track with six levels of \(p_{\mathrm{T}}\) information is defined where can be validated by an EI/FI hit signal. The additional number of input signals to a single Sector Logic Board is estimated to be 28 bits at most. To provide the EI/FI hit signals to the corresponding Sector Logic, additional electronics for signal fan-out and distribution is required.

#### 6.2.3 UseoftheCSCs

Whilst no detailed design work has yet been performed with regard to integrating CSC signals into the end-cap trigger, strategies are being evaluated. As long as signals reach the trigger logic in the same form as those currently expected from the TGCs their use in the trigger is unproblematic. However the large wire pitch of the CSC chambers, and the long shaping time of the CSC front-end electronics make it problematic to assign CSC signals unambiguously to any one Figure20: FunctionalstructureoftheE/FISlaveBoard.

bunch crossing. Additional electronics will be needed to perform this bunch identification, and studies are continuing to determine the optimal way of doing this.

## 7Summaryandconclusions

Studies of the response of the ATLAS Level-1 muon trigger to soft, charged particle backgrounds have led to the design of more robust trigger schemes to ensure that the output rate from the trigger is within the constraints arising from the experiment. In particular the background arising from muons in the cavern of momentum close to 100 MeV has been simulated in detail to estimate the rates expected given various extensions to the original trigger scheme.

The planned improvements to the trigger reduce the rate to an acceptable level, even in the case of very pessimistic assumptions with regard to the level of background. The use of the full, three-station trigger scheme (originally envisaged for use only in the high-\(p_{\mathrm{T}}\) trigger at nominal luminosity) will reduce the rate from the low-\(p_{\mathrm{T}}\) trigger at low luminosity to a level that is quite acceptable in the case of the nominal background level, as predicted by the Monte Carlo program. The incorporation of the full system into the low-\(p_{\mathrm{T}}\) trigger is straightforward, and design work is complete.

In the event that rates are seen to be significantly worse than present predictions, the possibility of using the EI/FI TGC station in the end-cap and the Tile Calorimeter in the barrel provides an extremely robust trigger. Design work on these solutions is advanced, and the logic is being built to receive signals from these additional sources. (However discriminators for the TileCal signals will not be built until it has been confirmed that this particular solution is necessary.) The incorporation of the CSCs into the end-cap trigger to increase robustness at higher \(\eta\) is also under investigation.

The extensions to the trigger scheme have introduced new flexibility to the Level-1 muon trigger. All the improvements discussed are programmable and can be added to or removed from the trigger algorithm as made necessary by running conditions. Whilst the extensions are motivated by a desire to reduce acceptance to the specific background arising from muons of momentum close to 100 MeV, the updated trigger schemes also increase robustness against other sources of backgrounds.

It remains to complete the studies of the FLUKA Monte Carlo program and reduce the uncertainties arising from the track weighting procedure. Additional efforts will be made to use other Monte Carlo programs to check the predictions of FLUKA.

Studies have begun into an optimization of the shielding of the detector that will reduce the flux of soft charged particle backgrounds. Investigations have so far centred on adding tungsten shielding at various locations, and these have demonstrated that neutron fluxes can be reduced in some regions by up to a factor two, though the impact on charged backgrounds has yet to be quantified. These investigations will continue.

## References

* [1]_ATLAS Level-1 Technical Design Report_, CERN/LHCC/98-14, ATLAS TDR 12, 24 June 1998.

* [2] S. Robins, _Level-1 trigger rate from beam halo muons in the end-cap_, ATL-DAQ-98-128 (1998).
* [3] FLUKA A. Ferrari, and P.R.Sala, _Intermediate and High Energy Models in FLUKA: Improvements, Benchmarks and Applications_, Procs., 'International Conference on Nuclear Data for Science and Technology', G. Reffo, A. Ventura and C. Grandi eds., ISBN 88-7794-114-6, Bologna (1997), Part I, p.247. A. Fasso, A. Ferrari, J. Ranft and P.R. Sala, _New developments in FLUKA modelling of hadronic and EM interactions_, Procs., 3rd workshop on 'Simulating Accelerator Radiation Environment', SARE-3, KEK-Tsukuba, May 7-9 1997, H. Hirayama ed., KEK report Proceedings 97-5, p. 32 (1997).
* [4] J. Ranft, _DPMJET version II.3 and II.4: sampling of hadron-hadron, hadron-nucleus and nucleus-nucleus interactions at cosmic ray energies_, according to the Dual Parton Model description of the model and code manual_, INFN-AE-97-45.
* [5] C. Zeitnitz, LA-12835-C (1994) 90.
* [6] A. Fasso, A. Ferrari, J. Ranft, P.R. Sala, G.R. Stevenson and J.M. Zazula, _FLUKA92_, Procs., 'Simulating Accelerator Radiation Environment', SARE, Santa Fe, 11-15 January (1993), A. Palounek ed., Los Alamos LA-12835-C, p. 134 (1994).
* [7] NIM A332, 1993 (459-468).
* [8] NIM A338, 1994 (534-543).
* [9] G. Ciapetti and A. Di Ciaccio, _Monte Carlo simulation of minimum bias events at the LHC energy_, Procs., ECFA Large Hadron Collider Workshop, Aachen, FR Germany; 4-9 Oct 1990, G. Jarlskog and D. Rein eds., Geneva 1990. ECFA 90-133 v2(155-163)
* [10].W.R. Nelson, H. Hirayama and D.W.O. Rogers, Report SLAC-225(1985).
* [11] E. Cuccoli, A.Ferrari and G.C. Panini, Report JEF-DOC-340 (1991).
* [12] J. Rowlands and N. Tubbs, Procs.,. Int. Conf. Nuclear Data for Basic and Applied Science (Santa Fe, 13-17 May 1985) eds. P.G. Young and R.E. Brown.
* [13] M.B. Emmett, Report ORNL-4972 (1975).
* [14] L. Acitelli et al., _Study of the efficiency and time resolution of a RPC irradiated with photons and neutrons_, NIM A360 (1995) 42-47.
* [15] C. Bittari et al., NIM A297, 1990 (250).
* [16] HIZ (O'Neill, 1996), private communication, L.Pinsky, Houston University.
* [17] R. Bellotti et al., Phys. Rev. D53 (1996) 1314.
* [18] O.C.Allkofer et al., Nucl. Phys. B 259 (1985) 1-18.
* [19]_DICE manual_, ATLAS note SOFT-NO-10, 1994.
* ATLAS trigger simulation version 1.00 user's guide._
* Detector description and simulation tool_, CERN Program Library long write-up W5013 (1993).
* [22]_ATLAS Muon Spectrometer Technical Design Report_, CERN/LHCC/98-15, ATLAS TDR 10, 31 May 1997.
* [23] L. Chevalier et al., ATLAS Internal note MUON-NO-148, (1997).

* [24] O. Jinnouchi and O. Sasaki, _Study of the muon Level-1 trigger scheme for TGC_, ATLAS-DAQ-82, (1998).
* [25] A. Nisati, _Preliminary timing studies of the barrel muon-trigger system_, ATLAS-DAQ-83, (1998)
* [26]_ATLAS Tile Calorimeter Technical Design Report_, CERN/LHCC/96-42, ATLAS TDR 3, 15 December 1996
* a preliminary investigation_, ATLAS-DAQ-99-002, (1999)
* [28] Y. Oren and A. Nisati, _Muons from pions and Kaons from Minimum Bias events_, ATLAS-???, 1998.
* [29] A. Ferrari, private communication.