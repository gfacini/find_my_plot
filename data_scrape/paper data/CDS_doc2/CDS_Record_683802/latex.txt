**ATLAS Internal Note**

**4 February 1999**

**Test of the Sliding Window Algorithm for Jets Reconstruction in ATLAS Hadronic Calorimeters**

**R. Mehdiyev \({}^{1}\), Z.Metreveli \({}^{2}\), P.Nevski \({}^{3}\), D.Salihagic \({}^{4}\)**

Joint Institute for Nuclear Research, Dubna

Test of the "sliding window" jet finding algorithm has been performed for reconstruction of back-to-back jets in barrel and end-cap regions of the ATLAS hadronic calorimeters. Fully simulated events have been used for various jet energies and pseudorapidities in \(E_{jet}\)=20 - 2000 GeV and \(\eta\)=0.6 - 3.05 range.

The transverse energy threshold for the jet candidates was found to be the most sensitive parameter of the algorithm. The values of this parameter has been selected to maximize jet reconstruction efficiency in a window of \(.3\times.3\) radians both in pseudorapidity and azimuthal angle. Plots are given to demonstrate the dependence of the optimal transverse energy threshold on the jet total energy, transverse energy and pseudorapidity. It is shown that the 90 - 95% efficiency of a single jet reconstruction is achievable by the proper choice of the transverse energy threshold. For this range of jet energies and pseudorapidities the value of the transverse energy threshold varies between 15 - 35% of the full jet transverse energy.

\({}^{1}\) Institute of Physics, Academy of Sciences, Baku, Azerbaijan

\({}^{2}\) Institute for High Energy Physics of Tbilisi State University, Georgia

\({}^{3}\) Brookhaven National Laboratory, Upton, NY, USA

\({}^{4}\) University of Montenegro, Podgorica, Montenegro

[MISSING_PAGE_EMPTY:2]

Introduction

An efficient jet reconstruction is very important for high multiplicity events at LHC. Many physics scenarios include jets as a result of hadronization processes of outgoing quarks and gluons.

Several jet reconstruction algorithms exist now on the market [1]. Their choice strongly depends on the physics scenario and on the task which certain algorithm is going to cope with. This note serves as a description of the sliding window algorithm, which can be used for jet finding and measuring jet characteristics in high luminosity environment at the LHC.

## 2 Algorithm Description

Sliding window algorithm for jet (cluster) reconstruction uses local maxima of transverse energy summed up in a selected window as seeds (\(pre-jets\)) for jets or clusters.

It is implemented in ATRECON - the ATLAS reconstruction framework [2]. In this framework data objects, internally maintained by ZEBRA[3] as data banks in a dynamic memory, are accessed from the code via REBANK [4] interface. The \(STRUCTURE\) operator, introduced in DICE95 version [5], creates a set of local variables to access banks using DICE95 operators - \(FILL\) and/or \(USE\).

The whole ATLAS calorimeter reconstruction proceeds via the construction of so-called combined calorimeter energy matrix, which is a sum of individual matrices for each homogeneous ( in terms of \(\eta-\phi\) granularity ) calorimeter regions.

As the first step within the ATRECON package, HCALREC steering module fills EPAR(2) and COMB banks with default value of parameters for the hadronic calorimeter reconstruction code.

The list of parameters in the EPAR(2) structure includes 1.

Footnote 1: All parameters in the EPAR(2) structure can be redefined in USE operators by userâ€™s datacards or kuip commands

* the reconstruction limits for pseudorapidity (_etamin, etamax_),
* _kcomb_ (D=4), which determines the size in \(\eta\) and \(\phi\) of combined matrix in cells of the electromagnetic calorimeter 2, Footnote 2: default value corresponds to the Tile calorimeter granularity (0.1x0.1)
* default local working matrix size _window_ (D=0.4),
* pre-jet window size coefficient _id0_ (D=1),
* pre-jet transverse energy threshold _thr_ (D=2 GeV).
* angular sizes of isolation cones _Radii_

The COMB structure contains calculated matrix parameters, such as the \(\eta\) and \(\phi\) granularity of combined matrix in angular units and the computed number of "elementary" cells in \(\eta\) and \(\phi\).

With reconstruction parameters defined, the HCALREC module calls the CALO-COMB routine, which fills the combined transverse energy matrix in \(\eta-\phi\) space with the required granularity, by putting a corrected for sampling fraction part of the energy of actual calorimeter cells.

Then HCALREC module calls the CALOCAND routine - sliding window algorithm itself for the jet finding. This algorithm makes a scan of the combined matrix \(\eta-\phi\) with the selected pre-window 3.

Footnote 3: \(3\times 3\) for the default value of _id0_=1, or \(5\times 5\) for _id0_=2.

Algorithm gradually moves ( slides ) in \(\eta\) and \(\phi\) to find the local maxima of the transverse energy, summed up in the pre-window, with a value above the required threshold ( _thr_ in EPAR(2) bank). Those maxima are considered as jet candidates positions, using which the CALOCLUS routine calculates the precise jet direction and energy, this time from full window or cone size.

The algorithm makes one scan over the matrix and finds all jet candidates, unlike some other algorithms (for example well known cone-size algorithms), which scan the cell matrix for one jet candidate, then switches off cells belonging to this candidate and then repeat the search again and again.

Because same cells may contribute to more then one jet, an additional filtering procedure is applied. If the minimal distance between a new jet and the other previously found jets is more than _separ_4 multiplied by the sum of the rms widths of energy distribution for both jets, the new jet is accepted. If the separation is not enough and the energy of the new jet is greater than the energy of the closest one, the new jet replaces the old one, otherwise it is dropped.

Footnote 4: default value is \(separ=1\) in EPAR(2) parameter bank

In addition, if the distance between the jet direction and its maximum energy cell is more than twice the r.m.s. width of the energy deposition calculated from full window, one more iteration is performed with an increased window size. If the jet direction after the second iteration changes significantly, the jet is also dropped.

Finally, for every found jet, the CALOCONE subroutine calculates and saves in JETS bank surrounding energy in a set of cones with radii (R=\(\sqrt{\delta\eta^{2}+\delta\phi^{2}}\)=0.3, 0.4,...). around the jet axis. Those energies can later be used for isolation cuts.

## 3 Data Sets for Algorithm Test

The following Monte Carlo simulations have been used for algorithm application and test.

Events with \(d\overline{d}\) quarks originating back-to-back jets were generated using PYTHIA 5.7/JETSET 7.4 programs in the framework of ATGEN 2.0 [6]. In order to get the correct efficiency normalization, jets were produced with fixed energies and fixed values of pseudorapidity. The initial - and final - state radiation were switched off to have only parton jets.

Generation were done for pseudorapidity values \(\eta\)=0.6 (barrel region), 1.85, 2.15, 2.45, 2.75, 3.05 (end-cap region). At each \(\eta\) point jets of following energies were produced: 20, 50, 100, 200, 300 GeV for \(\eta\)=0.6 and 100, 200, 500, 1000 and 2000 GeV for the remaining \(\eta\) points. 250 events were generated for every energy/\(\eta\) point, which gives 500 jets per point. It should be noted that for \(\eta\)=0.6 point a different procedure for jets generation has been used - jets were produced in only one hemisphere and and not uniformly in \(\phi\).

The detector response to the final state particles from jets was simulated using the standard ATLAS software (DICE 3.1/SLUG 1.2) and GEANT 3.21 [5, 8, 9]. For this study information from all calorimeters was stored on output. The magnetic field inside calorimeters was switched on. GCALOR transport code[7] was used for hadronic shower development.

Energy reconstruction in the ATLAS calorimeters ( including hadronic ones ) was done by using so-called electromagnetic calibration. For each homogeneous calorimeter region (in the terms of \(\eta-\phi\) granularity) the calibration parameters are determined to reproduce the energy of electrons. However the ATLAS hadronic calorimeters are non-compensated, i.e. their response to hadrons differs from the response to electrons of the same energy ( \(e/\pi\neq 1\) ). Therefor an additional so-called "software" calibration is needed to correctly reconstruct the jet energy. Standard weighting technique has been used to obtain those calibration parameters.

The reconstructed jet energy in the \(i^{th}\) event is defined as

\[E_{i} = \sum_{j=1}^{M}C_{j}E_{ij} \tag{1}\]

where \(E_{ij}\) is the energy ("electromagnetically" calibrated) in the \(j^{th}\) part of the calorimeter in the \(i^{th}\) event, \(C_{j}\) are the jet calibration parameters and M is the number of segments of calorimeters with different calibration parameters. The parameters \(C_{j}\) are determined by minimizing of the following functional

\[F = \sum_{i=1}^{n}(E_{i}-E_{0i})^{2} \tag{2}\]

where \(E_{0i}\) is the initial energy in the \(i^{th}\) event and N is the number of events [10, 11].

The distributions of the total energy, reconstructed with this calibration procedure, are shown on Fig.1 for \(\eta\)=2.45. It shows that the additional "software" calibration significantly improves the jet energy resolution. The same distributions for other \(\eta\) bins are similar to the shown one.

## 4 Results and Discussion

Pre-jet window size \(3\times 3\) has been used for algorithm test. Fig.2 shows the distributions of the number of reconstructed jets for different values of \(E_{t}^{thr}\) for \(E_{jet}\)=500 GeV and \(\eta\)=2.45. One can see the sensitivity of the reconstruction efficiency to the \(E_{t}^{thr}\) parameter. Here the reconstruction efficiency is the ratio of the number of reconstructed jets to the original number of jets in the event. The fact that the fraction of events have more than two jets reconstructed shows that sometimes the algorithm tries to reconstruct the same jet twice. Double counting problem of reconstructed jets is important for small (less then 15% from full jet transverse energy) values of \(E_{t}^{thr}\) parameter. This could be partially avoided by choice of this parameter at the level of \(\sim\)26% of \(E_{t}\) for given values of \(E_{jet}\) and \(\eta\). For this case (see Fig.4**(a)**) \(\sim\)90% efficiency of jet reconstruction is achievable (original number of jet pairs in event is 250).

In Fig.3 dependence of the reconstruction efficiency on \(E_{t}^{thr}/E_{t}\) is plotted for different values of jet energy (Fig.3**(a)**, **(b)**,**(c)**,**(d)**,**(e)**) and for one value of \(\eta\)=2.45. Approximation of the distributions by linear form has been done. Results of approximation are presented by solid lines. The value of \(E_{t}^{thr}\) corresponding to the crossing point of the approximation line with efficiency=1 is taken as more appropriate, i.e. corresponding to maximum efficiency. Fig.3**(f)** shows dependence of \(E_{t}^{thr}/E_{t}\) for maximum efficiency on \(E_{jet}\) for the same \(\eta\) value. One can see that with increase of \(E_{jet}\) from 100 to 2000 GeV for given \(\eta\)=2.45, ratio \(E_{t}^{thr}/E_{t}\)(eff=max) increases from 0.17 to 0.32.

It should be noted that change of pre-jet window size to \(5\times 5\) leads to bigger \(E_{t}^{thr}\) values, but the overall tendency is preserved.

Ability of the algorithm to reconstruct the jet direction is plotted in Fig.4**(b),(c)**, where the corresponding distributions of \(\eta\) and \(\phi\) for reconstructed jets are presented for a obtained value of \(E_{t}^{thr}\) (\(E_{jet}\)=500 GeV, \(\eta\)=2.45). Curves on Fig.4**(b)** are result of shape approximation by Gaussian form. The mean values of reconstructed \(\eta\) are plotted on the top of figure. As could be seen, the jets direction reconstructed rather well.

Dependence of the quality of energy reconstruction on the cone size with energy collected within is presented in Fig.5. Reconstructed energy distributions, collected in cone size \(R_{cone}\)=0.4 (Fig.5**(a)**) and \(R_{cone}\)=0.7 (Fig.5**(b)**) are shown for initial \(E_{jet}\)=500 GeV and \(\eta\)=2.45. Results of Gaussian form approximation are drawn by solid curves. The mean values of reconstructed energy are presented also. The tails on the left hand side of the distributions are appear due to restricted cone size (0.4 or 0.7), i.e. cone collects only certain fraction of reconstructed jet energy. Tails are gradually disappear with the increase of the cone size.

Fig.5**(c),(d)** shows distribution of collected energies in \(R_{cone}\)=0.4 and \(R_{cone}\)=0.7 for generated events by ATGEN (before full simulation). One can conclude that the energy reconstruction for jets is satisfactory (cf. Fig.5**(a),(b)** and Fig.5**(a),(b)**).

Fraction (in percent) of reconstructed energy collected in \(R_{cone}\)=0.4 and \(R_{cone}\)=0.7 for different \(E_{jet}\) and \(\eta\) are presented in Fig.6. It is clear that with increase of initial jet energy the jets become narrow and fraction of reconstructed energy for \(R_{cone}=0.7\) from \(\sim\)80% (\(E_{jet}\)=100 GeV) increase to \(\sim\)95% (\(E_{jet}\)=2000 GeV).

In Fig.7 and 8 the values \(E_{t}^{thr}\) for maximum jet reconstruction efficiency versus jet total energy (Fig.7**(a)**), jet transverse energy (Fig.7**(b)**) and emittance pseudorapidity (Fig.8) are plotted. For the considered interval of jet total energy and pseudorapidity (\(E_{jet}\)=20-2000 and \(\eta\)=0.6-3.05) the value of transverse energy threshold parameter varies between 15-35% of full jet transverse energy.

This plots (Fig.7,8) could serve as a clue to define what parameter value in sliding window algorithm corresponds to maximum efficiency for well separated jets reconstruction for certain physical tasks.

More stringent test of algorithm could be in use for double jet reconstruction ( i.e. close jets ) for physics processes like W mass reconstruction in W\(\rightarrow\)2 jets channel... These tests will be done when a bulk of fully simulated data of appropriate processes for Physical TDR needs will be available.

## 5 Summary

Test of sliding window jet finding algorithm has been performed for back-to-back jets reconstruction in barrel and end-cap region of ATLAS hadronic calorimeters.

Window size of \(3\times 3\) has been used for jet finding. The value of transverse energy threshold for the observed jet candidate is the most sensitive parameter of the algorithm.

The plots for dependence of transverse energy threshold for maximum efficiency of jets reconstruction on jet total energy, jet transverse energy and pseudorapidity are given. The value of transverse energy threshold varies between 15-35% of full transverse energy for considered interval of jets energy and pseudorapidity (\(E_{jet}\)=20-2000 GeV, \(\eta\)=0.6-3.05). Efficiency of single jet reconstruction \(\sim\)90-95% is achievable by selecting a proper value for transverse energy threshold. The fraction of reconstructed jet energy is \(\sim\)80-95% for cone size R=0.7 in the considered \(E_{jet}\)-\(\eta\) interval.

## 6 Acknowledgment

We would like to thank M.Bosman, F.Gianotti, A.Kiryunin and A.Solodkov for a valuable discussions during this study.

## References

* [1] M.Bosman et al., "Jet-finder library", ATL-SOFT-98-038
* [2] draft ATLAS ATRECON manual, Atlas Internal Note ATL-SOFT-96-033
* [3] Zebra System, CERN program Library Q100/Q101, Geneva 1993.
* [4] M.Nessi, P.Nevski, G.Poulard, ATLAS reconstruction banks. ATLAS internal note ATL-SOFT-94-003
* [5] A.Artamonov et al.,DICE-95, Atlas Internal Note ATL-SOFT-95-0.14
* [6] A.Amorim, ATGEN 2.0, Atlas Internal Note ATL-SOFT-96-033
* [7] T.A. Gabriel and C.Zeitnitz, Nucl.Instr.and Meth.A 349 (1994) p.106; T.A.Gabriel and C.Zeitnitz, The GEANT-CALOR interface user's guide, unpublished (1994)
* SLUG Interface to GEANT, ATL-SOFT-93-012
* [9] R.Brun et al., GEANT3, CERN DD/EE/84-1 (1986)
* [10] ATLAS Collaboration, "ATLAS Calorimeter Performance. Technical Design Report", CERN/LHCC/96-40, ATLAS TDR1(1996)
* [11] A.Kiryunin et al., "Jet Energy Measurements in the End-Cap Region", ATLAS-HEC-98-047