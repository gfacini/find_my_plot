**ATLAS Internal Note**

**MUON-NO-051**

**8 September 1994**

Application of deformable templates for

recognizing of tracks detected by high pressure

drift tubes.

S. Baginyan, S. Baranov, A. Glazov, G. Ososkov

Dubna JINR

[MISSING_PAGE_EMPTY:2]

Introduction

The experience of Artificial Neural Network (ANN) applications shows their efficiency for solving of various optimization and recognition problems. ANN are, in particular, used for track finding in experiments with elementary particle physics [2, 3, 4, 5].

Special efforts were made to overcome difficulties caused by the presence of background and noise points that leads to considerable worsening of the accuracy of the statistical characteristics of track parameters. These efforts were carried out on different ways. The cellular automaton was designed especially for preliminary data filtering to speed up the Hopfield ANN evolution on the rest of data [6]. In [7] the modified rotor ANN searches for track points avoiding background points due to a carefully elaborated initial configuration of rotors and robust synaptic weights.

One should realize, however, that in the applications listed above ANN's were used for the recognition of track points only. The explicit estimation of track parameter that is, in fact, the aim of physicists is usually to be done on the next step of data handling procedure by one of the robust version of the least square methods (LSM) (see for example [9, 10]).

Therefore the deformable template approach [11] (called also the elastic arm method) looks quite promising, since it combines both the ANN evolution and the robust LSM for explicit estimation of the track parameters.

In the given paper we propose our modification of the defomable template method (DTM) application to the problem of track finding and track parameter determination for data detected by high pressure drift tubes (HPDT) in the design of the ATLAS for the muon spectrometer experiment [1].

Our DTM applications consist on two parts, according with two stages of the study.

The first part related to the stage of HPDT study on the CERN muon beam (BEAM-TEST, 1992-1993 [1]) with the simplest one-prong events without noise signals, when the main obstacle is the left-right ambiguities for each tube. At the second part more complicate HPDT data are to be handled with noise signals and the arbitrary angle between track and \(Z-\) axis. It was shown that suggested DTM development solve the problem of track recognition and track parameter determination for both noiseless and noise data. Results are obtained on the real beam test data and on data simulating the muon spectrometer on the basis of HPDT.

## 2 Problem formulation.

The HPDT spectrometer consists on modules with two superlayers each. The superlayer (see fig. 1 and [1]) formed by three layers of HPDT's arranged in honeycomb order. All tubes have the same radius R (15mm). In the middle of every tube there is the anode wire with known \(ZX-\)coordinates. Any track passing solution of the normal system of the linear equations produced by differentiating of \(L_{1}\) by these two parameters.

In the case of non-fixed \(S_{i}\) the minimization of \(L_{1}\) is fulfilled by our modification of deformable templates. It'll be described later, since \(L_{1}\) minimizing is the partcular case of more general problem considered on the next stage of study.

On the second stage of our study we have to solve the analogous problem, but for tracks going under an arbitrary angle to axis \(Z\) and in the presence of noise signals.

The latter circumstance leads to serious difficulty in HPDT data processing, which was not surmounted, for instance, in [8]. Noise measurements are not included also in the functional (1).

Let us include nose signals in our formalism. Whenever the \(i-th\) tube produces the signal measured as \(R_{i}\), we attribute it to a nose measurement, if the following condition holds:

\[\frac{(D_{i}(a,b)-R_{i})^{2}}{\sigma_{i}^{2}}>\lambda. \tag{3}\]

Here \(a,b\) are parameters of the true track and \(\lambda\) is the constant (we state it by \(\sqrt{\lambda}=3.5\), which corresponds to the 99.9% -- confidential level under the assumption of the \(R_{i}\) normality with the standart deviation \(\sigma_{i}\)).

The variable \(S_{i}=\pm 1\) in \(L_{1}\) points out how the given track is situated (upward-downward) relatively to the tube center. It would be quite reasonable to supplement this variable by a special state for cases of the noise measurements.

At this point of our consideration the conception of neuron is needed (in fact, there is the close connection between neural networks and deformable templates [10, 11]).

We define the neuron as two-dimensional vector \(\vec{S}_{i}=(S_{i}^{+},S_{i}^{-})\)

with values \((1,0),(0,1),(0,0)\) corresponding to three situations:

* track goes upward to the \(i-th\) tube center;
* track goes downward to the \(i-th\) tube center;
* \(R_{i}\) measurement is noise, i. e. (3) holds.

Now we can generalize the functional \(L\) for cases of noise signals in the following expression:

\[L=\sum_{i=1}^{N}\left\{\frac{(D_{i}(a,b)-R_{i})^{2}}{\sigma_{i}^{2}}S_{i}^{-}+ \frac{(D_{i}(a,b)+R_{i})^{2}}{\sigma_{i}^{2}}S_{i}^{+}\right\}+\lambda\sum_{i =1}^{N}((S_{i}^{+}+S_{i}^{-})-1)^{2}. \tag{4}\]

Thus the problem of the full track recognition, i. e. all track points finding and track parameter estimating, is reduced to minimizing the functional \(L\) with the following constraint for the vectors \(\vec{S}_{i}\) :\[S_{i}^{+}+S_{i}^{-}\leq 1 \tag{5}\]

One can see, that both functionals( 1) and( 4) have a form similar to the method of deformable templates [10, 11]. So we can apply the minimizing procedure developed for it, so-called EM-method. It consists of the following steps:

1. Find initial approximation for \(a,b,\{\vec{S}_{i}\}\)
2. Iterate through: 1. Given \(a,b\), find \(\vec{S}_{i}\) in each tube: \(\vec{S}_{i}^{n+1}=S(a,b,\vec{S}_{i}^{n})\) 2. From given \(S_{i}\) find \(a^{n+1},b^{n+1}\)
3. Stop, if the minimum has been achieved, i. e. \(\vec{S}_{i}^{n+1}=\vec{S}_{i}^{n}\), \(|a^{n+1}-a^{n}|<\Delta_{astop}\), \(|b^{n+1}-b^{n}|<\Delta_{bestop}\)

The possible version of the renewing procedure for vectors \(\vec{S}_{i}\) in the iteration process could be based of the stepwise function \(S(\{\vec{S}_{i}\},a,b)\) of the argument \(sign(D_{i}(a,b))\). However this procedure has such the essencial disadvantage that with the big probability the functional \(L\) could fall into one of its local minima.

Between various tricks to avoid sticking to local minima one can try to use combinatorics to search for the best initial approximation (see step 1 above). However, just in our case of false HPDT signals and the great level of noise this way is not effective.

We choose the way recommended by the deformable template theory [10] to replace the stepwise function \(S(\{\vec{S}_{i}\},a,b)\) by a sigmoid function. According to this method, we suppose that our system is situated in thermostat with the temperature \(T\), so the probability to have parameters \(\{\vec{S}_{i}\},a,b\) is given by canonical Gibbs distribution:

\[P[\{\vec{S}_{i}\},a,b]=\frac{1}{H}e^{-\frac{L(\{S_{i}\},a,b)}{T}}, \tag{6}\]

where

\[H=\sum_{\{\vec{S}_{i}\},a,b}P[\{\vec{S}_{i}\},a,b].\]

Let us denote:

\[\frac{(D_{i}(a,b)-R_{i})^{2}}{\sigma_{i}^{2}}=d_{i}^{-}\quad,\frac{(D_{i}(a,b) +R_{i})^{2}}{\sigma_{i}^{2}}=d_{i}^{+}.\]

Then, we should calculate the marginal probability distribution

\(P_{m}[a,b]=\sum_{\{\vec{S}_{i}\}}P[\{\vec{S}_{i}\},a,b]\). This gives:

\[P_{m}[a,b]=\frac{1}{H}\sum_{\{\vec{S}_{i}\}}e^{-\frac{1}{T}L}\quad=\quad\frac {1}{H}\sum_{\{\vec{S}_{i}\}}\prod_{i}e^{-\frac{1}{T}\left(d_{i}^{-}S_{i}^{-}+ d_{i}^{+}S_{i}^{+}+\lambda((S_{i}^{+}+S_{i}^{-})-1)^{2}\right)}=\]\[=\frac{1}{H}\prod_{i}\left\{e^{-\frac{\lambda}{T}}+e^{-\frac{d_{i}^{-}}{T}}+e^{- \frac{d_{i}^{+}}{T}}\right\}\quad=\quad\frac{1}{H}e^{-\frac{1}{T}E_{eff}},\]

here

\[E_{eff}=-T\sum_{i}\log\left(e^{-\frac{\lambda}{T}}+e^{-\frac{d_{i}^{-}}{T}}+e^{ -\frac{d_{i}^{+}}{T}}\right).\]

Let's find derivations of \(E_{eff}\) with respect to parameters \(a,b\). We denote as \(x\) any of \(a,b\). Then

\[\frac{\partial E_{eff}}{\partial x}=\sum_{i}\frac{e^{-\frac{d_{i}^{-}}{T}} \frac{\partial d_{i}^{-}}{\partial x}+e^{-\frac{d_{i}^{+}}{T}}\frac{\partial d _{i}^{+}}{\partial x}}{e^{-\frac{\lambda}{T}}+e^{-\frac{d_{i}^{-}}{T}}+e^{- \frac{d_{i}^{+}}{T}}}. \tag{7}\]

Comparing with

\[\frac{\partial L}{\partial x}=\sum_{i}S_{i}^{-}\frac{\partial d_{i}^{-}}{ \partial x}+S_{i}^{+}\frac{\partial d_{i}^{-}}{\partial x} \tag{8}\]

we obtain the procedure of parameter \(\{\vec{S}_{i}\}\) renewing on the next step of iteration as follows:

\[S_{i}^{-}=\frac{1}{1+e^{\frac{d_{i}^{-}-\lambda}{T}}+e^{\frac{d_{i}^{-}-d_{i }^{+}}{T}}} \tag{9}\]

\[S_{i}^{+}=\frac{1}{1+e^{\frac{d_{i}^{+}-\lambda}{T}}+e^{\frac{d_{i}^{+}-d_{i }^{-}}{T}}} \tag{10}\]

From (9-10) one can see the sigmoid shape of the function \(S(\{\vec{S}_{i}\},a,b)\). As higher the temperature \(T\), as large uncertainty of the track passage in respect the \(i-th\) tube (i. e. \(S_{i}^{+}\approx S_{i}^{-}\)), but if the temperature \(T\) is small, one has \(S_{i}^{+}\approx 1\), a \(S_{i}^{+}\approx 0\), or vice versa. Thus, decreasing sequentially the temperature (so-called "simulated annealing" procedure, see, for example, [12]) one case force the functional \(L\) to approach to its global minimum in the iterational process.

## 3 Algorithm implementation.

### Problem linerization.

It is obvious that in the case of the arbitrary track slope to \(Z-\)axis the value \(a^{2}\) in (2) is no more negligible and the problem of \(L\) minimization is not linear. However we find a way to obtain the new values of parameters \((a,b)\) on the second step of EM-method by solving the equation system linear in respect to \(a,b\).

The idea is the following: use the _a priori_ information about centers of all tubes on order to fit a straight line to centers of these tubes, producing signals. The parameters \(a,b\) of this line remain fixed during the given step of \(T\) of simulatedannealing iteration while the increments \(\Delta a,\Delta b\) are treated as fitted variables. The formula (2) changes as: \[D_{i}(a,b)=\frac{X_{i}-(a+\Delta a)Z_{i}-(b+\Delta b}{\sqrt{(a+\Delta a)^{2}+1}},\] (11) It seems there is the non-linearity due to \(\Delta a\) in the denominator. However, the ratio \(((a+\Delta a)^{2}+1)/(a^{2}+1)=1+\Delta a(2a+\Delta a)/(a^{2}+1)\) tends to \(1\) for vanishing \(\Delta a\) (see also the distribution of \(\Delta a(2a+\Delta a)/(a^{2}+1)\) denoted as \(\Delta a/A\) in fig. 2 for the set of modelled events). Therefore, we can neglect by \(\Delta a\) in the denominator of (11).

### The algorithm of the global minimum search.

The global minimum search of the functional \(L\) is implemented in three steps.

Step 1. The iterational process of EM-method is going on with the big temperature and the big value of the constant \(\lambda\) in the noise criterium (3).

Step 2. The straight line is refitted with the starting values obtained on the step 1. The temperature \(T\) and the noise cut-off both are decreased and EM-iterations are repeated till the convergence or exhausting of the iteration limit.

Step 3. Analogous refitting with the temperature closed to zero and \(\sqrt{\lambda}=3.5\).

At the end of every step the minimum value of the functional \(L\) with fitted parameters \(\{\vec{S}_{i}\},a,b\) is calculated and compared with \(L_{cut}\). The cut-off \(L_{cut}\) was calculated in advance from the distribution of \(L\) for simulated events. As soon, as \(L<L_{cut}\) on some step we finish the whole procedure considering the given event (a track) as the recognized one. Otherwise we go to the next step.

There is no guarantee that the algorithm described above must definitely find the global minimum of the functional \(L_{2}\). The efficiency of our algorithm varies between 75% and 85% on different series of event simulated by the program GEANT [13].

To increase the efficiency of our algorithm it was completed by auxillary heuristic procedures elaborated after the careful study of many various situations of mutual dispositions of useful and noise signals in real and simulated events.

* The very reliable is the method of sequential rejecting (MSR) of every measurement \(R_{i}\) from the full set of \(\{R_{i}\}\) assuming \(R_{i}\) to be a noise whenever such assumption is attaiable (senseless to reject the only measurement in one of superlayers). In a case of the true assumption MSR gives the considerable decrease of the \(L-\)minimum. However the MSR is too time-consumable, so we apply it in our algorithm not at the beginning, but only when two following heuristic failed.
* Between different reasons of \(L>L_{cut}\) one appears often, when the starting line was fitted wrongly due to the presence in one of superlayer of an outlier,i. e. the noise tube situated far from the true track position (see fig. 8). Our trick is to split the \(ZX-\)plane into two semiplanes by this starting line and to apply our iterations to both semiplanes separately.
* If in both semiplanes one obtains \(L>L_{cut}\) again, we repeat the EM-iterations, but with the starting line previously changed. Namely, we attempt to apply small parallel shifts by changing the parameter \(b:b\pm b_{tol}\) or, if necessary, small variations of the parameter \(a:a\pm a_{tol}\). Constant \(a_{tol},b_{tol}\) were found experimentaly.

## 4 Results.

The solution of the beam track reconstruction in frames of the BEAM TEST methodical experiment was very succesful (100% efficiency) and allowed to determine the space resolution of HPDT and to study the possibilities of the accurate reconstruction of all anode wire positions.

The fortran program implemented our algorithm for minimizing the functional (4) was tested on different series of events simulated by the famous program GEANT [13]. Programm was writen in frames of the CERN management system CMZ [14]. The distribution of data processing time for one event (VAX-8350 computer) is given in fig. 10. The number of events in each seria varied from 2 to 14 thousands. The efficiency of correctly recognized events after applying the heuristics listed above was kept in the satisfactory range 96%-99%.

From the physicist point of view the most important track parameter is the absolute term \(b\). The distribution of the difference of the true and estimated value of \(b\) is shown in fig. 5.

The distribution of such values of \(\{\vec{S}_{i}\}\) that correspond to true measurements are demonstrated in fig. 3. As one can see, the number of the true measurements qualified by our program as false ones is very small. However, as it's seen from fig. 4, where the analogous distribution for the noise measurement is shown, our algorithm cannot supress all noise.

Examples of the succesful recognition by our algorithms are given in fig. 6, 7. The event presented in fig. 6 consists on four true measurements and three noise ones. The event of fig. 7 contains five true measurements and also three noise measurements.

Two examples of events that our algorithm couldn't crunch are demonstrated in fig. 8, 9. Real simulated tracks are denoted by continuous lines, tracks recognized by our programm are denoted by dotted lines. On the event in fig. 8 from 7 measurements four belong to noise, so the probability of the correct recognition is vanishing. The event in fig. 9 shows the configuration of measurements with the maximum uncertainty. To handle such events our algorithm should be completed by a special auxiliary procedure (what we are going to do).

This work was completed due to the support of the Russian Foundation for Fundamental Research.

## References

* [1] ATLAS Internal Note. MUON-NO-029. 28 October 1993.
* [2] C. Peterson and B. Soderberg, A New Method for Mapping Optimization Problems onto Neural Networks, IJNS 1,3 (1989).
* [3] C. Peterson, Neural Networks and High Energy Physics, Lund preprint LU TP 90-6.
* [4] L. Gislen et al., Rotor Neurons -- Basic Formalism and Dinamics, LU TP 91-21
* [5] G. Stimpfi-Abele and L. Carrido, "Fast Track Finding with Neural Nets", UAB-LFAE 90-06 (1990).
* [6] A. Glazov, I. Kisel, E. Konotopskaya, G. Ososkov, Filtering tracks in discrete detectors using a cellular automaton. Nucl. Instr. and Meth. A329 (1993) 262-268.
* [7] S. Baginyan, A. Glazov, I. Kisel, E. Konotopskaya,V. Neskoromnyi, G. Ososkov, _Tracking by modified rotor model of neural network_. Comp. Phys. Commun., 79 (1994) 165-178.
* [8] V. Kotov et al., JINR Commun. E10-93-86, Dubna, 1993.
* [9] G. Ososkov, Proc. 2d Intern. Tampere Conf. in Statistics., Tampere Univ. Press (1987), 615.
* [10] A. Yuille et. al., "Robust Statistics, Transparency and Correspondence", Harvard Robotics Laboratory Technical Report no. 90-7.
* The Elastic Arms Approach", LU TP 91-27.
* [12] M. B. Kiesel et. al., "UAI, T. 24 (1993) b. 6, 1551-1595.
* [13] GEANT User's Guide (DD/EE/84-1)
* [14] A Source Code Management System CMZ. User's Guide and Reference Manual.

Figure 1.

Figure 2.

Figure 3. Figure 4.

Figure 5.

Figure 6, 7.

Figure 8, 9.

Figure 10.