DAQ-NO-074

HD-IHEP 97-09

September 1997

Results of a Fast Simulation of the

\(\mbox{E}_{T}^{miss}\) Trigger of ATLAS

Martin Wunsch

Institut fur Hochenergiephysik, Universitat Heidelberg,

Schroderstrasse 90, D-69120 Heidelberg, Germany

September 19, 1997

**Description of the ATLAS \(E_{T}^{miss}\) Trigger**

on the electron/photon and jet triggers, allowing then to set up a complete trigger menu. Such a trigger menu is needed when studying events triggered exclusively by an \(E_{T}^{miss}\) trigger.

### Requirements to Search for Missing Energies

A real \(E_{T}^{miss}\) is due to particles not giving any signal in neither the calorimeters nor in the tracking devices. This signature can be faked by particles traversing insensitive areas of the detector or fluctuations in the shower development or detector noise or pile-up effects. Hence \(E_{T}^{miss}\) requires to detect as much particles as possible which have to be measured precisely in an as clean as possible environment.

In this note a fast simulation of the level-1 trigger chain is described. It covers the most important aspects of the signal handling within the level-1 chain. Because being sensitive to noise and pile-up simulation must foot on as realistic as possible input parameters.

Those parameters have been partially extracted directly from test beam measurements [1, 2] using electron, muon and pion beams of different energies (electrons of 20, 40, 60, 80, 120, 200 GeV, muons of 120 GeV and pions of 200 GeV). Although not directly related to an \(E_{T}^{miss}\) trigger, results on single particles are of great importance, because the calculation of the missing transverse energy foots on the summation of all energy deposits seen in the detector. In fig. 1 the shaped and digitized data of electrons (E = 80 GeV) were added up in each time slice of 25 ns, corresponding to the bunch crossing frequency in the LHC machine.

The characteristic response of the shaper, namely negative undershoot, is clearly visible. As it will be shown the negative undershoot plays an important role in the analysis of simulated events. Also from these test beam measurements the energy resolution of single electrons has been extracted. The results as a function of the beam energy are summarized in table 1 and are shown to demonstrate how the trigger system will respond in a LHC environment. Similar results have been obtained by the RD27 collaboration [3]. These results have to be confronted to those of the simulation.

Two other examples of such measurements are shown in fig. 2 and fig. 3. In fig. 2 the energy seen by the trigger digitization system (FADCs) system are compared to those obtained by the energies after reconstruction. The obvious correlation already shows that non-linearities are small, details of the analysis are found in ref. [1, 2]. In fig. 3 the energy resolution of single electrons is shown as function of the area in which the energies are summed up. The best resolution is obtained by adding up the energy deposits of two cells with one cell extending over \(\Delta\eta\Delta\phi=0.1\cdot 0.1\).

## 2 Signal Handling

At level-1 only calorimeter objects measured in the electromagnetic and in the hadronic calorimeter within the restricted \(\eta\) range of \([-5;5]\) are input for the \(E_{T}^{miss}\) trigger. Jets and electrons are only triggered on within a region of \([-3.2;3.2]\). The basic trigger cell size is \(\Delta\eta\Delta\phi=0.1\cdot 0.1\). The fast simulation includes electronic noise, pile-up contributions of multiple interactions within one bunch crossing as well as due to previous interactions (signal history), shaping and resolution effects due to the finite FADC measurement range and due to the coarse granularity. These different components will be described in some detail now.

### Electronic Noise

The electronic noise for the basic trigger cells is expected to be in the order of a few hundred MeV. In the current simulation the noise is assumed to be 400 MeV independent of the calorimeter type. The energy deposit is smeared following a Gaussian distribution. Similar numbers have been found in test beam results and will be adjusted according to new measurements whenever available.

Figure 1: Shaped and digitized data of electrons

Figure 3: The energy resolution as a function of the trigger cell size. With the nominal cell size of \(2\times 1\) an optimum resolution is reached.

Figure 2: The correlation between the energy seen by the FADC system and the energy in the calorimeter.

### Pile-up Contribution

Pile-up effects due to multiple interactions within one bunch crossing are crucial in the case of \(E_{T}^{miss}\) triggers because summing must be performed over large detector areas. In the simulation the following method has been adopted: Minimum bias events are tracked through the full detector simulation program. Energy depositions in individual trigger cells are added up according to a Poisson distribution with a mean multiplicity of 25 events, corresponding to the highest luminosities within reach of the LHC machine. The energies released in these events are summed up to form trigger towers of \(\Delta\eta\Delta\phi=0.1\cdot 0.1\). 4096 single cell energies in the ECAL and the same number for the HCAL are then written to a separate file in order not to repeat for every event this time consuming procedure. Afterwards these pseudo-events are read back and can be used in the further analysis.

### Energy Summation

In the first step of the signal handling of an event of interest the energies of this event and the pile-up pseudo-events are summed up laterally and longitudinally to form trigger towers of \(\Delta\eta\Delta\phi=0.1\cdot 0.1\), the basic trigger cell structure. The summing is assumed to be analogue. These sums are then input into the level-1 digitization chain. In the simulation it is assumed that there are no differences in the signal shape neither in the lateral nor the longitudinal segmentation of the calorimeters, and that the relative timing is adjusted. Whenever special characteristics will be chosen they are easily to incorporate.

### Signal History and Signal Shaping

An effect which influences the measurement of \(E_{T}^{miss}\) is a result of the fact that the signals extend over several bunch-crossings. Therefore the influence of the energy depositions of previous events to the event of interest occuring at a time \(T=BX_{0}\) must be taken into account. In the simulation the single cell energies are traced back 25 bunch-crossings. After adding up the energies \(E_{T}\) of the event and the contribution of pile-up, shaping is applied with a characteristic shaping function of which an example is shown in figure 1. The positive part of the signal extends over a few bunch-crossings followed by a negative undershoot which extends over 20 bunch-crossings. The contributions of events earlier in time are added up resulting in a effective energy E\({}_{eff}(\Gamma)\) for a given bunch-crossing T=BX:

\[E_{eff}(T=BX)=\sum_{t=BX\to 25}^{t=BX}E_{T}(t)\cdot f_{sh\,ape}(t)\]

This procedure is repeated for every bunch-crossing including at least the expected occurrence of the signal maximum (For the shaping function chosen at \(T_{max}=BX_{0}+2\)).

### Digitization

The effective energies \(E_{eff}(\)T\()\) are then fed into a FADC system which is assumed to be 8 bit wide. The current MC implementation is calibrated with 1 GeV (transverse energy) per ADC count.

### Thresholding in Single Cells

After shaping and digitization a threshold for each trigger cell is applied in order to be less sensitive to noise and pile-up effects. Currently a threshold of 1 GeV is applied.

### Filtering

The FADC values then undergo a filter procedure to identify real energy deposits and to perform bunch-crossing identification. The filter algorithm works in the following way: the effective energies E\({}_{eff}(T)\) seen in five subsequent bunch-crossings are weighted by the following factors: \(\omega(T-4BX),...,\omega(T)=\{-1,0,4,0,-1\}\). These factors are enhancing the maximum of a real signal and are suppressing noise contributions. The output of these procedure is the weighted sum Y(T) given here with respect to the bunch-crossing of interest \(BX_{0}\)

\[Y(T=BX_{0}+2)=\sum_{t=BX_{0}=2}^{t=BX_{0}+2}E_{eff}(t)\cdot\omega(t)\]

\begin{table}
\begin{tabular}{|l|c c c c c|} \hline beam energy (GeV) & 20 & 40 & 60 & 80 & 120 \\ \hline resolution \(\sigma\) (GeV) & 2.5 & 3.1 & 4.6 & 4.7 & 6.3 \\ \hline \end{tabular}
\end{table}
Table 1: Energy resolution obtained with the FADC system.

### Bunch-Crossing Identification

The weighted sums Y(T) are input to the bunch crossing identification algorithm which is realized as a simple peak finding algorithm again given as an example with respect to the bunch-crossing of interest \(BX_{0}\):

\[Y(BX_{0}+1) < Y(BX_{0}+2)\quad\text{or}\] \[Y(BX_{0}+1) \leq Y(BX_{0}+2)\] and \[Y(BX_{0}+3) < Y(BX_{0}+2)\quad\text{or}\] \[Y(BX_{0}+3) \leq Y(BX_{0}+2)\]

If this requirement is fulfilled a flag \(BX_{true}\) is set and only those FADC signals \(E_{eff}(\text{T})\) are input to further analysis which are validated by the \(BX_{true}\) flag.

## 3 Determination of \(E_{t}^{miss}\)

Only the signals validated by the bunch crossing identification are summed up in further steps of the algorithm. To get the \(E_{t}^{miss}\) the signals have to be split into their x and y components.

### Build Energy Sums within \(\Delta\eta\Delta\phi=0.4\cdot 0.4\)

In a first step the energy sums in \(\Delta\eta\Delta\phi=0.4\cdot 0.4\) are built and are then combined with the other calorimeter sums with the appropriate relative calibration constants.

### Building of \(E_{x}\) and \(E_{y}\)

In order to compute the \(E_{t}^{miss}\), the individual components \(E_{x}\) and \(E_{y}\) have to be deduced which is done with respect of the energy sums in \(\Delta\eta\Delta\phi=0.4\cdot 0.4\). In the current simulation of the algorithm it is assumed that the components are splitted with respect to the cell center.

### Calculate \(E_{t}^{miss}\)

These components are then summed up individually before combined to form the \(E_{t}^{miss}\) :

\[E_{t}^{miss}=\sqrt{(\sum E_{x})^{2}+(\sum E_{y})^{2}}\]

### Apply Thresholds

In the last step the thresholds are applied, it is assumed that up to 8 different thresholds can be applied.

### Fast Simulation

The chain of level-1 trigger elements described in the previous subsections has been implemented into a stand-alone simulation program. It allows to simulate single particles or to read in fully simulated events in form of calorimeter maps of 64x64 trigger cells. It is also interfaced to PYTHIA and ISAJET and working in the framework of ATLFAST. Therefore both the effects of the magnetic field and the energy resolution of the calorimeters are taken into account.

Cracks and details of the detector geometry are not taken into account when dealing with either single particles or PYTHIA/ISAJET events. Also not taken into account are details of electromagnetic and hadronic showers. No energy sharing between different types of calorimeters have been simulated so far.

## 4 First Results

The fast simulation has been performed on different samples of events. Both, signal events and background have been simulated. Table 2 summarizes the different samples.

### Definition of Variables

Before going into details of the results the variables used in the analysis will be defined. There are several stages within the level-1 chain which influences the determination of \(E_{t}^{miss}\). The first stage at which \(E_{t}^{miss}\) is calculated is the particle level. The next level is after taking into account energy smearing and pile-up contributions. Then shaping and digitization are simulated without any thresholding at the trigger cell level, which is included as well as bunch crossing identification, finally. Table 3 summarizes the definition of the energies at the different stages.

### Results on a \(E_{t}^{miss}\) Trigger

In a first analysis we compared the signal and background due to minimum bias events at the different stages of the level-1 trigger chain. Starting with the raw energies \(E_{T}^{RAW}\) there is no clear separation between signal and background. Taking into account the shaping the separation iseven worse. Taking into account the event history and setting a threshold at the level of single trigger cells the two distributions are separated quite well and finally, after performing the bunch crossing identification, the two distributions are separated clearly, the resolution of \(E_{t}^{miss}\) is expected to be for single electrons around 6 GeV. This behavior is shown in fig. 4. In table 4 details on the reconstructed missing energy, the resolution and the background contribution are given.

We convinced ourselves, that the fast simulation is adequate to perform trigger studies by comparing fully simulated electrons (\(E_{T}=100\ GeV\)) to those of the fast simulation. The results are shown in fig. 5. We found a resolution for the full simulation of 6.8 GeV, which is only slightly worse than we obtained in the fast simulation.

The \(E_{t}^{miss}\) in single electron events has also been analyzed with respect to effects on the pseudo-rapidity of the electron and on empty bunches preceding an event of interest. We have found, that in all cases the reconstructed \(E_{t}^{miss}\) is nearly the same. The increase of the resolution as a function of the electron energy is small. The energy dependence as well as the other comparisons is summarized in table 5. Single electrons are resulting in a much better energy resolution for \(E_{t}^{miss}\) than in events with a large hadronic activity. Therefore we have analyzed also W's decaying into electrons and neutrinos and finally to SUSY events where the reconstructed

\begin{table}
\begin{tabular}{|l|} \hline Single electrons: 20-20 GeV both at the particle level and after full \\ detector simulation \\ \(W\longrightarrow e\nu\) \\ SUSY events: \(m\tilde{q},\tilde{g}\approx 200\) GeV \(\approx 400\) GeV \(\approx 1000\) GeV \\ \hline QCD events: \(p_{T}^{rel}>20\) GeV (+ subsamples of different \(p_{T}\) ranges) \\ Fully simulated min.bias events \\ \hline \end{tabular}
\end{table}
Table 2: Overview on the samples of simulated events.

Figure 4: Reconstructed missing transverse energy, its resolution and the mean of mean bias events for the raw energy (left upper), the energy after shaping (right upper), the energy after thresholding of trigger cell energies (left lower) and after bunch crossing identification (right lower)

missing energy is dominated by the hadronic activity. Whereas single electrons of W decays as well as the single electrons without any other activity do not show a strong energy dependence the missing energy within SUSY events may be expressed to be mainly due to statistical fluctuations of the energy deposits of the large number of produced hadrons. In table 6 the resolution as a function of the generated \(E_{l}^{miss}\) is given. In the third column the resolution is expressed in the form \(\sigma/\sqrt{E}\). We may expect to have a resolution of a missing energy trigger to be about \(\sigma/E=20\,\%/\sqrt{E}\).

## 5 Conclusions

We have performed studies of a \(E_{T}^{miss}\) trigger for the ATLAS experiment. We found, that some elements of the level-1 trigger chain influences the resolution quite drastically. Especially triggers which rely on the summation of large detector area do profit by setting thresholds to single cells and by identifying the correct bunch crossings. It should be emphasized that not only the \(E_{T}^{miss}\) trigger but all other triggers relying on calorimetric measurements have to be studied taking into account the above mentioned effects. We have found, that minimum bias events preceding the event of interest influence the energy measurement of this event. Especially the long negative undershoot of the shaped signals leads to a noise level which has its mean at zero in contrast to the always positive energies at particle level and therefore thresholding of energy deposits in trigger cells is very effective already at very low threshold settings. We conclude that low threshold for an \(E_{T}^{miss}\) trigger are feasible. Rate estimates, efficiencies and analysis of other triggers including all the aspects of the level-1 trigger system are currently investigated and results will appear in a following note.

\begin{table}
\begin{tabular}{|c||c|c|c|} \hline Signal form & \(\langle E_{T}^{miss}\rangle\) (GeV) & \(\sigma_{E_{T}^{miss}}\) (GeV) & (Background) (GeV) \\ \hline Raw & 104.9 \(\pm\).7 & 14.3 \(\pm\).6 & 19.2 \\ Shaping & 101.6 \(\pm\).8 & 17.6 \(\pm\).7 & 22.7 \\ Digitization & 100.8 \(\pm\).3 & 7.0 \(\pm\).3 & 8.9 \\ BCID; Threshold & 100.0 \(\pm\).3 & 5.9 \(\pm\).2 & 7.1 \\ \hline \end{tabular}
\end{table}
Table 4: Reconstructed missing transverse energy, its resolution and the mean of mean bias events for the raw energy, the energy after shaping, the energy after thresholding of trigger cell energies and after bunch crossing identification

Figure 5: Reconstructed missing transverse energy of fast simulated (upper plot) and fully reconstructed single electrons lower plot

## References

* [1] W. Braunschweig et al., RD33 Collaboration, "Performance of the TGT liquid argon calorimeter and trigger system.", _Nucl. Instrum. Meth_**A378** (1996) 479.
* the TGT", _Nucl. Instrum. Meth._**A 357** (1995) 333.
* [3] RD27 status report, CERN-DRDC/93-32. I.P.Brawn et al., RD 27 note 22.

\begin{table}
\begin{tabular}{|c|c|c|} \hline \(E_{T}^{MISS,GEN}\) & \(\sigma\) & \(\sigma/\sqrt{E}\) \\ (GeV) & (GeV) & \\ \hline
60 & 18.7 & 250\% \\
70 & 16.4 & 193\% \\
120 & 18.9 & 172\% \\
160 & 20.9 & 167\% \\
520 & 36.4 & 160\% \\ \hline \end{tabular}
\end{table}
Table 6: Energy resolution of \(E_{T}^{MISS}\) obtained in the SUSY events