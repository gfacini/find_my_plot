[MISSING_PAGE_FAIL:1]

## 1 Introduction

The identification of jets containing \(b\)-hadrons is an important ingredient for a wide range of analyses performed on the data collected with the ATLAS detector [1] at the Large Hadron Collider [2]. Several methods to identify \(b\)-jets have been developed, exploiting characteristic properties of \(b\)-flavoured hadrons (see Section 2 for a brief overview). In particular their long lifetime, high mass and decay multiplicity, as well as the hard \(b\)-quark fragmentation function are important to distinguish them from jets containing charmed or light-flavoured hadrons.

The definition of these tagging algorithms makes heavy use of large samples of simulated events. Before a tagger can be used in the context of a physics analysis, its tagging performance in collision data needs to be measured. More specifically, the efficiency \(\epsilon_{b}^{\mathrm{data}}\) to correctly identify a jet containing a \(b\)-hadron in data needs to be quantified. Similarly, the efficiencies to incorrectly tag a jet containing a charmed hadron (\(\epsilon_{c}^{\mathrm{data}}\)) or a light-flavoured hadron (\(\epsilon_{l}^{\mathrm{data}}\)) as a \(b\)-jet are required. These calibration results are usually presented in the form of data-to-simulation scale factors, defined as the ratio of the tagging efficiency in data and in simulation for various jet flavours. They are used to correct the tagging efficiencies \(\epsilon_{i}^{\mathrm{MC}}\) (\(i=b\), \(c\), \(l\)) in simulation to match those observed in data. The measurement of the \(b\)-tagging efficiency scale factor is based on a sample enriched in \(t\bar{t}\) events [3].

Since the determination of the data-to-simulation scale factors relies heavily on the abundance of events suitable for calibration in data, the regime in which the scale factors can be extracted is limited. In particular, the \(t\bar{t}\)-based calibration strategy mentioned above only allows to derive \(b\)-tagging efficiency scale factors for particle flow jets with transverse momenta \(p_{T}\) up to \(400\,\mathrm{GeV}\). This is to be contrasted with the overall kinematic range of jets contained in the data collected by ATLAS--and therefore usable by physics analyses--which extends well into the multi-TeV regime. Some of these analyses, such as searches for heavy hadronically decaying resonances can benefit significantly from the usage of flavour-tagging information [4]. These searches target events containing jets close to the upper end of the \(p_{T}\)-spectrum that is kinematically accessible, for which the necessary calibration information is not directly accessible from data.

This note documents a simulation-based method to extrapolate existing data-driven calibration results for the \(b\)-tagging efficiency into the high-\(p_{T}\) regime, making them available for jets with transverse momenta up to \(3\,\mathrm{TeV}\). The results of this procedure are phrased in terms of the extrapolated central value of the scale factor that applies in the \(p_{T}\) range above the data-driven regime, as well as a dedicated extrapolation uncertainty. The latter is constructed from variations of the \(b\)-tagging efficiency corresponding to experimental and theoretical uncertainties on the inputs of the tagging algorithm. The extrapolation uncertainty compares the magnitude of these variations in the extrapolation regime to their importance in the domain covered by data-driven methods. It thus captures effects that are specific to the extrapolation region and is indicative of the overall uncertainty on the extrapolated scale factor.

The remainder of this note is organised as follows. Section 2 gives a brief overview of the \(b\)-tagging methods that are used within the ATLAS Collaboration. Section 3 gives a precise definition of the extrapolation strategy, Section 4 specifies the samples of simulated events on which this work is based and Section 5 summarises the reconstruction of the relevant objects. Section 6 describes the origin of the dominant sources of experimental and theoretical uncertainties that are taken into account. Finally, Section 7 summarises the results obtained from this method.

## 2 \(b\)-tagging in ATLAS

A number of different algorithms for the identification of jets containing \(b\)-hadrons have been developed or are in use. These algorithms make use of information delivered by several subdetectors of the ATLAS experiment, which is described in great detail elsewhere [1].

The central input variables to \(b\)-tagging are the jet kinematics as well as the properties of the charged particle tracks that are associated with these jets. Tracks are reconstructed in the inner detector [5], which consists of silicon pixels, a silicon micro-strip tracker, and a transition radiation tracking detector. In this note, \(b\)-tagging is discussed in the context of particle flow jets [6], which are constructed by combining information from the calorimeter system and the inner detector (see also Section 5).

For purposes of \(b\)-tagging, tracks are associated with a jet based on the angular separation between the track and the jet axis1, \(\Delta R(\text{track, jet})=\sqrt{(\Delta\eta)^{2}+(\Delta\phi)^{2}}\). A variable \(\Delta R\) criterion is used, depending on the jet \(p_{T}\), leading to narrower association cones for jets with high transverse momenta.

Footnote 1: ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point (IP) in the centre of the detector and the z-axis along the beam pipe. The x-axis points from the IP to the centre of the LHC ring, and the y-axis points upward. Cylindrical coordinates (\(r,\phi\)) are used in the transverse plane, \(\phi\) being the azimuthal angle around the beam pipe. The pseudorapidity is defined in terms of the polar angle \(\theta\) as \(\eta=-\log\tan(\theta/2)\).

A number of physics-inspired "low-level" algorithms [7] are applied to the collections of associated tracks. They aim to extract a small number of discriminants relevant for the identification of \(b\)-jets. The presence of long-lived \(b\)-hadrons generally leads to tracks with large impact parameters. Traditional track-oriented algorithms such as IP2D and IP3D exploit the transverse and longitudinal impact parameters of each track individually. The RNNIP algorithm [8], based on a recurrent neural network, is also able to harness the correlations between different tracks. Vertex-based methods either rely on the properties of an inclusively reconstructed secondary vertex (SV1) or attempt to reconstruct the entire decay chain of the \(b\)-hadron (JetFitter). In both cases, the presence of a displaced secondary vertex with high invariant mass of the tracks emanating from it is indicative of the presence of a \(b\)-hadron.

The individual observables provided by these methods are combined into powerful "high-level" discriminants by means of a fully-connected artificial neural network. This gives rise to the DL1r tagger, which forms the primary \(b\)-tagging algorithm recommended to the ATLAS Collaboration.

More detailed information about the tagger architecture is available in Ref. [9; 10; 11].

## 3 Extrapolation strategy

### Overview

The results of \(b\)-tagging calibrations are obtained in the form of data-to-simulation scale factors. Scale factors are available for all jet flavours that are calibrated (currently \(b\), \(c\) and light). In what follows, the extrapolation strategy is presented in the context of \(b\)-jets, but the methodology is equally applicable to other jet flavours.

The \(b\)-tagging efficiency scale factor is defined as

\[\text{SF}_{b,w}=\frac{\epsilon_{b,w}^{\text{data}}}{\epsilon_{b,w}^{\text{MC}}}, \tag{1}\]

where \(\epsilon_{b,w}^{\text{MC}}\) is the \(b\)-tagging efficiency obtained in simulation and \(\epsilon_{b,w}^{\text{data}}\) is the efficiency in data. The tagger operating point (OP) is labelled by \(w\). Four OPs are available that achieve an average \(b\)-tagging efficiency of 60%, 70%, 77% and 85% respectively for \(b\)-jets with \(p_{T}>20\,\text{GeV}\) found in simulated \(t\bar{t}\) events. The scale factor \(\text{SF}_{b,w}\) corrects the \(b\)-tagging performance in simulation to match that in data. It is expected to be a continuous function of the jet kinematics [12]. For the present purposes, the jet \(p_{T}\) is the most important kinematic quantity and the dependency of the scale factor on this variable is made explicit as \(\text{SF}_{b,w}=\text{SF}_{b,w}(p_{T})\).

The extrapolation strategy described in the following applies to all OPs. The explicit dependence on the OP \(w\) is therefore dropped in order to simplify the notation.

Any measurement of the scale factor \(\text{SF}_{b}\) from data is associated with an uncertainty \(\sigma_{\text{rel}}(\text{SF}_{b}(p_{T})):=\sigma(\text{SF}_{b}(p_{T}))/\text{ SF}_{b}(p_{T})\). Results from data-driven calibration methods are available for jets with \(p_{T}<p_{T,\text{ref}}\), where \(p_{T,\text{ref}}\) is referred to as the "reference momentum".

For the extrapolation of the scale factor \(\text{SF}_{b}\) into the region \(p_{T}>p_{T,\text{ref}}\), the following model is used,

\[\text{SF}_{b}(p_{T}):=\text{SF}_{b}(p_{T,\text{ref}})\cdot\mathcal{R}_{b}^{ \text{MC}}(p_{T};p_{T,\text{ref}})\quad\text{for}\quad p_{T}>p_{T,\text{ref}}. \tag{2}\]

In the extrapolation domain, \(\mathcal{R}_{b}^{\text{MC}}(p_{T};p_{T,\text{ref}})\) scales the measured value of the scale factor at the reference momentum. This multiplicative factor is defined only in terms of quantities accessible from simulation, as indicated by the superscript. Its explicit form does not enter the argument below. Only some of its very general properties are required.

Equation 2 defines both the central value of the extrapolated scale factor as well as its uncertainty. In principle, it allows to incorporate simulation-driven corrections to \(\text{SF}_{b}(p_{T,\text{ref}})\) through a judiciously chosen factor \(\mathcal{R}_{b}^{\text{MC}}\). In the simplest case, which is relevant here, no such corrections are applied and the central value of \(\text{SF}_{b}\) measured for the reference momentum is used also in the extrapolation domain. This effectively assumes that \(\text{SF}_{b}\) depends only weakly on the jet \(p_{T}\) in the extrapolation region--a fact suggested by the data for \(p_{T}<p_{T,\text{ref}}\)[11]. The scale factor in the extrapolation domain is thus defined as

\[\text{SF}_{b}(p_{T}):=\text{SF}_{b}(p_{T,\text{ref}})\implies\mathcal{R}_{b} ^{\text{MC}}(p_{T};p_{T,\text{ref}}):=1\quad\text{for}\quad p_{T}>p_{T,\text {ref}}. \tag{3}\]

Note that this choice only concerns the central value of the extrapolated scale factor and does not impact its uncertainty, which is discussed next.

Equation 2 implies that the relative uncertainty of \(\text{SF}_{b}\) in the extrapolation domain is given as the sum of two contributions,

\[\sigma_{\text{rel}}^{2}(\text{SF}_{b}(p_{T})) =\sigma_{\text{rel}}^{2}(\text{SF}_{b}(p_{T,\text{ref}}))+\sigma_ {\text{rel}}^{2}(\mathcal{R}_{b}^{\text{MC}}(p_{T};p_{T,\text{ref}}))\] \[=\sigma_{\text{rel}}^{2}(\text{SF}_{b}(p_{T,\text{ref}}))+\sigma_ {\text{extrap}}^{2}(p_{T};p_{T,\text{ref}})\quad\text{for}\quad p_{T}>p_{T, \text{ref}}. \tag{4}\]

The relative uncertainty on the factor \(\mathcal{R}_{b}^{\text{MC}}\) plays the role of a dedicated extrapolation uncertainty, written as \(\sigma_{\text{extrap}}^{2}(p_{T};p_{T,\text{ref}}):=\sigma_{\text{rel}}^{2}( \mathcal{R}_{b}^{\text{MC}}(p_{T};p_{T,\text{ref}}))\). Its precise definition is outlined in Section 3.2 below. The extrapolation uncertainty is added in quadrature to the uncertainty coming from the data driven measurement, \(\sigma_{\text{rel}}^{2}(\text{SF}_{b}(p_{T,\text{ref}}))\).

### Extrapolation uncertainty

The tagging decision made by a \(b\)-tagging algorithm is affected by a number of experimental and theoretical systematic uncertainties. Owing to the heavy reliance on tracking information, uncertainties affecting the reconstruction of charged particle tracks in the inner detector are relevant, as are uncertainties on the modelling of the jet fragmentation in simulation. Dedicated uncertainties on the momentum calibration for particle flow jets are important as well, as are comparisons between different simulation models for the \(b\)-hadron interactions with the detector.

The impact of these uncertainties on the \(b\)-tagging algorithm is determined by modifying its input variables in an appropriate way (made more precise in Section 6 below) and then recomputing the \(b\)-tagging discriminant. In this way, an uncertainty component \(s\) leads to a \(b\)-tagging efficiency \(\epsilon_{b,s}^{\text{MC}}(p_{T})\) in simulation which is in general different from the nominal efficiency \(\epsilon_{b}^{\text{MC}}(p_{T})\). Comparing these two, the relative impact of the systematic uncertainty \(s\) on the efficiency is

\[\delta\epsilon_{b,s}^{\text{MC}}(p_{T})=\frac{\epsilon_{b,s}^{\text{MC}}(p_{T })-\epsilon_{b}^{\text{MC}}(p_{T})}{\epsilon_{b}^{\text{MC}}(p_{T})}.\]

It is taken to be fully correlated across jet \(p_{T}\).

Equation 2 allows to express the extrapolation uncertainty in terms of the \(\delta\epsilon_{b,s}^{\text{MC}}(p_{T})\). For this relation to be well-formed, \(\mathcal{R}_{b}^{\text{MC}}(p_{T}\,;p_{T,\text{ref}})\) must scale like the ratio of two scale factors. To compute the extrapolation uncertainty, only the dependence of \(\mathcal{R}_{b}^{\text{MC}}\) on simulation-based quantities such as \(\epsilon_{b}^{\text{MC}}\) is relevant. Since \(\text{SF}_{b}\propto 1/\epsilon_{b}^{\text{MC}}\), the following relation holds,

\[\mathcal{R}_{b}^{\text{MC}}(p_{T};p_{T,\text{ref}})\propto\left(\frac{ \epsilon_{b}^{\text{MC}}(p_{T})}{\epsilon_{b}^{\text{MC}}(p_{T,\text{ref}}) }\right)^{-1}, \tag{5}\]

i.e. \(\mathcal{R}_{b}^{\text{MC}}(p_{T};p_{T,\text{ref}})\) depends on the ratio of two (simulation-based) \(b\)-tagging efficiencies evaluated at different transverse momenta.

From Equation 5, the extrapolation uncertainty \(\sigma_{\text{extrap}}^{2}(p_{T};p_{T,\text{ref}})\) (again as a relative uncertainty) is given by the quadratic sum of all independent variations \(\delta\epsilon_{b,s}^{\text{MC}}(p_{T})\), relative to their contribution at \(p_{T,\text{ref}}\),

\[\sigma_{\text{extrap}}^{2}(p_{T};p_{T,\text{ref}})=\sum_{s\in\mathcal{S}} \max_{<p_{T}}\left[\delta\epsilon_{b,s}^{\text{MC}}(p_{T})-\delta\epsilon_{b,s}^{\text{MC}}(p_{T,\text{ref}})\right]^{2}. \tag{6}\]

The set \(\mathcal{S}\) contains all considered sources of uncertainties. The notation \(\max_{<p_{T}}\) indicates that the highest value observed up until the considered jet \(p_{T}\) is used for the uncertainty. This ad-hoc procedure ensures that the extrapolation uncertainty increases monotonically with the jet momentum. It thus prevents an artificial reduction of \(\sigma_{\text{extrap}}^{2}\)in case some uncertainties \(s\) lead to a crossover between \(\epsilon_{b}^{\text{MC}}(p_{T})\) and \(\epsilon_{b,s}^{\text{MC}}(p_{T})\).

Figure 1 illustrates \(\epsilon_{b}^{\text{MC}}(p_{T})\) for the 77% efficiency OP of the DL1r tagger. Also shown are two efficiency variations \(\epsilon_{b,s}^{\text{MC}}(p_{T})\) that enter the computation of the extrapolation uncertainty as described above. All considered sources of uncertainty are described in more detail in Section 6. Several effects contribute to the reduction of the \(b\)-tagging efficiency with jet \(p_{T}\). One of the most important factors is the limited efficiency to reconstruct the tracks produced by charged \(b\)-hadron decay products. It can become very small in the dense tracking environments found inside the cores of high-\(p_{T}\) jets.

Equation 6 shows that the extrapolation uncertainty measures the increased importance of the uncertainties on the \(b\)-tagging efficiency at high-\(p_{T}\) compared to their respective impact at the reference momentum \(p_{T,\mathrm{ref}}\). It is indicative of the magnitude of additional deficiencies in the detector modelling that are specific to the extrapolation region \(p_{T}>p_{T,\mathrm{ref}}\) and that are therefore not already corrected by the data-driven calibration. It thus captures the expected difference between the extrapolated scale factor according to Equation 3 and the correct scale factor in the extrapolation domain. Section 6 lists all considered sources of systematic uncertainties in detail.

## 4 Simulated event samples

Uncertainties originating from the reconstruction of charged particle tracks in the inner detector as well as the calibration of the jet energy scale and jet energy resolution are assessed from a sample of events containing \(Z^{\prime}\) bosons produced from the \(pp\) initial state and decaying to quark-antiquark pairs [9]. The branching ratios of the \(Z^{\prime}\) to bottom (\(b\)), charm (\(c\)) and light quarks (\(u\), \(d\), \(s\)) are each artificially set to 30%, and the decay into \(\tau\) and \(e\) is set to occur with a branching fraction of 5% each. Events are generated and showered with Pythia 8.235 [13] using the NNPDF23LO parton distribution function (PDF) set [14] and the A14 set of tuned parameters [15]. The decay of bottom and charmed hadrons is performed using the EvtGen decay package [16]. The cross-section of the hard scattering process is modified to broaden the natural

Figure 1: The \(b\)-tagging efficiency for the 77% efficiency OP of the DL1r tagger as a function of the jet \(p_{T}\) in simulation. The black points correspond to the nominal efficiency. The blue and red markers correspond to the efficiency in the presence of uncertainty components affecting the track reconstruction and the jet momentum calibration, respectively. These form a small subset of all considered variations and are shown for illustration only.

width of the \(Z^{\prime}\) resonance, resulting in a sample enriched in jets with transverse momenta \(p_{T}>1\) TeV. This allows assessing relevant uncertainties on the \(b\)-tagging efficiency with reasonable statistical precision up to a jet \(p_{T}\) of around 3 TeV, which is set as the upper limit of the high-\(p_{T}\) extrapolation.

Theoretical uncertainties pertaining to the modelling of the jet final state are evaluated based on a dedicated set of samples of \(Z^{\prime}\) events. These samples were produced using MadGraph 5 v2.6.7 [17], where the same decay modes of the \(Z^{\prime}\) as described above are used, and a similar scheme is employed to enrich the sample in high-\(p_{T}\) jets. MadGraph was interfaced to Pythia 8.243 [13] using the NNPDF23LO PDF set [14] and the A14 set of tuned parameters [15]. The uncertainties originating from the modelling of final-state radiation (FSR) are assessed by reweighting these \(Z^{\prime}\) events in a manner that reduces and enhances final state parton shower radiation around the nominal intensity. An alternative sample was generated using MadGraph interfaced to Herwig 7.1.6 [18] with the default set of tuned parameters, and is used to evaluate uncertainties due to variations in the parton shower.

In addition to the hard scattering process, each event was overlaid with additional \(pp\) collisions (pile-up) generated with Pythia 8.1 [19] using the ATLAS A3 set of tuned parameters [20] and the NNPDF23LO [14] PDF set. Events are weighted to match the pile-up distribution observed in data. All samples were processed through the full ATLAS detector simulation [21] based on GEANT4 [22]. This simulation setup does not model the interaction of \(b\)-hadrons with the detector, but does so only for their decay products. To study the impact on the \(b\)-tagging efficiency, a subset of the samples described above was also propagated through an alternative version of the ATLAS detector simulation which does include \(b\)-hadron interactions [23].

For all samples, it was verified that the magnitude of the \(b\)-tagging efficiency variations \(\delta\epsilon^{\text{MC}}_{b,s}(p_{T})\) for jets with \(p_{T}\lesssim 500\) GeV are comparable to those seen for \(b\)-jets produced in the decay of \(t\bar{t}\) pairs.

## 5 Objects and event selection

Jets are reconstructed based on particle flow objects built from topological calorimeter clusters and reconstructed tracks [6]. The anti-\(k_{T}\) algorithm [24] with a radius parameter of \(R=0.4\) is used. A series of corrections is applied to calibrate the jet response to particle level, as detailed in Ref. [6]. Only jets with \(p_{T}>20\) GeV and \(|\eta|<2.5\) are considered. In addition, a requirement on the output of the Jet Vertex Tagger algorithm [25] is applied to suppress jets originating from pile-up events.

Jets are labelled as \(b\)-jets if a \(b\)-hadron with \(p_{T}>5\) GeV is present within a cone of radius \(\Delta R=0.3\) around the jet axis. Only the two \(b\)-jets with highest \(p_{T}\) in each event are used.

## 6 Systematic uncertainties

The leading sources of systematic uncertainties that are included in the computation of the extrapolation uncertainty are briefly described below.

### Tracking uncertainties

Observables derived from tracking information are important input variables for all low-level tagging algorithms. Uncertainties coming from track reconstruction thus have a direct impact on the \(b\)-tagging efficiency. Their impact is exacerbated by the challenging tracking environment found inside the cores of high-\(p_{T}\) jets [26]. Dedicated uncertainty components are included to account for these effects.

#### 6.1.1 Tracking efficiency

The impact of tracking efficiency variations on the \(b\)-tagging efficiency is investigated by randomly removing tracks with a \(p_{T}\)- and \(|\eta|\)-dependent probability. This emulates a situation with reduced tracking efficiency. The resulting change of the \(b\)-tagging efficiency is taken to be symmetric, i.e. a corresponding enhancement of the tracking efficiency is assumed to modify the \(b\)-tagging efficiency by the same magnitude.

The tracking efficiency is varied within its uncertainties. The most important sources arise from uncertainties in the material budget of the inner detector, and the physics model used in its simulation. The uncertainty is assessed by comparing the tracking efficiency in samples with modified material budgets of the inner detector [27], as well as different physics lists in the GEANT4 detector simulation model. These differ in their description of the interaction between high-energy particles and nucleons.

The overall uncertainty on the tracking efficiency for inclusive tracks ranges from 0.4% for tracks with \(|\eta|<0.1\) to 1.5% for the region \(2.3\leq|\eta|\leq 2.5\). A dedicated uncertainty of 0.4% on the tracking efficiency is applied only to tracks with an angular distance of \(\Delta R<0.1\) from the closest particle flow jet axis. It is derived from the fraction of charge deposits in the inner detector that are consistent with two tracks, but are assigned to only one reconstructed track. This uncertainty component is specific to tracks in dense environments, i.e. in the high-density core of the jet.

#### 6.1.2 Rate of fake tracks

Fake tracks are reconstructed tracks that do not originate from a physical particle, but instead arise due to combinatorial effects in dense tracking environments. The fake track rate is varied within its uncertainties and the impact on \(b\)-tagging is studied by randomly removing fake tracks in simulation. As before, this emulates a situation with reduced fake track rate. The effect on the \(b\)-tagging efficiency is again assumed to be symmetric.

To define the uncertainty on the fake track rate, fake tracks are studied inside jets by inverting some of the track quality criteria. This measurement [26, 28] results in an inclusive uncertainty on the number of fake tracks of 10%. An additional uncertainty of 25% is specific to dense tracking environments and applies only to tracks with an angular distance of \(\Delta R<0.1\) from the closest particle flow jet axis.

#### 6.1.3 Impact parameter resolution

Variations in the resolution of the transverse and longitudinal impact parameters \(d_{0}\) and \(z_{0}\) affect the IP2D, IP3D and RNNIP taggers, which specifically depend on these variables. The impact on \(b\)-tagging is quantified in the following way. The impact parameter resolution in simulation is first corrected to match the resolution observed in data, and then varied around this value in both directions within the uncertaintiesof the impact parameter measurement by randomly smearing the impact parameter values. The resulting two-sided uncertainty on the \(b\)-tagging efficiency is symmetrised and included in the computation of \(\sigma_{\text{extrap}}^{2}\).

The experimental resolution of the transverse and longitudinal impact parameters is determined in di-jet events and then unfolded from the primary vertex resolution [29, 30]. The uncertainties on this measurement include components pertaining to the unfolding procedure itself. The impact parameter resolution in data and simulation can differ by \(20-50\%\) before the correction, depending on the \(p_{T}\) of the track. For \(d_{0}\), the uncertainty amounts to about \(40\%\) of the size of the correction for a track with a \(p_{T}\) of \(1\,\text{Ge\kern-1.0ptV}\) and reduces to about \(20\%\) of the correction for a track \(p_{T}\) of \(100\,\text{Ge\kern-1.0ptV}\). For \(z_{0}\), the uncertainty varies between \(20\%\) and \(10\%\) of the correction in the same track \(p_{T}\) range.

#### 6.1.4 Detector alignment

Additional effects come from the precision with which tracking detector modules are aligned, i.e. with which their relative and absolute positions can be determined. They affect the charge-to-momentum ratio \(q/p_{T}\) of the track from a potential sagitta distortion, as well as the longitudinal and transverse impact parameters due to detector misalignment weak modes [31]. These are systematic deformations of the tracker that cannot be identified merely by minimising the hit-to-track residuals during the alignment process. They are extracted instead by fitting the mass distribution of a known particle in a two-body decay, e.g. \(Z\to\mu\mu\), as described in Ref. [32, 33].

The magnitude of these biases depends strongly on the pseudorapidity \(\eta\) of the track, with larger values close to the edge of the tracker at \(|\eta|=2.5\). In this region, weak modes account for a bias of around 2-4 \(\mu\)m for the transverse impact parameter \(d_{0}\) and around 0.05-0.08 mm for the longitudinal impact parameter \(z_{0}\). The bias for \(z_{0}\) is considerably reduced to below 8 \(\mu\)m for \(|\eta|<2.0\). The sagitta bias reaches values of up to \(0.6\,\text{TeV}^{-1}\) for \(|\eta|=2.5\) and is below \(0.2\,\text{TeV}^{-1}\) for \(|\eta|<2.0\).

### Jet calibration uncertainties

The jet \(p_{T}\) is used both to define the angular size of the track-to-jet association cone and is also used explicitly as input to the high-level \(b\)-tagging algorithms.

Uncertainties coming from the determination of the jet energy scale (JES) and jet energy resolution (JER) are evaluated [6, 34]. They include uncertainties on the flavour composition of jets and the flavour response of the calorimeter and the dependency on the pile-up activity [35]. Among these uncertainties, the dominant component arises from the JES for jets with \(p_{T}\gtrsim 2.4\,\text{Te\kern-1.0ptV}\). In this regime, the JES cannot be extracted using standard in-situ calibration methods, but is instead evaluated based on the calorimeter response to individual charged hadrons [36]. This uncertainty affects the \(p_{T}\) of the jet by about \(3.5\%\) at \(p_{T}=3\,\text{Te\kern-1.0ptV}\). The JES and JER uncertainties are two-sided. Their impact on the \(b\)-tagging efficiency is symmetrised and included in the computation of the extrapolation uncertainty.

The difference between the \(b\)-tagging efficiencies achieved on uncalibrated and fully calibrated particle flow jets is taken as an additional uncertainty to capture the overall susceptibility of the \(b\)-tagging algorithms to the jet calibration.

### Jet modelling uncertainties

Theory uncertainties that can affect the performance of \(b\)-tagging are mainly related to the modelling of the jet final state. Two uncertainty components are considered. The dependency of the tagging performance on the parton shower and hadronisation model is evaluated by comparing the \(b\)-tagging efficiency achieved in a sample of \(Z^{\prime}\) events showered either with Pythia 8.243 or Herwig 7.1.6, as detailed in Section 4. In addition, a dedicated final-state radiation (FSR) uncertainty component is added for the Pythia 8 shower, comprising variations of the strong coupling \(\alpha_{s}\) used to generate final-state emissions.

### \(b\)-hadron simulation

For \(b\)-jets with a transverse momentum of \(p_{T}=500\) GeV, about 30% of the corresponding \(b\)-hadrons will decay after the first layer of the tracking detector, with an even larger fraction for higher jet momenta. Charged \(b\)-hadrons can interact with the tracking detector and the energy deposited in the innermost tracking layers might be mistakenly assigned to the track of one of its decay products, leading to a distortion of this track.

The nominal ATLAS detector simulation [21] does not include interactions of \(b\)-hadrons with detector elements. Only the interactions of \(b\)-hadron decay products are fully simulated. The impact of this effect on the \(b\)-tagging efficiency is determined through a comparison with an alternative, "quasi-stable" detector simulation setup which does includes electromagnetic interactions [23]. Hadronic interactions of the \(b\)-hadrons with the detector are not included, but expected to be small. The full difference between the \(b\)-tagging efficiency in the quasi-stable and the nominal detector simulation is taken for the computation of the extrapolation uncertainty.

## 7 Results

The extrapolation uncertainty \(\sigma_{\rm extrap.}\) for the \(b\)-jet scale factor \(\mathrm{SF}_{b}\) for particle flow jets, computed according to Equation 6, is shown in Figure 2 for the DL1r tagger. Current measurements of \(\mathrm{SF}_{b}\) for particle flow jets are available in the range \(20\leq p_{T}\leq 400\) GeV, so the reference momentum \(p_{T,\rm ref}\) is set to 400 GeV. By construction, the extrapolation uncertainty vanishes in the region \(p_{T}<p_{T,\rm ref}\) and increases monotonically for \(p_{T}\geq p_{T,\rm ref}\). For jets at the upper end of the extrapolation regime at \(p_{T}\sim 3\) TeV, it reaches a value of about 21% for the 85% efficiency OP to around 37% for the 60% efficiency OP. The extrapolation uncertainties for the 70% and 77% efficiency OP lie in between these values.

The dominant uncertainties across most of the extrapolation domain are found to come from the simulation of \(b\)-hadron interactions with the innermost tracking layers. This contribution affects \(\epsilon_{b}^{\rm MC}\) by around 15-20%, depending on the OP. In addition, the comparison between the Pythia 8 and Herwig 7 parton shower models leads to important uncertainties. For \(p_{T}=3\) TeV, they modify \(\epsilon_{b}^{\rm MC}\) by around 30% for the 60% efficiency OP and by around 13% for the 85% efficiency OP. Figure 3 summarises and compares these important uncertainty components for the 77% efficiency OP.

Uncertainties coming from the jet calibration are of sub-leading importance, with a total contribution of no more than 5%. The JES uncertainty affects the \(b\)-tagging uncertainty by at most 3% for jets with \(p_{T}\sim 3\) TeV. The combined contribution from the JER uncertainty components yields similar results.

Sources of uncertainty pertaining to the reconstruction of tracks are of similar magnitude, with the uncertainty on the rate of fake tracks being the most important contribution. It impacts the \(b\)-tagging efficiency by about 2-3% for jets with \(p_{T}\sim 3\) TeV. The impact of uncertainties on the tracking efficiency is below 1%. Figure 3(b) summarises the most important tracking uncertainty components entering the computation of the extrapolation uncertainty.

The extrapolation uncertainty is combined with data-driven measurements [3] of the \(b\)-tagging efficiency scale factor \(\mathrm{SF}_{b}\), which is based on the Run 2 dataset with an integrated luminosity of about \(139\,\mathrm{fb}^{-1}\). The combination is performed according to Equations 4 and 3. Figure 4 shows \(\mathrm{SF}_{b}\) across the entire considered kinematic range. A smoothing procedure [12] is applied to the binned measurement in order to obtain a continuous parametrisation of the scale factor.

Figure 2: Extrapolation uncertainty \(\sigma_{\mathrm{extrap}}\). for the DL1r tagger applied to particle flow jets as a function of the \(b\)-jet \(p_{T}\) (black curve). The contribution from experimental uncertainties affecting the reconstruction of tracks is shown in orange, uncertainties pertaining to the energy calibration of particle flow jets are shown in blue. Theoretical uncertainties on the modelling of the jet fragmentation are drawn in green and uncertainties coming from the modelling of the \(b\)-hadron interaction with the detector are shown in grey. The extrapolation uncertainty is applied for \(p_{T}\geq 400\) GeV. Figure (a) shows the 60% efficiency OP, (b) the 70% OP, (c) the 77% OP and (d) the 85% OP.

Figure 3: Figure (a) gives an overview of the most important extrapolation uncertainty components for the 77% efficiency OP of the DL1r tagger. The uncertainty due to the simulation of \(b\)-hadron interactions with the detector is shown in grey. The uncertainties pertaining to the modelling of the jet final state are drawn in dark blue for the comparison of different parton shower models, and in yellow for the FSR variations. Figure (b) shows the most important tracking uncertainty components for the same OP. The contributions due to the uncertainty of the fake track rate are shown in blue. The effect of the resolution uncertainty on the transverse and longitudinal impact parameters \(d_{0}\) and \(z_{0}\) are given in yellow. The contribution from the uncertainty on the tracking efficiency is shown in orange. The combination of all tracking uncertainty components is indicated by the black line.

Figure 4: Scale factor for the \(b\)-tagging efficiency, SF\({}_{b}\), for particle flow jets for the DL1r tagging algorithm as a function of the jet \(p_{T}\). The black markers correspond to the measurement of SF\({}_{b}\) from data. The black line represents the (smoothed) central value of the scale factor and the light green band represents the (smoothed) uncertainty from the measurement. The dark green band gives the extrapolation uncertainty for \(p_{T}>400\) GeV. Figure (a) shows the 60% efficiency OP, (b) the 70% OP, (c) the 77% OP and (d) the 85% OP.

## 8 Conclusions

A simulation-based technique is presented that is used to extrapolate data-driven calibration results to the domain of jets with TeV-scale transverse momenta, which can not be covered by these data-based measurements. A dedicated high-\(p_{T}\) extrapolation uncertainty is constructed to capture additional modifications of the \(b\)-tagging performance that are specific to the high-\(p_{T}\) regime, which gives a measure for the extent to which existing calibration results are still valid in the extrapolation domain.

Using this method, the extrapolation uncertainty is evaluated for \(b\)-jets for the DL1r tagging algorithm when applied to particle flow jets. The resulting additional uncertainties on the \(b\)-tagging data-to-simulation scale factors increase monotonically with the jet \(p_{T}\) and range from around 20% for the loosest to around 37% for the tightest OP at the highest considered momentum of \(p_{T}=3\) TeV.

[MISSING_PAGE_EMPTY:15]

Figure 6: Efficiency to correctly identify a \(b\)-jet for the 77% efficiency OP of the DL1r tagger. The black points correspond to the efficiency achieved on a sample of events generated by MadGraph and showered with Pythia 8. The blue markers show the efficiency for the alternative sample which makes use of the same matrix element, but the Herwig 7 shower instead (see Section 4).

## Appendix B Efficiency for the DL1 tagger

Figure 7: Efficiency to correctly identify a \(b\)-jet for the 77% efficiency OP of the DL1r and DL1 taggers, as a function of the jet \(p_{T}\). The efficiencies are obtained from a sample of simulated \(Z^{\prime}\to q\bar{q}\) events generated and showered by Pythia, as described in Section 4. The DL1r tagger achieves a significantly higher efficiency for jets with \(p_{T}>1\) TeV compared to DL1. DL1r also includes information delivered by the RNNIP algorithm [8], which exploits the IPs and the kinematics of the tracks within the jet, as well as their correlations. It has been trained on a dataset enriched in high-\(p_{T}\) jets and is expected to be able to efficiently identify \(b\)-jets in this regime.

## 6 Conclusion

Figure 8: Efficiency to correctly identify a \(b\)-jet for the 77% efficiency OP of the DL1 tagger. The black points correspond to the nominal efficiency. The blue markers show the efficiency achieved when the rate of fake tracks in a region within \(\Delta R<0.1\) of the jet axis is reduced by 25%, as discussed in Section 6.1.2. The red curve corresponds to the efficiency when the JES for jets with \(p_{T}\gtrsim 2.4\,\mathrm{TeV}\) is reduced within the uncertainties of the measurement explained in Section 6.2.

C Extrapolation uncertainties for the DL1 tagger

Figure 9: Extrapolation uncertainty \(\sigma_{\text{extrap.}}\) for the DL1 tagger applied to particle flow jets as a function of the \(b\)-jet \(p_{T}\) (black curve). The contribution from experimental uncertainties affecting the reconstruction of tracks is shown in orange, uncertainties pertaining to the energy calibration of particle flow jets are shown in blue. Theoretical uncertainties on the modelling of the jet fragmentation are drawn in green and uncertainties coming from the modelling of the \(b\)-hadron interaction with the detector are shown in grey. The extrapolation uncertainty is applied for \(p_{T}\geq 400\) GeV. Figure (a) shows the 60% efficiency OP, Figure (b) the 70% OP, Figure (c) the 77% OP and (d) the 85% OP.

Figure 10: Scale factor for the \(b\)-tagging efficiency, SF\({}_{b}\), for particle flow jets for the DL1 tagging algorithm as a function of the jet \(p_{T}\). The black markers correspond to the measurement of SF\({}_{b}\) from data. The black line represents the (smoothed) central value of the scale factor and the light green band represents the (smoothed) uncertainty from the measurement. The dark green band gives the extrapolation uncertainty for \(p_{T}>400\) GeV. Figure (a) shows the 60% efficiency OP, (b) the 70% OP, (c) the 77% OP and (d) the 85% OP.

## Appendix D Modelling of \(b\)-jet fragmentation by Pythia and Herwig

This Appendix collects additional material to document the differences in the modelling of the \(b\)-jet fragmentation as performed by Pythia 8.243 and Herwig 7.1.6. All comparisons are based on the samples of simulated events described in Section 4. Variables are shown both at "truth-level" (i.e. defined using information from the truth particle record of the generators) and at "reconstructed level" (i.e. defined using only experimentally accessible information).

Figure 11: Distribution of the decay multiplicity of \(b\)-hadrons, as a function of the transverse momentum of the truth jet that contains the hadron. Truth jets are reconstructed with the anti-\(k_{T}\) algorithm with a radius parameter of \(R=0.4\) starting from all stable particles in the truth record of the generator. The error bars correspond to the standard deviation of the distribution. Figure (a) considers only stable charged stable decay products, while Figure (b) counts only neutral stable decay products. Figure (c) considers all stable decay products.

Figure 12: Comparison of \(b\)-jet fragmentation using information from the generatorsâ€™ truth records. Figure (a) shows the distribution of the mean number of truth jet constituents as a function of the jet \(p_{T}\). Figure (b) shows the distribution of the mean of the quantity \(R_{0.8}\) as a function of the truth jet \(p_{T}\). \(R_{0.8}\) is defined as the radius of the cone in the \(\eta-\phi\) plane which is centered on the truth jet axis and contains \(80\%\) of the total jet energy. For both plots, truth jets are reconstructed with the anti-\(k_{T}\) algorithm with a radius parameter of \(R=0.4\) starting from all stable particles in the truth record of the generator. The error bars correspond to the standard deviation of the distribution.

Figure 13: Comparison of \(b\)-jet fragmentation at reconstructed level. Figure (a) shows the distribution of the mean number of tracks associated to a reconstructed particle flow jet following the procedure outlined in Section 5, as a function of the jet \(p_{T}\). Figure (b) gives the distribution of the mean number of tracks from which an inclusive secondary vertex is built by the SV1 algorithm, as a function of the jet \(p_{T}\). For both plots, the error bars correspond to the standard deviation of the distribution.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003 (cited. on pp. 2, 3).
* [2] L. Evans and P. Bryant, _LHC Machine_, JINST **3** (2008) S08001 (cited. on p. 2).
* [3] ATLAS Collaboration, _ATLAS \(b\)-jet identification performance and efficiency measurement with \(t\bar{t}\) events in \(pp\) collisions at \(\sqrt{s}=13\) TeV_, Eur. Phys. J. C **79** (2019) 970, arXiv: 1907.05120 [hep-ex] (cited. on pp. 2, 11).
* [4] ATLAS Collaboration, _Search for new resonances in mass distributions of jet pairs using \(139\,\text{fb}^{-1}\) of \(pp\) collisions at \(\sqrt{s}=13\) TeV with the ATLAS detector_, JHEP **03** (2020) 145, arXiv: 1910.08447 [hep-ex] (cited. on p. 2).
* [5] ATLAS Collaboration, _Performance of the ATLAS track reconstruction algorithms in dense environments in LHC Run 2_, Eur. Phys. J. C **77** (2017) 673, arXiv: 1704.07983 [hep-ex] (cited. on p. 3).
* [6] ATLAS Collaboration, _Jet reconstruction and performance using particle flow with the ATLAS Detector_, Eur. Phys. J. C **77** (2017) 466, arXiv: 1703.10485 [hep-ex] (cited. on pp. 3, 7, 9).
* [7] ATLAS Collaboration, _Performance of b-jet identification in the ATLAS experiment_, JINST **11** (2016) P04008, arXiv: 1512.01094 [hep-ex] (cited. on p. 3).
* [8] ATLAS Collaboration, _Identification of Jets Containing b-Hadrons with Recurrent Neural Networks at the ATLAS Experiment_, ATL-PHYS-PUB-2017-003, 2017, url: [https://cds.cern.ch/record/2255226](https://cds.cern.ch/record/2255226) (cited. on pp. 3, 17).
* [9] ATLAS Collaboration, _Optimisation and performance studies of the ATLAS b-tagging algorithms for the 2017-18 LHC run_, ATL-PHYS-PUB-2017-013, 2017, url: [https://cds.cern.ch/record/2273281](https://cds.cern.ch/record/2273281) (cited. on pp. 3, 6).
* [10] ATLAS Collaboration, _Expected performance of the 2019 ATLAS b-taggers_, 2019, url: [http://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PLOTS/FTAG-2019-005/](http://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PLOTS/FTAG-2019-005/) (cited. on p. 3).
* [11] ATLAS Collaboration, _Flavour-tagging efficiency corrections for the 2019 ATLAS PFlow jet b-taggers with the full LHC Run II dataset_, 2020, url: [http://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PLOTS/FTAG-2020-001/](http://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/PLOTS/FTAG-2020-001/) (cited. on pp. 3, 4).
* [12] ATLAS Collaboration, _Optimisation of the smoothing of b-jet identification efficiency and mistag rate simulation-to-data scale factors in ATLAS_, ATL-PHYS-PUB-2020-004, 2020, url: [https://cds.cern.ch/record/2710598](https://cds.cern.ch/record/2710598) (cited. on pp. 4, 11).
* [13] T. Sjostrand et al., _An introduction to PYTHIA 8.2_, Comput. Phys. Commun. **191** (2015) 159, arXiv: 1410.3012 [hep-ph] (cited. on pp. 6, 7).
* [14] R. D. Ball et al., _Parton distributions with LHC data_, Nucl. Phys. B **867** (2013) 244, arXiv: 1207.1303 [hep-ph] (cited. on pp. 6, 7).
* [15] ATLAS Collaboration, _ATLAS Pythia 8 tunes to 7 TeV data_, ATL-PHYS-PUB-2014-021, 2014, url: [https://cds.cern.ch/record/1966419](https://cds.cern.ch/record/1966419) (cited. on pp. 6, 7).