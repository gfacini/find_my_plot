Simulation of the full noise pattern in Tile Calorimeter Front End electronics: a phenomenological approach to coherent effects

F. Spano

_Newis Laboratories_

Columbia University in the City of New York

Irvington NY 10533 \({}^{1)}\)

###### Abstract

The noise pattern in the high gain read-out of the TileCal front-end electronics is simulated including correlations. A basic comparison with test beam data is carried out. The limits and potentialities of the current approach are discussed. A preliminary extrapolation to simulated QCD di-jet events implies that, on average, the correlated noise component can increase TileCal noise contribution to the jet energy by about 87% on average, while the total calorimeters noise is expected to remain between 2% to 4% of the total jet energy. An initial strategy for analysing and incorporating these effects during LHC data-taking, particularly in the early phase, is also outlined.

Introduction: why coherent effects?

In signal processing noise is defined as data that is not used to transmit useful information [1]. In the case of electronic circuits, current (voltage) fluctuations deriving from thermal motion or charge granularity represent the ultimate limit to the knowledge of the signal [2]. The relations between such fluctuations play a role when the sum of many signals needs to be calculated.

The signal extraction of any high energy physics detector is implemented by a complex electronic read-out set-up [3]. The signal (charge, light) is usually transformed into analog form, amplified, shaped and digitized. Understanding the noise properties of the read-out chain allows to determine the limits to the precision of the measurement. Most of the times many sub-units are involved in one measurement: correlations between noise in sub-units play an important role when many sub-units' signals are added together. Particularly, correlations between cells signals will affect both jet algorithms and missing energy calculations as they involve a large number of cells in the calorimeters.

Introducing the noise pattern simulation in the signal reconstruction allows to incorporate its impact on physics measurements. This paper aims at describing a full noise pattern simulation description for the ATLAS hadronic Tile calorimeter.

In section 2 the Tile Calorimeter front-end electronics and signal reconstruction are succinctly described. The simulation approach, its implementation and limitations are formulated and discussed in section 3. Its validation and the results are then outlined in section 4. Section 5 discusses a figure of merit for rapid and robust assessment of coherent noise effects. It also provides an initial evaluation of the order of magnitude of coherent effects in TileCal and it partially extrapolates the values measured in the combined test beam to fully simulated QCD di-jet events measured by ATLAS at LHC. Section 6 gives the instructions for usage in the ATLAS Athena software framework. Prospects, future possible developments and extensions are finally discussed in section 7.

## 2 The Tile Calorimeter

The Tile Calorimeter for the ATLAS detector (TileCal) [4] is a cylindrical iron-scintillator sampling calorimeter aimed at providing information mainly on strongly interacting particles produced in 14 TeV pp collisions at the Large Hadron Collider: it will measure energy and direction of hadrons, derive missing energy, help in particle identification (muons). Iron and scintillator tiles alternate in the detector structure. Light from each scintillating tile is viewed by two wavelength shifting fibers. Fibers are bundled together to form 0.1 \(\times\) 0.1 cells in \(\eta\times\phi\) in three radial samplings. Each cell is read out by two photomultiplier tubes (PMTs), one for each side of the tile 2). The approximately 5000 cells are grouped in 0.1 \(\phi\) units (modules) which constitute three sub-cylinders whose axis is along the beam direction z (one central barrel section and two symmetric extended barrels). Each PMT analog signal is extracted and processed by fast and low noise read-out front-end electronics placed on the detector and transmitted in the form of light via optical cables to off-detector back-end electronics. The data is then processed through computer farms, passed through trigger selection, combined with the information from other sub-detectors and appropriately stored [5].

Footnote 2): So one cell corresponds to two read-out channels.

Coherence effects in the front-end electronics are mainly related to hardware features like cross-talk between channels due to common signals (power and/or timing, trigger and control) or electromagnetic field emissions. Such effects result in variation of the standard deviation of empty events' signal (pedestal) both for individual channels and their sum. Such variations could directly affect jet energy resolution [6]. In addition a bias in hadron energy scale (and consequently in jet energy scale) could also ensue due the sign and size of correlations among cells in the cluster energy determination.

### Tile Front End electronics in a nutshell

The TileCal Front end electronics (structure, requirements and performance) is described in detail elsewhere [7, 8, 9]. Here only the features are mentioned that are relevant for the analysis at hand.

Each barrel (extended barrel) module contains 90 (32) PMTs. The PMTs are placed in metallic cases called drawers. A barrel module accommodates two drawers and each drawer has space for 48 PMTs (3 are empty). An extended barrel module hosts only one drawer which can contains 38 PMTs (6 slots are empty). For each PMT, the analog signal is shaped by a printed circuit board called 3-in-1 card 3).

Footnote 3): Each 3-in-1 card also provides charge injection system for read-out calibration, analog signal for Level 1 Trigger and integrated charge signal for monitoring also of minimum-bias event current.

A system of four motherboards delivers both power and individual control signals to all the cards by a digital bus encased in a flat cable: each motherboard services up to twelve 3-in-1 cards. The control logic signal for a module (including timing and trigger information) is received by a unique interface card and delivered to the one (out of 4) control motherboard by LVDS signal.

Each 3-in-1 card outputs two differential fast analog signals with a relative gain of sixty-four. They are sent to one of eight digitizer boards over shielded-pair cable. A PMT signal will be transmitted with gain one or one over sixty-four depending on its amplitude. One digitizer will read up to six 3-in-1 cards and will receive trigger and control signals directly from the interface card via LVDS signal. The digitized data are lumped into three channels groups; data from each group is stored in a custom designed chip before being passed via optical link to the interface card and being shipped out to the back-end electronics via two (redundant) duplicate optical fiber links.

For each drawer one DC-to-DC converter turns a 200 V power line into 8 voltage levels (from 3.3. to 15 V) powering the high voltage distribution system for the PMTs and the front end electronics (both analog and digital components). Groups of four drawers receive power from the same 200 V power line.

The few last 4) PMTs in a drawer are equipped with additional resistors called "noise killers".

Footnote 4): PMTs are ordered along z, starting at z = 0.

Each cell grouping plays a role in noise coherence: as hadrons showers involve many cells it is important to understand noise for both individual channels and their sum.

### Signal reconstruction in TileCal: data ad simulation

In TileCal more than one method is used to convert the digitized output from each channel in GeV. The various reconstruction methods are described in [10, 11].

The current offline reconstruction scheme uses a fit of the digitized pulse shape (see section 2.2 of [10]) to a numerical description of the expected shape: the amplitude, the pedestal and the position of the peak (time of the data in the shape reference frame) are parameters of the fit. For very small (pedestal-like) signals the fit is downgraded to a two parameter fit. Possible improvements to this procedure are under consideration [12].The pedestal-subtracted amplitude is then converted from ADC counts to charge (pC) by applying channel specific calibration constants determined by recording the front end electronics response to charge injection scanning the full expected signal dynamic range(section 3.2 of [10] and [13]). The final conversion from pC to GeV is obtained with another set of channel specific calibration constants determined by analysis of the calorimeter response to test beam electrons(section 4.2 of [10]). The energy reconstruction scheme to be used in the Read Out Drivers will instead use an optimal filtering coefficients technique [11].

The simulation of particles' interactions with the detector is carried out by GEANT4 [14] using the full detector description provided by the ATLAS GeoModel framework [15]. GEANT4 provides energy depositions in the Tile active material (hits). Saturation effects in the scintillator (Birks law) and energy smearing due to Poisson fluctuations in number of photoelectrons at a given PMT are taken into account [16]. The corrected energy is then convoluted with the measured gain-dependent PMT pulseshape digitized in 25 ns bins as in real ATLAS data-taking. Digitized shapes for both gains for each PMT are obtained to be able to simulate calibration runs too. Each PMT output i.e. each channel is simulated.

Noise is introduced in the description by adding a random variable to each simulated sample. The measured signal in channel k reported in sample i for a given gain is defined as:

\[S_{ik}^{meas}=S_{ik}+N_{ik} \tag{1}\]

where \(S_{ik}\) is the signal in the i\({}^{\rm th}\) sample resulting from the simulated response to the energy deposited by an incoming particle in channel k and \(N_{ik}\) is the noise associated to i\({}^{mathrmth}\) sample in channel k. The final digitized pulse shape is then passed through the same reconstruction algorithm as data.

As of the moment when this document is written, the evolution of the Tile digitization and reconstruction software is presented in [17, 18, 19].

Noise for a given channel is defined as the standard deviation of the signal in "pedestal events" i.e. empty events where no physics signal is expected in the calorimeter (for the combined test beam, the detector is on, but no particles are shot in). No detailed frequency analysis is usually carried out for the digital electronics, but some characteristic quantities are used to estimate the noise properties.

For a given channel, the signal in a pedestal event is sampled nine or seven times; the standard deviation of the samples is averaged over all events and called "high frequency noise". Similarly, for a given channel, the value of the first of the seven (or nine) samples is recorded for all pedestal events: the standard deviation of this distribution is called the "low frequecy noise". In fact both high and low frequency noise span an interval of frequencies.

## 3 TileCal full noise pattern simulation: a phenomenological approach

As it was mentioned in section 2, the sources of possible correlation effects are diverse. For this reason there is no unique model capable of describing all effects from first principles. It is then advisable to use a phenomenological approach: incorporate the description of the signal correlation in the simulation. Such description had better be at a sufficiently high level in the signal read out-reconstruction chain to avoid having to simulate or model causes for correlations. The level also has to be sufficiently low to propagate the effect of correlations to all subsequent steps of the energy reconstruction and to take into account its interaction with other (possible) correlations.

The solution that meets these requirements is to simulate correlations between channel signals at the digitization level according to a given (possible measured) covariance matrix. Digitized channel signals are at the end of the front-end read-out chain, but they are produced before the software signal reconstruction and application of calibration constants.

### The algorithm

The correlation between channels is introduced by generating noise variables \(N_{ik}\) that are correlated according to a given covariance matrix \(C(i,j)\) where i and j run over the number of channels involve. The definition of \(C(i,j)\) is not unique: it will depend on how the digits are to be correlated and on how many channels are involved 5.

Footnote 5: Different values are set for the deskewed clock provided by the accelerator Timing Trigger and Control in the case of physics and calibration events (charge injection, laser injection): different covariance matrices will obtained for the different event types. The analysis reported here is not related to calibration events.

The following assumptions are made:* Sample-to-sample correlation within the same channel are assumed to be absent. Correlations between different channels are introduced only between samples with the same sample time in the trigger selected sample sequence.
* Correlations are introduced only between channels in the same TileCal drawer. No inter-drawer correlations are considered.
* Correlations are introduced only between signals with the same gain. No inter-gain correlations are considered.
* For a given channel all digitized samples with the same sample time are considered when building the covariance matrix. All noise frequencies are included in the calculation. Low frequency noise (as defined in section 2.2) should not play a role in the energy determination as the pedestal of the signal is subtracted by the reconstruction algorithm. Low frequency noise inclusion allows to study its impact at the digitization level.

The covariance matrix of an n-dimensional set of variables \(X\)=(\(x_{1}\),...\(x_{n}\)) is generally defined as

\[C(i,j)=<x_{i}x_{j}>-<x_{i}><x_{j}> \tag{2}\]

where the symbol \(<>\) indicates average values.

According to our assumptions the covariance matrix between the signals of the modules in a channels is then defined as:

\[C(i,j)=<N_{i}N_{j}>-<N_{i}><N_{j}> \tag{3}\]

where

\[<N_{i}N_{j}>=\frac{1}{N_{samp}N_{ev}}(\sum_{l=1}^{N_{samp}}\sum_{p=1}^{N_{ev}} N_{li}^{p}N_{lj}^{p}) \tag{4}\]

and

\[<N_{i}>=(\frac{1}{N_{samp}N_{ev}}\sum_{l=1}^{N_{samp}}\sum_{p=1}^{N_{ev}}N_{li} ^{p}) \tag{5}\]

In equations 4 and 5, \(N_{li}^{p}\) is the l\({}^{\rm th}\) digitized signal sample of the i\({}^{th}\) channel in the p\({}^{\rm th}\)_pedestal_ event, \(N_{samp}\) is the number of digitized samples and \(N_{ev}\) is the number of pedestal events, i and j both belong to 1,...,\(N_{chan}\) where \(N_{chan}\) is the number of channels in a module. Particularly \(\sqrt{(}C(i,i))\) is the noise in the i\({}^{\rm th}\) channel.

Given the covariance matrix, a set of \(N_{chan}\) accordingly correlated variables can be constructed from \(N_{chan}\) independent Gaussian Normal variables, the latter ones being extremely easy to generate [20]. This can be shown as follows.

The general law of propagation of (small) errors [21] states that the following matrix multiplication equality holds:

\[Cov(Y)=SCov(X)S^{T} \tag{6}\]

where \(Cov(Y)\) and \(Cov(X)\) are the covariance matrices of N-dimensional sets of variables \(Y\) and \(X\) respectively and \(S\) is the N-dimensional matrix whose components are \(S(i,j)=dY(i)/dX(j)\). Let's now assume that the \(Y(i)\)s are linear combinations of the \(X(i)\)s and that the \(X(i)\)s are Gaussian Normal variables i.e.:

\[Y(i)=\sum_{k=1}^{N}A(i,k)X(k) \tag{7}\]

\[X(k)=N(0,1) \tag{8}\]

It follows that:

\[S(i,j)=dY(i)/dX(j)=A(i,j) \tag{9}\] \[Cov(X)=1 \tag{10}\]

Consequently one has:

\[Cov(Y)=SS^{T}=AA^{T} \tag{11}\]

So a linear combination of normal Gaussian variables (equations 7, 8) that fulfill relation 11 will produce correlated variables according to the requested covariance (equation 6).

The N-dimensional matrix \(A\) satisfying equation 11 is called the Cholesky decomposition of matrix \(Cov(Y)\)[22]. This is proven to exist for any symmetric, positive definite matrix [23].

The implementation in the simulation follows the definition of the covariance matrix in 3. For each given event, \(N_{samp}\) vectors of dimension \(N_{chan}\) are generated. The j\({}^{\text{th}}\) elements of the vectors are drawn from to the same Gaussian population with mean zero and unitary variance i.e.if the vectors are (\(w_{1}(1)\),....., \(w_{1}(N_{chan})\)),.....,(\(w_{N_{samp}}(1)\),..., \(w_{N_{samp}}(N_{chan})\)), the digits \(w_{1}(j)\),...., \(w_{N_{samp}}(j)\) are extracted from the same normal Gaussian distribution. The \(N_{chan}\) Gaussian distributions are independent.

The noise digits to be added to the signal in equation 1 are then obtained as follows:

\[N_{pl}=\sum_{k=1}^{N_{chan}}A(k,l)w_{p}(k) \tag{12}\]

where \(p\) is the sample number (i.e. it runs over 1,..,\(N_{samp}\)), \(l\) is the channel number (i.e. it belongs to 1,..,\(N_{chan}\)) and \(A\) is the Cholesky decomposition matrix defined in equation 11.

Such procedure is carried out for each separate gain level: two covariance matrices are produced correlating the channels' signals obtained with the same gain.

### The limitations

The hypotheses underlying the algorithm also determine its limitations.

The fact that channel-to-channel correlations affect only same order samples relies on the correct relative timing of the signal in different channels. In a drawer correlations can be of three types:

* between different samples of the same channel: autocorrelation matrix
* between same-order samples of different channels: actually used
* between different samples of different channels:The absence of simulated sample-to-sample correlation within the same channel assumes that the autocorrelation matrix in a given channel is diagonal: sample k and sample m of the same channel are considered uncorrelated. This assumption can have an impact on the calculation of optimal filtering coefficients in the reconstruction. Past studies from test beam (albeit with different power supply system) [24] show that the measured auto-correlation matrix has relatively small non-diagonal terms of the order of few percent. Differences in optimal filter coefficients (OFCs) between real and diagonal correlation matrix are small [11]. A diagonal matrix is probably reasonable for low luminosity running. Non-diagonal terms can become important in the case of pile-up noise due to high luminosity environment ( even though initial studies imply their effect is small [17, 25]). In such a case the approximation might not be tenable anymore.

Correlations between different samples in different channels were neither investigated nor simulated. These would be sensitive to possible time-delayed noise. The assumption is that such effects are small.

The absence of inter-gain correlations imposes the need to consider what to do when, in a module, there is a mixed population of channels using high gain and low gain. At present each channel is treated as if all the others were using the same gain. In principle there is no reason for the covariance matrix to be the same in the case of mixed gain as the one for a single gain.

Inter-drawer correlations are expected to be small compared to intra-drawer ones 6 as there are less common signals between drawers than one has within a drawer itself. Any deviation from uncorrelated drawers can play an additional role in jets' energy reconstruction where a large number of channels from different drawers are illuminated.

Footnote 6: _Inter-drawer_ correlations are the correlations between signals from channels belonging to different drawers while _intra-drawer_ correlations are related to those between signals from channels of the same drawer.

Most of these effects are expected to be small: as one can see in the following sections the Monte Carlo agreement with the data is already rather good without their inclusion. In comparison the present simulation scenario marks a sizeable change in the noise description with respect to the uniform noise assumption. Before investing additional effort into taking them into account an estimate or measurement of their size should be obtained.

## 4 Simulation Validation Results

The simulation algorithm outlined in section 3.1 was implemented in the ATLAS software. The basic steps for its validation are reported below:

* extract correlation matrix from a pedestal data sample
* simulate given pedestal events according to data correlation matrix
* compare significant quantities to confirm data-Monte Carlo agreement

### Data and Monte Carlo samples

The correlation matrix for one drawer (48 channels) was extracted by a data sample of 2595 empty (pedestal) events (run 61270). These events collected in September 2006 from module LBA52 7 instrumental in the ATLAS cavern [26].

Footnote 7: LB stands for Long Barrel.

A Monte Carlo sample of 8000 empty events was generated using the "geantino scan" technique [27] in the combined test beam setup. The analysis was then focused on the high gain response of channels in one module 8 Monte Carlo simulated pedestal events sample the pulse shape 9 times while data use 7 samples. This difference is marginal in our analysis as standard deviation calculation for the while frequency range lumps all the samples from all the events of a single channel in one histogram. Each element of the covariance matrix has 72000 entries for the Monte Carlo sample and about 18000 entries for the data. In addition it was necessary to make sure that the full analysis compared results according to the PMT order rather than the channel one. The two orderings are different: they are the same for the first 24 channels, then for the following ones, it is necessary to invert the order of PMTs in groups of three to obtain the channel order 9). The algorithm for noise simulation was then applied to the digitization of the simulated events. The C(i,j) matrix in formula 11 was obtained from the data.

Footnote 9): For instance PMT triplet {25,26,277} corresponds to channels {27,26,25}.

### Results

The Monte Carlo digitized sample was then compared to the data in a variety of ways.

The first step was to verify that the digitized samples covariance matrix was effectively reproduced. Figure 1 shows the two covariance matrices for data and Monte Carlo. The distribution of the element-by-element ratio of the covariance matrices is reported in figure 2. The (upper) full distribution shows a few ratios at (mainly) large negative values amounting to about 0.8% of the total. If these few ratios are discarded the (lower) core distribution shows a mean of 1.002 \(\pm\) 0.006 with an standard deviation (RMS) of 0.335 \(\pm\) 0.005.

In order to investigate the channels with large deviations from unity in data to Monte Carlo ratio, a two-dimensional colour plot of the data to Monte Carlo ratio is shown in figure 3. Large values are observed in correlations between physically distant channels whose correlations are expected to be small.

Finally it is instructive to plot the data to Monte Carlo ratio versus the magnitude of the covariance matrix element in the Monte Carlo in figure 4. The full plot shows that the very large ratios are related to covariance elements consistent with zero where fluctuations on the value can cause large shift in the ratio. The zoom on the core region confirms that a small number of covariance matrix elements (about 2.8% of the total) lie in the tails and they all result from the ratio of two very small numbers.

The particular features of the noise distribution can also be investigated.

Figure 5 shows the distribution of the square root of the covariance matrix diagonal elements (upper plot) also as a function of the channel number (lower plot) for data and Monte Carlo simulation: the agreement is good 10). This is quantitatively confirmed by the distribution of the data to Monte Carlo ratio for the same values shown in the upper plot of figure 6 and also plotted as a function of channel number in the lower plot. The average systematic shift shown in the upper plot of figure 6 amounts to 2.7% of the noise value corresponding to about 0.04 ADC counts 11).

Footnote 10): The LBA52 drawer is part of the TileCal barrel and features 48 read-out channels, 45 of which correspond to PMts.Non instrumented channels are 31,32 and 44.

Footnote 11): The average shift is 2% if non instrumented channels are not considered i.e.0.03 ADC counts.

A similar analysis to the diagonal covariance elements can be obtained by checking the reproducibility of the high frequency noise (as defined in section 2.2). The noise distribution is shown in the upper plot of figure 7, while the lower plots illustrates its dependence on the channel number. The shape is well modelled, with a systematic shift that is clearly quantified by the data to Monte Carlo ratio shown in figure 8: the upper plot illustrates the ratio distribution, the lower one the ratio dependence on the channel number. The size of the systematic shift is about 5.3% corresponding to 0.07 ADC counts 12).

Footnote 12): If non instrumented channels are considered,the average shift is 3.3% i.e.0.02 ADC counts.

The systematic shifts between data and Monte Carlo present in both total diagonal and high frequency noise are small effects compared to the typical noise RMS values over the channels of 0.26 ADC counts in data (0.25 in Monte Carlo) for diagonal noise and 0.25 (0.24 ) for high frequency noise (see figures 5 and 7). It would be anyhow useful to investigate and clarify their origin.

Figure 1: Covariance matrix for Monte Carlo simulated pedestal events (above) and data pedestal events in run 61270 (below). The values are in \((ADCcounts)^{2}\)..

Figure 2: Data to Monte Carlo ratio of covariance matrix elements distribution: full range (above) and zoom into the core (below).

Figure 3: Data to Monte Carlo ratio of covariance matrix elements: 2-dimensional grid illustrates element-by-element ratio. Ratios in the (-2,4) interval are shown in the upper plot while larger (or smaller) ratios are shown in the lower plot.

Figure 4: Data to Monte Carlo ratio of covariance matrix elements vs the magnitude of covariance matrix elements (upper plot) and a zoom of the same distribution on the region where most of the events lie (lower plot)

Figure 5: The distribution of the square root of covariance matrix diagonal elements for data (black solid line) and Monte Carlo (red dashed line) is shown in the upper plot; the same values are plotted below as a function of channel number in data (black squares) and Monte Carlo (red triangles). Channels 31, 32 and 44 are not instrumented.

Figure 6: Distribution of data to Monte Carlo ratio of the square root of covariance matrix diagonal elements(upper plot), also as a function of channel number (lower plot). Channel 31, 32 and 44 are not instrumented.

Figure 7: High frequency noise distribution for data (black solid line) and Monte Carlo (red dashed line) is shown in the upper plot. The same values are plotted below as a function of channel number in data (black squares) and Monte Carlo (red triangles). Channels 31,32 and 44 are not instrumented.

Figure 8: Data to Monte Carlo ratio of high frequency noise distribution (upper plot) and as a function of channel number (lower plot).Channels 31, 32 and 44 are not instrumented.

The difference between the full noise RMS and the high frequency RMS is plotted in figure 9 for both data and Monte Carlo: the distribution is shown in the upper plot while the lower one illustrates the values as a function channel number. The small size of the difference (on average 0.07 ADC counts in data and 0.04 in Monte Carlo) shows that the noise behaviour is dominated by the high frequency component. The average difference between data and Monte Carlo is small compared to the average noise (0.3 ADC counts on average with a maximum of 0.11 ADC counts vs 1.37 ADC counts). Understanding the separate biases in full diagonal and high frequency noise is the key for bridging the gap between the two shapes. 13

Footnote 13: Particularly one can notice that the high frequency component slowly decreases with increasing channel number, up to a sharp drop in the channels that are on the opposite side to the patch panel. Such effect is not fully captured by the simulation which is devised mainly to reproduce the full diagonal noise and not necessarily its frequency break-up.

## 5 Importance of coherence effects

The covariance matrix provides full information about the noise profile of the set of channels it is constructed from. Anyhow, especially in the beginning of ATLAS data taking, it is important to provide a single variable that is:

* quantitatively and concisely sensitive to coherent effects
* simple to visualize
* robust

Such a figure of merit can be used to provide a fast assessment of the noise pattern and it can also be useful for monitoring purposes.

### A quantitative estimate for coherent noise effects

The present analysis exploits a different variable than those those used in ATLAS in the past (see the Appendix for a brief overview); its use is established for the D0 detector at the Tevatron [28].

The \(R\) variable is defined as:

\[R=<C_{d}>/<C_{nd}> \tag{13}\]

where \(<C_{d}>\) and \(<C_{nd}>\) are the average diagonal and non-diagonal term of the covariance matrix and they are defined as follows:

\[<C_{d}>=\frac{1}{N}\sum_{l=1}^{N}C(i,i) \tag{14}\]

\[<C_{nd}>=\frac{1}{N(N-1)}\sum_{i=1}^{N}\sum_{j=1,j\neq i}^{N}C(i,j) \tag{15}\]

where N is the covariance matrix dimension i.e. the total number of channels under consideration.

The ratio \(R\) has a simple interpretation: it is the number of channels to be summed in a drawer so that the average non-diagonal contribution of the covariance matrix to the uncertainty on the sum of all channels is equal to the average diagonal contribution.

Figure 9: Difference between cov. matrix diagonal RMS and high frequency RMS for Monte Carlo simulated pedestal events in data (black solid line) and Monte Carlo (red dashed line) is shown in the upper plot. The same values are plotted below as a function of channel number in data (black squares) and Monte Carlo (red triangles)

In fact, given a set of M channels, error propagation gives:

\[\sigma^{2}(\sum{Mchannels})=\sum_{i=1}^{M}C(i,i)+\sum_{i=1}^{M}\sum_{j=1,j\neq i}^ {M}C(i,j) \tag{16}\]

Using formulas 14 and 15 one can re-write formula 16 as:

\[\sigma^{2}(\sum{Mchannels})=M<C_{d}>+M(M-1)<C_{nd}> \tag{17}\]

Requiring the diagonal and non-diagonal terms to have the same importance one obtains:

\[\frac{M<C_{d}>}{M(M-1)<C_{nd}>}=1 \tag{18}\]

i.e. this is an equation for M whose solution is

\[M-1=<C_{d}>/<C_{nd}>=R \tag{19}\]

If there were no coherent effects the covariance matrix would be diagonal and even the size of the diagonal elements would be different.

The ratio \(R\) is then

* one number concisely quantifying the relative size of coherent effects
* very simple to visualize and interpret
* independent of the order of summed channels channels, differently from most of the methods outlined in Appendix 8

While the definition of \(R\) is general, it should be noted that when inter-drawer correlations are neglected the size of the effect is determined by the number of channels in one drawer and the \(R\) value.

In fact under such an assumption the total noise of \(N^{ch}\) channels belonging to more than one drawer can be written as

\[\sigma^{2}(N^{ch})=\sigma^{2}(N_{D})+\sigma^{2}(N_{Res}) \tag{20}\]

where

* \(\sigma^{2}(N_{D})\) is the total noise of all those channels that make up exactly \(N_{D}\) drawers
* \(\sigma^{2}(N_{Res})\) is the total noise of the \(N_{Res}\) channels that do not belong to any of the previous \(N_{D}\) drawers, but do not form a full drawer. In general these channels will belong to different drawers.

Using formulas 17 and 19, \(\sigma^{2}(N_{D})\) is defined as:

\[\sigma^{2}(N_{D})=\sum_{k=1}^{N_{D}}\sigma_{k}^{2}=\sum_{k=1}^{N_ {D}}(N_{k}^{chan}<C_{d}>_{k}+(N_{k}^{chan})(N_{k}^{chan}-1)<C_{d}>_{k}/R_{k}) \tag{21}\] \[=\sum_{k=1}^{N_{D}}N_{k}^{chan}<C_{d}>_{k}(1+(N_{k}^{chan}-1)/R_{k})\]where \(\sigma_{k}^{2}\) is the total noise for the \(k^{th}\) drawer. The variables \(N_{k}^{chan}\), \(R_{k}\) and \(<C_{d}>_{k}\) are the number of channels, the value of \(R\) and the average diagonal covariance element for the kth drawer.

In a similar way \(\sigma^{2}(N_{Res})\) is defined as:

\[\sigma^{2}(N_{Res})=\sum_{p}^{N_{Des}}N_{p}^{chan}<C_{d}>_{p}(1+(N _{p}^{chan}-1)/R_{p}) \tag{22}\] \[\sum_{p}^{N_{Des}}N_{p}^{chan}=N^{Res}\]

where \(N_{Des}\) is the number of drawers over which the \(N_{res}\) channels are spread and \(N_{p}^{chan}\) is the number of \(N_{res}\) channels belonging to the pth drawer. Similarly to formula 21, \(R_{p}\) and \(<C_{d}>_{p}\) are the \(R\) and \(<C_{d}>\) values for the pth drawer.

When deriving an order of magnitude for coherent effects, it is worth considering the case of identical drawers. In that case in formulas 21 and 22 one has to set \(N_{k}^{chan}\) = \(N^{chan}\), \(<C_{d}>_{k}\) = \(<C_{d}>_{p}\) = \(<C_{d}>\) and \(R_{k}=R_{p}\) = \(R\), thus resulting in:

\[\sigma^{2}_{IdDraw}(N_{D})=N_{D}N^{chan}<C_{d}>(1+(N^{chan}-1)/R) \tag{23}\] \[\sigma^{2}_{IdDraw}(N_{Res})=<C_{d}>\sum_{p}^{N_{DRes}}N_{p}^{chan }(1+(N_{p}^{chan}-1)/R) \tag{24}\]

In the absence of correlations, formulas 21 and 22 are re-derived by setting \(<C_{nd}>\) = 0 in formula 17, consequently formula 20 is changed into:

\[\sigma^{2}_{IdDrawNoCor}(N^{ch})=N^{ch}<C_{d}> \tag{25}\]

The percentage variation in noise due to coherent effects with respect to their absence is given by

\[PNoiseChange=1-\sigma_{IdDraw}(N^{ch})/\sigma_{IdDrawNoCor}(N^{ ch})= \tag{26}\] \[1-\sqrt{(\sigma^{2}_{IdDraw}(N_{D})+\sigma^{2}_{IdDraw}(N_{ Res}))/\sigma^{2}_{IdDrawNoCor}(N^{ch})}\]

where one should use formulas 23, 24 and 25 for the simplified identical drawers case.

There are two additional possible simplifying assumptions to be added to the identical drawers case:

* no residual channels are present i.e. \(N_{res}\) = 0. In this case \(N_{D}N^{chan}\) = \(N^{ch}\) and \(PNoiseChange\) = \(\sqrt{1+(N^{chan}-1)/R}\).
* all the residual channels belong to one single drawer, so \(\sigma^{2}_{IdDraw}(N_{Res})\) = \(<C_{d}>N^{chan}(1+(N^{chan}-1)/R)\) and \[PNoiseChange=1-\sqrt{(N_{D}N^{chan}(1+(N^{chan}-1)/R)+N^{Res}(1+(N^{Res}-1)/R)) /N^{ch}}\] (27)

If inter-drawer correlation play a role the values mentioned above can change depending on the sign of the correlations.

### Measuring coherent effects: from test beam data to a snapshot of simulated jets in collisions

The values for \(<C_{d}>\), \(<C_{nd}>\) and \(R\) for the data set used in the present analysis are reported in table 1. Good agreement between data and simulation expectation is observed.

A basic strategy to assess the expected effect of coherent noise before and during data taking is outlined in section 7. Coherent effects are expected to vary the amount of noise in typical jet with respect to the no-correlation scenario. More importantly the size and, possibly, even the average number of clusters can change with an impact on jet multiplicity. Possible biases to the jet energy scale due to non-Gaussian effects are not easily studied, as the simulation assumes Gaussian noise, but they should be borne in mind when analyzing the first data at LHC.

In what follows a preliminary assessment of the order of magnitude of the effect is provided for jets reconstructed with the ATLAS detector in a typical sample of high cross section physics events at the LHC. An estimate of the noise variation is derived by comparing the measured \(R\) value with the expected average number of TileCal cells that are included in each jet for fully simulated QCD di-jet events. In order to extract an order of magnitude for this variation, it is assumed that the correlations at the ADC level are unchanged when deriving cells' energies.

Three samples of fully simulated QCD di-jet events [29] were used: they were reconstructed with the ATLAS detector from proton-proton collisions at 14 TeV. The properties of the three samples are reported in table 2: their names (to be used in what follows), the interval of transverse momentum (\(p_{T}\) ) of the hard scattered partons used in the generation, their size. 14). The Athena software version 11 was used for event generation. Simulation and digitization were performed with version 12. Finally, reconstruction was performed with version 13.0.40. The detector response was simulated by GEANT4. Jets are reconstructed with a cone algorithm [30] from locally calibrated three-dimensional topological clusters [31]. The cone aperture dR in (\(\eta\),\(\phi\)) is chosen to be 0.4.

Footnote 14): The J2 sample would have covered the the interval from 35 to 70 GeV in scattered parton \(p_{T}\), but it was not available in the appropriate format at the time of the analysis.

Only jets with \(|\eta_{\rm jet}|<1.3\) are considered so as to deposit energy in both TileCal and the ATLAS electromagnetic liquid argon calorimeter (LAr). No additional cuts are applied. The number of jets selected in the J1, J3 and J4 samples are shown in table 2.

The expected number of TileCal cells included in a selected jet is shown in the upper plot of figure 10 for the three different jet samples. The lower plot of figure 10 shows the same distributions for LAr cells. It should be noted that it is possible for a jet to be formed only by LAr cells: the zero cells bin is filled in the Tile plot for all samples, but the LAr one is always empty. In addition the number of jets with zero Tile cells increases with decreasing jet \(p_{T}\) showing that there are more chances for a low \(p_{T}\) jet to be

\begin{table}
\begin{tabular}{|c|c c|} \hline  & Data & Monte Carlo \\ \(<C_{d}>\) (ADCcounts)\({}^{2}\) & 1.97 & 2.05 \\ \(<C_{nd}>\) (ADCcounts)\({}^{2}\) & 0.12 & 0.12 \\ \hline \(R\) & 16.9 & 17.7 \\ \hline \end{tabular}
\end{table}
Table 1: Average diagonal (C(i,i)) and non-diagonal (C(i,j)) covariance matrix elements for data and Monte Carlo samples described in section 4.1 and their ratio \(R\), indicative of the magnitude of coherent effects (see text).

\begin{table}
\begin{tabular}{|c|c c|} \hline Type & \(P_{T}^{gen}\) interval (GeV) & No. of events & No. of jets with \(|\eta_{\rm jet}|<1.3\) \\ \hline J1 & (17,35) & 250 & 263 \\ J3 & (70,140) & 250 & 587 \\ J4 & (140,280) & 500 & 1382 \\ \hline \end{tabular}
\end{table}
Table 2: Di-jet samples considered for noise studies.

Figure 10: Distribution of the number of cells in a jet belonging to TileCal (upper plot) and to LAr (Lower plot) for three QCD di-jet samples: J1 (black full line), J3 (red dashed line), J4 (blue dot-dashed line). Each distribution is normalized to unity. The absolute normalization for each sample is reported in table 2.

completely contained in the LAr. The average numbers of TileCal cells included in a jet are 37 \(\pm\) 2 for J1, 65 \(\pm\) 3 for J2, 87 \(\pm\) 4 for J3. As one cell corresponds to two read-out channels, on average, more than one LB TileCal drawer is expected to be included in a jet for all the samples. If inter-drawer correlations are neglected and the drawers are considered sufficiently similar to be described by formulas 23 and 24, formula 27 and the values of table 3 can be used to determine the variation in noise with respect to the uncorrelated case. To obtain an order of magnitude estimate it is assumed that:

* the channels included in the jet fully cover as many drawers as it is allowed i.e. \(N_{D}\) = integer value of (\(N^{avgch}/N^{chan}\)) where \(N^{avgch}\) is the average number of TileCal cells included in a jet for a given sample and \(N^{chan}\) is the number of channel in a given drawer type.
* 1\(\times\)45 = 29.

As a consequence formula 27 is used to determine \(PNoiseChange\), by using the value of \(R\) derived from the data in table 1 and setting \(N^{ch}\) = 45 for LB drawers. The results are shown in table 3: the TileCal noise contribution to a jet can increase by as much as 87%.

The total expected electronic noise \(\sigma_{jet}\) in a jet when no correlation effects are considered is obtained by

\[\sigma_{jet}=\sqrt{\sum_{c}^{AllCellsinjet}\sigma_{c}^{2}}=\sqrt{\sigma_{TileCell }^{2}+\sigma_{LArCell}^{2}}=\sqrt{\sum_{k}^{TileCellsinjet}\sigma_{k}^{2}+ \sum_{p}^{LArCellsinjet}\sigma_{p}^{2}} \tag{28}\]

where \(\sigma_{c}\) is the electronic noise stored in the conditions database for a given cell in the calorimeters and \(\sigma_{k}\) and \(\sigma_{p}\) are defined by restricting the quadratic sum to Tile or LAr cells only i.e. summing \(\sigma_{k}^{2}\) and \(\sigma_{p}^{2}\) respectively.

The distributions of \(\sigma_{TileCellinjet}\) and \(\sigma_{LArCellsinjet}\) are shown in figure 11 in the upper and lower plot respectively. In the distribution for Tile noise, two small peaks are observed around 500 MeV for the J3 and J4 samples; the J4 sample also has a small peak around 900 MeV and a barely visible one around 1100 MeV 700. They represent about 4% of the jets in J3 and 7.5% of those in J4. These peaks are essentially due to the different magnitude of the expected noise when switching from high to low gain in TileCal front-end electronics. In fact the switch happens for deposited energies around 10 GeV and 98% (100%) of the jets making up the peaks contains at least one cell with energy above 10 GeV; 98% (81%) of such have an energy above 100 GeV in J4 (J3 16)). The average noise in the uncorrelated scenario is definitely dominated by the LAr contribution.

\begin{table}
\begin{tabular}{|c|c c|} \hline Sample type & \(N^{avgch}\) & \(PNoiseChange\) (\%) \\ \hline J1 & 74 & 79.4 \\ J3 & 130 & 87.0 \\ J4 & 174 & 87.3 \\ \hline \end{tabular}
\end{table}
Table 3: Estimated noise variation as a function QCD di-jet sample type obtained by using formula 27 and average number of channels included in a jet (\(N^{avgch}\)). The underlying assumptions are discussed in the text.

Figure 11: Expected noise distributions in a jet with in the no-correlation scenario: contribution from TileCal (upper plot) and LAr (lower plot) cells are shown separately. The distribution for three QCD di-jet samples are reported: J1 (black - full), J3 (red - dashed), J4(blue-dot-dashed). Each distribution is normalized to unity. The absolute normalization for each sample is reported in table 2.

The TileCal noise contribution in a jet can be compared to the LAr contribution on an event by event basis in the no-correlation scenario. The relative magnitude of TileCal noise contribution to a jet can be assessed by comparing it to the LAr contribution (\(\sigma_{TileCell}/\sigma_{LArCell}\)) and to the total jet energy in the uncorrelated case (\(\sigma_{TileCell}/E_{jet}\)). These two distributions are shown in figure 12 for the three QCD d-jet samples. TileCal noise is on average about 24% to 31% of LAr noise for a jet: an average increase in the TileCal contribution as reported in table 3 would change the TileCal to LAr ratio to about 43% for J1, 50% for J3 and 56% for J4 respectively. The total noise in the jet is then expected to increase on average by 6% in J1, 8% in J3 and 10% in J4. Anyhow the lower plot of figure 12 shows that the ratio of jet energy TileCal noise is on average 0.8% of the total jet energy for J1, 0.6% for J3 and 0.5% for J4. If LAr average contribution is taken into account, the total uncorrelated noise is expected to be on average about 3.4% of the total jet energy in J1, 2.2% in J3 and 1.7% in J4. Coherent effect would bring these percentages up by the same amount the total noise is expected to increase, making the ratio of total noise to jet energy on average about 3.6% in J1, 2.4% in J3 and 1.9% in J4.

These conclusions should be considered preliminary and principally aimed at providing an order of magnitude rather than estimating the detailed impact of the effect. They are based on average values extrapolated from the no-correlation scenario and not on the fully simulated effect, so they do not account for the impact of coherence effect on cluster and jet multiplicity. In addition the estimate of \(R\) was obtained from only one module with non-final power supply operated in the combined test beam environment. Measurements from all the modules with the final power supplies in the assembled ATLAS detector will provide a more solid estimate.

## 6 Full noise profile implementation in Athena and how to switch it on

The code for including the full noise profile in the simulation is in the CVS repository for the Tile Calorimeter in Athena ([http://atlas-sw.cern.ch/cgi-bin/viewcvs-atlas.cgi/offline/TileCalorimeter/](http://atlas-sw.cern.ch/cgi-bin/viewcvs-atlas.cgi/offline/TileCalorimeter/)).It involves changes in the code of the following packages

* TileCalorimeter/TileConditions,
* TileCalorimeter/TileSimAlgs

In TileConditions, TileInfoLoader.cxx contains the instruction to switch on correlation effects and this information is passed over to code in TileInfo.cxx. There the covariance matrix is read from a text file currently kept in the share directory into a covariance matrix object. This object is used by code in TileDigitsMaker.cxx where simulated digits are obtained from GEANT4 hits and the algorithm described in section 3.1 is applied.

The starting point is to have or produce a file with simulated GEANT4 hits in the Tile calorimeter. Standard digitization of the simulated hits will be modified by two simple steps to include the full noise profile:

* input the covariance matrix to be simulated. Currently there are four files in TileCalorimeter/TileConditions/share/: CovaMatrixHiBar.txt, CovaMatrixHiEBar.txt, CovaMatrixLoBar.txt and CovaMatrixLoEBar.txt. The "Bar" files refer to modules in the Tile Long Barrel, while the "EBar" are used for those Tile Etended Barrel. The "Hi" files contain covariance matrix for high gain signals and the "Lo" ones for low gain signals.Customization is obtained by replacing these text file with different ones suiting the purpose of the analysis to be performed.
* modify the digitization job option to switch on full correlation effects. The following line Figure 12: Distribution of the ratio of expected noise in a jet from TileCal cells (upper plot) and from LAr cells (lower plot). The distributions are normalized to unity. The absolute normalization for each sample is reported in table 2.

doTileHitToRawChannelCoherNoise=True  has to be added before the line including the Tile Calorimeter digitization job options file i.e  for Test Beam studies:  include ("TileSimAlgs/TileTBDigitization_jobOptions.py" )  for full ATLAS studies:  include ("TileSimAlgs/TileDigitization_jobOptions.py")

It is important to note that current setup will introduce the same covariance effects for each Tile module because there is only one covariance matrix set to draw info upon. The inclusion of drawer to drawer differences will require additional development (see section 7).

The analysis reported in this document was obtained by simulating one Tile module front-end electronics signal using the code in TileCalorimeter/TileExample/ TileSimEx/. The job options files used to steer Athena were jobOptions_TileTB_Sim.py (for the hits simulation) and jobOptions_TileTB_Dig.py (for the digitization). The last one was modified as above to include the full noise profile from the data.

## 7 Outlook: a strategy for initial LHC data-taking

The results of section 5 suggest that the magnitude of coherent effects in TileCal can play a significant role in determining the noise pattern in the hadronic calorimeter in physics events at the LHC and it should not be unaccounted for.

There are still some issues to be understood in the current analysis and improvements to be implemented in the current set-up for noise simulation.

The main starting points for improvement studies are the limitations illustrated in section 3.2. As a consequence the following possible lines of development can be envisaged (ordered in priority):

* extend the current setup to allow different covariance matrices for different drawers.
* analyze possible module-to-module correlation and possibly incorporate them in the simulation. This should be a useful tool to consider possible noise leakage between drawers.
* analyze inter-gain correlations. In order to introduce them in the present framework possibly consider an average correction to be applied.
* consider extremely high correlation cases to check how well the current approach is able to cope with them.
* analyze the high luminosity scenario when pile-up from many superposing physics events will introduce physics-related correlations and modifications to the current algorithms will be necessary.

The possible improvements of the current scheme can happen in parallel with its usage and benefit from it. A strategy for handling the noise pattern can be outlined as follows.

The covariance matrix for each individual module front-end electronics should be measured and stored in the conditions data base. The described set-up can then incorporate the measured values in the full simulation of the ATLAS detector.

During the final period of the calorimeter commissioning such measurements should be carried out for the most up-to-date configuration of the Tile front-end electronics, particularly after the insertion of the new patched power supplies [32]. A similar analysis to the one reported in section 5.2 for estimating \(R\) can be quickly performed for each pedestal data-taking. In this way quantitative information about initial conditions of the TileCal noise pattern can be monitored and recorded.

In the meanwhile an initial quantitative estimate of the expected coherent noise effects can be obtained for physics analyses where a large number of TileCal cells will be involved. For any physics analysis, a comparison can be made between the results obtained by digitizing simulated samples with and without coherence effects. For instance the effects should be checked in pion reconstruction, di-jets, top-anti-top, SUSY, large missing transverse energy events. The noise pattern to be used in the simulation can be either derived from the single best knowledge for each module or using a module-averaged covariance matrix.

The magnitude of the noise with respect to jet energy is expected to remain small if the coherent effects are still at the level of section 5.2. The full analysis should update these preliminary conclusions using the latest values of the correlation matrix and also check the possible impact of non-Gaussian effect on jet energy linearity should be analyzed. The emphasis should then be placed on analysing the impact of coherent effects on cluster multiplicity, jet multiplicity and missing energy: such an exercise is doable with the available tools, but, given its size, it is beyond the scope of the present paper.

Finally this approach should become systematic when ATLAS is running in full data-taking mode. The module-related covariance matrix in a given interval of validity should be measured and stored. The incorporation of the measured values in the ATLAS full simulation should be the default for all physics studies. Noise stability coupled with the final calibration and monitoring scheme adopted for TileCal will determine the reasonable size of the interval of validity. Stability results from the test beam and the commissioning period can already provide hints on this issue 17).

Footnote 17: Combined test beam studies [33] show that noise and coherent effects are stable at better than the percent level over a two weeks period.

## 8 Conclusions

A simulation scheme was developed to describe the full noise pattern of any set of channels in TileCal in a phenomenological way by taking into account correlation effects. The natural set of channels is one of the 256 drawers that compose TileCal. Even within its limitations the current setup is able to reproduce the measured covariance matrix at the level of a few percent%. A single, robust estimator derived from the covariance matrix is also considered for capturing the size of the coherent effects per module for quick diagnoses and monitoring purposes. An preliminary estimate of the size of non coherent effects in QCD di-jet events shows that noise deriving from TileCal cells in a jet can increase up to about 87% on average, even though the total noise due to calorimetery is expected to remain below 4% to 2% of the total jet energy. The effect on cluster multiplicity, jet multiplicity and missing energy is entrusted to future studies. These should be part of a strategy aimed at analysing the impact of coherent effects on observable quantities and incorporate their presence during LHC data-taking (particularly in the early days). An outline of the steps to take in such an effort is provided.

A correct handling and monitoring of the full noise pattern of the Tile Calorimeter becomes important during LHC running, particularly in the early days, when high multiplicity/occupancy events (i.e. di-jets,top-anti-top) will be measured to (inter)calibrate the full ATLAS detector and understand jet and missing energy reconstruction.

## Acknowledgments

The author would like to acknowledge Jimmy Proudfoot and Matteo Cavalli-Sforza for initially encouraging studies on coherent effects. Richard Teuscher is to be thanked for providing the initial code to study noise in TileCal and for many enlightening discussions. Sasha Solodkov is gratefully acknowledged for invaluable help in the implementation of the simulation in the TileCal software, valuable comments on the content and structure of the paper and various useful discussions. It is a pleasure to acknowledge the precious comments on the structure and the content of the paper provided at different stages of paper writing by Christian Bohm, Ilya Korolkov, John Parsons and Jim Pilcher. Kristin Lohwasser deserves thanks for help in getting hold of the QCD ntuples and deciphering the initial meaning of useful variables. Sven Menke's help in setting up the code for running over the QCD samples and various enlightening discussions is also gratefully acknowledged.

## Appendix: On estimates of coherent effects in ATLAS Calorimetry

Various estimates of the size of coherent effects were used in ATLAS calorimetery.

Past studies of coherent effects in combined testbeam data extracted coherent noise information from fits to the properties of the cumulative response of N channels [34]. The signals of N channels were either summed normally ( \(S_{N}\) = \(\sum_{n}E_{n}\) ) or with alternate signs (\(S_{N}^{\pm}\) = \(\sum_{n}(-1)^{n}E_{n}\)) and their standard deviations \(sigma_{N}\) = RMS(\(S_{N}\)) and \(sigma_{N}^{\pm}\) = RMS(\(S_{N}^{\pm}\) ) were considered as functions of the number of used channels N. The assumption of noise uniformity allowed to postulate a functional form for \(\sigma\)s depending only on two parameters: single channel coherent and random noise. In addition \(sigma_{N}^{\pm}\) should only depend on the random noise if the coherent noise is uniform and cancels out. Fits to the data with the functional forms determined the two parameters. Sizeable non-uniformity in the noise profile can change the shape of \(sigma_{N}\) as different sets of N channels are no more equivalent: the results of the fit will depend on the order in which the channels are summed and the fit can even fail. An example of the limits of such approaches is found in figure 13 taken from [35]. The functional form for \(\sigma_{N}\) being used is \(\sigma_{N}=\sqrt{N\sigma_{rand}^{2}+N^{2}\sigma_{coher}^{2}}\). The fit fails as anti-correlation sets in when summing the final set of channels and it breaks the model of uniform coherent effects.

Figure 13: Noise \(sigma_{N}\) as a function of N, the number of summed signals from different channels.

Both \(sigma_{N}\) and \(sigma_{N}^{\pm}\) were used in past standalone Liquid Argon Calorimetry (LAr) analyses [36] and more recently [37] for the analysis of the noise in a full front-end board of the LAr in the 2004 Combined Test beam data. In these cases no fit was implemented, but an average value was extracted using the \(sigma_{N}\) for the total number of channels.

A more robust approach uses the covariance matrix information to extract knowledge about coherent effects [36]. In this scenario the N-channels noise vector **b** is parametrized as **b** = **u+** c\(\alpha\) where **u** is the vector of "incoherent noise", \(\alpha\) is a normalized vector and \(c\) characterizes the coherent noise size. Both coherent and incoherent noise are assumed to be uniform over all the channels. These simplifying assumptions produce a covariance matrix depending on two parameters (the sizes of coherent and incoherent noise per channel) which are determined by extracting its eigenvalues. Particularly the largest eigenvalue contains the info about the coherent noise, with all the others being determined by "incoherent effects". The method provides sensible results if the noise uniformity assumption is respected; it can run into problems when non-uniformities and anti-correlation between channels are present. Meaningful results are obtained by choosing uniform regions which will then be characterized by different combinations of parameters.

Additionally, an interesting approach which was used in for analyzing the 1994 TileCal test beam results is based on the assumption that coherent noise can be viewed as linear function of the signal in all involved channels [38]. If the intrinsic noise of every channel is considered as a perturbation, the parameters of the coherent noise can be extracted using conventional linear regression analysis i.e. by minimizing the sum of the squares of the difference between the covariance matrix and its predicted functional form. The basic formulas are given in [39]. An event-by-event and channel-by-channel coherent noise prediction can be obtained with the aim to correct the signal and even improve the resolution. Such an approach is still model dependent, but in a rather general way and does not assume any uniformity in the noise.It would deserve a study of its own, in order to understand the limitations of the used approximations (linear dependence of the coherent noise on the signal in the channels and possibility to treat the "intrinsic" incoherent noise as a perturbation).

A similar event-by-event correction is also explored in [36] within the simpler assumption of uniformity discussed above: in this case the estimator of the noise magnitude, \(c\), turns out to be the scalar product of the \(\alpha\) direction times the full noise vector.

Finally the current Liquid Argon Calorimeter monitoring tools use a thorough and very robust approach in characterizing coherent effects by plotting quantities that can be related to \(R\)[40]. These quantities are the bin integrated ratio of total to incoherent noise \(R_{\alpha}\) and the bin integrated effective correlation coefficient \(\rho_{alpha}\). To define them it is useful to consider \(Num\) = standard deviation of sum of signal in N channels, \(Den2\) = sum of squares of standard deviations of signals in N channels and \(DenPair\) = sum of products of standard deviations of signals in all pairs of different channels. The variables are then defined as \(R_{\alpha}=\frac{Num}{Den2}\)[41] and \(\rho_{alpha}=\frac{Num^{2}-Den2}{DenPair}\)[42]. Both quantities are robust against channel order as they take all the channels in a region. They do not depend on a specific assumption on the functional form of the noise and can be derived for varying detector granularities.

## References

* [1] H. Spieler, _"Radiation Detectors and Signal Processing"_ [[http://www-physics.lbl.gov/~spieler/Heidelberg_Notes_2005/pdf/](http://www-physics.lbl.gov/~spieler/Heidelberg_Notes_2005/pdf/) IV_Signal_Processing.pdf]
* Electronics in High Energy Physics
- Course series on modern electronics
- CERN -2005
[[http://humanresources.web.cern.ch/humanresources/external/training/tech/special/ELEC2005.asp](http://humanresources.web.cern.ch/humanresources/external/training/tech/special/ELEC2005.asp)]

Section 28.12 in W.M. Yao _et al._, _Journal of Physics_**G** 33, 1 (2006) [[http://pdg.lbl.gov/2006/reviews/pardetrp.pdf](http://pdg.lbl.gov/2006/reviews/pardetrp.pdf)]
* [3] H. Spieler, _"Front End Electronics and Signal Processing"_ Lecture notes at [http://www-physics.lbl.gov/~spieler/ICFA_Morella/text/Front_End_electronics.pdf](http://www-physics.lbl.gov/~spieler/ICFA_Morella/text/Front_End_electronics.pdf)

Section _Electronics applications in HEP experiments_ in Electronics in High Energy Physics - Course series on modern electronics - CERN -2005 [[http://humanresources.web.cern.ch/humanresources/external/training/tech/special/ELEC2005.asp](http://humanresources.web.cern.ch/humanresources/external/training/tech/special/ELEC2005.asp)]

J. Millman and A. Grabel, _"Microelectronics"_, McGraw Hill Higher education, New Edition (1988)
* [4] ATLAS Tile Calorimeter Collaboration, _"Tile Calorimeter Technical Design Report"_, CERN/LHCC 96-42, Dec 1996
* [5] J. Garvey et al., _"The ATLAS Level-1 Calorimeter Trigger Architecture"_, IEEE Transactions On Nuclear Science, Vol. 51, No. 3, June 2004 R. Goncalo et al., _"The ATLAS Trigger: High-Level Trigger Commissioning and operation During Early Data Taking"_, to be published in the proceedings of The 2007 Europhysics Conference on High Energy physics (EPS HEP) 2007, Manchester, 18th-25th July 2007. [[http://doc.cern.ch//archive/electronic/cern/others/atlasconf/slide/slide-2007-054.pdf](http://doc.cern.ch//archive/electronic/cern/others/atlasconf/slide/slide-2007-054.pdf)]

The ATLAS Collaboration, _"ATLAS High-Level Trigger, Data Acquisition and Controls"_, ATLAS TDR-016, 2nd October 2003 [[http://atlas-proj-hltdaqdcs-tdr.web.cern.ch/atlas-proj-hltdaqdcs-tdr/tdr-v1-r4](http://atlas-proj-hltdaqdcs-tdr.web.cern.ch/atlas-proj-hltdaqdcs-tdr/tdr-v1-r4) /PDF/TDR-2up.pdf]
* [6] U. Blumenschein, "Degradation of jet resolution" presented at the TileCal Institute Board Meeting, CERN, 5th December 2005 [[http://indico.cern.ch/getFile.py/access?contribId=s1t62](http://indico.cern.ch/getFile.py/access?contribId=s1t62)\&resId=0\&materialId =0\&confId=a057372]
* [7] K. Anderson et al., _"Design of the front-end analog electronics for the ATLAS tile calorimeter"_ Nul.Intr.Meth. A Volume 551, Issues 2-3, 11 October 2005, Pages 469-476
* [8] K. Anderson et al., _A Digitizer System for the Tile Calorimeter"_ ATL-TILECAL-97-132 [[http://doc.cern.ch//archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-97-132.ps.gz](http://doc.cern.ch//archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-97-132.ps.gz)]

C. Bohm et al., _"ATLAS Tilecal Digitizer Test System and Quality Control"_ ATL-TILECAL-2004-009 [http://doc.cern.ch//archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-2004-009.pdf](http://doc.cern.ch//archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-2004-009.pdf)

[http://doc.cern.ch/archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-2004-008.pdf](http://doc.cern.ch/archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-2004-008.pdf)* [9] R. Teuscher, _"Front-end Electronics of the ATLAS Tile Calorimeter_ XI International Conference on Calorimetry in High Energy Physics, CALOR2004, Proceedings, 2004. [http://web.cern.ch/t/teuscher/www/CALOR2004_TEUSCHER.pdf](http://web.cern.ch/t/teuscher/www/CALOR2004_TEUSCHER.pdf)
* [10] The TileCal system of the ATLAS collaboration, _Testbeam Studies of Production Modules of the ATLAS Tile Calorimeter_ (in preparation) and references therein. [[http://atlas.web.cern.ch/Atlas/SUB_DETECTORS/TILE/testbeam/summary_paper/tbpaper.ps](http://atlas.web.cern.ch/Atlas/SUB_DETECTORS/TILE/testbeam/summary_paper/tbpaper.ps)]
* ATL-TILECAL-2005-001 [ [http://doc.cern.ch/archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-2005-001.pdf](http://doc.cern.ch/archive/electronic/cern/others/atlnot/Note/tilecal/tilecal-2005-001.pdf)] X. Poveda, _"Optimal filtering General Aspects"_ presented at the TileCal Calibration Workshop, CERN (13th November 2007) [[http://indico.cern.ch/getFile.py/access?contribId=15&sessionId=3&resId=2](http://indico.cern.ch/getFile.py/access?contribId=15&sessionId=3&resId=2) &materialId=slides&confId=23070]
* [12] N. Gollub, _"Fit Method improvements"_ [[http://indico.cern.ch/getFile.py/access?contribId=1&resId=0&materialId=slides&confId=10941](http://indico.cern.ch/getFile.py/access?contribId=1&resId=0&materialId=slides&confId=10941)]presented at the ATLAS TileCal week, CERN (16th February 2007) N. Gollub and I.Jen-La Plante, _Pulse shape biases in CIS and physics_ presented at the ATLAS TileCal Pion Task Force meeting, CERN (17th October 2007) [[http://indico.cern.ch/getFile.py/access?contribId=1&resId=0&materialId=slides&confId=22636](http://indico.cern.ch/getFile.py/access?contribId=1&resId=0&materialId=slides&confId=22636)]
* [13] I.Jen-LaPlante, et al._Systematic Uncertainties in CIS Calibrations_ presented at the ATLAS TileCal Pion Task force meeting, CERN (4th February 2007) [[http://indico.cern.ch/getFile.py/access?contribId=4&sessionId=0&resId=0](http://indico.cern.ch/getFile.py/access?contribId=4&sessionId=0&resId=0) &materialId=slides&confId=21731]
* [14] The GEANT4 Collaboration, S. Agostinelli et al., _"GEANT4 a simulation toolkit_ Nucl. Instr. Meth. **A506** (2006) 250 J.Allison et al., _Geant4 developments and applications_, IEEE Transactions on Nuclear Science **53** No. 1 (2006) 270-278. [http://geant4.web.cern.ch/geant4/](http://geant4.web.cern.ch/geant4/)
* [15][http://atlas.web.cern.ch/Atlas/GROUPS/DATABASE/detector_description/index.htm](http://atlas.web.cern.ch/Atlas/GROUPS/DATABASE/detector_description/index.htm)
* [16] G. Schlager, _The Energy Response of the ATLAS Calorimeter System_, CERN-THESIS-2006-056, [[http://documents.cern.ch/cgi-bin/setlink?base=preprint&category=cern&id=cern-thesis-2006-056](http://documents.cern.ch/cgi-bin/setlink?base=preprint&category=cern&id=cern-thesis-2006-056)]
* [17] X. Poveda, S. Solodkov, J. Maneira, _"TileCal Digitization: Status and Plans"_, presented at the ATLAS and Software Computing Workshop, CERN, (13th Dec. 2006) [[http://indico.cern.ch/getFile.py/access?resId=1&materialId=slides&contribId=22](http://indico.cern.ch/getFile.py/access?resId=1&materialId=slides&contribId=22) &sessionId=13&subContId=4&confId=a057209]* [18] S. Solodkov, _"TileCal offline software status"_ presented at the ATLAS TileCal Week (18th July 2007) [[http://indico.cern.ch/getFile.py/access?contribId=10&resId=1](http://indico.cern.ch/getFile.py/access?contribId=10&resId=1) &materialId=slides&confId=18836]
* [19] A. Artamov, _"OFC Calculations new approach"_ presented at the ATLAS TileCal Week (2nd July 2008) [[http://indico.cern.ch/getFile.py/access?contribId=44&sessionId=1&resId=1](http://indico.cern.ch/getFile.py/access?contribId=44&sessionId=1&resId=1) &materialId=slides&confId=31921]
* [20] M. Haugh, _The Monte Carlo Framework, Examples from Finance and Generating Correlated Random Variables_ [[http://www.columbia.edu/~mh2078/MCS04/MCS_framework_FEegs.pdf](http://www.columbia.edu/~mh2078/MCS04/MCS_framework_FEegs.pdf)] T. Fischer, A. Roehrl, _Simulation of correlated normal random variables_ in _Risk and performance optimization for portfolios of bonds and stocks"_ [[http://approximity.com/papers/ptfopt/node19.html](http://approximity.com/papers/ptfopt/node19.html)]
* [21] A. G. Froedesen, O. Skjeggestad, _"Probability and Statistics in Particle Physics"_, Bergen Universitetsforlaget, Oslo, 1979
* [22][http://mathworld.wolfram.com/CholeskyDecomposition.html](http://mathworld.wolfram.com/CholeskyDecomposition.html) and references therein
* Numerical Analysis II available at [[http://astro.tempe.edu/~dhill001/course/math254/CHOLESKYDECOMPOSITION_stu.pdf](http://astro.tempe.edu/~dhill001/course/math254/CHOLESKYDECOMPOSITION_stu.pdf)] P. Koev, _"Cholesky factorization_ Lecture Note 12 of MIT course "_Introduction to Numerical Analysis"_ (Fall 2004)
- available at [http://ocw.mit.edu/OcwWeb/Mathematics/18-335JFall/LectureNotes/index.htm](http://ocw.mit.edu/OcwWeb/Mathematics/18-335JFall/LectureNotes/index.htm)
* [24] C. Cuenca Almenar, _"Implementation of an optimal filter for TileCal energy reconstruction in the Athena framework"_ [[http://ific.uv.es/tical/doc/TDI_21_9.pdf](http://ific.uv.es/tical/doc/TDI_21_9.pdf)]
* [25] X. Poveda, _"Optimal Filtering with Minimum Bias Pile-up Studies"_ presented at the ATLAS TileCal week, CERN (4th October 2007) [[http://indico.cern.ch/getFile.py/access?contribId=5&resId=0&materialId](http://indico.cern.ch/getFile.py/access?contribId=5&resId=0&materialId) slides&confId21730+]
* [26] Run 61270 information is available at /castor/cern.ch/user/t/tilebeam/LBA52/tiletb_61270_Ped.LBA52.0.root. A more recent version is also in /castor/cern.ch/user/t/tilebeam/tilemon_61270_Ped.0.root.
* For Application Developers_ [[http://wwwasd.web.cern.ch/wwwasd/geant/geant4_public/G4UsersDocuments/UsersGuides/ForApplicationDeveloper/html/PracticalApplications/particle.html](http://wwwasd.web.cern.ch/wwwasd/geant/geant4_public/G4UsersDocuments/UsersGuides/ForApplicationDeveloper/html/PracticalApplications/particle.html)]
- D0 Note 1434 [[http://www-d0.fnal.gov/~d0upgrad/calelec/notes/Pub-92-162.pdf](http://www-d0.fnal.gov/~d0upgrad/calelec/notes/Pub-92-162.pdf)]
* [29] The description of the J1, J3 and J4 QCD samples is provided at [http://jarguin.home.cern.ch/jarguin/dc3requests_sm.html](http://jarguin.home.cern.ch/jarguin/dc3requests_sm.html) The information about the di-jet samples used in the analysis can be retrieved from the GRID through the DonQuijote service dq2-get documented at [[https://twiki.cern.ch/twiki/bin/view/Atlas/WorkBookDQ2](https://twiki.cern.ch/twiki/bin/view/Atlas/WorkBookDQ2)]. The names of the ROOT files (ntuple format) are as follows J1: user.kristinolhausser.calib0_csc11.005010.J1_pythia_jetjet.digit.RDO.v12003101_V3.aan.root. AANT_00001.root. J3: user.kristinolhausser.calib0_csc11.005012.J3_pythia_jetjet.digit.RDO.v12003104_V3.aan.root. AANT_00194.root J4: user.kristinolhausser.calib0_csc11.005013.J4_pythia_jetjet.digit.RDO.v12003101_V3.aan.root. AANT_00002.root.
* [30] G. Blazey et al., _Run II jet Physics_ [hep-ex00005012] (2000)
* [31] S. Menke, _"Topological Clustering"_ [[https://twiki.cern.ch/twiki/bin/view/Atlas/](https://twiki.cern.ch/twiki/bin/view/Atlas/)]
* [32] G. Blanchot et al., "Electromagnetic Compatibility of a Low Voltage Power Supply for the ATLAS Tile Calorimeter Front-End Electronics", in Proceedings of the 12th Workshop on Electronics for LHC and Future Experiments, 25th-29th September 2006, Valencia (Spain) [[http://indico.cern.ch/getFile.py/access?contribId=82&sessionId=14&resId=0](http://indico.cern.ch/getFile.py/access?contribId=82&sessionId=14&resId=0) &materialId=paper&confId=574]
* [33] F. Spano, _"Noise and stability studies for TileCal Front End Electronics in CTB2004: a more systematic approach"_, presented at TileCal Week (CERN), 28th June 2005 [[http://indico.cern.ch/getFile.py/access?contribId=s1t10&resId=1&materialId=0](http://indico.cern.ch/getFile.py/access?contribId=s1t10&resId=1&materialId=0) &confId=a052832]
* [34] M. Cobal et al., _Analysis results of the April 1996 combined test of the LArgon and TILECAL barrel calorimeter prototypes_ ATL-TILECAL-98-168, CERN, 2 Nov 1998
* [35] F Spano, _"Very preliminary look at Coherent Electronic Noise in TileCal for CTB2004"_, presented at TileCal Week, 14th February 2005 [[http://indico.cern.ch/getFile.py/access?contribId=s1t28&resId=1&materialId](http://indico.cern.ch/getFile.py/access?contribId=s1t28&resId=1&materialId) =0&confId=a05600]
* [36] R. Zitoun, _Study of Noise in November 1998 barrel run_, ATL-LARG-99-06
* [37] M. Aleksa et al._2004 ATLAS Combined Testbeam Computation and Validation of the Electronic Calibration Constants for the Electromagnetic Calorimeter_ ATL-LARG-PUB-2006-003, 10th June 2006
* [38] A. Ostankov, _"A preliminary Correlation Analysis"_, (1996) unpublished. I. Guz, private communication * [39] G. Korn and T. Korn, _"Mathematical handbook for scientists and engineers"_, Dover Publications Inc.; Dover Edition (March 2003). See formulas in paragraph 18.4-9 "Regression, multiple and partial correlation coefficients"
* [40] M. Lefevbre et al., _LAr Noise/Pedestal monitoring_ [[https://twiki.cern.ch/twiki/bin/view/Atlas/NoiseAdnPedestalMonitoring](https://twiki.cern.ch/twiki/bin/view/Atlas/NoiseAdnPedestalMonitoring) #LAr_Noise_Pedestal_Monitoring]
* [41] M. Lefevbre et al., _LAr Noise/Pedestal monitoring_ [[https://twiki.cern.ch/twiki/bin/view/Atlas/NoiseAdnPedestalMonitoring#](https://twiki.cern.ch/twiki/bin/view/Atlas/NoiseAdnPedestalMonitoring#) Bin_integrated_total_incoherent]
* [42] M. Lefevbre et al., _LAr Noise/Pedestal monitoring_ [[https://twiki.cern.ch/twiki/bin/view/Atlas/NoiseAdnPedestalMonitoring#](https://twiki.cern.ch/twiki/bin/view/Atlas/NoiseAdnPedestalMonitoring#) Bi_integrated_effective_correla]