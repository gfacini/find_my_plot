[MISSING_PAGE_FAIL:1]

## 1 Introduction

Jets are collimated sprays of particles resulting from the fragmentation of high energy quarks and gluons. Nearly every analysis at the Large Hadron Collider (LHC) uses jets and both Standard Model (SM) measurements and searches for physics beyond the SM rely on an accurate and precise measurement of the jet energy. Due to various distortions arising from detector effects, such as the intrinsic energy resolution of the calorimeters, the reconstructed jet energy deviates from the hadron-level jet energy in the absence of a detector. These distortions are corrected for using a series of calibration steps that are documented in Ref. [1; 2]. One part of the current calibration procedure (Global Sequential Calibration, GSC) incorporates auxiliary measurements about the jet, such as its reconstructed charged particle multiplicity, to improve the overall quality of the energy reconstruction [3]. In particular, the calibration is designed to reduce the dependence on jet and event features. As a result, the size of the residual distortions decreases for different final states and the dependence on an accurate model of jet features is reduced.

The current scheme for incorporating auxiliary information treats the impact of each feature on the residual jet energy distortions as independent and thus proceeds as a sequential calibration. This approach works well for the current set of features, which are chosen to satisfy the independence criteria. However, there is more information about the jet that is available and using these data in a sequential way would be sub-optimal. In addition, advances in machine learning for jets [4] have shown that neural networks and other modern tools can exploit subtle correlations in high dimensions to improve performance. This note describes the connection between these two concepts by demonstrating a machine learning approach to a jet calibration that uses auxiliary features. In order to ensure that this machine learning approach has the same properties as the algorithm used by the standard calibration scheme [5], a new technique called _Generalized Numerical Inversion_ is described. The main advantage of this algorithm, unlike traditional machine learning regression algorithms, is that it is independent of the energy spectrum of jets used for training. By including all of the available information at once, one can test the importance of correlations in the auxiliary features with the residual energy distortions and ultimately improve the quality of the calibration overall.

This note is organized as follows. Section 2 briefly introduces the ATLAS detector and simulated samples used in this study and Sec. 3 reviews the current ATLAS jet reconstruction and calibration procedures. Generalized numerical inversion is described in Sec. 4 and first results using this new method are presented in Sec. 5. The note closes with Sec. 6.

## 2 ATLAS Detector and Event Simulations

The ATLAS detector [6] is a general-purpose particle physics detector with nearly \(4\pi\) coverage in solid angle around the collision point.1 It consists of an inner tracking detector (ID), surrounded by a superconducting solenoid providing a 2 T axial magnetic field, a system of calorimeters, and a muon spectrometer (MS) incorporating three large superconducting toroid magnets. The ID provides charged-particle tracking in the range \(|\eta|<2.5\) using three technologies: silicon pixel and silicon microstrip tracking detectors,and a transition radiation tracker (up to \(|\eta|<2\)). Due to their precise angular resolution, tracks can be well-associated to the hard-scatter vertex -- the primary vertex with at least two associated tracks that also has the largest \(\sum_{\text{tracks in vertex }p_{\text{T}}^{2}}\) over all such vertices. As a result of this association, the contribution from pile-up to track-based observables is small. Relatively fine-granularity electromagnetic and hadronic calorimeters cover the region \(|\eta|<4.9\). The central hadronic calorimeter is a sampling calorimeter with scintillator tiles as the active medium with steel absorbers. All of the electromagnetic calorimeters, as well as the endcap and forward hadronic calorimeters, are sampling calorimeters with liquid argon as the active medium and lead, copper, or tungsten absorber. The MS consists of three layers of high-precision tracking chambers with coverage up to \(|\eta|=2.7\) and dedicated chambers for triggering in the region \(|\eta|<2.4\).

Studies documented within this note are performed using a variety of Monte Carlo (MC) simulated samples. Dijet events are generated at Leading Order (LO) in Pythia 8.1 [7] with the \(2\to 2\) matrix element convolved with the NNPDF2.3LO Parton Distribution Function (PDF) set [8] and using the A14 set of tuned parameters [9]. An additional sample is simulated using Herwig 7.0 [10] using the NNPDF3.0 NLO PDF and the default set of tuned parameters for the underlying event. Both Pythia and Herwig are interfaced with EvtGen for heavy flavor decays [11, 12].

All simulated events have been reconstructed using a full simulation of the ATLAS detector [13] implemented in Geant 4 [14], which describes the interactions of particles with the detector and the subsequent digitization of analog signals. The effects of multiple simultaneous \(pp\) collisions (pile-up) are simulated with minimum bias \(pp\) collisions using Pythia 8.1 and overlaid on the nominal dijet interactions.

## 3 Jet Reconstruction and Calibration

Detector-level ('reco') jets are formed from topologically connected, noise-suppressed calorimeter cell-clusters [15] at the electromagnetic scale using the FastJet [16] implementation of the anti-\(k_{t}\) jet algorithm [17] with distance parameter \(R=0.4\). The angular coordinates of the cell-clusters are corrected to point to the location of the \(pp\) collision instead of the geometric center of the detector. Hadron-level ('truth') jets are formed from detector-stable simulated particles (\(c\tau>10\) mm), excluding muons and neutrinos. Reco jets are geometrically matched to truth jets using the \(\Delta R\) distance metric; all jets with a reco-truth match are considered. Truth jets are matched to partons using ghost association [18]; the type of the highest energy parton matched to a truth jet is used as the label.

The goal of jet calibration is to ensure that the average calibrated detector-level momentum is the same as the corresponding particle-level quantity on average: \(f(x)\equiv\langle p_{\text{T}}^{\text{reco}}|p_{\text{T}}^{\text{true}}=x\rangle \approx x\). In practice, since \(p_{\text{T}}^{\text{reco}}|p_{\text{T}}^{\text{true}}\) is not exactly normal, a Gaussian function is fit to the core of the probability distribution and the mean and standard deviation of the fit are used to quantify the bias and spread. A related quantity to \(f(x)\) is the average response \(R(x)=f(x)/x\). The closure of the jet calibration procedure is often quantified by the deviation of \(R(x)\) from unity.

The calibration procedure is achieved through a series of steps. Following jet reconstruction from the calorimeter cell-clusters, the impact of multiple nearly simultaneous \(pp\) collisions (pile-up) is corrected for using a jet area-based [18, 19] approach with a residual correction sensitive to both in-time and out-of-time pile-up [20]. Following the pile-up correction, a calibration for the jet energy brings \(E^{\text{reco,calibrated}}\approx E^{\text{true}}\). This absolute MC-based calibration also corrects the jet direction. After this calibration is applied, the GSC corrects the dependence of the jet \(p_{\text{T}}\) on various jet quantities using information from the tracker,calorimeter, and MS (see Sec. 5.3 in Ref. [1] for the detailed list). This reduced dependence makes the response more similar for quark and gluon jets, reduces the uncertainty due to jet fragmentation modeling for a given jet type, and improves the jet energy resolution. The final step of the jet calibration procedure applied only to data is an in-situ correction that accounts for the residual difference in \(R\) between data and simulation. Complete details about the ATLAS jet calibration procedure can be found in Ref. [1; 2].

The focus of this note is on improving the method used for the MC-based residual calibration of the jet \(p_{\mathrm{T}}\) on various jet quantities following an inclusive calibration, which in ATLAS is accomplished with the GSC.

To perform a calibration in \(p_{\mathrm{T}}\), one may want to learn a function that predicts \(p_{\mathrm{T}}^{\mathrm{true}}\) given \(p_{\mathrm{T}}^{\mathrm{reco}}\). While straightforward, this method depends on the distribution of \(p_{\mathrm{T}}^{\mathrm{true}}\) and thus renders the calibration dependent on the event sample from which it is derived. Moreover, this method does not guarantee that \(f(x)\approx x\) even for the sample used to derive the calibration. After applying the learned function it should be the case that \(p_{\mathrm{T}}^{\mathrm{reco}}\approx\langle p_{\mathrm{T}}^{\mathrm{true}}| p_{\mathrm{T}}^{\mathrm{reco}}\rangle\), but \(f(x)=\langle p_{\mathrm{T}}^{\mathrm{reco}}|p_{\mathrm{T}}^{\mathrm{true}}=x\rangle\approx x\) may not necessarily be satisfied. A potential modification of the naive procedure is to enforce that the distribution of \(p_{\mathrm{T}}^{\mathrm{true}}\) used in the learning is uniform over a particular range. However, one can show that if \(f(x)\) is nonlinear or if the resolution \(\sigma(p_{\mathrm{T}}^{\mathrm{reco}}|p_{\mathrm{T}}^{\mathrm{true}})\) is nonconstant, then even with this modification there can be large non-closures. Since both of these properties are true of jet reconstruction in ATLAS, this simple fix does not solve the non-closure problem.

An approach that can be used to ensure that the calibration is independent of the \(p_{\mathrm{T}}^{\mathrm{true}}\) distribution is called numerical inversion, which is the method used in ATLAS for the jet energy corrections. Instead of learning to predict \(p_{\mathrm{T}}^{\mathrm{true}}\) given \(p_{\mathrm{T}}^{\mathrm{reco}}\), numerical inversion does exactly the opposite - by using \(f(x)\) directly, \(p_{\mathrm{T}}^{\mathrm{reco}}\) is calibrated via \(p_{\mathrm{T}}^{\mathrm{reco}}\mapsto\hat{p}_{\mathrm{T}}^{\mathrm{reco}} \equiv f^{-1}(p_{\mathrm{T}}^{\mathrm{reco}})\). This procedure is inherently independent of the distribution of \(p_{\mathrm{T}}^{\mathrm{true}}\) and under a wide variety of circumstances [5], the response closes (\(\hat{R}(x)\equiv\langle\hat{p}_{\mathrm{T}}^{\mathrm{reco}}/p_{\mathrm{T}}^{ \mathrm{true}}|p_{\mathrm{T}}^{\mathrm{true}}=x\rangle\approx 1\)) following the calibration.

Even though the overall response closes, \(f(x)\) may have a residual dependence on auxiliary information available from the detector, such as the jet radiation pattern and the energy deposition pattern in the detector. Let \(\theta\) represent the available auxiliary information about a jet. Then, the function \(f\) can be generalized as \(f_{\theta}(x)\equiv\langle p_{\mathrm{T}}^{\mathrm{reco}}|p_{\mathrm{T}}^{ \mathrm{true}}=x,\theta\rangle\). For \(\theta\in\mathbb{R}\), the correction for these residual dependencies is then given by \(p_{\mathrm{T}}^{\mathrm{reco}}\mapsto\hat{p}_{\mathrm{T}}^{\mathrm{reco}}=\hat {f}_{\theta}^{-1}(p_{\mathrm{T}}^{\mathrm{reco}})\). In practice, the distribution of \(\theta\) is binned and the numerical inversion is performed for different functions in each bin of \(\theta\). When \(\theta\in\mathbb{R}^{n}\), the calibration proceeds with a sequential application of numerical inversion:

\[p_{\mathrm{T}}^{\mathrm{reco}}\mapsto\hat{p}_{\mathrm{T}}^{\mathrm{reco}}=f_{ \theta_{n}}^{-1}\left(\cdots f_{\theta_{2}}^{-1}\left(f_{\theta_{1}}^{-1} \left(p_{\mathrm{T}}^{\mathrm{reco}}\right)\right)\cdots\right). \tag{1}\]

The sequential method removes all residual dependencies when \(f_{\theta_{i}}(x)\) is independent of \(\theta_{j\neq i}\), i.e. when \(f_{\theta}(x)\) is entirely determined by one feature at time. If there are such dependencies of \(f_{\theta}(x)\) on more than one feature \(\theta_{i}\), then there could be residual dependencies on some combination of the \(\theta_{i}\) after the full sequential correction.

## 4 Generalized Numerical Inversion

The idea of generalized numerical inversion is to simply replace the sequential approach in Eq. 1 with a single inversion: \(p_{\mathrm{T}}^{\mathrm{reco}}\mapsto\hat{p}_{\mathrm{T}}^{\mathrm{reco}}=f_{\theta _{1},\ldots,\theta_{n}}^{-1}(p_{\mathrm{T}}^{\mathrm{reco}})\). Binning the response in \(n\) dimensions would require significant computing resources and so is practically infeasible. An unbinned approach that can simultaneously capture the dependence on many features is needed to exploit the potential correlations in the response on the \(\theta_{i}\). One powerful tool for this purpose is a neural network. In principle, neural networks can approximate any smooth function [21, 22] and have been shown to provide excellent performance for a wide variety of classification and regression tasks with limited training data. Inverting a neural network can be non-trivial, so the procedure for generalized numerical inversion is adapted as follows:

1. Learn a neural network approximation \(L(x,\theta)\) to the function \(f_{\theta}(x)=\langle p_{\mathrm{T}}^{\mathrm{reco}}|p_{\mathrm{T}}^{\mathrm{ true}}=x,\theta\rangle\). Note that \(L(x,\theta):\mathbb{R}^{n+1}\rightarrow\mathbb{R}\).
2. Learn a neural network \(C(L(x,\theta),\theta)\) that tries to predict \(x\) given \(\theta\) and \(L(x,\theta)\). This is an approximation to the family of functions \(f_{\theta}^{-1}(x)\). Note that learning the inverse this way is technically simple since \(L\) is single-valued.
3. Calibrate with \(p_{\mathrm{T}}^{\mathrm{reco}}\mapsto\hat{p}_{\mathrm{T}}^{\mathrm{reco}}=C(p_ {\mathrm{T}}^{\mathrm{reco}},\theta)\). The calibration non-closure is defined as the deviation of \(\langle\hat{p}_{\mathrm{T}}^{\mathrm{reco}}/p_{\mathrm{T}}^{\mathrm{true}}|p_ {\mathrm{T}}^{\mathrm{true}}=x,\theta\rangle\) from 1.

There are therefore two learning stages in this procedure. The first step learns a neural network that predicts the average behavior of \(p_{\mathrm{T}}^{\mathrm{reco}}\) given \(p_{\mathrm{T}}^{\mathrm{true}}\) and \(\theta\) while the second network tries to approximate a single-valued function. In principle, the above procedure could be applied to the entire jet calibration procedure described in Sec. 3, but the focus here is on the component addressing residual dependencies, following the inclusive jet energy calibration.

## 5 Results

To illustrate the potential of generalized numerical inversion, an example is provided using jets simulated with the ATLAS full detector simulation. Neural network training is performed using scikit-learn [23] with a simple two-layer feed-forward neural network that has 100 hidden nodes in each layer and a rectified linear unit activation function. To lay the groundwork for application to the full GSC, two key jet features are studied: the number of tracks above 1 GeV associated to the jet (\(n_{\mathrm{track}}\)) and the average track radius2:

Footnote 2: The GSC currently used in ATLAS uses instead the track width, which is the average track radius multiplied by \((n_{\mathrm{track}}+1)\). The residual dependence of the \(n_{\mathrm{track}}\)-calibrated response on the track width is negligible and is thus not useful for benchmarking generalized numerical inversion as the sequential calibration is nearly the same as the simultaneous calibration.

\[\Delta R_{\mathrm{track,avg}}\equiv\begin{cases}\frac{1}{n_{\mathrm{track}}+1} \sum_{\mathrm{tracks}}(p_{\mathrm{T,track}}/\sum_{\mathrm{tracks}^{\prime}}p_{ \mathrm{T,track}^{\prime}})\times\Delta R_{\mathrm{track,jet}}&\text{if $n_{\mathrm{track}}>0$}\\ -1&\text{if $n_{\mathrm{track}}=0$}\end{cases}\]

These observables are useful because the calorimeter response depends on the type of parton that initiated the jet as gluon jets have more particles and have a wider radiation pattern than quark jets. These properties lead to a different response because of the non-linear calorimeter-cell response as well as out-of-cone effects. Even though it is only sensitive to charged particles, the tracker is insensitive to pile-up and is an excellent detector for measuring these jet radiation properties.

Figure 1 shows the dependence of the response (following the inclusive energy calibration) on \(n_{\rm track}\) and \(\Delta R_{\rm track,avg}\). The response depends strongly on these two quantities, varying by about 20-30% across the accessible range. The trends are also not uniform in jet \(p_{\rm T}\) - the response of lower \(p_{\rm T}\) jets shows a stronger dependence on both \(n_{\rm track}\) and \(\Delta R_{\rm track,avg}\).

In order to understand the performance provided by a simultaneous instead of a sequential approach, approximations are derived for the calibration functions \(f_{n_{\rm track}}(x)\), \(f_{\Delta R_{\rm track,avg}}(x)\), and \(f_{n_{\rm track},\Delta R_{\rm track,avg}}(x)\), and the sequential calibration \(f_{\Delta R_{\rm track,avg}}^{-1}(f_{n_{\rm track}}^{-1}(p_{\rm T}^{\rm reco}))\) is compared with the simultaneous calibration \(f_{n_{\rm track},\Delta R_{\rm track,avg}}^{-1}(p_{\rm T}^{\rm reco})\). The sequential calibration presented here differs in some details with the standard GSC used in ATLAS; a major difference is that the calibration presented here does an unbinned fit to \(p_{\rm T}^{\rm reco}\) and the feature \(\theta\) while the GSC does a binned fit which is then smoothed. To control for this ability of the neural network to operate unbinned, the generalized numerical inversion approach is used for both the one- and two-feature cases in order to study only the differences between the sequential and the simultaneous calibrations. However, importantly the sequential approach demonstrated here does no worse than the GSC in correcting for the residual dependence of the response.

The learned functions in the sequential calibration, \(L(p_{\rm T}^{\rm true},n_{\rm track})/p_{\rm T}^{\rm true}\) and \(L(p_{\rm T}^{\rm true},\Delta R_{\rm track,avg})/p_{\rm T}^{\rm true}\), are presented in Fig. 2(a) and (d). As expected, Fig. 2(a) looks similar to Fig. 1(a), as the neural network has learned to approximate the shape of the response with respect to \(n_{\rm track}\) (Fig. 2(d) is not expected to look similar to Fig. 1(b), since the previously applied \(n_{\rm track}\) correction affects the dependence of the response on \(\Delta R_{\rm track,avg}\)). The ratio of \(p_{\rm T}^{\rm reco}\) to \(L(p_{\rm T}^{\rm true})\) (for the appropriate \(\theta\), at the appropriate step of the sequential calibration) is shown in (b) and (e), and the ratio is very close to 1, indicating the learning step is working properly. The closure of the calibrations at each step of the sequence is shown in (c) and (f) of Fig. 2. In both cases, the calibration closes, with an average calibrated response at unity, independent of the features.

Figure 1: The dependence of the response on (a) \(n_{\rm track}\) and (b) \(\Delta R_{\rm track,avg}\) in several bins of truth jet \(p_{\rm T}\).

Figure 2: The dependence of the (a) learned response \(L(p_{\rm T}^{\rm true},\theta)/p_{\rm T}^{\rm true}\), (b) ratio of \(p_{\rm T}^{\rm reco}\) to learned approximation \(L(p_{\rm T}^{\rm true},\theta)\), and (c) calibrated response \(C(p_{\rm T}^{\rm reco},\theta)/p_{\rm T}^{\rm true}\) on \(n_{\rm track}\) in several bins of truth jet \(p_{\rm T}\) for \(\theta=\{n_{\rm track}\}\). Also, the dependence of the (d) learned response \(L(p_{\rm T}^{\rm true},\theta)/p_{\rm T}^{\rm true}\), (e) ratio of \(p_{\rm T}^{\rm reco}\) to learned approximation \(L(p_{\rm T}^{\rm true},\theta)\), and (f) calibrated response \(C(p_{\rm T}^{\rm reco},\theta)/p_{\rm T}^{\rm true}\) on \(\Delta R_{\rm track,avg}\) in several bins of truth jet \(p_{\rm T}\) for \(\theta=\{\Delta R_{\rm track,avg}\}\) in sequence after the \(n_{\rm track}\) correction.

Corresponding results for the network trained to simultaneously learn the dependence on \(n_{\text{track}}\) and \(\Delta R_{\text{track,avg}}\) are shown in Fig. 3. The network is able to learn the dependence on either of the two features in one dimension and the (c) and (f) of Fig. 3 also show that the calibration closes. The advantage of the simultaneous method is highlighted in Fig. 4. After the calibration, in each step of the sequential method, there is still a residual dependence of the calibrated response \(\hat{R}\) on \(n_{\text{track}}\) in individual bins of \(\Delta R_{\text{track,avg}}\). This residual dependence is monotonic, and so the single value \(d\hat{R}/dn_{\text{track}}\) (obtained as the slope when fitting \(\hat{R}\) versus \(n_{\text{track}}\) to a line in bins of \(\Delta R_{\text{track,avg}}\)) parameterizes the remaining residual dependence. The residual dependence on \(n_{\text{track}}\) in bins of \(\Delta R_{\text{track,avg}}\) is nearly the same if the \(n_{\text{track}}\) or sequential \(n_{\text{track}}\), \(\Delta R_{\text{track,avg}}\) calibrations are applied. However, the slope is zero and independent of \(\Delta R_{\text{track,avg}}\) when the simultaneous calibration is performed. Similarly, there is still a residual dependence of \(d\hat{R}/d\Delta R_{\text{track,avg}}\) on \(n_{\text{track}}\) if the \(n_{\text{track}}\) or sequential \(n_{\text{track}}\), \(\Delta R_{\text{track,avg}}\) calibrations are applied; this residual dependence goes away with the simultaneous calibration. Because of this residual dependence, there can be nonclosures in specific regions of the parameter space, despite the calibration closing inclusively overall. In the sequential calibration, large non-closures can be seen in some regions of the parameter space, while the simultaneous calibration almost completely removes these nonclosures. This comparison illustrates the main benefit of the generalized numerical inversion approach.

[FIGURE:S3.F3][ENDFIGURFigure 4: The dependence of (a) \(\frac{dR}{dn_{\rm max}}\) on \(\Delta R_{\rm track,avg}\) and (b) \(\frac{dR}{d\Delta R_{\rm track,avg}}\) on \(n_{\rm track}\) for: a calibration using a network with \(\theta=\{n_{\rm track}\}\) (circles); a calibration using a network with \(\theta=\{\Delta R_{\rm track,avg}\}\) employed sequentially after correcting for \(n_{\rm track}\) (squares); and a simultaneous calibration using a network with \(\theta=\{n_{\rm track},\Delta R_{\rm track,avg}\}\) (diamonds). Also, the closure as a function of \(p_{\rm T}^{\rm true}\), highlighting the nonclosure due to this residual dependence in (c) a selection intended to target gluon jets; and (d) a selection intended to target quark jets.

As observables sensitive to the quark or gluon nature of a jet, \(n_{\rm track}\)- and \(\Delta R_{\rm track,avg}\)-based calibrations ideally reduce the response difference between jet types. Figure 5 shows the difference between the response for quark and gluon jets as a function of the truth jet \(p_{\rm T}\) for different calibration methods. Since gluon jets have a softer constituent \(p_{\rm T}\) spectrum, their response is lower than for quark jets on average. Applying any residual correction can be seen to be beneficial in reducing the response difference and the largest reduction is observed for the simultaneous approach. Reducing the response difference between quark and gluon jets is important for analyses that have an unknown or poorly modeled quark/gluon composition. The properties of quark and gluon jets can depend on the specific model of jet fragmentation used; therefore, it is also important to check that the improvement in the quark-gluon response difference is robust to these model differences. In addition to showing the results for Pythia 8, Fig. 5 also demonstrates that (without retraining) there are also improvements for Herwig 7.

One step beyond reducing the quark/gluon composition dependence is to reduce the sensitivity to the modeling of the radiation pattern inside a given jet type. An important consequence of such a reduction could be a smaller systematic uncertainty associated with jet fragmentation modeling. Figure 6 quantifies this effect by showing the difference in the jet response between Pythia 8 and Herwig 7 for quarks and gluons separately. It can be seen that the jet response difference between the generators is generally better in the simultaneous calibration method than in the sequential method. In particular, in some bins of \(p_{\rm T}^{\rm true}\), the sequential method makes the difference between the generators worse than not including the second variable, while the simultaneous method retains or slightly improves the difference between the generators. This could happen if the correlation between the two features changes between the generators in such a way that the sequential calibration effectively undoes the correction of the first feature in the sample the network was not trained on. Another possible effect is that the correlation between the two features stays the same between the generators, but the underlying distribution of one or both of the features in the jets changes. In either case, since the simultaneous method conditions on both features at once, this does not affect the final performance.

A final metric for studying the impact of generalized numerical inversion is the jet energy resolution. One component of the jet energy resolution is due to the spread in the jet energy response for various values of \(\theta\). In the extreme case that there is no spread in \(p_{\rm T}^{\rm reco}\) given \(p_{\rm T}^{\rm true}\) and \(\theta\), there will still be an effective

Figure 5: The difference between the response of quarks and gluons as a function of \(p_{\rm T}^{\rm true}\) for: before any \(n_{\rm track}\) or \(\Delta R_{\rm track,avg}\) correction (open circles); a calibration using a network with \(\theta=\{n_{\rm track}\}\) (circles); a calibration using a network with \(\theta=\{\Delta R_{\rm track,avg}\}\) sequentially after correcting for \(n_{\rm track}\) (squares); and a simultaneous calibration using a network with \(\theta=\{n_{\rm track},\Delta R_{\rm track,avg}\}\) (diamonds).

resolution resulting from the spread in values over the range of \(\theta\). This contribution to the resolution is reduced with any residual calibration. However, the calibrated resolution is not only determined by the spread in the response values with \(\theta\) and in general need not improve following the calibration. Figure 7 shows both the inclusive (not differential in \(\theta\)) closure as well as the inclusive resolution as a function of the truth jet \(p_{\mathrm{T}}\), for different calibration methods. All methods achieve a similar inclusive closure and as desired, the residual calibration procedures reduce the resolution. The overall resolution reduction is similar for the sequential and simultaneous approaches, with the simultaneous slightly better at higher \(p_{\mathrm{T}}\) and the sequential slightly better at low \(p_{\mathrm{T}}\). The difference in the resolutions from the various approaches is small compared to the gain over no residual calibration.

Figure 6: The difference between the response of jets in Pythia8 and Herwig7 as a function of \(p_{\mathrm{T}}^{\mathrm{true}}\) in (a) gluon jets, and (b) quark jets, for: before any \(n_{\mathrm{track}}\) or \(\Delta R_{\mathrm{track,avg}}\) correction (open circles); a calibration using a network with \(\theta=\{n_{\mathrm{track}}\}\) (circles); a calibration using a network with \(\theta=\{\Delta R_{\mathrm{track,avg}}\}\) sequentially after correcting for \(n_{\mathrm{track}}\) (squares); and a simultaneous calibration using a network with \(\theta=\{n_{\mathrm{track}},\Delta R_{\mathrm{track,avg}}\}\) (diamonds).

Figure 7: The (a) closure and (b) resolution as a function of \(p_{\mathrm{T}}^{\mathrm{true}}\) for: before any \(n_{\mathrm{track}}\) or \(\Delta R_{\mathrm{track,avg}}\) correction (open circles); a calibration using a network with \(\theta=\{\Delta R_{\mathrm{track,avg}}\}\) sequentially after correcting for \(n_{\mathrm{track}}\) (squares); and a simultaneous calibration using a network with \(\theta=\{n_{\mathrm{track}},\Delta R_{\mathrm{track,avg}}\}\) (diamonds). For the resolution, also shown is the (negative) improvement in quadrature of the resolution for a given calibration with resolution \(\sigma^{\prime}\) to the resolution before any correction \(\sigma\).

## 6 Conclusion

This note has presented a study of a regression-based residual jet energy calibration procedure, implemented with neural networks and designed to avoid binning effects and incorporate correlations in the response between various jet features. This new method can eliminate the residual dependence on one feature after calibrating for a second feature with a strong influence on the response for the first feature. This can be useful for mitigating the response difference between quark and gluon jets as well as for reducing the residual dependence on the feature for quark or gluon jets separately. The simultaneous calibration offers similar benefits to the sequential calibration for the jet energy resolution and by construction has no impact on the inclusive closure of the jet calibration. Generalized numerical inversion is a promising method for the future as more information about jets is included in the calibration procedure. Further studies are required to incorporate more observables and quantify the potential reduction in the topology dependence and systematic uncertainties of the full approach.

## References

* [1] ATLAS Collaboration, _Jet energy scale measurements and their systematic uncertainties in proton-proton collisions at \(\sqrt{s}=13\) TeV with the ATLAS detector_, Phys. Rev. D **96** (2017) 072002, arXiv: 1703.09665 [hep-ex].
* [2] ATLAS Collaboration, _Jet energy measurement with the ATLAS detector in proton-proton collisions at \(\sqrt{s}=7\) TeV_, Eur. Phys. J. C **73** (2013) 2304, arXiv: 1112.6426 [hep-ex].
* [3] ATLAS Collaboration, _Jet global sequential corrections with the ATLAS detector in proton-proton collisions at \(\sqrt{s}=8\) TeV_, ATLAS-CONF-2015-002, 2015, url: [https://cds.cern.ch/record/2001682](https://cds.cern.ch/record/2001682).
* [4] A. J. Larkoski, I. Moult and B. Nachman, _Jet Substructure at the Large Hadron Collider: A Review of Recent Advances in Theory and Machine Learning_, (2017), arXiv: 1709.04464 [hep-ph].
* [5] A. Cukierman and B. Nachman, _Mathematical Properties of Numerical Inversion for Jet Calibrations_, Nucl. Instrum. Meth. **A858** (2017) 1, arXiv: 1609.05195 [physics.data-an].
* [6] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003.
* [7] T. Sjostrand, S. Mrenna and P. Z. Skands, _A Brief Introduction to PYTHIA 8.1_, Comput. Phys. Commun. **178** (2008) 852, arXiv: 0710.3820 [hep-ph].
* [8] R. D. Ball et al., _Parton distributions with LHC data_, Nucl. Phys. **B867** (2013) 244, arXiv: 1207.1303 [hep-ph].
* [9] ATLAS Collaboration, _ATLAS Pythia 8 tunes to 7 TeV data_, ATL-PHYS-PUB-2014-021, 2014, url: [https://cds.cern.ch/record/1966419](https://cds.cern.ch/record/1966419).
* [10] J. Bellm et al., _Herwig 7.0/Herwig++ 3.0 release note_, Eur. Phys. J. **C76** (2016) 196, arXiv: 1512.01178 [hep-ph].