[MISSING_PAGE_EMPTY:1]

## 1 Introduction

### Paper modelling

For analysis of consequences of different possible design choices for the Atlas LVL2 system, "back of the envelope" calculations give a first approximation on number of messages per second to be handled and link bandwidth required at various places in the system, on number of processors needed, etc. Although the calculations are simple, the amount of numbers to deal with makes some form of bookkeeping necessary. This note presents results from "paper models" implemented in Microsoft Excel. The basic model dealt with is the model of the LVL2 pilot project. Trigger menus, selection strategies, mapping of the ROBs, component models, the system model and all other relevant input to the model are documented in this note together with results obtained.

### Historical note

Paper modelling of the ATLAS trigger system started at Saclay [1]. This work prompted the development of spreadsheet models at RHUL and later at NIKHEF [2]. The spreadsheet developed at NIKHEF [3] has continued to evolve and was adapted to new models and new parameters. It does not make use of macros and is therefore calculating much faster than the RHUL version. However, it does not have the possibility of the RHUL version to compute the decision time for sequential processing (neglecting the effect of message queueing). It was used, modified, and partially simplified in Saclay to study the so called "pull" architecture [4]. A new spreadsheet model introducing a more sophisticated sequential processing strategy ("fully sequential processing") was recently developed at Saclay [5]. This processing strategy is now also included in the NIKHEF variant of the spreadsheet, but only, if relevant, for trigger items with relatively high rates. In the Saclay and NIKHEF variants different assumptions are made with respect to grouping ROBIns in a ROB Complex.

### Present paper models

Results in the present version of this document have been obtained with the current NIKHEF [3] and Saclay [5] versions of the spreadsheet. The results of both variants are in agreement for all results where the grouping of ROBs does not matter and if the differences with respect to the more sophisticated sequential processing strategy are taken into account. Many of the results in the present version of this document have been checked against results from the computer model [6]. This made it possible to find a number of problem areas. After solving the problems in all cases excellent agreement has been found between computer and paper model results.

## 2 Input

### System model

An overview of the system architecture and the data streams is presented in Figure 1.

Data from the subdetector RODs (not shown in the figure) are transferred to the ROBIns through Read Out Links (ROLs), each ROBIn servicing one ROL. The total number of ROBIns is 1530. A number of ROBIns (typically 1 - 4) connected to a single ROBOut (also referred to as RSI for ROB-Switch Interface) form a _ROB Complex_. Every ROBOut has an individual link to the LVL2 network, the Event Builder (EB) network is connected either to the ROBOuts or to the ROBIns. The LVL2 _Supervisor_ receives RoI information from the LVL1 system, assigns a LVL2 processor to each event and sends it the RoI information. From the LVL2 processors it receives back the trigger decisions, forms blocks of decisions and sends (broadcasts) these blocks to all ROB Complexes. The LVL2 _Processors_ each have an individual network connection. In principle a number of LVL2 processors could share a single network connection, but this possibility was not considered in the present model. All the control messages and all of the data transit through a single bi-directional _switching network_.

The event building and processing in the Event Filter is ignored in the baseline model, apart from the output requirements for the ROB Complexes with respect to data to be sent to the Event Builder.

Figure 1: System architecture : baseline model.

### Trigger menus

Two trigger menus are used, a low luminosity menu and a high luminosity menu. These menus consist of a number of trigger items defining the LVL1 RoIs together with exclusive rates and are specified in [7]. For completeness the menus are also shown in Table 1 and Table 2. For both menus the LVL1 trigger rate is approximately 40 kHz. Results have also been obtained for a LVL1 trigger rate of 75 kHz. In that case the exclusive rates for each item are scaled, with the exception of the rates associated with the B-physics trigger (the scan of the TRT data and associated analysis of data from the SCT and pixels), and the accept rates. The rates of these items are kept constant. In reality a change in LVL1 rate from 40 to 75 kHz would imply changes in some thresholds and not a simple rate scaling. The present approach is motivated by uncertainties in the relevant rates.

The distributions describing the probability for finding an RoI within certain eta and phi intervals are assumed to be flat, i.e. independent of the eta and phi position of these intervals.

\begin{table}
\begin{tabular}{|c|l|c|} \hline Item \# & Item composition & Freq (Hz) \\ \hline

[MISSING_PAGE_POST]

J180 + 2*J55 & 8 \\ \hline \end{tabular} 
\begin{tabular}{|c|c|c|} \hline Item \# & Item composition & Freq (Hz) \\ \hline
29 & 2*J180 + 3*J55 & 3 \\ \hline

[MISSING_PAGE_POST]

 \end{tabular}
\end{table}
Table 1: Low luminosity menu. The accept fraction is 5% of the LVL1 rate of 40.12 kHz.

### Processing sequences and acceptance factors

For each trigger item of a trigger menu the processing strategy has to be determined. The most straightforward strategy is to request from the ROBs all data associated with the LVL1 RoI(s). However, the bandwidth and processing requirements may be reduced considerably if the data is analyzed in steps and for each step the data needed for that step is requested. After each step an accept or reject decision is taken. In the present note two variants of this trigger strategy are distinguished :

* In the _sequential strategy_ all data required from the electromagnetic calorimeter is requested in one step. RoIs are handled independent of each other. However, for low luminosity the TRT scan depends on validation of at least one muon RoI.
* In the _fully sequential strategy_ the data required from the electromagnetic calorimeter is requested per layer and processed sequentially for em and for muon RoIs. This is possible as each ROB receives a part of a layer. Furthermore the processing of data from a RoI may depend on the processing of data from another RoI (e.g. an event triggered as item 10 of the low luminosity menu from Table 1 may be rejected if the first EM15I RoI is not confirmed, as there is no trigger item with a single EM15I RoI, so that there is no need to confirm the second Em15I RoI).

\begin{table}
\begin{tabular}{|c|l|r|} \hline Item \# & Item composition & Freq (Hz) \\ \hline

[MISSING_PAGE_POST]

 \end{tabular}
\end{table}
Table 2: High luminosity menu. The accept fraction is 5 % of the LVL1 rate of 39.39 kHz.

The acceptance factors with respect to LVL1 rates and processing sequences used in the present paper models for single RoIs in sequential and fully sequential strategies are listed in Table 3 for both low (\(\,10^{33}\,\)) and high (\(\,10^{34}\,\)) luminosities. The hadron RoI steps apply to TAU menu items.

For the low luminosity B-physics trigger, if a muon is confirmed, the data from the TRT is scanned, followed by track finding in the SCT/Pixel detectors. The following processing sequence is assumed :

* All data of the TRT, SCT and pixels is requested1 after validation of at least one muon RoI (probability : 40 % per LVL1 muon RoI). Footnote 1: Due to a large number of generated RoIs and a relatively small number of ROBs, sending individual SCT and pixel RoIs may generate more network traffic. It would also require an extra input to the model, namely the probability distribution describing the number of RoIs generated by the scan of TRT data.
* The scan generates two muon RoIs for which data from the muon detectors and the calorimeters are requested. The eta-phi extent of these RoIs could be smaller than for LVL1 muon RoIs, in view of the spreadsheet and computer programs available however, the size of LVL1 muon RoIs is used.

The missing energy is not recalculated by the LVL2 system.

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline RoI type & Data from & Action & Accepted & Comment \\ \hline \hline _Muon_ & muon detectors & LVL1 confirmation & 75 \% & \\ \cline{2-5}  & inner detector & track matching & 40 \% & at low L: accepted for B-trigger \\ \cline{2-5}  & e.m. layer 2, HAC & isolation & 20 \% & used in fully sequential strategies \\ \cline{2-5}  & calorimeter & isolation & 4 \% & not if B-trigger is run \\ \hline \hline _e/gamma_ & e.m. layer 2 & LVL1 confirmation & 50 \% & used in fully sequential strategies \\ low L & e.m. layer 1 & and refinement & 18 \% & \\ \hline \hline _e/gamma_ & e.m. calorimeter & LVL1 confirmation & 16 \% & \\ low L & hadron calorimeter & and refinement & 13.5 \% & \\ \cline{2-5}  & inner detector & track find and match & 1.8 \% & electron candidates \\  & & & 1.6 \% & gamma candidates \\ \hline \hline _e/gamma_ & e.m. layer 2 & LVL1 confirmation & 50 \% & used in fully sequential strategies \\ high L & e.m. layer 1 & and refinement & 20 \% & \\ \hline \hline _e/gamma_ & e.m. calorimeter & LVL1 confirmation & 18.3 \% & \\ high L & hadron calorimeter & and refinement & 16.7 \% & \\ \cline{2-5}  & inner detector & track find and match & 2.6 \% & electron candidates \\  & & & 1.5 \% & gamma candidates \\ \hline \hline _jet_ & calorimeters & LVL1 confirmation & 100 \% & the worst case is considered \\ \hline \hline _hadron_ & calorimeters & LVL1 confirmation & 20 \% & \\ \cline{2-5}  & inner detector & track find and match & 8 \% & \\ \hline \end{tabular}
\end{table}
Table 3: Processing steps and acceptance factorsThe confirmation of individual RoIs follows the description given in Table 3. For "sequential processing" all RoIs are treated individually with the exception of requesting all data from the inner tracker for the low luminosity B-physics trigger, which depends on the validation of a muon RoI. In the case of the "fully sequential strategy" a step is performed only if there is a chance to end up with a valid trigger item. A similar rule applies if several RoIs of the same kind are present. In the NIKHEF spreadsheet these rules are applied for low luminosity to trigger item 10 (2 * EM15I) only and for high luminosity to trigger items 2 (2 * MU 6) and 5 (2 * EM20I). In the Saclay spreadsheet all items to which the rules apply are taken into account for the "fully sequential strategy". In the calculation of the average number of steps per event with the NIKHEF spreadsheet it is assumed that a processing step is started as soon as this processing step is no longer depending on acceptance of previous steps.

### LVL1 trigger RoIs

The LVL1 information indicates the type of RoI, a location in \(\eta\,\mathrm{x}\varphi\)  space (if applicable) and the energy or momentum threshold applied. For the types of RoI and thresholds used see the trigger menus (Table 1 and Table 2). The \(\eta\,\mathrm{x}\varphi\)  locations and sizes of the e/gamma, jet and hadron (TAU) RoIs are the same as those for LVL2 and they are defined in the next section (see Table 5).

The information on the muon RoIs needs to be clarified. The current assumption is not completely up-to-date. The LVL1 RoIs are non-overlapping and for each \(\eta\) -interval, all the \(\varphi\) -intervals have the same size. Table 4 gives limits of positive \(\eta\) -intervals and for each of them the number of corresponding \(\varphi\) -intervals. For negative \(\eta\) the same table applies with all \(\eta\)  values taken with the opposite sign.

### RoI sizes used by the LVL2 system

The **muon LVL2 RoIs** are defined with respect to the LVL1 RoI minimum and maximum values of \(\eta\) and \(\varphi\)  which are given in the previous section.

* muon spectrometer : \[\begin{array}{l}\mathrm{n}_{min}(RoI)\ -0.1<\eta<\ \mathrm{n}_{max}(RoI)\ +0.1,\\ \\ \varphi_{min}(RoI)<\varphi<\ \mathrm{\varphi}_{max}(RoI)\end{array}\]

\begin{table}
\begin{tabular}{|c|c c c c c c c c c|} \hline Number of \(\varphi\) -intervals & \multicolumn{88}{|c|}{\(\eta\) -interval limits} \\ \hline \hline
48 & & 0 & 0.1 & 0.2 & 0.3 & 0.4 & 0.5 & 0.6 & 0.7 & 0.8 & 0.9 & 1.0346 \\ \hline
192 & 1.0346 & 1.0387 & 1.0600 & 1.0821 & 1.1050 & 1.1289 & 1.1544 & 1.1815 \\  & 1.2104 & 1.2403 & 1.2699 & 1.2989 & 1.3274 & 1.3545 & 1.3797 & 1.4029 \\  & 1.4239 & 1.4440 & 1.4634 & 1.4821 & 1.5007 & 1.5198 & 1.5397 & 1.5604 \\  & 1.5822 & 1.6051 & 1.6289 & 1.6538 & 1.6797 & 1.7066 & 1.7346 & 1.7624 \\  & 1.7898 & 1.8169 & 1.8435 & 1.8695 & 1.8948 & 1.9178 \\ \hline
96 & 1.9178 & 1.9356 & 1.9675 & 1.9990 & 2.0302 & 2.0608 & 2.0914 & 2.1228 \\  & 2.1550 & 2.1881 & 2.2221 & 2.2565 & 2.2907 & 2.3248 & 2.3586 & 2.3920 \\  & & & & & & & & & & \\ \hline \end{tabular}
\end{table}
Table 4: Muon LVL1 RoI limits	- 0.1 \(<\)\(\eta\)\(<\)\(\eta_{max}(RoI)\) + 0.1, \(\varphi_{min}(RoI)\)
- 0.06666 \(<\)\(\varphi\)\(<\)\(\varphi\)\({}_{max}(RoI)\) + 0.06666
* 0.15 \(<\)\(\eta\)\(<\)\(\eta\)\({}_{max}(RoI)\) + 0.15, \(\varphi\)\({}_{min}(RoI)\)
- 0.13333 \(<\)\(\varphi\)\({}_{max}(RoI)\) + 0.13333

The other RoI sizes and \(\eta\) intervals are summarized in Table 5. The \(\varphi\) -sizes are specified in units of \(\pi\)/3.2  and the overall \(\varphi\) -interval extends always from 0 to 2\(\pi\). The step size with which the RoI window is sliding is the same in both \(\eta\)  and \(\varphi\).

### ROB mapping

The mapping of the detectors onto the ROBIns, in combination with the probabilities for the RoIs to point in a certain direction (assumed to be independent of the direction, see Section 2.2), determines the RoI request rate. The mapping of subdetectors to ROBIns is described in [8]. This information is also summarized in Appendix B, together with graphical results on the hit probability per ROBIn for each subdetector and for relevant RoI types. These results were calculated by a program of the type described in Appendix A. Table 6 shows the mean numbers of ROBIns hit by each type of RoI. The mean numbers of ROBOuts hit for 1, 2, 4 and 8 ROBIns per ROBOut per layer for the electromagnetic calorimeter and for the hadron calorimeter are given in Table 7. The maximum numbers of ROBOuts hit by an RoI are shown as well. Note that results for the ROBOuts depend on how the ROBIns are grouped together. For em and jet RoIs results for a more or less optimized grouping as used in the Saclay spreadsheet are shown, together with results for grouping the ROBIns in the order implied by the specification of the mapping in the appendix.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline RoI type & mu prec & mu trig & total em & had cal & TRT & SCT & Pixels \\ \hline \hline _muon_ & 2.30 & 1.22 & 13.8 & 5.13 & 5.77 & 3.32 & 4.59 \\ \hline _e/gamma_ & – & – & 13.17 & 4.85 & 3.30 & 3.27 & 4.40 \\ \hline _jet_ & – & – & 25.00 & 8.90 & – & – & – \\ \hline \end{tabular}
\end{table}
Table 6: Average number of ROBIns per RoI

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline RoI type & Detector & \(\eta\) x \(\varphi\) sizes & \(\eta_{min}\) & \(\eta_{max}\) & Sliding \\ \hline \hline _e/gamma_ & calorimeters & 0.4 x 0.4 & -2.5 & 2.5 & 0.1 \\ \cline{2-7}  & inner detector & 0.2 x 0.2 & -2.4 & 2.4 & 0.1 \\ \hline _jet_ & calorimeters & 0.8 x 0.8 & -3.2 & 3.2 & 0.2 \\ \hline _tau_ & calorimeters & 0.4 x 0.4 & -2.5 & 2.5 & 0.1 \\ \cline{2-7}  & inner detector & 0.2 x 0.2 & -2.4 & 2.4 & 0.1 \\ \hline \end{tabular}
\end{table}
Table 5: LVL2 RoI sizes 

### Event fragment sizes

The average sizes of the data fragments requested for an RoI from the RoI-related ROBIns of each subdetector are listed in Table 8.

To each raw data fragment a 32 byte header is added.

It is assumed there is no variation in the fragment sizes for a single subdetector. This will not be true in reality : the number of data channels supplying data to a single ROB may be different for different ROBs, while for subdetectors other than the calorimeter there will also be dynamic variations in the fragment sizes. The fragment size for the TRT at low luminosity may be reduced by pre-processing in the ROBs by applying lossless zero-suppression optimized for low luminosity running [9]. The resulting data can also be sent to the Event Builder. The fragment size for the calorimeters after pre-processing is the size as obtained by selecting only the block with energies [10]. For event building the full data has to be sent.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|} \hline \multirow{2}{*}{RoI type} & \multicolumn{2}{c|}{ROBIn} & \multicolumn{2}{c|}{em presampler} & \multicolumn{2}{c|}{em front} & \multicolumn{2}{c|}{em middle} & \multicolumn{2}{c|}{em back} & \multicolumn{2}{c|}{hadronic} \\ \cline{3-11}  & \multicolumn{2}{c|}{per} & \multicolumn{2}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ \cline{3-11}  & ROBOut & aver. & max. & aver. & max. & aver. & max. & aver. & max. & aver. & max. \\ \hline \hline _muon_ & 1 & 1.72 & 6 & 5.17 & 11 & 3.92 & 10 & 2.99 & 10 & 5.13 & 13 \\ \cline{2-11}  & 2 & _1.43_ & \(6\) & _3.83_ & _10_ & _3.35_ & _10_ & _2.58_ & \(6\) & _3.72_ & _11_ \\ \cline{2-11}  & 4 & _1.28_ & \(4\) & _3.33_ & _10_ & _3.06_ & \(6\) & _2.03_ & \(4\) & _2.87_ & \(7\) \\ \cline{2-11}  & 8 & _1.08_ & \(4\) & _2.95_ & \(6\) & _2.50_ & \(6\) & _1.71_ & \(4\) & _2.02_ & \(5\) \\ \hline \hline _e/gamma_ & 1 & 1.80 & 6 & 4.76 & 11 & 3.74 & 10 & 2.87 & 8 & 4.85 & 13 \\ \cline{2-11}  & 2 & _1.47_ & \(6\) & 3.33 & 8 & 2.66 & 6 & 2.10 & 5 & 3.07 & 9 \\ \cline{2-11}  & 4 & _1.29_ & \(4\) & _3.66_ & _10_ & _3.15_ & \(8\) & _2.44_ & \(5\) & _3.48_ & _11_ \\ \cline{2-11}  & 4 & _1.29_ & \(4\) & _2.63_ & \(7\) & 2.11 & 6 & 1.75 & 4 & 2.10 & 6 \\ \cline{2-11}  & 8 & _1.09_ & \(4\) & _3.15_ & \(8\) & _2.87_ & \(6\) & _1.92_ & \(4\) & _2.71_ & \(7\) \\ \cline{2-11}  & 8 & _1.09_ & \(4\) & _2.20_ & \(6\) & _1.75_ & \(4\) & _1.45_ & \(4\) & _1.64_ & \(4\) \\ \cline{2-11}  & 1 & _2.66_ & \(7\) & _9.98_ & _18_ & _7.40_ & _17_ & _4.97_ & _13_ & _8.90_ & 17 \\ \cline{2-11}  & 2 & _1.98_ & \(6\) & _6.33_ & _13_ & _4.75_ & _11_ & _3.41_ & \(7\) & _4.85_ & _10_ \\ \cline{2-11}  & 2 & _1.98_ & \(6\) & _7.03_ & _17_ & _5.74_ & _16_ & _3.88_ & \(8\) & _6.10_ & _13_ \\ \cline{2-11}  & 4 & _1.60_ & \(4\) & _4.65_ & _10_ & _3.29_ & \(8\) & _2.51_ & \(6\) & _3.17_ & \(7\) \\ \cline{2-11}  & _1.60_ & \(4\) & _5.52_ & _15_ & _4.75_ & \(9\) & _2.85_ & \(5\) & _4.24_ & \(8\) \\ \cline{2-11}  & 8 & _1.25_ & \(4\) & _3.40_ & \(8\) & _2.40_ & \(4\) & _1.86_ & \(4\) & _2.49_ & \(4\) \\ \cline{2-11}  & _1.25_ & \(4\) & _4.43_ & _10_ & _2.34_ & \(7\) & _2.17_ & \(4\) & _2.77_ & \(5\) \\ \hline \end{tabular}
\end{table}
Table 7: Average and maximum number of ROBOuts hit by different types of RoIs. Italic numbers refer to grouping in the order as implied by the specification of the ROB mapping in the appendix.

A slightly more sophisticated pre-processing of the calorimeter data consists of selecting from each ROBIn only the RoI-related subsets of data. Table 9 shows the mean factor by which 1 kByte calorimeter fragments (see Table 8) are reduced for different calorimeter layers. The numbers depend on the shape of the eta-phi intervals covered by the ROBIns.

### Component models

The component models and parameters follow the decisions of the Amsterdam modelling meeting of January 1999 [11].

#### 2.8.1 Processing time

The processing times for different steps are taken from [12], but scaled to 1000 MIPS, i.e. reduced with a factor of 2. The total processing time is considered to include an operating system overhead of 10 %, therefore all nominal processing times were increased by 11.1111 %. This does not concern the context switching and the I/O overheads which are both supposed to be 10 \(\upmu\)s. The I/O overheads are added for each input or output operation except for the event data arriving via the Read-Out Links in the ROBIns. For calculating the time needed for data fragment merging it is assumed that the merging speed is 80 MByte/s.

#### 2.8.2 ROB Complex

A ROB Complex consists of a number of ROBIns connected to a single ROBOut. In the model, each ROBIn has a direct connection to the ROBOut (i.e. the ROBIns and ROBOut do not share a bus). These connections transfer data with a speed of 80 MByte/s.

A ROBIn has to perform indexing for each event fragment received via a ROL, and to handle RoI requests and decision blocks. The execution times for different types of processing by a ROBin are summarized in Table 10.

A ROBOut fans out RoI requests and decision blocks to the ROBIns connected to it. The associated execution times do not depend on the number of ROBIns, but I/O overheads are added for each input or output operation. No data pre-processing time is considered. The processing times for a ROBOut are given in Table 11.

\begin{table}
\begin{tabular}{|c|c|c|} \hline ROBIn processing & Nominal time & Total time \\ \hline \hline Indexing per LVL1 trigger & 5 \(\upmu\)s & 5.0 \(\upmu\)s \\ \hline RoI request handling & 10 \(\upmu\)s & 11.111 \(\upmu\)s \\ \hline Decision block processing per block & 50 \(\upmu\)s & 55.555 \(\upmu\)s \\ \hline Decision handling per decision & 1 \(\upmu\)s & 1.1111 \(\upmu\)s \\ \hline \end{tabular}
\end{table}
Table 10: Execution times for ROBIn processing

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline RoI type & Presampler & Front layer & Middle layer & Back layer & Hadronic \\ \hline \hline _e/gamma_ & 7.20 & 2.38 & 3.74 & 5.74 & 25.87 \\ \hline _jet_ & 2.66 & 1.25 & 1.85 & 2.49 & 11.87 \\ \hline \end{tabular}
\end{table}
Table 9: Calorimeter fragment size reduction factors if only RoI-related data is selected In the model event data is transmitted directly to interfaces to the Event Builder by the ROBIns after receiving a LVL2 accept decision. These interfaces are not part of the current model. However, optionally the accepted event data can be passed via the ROBOuts, providing results on the consequences for input and output message rates, data volumes and required processing capacity of the ROBOuts.

#### 2.8.3 Switch model

The structure of the switch is not important for the paper model, as long as multi-casting of messages is possible and as long as data can be passed between any two ports. The grouping factor for the calorimeter and muon detector ROB Complexes is based on a network link speed of 15 MByte/s.

#### 2.8.4 Supervisor

The supervisor consists of independent RoI processors. There is no "steward" handling decisions and processor assignment as in earlier designs. Assignment of events to one of the processors in the LVL2 farm is done by each RoI processor independently. A LVL2 decision is sent from the LVL2 processor to the RoI processor which assigned the LVL2 processor. Decision blocks are sent by the RoI processor to the ROBs as a multicast message (i.e. the switch broadcasts the decision block to all ROBIns and ROBOuts connected to it). The size of the decision blocks is determined by the requirement that there is on average one accept message per block at nominal LVL1 rate, i.e with 5 % accept fraction each block will contain 20 decisions. Therefore a blocking factor of 20 has been used in all calculations.

#### 2.8.5 LVL2 processors

The LVL2 processors take care of RoI request formulation, of preparation of input for feature extraction and performing feature extraction and of global processing and "steering" in the sense of the reference software. Table 12 contains an overview of the nominal feature extraction nominal processing times (the total time is obtained again by multiplying with a factor 1.11111), Table 13 an overview of other processing times.

\begin{table}
\begin{tabular}{|c|c|c|} \hline ROBOut processing & Nominal time & Total time \\ \hline \hline Fanning out an RoI request & 10 \(\upmu\)s & 11.111 \(\upmu\)s \\ \hline Decision block distribution & 10 \(\upmu\)s & 11.111 \(\upmu\)s \\ \hline \end{tabular}
\end{table}
Table 11: Execution times for ROBOut processing

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline Detector & em/had RoI & jet RoI & mu RoI & scan \\ \hline \hline Pixels \& SCT & 250 \(\upmu\)s & – & 250 \(\upmu\)s & 20 \(\upmu\)s \\ \hline TRT & 155 \(\upmu\)s & – & 295 \(\upmu\)s & 25 \(\upmu\)s \\ \hline Total calorimeters & 50 \(\upmu\)s & 50 \(\upmu\)s & 50 \(\upmu\)s & – \\ middle e.m. & 20 \(\upmu\)s & & 20 \(\upmu\)s & \\ front e.m. & 10 \(\upmu\)s & & 10 \(\upmu\)s & \\ back \& presampler & 10 \(\upmu\)s & & 10 \(\upmu\)s & \\ hadronic & 10 \(\upmu\)s & & 10 \(\upmu\)s & \\ \hline Muon detector & – & – & 50 \(\upmu\)s & – \\ \hline \end{tabular}
\end{table}
Table 12: Feature extraction nominal processing times 

## 3 Basic design of the spreadsheet model

In principle it is possible to compute quantities of interest like e.g. the input rate to all feature extractor processors from the sum of the contributions of the various individual trigger items. Only for computing latencies (neglecting the effect of queueing) this approach is necessary, as the composition of each trigger item, in combination with the properties of the LVL2 system, determines what the average latency will be. However, for computing rates and data volumes only the rates and the data volumes associated with different trigger objects do matter (recall that a trigger item is composed of one or more trigger objects). Only the rates depend directly on the trigger menu, the data volumes depend in turn on the rates for different trigger objects. Hence the analysis can be based on the rates for muon RoIs, em RoIs, hadron RoIs, jet RoIs and TRT scan RoIs. A sequential model can be studied by adapting the rates for different RoI types and by introducing different rates for each RoI type and for each detector. For example, in a non-sequential trigger the muon RoI rate may cause an identical RoI rate for the e.m. calorimeter, the hadron calorimeter, the SCT and the TRT. A model in which all muon RoIs are analyzed in the muon detector, but where only a certain fraction of the muon RoIs will be analyzed in the other detectors, can be studied by setting the RoI rates for the other detectors to the value equal to that fraction of the muon RoI rate.

It is assumed that there is no correlation between the positions of different RoIs. A further assumption is that the probability for a RoI to occur at a certain position is only determined by the area from which data is used by the LVL1 trigger to establish the RoI (recall that only a limited number of discrete positions are possible for a RoI provided by the LVL1 trigger).

The calculation procedure is now as follows : first the RoI rates are derived from the appropriate trigger menu. Then for each RoI type and each subdetector all quantities of interest are calculated, making use of the RoI rates, of the event fragment sizes listed in Table 8 and of the average and maximum and minimum number of ROBs per RoI per subdetector, obtained from information on the mapping of the detector. Finally, if required, appropriate sums are formed per subdetector or per RoI type or globally.

## 4 Results

Results have been obtained for the non-sequential strategy, which requests for each menu item all available RoI data, and for the sequential and fully sequential processing strategies described in Section 2.3

\begin{table}
\begin{tabular}{|c|c|c|} \hline LVL2 processing & Nominal time & Total time \\ \hline \hline RoI request Formulation : per RoI & 10 μs & 11.111 μs \\ \hline Decision processing & 5 μs & 5.555 μs \\ \hline Global step & 50 μs & 55.555 μs \\ \hline \end{tabular}
\end{table}
Table 13: Execution times for processing steps other than feature extraction

[MISSING_PAGE_FAIL:13]

The average per event of the number of ROBIns receiving a RoI request can be calculated from the average number of RoIs per event and the average number of ROBIns per RoI. Table 16 contains results for this quantity. For low luminosity running B-physics triggering is assumed, the fixed frequency for the B-physics trigger causes the dependendence on the LVL1 rate.

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline Processing strategy & Low lumi, 40.1 kHz & Low lumi, 75 kHz & High luminosity \\ \hline \hline non-sequential & 934 & 507 & 39.7 \\ \hline sequential & 136 & 81.5 & 23.4 \\ \hline approximately fully sequential & 133 & 78.8 & 14.4 \\ \hline \end{tabular}
\end{table}
Table 16: Average per event of the number of ROBIns receiving a RoI request

Figure 3: RoI rates (kHz), high luminosity, 39.4 kHz LVL1 rate, sequential processing

[MISSING_PAGE_EMPTY:15]

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em calorimeter & had calorimeter & TRT & SCT & Pixels & Total \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate, B-physics**} \\ \hline non- & 4625.9 & 1156.5 & 18910.8 & 2580.2 & 6278.1 & 2326.0 & 2171.0 & 38048.5 \\ sequential & _1156.5_ & _289.1_ & _9632.61_ & _1335.901_ & & & _23189.3_ \\ \hline \multirow{2}{*}{sequential} & 153.5 & 81.1 & 872.6 & 204.5 & 2747.5 & 1041.4 & 1012.2 & 6112.8 \\  & _153.5_ & _81.1_ & _698.31_ & _145.61_ & & & & _5879.7_ \\ \hline fully & 153.5 & 81.1 & 668.2 & 675.72 & 200.2 & 202.22 & 2745.3 & 1039.9 & 1010.4 & 5898.7 \\ sequential & _153.5_ & _81.1_ & _496.0 & 541.212_ & _131.3 144.02_ & & & & _5657.6_ \\ \hline \end{tabular}
\end{table}
Table 17: Low luminosity, total RoI fragment rate (kHz) from the ROBIns and into the LVL2 processors (italic numbers) if ROBOuts merge RoI fragments. 1) grouping in the order as implied by the specification of the ROB mapping in the appendix, 2) approximately fully sequential processing

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em calorimeter & had calorimeter & TRT & SCT & Pixels & Total \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, B-physics**} \\ \hline non- & 3848.7 & 476.5 & 34133.8 & 4540.4 & 4869.4 & \multirow{2}{*}{641.6} & \multirow{2}{*}{235.5} & 48746.0 \\ sequential & 3848.7 & _19675.4_ & _2617.2_ & _2067.3_ & & & _29562.2_ \\ \hline sequential & 86.0 & 22.5 & 1087.8 & 286.8 & 2069.0 & \multirow{2}{*}{276.3} & \multirow{2}{*}{103.9} & \multirow{2}{*}{3932.2} \\ sequential & 86.0 & 22.5 & 627.0 & _165.3_ & _878.4_ & & & _2159.4_ \\ \hline fully & 86.0 & 22.5 & 887.1 & 894.71 & 282.5 & 284.51 & 2068.4 & \multirow{2}{*}{276.1} & \multirow{2}{*}{103.7} & \multirow{2}{*}{3726.2} \\ sequential & 86.0 & 22.5 & _511.3 & 515.71_ & _162.8 164.01_ & & & _2040.6_ \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, no B-physics**} \\ \hline non- & 48.1 & 12.6 & 1222.8 & 450.6 & 159.4 & \multirow{2}{*}{40.1} & \multirow{2}{*}{21.7} & 1955.3 \\ sequential & 48.1 & 12.6 & _704.8_ & _259.7_ & _67.7_ & & & _1154.7_ \\ \hline sequential & 48.1 & 12.6 & 842.1 & 195.5 & 91.6 & \multirow{2}{*}{20.0} & \multirow{2}{*}{10.9} & \multirow{2}{*}{1220.9} \\ _485.4_ & _112.7_ & _38.9_ & _20.0_ & & & _728.7_ \\ \hline fully & 48.1 & 12.6 & 550.6 & 558.21 & 191.2 193.21 & 91.0 & \multirow{2}{*}{19.8} & \multirow{2}{*}{10.8} & \multirow{2}{*}{557.5} \\ sequential & 48.1 & 12.6 & _317.4 & 321.81_ & _110.2 111.41_ & & & & _924.1_ \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate, B-physics**} \\ \hline non- & 3848.7 & 476.5 & 34644.6 & 4726.9 & 4909.5 & \multirow{2}{*}{655.9} & \multirow{2}{*}{243.2} & 49505.3 \\ sequential & 3848.7 & _19969.8_ & _2724.7_ & & & & _30003.1_ \\ \hline sequential & 127.7 & 33.4 & 1598.6 & 374.6 & 2148.6 & \multirow{2}{*}{293.7} & \multirow{2}{*}{113.4} & 4689.9 \\ sequential & 127.7 & 33.4 & _921.5_ & _215.9_ & _912.2_ & & & _2617.8_ \\ \hline fully & 1224.1 & 1237.81 & 366.7 & 370.41 & 2147.5 & \multirow{2}{*}{293.3} & \multirow{2}{*}{113.1} & \multirow{2}{*}{4305.9} \\ sequential & 127.7 & 33.4 & _705.6 & _713.51_ & _211.4 213.51_ & & & _2396.3_ \\ \hline \end{tabular}
\end{table}
Table 18: Low luminosity, total RoI data volume (MByte/s) with and without pre-processing (italic numbers) transferred to the LVL2 processors. 1) approximately fully sequential processing

#### 4.2.2 High luminosity

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em calorimeter & had calorimeter & TRT & SCT & Pixels & Total \\ \hline \hline \multicolumn{10}{|c|}{**39.4 kHz LVL1 rate**} \\ \hline non- & 28.8 & 15.2 & 701.7 & 258.3 & 189.1 & 157.7 & 213.4 & 1564.3 \\ sequential & _28.8_ & _15.2_ & _566.21_ & _185.11_ & & & & _1355.5_ \\ \hline sequential & 28.8 & 15.2 & 598.2 & 84.6 & 73.8 & 50.7 & 69.3 & 920.6 \\ _28.8_ & _15.2_ & _482.21_ & _60.21_ & & & & _780.2_ \\ \hline fully sequential & 20.0 & 10.5 & 317.6 317.72 & 72.5 72.52 & 54.4 & 38.5 & 52.5 & 566.0 \\ _26.0_ & _10.5_ & _226.6 255.012_ & _45.6 51.412_ & & & & _448.1_ \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate**} \\ \hline non- & 54.8 & 29.0 & 1335.9 & 491.8 & 360.0 & 300.2 & 406.4 & 2978.1 \\ sequential & _54.8_ & _29.0_ & _1077.91_ & _352.41_ & & & _2580.7_ \\ \hline sequential & 54.8 & 29.0 & 1138.9 & 161.1 & 140.5 & 96.5 & 131.9 & 1752.7 \\ _54.8_ & _29.0_ & _918.11_ & _114.61_ & & & & _1485.4_ \\ \hline fully sequential & 38.0 & 20.1 & 604.7 604.82 & 138.1 138.12 & 103.6 & 73.2 & 100.0 & 1077.7 \\ _38.0_ & _20.1_ & _431.5 485.412_ & _86.8 97.912_ & & & & 853.2 \\ \hline \end{tabular}
\end{table}
Table 20: High luminosity, total RoI fragment rate (kHz) from the ROBInns and into the LVL2 processors (italic numbers) if ROBOuts merge RoI fragments. 1) grouping in the order as implied by the specification of the ROB mapping in the appendix, 2) approximately fully sequential processing

Figure 5: High luminosity, 39.4 kHz LVL1 rate, sequential processing. The RoI fragment rate is the total rate into the LVL2 processors

\begin{tabular}{|c|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em calorimeter & had calorimeter & TRT & SCT & Pixels & Total \\ \hline \hline \multicolumn{10}{|c|}{**39.4 kHz LVL1 rate**} \\ \hline non- & \multirow{2}{*}{24.0} & \multirow{2}{*}{6.3} & 1285.5 & 473.3 & \multirow{2}{*}{195.1} & \multirow{2}{*}{257.3} & \multirow{2}{*}{177.6} & 2419.1 \\ sequential & & & _741.0_ & & _272.8_ & & & _1674.1_ \\ \hline sequential & \multirow{2}{*}{24.0} & \multirow{2}{*}{6.3} & 1095.9 & 155.1 & \multirow{2}{*}{76.2} & \multirow{2}{*}{82.8} & \multirow{2}{*}{57.6} & 1497.7 \\  & & & _631.7_ & & _89.4_ & & & _967.9_ \\ \hline fully & \multirow{2}{*}{16.6} & \multirow{2}{*}{4.3} & 581.9 & 582.0\({}^{1}\) & 132.8 & 132.9\({}^{1}\) & \multirow{2}{*}{56.3} & \multirow{2}{*}{62.8} & \multirow{2}{*}{43.7} & 898.5 \\ sequential & & & _335.4 & _335.5\({}^{1}\)_ & _76.6 & 76.6\({}^{1}\)_ & & & _595.7_ \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate**} \\ \hline non- & \multirow{2}{*}{45.6} & \multirow{2}{*}{11.9} & 2447.4 & 901.0 & \multirow{2}{*}{371.5} & \multirow{2}{*}{489.9} & \multirow{2}{*}{338.1} & 4605.5 \\ sequential & & & _1410.7_ & & _519.4_ & & & _3187.2_ \\ \hline sequential & \multirow{2}{*}{45.6} & \multirow{2}{*}{11.9} & 2086.4 & 295.2 & \multirow{2}{*}{145.0} & \multirow{2}{*}{157.6} & \multirow{2}{*}{109.7} & 2851.4 \\ \(1202.7\) & & & _170.2_ & & & & _1842.6_ \\ \hline fully & \multirow{2}{*}{31.6} & \multirow{2}{*}{8.3} & 1107.9 & 1108.1\({}^{1}\) & 252.9 & 253.0\({}^{1}\) & \multirow{2}{*}{107.2} & \multirow{2}{*}{119.6} & \multirow{2}{*}{83.1} & 1710.6 \\ sequential & & & _638.6 & _638.7\({}^{1}\)_ & _145.8 & _145.8\({}^{1}\)_ & & & _1134.2_ \\ \hline \end{tabular}

_Table 21. High luminosity, total RoI data volume (MByte/s) without and with pre-processing (italic numbers) transferred to the LVL2 processors. \({}^{1}\)) approximately fully sequential processing_

\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels & Total \\ \hline \hline  & 314.6 & 39.0 & 2742.5 & 353.6 & 520.4 & 295.7 & 137.7 & 4403.5 \\ \hline \end{tabular}

_Table 22. High luminosity, total data volume to the Event Builder(MByte/s)_

### Results for the ROBs

#### 4.3.1 Average RoI request rate, average RoI data volume, average data volume to EB

#### 4.3.1.1 Low luminosity

\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em calorimeter & had calorimeter & TRT & SCT & Pixels & Total \\ \hline \hline \multicolumn{10}{|c|}{**39.4 kHz LVL1 rate**} \\ \hline non- & \multirow{2}{*}{24.0} & \multirow{2}{*}{6.3} & 1285.5 & 473.3 & \multirow{2}{*}{195.1} & \multirow{2}{*}{257.3} & \multirow{2}{*}{177.6} & 2419.1 \\ sequential & & & _741.0_ & & _272.8_ & & & _1674.1_ \\ \hline sequential & \multirow{2}{*}{24.0} & \multirow{2}{*}{6.3} & 1095.9 & 155.1 & \multirow{2}{*}{76.2} & \multirow{2}{*}{82.8} & \multirow{2}{*}{57.6} & 1497.7 \\  & & & _631.7_ & & _89.4_ & & & _967.9_ \\ \hline fully & \multirow{2}{*}{16.6} & \multirow{2}{*}{4.3} & 581.9 & 582.0\({}^{1}\) & 132.8 & 132.9\({}^{1}\) & \multirow{2}{*}{56.3} & \multirow{2}{*}{62.8} & \multirow{2}{*}{43.7} & 898.5 \\ sequential & & & _335.4 & _335.5\({}^{1}\)_ & _76.6 & 76.6\({}^{1}\)_ & & & _595.7_ \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate**} \\ \hline non- & \multirow{2}{*}{45.6} & \multirow{2}{*}{11.9} & 2447.4 & 901.0 & \multirow{2}{*}{371.5} & \multirow{2}{*}{489.9} & \multirow{2}{*}{338.1} & 4605.5 \\ sequential & & & _1410.7_ & & _519.4_ & & & _3187.2_ \\ \hline sequential & \multirow{2}{*}{45.6} & \multirow{2}{*}{11.9} & 2086.4 & 295.2 & \multirow{2}{*}{145.0} & \multirow{2}{*}{157.6} & \multirow{2}{*}{109.7} & 2851.4 \\ \(1202.7\) & & & _170.2_ & & & & _1842.6_ \\ \hline fully & \multirow{2}{*}{31.6} & \multirow{2}{*}{8.3} & 1107.9 & 1108.1\({}^{1}\) & 252.9 & 253.0\({}^{1}\) & \multirow{2}{*}{107.2} & \multirow{2}{*}{119.6} & \multirow{2}{*}{83.1} & 1710.6 \\ sequential & & & _638.6 & _638.7\({}^{1}\)_ & & _145.8 & _145.8\({}^{1}\)_ & & _1134.2_ \\ \hline \end{tabular}

_Table 21. High luminosity, total RoI data volume (MByte/s) without and with pre-processing (italic numbers) transferred to the LVL2 processors. \({}^{1}\)) approximately fully sequential processing_

\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels & Total \\ \hline \hline  & 314.6 & 39.0 & 2742.5 & 353.6 & 520.4 & 295.7 & 137.7 & 4403.5 \\ \hline \end{tabular}

_Table 22. High luminosity, total data volume to the Event Builder(MByte/s)_

#### 4.3.1 Average RoI request rate, average RoI data volume to EB

#### 4.3.1.1 Low luminosity

\begin{tabular}{|c|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em calorimeter & had calorimeter & TRT & SCT & Pixels & Total \\ \hline \hline \multicolumn{10}{|c|}{**39.4 kHz LVL1 rate**} \\ \hline non- & \multirow{2}{*}{24.0} & \multirow{2}{*}{6.3} & 1285.5 & 473.3 & \multirow{2}{*}{195.1} & \multirow{2}{*}{257.3} & \multirow{2}{*}{177.6} & 2419.1 \\ sequential & & & _741.0_ & & _272.8_ & & & _1674.1_ \\ \hline sequential & \multirow{2}{*}{24.0} & \multirow{2}{*}{6.3} & 1095.9 & 155.1 & \multirow{2}{*}{89.4} & \multirow{2}{*}{76.2} & \multi

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, B-physics**} \\ \hline non-sequential & 24.09 & 24.09 & 24.52 & 25.29 & 24.32 & 25.73 & 25.03 \\ \hline sequential & 0.54 & 1.14 & 0.78 & 1.60 & 10.34 & 10.65 & 11.04 \\ \hline fully sequential & 0.54 & 1.14 & 0.64 & 1.57 & 10.33 & 10.64 & 11.03 \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, no B-physics**} \\ \hline non-sequential & 0.30 & 0.64 & 0.88 & 2.51 & 0.80 & 1.54 & 2.31 \\ \hline sequential & 0.30 & 0.64 & 0.60 & 1.09 & 0.46 & 0.77 & 1.16 \\ \hline fully sequential & 0.30 & 0.64 & 0.40 & 1.06 & 0.45 & 0.76 & 1.15 \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate, B-physics**} \\ \hline non-sequential & 24.09 & 24.09 & 24.88 & 26.33 & 24.52 & 25.28 & 25.85 \\ \hline sequential & 0.80 & 1.69 & 1.15 & 2.09 & 10.73 & 11.32 & 12.05 \\ \hline fully sequential & 0.80 & 1.69 & 0.88 & 2.04 & 10.73 & 11.30 & 12.03 \\ \hline \end{tabular}
\end{table}
Table 23: Low luminosity, RoI request rate per ROBIn (kHz)

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, B-physics**} \\ \hline non-sequential & 20.05 & 9.93 & 44.91 & 46.33 & 19.02 & 6.97 & 2.80 \\  & & _25.89_ & _26.71_ & _8.08_ & & \\ \hline sequential & 0.45 & 0.47 & 1.43 & 2.93 & 8.08 & 3.00 & 1.24 \\  & & _0.83_ & _1.69_ & _3.43_ & & \\ \hline fully sequential & 0.45 & 0.47 & 1.17 & 2.88 & 8.08 & 3.00 & 1.24 \\  & & _0.67_ & _1.66_ & _3.43_ & & \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, no B-physic**} \\ \hline non-sequential & 0.25 & 0.26 & 1.61 & 4.60 & 0.62 & 0.44 & 0.26 \\  & & _0.93_ & _2.65_ & _0.26_ & & \\ \hline sequential & 0.25 & 0.26 & 1.11 & 1.99 & 0.36 & 0.22 & 0.13 \\  & & _0.64_ & _1.15_ & _0.15_ & & \\ \hline fully sequential & 0.25 & 0.26 & 0.72 & 1.95 & 0.36 & 0.22 & 0.13 \\  & & _0.42_ & _1.12_ & _0.15_ & & \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate, B-physics**} \\ \hline non-sequential & 20.05 & 9.93 & 45.58 & 48.23 & 19.18 & 7.13 & 2.89 \\  & & _26.28_ & _27.80_ & _8.14_ & & \\ \hline sequential & 0.67 & 0.70 & 2.10 & 3.82 & 8.39 & 3.19 & 1.35 \\  & & _1.21_ & _2.20_ & _3.56_ & & \\ \hline fully sequential & 0.67 & 0.70 & 1.61 & 3.74 & 8.39 & 3.19 & 1.35 \\  & & _0.93_ & _2.16_ & _3.56_ & & \\ \hline \end{tabular}
\end{table}
Table 24: Low luminosity, RoI data volume per ROBIn (MByte/s), italic numbers indicate the use of pre-processing in the calorimeter and TRT ROBs

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, B-physics**} \\ \hline non-sequential & 20.05 & 9.93 & 44.91 & 46.33 & 19.02 & 6.97 & 2.80 \\  & & _25.89_ & _26.71_ & _8.08_ & & \\ \hline sequential & 0.45 & 0.47 & 1.43 & 2.93 & 8.08 & 3.00 & 1.24 \\  & & _0.83_ & _1.69_ & _3.43_ & & \\ \hline fully sequential & 0.45 & 0.47 & 1.17 & 2.88 & 8.08 & 3.00 & 1.24 \\  & & _0.67_ & _1.66_ & _3.43_ & & \\ \hline \hline \multicolumn{10}{|c|}{**40.1 kHz LVL1 rate, no B-physic**} \\ \hline non-sequential & 0.25 & 0.26 & 1.61 & 4.60 & 0.62 & 0.44 & 0.26 \\  & & _0.93_ & _2.65_ & _0.26_ & & \\ \hline sequential & 0.25 & 0.26 & 1.11 & 1.99 & 0.36 & 0.22 & 0.13 \\  & & _0.64_ & _1.15_ & _0.15_ & & \\ \hline fully sequential & 0.25 & 0.26 & 0.72 & 1.95 & 0.36 & 0.22 & 0.13 \\  & & _0.42_ & _1.12_ & _0.15_ & & \\ \hline \hline \multicolumn{10}{|c|}{**75 kHz LVL1 rate, B-physics**} \\ \hline non-sequential & 20.05 & 9.93 & 45.58 & 48.23 & 19.18 & 7.13 & 2.89 \\  & & _26.28_ & _27.80_ & _8.14_ & & \\ \hline sequential & 0.67 & 0.70 & 2.10 & 3.82 & 8.39 & 3.19 & 1.35 \\  & & _1.21_ & _2.20_ & _3.56_ & & \\ \hline fully sequential & 0.67 & 0.70 & 1.61 & 3.74 & 8.39 & 3.19 & 1.35 \\  & & _0.93_ & _2.16_ & _3.56_ & & \\ \hline \end{tabular}
\end{table}
Table 25: Low luminosity, average data volume to the Event Builder per ROBIn (MByte/s), the italic number indicates the use of pre-processing in the TRT ROBs

[MISSING_PAGE_EMPTY:20]

[MISSING_PAGE_EMPTY:21]

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**non-sequential processing, B-physics trigger**} \\ \hline Lower limit (kHz) & 24.09 & 24.09 & 24.17 & 24.37 & 24.30 & 24.33 & 24.63 \\ \hline Average (kHz) & 24.09 & 24.09 & 24.52 & 25.29 & 24.32 & 24.73 & 25.03 \\ \hline Upper limit (kHz) & 24.09 & 24.09 & 25.21 & 26.09 & 24.40 & 25.00 & 25.88 \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger**} \\ \hline Lower limit (kHz) & 0.18 & 0.54 & 0.25 & 0.69 & 10.32 & 10.21 & 10.58 \\ \hline Average (kHz) & 0.54 & 1.14 & 0.78 & 1.60 & 10.34 & 10.65 & 11.04 \\ \hline Upper limit (kHz) & 1.18 & 1.76 & 2.07 & 2.68 & 10.39 & 11.05 & 11.93 \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**approximately fully sequential processing, B-physics trigger**} \\ \hline Lower limit (kHz) & 0.18 & 0.54 & 0.25 & 0.69 & 10.31 & 10.21 & 10.57 \\ \hline Average (kHz) & 0.54 & 1.14 & 0.64 & 1.58 & 10.33 & 10.64 & 11.03 \\ \hline Upper limit (kHz) & 1.18 & 1.76 & 2.00 & 2.66 & 10.38 & 11.03 & 11.91 \\ \hline \end{tabular}
\end{table}
Table 29: Low luminosity, 40.1 kHz LVL1 rate, RoI request rate per ROBIn

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**non-sequential processing, B-physics trigger**} \\ \hline Lower limit (kHz) & 24.09 & 24.09 & 24.23 & 24.62 & 24.47 & 24.54 & 25.09 \\ \hline Average (kHz) & 24.09 & 24.09 & 24.88 & 26.33 & 24.52 & 25.28 & 25.85 \\ \hline Upper limit (kHz) & 24.09 & 24.09 & 26.17 & 27.82 & 24.66 & 25.78 & 27.43 \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger**} \\ \hline Lower limit (kHz) & 0.26 & 0.80 & 0.31 & 0.93 & 10.70 & 10.50 & 11.18 \\ \hline Average (kHz) & 0.80 & 1.69 & 1.15 & 2.09 & 10.73 & 11.32 & 12.05 \\ \hline Upper limit (kHz) & 1.75 & 2.62 & 3.04 & 3.47 & 10.83 & 12.06 & 13.71 \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**approximately fully sequential processing, B-physics trigger**} \\ \hline Lower limit (kHz) & 0.26 & 0.80 & 0.31 & 0.93 & 10.69 & 10.49 & 11.17 \\ \hline Average (kHz) & 0.80 & 1.69 & 0.89 & 2.06 & 10.73 & 11.31 & 12.03 \\ \hline Upper limit (kHz) & 1.75 & 2.62 & 2.90 & 3.43 & 10.82 & 12.04 & 13.67 \\ \hline \end{tabular}
\end{table}
Table 30: Low luminosity, 75 kHz LVL1 rate, sequential processing, B-physics trigger, RoI request rate per ROBIn

[MISSING_PAGE_EMPTY:23]

#### 4.3.3 Lower limit, average and upper limit of data volume sent to LVL2 per ROBIn

Lower / upper limits for the data volumes sent to the LVL2 system have been obtained by summing the minimum / maximum data volumes for the different RoI types. It is not taken into account that these minima / maxima may occur for different ROBIns, so only lower and upper limits are presented here. For the average data volumes for fully sequential processing see Section 4.3.1, in this section results are provided for approximate fully sequential processing. The differences between the two types of results are very small.

#### 4.3.3.1 Low luminosity

Figure 10: Low luminosity, nominal LVL1 rate, sequential processing, B-physics trigger

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline \multicolumn{2}{|c|}{Detector -\(>\)} & \multicolumn{1}{c|}{mu prec} & \multicolumn{1}{c|}{mu trig} & \multicolumn{1}{c|}{em cal} & \multicolumn{1}{c|}{had cal} & \multicolumn{1}{c|}{TRT} & \multicolumn{1}{c|}{SCT} & \multicolumn{1}{c|}{Pixels} \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**non-sequential processing**} \\ \hline Lower limit (kHz) & 0.09 & 0.29 & 0.31 & 0.88 & 1.28 & 1.27 & 2.81 \\ \hline Average (kHz) & 0.29 & 0.60 & 1.76 & 5.02 & 1.41 & 3.26 & 4.84 \\ \hline Upper limit (kHz) & 0.62 & 0.94 & 4.69 & 8.53 & 1.73 & 4.72 & 9.00 \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**sequential processing**} \\ \hline Lower limit (kHz) & 0.09 & 0.29 & 0.19 & 0.58 & 0.52 & 0.43 & 0.93 \\ \hline Average (kHz) & 0.29 & 0.60 & 1.50 & 1.64 & 0.55 & 1.05 & 1.57 \\ \hline Upper limit (kHz) & 0.62 & 0.94 & 3.99 & 2.74 & 0.63 & 1.56 & 2.84 \\ \hline \hline RoI request rate & \multicolumn{6}{|c|}{**approximately fully sequential processing**} \\ \hline Lower limit (kHz) & 0.06 & 0.20 & 0.16 & 0.52 & 0.38 & 0.33 & 0.70 \\ \hline Average (kHz) & 0.20 & 0.42 & 0.80 & 1.41 & 0.41 & 0.80 & 1.19 \\ \hline Upper limit (kHz) & 0.43 & 0.65 & 3.43 & 2.33 & 0.47 & 1.18 & 2.16 \\ \hline \end{tabular}
\end{table}
Table 32: High luminosity, 75 kHz LVL1 rate, sequential processing, RoI request rate per ROBIn

\begin{tabular}{|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline Data volume to LVL2 & \multicolumn{6}{|c|}{**non-sequential processing, B-physics trigger**} \\ \hline Lower limit (MByte/s) & 20.05 & 9.93 & 44.27 & 44.65 & 19.00 & 6.86 & 2.76 \\ \hline Average (MByte/s) & 20.05 & 9.93 & 44.91 & 46.33 & 19.02 & 6.97 & 2.80 \\ \hline Upper limit (MByte/s) & 20.05 & 9.93 & 46.18 & 47.79 & 19.08 & 7.05 & 2.90 \\ \hline \hline Data volume to LVL2 & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger**} \\ \hline Lower limit (MByte/s) & 0.15 & 0.22 & 0.46 & 1.26 & 8.07 & 2.88 & 1.18 \\ \hline Average (MByte/s) & 0.45 & 0.47 & 1.43 & 2.93 & 8.08 & 3.00 & 1.24 \\ \hline Upper limit (MByte/s) & 0.98 & 0.73 & 3.80 & 4.91 & 8.12 & 3.45 & 3.11 & 1.34 \\ \hline \hline Data volume to LVL2 & \multicolumn{6}{|c|}{**approximately fully sequential processing, B-physics trigger**} \\ \hline Lower limit (MByte/s) & 0.15 & 0.22 & 0.46 & 1.26 & 8.07 & 2.88 & 1.18 \\ \hline Average (MByte/s) & 0.45 & 0.47 & 1.18 & 2.90 & 8.08 & 3.00 & 1.24 \\ \hline Upper limit (MByte/s) & 0.98 & 0.73 & 3.66 & 4.87 & 8.12 & 3.45 & 3.11 & 1.34 \\ \hline \end{tabular}

_Table 33. Low luminosity, 40.1 kHz LVL1 rate, italic numbers indicate the use of preprocessing in the calorimeter and TRT ROBs, volume of data sent per ROBIn to LVL2_

Figure 11. Low luminosity, nominal LVL1 rate, sequential processing, B-physics trigger, preprocessing in calorimeter and TRT ROBs for reducing event fragment sizes

#### 4.3.3.2 High luminosity

Figure 12: High luminosity, 39.4 kHz LVL1 rate, sequential processing

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline Data volume to LVL2 & \multicolumn{6}{|c|}{**non-sequential processing, B-physics trigger**} \\ \hline Lower limit (MByte/s) & 20.05 & 9.93 & 44.39 & 45.10 & 19.14 _25.59_ & _8.12_ & 6.92 & 2.81 \\ \hline Average (MByte/s) & 20.05 & 9.93 & 45.58 & 48.23 & 19.18 _27.80_ & _8.14_ & 7.13 & 2.89 \\ \hline Upper limit (MByte/s) & 20.05 & 9.93 & 47.95 & 50.96 _27.64_ & _29.38_ & _8.19_ & 7.27 & 3.07 \\ \hline \hline Data volume to LVL2 & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger**} \\ \hline Lower limit (MByte/s) & 0.22 & 0.33 & 0.57 _0.33_ & 1.71 _0.98_ & _8.37_ & 2.96 & 1.25 \\ \hline Average (MByte/s) & 0.67 & 0.70 & 2.10 _1.21_ & 3.82 _2.20_ & _8.39_ & 3.19 & 1.35 \\ \hline Upper limit (MByte/s) & 1.45 & 1.08 & 5.57 _0.32_ & 6.35 _0.36_ & _8.47_ & 3.40 & 1.54 \\ \hline \hline Data volume to LVL2 & \multicolumn{6}{|c|}{**approximately fully sequential processing, B-physics trigger**} \\ \hline Lower limit (MByte/s) & 0.22 & 0.33 & 0.57 _0.33_ & 1.71 _0.98_ & _8.36_ & 2.96 & 1.25 \\ \hline Average (MByte/s) & 0.67 & 0.70 & 1.63 _0.94_ & 3.78 _0.35_ & 8.39 _3.56_ & 3.19 & 1.35 \\ \hline Upper limit (MByte/s) & 1.45 & 1.08 & 5.32 _0.06_ & _8.28_ & _8.46_ & 3.39 & 1.53 \\ \hline \end{tabular}
\end{table}
Table 34: Low luminosity, 75 kHz LVL1 rate, sequential processing, B-physics trigger, italic numbers indicate the use of pre-processing in the calorimeter and TRT ROB, volume of data sent per ROBIn to LVL2

Figure 12: High luminosity, 39.4 kHz LVL1 rate, sequential processing

\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline Data volume to LVL2 & \multicolumn{10}{|c|}{**non-sequential processing**} \\ \hline Lower limit (MByte/s) & 0.04 & 0.06 & 0.30 & 0.85 & 0.70 & 1.09 & 1.23 \\ \hline Average (MByte/s) & 0.12 & 0.13 & 1.69 & 4.83 & 0.76 & 2.80 & 2.11 \\ \hline Upper limit (MByte/s) & 0.27 & 0.20 & 4.51 & 8.21 & 0.94 & 4.05 & 3.93 \\ \hline \hline Data volume to LVL2 & \multicolumn{10}{|c|}{**sequential processing**} \\ \hline Lower limit (MByte/s) & 0.04 & 0.06 & 0.18 & 0.56 & 0.28 & 0.37 & 0.41 \\ \hline Average (MByte/s) & 0.12 & 0.13 & 1.44 & 1.58 & 0.30 & 0.90 & 0.69 \\ \hline Upper limit (MByte/s) & 0.27 & 0.20 & 3.84 & 2.63 & 2.63 & 0.34 & 1.34 & 1.24 \\ \hline \hline Data volume to LVL2 & \multicolumn{10}{|c|}{**approximately fully sequential processing**} \\ \hline Lower limit (MByte/s) & 0.03 & 0.04 & 0.15 & 0.50 & 0.29 & 0.21 & 0.28 & 0.31 \\ \hline Average (MByte/s) & 0.09 & 0.09 & 0.77 & 1.36 & 0.22 & 0.68 & 0.52 \\ \hline Upper limit (MByte/s) & 0.19 & 0.14 & 3.30 & 2.25 & 2.25 & 0.26 & 1.01 & 0.94 \\ \hline \end{tabular}

_Table 35. High luminosity, 39.4 kHz LVL1 rate, italic numbers indicate the use of preprocessing in the calorimeter ROBs, volume of data sent per ROBIn to LVL2_

Figure 13. High luminosity, 39.4 kHz LVL1 rate, sequential processing, pre-processing in the calorimeter ROBs for reducing event fragment sizes

#### 4.3.4 Rates and data volumes for the ROBOuts

The average input fragment rate for the ROBOuts, which is equal to the output RoI request rate, can be obtained by multiplying the number of ROBIns connected with the average RoI request rate per ROBIn (see Section 4.3.2). Table 37 and Table 38 contain results for the output rate (which is equal to the input RoI request rate), assuming grouping in the order as implied by the specification of the ROB mapping in the appendix and a grouping factor of 4 for the muon detectors and of 2 for the calorimeters. Lower / upper limits for the rates have been obtained by summing the minimum / maximum rates for the different RoI types, as obtained from the program described in appendix A. It is not taken into account that these minima / maxima may occur for different ROBOuts, so only lower and upper limits are presented here. If data for the Event Builder also passes through the ROBOuts the event building rate (5% of the nominal LVL1 rate, i.e. about 2 kHz) has to be added to the rates in the tables.

The average volume of the event data flowing through the ROBOuts is equal to the product of the number of ROBIns connected and the average data volume output by per ROBIn (see Section 4.3.3). Lower and upper limits can be obtained in the same way. If data for the Event Builder also passes through the ROBOuts the average volume of this data has also to be taken into account (see Table 25 and Table 28).

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline Data volume to LVL2 & \multicolumn{8}{|c|}{**non-sequential processing**} \\ \hline Lower limit (MByte/s) & 0.08 & 0.12 & 0.57 & 1.61 & 1.32 & 2.08 & 2.34 \\ \hline Average (MByte/s) & 0.24 & 0.25 & 3.22 & 9.19 & 9.19 & 5.30 & 1.45 & 5.33 & 4.02 \\ \hline Upper limit (MByte/s) & 0.52 & 0.39 & 8.58 & 15.63 & 9.01 & 1.79 & 7.71 & 7.49 \\ \hline \hline Data volume to LVL2 & \multicolumn{8}{|c|}{**sequential processing**} \\ \hline Lower limit (MByte/s) & 0.08 & 0.12 & 0.34 & 1.07 & 1.07 & 0.53 & 0.71 & 0.77 \\ \hline Average (MByte/s) & 0.24 & 0.25 & 2.75 & 3.01 & 1.74 & 0.57 & 1.71 & 1.31 \\ \hline Upper limit (MByte/s) & 0.52 & 0.39 & 7.31 & 5.02 & 2.89 & 0.65 & 2.54 & 2.36 \\ \hline \hline Data volume to LVL2 & \multicolumn{8}{|c|}{**approximately fully sequential processing**} \\ \hline Lower limit (MByte/s) & 0.05 & 0.08 & 0.29 & 0.96 & 0.55 & 0.39 & 0.53 & 0.59 \\ \hline Average (MByte/s) & 0.16 & 0.17 & 1.46 & 2.58 & 1.49 & 0.42 & 1.30 & 0.99 \\ \hline Upper limit (MByte/s) & 0.36 & 0.27 & 6.28 & 4.28 & 4.28 & 0.49 & 1.92 & 1.80 \\ \hline \end{tabular}
\end{table}
Table 36: High luminosity, 75 kHz LVL1 rate, italic numbers indicate the use of preprocessing in the calorimeter ROBs, volume of data sent per ROBIn to LVL2

#### 4.3.5 Lower limit, average and upper limit of ROBIn and ROBOut occupancies

The differences in ROBIn occupancies for sequential or non-sequential processing are much larger for low than for high luminosity due to the large increase in RoI request rate for low luminosity.

The ROBOut occupancies have been calculated assuming grouping in the order as implied by the specification of the ROB mapping in the appendix and a grouping factor of 4 for the muon detectors and of 2 for the calorimeters.

\begin{table}
\begin{tabular}{|l|c|c|c|c||c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & mu prec & mu trig & em cal & had cal \\ \hline \hline ROBOut output rate & \multicolumn{3}{c||}{**non-sequential processing, 39.4 kHz**} & \multicolumn{3}{c|}{**sequential processing, 39.4 kHz**} \\ \hline Lower limit (kHz) & 0.29 & 0.90 & 0.23 & 0.51 & 0.29 & 0.90 & 0.13 & 0.36 \\ \hline Average (kHz) & 0.60 & 1.27 & 1.49 & 3.78 & 0.60 & 1.27 & 1.27 & 1.23 \\ \hline Upper limit (kHz) & 0.98 & 1.97 & 4.48 & 6.59 & 0.98 & 1.97 & 3.81 & 2.11 \\ \hline ROBOut output rate & \multicolumn{3}{c||}{**non-sequential processing, 75 kHz**} & \multicolumn{3}{c|}{**sequential processing, 75 kHz**} \\ \hline Lower limit (kHz) & 0.56 & 1.72 & 0.43 & 0.98 & 0.56 & 1.72 & 0.25 & 0.68 \\ \hline Average (kHz) & 1.14 & 2.41 & 2.84 & 7.19 & 1.14 & 2.41 & 2.42 & 2.34 \\ \hline Upper limit (kHz) & 1.87 & 3.74 & 8.53 & 12.54 & 1.87 & 3.74 & 7.25 & 4.01 \\ \hline \end{tabular}
\end{table}
Table 38: High luminosity, ROBOut LVL2 fragment output rates

\begin{table}
\begin{tabular}{|l|c|c|c|c||c|c|c|c|} \hline Detector -\(>\) & mu prec & mu trig & em cal & had cal & mu prec & mu trig & em cal & had cal \\ \hline \hline ROBOut output rate & \multicolumn{3}{c||}{**non-sequential processing, 40.1 kHz**} & \multicolumn{3}{c|}{**sequential processing, 40.1 kHz**} \\ \hline Lower limit (kHz) & 24.09 & 24.09 & 24.19 & 24.44 & 1.05 & 3.23 & 0.34 & 0.76 \\ \hline Average (kHz) & 24.09 & 24.09 & 24.77 & 25.79 & 2.15 & 4.55 & 1.25 & 2.29 \\ \hline Upper limit (kHz) & 24.09 & 24.09 & 26.09 & 27.05 & 3.53 & 7.05 & 3.77 & 3.88 \\ \hline ROBOut output rate & \multicolumn{3}{c||}{**non-sequential processing, 75 kHz**} & \multicolumn{3}{c|}{**sequential processing, 75 kHz**} \\ \hline Lower limit (kHz) & 24.09 & 24.09 & 24.27 & 24.75 & 1.56 & 4.80 & 0.42 & 1.06 \\ \hline Average (kHz) & 24.09 & 24.09 & 25.35 & 27.26 & 3.20 & 6.76 & 1.84 & 2.97 \\ \hline Upper limit (kHz) & 24.09 & 24.09 & 27.82 & 29.61 & 5.24 & 10.48 & 5.50 & 5.04 \\ \hline \end{tabular}
\end{table}
Table 37: Low luminosity, ROBOut LVL2 fragment output rates

#### 4.3.5.1 Low luminosity, ROBIn occupancy

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline Detector \(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline ROBIn occupancy & \multicolumn{6}{|c|}{**non-sequential processing, B-physics trigger**} \\ \hline Lower limit (\%) & 139.0 & 139.0 & 139.5 & 140.7 & 140.2 & 140.4 & 142.2 \\ \hline Average (\%) & 139.0 & 139.0 & 141.5 & 146.0 & 140.4 & 142.7 & 144.5 \\ \hline Upper limit (\%) & 139.0 & 139.0 & 145.5 & 150.6 & 140.8 & 144.3 & 149.4 \\ \hline \hline ROBIn occupancy & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger**} \\ \hline Lower limit (\%) & 64.9 & 66.6 & 65.1 & 67.0 & 97.4 & 96.7 & 98.9 \\ \hline Average (\%) & 66.6 & 69.3 & 67.7 & 70.6 & 97.5 & 99.3 & 101.6 \\ \hline Upper limit (\%) & 69.5 & 72.2 & 73.5 & 74.9 & 97.8 & 101.6 & 106.8 \\ \hline \end{tabular}
\end{table}
Table 40: Low luminosity, 75 kHz LVL1 rate, ROBIn occupancy

Figure 14: Low luminosity, nominal LVL1 rate, sequential processing, B-physics trigger

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline Detector \(>\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline ROBIn occupancy & \multicolumn{6}{|c|}{**non-sequential processing, B-physics trigger**} \\ \hline Lower limit (\%) & 110.2 & 110.2 & 110.4 & 111.1 & 110.8 & 110.9 & 111.9 \\ \hline Average (\%) & 110.2 & 110.2 & 111.5 & 113.9 & 110.9 & 112.2 & 113.1 \\ \hline Upper limit (\%) & 110.2 & 110.2 & 113.7 & 116.4 & 111.1 & 113.0 & 115.7 \\ \hline \hline ROBIn occupancy & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger**} \\ \hline Lower limit (\%) & 35.8 & 36.9 & 36.0 & 37.4 & 67.3 & 67.0 & 68.1 \\ \hline Average (\%) & 36.9 & 38.8 & 37.7 & 40.2 & 67.4 & 68.4 & 69.6 \\ \hline Upper limit (\%) & 38.9 & 40.7 & 41.7 & 43.6 & 67.6 & 69.6 & 72.4 \\ \hline \end{tabular}
\end{table}
Table 39: Low luminosity, 40.1 kHz LVL1 rate, ROBIn occupancy

#### 4.3.5.2 High luminosity, ROBIn occupancy

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline Detector \(\textgreater{}\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline ROBIn occupancy & \multicolumn{8}{|c|}{**non-sequential processing**} \\ \hline Lower limit (\%) & 34.7 & 35.0 & 35.1 & 36.0 & 36.7 & 36.7 & 39.2 \\ \hline Average (\%) & 35.0 & 35.6 & 37.5 & 42.8 & 36.9 & 39.9 & 42.5 \\ \hline Upper limit (\%) & 35.6 & 36.1 & 42.2 & 48.5 & 37.4 & 42.3 & 49.3 \\ \hline \hline ROBIn occupancy & \multicolumn{8}{|c|}{**sequential processing**} \\ \hline Lower limit (\%) & 34.7 & 35.0 & 34.9 & 35.5 & 35.4 & 35.3 & 36.1 \\ \hline Average (\%) & 35.0 & 35.6 & 37.0 & 37.3 & 35.5 & 36.3 & 37.1 \\ \hline Upper limit (\%) & 35.6 & 36.1 & 41.1 & 39.1 & 35.6 & 37.1 & 39.2 \\ \hline \end{tabular}
\end{table}
Table 41: High luminosity, 39.4 kHz LVL1 rate, ROBIn occupancy

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline Detector \(\textgreater{}\) & mu prec & mu trig & em cal & had cal & TRT & SCT & Pixels \\ \hline \hline ROBIn occupancy & \multicolumn{8}{|c|}{**non-sequential processing**} \\ \hline Lower limit (\%) & 64.3 & 64.9 & 65.0 & 66.8 & 68.0 & 68.0 & 72.8 \\ \hline Average (\%) & 64.9 & 65.9 & 69.5 & 79.7 & 68.4 & 74.2 & 79.1 \\ \hline Upper limit (\%) & 66.0 & 67.0 & 78.6 & 90.6 & 69.4 & 78.7 & 92.1 \\ \hline \hline ROBIn occupancy & \multicolumn{8}{|c|}{**sequential processing**} \\ \hline Lower limit (\%) & 64.3 & 64.9 & 64.6 & 65.9 & 65.7 & 65.4 & 66.9 \\ \hline Average (\%) & 64.9 & 65.9 & 68.7 & 69.2 & 65.8 & 67.3 & 68.9 \\ \hline Upper limit (\%) & 66.0 & 67.0 & 76.5 & 72.6 & 66.0 & 68.9 & 72.9 \\ \hline \end{tabular}
\end{table}
Table 42: High luminosity, 75 kHz LVL1 rate, ROBIn occupancy

Figure 15: High luminosity, 39.4 kHz LVL1 rate, sequential processing

#### 4.3.5.3 Low luminosity, ROBOut occupancy

#### 4.3.5.4 High luminosity, ROBOut occupancy

#### 4.3.5.4 High luminosity, ROBOut occupancy

\begin{table}
\begin{tabular}{|l|c|c|c|c||c|c|c|c|} \hline Detector \(\textgreater{}\) & mu prec & mu trig & em cal & had cal & mu prec & mu trig & em cal & had cal \\ \hline \hline  & \multicolumn{6}{|c||}{without data for Event Builder} & \multicolumn{6}{|c|}{with data for Event Builder} \\ \hline ROBOut occ. & \multicolumn{6}{|c|}{**non-sequential processing, B-physics trigger, 40.1 kHz LVL1 rate**} \\ \hline Lower limit (\%) & 378.0 & 327.4 & 288.6 & 291.2 & 396.4 & 341.5 & 303.8 & 306.4 \\ \hline Average (\%) & 378.0 & 327.4 & 293.4 & 303.2 & 396.4 & 341.5 & 308.6 & 318.5 \\ \hline Upper limit (\%) & 378.0 & 327.4 & 303.5 & 314.0 & 396.4 & 341.5 & 318.7 & 329.2 \\ \hline \hline ROBOOut occ. & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger, 40.1 kHz LVL1 rate**} \\ \hline Lower limit (\%) & 15.4 & 25.5 & 9.2 _8.7_ & 13.0 _14.3_ & 33.8 & 39.7 & 24.4 _24.0_ & 29.5 _28.2_ \\ \hline Average (\%) & 23.3 & 35.6 & 16.6 _15.1_ & _23.7 26.8_ & 41.7 & 49.8 & 31.8 _30.3_ & 42.1 _39.0_ \\ \hline Upper limit (\%) & 35.3 & 49.7 & 35.5 _31.5_ & 35.9 _41.1_ & 53.7 & 63.9 & 50.7 _46.7_ & 56.3 _51.1_ \\ \hline \hline ROBOOut occ. & \multicolumn{6}{|c|}{**sequential processing, B-physics trigger, 75 kHz LVL1 rate**} \\ \hline Lower limit (\%) & 26.8 & 41.8 & 15.2 _14.6_ & 22.5 _20.7_ & 45.2 & 55.9 & 30.5 _29.9_ & 37.8 _36.0_ \\ \hline Average (\%) & 38.4 & 56.8 & 26.8 _24.6_ & 38.4 _34.3_ & 56.8 & 71.0 & 42.0 _39.8_ & 53.6 _49.6_ \\ \hline Upper limit (\%) & 56.3 & 77.7 & 54.4 _48.5_ & 56.7 _49.9_ & 74.7 & 91.9 & 69.6 _63.7_ & 71.9 _65.1_ \\ \hline \end{tabular}
\end{table}
Table 43: Low luminosity, italic numbers indicate the use of pre-processing, ROBOut occupancy

\begin{table}
\begin{tabular}{|l|c|c|c|c||c|c|c|c|} \hline Detector \(\textgreater{}\) & mu prec & mu trig & em cal & had cal & mu prec & mu trig & em cal & had cal \\ \hline \hline  & \multicolumn{6}{|c||}{without data for Event Builder} & \multicolumn{6}{|c|}{with data for Event Builder} \\ \hline ROBOut occ. & \multicolumn{6}{|c||}{**non-sequential processing, 39.4 kHz LVL1 rate**} \\ \hline Lower limit (\%) & 11.4 & 14.2 & 8.0 _7.7_ & 11.5 _10.6_ & 29.4 & 28.1 & 23.0 _22.6_ & 26.4 _25.5_ \\ \hline Average (\%) & 13.5 & 17.0 & 18.5 _16.7_ & 40.3 _35.2_ & 31.6 & 30.9 & 33.4 _31.6_ & 55.2 _50.1_ \\ \hline Upper limit (\%) & 16.9 & 20.9 & 41.0 _36.2_ & 64.9 _56.2_ & 34.9 & 34.8 & 55.9 _51.1_ & 79.8 _71.1_ \\ \hline \hline ROBOOut occ. & \multicolumn{6}{|c||}{**sequential processing, 39.4 kHz LVL1 rate**} \\ \hline Lower limit (\%) & 11.4 & 14.2 & 7.2 _7.0_ & 9.7 _9.1_ & 29.4 & 28.1 & 22.1 _21.9_ & 24.6 _24.0_ \\ \hline Average (\%) & 13.5 & 17.0 & 16.6 _15.1_ & 17.1 _15.5_ & 31.6 & 30.9 & 31.5 _30.0_ & 32.1 _30.4_ \\ \hline Upper limit (\%) & 16.9 & 20.9 & 35.8 _31.7_ & 24.8 _22.0_ & 34.9 & 34.8 & 50.7 _46.6_ & 39.7 _36.9_ \\ \hline \hline ROBOOut occ. & \multicolumn{6}{|c||}{**sequential processing, 75 kHz LVL1 rate**} \\ \hline Lower limit (\%) & 21.6 & 27.0 & 13.6 _13.3_ & 18.4 _17.3_ & 39.7 & 40.9 & 28.6 _28.2_ & 33.3 _32.2_ \\ \hline Average (\%) & 25.8 & 32.3 & 31.6 _28.7_ & 32.6 _29.4_ & 43.8 & 46.2 & 46.6 _43.6_ & 47.6 _44.4_ \\ \hline Upper limit (\%) & 32.2 & 39.8 & 68.1 _60.3_ & 47.2 _41.9_ & 50.2 & 53.7 & 83.0 _75.2_ & 62.1 _56.8_ \\ \hline \end{tabular}
\end{table}
Table 44: High luminosity, italic numbers indicate the use of pre-processing, ROBOut occupancy

### Farm size, dependence on execution times, task switching times

Results for the required number of LVL2 farm processors are presented in Table 45 and Table 46. The number is sensitive to the number of ROBIns per ROBOut, as the ROBOut is assumed to build partial RoI fragments. The effect is that the number of messages received per RoI by a farm processor is reduced with respect to the situation in which each ROBin has its own network connection. The numbers in Table 45 and Table 46 have been calculated assuming that 4 ROBIns per ROBOut are grouped for the muon detectors and 2 for the calorimeter. For the tracker (TRT, SCT, pixels) it is assumed that there is no grouping. Grouping 4 ROBIns per ROBOut for each detector would reduce the number of processors required for the high luminosity sequential trigger processing at nominal LVL1 rate from 51 to 48.

From the number of processors with nominal processing time for the scan (third column of Table 45) and the number for 0 % processing time for the scan (fourth column of Table 45) the effect of a reduction of the processing time for the scan can be estimated. This processing time includes the time required for the analysis of the SCT and Pixels data. Note that rates at 75 kHz LVL1 rate are obtained by scaling all rates up with the exception of the rate of the scan.

For small farms the bandwidth required for input of event data into each processors becomes a bottleneck. The minimum number of network ports, assuming a bandwidth of 15 MByte/s per port, is shown in Table 47.

Task switching times (assumption : 10 us) have a considerable effect on the processing requirements. If the B-physics trigger is not taken into account, roughly a third of the processing capacity is needed for task switching. For the low luminosity trigger including B-physics trigger the fraction is about 10 %.

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline LVL1 rate & non-sequential & sequential & approximately fully sequential \\ \hline \hline
39.4 kHz & 89 & 51 & 35 \\  & _80_ & _45_ & _31_ \\ \hline
75 kHz & 170 & 97 & 66 \\  & _152_ & _84_ & _58_ \\ \hline \end{tabular}
\end{table}
Table 46: Farm sizes for high luminosity trigger, italic numbers indicate the use of preprocessing in the calorimeter and TRT ROBs

## 5 Discussion

### Choices made for parameters and models

Simplifying assumptions have been made. The average fragment volume per ROBIn is fixed per subdetector, but can be expected to be different for different ROBIns. More detailed information is required.

Uncertainties in the trigger menus (composition and exclusive rates), for sequential processing in the reduction factors and processing sequences and due to the assumption that the eta-phi positions for each RoI individually is randomly distributed over the relevant eta-phi space need to be estimated. Correlations between the positions of different RoIs can be ignored for the paper model, as only average numbers and event rates are computed. However, for the LVL2 decision time distribution, as obtained from the computer model, correlations may be important.

Although the assumptions for values of processing times, task switching times and available network bandwidth (including throughput of switches) do not seem to be unrealistic, further justification by testbed results is required.

### Consequences of different architecture choices

In Section 4 results have been shown for sequential and for non-sequential processing. The numbers obtained for the ROBIns in the case of non-sequential processing would apply in a DAQ crate with a separate LVL2 interface, where the ROBIns receive RoI requests directly from the LVL1 trigger or a supervisor. This would be true also in the case of sequential processing by the LVL2 trigger system.

## 6 Conclusions

In this document, an overview has been presented of paper model results for the ATLAS LVL2 and F/E DAQ system (up to the Event Builder) based on current information on trigger menus, associated exclusive rates and processing sequences, ROB mapping, values of processing times, task switching times and available network bandwidth. Several conclusions may be drawn.

* The results show clearly advantages of the sequential type of data processing both in required rates and data volumes. "Fully sequential" processing allows to reduce the rates and data volumes further, in particular for high luminosity processing. Computer modelling [6] indicates that there is no negative effect on the average decision time.

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline  & low luminosity, & high luminosity, & high luminosity, \\ LVL1 rate & sequential, B-physics & sequential & fully sequential \\ \hline \hline nominal & 263 & 100 & 60 \\  & _145_ & _65_ & _40_ \\ \hline
75 kHz & 313 & 191 & 115 \\  & _175_ & _123_ & _76_ \\ \hline \end{tabular}
\end{table}
Table 47: Minimum number of network ports needed for the processor farm, assuming a bandwidth of 15 MByte/s per port, italic numbers indicate the use of pre-processing in the calorimeter and TRT ROBs* At both low and high luminosities, the high-p\({}_{\rm T}\) LVL2 triggers may be handled by a comparable number (about 100 1000 MIPS) processors at 75 kHz LVL1 rate.
* The maximum data volume to be transferred through the network is, for nominal LVL1 rate, 2 to 4 GByte/s for the low luminosity trigger including the needs of the TRT full scan for the B-physics, and 1 to 2.5 GByte/s for the high luminosity trigger. Event building at a rate of 2 kHz would add about 4 GByte/s to the total traffic.
* The TRT full scan and associated analysis of all data from SCT and Pixels increases the requirements on the processing power at least 6 times (without use of specialized co-processors) and takes up more than 65 % of the total required network bandwidth.
* For the high luminosity trigger or the low luminosity trigger with fast processing for the B-physics trigger in dedicated co-processors the number of farm processors could be dictated by the available input bandwidth per processor rather than the required processing capacity. A combined EF-LVL2 farm with a much larger number of processors than in a single LVL2 farm could in this case allow a better utilization of the available network bandwidth and processing capacity.
* For event building, for high luminosity about 70 % or for low luminosity about 79 / 84 % (with / without pre-processing of TRT data) of the total required bandwidth is needed for transferring data from the calorimeters. Due to the large fragment size for the calorimeters and the accept rate of 2 kHz, the total volume of the data transferred via the Event Builder has increased by a factor of 4 with respect to previous estimates.

## References

* [1] J.Bystricky, D.Calvet, J.Ernwein, O.Gachelin, T.Hansl-Kozanecka, J.R.Hubbard, M.Huet, P.Le Du, I.Mandjavidze, M.Mur, M.Smizanska, and B.Thooris: A Model for Sequential Processing in the ATLAS LVL2/LVL3 Trigger, Atlas internal note ATL-DAQ-96-055, June 1996
* [2] M.Dobson, S.George, J.A.Strong, J.C.Vermeulen: Paper Models of the ATLAS Second Level Trigger, Atlas internal note ATL-DAQ-98-113, June 1998
* [3] [ftp://ftp.nikhef.nl/pub/experiments/atlas/tdaq/Paper/](ftp://ftp.nikhef.nl/pub/experiments/atlas/tdaq/Paper/)
* [4] A.Amadon, J.Bystricky, D.Calvet, R.Hubbard, M.Huet, P.Le Du, I.Mandjavidze, M.Abolins: Architecture C Performance from Paper Models, Atlas internal note ATL-DAQ-98-106, June 1998
* [5][http://www-dapnia.cea.fr/Phys/Sei/exp/ATLAS/model](http://www-dapnia.cea.fr/Phys/Sei/exp/ATLAS/model)
* [6] J.C.Vermeulen: Computer modelling of the ATLAS LVL2 trigger system, ATL-COM-DAQ-2000-031, March 2000
* [7] S.George, T.Hansl-Kozanecka, K.Mahboubi, A.Watson: RoI-based event descriptions for modelling the ATLAS second level trigger, Atlas internal note ATL-DAQ-99-010, April 1999
* [8] P.Clarke, S.Falciano, P.Le Du, J.B.Lane, M.Abolins, C.Schwick, F.J.Wickens: Detector and Read-Out Specification, and Buffer-RoI Relations, for Level-2 Studies, Atlas internal note ATL-DAQ-99-014, October 1999, an update of ATL-DAQ-97-062
* [9] N.Ellis, private communication
* [10] P.Le Du, private communication
* [11] R.Cranfield, F.Wickens, J.Vermeulen: Notes on Pilot Project modelling meeting, NIKHEF, January 27+28, 1999, Amsterdam, [http://www.nikhef.nl/pub/experiments/atlas/daq/Modelling-27-28-1-99.pdf](http://www.nikhef.nl/pub/experiments/atlas/daq/Modelling-27-28-1-99.pdf)
* [12] S.George, J.R.Hubbard, J.C.Vermeulen: Input Parameters for Modelling the ATLAS Second Level Trigger, Atlas internal note ATL-DAQ-97-070, June 1997