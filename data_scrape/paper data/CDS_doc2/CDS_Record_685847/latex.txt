# **Atlas Internal Note**

**Indet-No-013**

**Addendum**

**Update on**

**Second Level Electron Triggering**

**in the Atlas A Detector**

R.J. Hawkings, A.R. Weidberg

Department of Physics

Oxford University, UK

October 21, 1992

###### Abstract

Further results on global second level electron triggering are presented. An improved level 2 calorimeter trigger has been implemented, and the effect of pileup in the calorimeter and preshower detector has been studied. The rejection against single charged pions has also been evaluated.

## 1 Introduction

This note forms an addendum to a previous study on second level electron triggering[1], which described the performance of a track trigger based on the SIT detector of the Atlas A-option tracker design, combined with a simple calorimeter trigger algorithm. The possibility of using the preshower detector to reject isolated charged pions left after the calorimeter and tracking triggers was also studied.

A new larger jet sample has been generated, and used to obtain better statistics on the trigger performance. A possible optimised level 2 calorimeter algorithm resulting from detailed studies[4] has been incorporated into the simulation. The effect of minimum bias (pileup) background had already been checked in the tracking, this has now been extended to the calorimeter and preshower detectors. Finally, a large number of isolated charged pions have been simulated through the setup, to obtain a more accurate determination of the performance of the preshower detector on the remaining charged pion background.

All the simulations have used an identical Atlas A geometry to that described previously[1], with a beam pipe, inert SITV, barrel SIT, neutron moderator, coil, cryo-stat, cold preshower and electromagnetic and hadronic calorimeters. The fast homogeneous calorimeter simulation was again used[2], to speed up the event simulation.

## 2 Performance with simple calorimeter trigger

### Event Generation

The previous study used two samples of jet events selected by the level 1 electromagnetic cluster trigger, an inclusive sample of 162 events containing calorimeter, tracking and preshower detector hit information (sample 1); and a larger sample of 529 eventsgenerated with different kinematic cuts, containing only the calorimeter information (sample 2). For this study, a large inclusive jet sample was generated retaining all the tracking, calorimeter and preshower detector information, this contains 557 events faking the level 1 trigger, from \(1.2\times 10^{5}\) PYTHIA events (sample 3). As before, the level 1 trigger looked for a 35 GeV \(2\times 1\) cluster with less than 5 GeV in the 12 surrounding electromagnetic cells and 16 hadronic cells behind.

### Results from this sample

These jets were resimulated in the tracking, adding \(\overline{n}=20\) minimum bias events per bunch crossing, and using the stored calorimeter information for the calorimeter triggers. The same cuts were applied to the events as before, looking for an isolated calorimeter cluster spatially matched to a good trigger track, with compatible measured energy and momentum values.

The results are shown in table 1, for the old and new samples for comparison. The numbers of raw track triggers in the RoI defined by level 1 are shown, together with those remaining after calorimeter matching, split into high (\(p_{T}>30\) GeV) and low \(p_{T}\) events. All the samples are consistent with an overall rejection ratio of about 35:1 and a low \(p_{T}\) rejection of just under 100:1, from the tracking and calorimetry alone.

The same preshower detector cuts as described previously were used on this sample, looking for a calorimeter-preshower spatial match and \(E_{layer1}>0.01\) GeV, \(E_{layer2}>0.05\)GeV in the preshower detector. This left 2 low \(p_{T}\) and 3 high \(p_{T}\) hadrons from the 16 hadronic events left from the calorimeter and tracking trigger. This gives an overall rejection (excluding the events where the leading track is an electron) of 553:5 or 110:1, which is consistent with the 80:1 obtained from sample 1, and an additional rejection of about a factor 3 from the preshower detector. However these results do not include the effect of pileup in the calorimeter and preshower.

## 3 Performance for realistic calorimeter trigger

### Calorimeter Trigger Algorithm

The calorimeter trigger employed for the above results used a simple algorithm, known to be efficient for electrons and safe from pileup background from the offline studies[3]. A separate study[4] has produced a possible realistic level 2 calorimeter trigger algorithm, which was implemented and used to study the global level 2 electron trigger performance. Other possible algorithms are also under consideration[5].

This algorithm uses the full granularity of the electromagnetic calorimeter, \(\Delta\eta\times\Delta\phi=0.02\times 0.02\) in the transverse direction, but sums the longitudinal segmentations. A core of \(2\times 2\) cells is moved around in the region of interest defined by the level 1 trigger, and its energy maximised subject to the following conditions:

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c|c||} \hline Sample & Events & Raw & Remaining & Overall & Low \(p_{T}\) & Low \(p_{T}\) & Low \(p_{T}\) \\  & & Triggers & Triggers & Rejection & Events & Triggers & Rejection \\ \hline
1 & 162 & 20 & 5 & 32:1 & 141 & 1 & 140:1 \\
2 & 529 & 54 & 14 & 38:1 & 505 & 6 & 84:1 \\
3 & 557 & 47 & 16 & 35:1 & 521 & 6 & 87:1 \\ \hline \end{tabular}
\end{table}
Table 1: Jet simulations for simple calorimeter trigger 1. The energy in the core must be at least 66% of the energy found in the level 1 trigger cluster.
2. The energy in an inner ring of \(4\times 4\) cells around but excluding the core must be less than 20% of the core energy.
3. The energy in an outer ring of \(6\times 6\) cells around but excluding the core and inner ring must be less than 10% of the core energy.

### Calorimeter Trigger Performance

The efficiency of this algorithm was checked by running on the same dataset of 1279 electrons passing the level 1 trigger as used in the previous study. The energy distributions in the core, inner and outer rings are shown in figure 1(a). Of the 1279 events, 1252 have a cluster satisfying the above conditions, giving a calorimeter selection efficiency of 97.9%. These cuts are quite loose, most events that fail having more than 20% of core energy in the inner ring.

Figure 1: Calorimeter selection for electrons (a) no pileup, (b) \(\overline{n}=40\) pileup events

The effect of minimum bias pileup in the calorimeter was then investigated. 1000 minimum bias events were simulated using the GENCL generator interfaced to SLUG. An average of 40 events (20 per bunch crossing integrated over two crossings) were superimposed on the calorimeter information from the electron events, and the trigger algorithm rerun on the result. Figure 1(b) shows the resulting distributions, as expected the ring energies are shifted slightly higher, causing a small loss of efficiency due to more events failing the isolation requirements. 1249 events pass this selection, for a calorimeter trigger efficiency in the presence of pileup of 97.7%.

To evaluate the effect of electronic noise in the calorimeter on the level 2 trigger efficiency, another run was performed, adding 100 MeV RMS noise to each EM calorimeter tower. A threshold of 80 MeV was then applied, as was done before in the calorimeter simulation. This noise slightly smears out the isolation ring energies, but the effect on efficiency is small, 1245 instead of 1249 events passing the level 2 calorimeter trigger.

## 4 Global Trigger Performance

The electron sample and the jet samples 1 and 3 were run through the whole simulation, with the new calorimeter trigger and the tracking trigger described previously. Pileup, at \(\pi=40\) events per bunch crossing was added in all detectors to simulate the slow readout of the calorimeter and preshower detector. The SIT has fast readout, so should have an average of 20 events per bunch crossing, however, at present SLUG only allows the same number of events to be merged into all detectors. Hence the tracking trigger performance is worse than expected in practice.

The following cuts were used on the raw triggers from the calorimeter and tracker, they are similar to the ones employed before.

1. The track trigger coordinates must be within 0.3 radians of the level 1 calorimeter trigger, eliminating triggers away from the RoI.
2. A level 2 calorimeter cluster in the RoI, satisfying the conditions listed above.
3. The calorimeter cluster position (obtained from the energy weighted mean position of cells in the core and inner ring) and track position extrapolated into the calorimeter must match to within \(\Delta\phi<0.015\) radians and \(\Delta z<1.2\)cm.
4. The RMS deviation from a straight line of the points making up the track trigger must be less than \(0.15\times 10^{-3}\) radians. This eliminates random hit coincidences which do not line up to make a good track.
5. The energy in the level 2 core and the momentum measured by the track trigger algorithm must agree to within \(0.5<E/p<1.5\), limited by energy loss in the preshower material and bremsstrahlung in the tracking detectors. The core energy was used rather than core plus rings, as this gave a slightly narrower distribution for electrons, allowing tighter cuts to be used against jets.

As before, the cuts were optimised to have a high rejection power against jets, whilst still having as high an efficiency as possible for electrons.

### Electron Efficiency

As described above, in the presence of pileup background, 1249 events pass the calorimeter trigger (97.7%), limited by energy leakage into the rings and pileup noise. Takingthe track trigger alone, 1211 events have a trigger pointing to the RoI (94.7%), limited by bremsstrahlung loss in the tracker material. Combining these two triggers gives 1194 events (93.4%), and adding the spatial match and RMS deviation cuts leaves 1165 (91.1%). Finally, adding the \(E/p\) cut leaves 1143 events, for a global level 2 electron trigger efficiency of 89.4% in the presence of pileup background. The electron selection variables are shown in figure 2.

### Rejection against Jets

Jet samples 1 and 3 were resimulated, adding pileup in all detectors as for the electrons. The selection variables for sample 3 are shown in figure 3 and the results are summarised in table 2. The small sample 1 appears consistent with the larger sample 3, so both have been added together in the results.

The track trigger rejection is about 5:1, this includes all events with a trigger in the level 1 RoI, and is rather low due to double the amount of occupancy in the SIT

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c|c||} \hline Sample & Events & Tracking & Calo & Combined & Combined & Low \(p_{T}\) & Low \(p_{T}\) \\  & & Triggers & Triggers & SIT+calo & with match & Events & Triggers \\ \hline
1 & 162 & 33 & 15 & 4 & 2 & 143 & 1 \\  & & 5:1 & 11:1 & 40:1 & 81:1 & & 143:1 \\
3 & 557 & 106 & 74 & 20 & 8 & 521 & 0 \\  & & 5.1:1 & 7.3:1 & 27:1 & 68:1 & & \(\infty\) \\
1+3 & 719 & 139 & 89 & 24 & 10 & 664 & 1 \\  & & 5.2:1 & 7.9 & 29:1 & 70:1 & & 660:1 \\ \hline \end{tabular}
\end{table}
Table 2: Jet simulations for full calorimeter trigger and pileup background

Figure 2: Level 2 selection for electrons with pileup background

from the 40 background events. The calorimeter gives a rejection of about 8:1 by itself additional to the level 1 rejection, showing the rejection power that can be obtained by using the full granularity calorimeter information. The two rejections are not strongly correlated, and requiring triggers in both sub-detectors gives a rejection of 29:1. Adding the spatial matching and \(E/p\) cuts described above gives a final rejection factor of 70:1 in the presence of pileup for the tracking and calorimetry alone, without using the preshower detector.

Virtually all the remaining events are high \(p_{T}\) charged hadrons (pions and kaons), and only one of the ten triggers has low \(p_{T}\). The track trigger alone selects some low \(p_{T}\) events, mainly conversions in the tracker with some false triggers from the minimum bias background, however the improved calorimeter algorithm is much better at rejecting these events.

### Note on minimum bias generators

The results presented above were produced using the GENCL minimum bias event generator interfaced to SLUG in the standard way. Events were also generated using PYTHIA (Di Ciaccio tuning--Aachen Vol.II p.155) for comparison. The GENCL events were found to be almost a factor 2 more complex, with higher energies deposited in the calorimeter and many more hits in the tracking (see figure 4). However, the results do not depend much on the generator used, PYTHIA gives slightly higher efficiency for electrons, but the jet rejections are almost exactly the same.

Figure 3: Level 2 selection for jets sample 3

Figure 4: Electrons + minimum bias: (a-b) in calorimeter, (c-d) in tracking.

## 5 Use of the Preshower Detector

In the previous study, a simple preshower algorithm was used. This looked in the region defined by the level 2 calorimeter trigger and found the highest energy cluster in a region of \(15\times 3\) strips. Cuts were made on the spatial matching with the calorimeter, and on the energies deposited in the preshower detector layers, thus providing a rejection of between 2 and 5 on the remaining high \(p_{T}\) charged hadron background to the electron trigger.

In order to investigate this further, a large sample of charged pions with energies between 40-80 GeV and \(\mid\eta\mid<1.0\) was generated and run through the simulation with the level 1 calorimeter trigger. Of 7000 events, 661 showered early in the calorimeter and faked the level 1 trigger. These were then resimulated with \(\overline{n}=40\) minimum bias events, in the same way as was done for electrons and jets. The level 2 calorimeter trigger selected 278 of these 661 events, giving a rejection of 2.4:1. The preshower detector response was then looked at in detail, on the remaining pions, the electrons and remaining jets.

Figure 5: Preshower-calorimeter spatial match: (a) electrons, (b) pions, (c) jetsFigure 6: Preshower energy: (a) electrons, (b) pions, (c) jets

The preshower-calorimeter spatial match is shown in figure 5, for all three types of events. An angular cut of \(\Delta\eta<0.015\) radians and \(\Delta\phi<0.02\) radians is reasonably safe, removing 2 electrons and 77 pions. The preshower energy response for all event types is shown in figure 6. As expected, the electrons give a large signal, whilst many of the pions give a very small signal. Those with larger signals begin showering very early, before even the preshower detector layers, and fake the signal for electrons. A suitable energy cut to remove as many pions as possible is \(E_{layer1}<0.01\) GeV, \(E_{layer2}<0.03\) GeV. The previous study cut higher on \(E_{layer2}\) at 0.05 GeV, but the pion results show not much is lost in rejection by lowering this cut to 0.03 GeV, and a few more electrons are recovered.

The preshower detector results are summarised in table 3, which shows the performance of this component after all the other cuts have been used. The efficiency for electrons is very high, giving an overall global level 2 trigger efficiency of 88.8%. The total additional rejection obtained from the preshower (spatial match and energy cuts) for isolated charged pions is 2.3:1, and the overall level 2 pion rejection is 661:120 or 5.5:1.

On the jet samples (1 and 3), of the 10 remaining triggers, 7 are removed by the preshower cuts, leaving 2 high and one low \(p_{T}\) events out of 719 (excluding the events where the leading particle is an electron). This gives an overall rejection ratio of 240:1, with the preshower detector contributing a factor of 3.3. If the higher statistics pion rejection ratio is assumed, the 70:1 obtained from the calorimeter and track triggers is improved to 160:1. This is still above the 100:1 rejection ratio required to reduce the fake electron rate to a level comparable with that of real electrons from heavy flavour and W,Z decays.

## 6 Conclusions

The feasibility of a second level electron trigger based on the SIT tracker and electromagnetic calorimeter has been demonstrated. Under realistic pileup conditions, a rejection factor of 70:1 can be achieved together with an electron efficiency of 89.5%. The remaining trigger background is predominantly high \(p_{T}\) hadrons, which can be reduced by using the cold preshower detector. This gives an additional rejection of between 2 and 3, giving an overall rejection of 150-250:1, well above the minimum necessary for a level 2 electron trigger. The overall trigger results are summarised in table 4, which also shows the preformance expected from the level 1 electron trigger[6], and that of the combined level 1-2 trigger system.

## References

* [1] N. Ellis et. al, Second Level Electron Triggering in the Eagle A Detector, INDET-NO-013.

\begin{table}
\begin{tabular}{||c|c|c|c|c|c||} \hline Particle & Preshower & Spatial & Spatial & Total & Total \\ Type & Events & Selection & Rejection & Selection & Rejection \\ \hline Electrons & 1143 & 1141 & 99.8\% & 1136 & 99.4\% \\ Pions & 278 & 201 & 1.4:1 & 120 & 2.3:1 \\ Jets & 10 & 7 & 1.4:1 & 3 & 3.3:1 \\ \hline \end{tabular}
\end{table}
Table 3: Summary of preshower detector results* [2] N. Ellis et. al, Level 1 Trigger System (appendix), DAQ-NO-005.
* [3] A. Clark et. al, Electron identification using energy momentum matching in the EAGLE inner detector, INDET-NO-015.
* [4] J. Carter and J. Strong, ATLAS internal note in preperation.
* [5] G. Klyuchnikov et. al, A second level trigger, based on calorimetry only, DAQ-NO-007.
* [6] A. Watson, private communication.

\begin{table}
\begin{tabular}{||c|c|c|c||} \hline \multicolumn{2}{||c|}{Trigger Type} & \multicolumn{1}{c|}{Electron Efficiency} & \multicolumn{1}{c||}{Jet Rejection} \\ \hline Level 1 & Calorimeter & 95-97\% & 10:1 \\ \hline Level 2 & Track & 94.7\% & 12:1 \\  & Track+Calo & 89.4\% & 70:1 \\  & Track+Calo+Preshower & 88.8\% & 150-250:1 \\ \hline Overall Level 1 + Level 2 & 84.5-86\% & 2000:1 \\ \hline \end{tabular}
\end{table}
Table 4: Summary of trigger results