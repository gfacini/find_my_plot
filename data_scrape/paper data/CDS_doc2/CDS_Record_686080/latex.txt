ATLAS Internal Note

LARG-NO-19

Date 21 APR 95

Study of energy reconstruction using optimal filtering

with the LAr electromagnetic calorimeter

I. Wingerter-Seez

LAPP, Annecy, FRANCE

21 April 1995

This note summarizes the study, using monte-carlo technique, of possible algorithms to extract the energy in the LAr em calorimeter. Optimal filtering method is used, as in [1]. Several effects are taken into account: electronics noise, pile-up noise, vertex spread and jitter on the sampling frequency. This study is done without any detailled shower simulation. At nominal luminosity, the transverse energy resolution in a nonet is \(\simeq 450\) MeV, coming from electronics and pile-up noise, to be compared to \(\frac{750}{sin\theta}\) due to the local calorimeter resolution at 50 GeV. If one uses an algorithm capable of measuring the time of the pulse arrival, the vertex spread has no effect on the energy measurement (even if the jitter on \(t_{0}\) is 1ns, the effects are negligeable). Whereas, any jitter on the sampling frequency should be kept below 200ps.

Introduction

In this note we continue the study described in [4] by looking at the signal on top of the noises (electronics and pile-up). We consider electromagnetic showers and study the effects on the energy resolution due to luminosity, vertex spread and jitter on the sampling frequency; we also study the timing resolution. The technique of optimal filtering is used to reduce the noise contribution to the energy resolution.

The parameters used for this study are the same as the ones listed in the first section of [4]. Electronics noise and pile-up are the same also. We only consider transverse energy in a _nonet_, i.e. in \(3\times 3\)\(cells\times 3\)\(samplings\).

We generate signal by adding, on top of the noise and every 30 bunch crossing (to have no overlap), a high transverse energy deposit in a nonet (50 GeV or 500 GeV). In the following, we shall always consider the transverse energy.

We shall consider 3 cases for the luminosity: low (\(0.5\times 10^{33}cm^{2}s^{-1}\)), nominal (\(1.\times 10^{34}cm^{2}s^{-1}\)) and high (\(2.5\times 10^{34}cm^{2}s^{-1}\)); we have taken 1, 20 and 50 as the average number of interactions per crossing respectively. The pulse is sampled 5 times, except in section 4.

In the next section we study the choice of the algorithm to use and the technique to obtain the coefficients; effects of the luminosity will be looked at. In section 3 the effects of time jitters will be investigated. In section 4 the effect of sampling the pulse 3 times instead of 5. And finally, in section 5, the energy and timing resolution for different shaping times are compared.

## 2 Energy resolution

Without any noise, the height of the peak at the output of the shaper (cf Fig 1) is proportionnal to the deposited energy. Multiple samplings allow to take into account the noises and recover some of the information lost when the pulse shape is distorted by noise. This technique of optimal filtering of multiply-sampled signal is described in details in [1].

### Mathematics

The optimal filtering technique consists in computing the linear sum of N samples in order to estimate the energy, or the time. The N samples are taken at each bunch crossing before and after the crossing one is looking at (cf the arrows on Fig 1). For instance, for the energy one can write:

\[\tilde{E}=\sum_{i=1}^{N}A_{i}\cdot S_{i}.\]

When there is a shift in time one can estimate in a similar way by:\[E\,\cdot\,\tau=\sum_{i=1}^{N}\,B_{i}\,\cdot\,S_{i}.\]

\(S_{i}\) is the signal measured at the \(i^{th}\) crossing. In order to compute the \(A_{i}\) one can make different hypothesis on the shape of \(S_{i}\):

* algo 1: the timing is supposed to be perfect: \(S_{i}=\textit{b}_{i}+E\cdot w\,(t_{i})\).
* algo 2: there is an offset \(\tau\) between the measurement and the maximum of the pulse: \(S_{i}=\textit{b}_{i}+E\cdot w\,(t_{i}-\tau)\).
* algo 3: same as 2 plus the pulse is on top of a pedestal: \(S_{i}=\textit{p}\textit{e}\textit{d}+\textit{b}_{i}+E\cdot w\,(t_{i}-\tau)\).

where \(\textit{b}_{i}\) is the total noise for the \(i^{th}\) crossing, \(w\) is the shape of pulse that is sampled, \(\tau\) is a shift between the nominal and the actual \(t_{0}\), the begining of the pulse. To compute the coefficients \(A_{i}\), we make the assumption that \(w\) can be linearized (as in [1]):

\[w(t_{i}-\tau)=w(t_{i})-\tau w^{\prime}(t_{i})=w_{i}-\tau w^{\prime}_{i}.\]

where \(w^{\prime}_{i}\) is the time derivative of \(w_{i}\).

The determination of the coefficients is done by requiring the estimator to be unbiaised and the variance to be minimum. The coefficients are function of the inverse of the covariance matrix on the noise (\(R^{-1}\)), the \(w_{i}\) and the \(w^{\prime}_{i}\). The details of the calculation of the coefficients are described in [1].

### Values of coefficients

In this section, we give the values of the covariance matrix and of the coefficients obtained for the three considered luminosities. All through the note we use 5 samples except in section 4 where we look at the effect of using less (3 samples) on the performances of the detector.

The coefficients are computed in the following way:

the covariance matrix \(R\) is computed using _minimum biais_ events, i.e. by averaging over 10000 events where only the noise is generated (electronics+pile-up); it is then inversed and the coefficients are calculated from \(R^{-1}\), \(w\) and \(w^{\prime}\) where the latest 2 are the assumed pulse shape. This procedure is not irrealistic: coefficients could be calculated this way in the experiment.

The elements of \(R\), \(R_{i-j}=R_{j-i}=b_{i}b_{j}\), obtained for the three considered luminosities are listed in table 1; the variance of the matrix, \(R_{00}\), is given in the first column. The values of the matrix elements can be understood in terms of the autocorrelation functions of the two noises: electronics and pile-up; at low luminosity the electronics noise dominates whereas at high luminosity the pile-up noise does.

The coefficients obtained to estimate \(\tilde{E}\) for the three algorithms are listed in table 2. As expected the third coefficient is always the highest because it is at the peak that the ratio signal/noise is the highest. The higher the luminosity, the higher is this third coefficient.

The coefficients to estimate \(\tilde{E^{\cdot}\tau}\) are listed in table 3. The timing information does not lay in the third point (the peak) because at this point the shaping function is flat over many nanoseconds. Therefore the important points for the timing measurements are -1, +1 and +2.

### Energy resolution

The first thing we can do is to run these algorithms on _minimum bias_ events to check that the reconstructed energy is nil and to measure the energy resolution. In table 4 are summarized the results for four algorithms: we call _algo 0_ the case when the peak value is taken; the other three are the one described before. Numbers are given for the three luminosities.

The first remark to make is that indeed the average reconstructed energy is nil; the second one is that at the nominal luminosity, the optimal filtering on 5 samples brings little improvement on energy resolution: this is because the shaping time has been optimized so that the

\begin{table}
\begin{tabular}{|c|r|r|r|r|r|r|r|} \hline  & \multicolumn{4}{|c||}{low lumi.} & \multicolumn{4}{|c||}{nominal} & \multicolumn{4}{|c||}{high lumi.} \\ \hline \hline  & Pulse & \multicolumn{4}{|c||}{Algorithm} & \multicolumn{4}{|c||}{Algorithm} & \multicolumn{4}{|c||}{Algorithm} \\  & Height & 1 & 2 & 3 & 1 & 2 & 3 & 1 & 2 & 3 \\ \hline \hline -2 & 0. & 0.130 & +0.129 & -0.737 & -0.133 & -0.211 & -0.551 & -0.069 & -0.239 & -0.489 \\ -1 & 0.3526 & 0.331 & +0.325 & +0.026 & -0.125 & +0.042 & -0.100 & -0.375 & -0.073 & -0.182 \\
0 & 1.0 & 0.592 & +0.592 & +0.900 & +0.965 & +0.939 & +1.083 & +1.171 & +1.111 & +1.221 \\ +1 & 0.6029 & 0.435 & +0.435 & +0.260 & +0.163 & +0.108 & +0.033 & -0.032 & -0.111 & -0.168 \\ +2 & 0.1458 & 0.216 & +0.216 & -0.449 & -0.129 & -0.133 & -0.465 & -0.136 & -0.124 & -0.382 \\ \hline \end{tabular}
\end{table}
Table 2: _Values of the coefficients for the three luminosities and the three algorithms computed to estimate the energy \(\tilde{E}\). Algorithm 1 assumes that \(\tau=0\) and \(ped=0\); algorithm 2 assumes that \(\tau\) varies and \(ped=0\); and the third one assumes that both \(\tau\) and \(ped\) can vary._

\begin{table}
\begin{tabular}{|c|r|r|r|r|r|r|r|} \hline  & \multicolumn{4}{|c||}{\(\sqrt{R_{0}}=\sqrt{\frac{1}{N}}\sum_{j=1}^{N}S_{i}^{2}\)} & \multicolumn{1}{|c|}{\(\frac{R_{0}}{R_{0}}\)} & \multicolumn{1}{|c|}{\(\frac{R_{1}}{R_{a}}\)} & \multicolumn{1}{|c|}{\(\frac{R_{2}}{R_{a}}\)} & \multicolumn{1}{|c|}{\(\frac{R_{1}}{R_{0}}\)} \\ \hline low & 235. MeV & +1.000 & -0.168 & -0.156 & +0.011 & +0.060 \\ nominal & 489. MeV & +1.000 & +0.516 & +0.194 & +0.055 & -0.007 \\ high & 711. MeV & +1.000 & +0.632 & +0.263 & +0.072 & -0.002 \\ \hline \end{tabular}
\end{table}
Table 1: _Covariance matrix elements(\(R_{i-j}\)) measured on \(10^{4}\) events made of electronics and pile-up noise, at nominal luminosity; the matrix \(R\) is symetric accross the diagonal. The typical error on the elements \(R_{i-j}\) is \(1\%\)._electronics and pile-up noises are equivalent for this luminosity [5]. Algorithms 1 and 2 give similar energy resolution wheras 3 is \(\simeq\) 20% worse. We shall see in the next section how important it is the be able to measure the time \(\tau\), therefore algorithm 2 will become the basic one. Algorithm 3 could be usefull when two high energy signal overlap each other: this algorithm would allow to measure correctly the energy of the second signal (as it would be sitting on top of an offset). But as it broadens the energy distribution, it is not considered as the standard technique to extract the energy.

On Fig. 2 are shown three distributions, for the three luminosities, of \(E^{2}_{rec}\) the transverse energy reconstructed using _algo 2_ for \(10^{5}\) minimum-bi\(\,\)ais events. One can notice the tails on the right of a quasi-gaussian distribution; it is the presence of such tails that makes the problem of reconstructing the energy more complicated. It was shown in [4] that the tails are coming essentially from the crossing itself and not from previous beam crossings. These tails also lead to fluctuations, depending on the number of events, on the measured width of the transverse energy distribution. The probability to get \(E_{t}\geq 1\;GeV\) in a nonet, at the nominal luminosity, is 3% [4].

\begin{table}
\begin{tabular}{|c||c|c|c|c||c|c|c||c|c|c|c||} \hline  & \multicolumn{4}{|c||}{low lumi.} & \multicolumn{4}{|c||}{nominal} & \multicolumn{4}{|c||}{high lumi.} \\ \cline{2-11}  & \multicolumn{2}{|c|}{1 evt/cross.} & \multicolumn{4}{|c||}{20 evts/cross.} & \multicolumn{4}{|c||}{50 evts/cross.} \\ \hline \hline  & \multicolumn{4}{|c||}{Algorithm} & \multicolumn{4}{|c||}{Algorithm} & \multicolumn{4}{|c||}{Algorithm} & \multicolumn{4}{|c||}{Algorithm} \\  & 0 & 1 & 2 & 3 & 0 & 1 & 2 & 3 & 0 & 1 & 2 & 3 \\ \hline \hline \(<E>\) (MeV) & 0. & 0.2 & 0.2 & -0.3 & 0.8 & 0.6 & 0.6 & -0.1 & 2.0 & 1.1 & 1.1 & -1. \\ \hline \(\sigma\,(E)\) (MeV) & 239. & 157. & 157. & 331. & 464 & 448. & 452. & 519. & 694. & 646. & 660. & 719. \\ \hline \end{tabular}
\end{table}
Table 4: _Results for energy reconstruction on minimum-bi\(\,\)ais deposits for three luminosities. The typical error on the mean value is a few MeV. \(10^{5}\) events were used to measure these quantities._

\begin{table}
\begin{tabular}{|c||c|c||c|c||c|c||} \hline  & \multicolumn{2}{|c||}{low lumi.} & \multicolumn{2}{|c||}{nominal} & \multicolumn{2}{|c||}{high lumi.} \\ \hline \hline  & \multicolumn{2}{|c||}{Algorithm} & \multicolumn{2}{|c||}{Algorithm} & \multicolumn{2}{|c||}{Algorithm} \\  & 2 & 3 & 2 & 3 & 2 & 3 \\ \hline \hline -2 & +3.552 & +1.036 & -9.799 & -10.067 & -12.276 & -12.430 \\ -1 & +17.633 & +16.765 & +20.886 & +20.774 & +21.913 & +21.846 \\ 0 & +0.225 & +1.120 & -3.141 & -3.027 & -4.397 & -4.329 \\ +1 & -8.835 & -9.345 & -6.892 & -6.951 & -5.722 & -5.757 \\ +2 & -7.646 & -9.575 & -0.467 & -0.729 & +0.828 & +0.670 \\ \hline \end{tabular}
\end{table}
Table 3: _Values of the coefficients, for the three luminosities and the two algorithms, computed to estimate the time shift \(E\,\tilde{\cdot}\,\tau\,\). Algorithm 2 assumes that \(\tau\) varies and \(ped=0\); algorithm 3 assumes that both \(\tau\) and \(ped\) can vary._

### Comparison with intrinsic calorimeter resolution

The contribution to the transverse energy resolution of these noises is therefore a function of the luminosity, but it is independant of the energy; it contributes at low energy. At the nominal luminosity, it is \(\simeq 450\ MeV\); at low luminosity it becomes \(\simeq 150\ MeV\) and \(\simeq 660\ MeV\) at high luminosity. These numbers could be compared to \(\frac{750}{\sin\theta}MeV\) of intrinsic calorimeter energy resolution for an e.m. particle of E=50 GeV. The numbers given here are significantly higher than the ones of [7]: part of the difference can be attributed to the fact that no detailled shower simulation has been performed here. In any case, optimal filtering on 5 samples contributes significantly to reduce this term. In addition this technique is essential to measure any time shift. This is the subject of the next section.

## 3 Timing effects

In this section we investigate what are the effects of time shifts and of time jitters. Following a remark made in 2.3 we only use _algo 2_ in this study. Using this algorithm, we can see how well we reconstruct the energy and the time shift, when the timing is not perfect. Three types of effects have been looked at:

* a global shift on the \(t_{0}\), \(\tau\), stable in time, as could be due to an imperfect timing adjustment, due for instance to different cable lengths. In this case, all the events have the same \(t_{0}\).
* a jitter on the \(t_{0}\), as due to the vertex spread for instance. In this case, the shift on \(t_{0}\), \(\tau\), varies from event to event; we assume that the distribution of that shift is gaussian and we call its width \(\sigma_{vertex}\).
* a jitter on the sampling frequency as due to a jitter on the clock, due to the SCA or any imperfection on the flow of data before the ADC.

The ability to measure the time goes as \(\frac{1}{E}\) as the variance of the quantity \(E.\tau\) has been minimized. We therefore study the timing effects for high energies deposit, namely 50 GeV.

In the following studies, the weights are computed as explained in [4]: the covariance matrix is computed from the data and the theoretical pulse shape. In the present case, this means that the weights are computed with data with imperfect timing.

### Time resolution

At 50 GeV, the time resolution is 100ps at low luminosity; the time resolution function can been parametrized by: \(\sigma(\tau)=\frac{5n\,s.GeV}{E_{t}\,(GeV)}\) for this configuration (i.e. transverse energy in a nonet with a noise of \(\simeq 220\ MeV\)). At the nominal luminosity, the time resolution at 50 GeV becomes 160ps in a nonet.

If one would consider only one cell of solid angle (i.e. 3 cells in depth:\(\sigma_{noise}=\sqrt{3}\times 42=73\ MeV\)), the time resolution would improve to 31 ps at 50 Gev i.e. \(\sigma(\tau)=\frac{1.5ns.GeV}{E\,(GeV)}\), at low luminosity.

### Global time shift

We have applied a shift \(\tau\) between the begining of the pulse \(t_{0}\) and the clock, which is assumed to be perfect for this study. On Fig. 3 are shown the distributions of energies and timing measurement for the case of 50 GeV, with a time offset of 5ns. In table 5 are listed, for the low and nominal luminosities, values of the average reconstructed time shift \(\tau_{rec}\) together with the average of the difference between the reconstructed energy and the input energy, for 50 GeV; the widths of the time and energy are unchanged when increasing the shift up to \(\simeq 10\ ns\). One can see that a time shift below \(\simeq 4\ ns\) does not affect much either the time measurement or the energy measurement at low luminosity: for 4 ns, the shift is for the quantities \(\leq 0.7\%\). At nominal luminosity, the time measurement is affected at the level of 3.2%.

In the TP it is stated that the shapers could be adjusted within 1ns; the present study shows that, in term of energy and time measurements, this specification is very safe.

In this study, we have assumed that apart from the global time shift on \(t_{0}\), the timing was perfect. We now consider the case when the shift from \(t_{0}\) varies from one event to the next with a jitter that we call \(\sigma_{vertex}\).

\begin{tabular}{|c||c|c|c||c|c|c||} \hline  & \multicolumn{3}{|c||}{low luminosity} & \multicolumn{3}{|c||}{nominal luminosity} \\  & \multicolumn{3}{|c||}{1 event/cross.} & \multicolumn{3}{|c||}{20 evts/cross.} \\ \hline \hline  & \(<\Delta\tau_{rec}>\) & \(<\Delta E_{rec}>\) & \(<\Delta E_{peak}>\) & \(<\Delta\tau_{rec}>\) & \(<\Delta E_{rec}>\) & \(<\Delta E_{peak}>\) \\  & ps & MeV & MeV & ps & MeV & MeV \\ \hline \hline
0 ns & 0.6 & -3.3 & 1.7 & 4. & 8. & 8. \\
1 ns & 1. & -3.3 & -49. & 4. & 8. & -43. \\
2 ns & 8. & -45. & -200. & 26. & 87. & -194. \\
3 ns & 18. & -130. & -445. & 67. & -274. & -439. \\
4 ns & 29.(0.7\%) & -260.(\(-\)0.5\%) & -780. & 127.(3.2\%) & -550. (\(-\)1\%) & -774. \\
5 ns & 38. & -437. & -1200. & 203. & -907. & -1195. \\
7 ns & 37. & -934. & -2275. & 399. & -1847. & -2271. \\ \hline \hline \end{tabular}

Table 5: _Results for timing and energy accuracies, for 50 GeV, when increasing the time offset \(\tau\), for the low and nominal luminosities (1 and 20 events/crossing). \(<\Delta\tau_{rec}>\) is given in picoseconds and \(<\Delta E>\) in MeV. There is no effect either on timing or on energy resolution. The typical error on the energy mean value is of a few MeV; on the time mean value it is 3 ps for this energy (50 GeV)._

### Vertex spread: jitter on \(t_{0}\)

From table 5 we know that an offset on \(t_{0}\), smaller than 2 ns, does not affect either the timing accuracy or the energy. The case we consider now differs from the previous one, only by the fact that the coefficients are computed with different conditions: here the shift \(\tau\) on \(t_{0}\) varies from one event to the next, as it will because of the vertex spread. The vertex distribution along the z axis, has a \(\sigma\) of 5 cm; this leads to jitter on the time of arrival of the particles in the barrel of \(\simeq 150\)_ps_.

The effects of the energy measurement are small: for a 1ns jitter on \(t_{0}\), the energy is only shifted by \(\simeq 0.1\pm 0.02\%\) at nominal luminosity, and only by \(\simeq 0.05\pm 0.01\%\) at low luminosity. The timing measurement is not affected for jitters on \(t_{0}\) below 1ns.

### Clock jitter: jitter on the sampling frequency

From the previous section, we have learnt that a jitter on \(t_{0}\) is not a problem for the energy and time reconstructions. As in the experiment there will be jitter on \(t_{0}\) of at least 150 ps, we have put this effect in the present analysis, where we study the effect of a jitter on the sampling frequency: we introduce a fluctuation around the nominal 25ns between two bunches of width \(\sigma_{clock}\). This fluctuation could come from the clock itself, from the position in the SCA,.....; we have varied \(\sigma_{clock}\) between 50 ps and 1 ns and looked at the effects on the energy and time reconstructions; results are summarized in table 6. On Fig. 4 are shown energy and timing distributions for the case \(\sigma_{clock}=200\)_ps_.

From table 6 one can extract the following result: the contribution to the constant term of the energy resolution (added in quadrature) goes as \(1.6\%/ns\) leading to the constraint that the jitter on the clock frequency should be kept below 200ps, if its contribution is not to increase the constant term (0.5%) by more than 10%: if \(\sigma_{clock}=200ps\), \(\frac{\sigma(E_{rec}-E)}{E}=0.4\%\) to be compared to 0.3% when \(\sigma_{clock}=0ps\); the quadriatque difference between the two ratio is 0.25%, half of the constant term. To give this result, we have checked that the effect on \(\frac{\Delta E}{E}\) is indeed independant of E.

## 4 Number of samples

So far we have only consider the case where the pulse is sampled 5 times. In this section we look at results on energy and timing resolution when the pulse is sampled only 3 times. In table 7 are given the energy and time resolution for 2 luminosities and for 2 cases: the case when the 3 samples are taken at each bunch crossing (called \(\Delta sample=1\)) and the case when there are 2 bunch crossings between 2 samples; the peak is the middle point in each case. Using _algo. 2_ for energy and time measurements, the energy resolution is degraded by 9, 3 and 4 % at low, nominal and high luminosities respectively and the time resolution by 10, 3.5 and 27%, compared to the measurement with 5 samples. This result is given using three consecutive samples. When the time between 2 samples is 2 bunch crossings, the timing resolution isdegraded by a factor 3 whereas the energy resolution becomes slightly better for the nominal and high luminosities.

In any case, sampling the pulse only three times affects the energy and timing measurement: the energy is less degraded than the timing measurement. This study indicates that the energy and timing resolution obtained with three samples of the pulse are still acceptable for operating the LAr calorimeter at all luminosities. Nevertheless further studies, more detailed and systematic, should be pursued before choosing the number of samples.

\begin{table}
\begin{tabular}{|r||c|c||c|c||c|c||} \hline  & \multicolumn{6}{|c||}{low luminosity} \\  & \multicolumn{6}{|c||}{1 event/cross.} \\  & \multicolumn{6}{|c||}{\(\sigma(t_{0})=150\)\(ps\)} \\ \hline \hline \(\sigma_{clock}\) & \(<\Delta\tau>\) & \(\sigma_{\tau}\) & \(<\Delta E_{rec}>\) & \(\sigma\,E_{rec}\) & \(<\Delta E_{rec}>\) & \(\sigma\,E_{rec}\) \\ ps & ps & ps & MeV & MeV & MeV & MeV \\ \hline \hline
0 & 1.3 & 100. & -5.6 & 147. & -4.4 & 239. \\
50 & 0.3 & 107. & -5.4 & 152. & -4.7 & 239. \\
100 & -0.8 & 126. & -5.4 & 168. & -5.7 & 239. \\
150 & -1.8 & 151. & -5.5 & 191. & -7.1 & 239. \\
200 & -2.8 & 180. & -5.7 & 219. & -8.8 & 239. \\
250 & -3.9 & 212. & -6.0 & 252. & -10.6 & 239. \\
500 & -9.2 & 385. & -9.4 & 436. & -24. & 240. \\
1000 & -10.6 & 733. & -25.0 & 834. & -75. & 260. \\ \hline \hline \end{tabular}
\end{table}
Table 6: _Results for timing and energy accuracies, for 3320 events at 50 GeV, when increasing the time jitter on the sampling frequency; there is a jitter on \(t_{0}\) of 150 ps. \(\Delta\tau=\tau_{rec}-t_{0}\) and \(\sigma_{\tau}\) are given in picoseconds, \(\Delta E\) and \(\sigma_{E}\) in MeV, where \(E\) is either \(E_{rec}\) using alfo. 2 or \(E_{peak}\). The typical error on the time mesurement is of a few ps and on the energy measurement of a few MeV. The results are given at low luminosity, where the effect is the most visible._

\begin{table}
\begin{tabular}{|c||c|c||c|c||c||c|c||} \hline  & \multicolumn{4}{|c||}{low lumi.} & \multicolumn{4}{|c||}{high lumi.} \\  & \multicolumn{4}{|c||}{levent/cross.} & \multicolumn{4}{|c||}{50\(\mathrm{vts}\)/cross.} \\ \hline \hline  & \(\sigma(\,E_{rec})\) & \(\frac{\Delta\sigma\,E}{\sigma\,E}\) & \(\sigma(\tau_{rec})\) & \(\frac{\Delta\sigma_{\tau}}{\sigma_{\tau}}\) & \(\sigma\,E_{rec}\) & \(\frac{\Delta\sigma_{E}}{\sigma_{E}}\) & \(\sigma(\tau_{rec})\) & \(\frac{\Delta\sigma_{\tau}}{\sigma_{\tau}}\) \\  & MeV & & ps & MeV & & ps & \\ \hline \hline \(\Delta sample=1\) & 160 & 9.\% & 110. & 10.\% & 667. & 3.9\% & 265. & 27.\% \\ \(\Delta sample=2\) & 242 & 65.\% & 380. & 2800.\% & 645. & 0\% & 805. & 2870.\% \\ \hline \hline \end{tabular}
\end{table}
Table 7: _Results for energy and timing resolutions, for 3320 events with 50 GeV, when sampling the pulse 3 times: either every bunch crossing around the peak, or every two bunch crossing around the peak. The ratio are the relative variation with respect to the measurements using 5 samples._

## 5 Peaking time

There is the project to use preamplifiers that would compress the signal after \(\simeq~{}200\;GeV\); when there is compression, the pulse shape at the output of the preamps is changed so is the peaking time at the output of the shaper \(\tau_{triangle}^{shaper}\). In this section, in order to estimate what would be the impact on the energy and time resolutions, we have varied the peaking time of the shaper between \(20\) and \(100\) ns. In table 8 are summarized the results of this study. This study does not describe very well the problem as the electronics noise increases when \(\tau_{triangle}^{shaper}\) decreases; in the case of the preamp compression this would not be the case as \(\tau_{triangle}^{shaper}\) would actually be unchanged. Nevertheless, this study allows us to observe that when \(\tau_{triangle}^{shaper}\) becomes too small (below \(\simeq 30-35\;ns\)), the energy and time resolution are degraded significantly; as the pulse is only sampled once or twice (for a sampling frequency of \(40\) MHz) the optimal filtering does not help. On the other side, increasing \(\tau_{triangle}^{shaper}\) up to \(\simeq 70-80\;ns\) does not affect much the resolution, if one considers the result after optimal filtering. This statement can be nuanced by looking separatly at time and energy resolutions or as a function of the luminosity. This study was performed using \(5\) samples; obviously this is not good enough at large peaking time. The effect of using \(8\) samples is illustrated by the last line of table 8.

From this study, one can conclude that if the energy and time can be reconstructed using the optimal filtering technique with \(5\) samples, a shaper peaking time of \(70\) ns could be used: the energy resolution would barely be affected; the time resolution would be degraded by \(30\%\) at nominal luminosity, by \(40\%\) at high luminosity and not at all at low luminosity. On the contrary, going down below \(\tau_{triangle}^{shaper}=35ns\) does affect significantly energy and time measurement (with or without optimal filtering).

For clarity, and following [8], what is called here \(\tau_{triangle}^{shaper}\) is the position of the maximum of the pulse and not the peaking time (\(5-100\%\)) as defined there; one needs to multiply \(t_{max}\) of table 8 by a factor \(0.84\) in order to obtain the peaking time (\(5-100\%\)); this factor was obtained using Table 1 of [8]. For instance, in this note we have used \(45\) ns for the shaper peaking time (\(0-100\%\)) (the \(t_{max}\) of [8]) to a triangle; it corresponds to \(37.8\)ns of peaking time (\(5-100\%\)). In the T.P. [2], noises figures in Table 2.4 are given for \(t_{p}(\delta)=20ns\); this corresponds to \(t_{max}=52ns\) in the notation of table 8.

## 6 Conclusions

In this note we have studied different algorithms to reconstruct energy and time, in a nonet, at three luminosities, using the optimal filtering method [1]. The following points have been made:

* the optimal filtering is essential at low luminosity.
* The use of an algorithm able to extract energy and time is mandatory, as the timing will not be perfect in real life.

* At nominal (low) luminosity the RMS of the transverse energy distribution is, after shaping and with optimal filtering, \(\simeq 450\ MeV\ (\simeq 160\ MeV\)). The timing resolution goes as \(\frac{8\,ns\,GeV}{E_{t}}\ \left(\frac{5n\,s\,GeV}{E_{t}}\right)\) at nominal (low) luminosity.
* Energy and time resolutions are not affected by a shift on \(t_{0}\) either global (below \(\simeq 10\ ns\)), as would be introduced by a different cable length, or a jitter (below \(\simeq 1\ ns\)), as due to the vertex spread.
* A jitter on the clock frequency, as due to a jitter on the clock or the position of the sample in the SCA, is more dangerous; in order not to increase the constant term of the calorimeter energy resolution of \(0.5\%\) by more than \(10\%\) (i.e. keep it below \(0.55\%\)) one has to keep the jitter on the sampling frequency below \(200\)ps.
* the energy and timing resolutions measured with \(3\,\)samples instead of \(5\) are degraded but probably still acceptable.
* going to low peaking time (below \(35\,\)ns) affects the energy and timing resolutions; whereas increasing it up to \(\simeq 70\,ns\), when using \(5\) samples, does not affect the energy resolution; the timing resolution is degraded by \(30-40\%\).

Results on timing measurements are improved when one looks at only one electromagnetic cell, as the noise is much smaller; this could not be done here because of the lack of detailed shower simulation.

\begin{table}
\begin{tabular}{r||c|c|c||c|c|c||c|c}  & \multicolumn{3}{c||}{low lumi.} & \multicolumn{2}{c||}{nom. lumi.} & \multicolumn{2}{c}{high lumi.} \\  & \multicolumn{3}{c||}{1event/cross.} & \multicolumn{3}{c||}{20evts/cross.} & \multicolumn{3}{c}{50evts/cross.} \\ \hline \hline \(t_{\mathit{max}}\) & \(\sigma\left(E_{peak}\right)\) & \(\sigma\left(E_{rec}\right)\) & \(\sigma\left(\tau_{rec}\right)\) & \(\sigma\left(E_{peak}\right)\) & \(\sigma\left(E_{rec}\right)\) & \(\sigma\left(\tau_{rec}\right)\) & \(\sigma\left(E_{peak}\right)\) & \(\sigma\left(E_{rec}\right)\) & \(\sigma\left(\tau_{rec}\right)\) \\ ns & MeV & MeV & ps & MeV & MeV & ps & MeV & MeV & ps \\ \hline \hline
20 & 724. & 780. & 749. & 780. & 837. & 777. & 867. & 929. & 817. \\
25 & 532. & 546. & 444. & 609. & 635. & 508. & 719. & 743. & 576. \\
30 & 402. & 317. & 236. & 525. & 513. & 328. & 674. & 682. & 428. \\
35 & 331. & 208. & 136. & 484. & 469. & 216. & 648. & 644. & 285. \\
40 & 272. & 159. & 109. & 465. & 455. & 180. & 650. & 635. & 235. \\
45 & 235. & 142. & 99. & 466. & 452. & 161. & 683. & 647. & 208. \\
50 & 205. & 136. & 97. & 473. & 448. & 154. & 711. & 654. & 193. \\
55 & 190. & 138. & 97. & 496. & 459. & 153. & 751. & 667. & 192. \\
60 & 174. & 133. & 99. & 503. & 450. & 168. & 776. & 663. & 213. \\
70 & 149. & 128. & 103. & 538. & 457. & 211. & 843. & 683. & 280. \\
100 & 142. & 137. & 118. & 647. & 530. & 400. & 1023. & 814. & 587. \\ \hline
100/8 & 142. & 132. & 100. & 647. & 439. & 208. & 1023. & 642. & 270. \\ \end{tabular}
\end{table}
Table 8: _Results for energy and timing resolutions, for 3320 events with 50 GeV, when varying the shaper peaking time to the triangle between 20 and 100 ns at the three luminosities. For each luminosity and each peaking time three values are given: the energy resolution when sampling the pulse at the peak only and using optimal filtering with 5 samples (\(\sigma\left(E_{peak}\right)\) and \(\sigma\left(E_{rec}\right)\) respectively) and the timing resolution \(\sigma\left(\tau_{rec}\right)\). The last line gives the results for a peaking time of 100 ns but using 8 samples._List of Figures
* 1 _a) Pulse after the Shaper (CR2-RC3) (full line) and the 5 measurements (arrows). The timing has been adjusted so that the maximum of the pulse is sampled (3rd point)._\(t_{max}^{triangle}=45ns\)_;_\(t_{dri\,ft}=441ns\)_;_\(t_{BX}=25ns\)_. Also plotted is the derivative (dashed line) and the response to a derivative of an impulse (dotted line); these three functions are used in the simulation._
* 2 _Distributions of the reconstructed energy (using algo. 2) for 3320 events with 50 GeV deposit in a nonet. a) at low luminosity, b) at nominal and c) at high luminosity. Both electronics and pile-up noises are included._
* 3 _Distributions of the reconstructed energy for 3320 events with 50 GeV deposit in a nonet, at nominal luminosity and of the reconstructed time offset: the actual time offset being 5 ns. a) using the peak measurement, b) using the algorithm 2. The reconstructed time offset is shown on plot c). Both electronics and pile-up noises are included._
* 4 _Distributions of the reconstructed energy for 3320 events with 50 GeV deposit in a nonet, at low luminosity: \(\sigma(t_{0})=150\) ps and \(\sigma(clock)=200\) ps. a) using the peak measurement, b) using the algorithm 2. Distribution of the reconstructed offset on \(t_{0}\) c) raw and d) having subtracted the actual offset (event by event). Both electronics and pile-up noises are included._

## References

* [1] W.E. Cleland and E.G. Stern: Signal processing considerations for liquid ionization calorimeters in a high rate environment, NM A338(1994)467-497.
* [2] ATLAS Technical Proposal for a General-Purpose pp Experiment at the LHC at CERN. CERN/LHCC/94-43; LHCC/P2
* [3] Front-End Electronic for the ATLAS electromagnetic Calorimeter System Specifications.
* [4] I. Wingerter-Seez: Study of the effect of pile-up events on energy measurements for the LAr electromagnetic calorimeter. ATLAS Internal Note/LARG-N0-18/April 1995.
* [5] N. Launay, C. de la Taille and L. Fayard: Noise improvement with multiple samples, ATLAS Internal Note/CAL-NO-024/12 July 1993.
* [6] J. Parsons: Preliminary results of analysis of LKr data with Nevis SCA readout, LAr meeting, 25/01/95.
* [7] L. Serin and V. Tisserand: Study of pileup in the ATLAS electromagnetic calorimeter. ATLAS Internal Note/CAL-NO-73/7 February 1995.
* [8] R.L. Chase et al.: A fast monolithic shaper for the ATLAS electromagnetic calorimeter. ATLAS Internal Note/LARG-NO-10/208 February 1995.