# ATLAS FCal Diagnostics using the Calibration Pulse

J.Rutherford

 A Savine

University of Arizona, Tucson, USA

30 June 2004

###### Abstract

The calibration pulser in the ATLAS Forward Calorimeter electronics is used to 1) directly calibrate the warm, active electronics and 2) diagnose the cold, passive electronics chain all the way to the liquid argon electrodes. The study presented here shows that reflections of the calibration pulse coming from discontinuities located at or between the warm preamplifier and the electrode can differentiate and identify all known defects so far observed in this chain.

## 1 Introduction

For most of the liquid argon calorimeters in ATLAS, a precision calibration pulse is introduced directly onto the electrodes, electrically mimicking the way the electrons from ionizing radiation drifting in the liquid argon gaps deposit charge onto the electrodes. But the calibration strategy for the Forward Calorimeter (FCal) is different. Because the radiation environment is especially severe in the forward region there was a worry that the calibration cables and distribution system would not survive over the course of the experiment. Also the precision of the energy measurement from the FCal is already compromised by other factors so the calibration needn't be determined quite as accurately as for the accordion calorimeters. The calibration pulse is therefore introduced at the input to the warm preamplifiers. At this point the calibration pulse is split roughly in half with one half going directly into the warm electronics and the other half traveling down the cables to the FCal electrodes and then reflecting back to the warm electronics. There are small imperfections between the preamplifier and the electrodes which introduce smaller reflections as well. It is the diagnostic power of these reflections which we present in this report.

## 2 Reflections in the readout chain

The cold, passive readout chain of the ATLAS FCal (Fig. 1 shows the normal "summed" channel) is designed to have a nearly uniform line impedance from each FCal liquid argon tube electrode to the warm preamplifier outside the cryostat, giving minimal reflections. The signal pulse is integrated right at the electrode so the high frequency components are filtered out. But the leading edge of the calibration pulse is much shorter than the signal pulse thus providing greater sensitivity to any small discontinuities in impedance. In the warm electronics we record a waveform from our calibration system which starts with the half of the pulse which travels directly into the preamplifier and is followed by the reflection of the other half of the pulse off of the FCal electrodes. Between the direct pulse and the reflected pulse are a number of small reflections from imperfections along the readout chain. And the reflected pulse is followed by smaller, multiple reflections.

There are two points in the chain where, by design, the impedances are not matched.

1) If we consider the FCal tube electrodes as transmission lines, then they are badly matched to the 25 \(\Omega\) readout cables. For instance in the FCal1 module each electrode has a characteristic impedance of 5.2 \(\Omega\) and the four electrodes ganged in parallel look like a 1.3 \(\Omega\) transmission line. Furthermore each electrode is unterminated at the far end. However the electrodes are such short transmission lines that it is a reasonable approximation to treat each ganged set of electrodes as a discrete capacitor terminating the readout cable. We usually make this approximation in our SPICE simulations. From either point of view, the electrode end of the readout cable does not have a matching termination.

2) In each cryostat, some readout cables are 25 \(\Omega\) and some are 50 \(\Omega\). (The FCal uses only 25 \(\Omega\) cables but other liquid argon calorimeters use both impedances.) Between the cold and warm flange of the feedthrough it was decided to use 33 \(\Omega\) transmission lines (vacuum cables) as a compromise so that all the feedthroughs could be identical. The same philosophy was applied to the pedestal cables. The vacuum cables and pedestal cables are each 0.3 m long and the pedestal cables take

Figure 1: _Readout chain of the ATLAS FCal (“Summed” channel)_the pulse to the Front End Board (FEB) and the preamplifier.

These two intentional discontinuities are located at each end of the cold electronics chain.

There are a number of imperfections in the cold electronics chain which lead to modified or additional reflections. Some are unavoidable like cable connectors, ohmic resistance in the cables, small impedance mismatches, the summing transformer, and the blocking capacitor. Others are the very few anomalies like shorts on the electrodes, broken and/or cross-linked signal lines, and broken ground braids.

There are three normal classes of channels, 1) those which are summed via a transmission line transformer on the summing board, 2) those which are unsummed but attenuated by a factor two in order to match the gain of summed channels for purposes of trigger mixing, and 3) those which are unsummed and unattenuated.

To what extent can the reflections of the calibration pulse differentiate between the normal channels and pick out the various failure modes?

## 3 Data used in the analysis

In the present study, a subset of the calibration data from the FCal Calibration Test Beam Run (conducted in summer 2003) was used. Special runs were taken with 24 time samples per event and with 3ns event-to-event delay step. This allowed us to reconstruct the calibration waveform with timing steps which are small compared to the pulse shaping network with time constant of \(\tau\approx 13\)ns.

Though twelve different DAC setting were recorded (and used for different studies), we use only the DAC=750 setting for the reflection diagnostics shown here. At this setting the recorded waveform comes from the high gain output of the shaper but is large enough that the electronics noise contribution is negligible. At the same time the pulse is not so large that the nonlinearity (to be described in a separate note) has not yet set in. The calibration pulsers were fired one at a time, sending a signal to one channel at every FEB thereby eliminating most crosstalk concerns.

Calibration data was taken in two hardware configurations. The 'uncabled' waveform corresponds to a simplified setup where the pedestal cables are unplugged from the base plane. The calibration pulse goes only into the preamplifier (dashed line in Fig. 2) without splitting. This measurement is useful for one-time FEB and pulser system certification. The simplicity of the setup makes it a good test-bench for the pulse shape simulation (SPICE).

The 'connected' pulse shape was obtained with all elements of the readout chain in place. Part (nearly half) of the calibration pulse travels straight to the FEB preamplifier, while the other half travels down to the calorimeter electrodes, reflects, and travels back up the cold electronics chain to the preamplifier. This 'connected' pulse shape is shown as a solid line in Fig. 2.

Using these two waveforms, one can extract the (shaped) reflected signal and analyze its shape.

## 4 Extraction of the reflected signal

The first step in the analysis is to compare the signal obtained with disconnected cables with the first part of the 'connected' pulse (the peak between 60 and 120ns, Fig. 2). The ratio of these two signal amplitudes is determined by the ratio of the cold cable impedance to the preamplifier input impedance according to equations 1 and 2. If the two impedances are equal (the naive intent) then the signal amplitudes differ by a factor two. The pigtail cables (see Fig. 1) are long enough to keep the main peak of the first half of the pulse unaffected by the earliest reflections (coming from the Summing Board).

\[A_{\text{uncabled}}(t)=G*A_{\varepsilon}(t) \tag{1}\]

\[A_{\text{connected}}(t)=\frac{G}{1+\frac{Z\,amp}{Z\,sub}}*A_{\varepsilon}(t)+ \frac{G}{1+\frac{Z\,sub}{Z\,sub}}*R(t) \tag{2}\]

\(G\) _is the product of DAC conversion and preamplifier gain \(A_{\varepsilon}(t)\) is the standard calibration waveform R(t) is the reflected waveform produced by \(A_{\varepsilon}(t);R(t)=0\) for \(t<120\) ns_

A small time alignment (0.5ns) is required to compensate for the delay of the 'connected' signal relative to the 'uncabled' signal1. Subtracting the 'uncabled' waveform from the 'connected' waveform after adjusting for the calibration pulse splitting, we have the reflected signal (Reflection) shape R(t) as it comes back from the readout chain. This is shown in Fig. 3. Also shown is a SPICE simulation with the same operations applied. Note that while the qualitative features are

Figure 2: _Calibration waveforms obtained during Reflection Diagnostics_similar, some more work is required before the simulation agrees in detail.

## 5 Reflection types and their identification

Defects in the readout chain will show up as anomalies in the reflection waveforms. These defects are being simulated as we understand them. Independent information on defects can be obtained by Time-Domain Reflectometer (TDR) tests2. In this paper, the state of a readout channel determined by TDR measurements is called 'TDR status'.

Footnote 2: TDR reflection tests are performed from the base plane with the FEBs removed. TDR measurements do not involve any signal shaping and therefore have better ‘spacial resolution’.

Some defects like 'Anomalous Shaper Time Constant' or 'Disconnected Calibration Line' may be identified with 'uncabled' data alone. Nonetheless, they were included in the analysis to maintain a uniform procedure.

FCal modules (FCal1, 2, & 3) have different tube electrode parameters, different number of tubes ganged together, and different lengths of readout cables. As a result, reflections from these three depth segments are different and must be analyzed separately.

Fig. 4 shows all cases of reflections obtained in the 2003 calibration data. Most of these fall into the "good" category3.

Footnote 3: All of the Disconnected channels found in the 2003 test beam run are not defects but, rather, unused cables left dangling. During the final assembly process, all of these dangling cables will be cut so that unused channels will be classed by the diagnostics as ‘Disconnected at Summing Board’.

The waveforms in Fig. 4 are usually averages over a number of channels. Each has an associated envelope (channel-to-channel variation plus some noise). We perform a \(\chi^{2}/N\) comparison of each individual channel against these typical waveforms. We have selected a subset of 13 samples (shaded vertical bands in Fig. 4 over a 40 ns time interval) where the differences between cases are largest.

Figure 3: _Extraction of the reflected pulse from the ‘Connected’ and ‘Uncabled’ waveforms. Data (left) and SPICE simulation (right)._

Examples of \(\chi^{2}/N\) sets obtained for some channels are presented in Table 1. The smallest values (bold face type in the table) belong to the best matching reflection type. The upper plot in Fig. 5 shows the distribution of \(\chi^{2}/N\) for all 1024 channels and all identified cases. The shaded peak near 0 (labeled'match with correct case') contains values for the cases determined independently by the 'TDR status', while all other values ('match with wrong case') are mostly in the overflow with a tail which extends into the plot. The statistics in the box in the upper right corner applies only to the 'Match with correct case'.

The lower plot in Fig. 5 shows for each channel the difference between the six wrong cases and one correct case. The gap in \(\chi^{2}/N\) is larger than 38, indicating that the smallest (bold face) values in the rows of Table 1 are reliable indicators of the channel status. These diagnostics use only a standard ATLAS calibration procedure and may be employed for FCal monitoring at any time during detector operation.

\begin{table}
\begin{tabular}{|r|r|r|r|r|r|r|} \hline Chan & Good & SB disc & Tube disc & Short & Braid & Calib & Shaper \\ \hline
267 & 855.9 & 2171.9 & 1454.0 & **0.15** & 1503.2 & & 13171.0 \\ \hline
792 & **0.69** & 2021.8 & 687.6 & 881.9 & 98.6 & 806.9 & \\ \hline
897 & 704.4 & **1.53** & 141.7 & 1127.3 & 942.5 & 139.0 & \\ \hline \end{tabular}
\end{table}
Table 1: \(\chi^{2}/N\) _for some channels. Empty cells represent missing cases: FCal1 (channels 792 and 897) does not have shaper problems, for example_

Figure 4: _Reflection waveforms obtained during Reflection Diagnostics_

## 6 Special cases among the normal FCal channels

The ATLAS Forward Calorimeter readout system includes three different types of readout channels. Most of the channels are 'Summed', that is, four groups of tubes are connected to the impedance matching transformer as shown in Fig. 1.

But a small number of channels are 'Unsummed' - with one harness cable passing directly through the summing board to one output cable without need for an impedance matching transformer. These channels provide fine segmentation around the beam hole and fill the segmentation pattern at the outer perimeter of the FCal. These channels have a gain twice that of the 'Summed' channels.

A subset of the 'Unsummed' channels are mixed with 'Summed' channels in the Front End Crate electronics to form the Level 1 trigger. To match the gain of the 'Summed' channels, resistive dividers are installed.

These three types of normal readout channels are designed to be electrically identical so, naively, it should not be possible to tell them apart by electrical tests. It is therefore a more challenging task to see if the scheme described above can be used to differentiate between these three normal cases.

In the 2003 FCal Calibration Test Beam Run none of the channels were fitted with the resistive dividers. But we had an additional case because some of the older Pigtail cables had lower than normal impedance. Fig. 6 is a collection of reflection cases observed for good channels.

The procedure is identical to the one described in Section 5. The range of time samples for the \(\chi^{2}/N\) calculations was chosen individually for the three modules, because differences between the cases are now comparable to the module-to-module variation (Fig. 6). Due to these small differences

Figure 5: \(\chi^{2}/N\) distribution (upper plot) and difference between values obtained for cases which do not match the ‘TDR status’ and those which match it (lower plot).

between the reflection types, the gap in \(\chi^{2}/N\) (Fig. 7, lower plot) is not as big as the one in Fig. 5. Nevertheless, all the cases are identified properly for 981 good channels of the ATLAS FCal Calibration Test Setup. Note that although the two distributions overlap in the upper plot of Fig. 5, the larger values of \(\chi^{2}/N\) in the 'Match with correct case' distribution also have larger values of \(\chi^{2}/N\) for the 'Match with wrong case' distribution as can be seen in the lower plot.

## 7 Conclusions and Plans

The reflected calibration pulse carries sufficient information to determine the status of the ATLAS FCal readout channels. The technique described here allows us to identify 100 % of the defects and good channel subtypes in the 2003 FCal Calibration Test Beam Run data sample.

To perform the diagnostic procedure, data must be taken with fine delay steps (at least 3 ns) and

\begin{table}
\begin{tabular}{|c|c|c|c|c|} \hline Channel & Unsummed & Summed & Unsummed & Summed \\  & Normal Z & Normal Z & Low Z & Low Z \\ \hline
16 & **0.33** & 10.5 & & \\ \hline
192 & **13.7** & 15.7 & & \\ \hline
792 & 53.4 & 18.0 & 15.4 & **1,04** \\ \hline
995 & 14.2 & **0.90** & 27.7 & 18.9 \\ \hline \end{tabular}
\end{table}
Table 2: \(\chi^{2}/N\) _for some good channels. Empty cells ‘represent missing cases: FCal3 (channels 16 and 192) did not have cables with low Z_

Figure 6: _Reflection waveforms obtained during Reflection Diagnostics for the normal (good) channels_

over a time span which includes almost all of the pulse (at least 24 samples). More time samples at finer steps (32 samples, 1 ns) will provide better results. A single calibration DAC value (750) and fixed gain (high) readout are the recommended settings.

A one-time measurement of the calibration pulse with unplugged pedestal cables is important, since it allows us to separate the amplifier gain and amplifier-cable impedance mismatch. Without this measurement, the reconstructed 'pure' reflection pulse shape will be affected by the vertical scale variation. This will increase the measurement error and deteriorate the effectiveness of the procedure.

It appears that some channels, despite being properly identified, have a large \(\chi^{2}/N\) value (e.g. channel 192 in Table 2). Additional study will be undertaken to investigate the nature of such anomalies. Among the probable causes are cable impedance variation within a harness, channels at the edge of a module with fewer than the normal number of ganged tube electrodes (by design), odd shapes of the interconnect board providing uneven path lengths from the cable to the tubes and some 'beating' between the reflected signals.

Optimization of the sample sets used for the \(\chi^{2}/N\) calculation is not final. We will repeat this study for the CBT-EC2 setup once it is filled with liquid argon. We are making 25 Ohm terminator boards to plug into the underside of the baseplane in place of the pedestal cables so that we will have three, rather than two configurations for future studies. We will have 'connected' and 'uncabled' as before but for CBT-EC2 we will have 'terminated' in addition. Because we will use precision resistors on the terminator boards we will have an accurate measure of the preamplifier input impedance.

Figure 7: \(\chi^{2}/N\) distribution (upper plot) and difference between values obtained for cases that do not match the ‘TDR status’ and those which match it (lower plot).

Acknowledgements

The authors would like to thank the ATLAS FCal group for their many contributions that made possible the acquisition of the data used in this study. In particular we thank Dr. Petr Gorbunov (Univ. of Toronto/ITEP Moscow) for taking and organizing all the calibration data used in this study.