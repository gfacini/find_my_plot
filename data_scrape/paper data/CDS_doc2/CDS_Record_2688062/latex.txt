[MISSING_PAGE_EMPTY:1]

## 1 Introduction

The tau lepton has a mass of 1.777 GeV and decays either leptonically (\(\tau\to\nu_{\tau}\nu_{\ell}\), \(\ell=e,\mu\)) or hadronically (\(\tau\to\nu_{\tau}\) hadrons) after a proper decay length of 87 \(\mathrm{\SIUnitSymbolMicro m}\)[1]. Due to its short decay length, tau leptons produced in proton-proton (\(pp\)) collisions within the ATLAS experiment [2] at the LHC typically decay before they reach the innermost layer of the pixel detector and thus only the decay products of the tau leptons can be observed. This note only considers the hadronic tau lepton decays which correspond to a total branching fraction of approximately 65%. Almost all hadronic tau lepton decays include one (72%) or three (22%) charged pions and the majority (68%) include one or more neutral pions. Therefore, their signature corresponds to that of a narrow jet with one or three tracks in the detector. The neutrino from the hadronic tau lepton decay can not be reconstructed and the combination of all visible decay products is referred to as \(\tau_{\mathrm{had-vis}}\).

This note describes a novel identification algorithm that uses track and calorimeter information in a recurrent neural network (RNN) to separate true \(\tau_{\mathrm{had-vis}}\) and misidentified \(\tau_{\mathrm{had-vis}}\) originating from quark- and gluon-initiated jets. It is now used as the default tau identification algorithm for the data recorded by the ATLAS experiment from 2015 to 2018, also referred to as LHC Run 2, and has been used in tau lepton triggers in 2018.

The note is structured as follows. Section 2 introduces the ATLAS experiment at CERN, Section 3 describes the simulation samples used to train the tau identification algorithm and to assess its performance and Section 4 describes the reconstruction of \(\tau_{\mathrm{had-vis}}\) candidates. The neural-network-based identification algorithm and its training is described in Section 5, its performance is discussed in Section 6 and Section 7 concludes.

## 2 The ATLAS detector

The ATLAS experiment at the LHC is a multi-purpose particle detector with a forward-backward symmetric cylindrical geometry and a near \(4\pi\) coverage in solid angle.1 It consists of an inner tracking detector surrounded by a thin superconducting solenoid providing a 2 T axial magnetic field, electromagnetic and hadron calorimeters, and a muon spectrometer. The inner tracking detector covers the pseudorapidity range \(|\eta|<2.5\). It consists of silicon pixel, silicon microstrip, and transition radiation tracking detectors. The innermost layer of the pixel detector, the insertable B-layer (IBL), was installed between Run 1 and Run 2 of the LHC. Lead/liquid-argon (LAr) sampling calorimeters provide electromagnetic (EM) energy measurements with high granularity. A hadron (steel/scintillator-tile) calorimeter covers the central pseudorapidity range (\(|\eta|<1.7\)). The end-cap and forward regions are instrumented with LAr calorimeters for both EM and hadronic energy measurements up to \(|\eta|=4.9\). The muon spectrometer surrounds the calorimeters and is based on three large air-core toroidal superconducting magnets with eight coils each. The field integral of the toroids ranges between 2.0 and 6.0 T m across most of the detector. The muon spectrometer includes a system of precision tracking chambers and fast detectors for triggering. A two-level trigger system is used to select events. The first-level trigger is implemented in hardware and uses a subset of the detector information to reduce the accepted rate to at most nearly 100 kHz. This isfollowed by a software-based trigger that reduces the accepted event rate to 1 kHz on average depending on the data-taking conditions.

## 3 Monte Carlo samples

Monte Carlo (MC) simulations are used to train the RNN and evaluate its performance. The signal sample consists of \(\gamma^{*}\to\tau\tau\) events generated with Pythia8.212 [3], while background samples consist of dijet events produced with Pythia8.186. The Pythia8 generator was used for the matrix-element calculation, as well as the simulation of parton shower, hadronisation, underlying event, and \(\tau\)-lepton decay. The A14 [4] set of tuned parameters and the NNPDF2.3LO [5] set of parton distribution functions (PDFs) with \(\alpha_{S}=0.13\) were used. The decays of bottom and charm hadrons were simulated with the EvtGen v1.2.0 program [6].

All tau leptons in the \(\gamma^{*}\to\tau\tau\) events were forced to decay hadronically to maximise the available training sample. In addition, the \(\gamma^{*}\to\tau\tau\) events use a biased phase space sampling to populate the generated spectrum towards high invariant masses (\(m_{\gamma^{*}}\)) to provide a sufficient number of \(\tau_{\text{had-vis}}\) with high \(p_{\text{T}}\). Similarly, the jet \(p_{\text{T}}\) spectrum of the di-jet sample uses a biased phase space sampling which is compensated by a continuously decreasing weight for the event.

The \(pp\) collisions were simulated at a centre-of-mass energy of \(\sqrt{s}=13\,\text{TeV}\), with a \(25\,\text{ns}\) bunch spacing. The effect of multiple \(pp\) interactions in the same and neighbouring bunch crossings (pile-up) was modelled by overlaying simulated minimum-bias events generated with Pythia8.186 using the NNPDF2.3LO PDF set and the A3 tune [7] over the hard-scattering event. The average number of pile-up interactions per bunch crossing (\(\mu\)) in the simulation can reach up to \(\simeq 70\), and is representative of LHC Run-2 pile-up conditions. Generated events were processed through the ATLAS detector simulation [8] based on Geant4 [9].

## 4 Tau reconstruction

The reconstruction of \(\tau_{\text{had-vis}}\) candidates is described in detail in Ref. [10]. The \(\tau_{\text{had-vis}}\) candidates are seeded by jets formed using the anti-\(k_{t}\) algorithm [11], with a distance parameter of 0.4. Three-dimensional clusters of calorimeter cells called _TopoClusters_[12], calibrated using a local hadronic calibration (LC) [13], serve as inputs to the jet algorithm. Jets seeding \(\tau_{\text{had-vis}}\) candidates are additionally required to have \(p_{\text{T}}>10\,\text{GeV}\) and \(|\eta|<2.5\).

The seed jet axis is defined as the energy-weighted barycentre of all associated TopoClusters. The \(\tau_{\text{had-vis}}\) candidate vertex is defined as the vertex candidate with the highest \(p_{\text{T}}\)-weighted fraction of all tracks with \(p_{\text{T}}>0.5\,\text{GeV}\) within an angular distance of \(R=0.2\) around the seed jet axis. A set of boosted decision trees (BDTs) is used to classify all tracks within \(R=0.4\) of the tau axis into _core_ and _isolation_ tracks, depending on their \(p_{\text{T}}\), the number of hits in the tracking detectors as well as their transverse and longitudinal impact parameters with respect to the tau vertex. The number of core tracks defines the number of prongs. For \(\tau_{\text{had-vis}}\) candidates with more than one core track, a secondary vertex is reconstructed from all core tracks.

The energy calibration of \(\tau_{\text{had-vis}}\) candidates is described in Ref. [14]. First, a pile-up subtraction and a response correction are applied to the sum of the energy of the LC TopoClusters within \(R=0.2\) of the tau candidate axis. This corrected energy is used together with information from tau particle flow described in Ref. [15] in a boosted regression tree to calculate the final energy of the \(\tau_{\text{had-vis}}\) candidate. In this note, only \(\tau_{\text{had-vis}}\) candidates with \(p_{\text{T}}>20\,\text{GeV}\) are used, while candidates in the transition region between the barrel and forward calorimeters, \(1.37<|\eta|<1.52\), are excluded due to poor instrumentation in this region.

## 5 RNN tau identification

The tau reconstruction algorithm described above provides no discrimination against other particles that result in jet-like signatures in the detector. Therefore, dedicated algorithms are used to identify hardonic tau lepton decays. A set of BDTs was previously used in ATLAS to discriminate jets from \(\tau_{\text{had-vis}}\), and is now superseded by a RNN classifier that provides largely improved jet rejection. The input variables used in the RNN are defined in Section 5.1, followed by the description of the RNN architecture in Section 5.2 and the training procedure in Section 5.3. The RNN performance is evaluated in Section 6.

### Input variables

The RNN uses a combination of low-level input variables for individual tracks and clusters that are associated to the \(\tau_{\text{had-vis}}\) candidate as well as several high-level observables calculated from track and calorimeter quantities, similar to those used in the BDT-based tau identification algorithm described in Ref. [16]. The information used from each associated track are the transverse momentum (\(p_{\text{T}}^{\text{track}}\)), transverse (\(d_{\text{0}}^{\text{track}}\)) and longitudinal (\(z_{\text{0}}^{\text{track}}\sin\theta\)) impact parameters, angular distance to the \(\tau_{\text{had-vis}}\) axis (\(\Delta\eta^{\text{track}}\), \(\Delta\phi^{\text{track}}\)), and the number of hits on the track in the different Si detector layers: innermost pixel detector layer (\(N_{\text{IBL hits}}\)), other pixel detector layers (\(N_{\text{Pixel hits}}\)), and microstrip detector layers (\(N_{\text{SCT hits}}\)). From each TopoCluster, the transverse energy (\(E_{\text{T}}^{\text{cluster}}\)), the angular distance to the \(\tau_{\text{had-vis}}\) axis (\(\Delta\eta^{\text{cluster}}\), \(\Delta\phi^{\text{cluster}}\)) and the cluster moments [17] are used:

**Cluster depth (\(\lambda_{\text{cluster}}\)):**: The distance of the cluster barycentre from the calorimeter front face, determined along the cluster axis.
**Longitudinal cluster extension (\(\lambda_{\text{cluster}}^{2}\)):**: Second moment of the longitudinal distance of cluster cells from the cluster barycentre, along the cluster axis.
**Radial cluster extension (\(\langle r_{\text{cluster}}^{2}\rangle\)):**: Second moment of the radial distance of cluster cells from the cluster axis.

Two exemplary distributions of input variables for the leading three tracks and clusters are shown in Figure 1.

Furthermore, the following high-level observables are used:

**Transverse momentum of the seed jet (\(p_{\text{T}}^{\text{seed jet}}\)):**: Transverse momentum of the original seed jet.
**Transverse momentum at the LC scale (\(p_{\text{T}}^{\text{uncalib}}\)):**: \(p_{\text{T}}\) of the \(\tau_{\text{had-vis}}\) candidate at the LC scale prior to tau energy scale calibration, calculated from the sum of cluster 4-momenta within \(\Delta R<0.2\) of the \(\tau_{\text{had-vis}}\) candidate axis, where the cluster origin is set to the tau production vertex, and cluster energies are calibrated at the LC scale.

**Central energy fraction (\(f_{\text{cent}}\)):**: Fraction of transverse energy at EM scale deposited in the region \(\Delta R<0.1\) with respect to all energy deposited in \(\Delta R<0.2\) around the \(\tau_{\text{had-vis}}\) candidate axis calculated by summing the energy deposited in all cells with a barycentre in these regions. The calorimeter cells are required to be part of a TopoCluster belonging to the \(\tau_{\text{had-vis}}\) candidate.
**Inverse momentum fraction of the leading track (\(f_{\text{leadtrack}}^{-1}\)):**: The transverse energy sum, calibrated at the EM energy scale, deposited in all cells belonging to TopoClusters in the core region, divided by the transverse momentum of the highest-\(p_{\text{T}}\) core track of the \(\tau_{\text{had-vis}}\) candidate.
**Maximum track \(\Delta R\) (\(\Delta R_{\text{max}}\)):**: The maximum \(\Delta R\) between a core track associated with the \(\tau_{\text{had-vis}}\) candidate and the \(\tau_{\text{had-vis}}\) direction.
**Transverse impact parameter significance of the leading track (\(|S_{\text{leadtrack}}|\)):**: Transverse impact parameter of the highest-\(p_{\text{T}}\) core track of the \(\tau_{\text{had-vis}}\) candidate, calculated with respect to the tau vertex, divided by its estimated uncertainty.
**Transverse flight path significance (\(S_{\text{T}}^{\text{flight}}\)):**: The decay length of the secondary vertex in the transverse plane, calculated with respect to the tau vertex, divided by its estimated uncertainty.
**Momentum fraction of isolation tracks (\(f_{\text{iso}}^{\text{track}}\)):**: Scalar sum of the \(p_{\text{T}}\) of isolation tracks associated with the \(\tau_{\text{had-vis}}\) candidate divided by the sum of the \(p_{\text{T}}\) of all the associated core and isolation tracks.

Figure 1: Distribution of the TopoCluster \(E_{\text{T}}\) (top) and track \(|\Delta\eta|\) (bottom) for true (red) and misidentified (blue) \(\tau_{\text{had-vis}}\) candidates for the leading three clusters and tracks. Samples of true and misidentified \(\tau_{\text{had-vis}}\) candidates with matching \(p_{\text{T}}\) distributions are used.

**Ratio of EM energy and track momentum (\(\boldsymbol{f_{\text{track}}^{\text{EM}}}\)):**: Ratio of the sum of cluster energy deposited in the electromagnetic part of the TopoClusters (pre-sample, first and second layers of the LAr calorimeter) to the sum of the momentum of core tracks. Clusters are calibrated at the LC energy scale.
**Fraction of track-plus-EM-system \(\boldsymbol{p_{\text{T}}}\) (\(\boldsymbol{p_{\text{T}}^{\text{EM+track}}/\boldsymbol{p_{\text{T}}}}\)):**: Ratio of the \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\), estimated using the vector sum of core track momenta and up to two most energetic EM clusters in the core region to the calorimeter-only measurement of \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\).
**Mass of the track-plus-EM-system (\(\boldsymbol{m^{\text{EM+track}}}\)):**: Invariant mass of the system composed of the core tracks and up to two most energetic EM clusters in the core region, where EM cluster energy is the part of TopoCluster energy deposited in the presampler and first two layers of the LAr calorimeter, and the four-momentum of an EM cluster is calculated assuming zero mass and using TopoCluster seed direction.
**Mass of the track system (\(\boldsymbol{m^{\text{track}}}\)):**: Invariant mass calculated from the sum of the four-momenta of all core and isolation tracks, assuming a pion mass for each track.

### Network architecture

The tau identification algorithm described in this note employs a recurrent neural network architecture. The internal state of recurrent layers allows processing of sequences of a priori unknown length. Reconstructed objects in the ATLAS detector can be viewed as an ordered sequence after imposing a physically-motivated ordering (e.g. ordering by object \(p_{\text{T}}\)) and are thus suited for the use in recurrent neural networks. A similar approach for flavour-tagging using charged particle tracks is already employed by the ATLAS experiment [18].

The network architecture of the RNN-based tau identification is depicted in Figure 2. To facilitate the use of associated charged particle tracks, clusters in the calorimeter and high-level variables, the network is split into three dedicated branches for each type of input. The high-level observables associated to each \(\tau_{\text{had-vis}}\) candidate are processed through a sequence of three fully connected layers with 128, 128 and 16 units.

Sequences of charged particle tracks (clusters in the calorimeter) ordered by decreasing \(p_{\text{T}}\) (\(E_{\text{T}}\)) are passed into the network and are transformed by two fully connected layers with shared weights. These _shared dense_ layers consist of a fully connected layer with 32 units for each track or cluster in the input sequence. Within each _shared dense_ layer, the same set of weights is used to process input tracks or clusters. As a result, _shared dense_ layers create intermediate representations of each track or cluster in the input sequence. The sequences of track and cluster representations are then passed into recurre

Figure 2: Schematic view of the network architecture used for tau identification. Layers marked as _dense_ are fully connected to adjacent layers.

long short-term memory_ (LSTM) architecture [19]. The first LSTM layer of the identification algorithm performs a mapping of the input track and cluster sequence to a sequence of the same length. Due to the internal state of the LSTM layer, information on early objects in the sequence can be propagated to later outputs. The second LSTM repeats this process but only the final element of the output sequence is used for further computations thereby summarising the input sequence in a single vector of activations. The internal state of the the LSTM layers consist of 32 units (24 units) for the branch operating on charged particle tracks (calorimeter clusters).

The input track and cluster sequences are truncated after ten leading tracks in \(p_{\mathrm{T}}\) and after six leading clusters in \(E_{\mathrm{T}}\) to reduce the time needed to train and evaluate the network. The inclusion of more reconstructed objects was not found to improve the discriminative power of the algorithm.

The results of the computation in the three branches are combined by concatenating their output vectors in a _Merge_ layer. Further computation on the resulting vector is performed by three fully connected layers with 64, 32 and 1 unit(s). After applying a sigmoid activation function, the final unit corresponds to the tau identification score.

All fully connected layers, except the output layer, use the ReLU activation function. The LSTM layers use sigmoid activation functions for the gates of the internal state and the hyperbolic tangent otherwise. Furthermore, all components employ bias-vectors to apply a trainable offset to the inputs of each layer. The final model consists of approximately 56 000 free parameters that need to be determined via optimisation.

### Training and evaluation

The RNN-based tau identification algorithm is trained using simulated samples of \(\tau_{\text{had-vis}}\) candidates previously introduced in Section 3. True \(\tau_{\text{had-vis}}\) candidates from \(\gamma^{*}\rightarrow\tau\tau\) are required to be geometrically matched to \(\tau_{\text{had-vis}}\) at generator level and correctly reconstructed as 1- or 3-prong decays. Reconstructed \(\tau_{\text{had-vis}}\) candidates not originating from \(\tau_{\text{had}}\) decays are taken from simulated dijet samples and are required to be reconstructed as 1- or 3-prong \(\tau_{\text{had-vis}}\) candidates.

Due to the distinct signatures of 1- and 3-prong \(\tau_{\text{had}}\) decays, the tau identification is split into dedicated algorithms for 1- and 3-track \(\tau_{\text{had-vis}}\). The input variables used for the respective 1- and 3-prong RNNs are listed in Table 1. The reconstructed \(p_{\mathrm{T}}\) of \(\tau_{\text{had-vis}}\) candidates used as input to the identification algorithm is shown in Figure 3. The sample of background \(\tau_{\text{had-vis}}\) candidates is reweighted, separately for 1- and 3-track candidates, in bins of \(\tau_{\text{had-vis}}\)\(p_{\mathrm{T}}\) to match the \(p_{\mathrm{T}}\) distributions of true \(\tau_{\text{had-vis}}\) in \(\gamma^{*}\rightarrow\tau\tau\) events. This procedure ensures that no \(p_{\mathrm{T}}\)-dependent bias is introduced in the trained classifier as the dijet \(\tau_{\text{had-vis}}\) candidate \(p_{\mathrm{T}}\) distribution is softer when compared to the signal \(\tau_{\text{had-vis}}\) sample.

The available sample of \(\tau_{\text{had-vis}}\) candidates consists of approximately 20 million signal candidates and 46 million background candidates after selection. The sample is split into dedicated samples for training of the network (40%), monitoring of training progress (10%) and performance evaluation (50%).

The network described in Section 5.2 is constructed and trained using Keras[20] and TensorFlow[21]. The training is performed by minimising the binary cross-entropy loss function, measuring the classification performance, with respect to the randomly initialised weights of the network. For the minimisation stochastic gradient descent (SGD) is used. The convergence of the optimisation is improved by the use of momentum and a stepwise reduction of the optimiser's learning rate when the loss on the monitoring sample stopped decreasing. The input variables described in Section 5.1 are transformed, e.g. by applying the logarithm to observables spanning multiple orders of magnitude, and normalised to make them suitable 

\begin{table}
\begin{tabular}{l l c c} \hline \hline  & Observable & 1-prong & 3-prong \\ \hline  & \(p_{\text{T}}^{\text{seed\,jet}}\) & \(\bullet\) & \(\bullet\) \\  & \(p_{\text{T}}^{\text{track}}\) & \(\bullet\) & \(\bullet\) \\  & \(\Delta\eta^{\text{track}}\) & \(\bullet\) & \(\bullet\) \\  & \(\Delta\phi^{\text{track}}\) & \(\bullet\) & \(\bullet\) \\  & \(|d_{0}^{\text{track}}|\) & \(\bullet\) & \(\bullet\) \\  & \(|z_{0}^{\text{track}}\sin\theta|\) & \(\bullet\) & \(\bullet\) \\  & \(N_{\text{IBL\,hits}}\) & \(\bullet\) & \(\bullet\) \\  & \(N_{\text{Pixel\,hits}}\) & \(\bullet\) & \(\bullet\) \\  & \(N_{\text{SCT\,hits}}\) & \(\bullet\) & \(\bullet\) \\ \hline  & \(p_{\text{T}}^{\text{jet\,seed}}\) & \(\bullet\) & \(\bullet\) \\  & \(E_{\text{T}}^{\text{cluster}}\) & \(\bullet\) & \(\bullet\) \\  & \(\Delta\eta^{\text{cluster}}\) & \(\bullet\) & \(\bullet\) \\  & \(\lambda_{\text{cluster}}\) & \(\bullet\) & \(\bullet\) \\  & \(\langle\lambda_{\text{cluster}}^{2}\rangle\) & \(\bullet\) & \(\bullet\) \\  & \(\langle r_{\text{cluster}}^{2}\rangle\) & \(\bullet\) & \(\bullet\) \\ \hline  & \(p_{\text{T}}^{\text{uncalibrated}}\) & \(\bullet\) & \(\bullet\) \\  & \(f_{\text{cent}}\) & \(\bullet\) & \(\bullet\) \\  & \(f_{\text{leadtrack}}^{-1}\) & \(\bullet\) & \(\bullet\) \\  & \(\Delta R_{\text{max}}\) & \(\bullet\) & \(\bullet\) \\  & \(|S_{\text{leadtrack}}|\) & \(\bullet\) & \\  & \(S_{\text{T}}^{\text{flight}}\) & & \(\bullet\) \\  & \(f_{\text{iso}}^{\text{track}}\) & \(\bullet\) & \(\bullet\) \\  & \(f_{\text{track}}^{\text{EM}}\) & \(\bullet\) & \(\bullet\) \\  & \(p_{\text{T}}^{\text{EM+track}}/p_{\text{T}}\) & \(\bullet\) & \(\bullet\) \\  & \(m^{\text{EM+track}}\) & \(\bullet\) & \(\bullet\) \\  & \(m^{\text{track}}\) & & \(\bullet\) \\ \hline \hline \end{tabular}
\end{table}
Table 1: List of observables used as inputs in the different parts of the RNN. The markers indicate which observables are used to identify 1-prong and 3-prong \(\tau_{\text{had-vis}}\). See Section 5.1 for the definitions of the observables.

for minimisation with SGD. The training process is stopped once the loss did not improve for ten successive epochs. The binary representation of the trained networks is converted and evaluated in the ATLAS reconstruction software using lwtnn[22].

The output score of the RNN-based tau identification for true \(\tau_{\text{had-vis}}\) in \(\gamma^{*}\to\tau\tau\) is transformed to be uniform in \([0,1]\) in bins of reconstructed \(\tau_{\text{had-vis}}\,p_{\text{T}}\) and average number of interactions per bunch-crossing \(\mu\). The working points of the tau identification are then defined by a requirement on the transformed score. This flattening procedure reduces the dependency of the true \(\tau_{\text{had-vis}}\) efficiency on the reconstructed \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\) and pile-up.

## 6 Tau identification performance

The performance of the RNN tau identification algorithm is evaluated on statistically independent test samples of \(\gamma^{*}\to\tau\tau\) (signal) and dijet (background) events as discussed in Section 5.3. The RNN performance is compared to that of the BDT-based tau identification algorithm previously used by the ATLAS experiment [10]. Figure 4 shows the rejection power, defined as the reciprocal value of the background selection efficiency, for misidentified \(\tau_{\text{had-vis}}\) depending on the true \(\tau_{\text{had-vis}}\) selection efficiency for both classifiers, independently for 1-prong and 3-prong \(\tau_{\text{had-vis}}\) candidates. The rejection power of the RNN-based classifier is about two times better than the BDT-based classifier in both cases for any given signal selection efficiency.

After the transformation described in Section 5.3 the RNN score corresponds to the fraction of rejected true \(\tau_{\text{had-vis}}\), essentially independent of \(p_{\text{T}}\) and \(\mu\). The distribution of RNN scores for signal and background are shown in Figure 5. Four working points with increasing background rejection (_Very loose_, _Loose_, _Medium_ and _Tight_) are defined to be used by physics analyses. The corresponding signal selection efficiencies and rejection powers are given in Table 2. In Figure 4(b), the 3 prong background sample statistics is insufficient

Figure 3: Distribution of the reconstructed transverse momentum \(p_{\text{T}}\) in simulated \(\gamma^{*}\to\tau\tau\) (a) and dijet (b) events for reconstructed 1-prong (red) and 3-prong (blue) \(\tau_{\text{had-vis}}\) candidates. The reconstruction efficiency for true 3-prong \(\tau_{\text{had-vis}}\) decreases with increasing \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\) and changes the fractional composition of 1- and 3-prong \(\tau_{\text{had-vis}}\) (a). In contrast, the charged track multiplicity in jets increases with jet \(p_{\text{T}}\) making 3-prong \(\tau_{\text{had-vis}}\) more abundant at high \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\) (b).

Figure 4: Rejection power for quark and gluon jets misidentified as \(\tau_{\text{had-vis}}\) (fake \(\tau_{\text{had-vis}}\)) depending on the true \(\tau_{\text{had-vis}}\) efficiency. Shown are the curves for 1-prong (red) and 3-prong (blue) \(\tau_{\text{had-vis}}\) candidates using the RNN-based (full line) and the BDT-based (dashed line) identification algorithms. The markers indicate the four defined working points _Tight_, _Medium_, _Loose_ and _Very loose_ with increasing signal selection efficiencies.

Figure 5: Distribution of the RNN score for true (red) and misidentified (blue) \(\tau_{\text{had-vis}}\) candidates for 1-prong (a) and 3-prong (b) cases. The RNN score has been flattened such that it corresponds to the fraction of rejected true \(\tau_{\text{had-vis}}\).

to populate the bins at high RNN scores. This has a negligible impact on the estimate for the background efficiency even for the _Tight_ working point which is defined as RNN score \(>0.55\).

The dependence of the true \(\tau_{\text{had-vis}}\) selection efficiency on the transverse momentum, the pseudorapidity and the number of pile-up interactions per bunch crossing is shown in Figure 6. The signal selection efficiency is independent of \(p_{\text{T}}\), except for a turn on effect for \(p_{\text{T}}<50\,\text{GeV}\). The reduction of the signal efficiency by 5-10% is a result of the flattening of the signal efficiency being performed using only calorimeter based information for the tau energy and not the full particle flow information as described in Section 4. A decrease of up to 10% in signal selection efficiencies for the _Tight_ working point can be observed towards high numbers of pile-up interactions per bunch crossing and around the transition region between calorimeter barrel and endcap sections. The dependence on \(p_{\text{T}}\), \(\eta\) and \(\mu\) is significantly reduced for looser working points.

It is important to point out that the actual rejection power depends strongly on \(p_{\text{T}}\), \(\eta\) and \(\mu\) distributions, as well as the quark-gluon composition of the background sample as quark-initiated jets tend to be narrower and have lower track multiplicities than gluon jets and are thus more difficult to differentiate from true \(\tau_{\text{had-vis}}\). Therefore, the numbers given in this note are only an indication of the expected performance. The background rejection in dijet events for the _Medium_ working point, depending on \(p_{\text{T}}\), \(\eta\) and \(\mu\) is shown in Figure 7. The rejection power increases towards high \(p_{\text{T}}\) and decreases toward high numbers of pile-up interactions, especially for 3-prong \(\tau_{\text{had-vis}}\) candidates.

\begin{table}
\begin{tabular}{l c c c c c c} \hline \hline  & \multicolumn{2}{c}{Signal efficiency} & \multicolumn{2}{c}{Background rejection BDT} & \multicolumn{2}{c}{Background rejection RNN} \\ Working point & 1-prong & 3-prong & 1-prong & 3-prong & 1-prong & 3-prong \\ \hline Tight & 60\% & 45\% & 40 & 400 & 70 & 700 \\ Medium & 75\% & 60\% & 20 & 150 & 35 & 240 \\ Loose & 85\% & 75\% & 12 & 61 & 21 & 90 \\ Very loose & 95\% & 95\% & 5.3 & 11.2 & 9.9 & 16 \\ \hline \hline \end{tabular}
\end{table}
Table 2: List of defined working points with fixed true \(\tau_{\text{had-vis}}\) selection efficiencies and the corresponding background rejection factors for misidentified \(\tau_{\text{had-vis}}\) in dijet events for the BDT and RNN classifiers.

Figure 6: Selection efficiency for true 1-prong (left) and 3-prong (right) \(\tau_{\text{had-vis}}\) candidates depending on the transverse momentum \(p_{\text{T}}\) (top), the absolute pseudorapidity \(|\eta|\) (middle) and the average number of interactions per bunch crossing \(\mu\) (bottom). The efficiencies are shown for the four defined working points of the RNN.

Figure 7: Rejection power for quark and gluon jets misidentified as \(\tau_{\text{had-vis}}\) for 1-prong (left) and 3-prong (right) \(\tau_{\text{had-vis}}\) candidates using the _Medium_ working point depending on the transverse momentum \(p_{\text{T}}\) (top), the absolute pseudorapidity \(|\eta|\) (middle) and the average number of interactions per bunch crossing \(\mu\) (bottom). The rejection power is shown for the RNN-based (red) and BDT-based (blue) classifiers.

## 7 Conclusion

The architecture, training and performance of a neural-network-based tau identification algorithm has been presented. Low-level information from reconstructed tracks and calorimeter clusters is used in conjunction with high-level observables to significantly improve the separation power with respect to the previous BDT-based approach. Four working points with constant true \(\tau_{\text{had-vis}}\) selection efficiencies as a function of \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\) and \(\mu\) are defined for the use by ATLAS physics analyses. The background rejection for quark and gluon jets misidentified as \(\tau_{\text{had-vis}}\) is improved by approximately 75% in a \(p_{\text{T}}\)-range of 30-50 GeV. At higher \(\tau_{\text{had-vis}}\)\(p_{\text{T}}\), the improvement in rejection of the RNN-based identification over the BDT-based method exceeds 100%.

## References

* [1] M. Tanabashi et al., _Review of Particle Physics_, Phys. Rev. **D98** (2018) 030001 (cit. on p. 2).
* [2] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003 (cit. on p. 2).
* [3] T. Sjostrand, S. Mrenna and P. Skands, _A brief introduction to PYTHIA 8.1_, Comput. Phys. Commun. **178** (2008) 852, arXiv: 0710.3820 [hep-ph] (cit. on p. 3).
* [4] ATLAS Collaboration, _ATLAS Pythia 8 tunes to 7 TeV data_, ATL-PHYS-PUB-2014-021, 2014, url: [https://cds.cern.ch/record/1966419](https://cds.cern.ch/record/1966419) (cit. on p. 3).
* [5] R. D. Ball et al., _Parton distributions with LHC data_, Nucl. Phys. B **867** (2013) 244, arXiv: 1207.1303 [hep-ph] (cit. on p. 3).
* [6] D. J. Lange, _The EvtGen particle decay simulation package_, Nucl. Instrum. Meth. A **462** (2001) 152 (cit. on p. 3).
* [7] ATLAS Collaboration, _The Pythia 8 A3 tune description of ATLAS minimum bias and inelastic measurements incorporating the Donnachie-Landshoff diffractive model_, ATL-PHYS-PUB-2016-017, 2016, url: [https://cds.cern.ch/record/2206965](https://cds.cern.ch/record/2206965) (cit. on p. 3).
* [8] ATLAS Collaboration, _The ATLAS Simulation Infrastructure_, Eur. Phys. J. C **70** (2010) 823, arXiv: 1005.4568 [physics.ins-det] (cit. on p. 3).
* [9] S. Agostinelli et al., _GEANT4: A Simulation toolkit_, Nucl. Instrum. Meth. A **506** (2003) 250 (cit. on p. 3).
* [10] ATLAS Collaboration, _Identification and energy calibration of hadronically decaying tau leptons with the ATLAS experiment in pp collisions at \(\sqrt{s}=8\) TeV_, Eur. Phys. J. C **75** (2015) 303, arXiv: 1412.7086 [hep-ex] (cit. on pp. 3, 9).
* [11] M. Cacciari, G. P. Salam and G. Soyez, _The anti-\(k_{t}\) jet clustering algorithm_, JHEP **04** (2008) 063, arXiv: 0802.1189 [hep-ph] (cit. on p. 3).
* [12] ATLAS Collaboration, _Topological cell clustering in the ATLAS calorimeters and its performance in LHC Run 1_, Eur. Phys. J. C **77** (2017) 490, arXiv: 1603.02934 [hep-ex] (cit. on p. 3).
* [13] T. Barillari et al., _Local hadronic calibration_, ATL-LARG-PUB-2009-001-2, 2009, url: [https://cds.cern.ch/record/1112035](https://cds.cern.ch/record/1112035) (cit. on p. 3).