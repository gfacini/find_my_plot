On the feasibility of predicting the ATLAS EM Calorimeter ionization signals using the Time Convolution Method at the LHC sampling rate

Daniel Goldin and Marco Delmastro

Department of Physics, Southern Methodist University, Dallas, TX 75275, USA.CERN (PH-ATA), CH-1211 Geneve 23, Switzerland.

of \(r\), \(L\) and \(C\): \(\tau_{0}=\sqrt{LC}\) and \(\tau_{\rm r}=rC\)), the drift time \(T_{\rm d}\) of the ionization electrons in the liquid argon gap, and taking advantage of the common readout path [2, 3, 4]:

\[g^{\rm phys}(t)=g^{\rm cali}(t) * {\cal L}^{-1}\left\{\frac{(1+s\tau_{\rm cali})(sT_{\rm d}-1+e^{-sT_ {\rm d}})}{sT_{\rm d}(f_{\rm step}+s\tau_{\rm cali})}\right\} \tag{1}\] \[* {\cal L}^{-1}\left\{\frac{1}{1+s\tau_{r}+s^{2}\tau_{0}^{2}}\right\} *\delta(t-\tau_{\rm diff}),\]

where the first inverse Laplace transform incorporates the difference in shapes between the ionization and calibration pulses, and the second transform the difference in the injection points for the two signals.

The Time Convolution Method (TCM) [2, 3] attempts to extract the parameters \(\tau_{0}\) and \(\tau_{\rm r}\) by minimizing the difference between the predicted pulse (1), as computed by means of numerical time-domain convolutions from the corresponding calibration pulse, and the _measured_ ionization signal, while fixing the other parameters (\(f_{\rm step}\), \(\tau_{\rm cali}\) and \(T_{\rm d}\)) to measured or inferred values. The \(\delta(t-\tau_{\rm diff})\) term in (1) accounts for the timing difference \(\tau_{\rm diff}\) introduced between the calibration and average ionization signals by the presence of the calibration cables, and by the different setting of the readout system in calibration and physics mode.

The TCM approach has been developed and successfully used for the EMC calibration of the 2001 and 2002 EMC H8 beam tests [5, 6, 7], where the particles were asynchronous with respect to the EMC DAQ. In that case it was possible to reconstruct the average ionization pulses with a 1 ns granularity that matched that of the calibration pulses.

Since at LHC the particle reaching the EMC after a collision will be synchronous with respect to the DAQ clock, the measured ionization pulses will be sampled at a lower rate, namely at the LHC sampling period of 25 ns, thus carrying less information about the cell response.

In this note we investigate the feasibility of the TCM method at lower sampling rates, down to and including the LHC run-time rate of 25 ns. We present results obtained from

Figure 1: Basic equivalent circuit of the EMC detector readout cell.

a typical signal recorded at the 2002 EMC beam test, which yields a good quality TCM fit for 1 ns sampling.

## 2 TCM parameters at various sampling rates

Since the aim of this work is to study the performance of the TCM parameter extraction method at (virtual) sampling rates lower than the one available at the beam tests (1GHz, corresponding to a 1 ns pulse precision), we start from a converging TCM fit obtained on 2002 EMC Barrel beam test data, and we emulate the lower sampling frequencies by removing from the measured ionization pulse a certain number of points before reapplying the TCM fitting procedure.

The results presented here are obtained from channel 0x390D0600, located in the second layer (Middle) at \(\eta_{\rm cell}=1\), \(\phi_{\rm cell}=10\)1. Results similar to the ones shown below may also be obtained for other EMC channels. In our test case the value of the fixed parameters in 1 are [3]:

Footnote 1: These pseudorapidity and azimuthal positions are referred to the Middle compartment granularity in the EMC Barrel being \(\Delta\eta\times\Delta\phi=0.025\times 0.025\). For a cell with indexes \(\eta_{\rm cell}\) and \(\phi_{\rm cell}\) the value of \(\eta\) is given by \(0.025\cdot(\eta_{\rm cell}+0.5)\) and \(\phi\) is \(0.025\cdot(\phi_{\rm cell}+0.5)\).

\[\begin{array}{rcl}T_{\rm d}&=&450\,{\rm ns}\\ \tau_{\rm cali}&=&340\,{\rm ns}\\ f_{\rm step}&=&0.065.\end{array} \tag{2}\]

As we have already mentioned, the calibration and average ionization signals are found

Figure 2: Left: measured average ionization and calibration pulses for the test channel. Right: the calibration pulse is translated, so that the maxima of the ionization and calibration signals are aligned. Note that the normalization of the calibration pulse is such that is at unity (hence the use of the arbitrary units); the ionization pulse has the correct normalization, relative to the calibration pulse at the readout level.

to be shifted in time relative to each other (Fig. 2, left). In what would be an idealization of ATLAS run-time conditions, when the decrease in sampling frequency by removal of sampling points was simulated, we additionally required the ionization and calibration pulse peaks to be perfectly aligned, so that the ionization pulse is always sampled at the peak, independent of the sampling rate. To this end, the calibration signal was translated2 until the maxima of the two pulses coincided (Fig. 2, right). Note that this is a rather optimistic assumption, since the timing alignment precision of the EMC Front End Board (FEB) with respect to ionisation signal peak is expected to be of the order of 3 ns [8]; in Section 3 we discuss the impact of a more realistic sampling (e.g. the highest sample not being perfectly aligned with the signal peak) on the TCM fit results.

Footnote 2: Prior to this work \(\tau_{\rm diff}\) was used as a third free TCM fit parameter, but this approach led to non-converging fits when decreasing the signal sampling rate.

In Fig. 3 (top) the best TCM predicted pulse is shown alongside the measured ion

Figure 3: Results of the TCM fit of the predicted pulse to the measured ionization pulse with 1 ns sampling. Bottom plot shows the residuals, defined as the difference between the predicted and measured ionization pulses, divided by the maximum amplitude of the measured pulse, and the straight line fit to those points.

ization pulse. The bottom plot shows the residuals, defined as the difference between the predicted and measured ionization pulses, divided by the maximum amplitude of the measured pulse. As can be seen in the figure, the fit is unbiased, as evidenced by the small value of the fit to the residuals, and the residuals are contained within a \(\pm 2\%\) envelope, which is claimed to represent average precision of the TCM fit [3].

The optimal TCM parameter values are:

\[\left\{\begin{array}{rcl}\omega_{0}&=&0.148\,\mathrm{ns}^{-1}\\ \tau_{\mathrm{r}}&=&1.85\,\mathrm{ns}\end{array}\right. \tag{3}\]

The calibration and ionization pulses examined up to this point have been obtained with the 1 ns sampling rate. We want to investigate how the values of \(\omega_{0}\) and \(\tau_{r}\), as well as the size of the residuals, are affected by lower sampling rates. Sampling steps of 5, 10, 15, 19, 22 and 25 ns were applied to the measured ionization pulse. These sampling rates have been simulated by removing the required number of samples from the original 1 ns ionization signal. Note that a sampling rate higher than 25 ns _could_ in principle be obtained at LHC following an approach similar to the beam test. For instance, a \(\sim\)12.5 ns sampling rate be obtained at LHC by globally displacing the EMC readout by a \(\sim\)12.5 ns with respect to the LHC clock for a finite period of time, and then restoring the original DAQ LHC-aligned timing. Of course, such an operation should be proved to be useful to obtain sensible and accurate results.

In order to ensure the convergence of the fits, the lower rate ionization pulses were interpolated with the cubic spline fit. Analogously to 1 ns pulses, the peak of the interpolated pulse were then aligned with the corresponding 1 ns calibration pulse before proceeding with the TCM fit. In Fig. 4 we show the fits with 15 and 25 ns sampling steps.

The beam test average ionization pulses are known with a certain error, related to the size of the event sample used to cumulate the digits, and to the fluctuation of the shower

Figure 4: TCM fit results with 15 ns (left) and 25 ns (right) sampling rate. Residuals (the ones associated only with the remaining sampling points after stripping) are contained within 2% envelope.

energy deposits in each EMC samplings for the given electron energy. Typical size of the run used to compute these pulses was \(\sim\)10000 events, to be divided in 25 time bins \(\sim\)400 events; the typical electron beam used was the H8 primary at 245 GeV. Since at LHC the number of high energy electrons collected in each EMC cells will be smaller, and their energy distribution wider and generally lower, it reasonable to assume that the average ionization pulses will be known with a greater uncertainty with respect to the beam test ones, whatever their sampling rate.

It is beyond the scope of this work to estimate such an uncertainty, nevertheless we decided to perform a separate study, wherein bin-wise errors were set to two different fixed values: the original beam test one; 0.01 in normalized units of the sample height, representing fluctuations of \(\sim\)1% and reflecting to one order of magnitude a realistic physical bin-wise uncertainty; and 0.1, representing fluctuations of \(\sim\)10% and reflecting a larger uncertainty mimicking the quality of the average ionization pulses in early days of LHC data taking.

In Tables 1 and 2 we quote the dependence of the TCM-fit \(\omega_{0}\) and \(\tau_{r}\) on the sampling rate for the original ionization pulse uncertainty \(\sigma_{i}^{ion}\) and the two fixed errors. The same results are also shown graphically in Fig. 5 and 6.

\begin{table}
\begin{tabular}{c|c c c} \hline \hline Sampling & \multicolumn{3}{c}{TCM-fit \(\omega_{0}\) (ns\({}^{-1}\))} \\ step (ns) & Beam test \(\sigma_{i}^{ion}\) & \(\sigma_{i}^{ion}=0.01\) & \(\sigma_{i}^{ion}=0.1\) \\ \hline
1 & 0.14792 \(\pm\) 0.00005 & 0.14731 \(\pm\) 0.00113 & 0.14731 \(\pm\) 0.01127 \\
5 & 0.15047 \(\pm\) 0.00007 & 0.14745 \(\pm\) 0.00114 & 0.14744 \(\pm\) 0.01132 \\
10 & 0.14658 \(\pm\) 0.00007 & 0.14727 \(\pm\) 0.00117 & 0.14725 \(\pm\) 0.01154 \\
15 & 0.14004 \(\pm\) 0.00007 & 0.14774 \(\pm\) 0.00136 & 0.14768 \(\pm\) 0.01231 \\
19 & 0.14972 \(\pm\) 0.00012 & 0.15600 \(\pm\) 0.00207 & 0.15776 \(\pm\) 0.01532 \\
22 & 0.14777 \(\pm\) 0.00013 & 0.15723 \(\pm\) 0.00266 & 0.16484 \(\pm\) 0.01778 \\
25 & 0.15191 \(\pm\) 0.00029 & 0.15990 \(\pm\) 0.00305 & 0.17865 \(\pm\) 0.02925 \\ \hline \hline \end{tabular}
\end{table}
Table 1: Dependence of parameter TCM-fit \(\omega_{0}\) on the sampling rate and the ionization pulse uncertainty.

\begin{table}
\begin{tabular}{c|c c c} \hline \hline Sampling & \multicolumn{3}{c}{TCM-fit \(\tau_{\rm r}\) (ns)} \\ step (ns) & Beam test \(\sigma_{i}^{ion}\) & \(\sigma_{i}^{ion}=0.01\) & \(\sigma_{i}^{ion}=0.1\) \\ \hline
1 & 1.846 \(\pm\) 0.002 & 1.69659 \(\pm\) 0.047 & 1.697 \(\pm\) 0.475 \\
5 & 1.635 \(\pm\) 0.004 & 1.67683 \(\pm\) 0.048 & 1.678 \(\pm\) 0.476 \\
10 & 1.803 \(\pm\) 0.004 & 1.68256 \(\pm\) 0.048 & 1.684 \(\pm\) 0.476 \\
15 & 1.986 \(\pm\) 0.005 & 1.71006 \(\pm\) 0.052 & 1.708 \(\pm\) 0.476 \\
19 & 1.606 \(\pm\) 0.010 & 1.47781 \(\pm\) 0.078 & 1.360 \(\pm\) 0.521 \\
22 & 1.567 \(\pm\) 0.008 & 1.56864 \(\pm\) 0.086 & 1.368 \(\pm\) 0.530 \\
25 & 1.549 \(\pm\) 0.012 & 1.5Figure 5: Dependence of parameter \(\omega_{0}\) on the sampling rate. In the top figure we show the results with the original ionization pulse errors (\(\mathcal{O}(10^{-4})\)). In the middle and bottom figure the values of \(\omega_{0}\) with bin-wise errors fixed at 0.01 and 0.1 (a.u.), respectively, are plotted.

Figure 6: Dependence of parameter \(\tau_{\rm r}\) on the sampling rate. In the top figure we show the results with the original ionization pulse errors (\({\cal O}(10^{-4})\)). In the middle and bottom figure the values of \(\omega_{0}\) with bin-wise errors fixed at 0.01 and 0.1 (a.u.), respectively, are plotted.

We observe that both TCM-fit parameters \(\omega_{0}\) and \(\tau_{r}\) are reasonably stable up to, and including, 15 ns sampling rate. At greater sampling steps both deviate from the original values: \(\omega_{0}\) increases while \(\tau_{r}\) decreases, the two parameters being anti-correlated. With bin-wise errors fixed at 0.01, representing a realistic approximation to the physical fluctuation-induced errors, the difference in values of both parameters for 1 and 25 ns sampling is of the order of 10%. For overestimated errors fixed at 0.1 this difference can scale up to about 20%.

It is interesting to note that for sampling steps greater than 10 ns the mean value of the TCM parameters strongly depends on the uncertainty affecting the ionization pulse, thus hinting that the quality of the average signals should be further studied with respect to the size and energies of the available calibration stream samples at LHC.

## 3 Effect of sampling time misalignment

In the previous study we assumed that the FEB sampling timing is perfect, i.e. that the ionization pulse is always sampled at its maximum, regardless of the sampling rate. As mentioned before, this is a rather optimistic assumption, since the precision of the timing alignment of the FEB with respect to signal peaks is expected to vary by as much as \(\pm\)3 ns. With this in mind, we take the previously considered pulse sampled at 15 ns rate3 and with bin-wise errors set to 0.01, and shift the location of the sampling points, keeping the sampling rate constant. The exact maximum of the pulse is thus not sampled, mimicking more realistic data-taking conditions.

Footnote 3: The 15 ns sampling rate was chosen as the lowest rate yielding stable calibration constants.

Six sampling shifts in the range from -3 to +3 ns with a 1 ns step are applied; for every sampling configuration we repeat the ionization pulse sample interpolation (Fig. 7), then the calibration and the ionization pulses alignment, and, finally, the TCM fit.

As seen in Table 3, the resulting values of both parameters, and in particular \(\tau_{r}\), vary significantly. For the negative shift of the calibration pulse by -3 ns the values of \(\omega_{0}\) and \(\tau_{r}\) are 0.069 \(\pm\) 0.001 ns\({}^{-1}\) and 39.7 \(\pm\) 1.0 ns, respectively. For the positive shift of +3 ns

\begin{table}
\begin{tabular}{c c c} \hline \hline Relative shift (bins) & \(\omega_{0}\) (ns\({}^{-1}\)) & \(\tau_{r}\) (ns) \\ \hline -3 & 0.069 \(\pm\) 0.001 & 39.7 \(\pm\) 1.0 \\ -2 & 0.137 \(\pm\) 0.001 & 3.49 \(\pm\) 0.05 \\ -1 & 0.143 \(\pm\) 0.001 & 2.56 \(\pm\) 0.05 \\ **0** & \(\mathbf{0.148\pm 0.001}\) & \(\mathbf{1.71\pm 0.05}\) \\ +1 & 0.154 \(\pm\) 0.001 & 0.849 \(\pm\) 0.05 \\ +2 & 0.159 \(\pm\) 0.001 & 0.106 \(\pm\) 0.04 \\ +3 & n/a & n/a \\ \hline \hline \end{tabular}
\end{table}
Table 3: Dependence of parameters \(\omega_{0}\) and \(\tau_{r}\) on the sampling rate delays. The fit did not converge for +3 ns shift.

Figure 7: Top: Ionization pulse with the maximum accurately sampled. Bottom: same pulse with the sampling points shifted by -3 ns (thus, the maximum is not sampled). Cubic spline interpolation is shown for both cases.

\(\tau_{r}\) reaches the lower preset bound resulting in a non-convergent fit. Even for the smallest delay of \(\pm 1\) ns, \(\tau_{r}\) varies by as much as a factor of 2.

These significant fluctuations in the TCM-fit parameters are explained by the fact that the interpolating curve describes the original ionization pulse very poorly when the maximum samples is not exactly located on the signal peak. Since this condition is not guaranteed by the the normal EMC data acquisition settings, the wide spread of values of \(\omega_{0}\) (and even more critically of \(\tau_{r}\)) within the bounds of sampling fluctuations represents a significant limitation for the use of the the TCM parameter extraction approach at LHC, even at the relatively high 15 ns sampling rate.

## 4 Conclusions

The Time Convolution Method yields two stable electronic calibration parameters with sampling steps up to 15 ns, provided that the ionization pulses are _exactly_ sampled at their maximum. Larger sampling steps, including the LHC run-time rate of 25 ns, however, yield values of \(\omega_{0}\) and \(\tau_{r}\) which differ from the stable values by as much as 10%. While considering a more realistic sampling condition, in which the time position of the maximum is sampled with a 3 ns uncertainty, the TCM fitting methods fails in extracting the proper parameter values even at the favorable sampling rate of 15 ns.

The results seem to discourage any possible use of the TCM fitting procedure to evaluate the \(\omega_{0}\) and \(\tau_{r}\) EMC electrical parameters in the LHC data taking conditions, even with a possibly increased sampling rate to be obtained by displacing the FEB timing with respect to the LHC bunch crossing frequency.

## Acknowledgments

One of the authors (D.G.) would like to thank Jingbo Ye and Ryszard Stroynowski for many helpful discussions on the subject of calorimetry.

## References

* [1] The ATLAS collaboration. Liquid Argon Calorimeter Technical Design Report. Technical Report CERN/LHCC/96-41, CERN, 1996.
* [2] L. Neukermans, P.Perrodo and R. Zitoun. Understanding the electromagnetic barrel pulse shapes and the absolute electronic calibration. _ATLAS Internal Note_, ATL-LARG-2001-008, 2001.
* [3] D. Prieur. Using Time Convolution Method to compute Optimal Filtering Coefficients for LARG electromagnetic calorimeter. _ATLAS Internal Note_, ATL-LARG-2005-001, 2005.