###### Abstract

In this note we present a calculation of the expected pileup and electronic noise in the liquid argon presampler detector in ATLAS at full LHC luminosity (\(10^{34}\)\(cm^{-2}s^{-1}\)). A sample of 1800 minimum bias events, generated with PYTHIA5.7 and a full simulation of ATLAS with the 'hybrid model' of the electromagnetic calorimeter, has been analyzed to estimate the pileup noise. Readout with both GaAs and \(\emptyset\)T preamplifiers followed by bipolar shapers has been considered for eight strips per readout channel, _i.e._ a coarse presampler. The electronic noise has been calculated using the full signal waveform. The total noise in 1\(\times\)8 cells (\(\phi\times\eta\)) has been minimized by optimizing the peaking time of the preamplifiers. A total noise level, which increases with \(\eta\), of 2.5-5.2 MeV (no calibration applied) can be expected for GaAs preamplifiers, while the noise from \(\emptyset\)T preamplifiers will be \(\approx\)0.8 MeV higher. In addition, the pileup noise dependence on \(\eta\) and on the cluster size will be presented.

ATLAS Internal Note

LARG-NO-23

July 28, 1995

**A Study of Pileup and Electronic Noise**

**in the ATLAS Liquid Argon Presampler Detector**

E. Albertson, J. Collot

_ISN, Grenoble, France_Introduction

At full LHC luminosity (\(10^{34}\)\(cm^{-2}s^{-1}\)), noise arising from overlapping background events must, in addition to the familiar electronic noise, be taken into account when studying the performance of a future detector. The aim of this note is to present the calculation of electronic and pileup noise in the ATLAS presampler, which precedes the liquid argon electromagnetic calorimeter.

The presampler consists of 32 modules in \(\phi\) and each half barrel is made of 7 modules in \(\eta\) (\(\eta=-ln(\tan(\Theta/2))\)), each with a length of \(\Delta\eta\)=0.2. There might be an eighth module covering \(\eta\) 1.4-1.47. A module has 2\(\times\)64 strips, each with a size of \(0.1\times 0.0031\,2\) (\(\Delta\phi\times\Delta\eta\)). For the coarse presampler, the strips are ganged 8 by 8 in \(\eta\) before being read out by a preamplifier followed by a bipolar (CR-RC\({}^{2}\)) shaper. Presently, there are two preamplifier options: GaAs directly on the detector in the cold or cable coupled (\(\emptyset\)T) located outside the cryostat and calculations for both options will be presented. For the estimate of the pileup noise, we have analyzed minimum bias events, which have been simulated with a full simulation of the ATLAS detector, where the presampler was defined up to \(\eta\)=1.4 (7 modules).

All numbers in this note are presented _without calibration_ factors. Those who wish to include the presampler noise in their simulations, can find all revelant numbers on the www: [http://isnwww.in2p3.fr/atlas/Noise.html](http://isnwww.in2p3.fr/atlas/Noise.html).

## 2 Electronic Noise

In order to compare the noise signal with physical signals, the noise current is frequently expressed as equivalent noise current (ENI), which is the initial current of a triangular pulse at the input, whose maximal voltage amplitude at the output is equal to the rms of the noise. The equivalent noise energy (ENE), which is the noise expressed in units of energy is related to ENI through conversion factors, which can be found in the last column of table 1. In the same table, we have also listed the module dependent input parameters for the noise calculations, such as high voltage, drift time and detector capacitance.

### GaAs Preamplifiers

The GaAs preamplifiers considered for reading out the presampler pads are of the same type as those mounted on the calorimeter [1]. They are used in a current sensitive mode

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c||} \hline \hline Module & \(\eta\) & HV (V) & \(T_{\mathit{drift}}\) (ns) & \(C_{\mathit{det}}\) (nF) & \(A\) (for \(\emptyset\)T) & keV / nA \\ \hline
1 & 0.1 & 1760 & 350 & 248 & 11.3 & 53.4 \\
2 & 0.3 & 1980 & 400 & 236 & 10.3 & 58.5 \\
3 & 0.5 & 2180 & 430 & 234 & 10.1 & 58.4 \\
4 & 0.7 & 2390 & 480 & 236 & 10.3 & 58.5 \\
5 & 0.9 & 2500 & 540 & 242 & 10.8 & 57.6 \\
6 & 1.1 & 2500 & 590 & 256 & 12.1 & 54.1 \\
7 & 1.3 & 2500 & 650 & 275 & 13.9 & 50.4 \\
8 & 1.4 & 2500 & 700 & 302 & 16.8 & 45.5 \\ \hline \hline \end{tabular}
\end{table}
Table 1: Module dependent electronic parameters.

with 10 k\(\Omega\) and 3.3 pF in their feedback network. The preamplifier outputs are filtered by CR-RC\({}^{2}\) shapers described in [2]. The electronic noise was computed as referred to the input in terms of the equivalent noise triangular current with the proper drift time. The details of our calculation follow the procedure presented in [2], except that we use the triangular response instead of the step response to express the input current noise. The parameters that we used as input for these calculations are:

* series white noise (en): 0.25nV/\(\sqrt{Hz}\)
* corner frequency of 1/F series noise: 1 MHz
* shaper noise at the shaper input: 2 nV/\(\sqrt{Hz}\)
* backmatching resistors at the output of the preamplifiers: 6db
* input FET capacitance: 130 pF

The proper drift time and detector capacitance for the different modules are listed in table 1. The calculations were carried out using Mathematica. The result for module 1 (\(\eta\)=0.1) and 7 (\(\eta\)=1.3) are listed in tables 6 and 7 respectively.

### \(\emptyset\)T Preamplifiers

In the case of \(\emptyset\)T preamplifiers, the electronic noise has been extracted from measurements [3], which were fitted with

\[ENI^{2}=\frac{A\cdot 10^{-11}}{t_{p}^{3}(\Delta)}+\frac{6\cdot 10^{-14}}{t_{p}( \Delta)} \tag{1}\]

where the two terms represent series and parallel noise respectively, \(t_{p}\) is the peaking time (5-100 %) and \(A\) depends on the detector capacitance, \(C_{\mathit{det}}\). The measurements were performed for \(C_{\mathit{det}}\)=150 pF (\(A\)=4.6) and \(C_{\mathit{det}}\)=390 pF (\(A\)=25.) and, for the 8 presampler modules, the values of A, which are listed in table 1, were extrapolated from these two measurements.

## 3 Sample of Minimum Bias Events

Single minimum bias events from pp interactions at \(\sqrt{s}\)=14 TeV were generated using the PYTHIA generator version 5.7 and subsequently fed into the DICE program, which contains a full simulation of the ATLAS detector that is based on GEANT 3.21. These events were also used to study pileup in the ATLAS electromagnetic calorimeter [4]. The detector geometry is the one described in the technical proposal [5] and in [6], _i.e._ a liquid argon calorimeter with fine granularity readout of its first sampling and the presampler (the hybrid model). A total of 1792 events from tapes WBNH85-89 at ccahp in Lyon were analyzed.

## 4 Pileup Noise

For systems with bipolar shaping, the rms of the pileup noise can be separated into one physics dependent and one hardware dependent factor [7]\[\sigma^{2}_{pi_{leup}}=\rho^{2}_{pi_{leup}}\times T_{c}\sum_{i=-\infty}^{\infty}g ^{2}(t_{i}) \tag{2}\]

where \(\rho^{2}_{pi_{leup}}\) is the pileup noise density, _i.e._ the variance of the energy deposited in a cluster per bunch crossing and the second part is the pileup sum, which depends on the normalized signal waveform, \(g(t)\), and, therefore, on the CR-RC\({}^{2}\) shaping time and on \(T_{c}\), the time between consecutive bunch crossings. The signal waveform, \(g(t)\), at the output of the current amplifier and CR-RC\({}^{2}\) filter was calculated with a triangular input signal. As for the electronic noise, we used Mathematica for these calculations and the result can be found in tables 6(module 1) and 7(module 7).

### Pileup Noise Density

The pileup noise density was obtained by first determining the energy deposition in single minimum bias events and thereafter using these distributions to calculate the energy spectrum for entire bunch crossings. This procedure, which will be described in detail below, was followed for clusters with 1 and 2 cells in \(\phi\) and with 2, 8, 12, 16, 24 and 32 cells in \(\eta\).

Minimum bias events were analyzed to obtain the energy deposition in single events in clusters at fixed \(\eta\) and \(\phi\). Normally, we positioned the clusters symmetrically around the central strips (32-33) of a module. However, for small clusters (less than 10 strips in \(\eta\)), we positioned two clusters in \(\eta\), which were centered around strips 16-17 and 48-49 respectively. In order to increase statistics, especially to decrease the fluctuations in the long tails, distributions from different, but equivalent areas were superimposed. As equivalent, we considered:

* clusters with the same \(\eta\) but different \(\phi\)
* clusters with the same \(|\eta|\)
* for small clusters: different \(\eta\) if the clusters were in the same module.

In this way, the statistics were multiplied by 128 (64) for big clusters and by 256 (128) for the small ones, for one (two) cells per cluster in \(\phi\).

The occupancy, which we have defined as the fraction of events which deposit any energy (E\(>\)0) in the cluster, varies from a few up to about 5 % for 1\(\times\)8 and 2\(\times\)8. The complete statistics are shown in table 2.

In a second step, the distribution of energy deposition per bunch crossing was simulated. At LHC, where the luminosity will be 10\({}^{34}\)\(cm^{-2}s^{-1}\) and the mean inelastic cross section is estimated to be 70 mb, an average of 18 pp collisions per bunch crossing are to be expected. Hence, the number of events in each crossing was chosen according to Poisson distribution with a mean of 18. Each event was given energy randomly according to the distribution for single events and the energy from each event in one bunch crossing was summed. After having generated sufficiently many bunch crossings, the variance of the energy deposition per bunch crossing was calculated.

For clusters with 1\(\times\)8 cells, the mean and width of the distributions vary with \(\eta\) from 0.32 to 1.01 MeV and from 1.30 to 3.19 MeV respectively. These values are below the energy released by a minimum ionizing particle (MIP). The complete result is given in table 3.

## 5 Total Noise Versus Peaking Time

At very short time constants, the electronic noise is dominating, while, at long ones, a large pileup signal is collected during integration. Hence, one has to choose a time constant, where the total noise is minimized. For \(\emptyset\)T (GaAs) preamplifiers, the optimum peaking time lies between 38(34) ns (\(\eta\)=1.3) and 58(46) ns (\(\eta\)=0.1). The plots in figure 2 and 3 shows the electronic, pileup and total noise for \(\emptyset\)T and GaAs preamplifiers respectively and the optimum values are summarized in table 4. The cluster size in these figures are 1\(\times\)8 cells, but the optimum peaking time is not significantly sensitive to the choice of cluster size.

If one, for simplicity, desires preamplifiers with the same \(\tau\) for all modules in \(\eta\), the noise level will increase by about 2-6 % for high and low \(\eta\), depending on the preamplifier and the choise of common parameters. In table 5 we have choosen a peaking time of about 43 ns for \(\emptyset\)T and 38 ns for GaAs and the increase, compared to one \(\tau\) value per module, is listed in the last column.

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c||} \hline \hline cluster size & \multicolumn{6}{c||}{\(\eta\)} \\ \cline{2-7} \((\phi\times\eta)\) & 0.1 & 0.3 & 0.5 & 0.7 & 0.9 & 1.1 & 1.3 \\ \hline \(1\times 2\) & 0.38 \% & 0.39 \% & 0.40 \% & 0.48 \% & 0.60 \% & 0.72 \% & 1.04 \% \\ \(1\times 8\) & 1.19 \% & 1.24 \% & 1.35 \% & 1.52 \% & 1.85 \% & 2.28 \% & 3.10 \% \\ \(1\times 12\) & 1.66 \% & 1.79 \% & 1.93 \% & 2.16 \% & 2.58 \% & 3.25 \% & 4.17 \% \\ \(1\times 16\) & 2.14 \% & 2.29 \% & 2.48 \% & 2.77 \% & 3.31 \% & 4.11 \% & 5.30 \% \\ \(1\times 24\) & 3.05 \% & 3.24 \% & 3.50 \% & 3.92 \% & 4.59 \% & 5.70 \% & 7.33 \% \\ \(1\times 32\) & 3.93 \% & 4.11 \% & 4.45 \% & 4.97 \% & 5.83 \% & 7.18 \% & 9.21 \% \\ \(2\times 2\) & 0.71 \% & 0.74 \% & 0.77 \% & 0.92 \% & 1.14 \% & 1.38 \% & 1.96 \% \\ \(2\times 8\) & 2.20 \% & 2.30 \% & 2.50 \% & 2.82 \% & 3.40 \% & 4.16 \% & 5.55 \% \\ \(2\times 12\) & 3.05 \% & 3.26 \% & 3.52 \% & 3.95 \% & 4.65 \% & 5.83 \% & 7.37 \% \\ \(2\times 16\) & 3.88 \% & 4.12 \% & 4.45 \% & 4.97 \% & 5.87 \% & 7.24 \% & 9.15 \% \\ \(2\times 24\) & 5.49 \% & 5.68 \% & 6.20 \% & 6.88 \% & 7.93 \% & 9.77 \% & 12.3 \% \\ \(2\times 32\) & 6.88 \% & 7.13 \% & 7.73 \% & 8.61 \% & 9.93 \% & 12.1 \% & 15.1 \% \\ \hline \hline \end{tabular}
\end{table}
Table 2: Occupancy (energy deposition \(>\) 0) in single events.

\begin{table}
\begin{tabular}{||c|c|c|c||} \hline \hline \(\eta\) & mean (MeV) & \(\sigma\) (MeV) & MIP (MeV) \\ \hline
0.1 & 0.32 & 1.30 & 2.23 \\
0.3 & 0.34 & 1.46 & 2.32 \\
0.5 & 0.36 & 1.48 & 2.50 \\
0.7 & 0.45 & 1.68 & 2.79 \\
0.9 & 0.53 & 1.93 & 3.18 \\
1.1 & 0.66 & 2.18 & 3.70 \\
1.3 & 1.01 & 3.19 & 4.38 \\ \hline \hline \end{tabular}
\end{table}
Table 3: Mean and sigma of the energy deposition in one bunch crossing in 1\(\times\)8 clusters and, for comparison, the energy released by a MIP (no calibration applied).

Figure 1: Energy deposition in 1\(\times\)8 (solid line) and 2\(\times\)8 cells (dashed line) for single events (top) and for bunch crossings (bottom) for \(\eta\) =0.1 (left) and 1.3 (right).

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c||} \hline \hline  & & Tot al & Electr. & Pileup & & & In crease \\  & \(\eta\) & Noise & Noise & Noise & \(t_{p,5-100\%}\) & \(\tau=RC\) & of Total \\  & & ( MeV) & ( MeV) & ( MeV) & (ns) & (ns) & Noise \\ \hline  & 0.1 & 3.36 & 2.15 & 2.58 & 57.9 & 30 \\  & 0.3 & 3.69 & 2.31 & 2.87 & 58.0 & 30 \\  & 0.5 & 3.71 & 2.30 & 2.9l & 58.1 & 30 \\ \(\emptyset\)T & 0.7 & 3.99 & 2.59 & 3.04 & 50.9 & 25 \\  & 0.9 & 4.34 & 2.55 & 3.48 & 51.4 & 25 \\  & 1.1 & 4.57 & 2.86 & 3.57 & 44.0 & 20 \\  & 1.3 & 5.81 & 3.24 & 4.8l & 37.9 & 16 \\ \hline  & 0.1 & 2.57 & 1.22 & 2.26 & 46.0 & 16 \\  & 0.3 & 2.82 & 1.48 & 2.40 & 42.2 & 14 \\  & 0.5 & 2.84 & 1.45 & 2.44 & 42.3 & 14 \\ GaAs & 0.7 & 3.14 & 1.46 & 2.78 & 42.5 & 14 \\  & 0.9 & 3.47 & 1.71 & 3.02 & 38.3 & 12 \\  & 1.1 & 3.81 & 1.65 & 3.43 & 38.4 & 12 \\  & 1.3 & 5.18 & 1.96 & 4.79 & 33.8 & 10 \\ \hline \hline \end{tabular}
\end{table}
Table 4: Noise at optimum peaking time for \(\emptyset\)T and GaAs preamplifiers.

\begin{table}
\begin{tabular}{||c|c|c|c|c|c|c|c||} \hline \hline  & & Total & Electr. & Pileup & & & In crease \\  & \(\eta\) & Noise & Noise & Noise & \(t_{p,5-100\%}\) & \(\tau=RC\) & of Total \\  & & ( MeV) & ( MeV) & ( MeV) & ( ns) & ( ns) & Noise \\ \hline  & 0.1 & 3.57 & 2.85 & 2.14 & 42.7 & 20 & 6.2 \% \\  & 0.3 & 3.88 & 3.07 & 2.38 & 42.6 & 20 & 5.1 \% \\  & 0.5 & 3.88 & 3.04 & 2.41 & 42.6 & 20 & 4.6 \% \\ \(\emptyset\)T & 0.7 & 4.09 & 3.04 & 2.74 & 42.9 & 20 & 2.5 \% \\  & 0.9 & 4.34 & 3.00 & 3.17 & 43.4 & 20 & 0.7 \% \\  & 1.1 & 4.57 & 2.86 & 3.57 & 44.0 & 20 & 0.0 \% \\  & 1.3 & 5.94 & 2.71 & 5.28 & 44.8 & 20 & 2.2 \% \\ \hline  & 0.1 & 2.63 & 1.64 & 2.05 & 37.6 & 12 & 2.3 \% \\  & 0.3 & 2.87 & 1.73 & 2.29 & 37.8 & 12 & 1.7 \% \\  & 0.5 & 2.88 & 1.71 & 2.32 & 38.0 & 12 & 1.7 \% \\ GaAs & 0.7 & 3.15 & 1.72 & 2.65 & 38.1 & 12 & 0.6 \% \\  & 0.9 & 3.47 & 1.71 & 3.02 & 38.3 & 12 & 0.0 \% \\  & 1.1 & 3.81 & 1.65 & 3.43 & 38.4 & 12 & 0.0 \% \\  & 1.3 & 5.29 & 1.61 & 5.04 & 38.5 & 12 & 2.1 \% \\ \hline \hline \end{tabular}
\end{table}
Table 5: Noise at optimum peaking time for \(\emptyset\)T and GaAs preamplifiers, in the case of one time constant for the entire detector.

Figure 2: Noise versus peaking time with \(\emptyset\)T preamps for \(\eta\)=0.1, 0.5, 0.9 and 1.3.

Figure 3: Noise versus peaking time with GaAs preamplifiers for \(\eta\)=0.1, 0.5, 0.9 and 1.3.

Pileup Noise Versus \(\eta\) and Cluster Size

The pileup noise increases with eta, but in units of transverse energy, it is constant in \(\eta\) up to \(\eta\)=1.2 (Figure 4). With \(\emptyset\)T preamplifiers, the pileup noise at optimum peaking time is 2.16 MeV / \(\sin\Theta\) and with GaAs 2.08 MeV / \(\sin\Theta\). The different values are due to the electronic dependent pileup sums. In the last \(\eta\) module, the electronic noise is higher: 2.68 and 2.56 MeV/ \(\sin\Theta\) respectively.

_Figure 4: Pileup noise (\(\sigma(E)\) and \(\sigma(E_{t})\)) versus \(\eta\) with \(\emptyset\)T and GaAs preamplifiers._

In liquid ionization calorimeters, pileup noise has been found to scale as \((\Delta\phi\times\Delta\eta)^{c}\), where \(c\) is 0.76 [7][4] instead of 0.5, which is the case for uncorrelated noise. For the presampler, we first studied this correlation in the case that each strip is read out separately with GaAs preamplifiers, in order to have more data points. Fitting the data points for the presampler with \(b\cdot(\Delta\phi\times\Delta\eta)^{c}\) results in \(c\)=0.58\(\pm\)0.03. For compability with the study of pileup in the electromagnetic calorimeter [4], we also performed the fit of \(a+b\cdot(\Delta\phi\times\Delta\eta)^{c}\), which gave a significantly lower value of \(c\): 0.50\(\pm\)0.03. Both fits are shown in figure 6. When fitting the data for 8 strips per preamplifier, the value of \(c\) always stayed within the errors given above.

Figure 5: Pileup noise versus cluster size with \(\emptyset\)T and GaAs preamplifiers and 8 strips per readout channel.

Figure 6: Pileup noise versus cluster size in the case of separate readout of each strip.

## 7 Noise at Low Luminosity

At low luminosity, \((10^{33}~{}cm^{-2}s^{-1})\), the pileup noise can be neglected and by using digital filtering with multiple samples [7], one can obtain an equivalent longer peaking time. Extending the peaking time to about 100 ns, would reduce the electronic noise to about 1.5 for \(\emptyset\)T and 0.5 MeV for GaAs preamplifiers.

## 8 Conclusion

We have performed a complete calculation of the electronic noise from both the preamplifiers (\(\emptyset\)T and GaAs) and the shapers (CR-RC\({}^{2}\)), which will be used to read out the ATLAS liquid argon presampler. We have also estimated the pileup noise by analyzing 1\(\,\)800 minimum bias events and taking the shaping function into account. These events were generated with PYTHIA 5.7 and a full simulation of the ATLAS detector with the hybrid model of the electromagnetic calorimeter. Finally we minimized the total noise by optimizing the peaking time (\(t_{p}(\Delta)\)) of the shapers. Since both pileup and electronic noise increases with \(\eta\), we have performed the calculations separately for each of the seven modules. Using rather short peaking times, 43 and 38 ns for \(\emptyset\)T and GaAs respectively, results in total noise levels of 3.6-5.8 and 2.5-5.2 MeV respectively (no calibration applied) in a cluster with 1\(\times\)8 cells (one readout channel). In units of transverse energy, the pileup noise itself is constant at 2.1 MeV/\(\sin\Theta\) in \(\eta\) up to \(\eta\)=1.2 and for the last \(\eta\) module it is 2.6 MeV/\(\sin\Theta\). The pileup noise does not act as uncorrelated noise; it scales as \(b\cdot(\Delta\phi\times\Delta\eta)^{0.58}\), where \(b\) is \(\eta\) dependent.

## References

* [1] D. V. Camin and N. Fedyakin, ATLAS Internal Note LARG-NO-11, 1994.
* [2] C. de la Taille, ATLAS Internal Note LARG-NO-10, 1995.
* [3] C. de la Taille, _private communication_.
* [4] L.Serin and V.Tisserand, ATLAS Internal Note CAL-NO-73, 1995.
* [5] ATLAS Technical Proposal, CERN/LHHC/94-43, 1994.
* [6] F. Gianotti \(et.\)_al._, ATLAS Internal Note CAL-NO-70, 1995.
* [7] W.E.Cleland and E.G.Stern, Nucl. Instr. and Meth. A338(1994)467.