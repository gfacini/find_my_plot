# Secondary vertex based b-tagging.

V. Kostioukhine

Corresponding author

###### Abstract

A method to increase a rejection power of the track impact parameter based b-tagging algorithm in ATLAS is presented. The method is using the information obtained by reconstruction of secondary vertices inside jet. The proposed method provides a significant increase of the rejection power of the b-tagging procedure.

CPPM,IN2P3-CNRS,Marseille,France

## 1 Introduction

A standard b-tagging procedure for b-jet identification is based on 2- or 3-dimensional signed track impact parameters for all tracks in jet. This procedure is universal, very effective and allows to calculate a probability to be a b-jet even for a case when there is only one charged track in the jet. Nevertheless a rejection power of the b-selection procedure can be increased by using an additional information - a presence of secondary vertex due to B-mesons decay in the b-jet. This information is complementary to the track impact parameters information.

The method is proposed to calculate a discriminative variable for b-tagging based on the secondary vertex inside jet information. This variable can be added to any track impact parameter based b-tagging algorithm and provides a substantial improvement in the efficiency of b-tagging.

First chapter describes a method for primary vertex reconstruction with pileup. In the second chapter a procedure for secondary vertex inside jet detection in ATLAS is presented. Third chapter describes a method for constructing a discriminative variable for b-tagging from information obtained with secondary vertex. And fourth chapter describes some results received by application of vertex based b-tagging algorithm for jet identification.

All results presented in this paper were obtained with fully simulated W(\(\rightarrow\mu\nu\)) H(\(\to uu\), _bb_) data samples produced during ATLAS DC0 and DC1[1] simulation data production stages. Jets used for b-tagging studies were reconstructed around primary quarks (_u_ or _b_) from Higgs decay directions with cone algorithm (cone size \(\Delta R=0.4\)).

## 2 Primary vertex reconstruction

A normal b-tagging procedure should start with a primary vertex reconstruction. The quality of primary vertex is very important for an efficiency of the b-tagging especially in the presence of pile-up vertices. In this note a VKalVrt [3] package is used for the primary vertex reconstruction. The following track quality cuts were used in reconstruction:

* Number of precision silicon hits \(\geq 9\);
* Number of pixel hits \(\geq 1\);
* Quality of the track fit \(\chi^{2}\leq 3\);
* \(\frac{1}{P_{\perp}}\leq 1.3\)\(\frac{1}{GeV/c^{2}}\);
* Error of the \(R\phi\) plane track impact parameter \(\sigma_{a_{0}}\leq 0.035\)\(cm\);
* Error of the \(Z\) direction track impact parameter \(\sigma_{Z_{0}}\leq 0.25\)\(cm\);
* Track impact parameter in transverse \(R\phi\) plane \(a_{0}\leq 0.1\)\(cm\) ;

The vertex reconstruction starts with an approximate Z vertex position definition. To find it a value \(W=<P_{\perp}>+\frac{N_{tr}}{30}\) is calculated in a sliding window of 0.7 \(cm\) size in Z-direction along all interaction region of ATLAS. \(N_{tr}\) here is a number of selected tracks in this window and \(<P_{\perp}>=\left(\sum\limits_{i=1}^{N_{tr}}P_{\perp i}\right)/N_{tr}\) (in \(GeV/c^{2}\)) for these tracks. The window

\begin{table}
\begin{tabular}{|l|c|c|} \hline Process+setup & \(H\to u\bar{u}\) & \(H\to bb\) \\ \hline WH(120 GeV) DC0 low lum. & 1.8\% & 2.5\% \\ WH(400 GeV) DC0 low lum. & 0.2\% & 0.3\% \\ WH(120 GeV) DC1 low lum. & 3.3\% & 3.6\% \\ WH(400 GeV) DC1 low lum. & 0.4\% & 0.4\% \\ WH(120 GeV) DC1 high lum. & 10.8\% & 11.0\% \\ \hline \end{tabular}
\end{table}
Table 1: _Probability for reconstructed primary interaction vertex to be more than \(0.5\) mm away in Z direction from true MC vertex for 2-layer pixel detector setup._with the highest value of \(W\) is considered as a region of primary interaction vertex. This expression was obtained empirically by optimization of the primary vertex identification efficiency with the track selection described above. An initial estimate of Z coordinate of the primary vertex is calculated as \(<Z>\) - mean value of Z for all tracks in the window. After the complete primary vertex reconstruction started from the determined approximate Z vertex position all tracks of the found primary vertex are deleted from a whole track list and the procedure is repeated starting from a new approximate Z position estimation of the remaining (pileup) vertices. Current version of the program is able to reconstruct up to 10 primary+pileup vertices. Primary vertex misidentification probabilities (probability that found primary interaction vertex is not in a region \(\pm 0.5\)\(mm\) in Z direction around true MC vertex) for the DC0 and DC1 setup with the 2-layer pixel detector for WH events with different Higgs masses are shown in table 1 for low luminosity (4.6 pile-up events) and high luminosity (23 pile-up events).

After the estimation of the approximate Z vertex position all tracks in a window \(\pm 5\)\(mm\) in Z direction and \(\pm 1\)\(mm\) in transverse plane from point \((0,0,Z_{approx})\) are accepted as coming from the primary vertex. Based on the selected track set the primary vertex position is reconstructed. If \(\chi^{2}\) of the vertex fit is too high, the tracks with a highest contribution to the vertex \(\chi^{2}\) are rejected and the new vertex position is calculated. An algorithm iterates until reaching the good \(\chi^{2}\) of the vertex fit. A complete description of the algorithm including a description of robust functionals for vertex fitting can be found in [3]. Some results obtained with the VKalVrt primary vertex reconstruction program are shown in fig.1 for WH events with \(M_{H}=400\)\(GeV/c^{2}\) and low luminosity pileup.

Figure 1: _Primary vertex reconstruction results for DC0 WH(\(400\)\(GeV/c^{2}\)) events with low luminosity pileup. a) - distance between MC and reconstructed vertex in transverse plane; b) - distance between MC and reconstructed vertex along beam direction; c) - number of reconstructed vertices for low luminosity pileup._

## 3 Detection of the secondary vertex inside jet

A main purpose of the proposed procedure is to detect a presence of the secondary vertex due to B(D) mesons decay inside jet with highest efficiency. An exact decay topology and multiplicity are not assumed. In addition the procedure of the vertex reconstruction should be fast enough for application in reactions with high cross section and high jet multiplicity. Taking into account all these requirement a procedure for an "_inclusive_" vertex search inside jets was developed. This procedure is also based on the VKalVrt[3] vertexing package. Tracks were selected with the same quality cuts as for the primary vertex reconstruction except for the cut on transverse track impact parameter which was \(a_{0}\leq 3.5\;mm\).

A search is started with a definition of all track pairs which form good (\(\chi^{2}<3.5\)) 2-track vertices inside jet. All results in this note were obtained with jets defined as a cone with size \(\Delta R=0.4\) around primary quarks (from Higgs decay) directions. Each track must have a 3D distance from primary vertex1 divided by its error higher than 2.0 and sum of these two normalized distances for good track pair must be higher than 6.0.

Footnote 1: Distance in 3D space between reconstructed primary vertex and the point of closest approach of particle trajectory to this vertex

Some of the reconstructed two track vertices are \(K^{0}(\Lambda)\) decays, \(\gamma\to e^{+}e^{-}\) conversions and hadronic interactions in detector material. The corresponding distributions are presented in fig.2. The pictures 2 a) and b) show \(\pi\pi\) and \(p\pi\) mass spectra for good 2 particle vertices with peaks due to \(K^{0}\) and \(\Lambda\) decays. The picture fig.2 c) shows a distance between

Figure 2: _Some distributions for good reconstructed two track vertices. a) - \(\pi^{+}\pi^{-}\) invariant mass spectrum with a peak of \(K^{0}\) decay; b) - \(p\pi\) invariant mass spectrum with a peak of \(\Lambda\) decay; c) - transverse plane distance between primary and secondary vertices with the peaks due to interactions in beam pipe walls and pixel layers._primary and secondary vertices in the transverse plane with peaks due to interactions in the material of beam pipe and pixel layers. The tracks coming from such vertices are marked as "_bad_" in a special "_bad_" track list and don't participate in the track based b-tagging.

At the next step of the algorithm all tracks inside jet producing the good 2-tracks vertices except for the "_bad_" ones are combined into one "_secondary_" track list and a vertex fitting subroutine from VKalVrt package tries to fit one secondary vertex with all these tracks. If the resulting vertex has an unacceptable \(\chi^{2}\) the track with highest contribution to the vertex \(\chi^{2}\) is deleted from the "_secondary_" track list and the vertex is refitted. The procedure iterates until receiving good \(\chi^{2}\) of the vertex fit or complete disappearance of the tracks from "_secondary_" track list.

The reconstruction results are illustrated in fig.3 where three dimensional distances divided by corresponding errors between primary vertex and reconstructed secondary vertex for light quarks jets and b-quark jets are presented. An origin of secondary vertices in light quarks jets is mainly an occasional coincidence between tracks (badly reconstructed) coming from primary vertex. An influence of c-quark (D mesons) decay vertices on inclusive reconstructed secondary vertex in b-quark jets is seen in fig.4 where distance in transverse plane between reconstructed inclusive vertex and true MC b-meson decay vertex is shown. A tail in this figure originates from a presence in the selected "secondary" track list the tracks from D-mesons decays. The inclusive secondary vertex reconstruction procedure in this case gives some mean position between a B-meson decay point and a D-meson decay point.

The probabilities to find the secondary vertex inside jet for the described reconstruction procedure are shown in tab.2 for the realistic DC0 setup with low luminosity (\(L=2\cdot 10^{33}\)\(cm^{-2}s^{-1}\)) pileup, 3(2) layers and 3(2) disks of pixel detector, 1%(2%) of modules(chips) inefficiency, 400 \(\mu m\) b-layer with 0.5%(1%) ineffici

Figure 3: _Three dimensional distance between reconstructed primary and inclusive secondary vertices divided by corresponding error for a) - light quarks jets and b) - b-quark jets._

\(M_{Higgs}=100(400)\ GeV/c^{2}\) are reconstructed. Higgs decays into \(b\overline{b}\) or \(u\bar{u}\) pair. Jets are reconstructed around primary quarks directions with a cone size \(\Delta R=0.4\).

## 4 A discriminative variable construction

The following discriminative variable is used in track impact parameter based b-tagging:

\[W_{IP}=\sum_{i=1}^{N_{tracks}}\log\frac{b\big{(}\frac{a_{0i}}{\sigma_{i}}\big{)} }{u\big{(}\frac{a_{0i}}{\sigma_{i}}\big{)}}\]

Here \(a_{0i}\) is the track impact parameter in transverse plane, \(\sigma_{i}\) is it's error and sum is taken over all tracks in jet. The \(u(\ldots),b(\ldots)\) are the probability density functions for light quarks jets and b-quark jets. The b-tagging procedure based on track impact parameters are described in [2]. In order to combine the secondary vertex information with the track impact parameters based b-tagging procedure one needs a discriminative variable which can be added to the standard one.

The vertex based discriminative variable should also be a logarithm of the density functions ratio what allows to combine two variables easily. Now it's very important to

\begin{table}
\begin{tabular}{|c|c|c|} \hline Process & \(\varepsilon_{b}\) & \(\varepsilon_{u}\) \\ \hline \(\mathrm{WH}(100\ GeV)\ 3\) layers & \(57.0\%\) & \(3.9\%\) \\ \hline \(\mathrm{WH}(100\ GeV)\ 2\) layers & \(52.2\%\) & \(2.8\%\) \\ \hline \(\mathrm{WH}(400\ GeV)\ 3\) layers & \(77.2\%\) & \(12.5\%\) \\ \hline \(\mathrm{WH}(400\ GeV)\ 2\) layers & \(70.3\%\) & \(9.0\%\) \\ \hline \end{tabular}
\end{table}
Table 2: _Probability to find the inclusive secondary vertex inside jet for different reactions and different jet flavours._

Figure 4: _Distance in transverse plane between reconstructed inclusive secondary vertex and true B-meson decay point in the same jet (cm)._

identify correctly a set of variables which must be used for vertex probability density function construction. A simplest choice - three dimensional distance between primary and secondary vertex, should not be used because all information carried by this variable is already taken into account in tracks impact parameters information. The variables independent on tracks impact parameters have to be used in order to obtain a real gain in b-tagging performance.

The current version of the procedure uses 3 parameters for the \(W_{vertex}\) rejection variable construction. They are:

* Invariant mass of all particles coming from reconstructed secondary vertex \(M\);
* Fraction of total energy of particles coming from secondary vertex with respect to total charged jet energy \(F\);
* Number of good 2 track secondary vertices in the jet \(N\).

The distributions of these variables are shown in fig.5 for light quarks jets and b-quark jets separately for \(M_{H}=100\ GeV/c^{2}\) and \(M_{H}=400\ GeV/c^{2}\).

To construct the secondary vertex based b-tagging discriminative variable one needs the parameterizations of corresponding probability density functions for light quarks jets and b-quark jets. A simplest way to obtain them is to use calibration events for producing histograms with distributions of parameters of interest. After smoothing such histograms provide reasonable estimations of corresponding probability density functions and their ratio can be used as b-tagging discriminative variable. To take into account all correlations these calibration histograms must be multidimensional.

Using the histograms for calibration of the probability density functions requires a special choice of variables:

* All parameters must be limited (histogram limits);
* The histogram should have roughly equal number of events in each bin in order to provide a uniform statistical accuracy of underlying density function estimation. This means that the distributions should be as "flat" as possible. The "flatness" is extremely important for multidimensional histograms where one needs much higher statistics to obtain a stable function estimation [4].

The original parameters for vertex based b-tagging don't satisfy these requirements. So they were transformed:

* Invariant mass: \(\Longrightarrow\)\(M^{\prime}=\frac{M}{M+1}\);
* Ratio: \(\Longrightarrow\)\(F^{\prime}=F^{0.7}\);
* Number of good 2 track secondary vertices: \(\Longrightarrow\)\(N^{\prime}=\log N\).

The distributions of the transformed parameters are shown in fig.6 for lights and b quarks jets. Although not completely "optimal" the new parameters are more suitable for the histogram based calibration.

For smoothing of the 3D calibration histograms an ASH (Averaged Shifted Histograms)[4] method is used with linear extrapolation inside bins. This method has a fast convergence

Figure 5: _Distribution of parameters \(M,F,N\) (see text for definition) used for secondary vertex based b-tagging for \(M_{H}=100(400)\ GeV/c^{2}\). \(a),b),c),g),h),i)\) - light quarks jets distributions \(d),e),f),j),k),l)\) - b-quark jets distributions._

rate[4] to true underlying probability density function. The smoothed functions obtained from the 3D histograms are used for the calculation of probability density functions. To take into account an efficiency of secondary vertex finding inside jet the 3D probability density function (PDF) is constructed in the following way:

\[PDF=(1-\varepsilon)\cdot\delta(M^{\prime},F^{\prime},N^{\prime})+\varepsilon \cdot ASH(M^{\prime},F^{\prime},N^{\prime})\]

Here \(\varepsilon\) is an efficiency of secondary vertex inside jet finding (see table 2), \(\delta(\ldots)\) is a Dirac delta-function and \(ASH(\ldots)\) is a smoothed, normalized to one function obtained from corresponding 3D calibration histogram. Then the secondary vertex based discriminative variable is obtained as a logarithm of ratio of two PDFs in the following way:

\[W_{vertex}=\log\frac{b(\ldots)}{u(\ldots)}=\left\{\begin{array}{ll}\log \frac{1-\varepsilon_{b}}{1-\varepsilon_{u}}&\mbox{ \it vertex in $jet$ is absent}\\ \log\frac{\varepsilon_{b}\cdot b(M^{\prime},F^{\prime},N^{\prime})}{ \varepsilon_{u}\cdot u(M^{\prime},F^{\prime},N^{\prime})}&\mbox{ \it vertex in $jet$ is present}\end{array}\right.\]

Figure 6: The transformed parameters \(M^{\prime},F^{\prime},N^{\prime}\) used for \(b\)-tagging discriminative variable construction. \(a),b),c)\) - light quarks jets distributions; \(d),e),f)\) - b-quark jets distributions. See text for the parameters definitions the transformations description.

[MISSING_PAGE_FAIL:10]

algorithm. And last method uses the 3D track impact parameter information together with the "bad" track rejection and the secondary vertex based b-tagging discriminative variable. In all methods the primary vertex reconstructed with VKalVrt [3] was used for impact parameters calculations. This provides more realistic estimations of b-tagging performance comparing to using of MC primary vertex.

The same secondary vertex b-tagging method was used for the study of the influence of the longitudinal pitch of the b-layer on the b-tagging performance[6].

## 6 Conclusions

The procedure for the primary vertex and the inclusive secondary vertex inside jet reconstruction was described. The secondary vertex reconstruction algorithm provides several vertex related variables which are independent on track impact parameter information for given jet. The method was developed for the construction of the single discriminative variable out of several vertex related parameters taking into account all correlations between them. It was demonstrated that an addition of this vertex based discriminative variable to the track impact parameter based b-tagging algorithm provides a significant increase of rejection power.

The performance of realistic b-tagging procedure which uses only reconstructed tracks and reconstructed primary and secondary vertices (without any MC information) was studied for WH events with pileup. The vertex based jet flavour identification algorithm improves the light jet rejection by a factor \(2.1\div 2.4\) for jets from from \(400\)\(GeV/c^{2}\) Higgs decay and by a factor \(1.3\div 1.6\) for jets from \(100\)\(GeV/c^{2}\) Higgs decay. The procedure of discriminative variable for b-tagging construction is simple enough and can be easily extended to include any additional information.

## References

* [1]_[http://atlas.web.cern.ch/Atlas/groups/software/DC/index.html_](http://atlas.web.cern.ch/Atlas/groups/software/DC/index.html_) and references on this page.
* [2] "ATLAS detector and physics performance" _Technical Design Report, LHCC 99-14/15_
* a package for vertex reconstruction in ATLAS" _ATLAS note in preparation_
* [4] D.W. Scott "Multivariate density estimation theory, practice, and visualization" _New York, NY Wiley 1992_
* [5] V. Kostioukhine, J. Leveque, A. Rozanov and J.B. de Vivie "b-tagging with DC1" _ATLAS note in preparation_ S. Gonzalez de la Hoz, E. Ros, M. Vos,. "The b-tagging performance of the complete ATLAS DC1 layout using WH events." ATL-COM-INDET-2003-017
* [6] V. Kostioukhine, J. Leveque, A. Rozanov and J.B. de Vivie "Physics impact of the change of the pixel b-layer longitudinal pitch from 300 to 400 microns" ATL-INDET-2003-016