ATL-DAQ-2000-002

20 January 2000

Selection of high-p\({}_{T}\) electromagnetic clusters by the level-2 trigger of ATLAS

Saul Gonzalez

University of Wisconsin, Madison, Wisconsin, USA

Traudl Hansl-Kozanecka

CEA/DAPNIA, Saclay, France

Monika Wielers

CPPM, IN2P3-CNRS, Marseille, France

## Abstract

The ATLAS electron and photon level-2 (LVL2) triggers share the selection of electromagnetic clusters. The selection algorithm takes as input the Region-of-Interest information passed from the level-1 (LVL1) trigger and refines it using the full granularity information of the calorimeter. The shower-shape quantities are calculated, which together with the cluster transverse energy information, discriminate electromagnetic clusters from jets. This note summarizes the performance in terms of rates and efficiencies of the LVL2 electromagnetic feature extraction algorithm. Both low (\(L=10^{33}\)cm\({}^{\cdot}\)2s\({}^{\cdot}\)1) and high (\(L=10^{34}\)cm\({}^{\cdot}\)2s\({}^{\cdot}\)1) luminosity results are presented. Particular emphasis is given to the optimization of the trigger selections and to the sequence of trigger selection steps.

[MISSING_PAGE_EMPTY:2]

## 1 Introduction

The ATLAS Higher-level triggers, LVL2 and event filter (EF), must reduce the LVL1 rate of up to 100 kHz to about 100 Hz, where the largest rejection is expected from the LVL2 trigger. The processing steps at LVL2 are as follows. Raw data associated with the Regions of Interest (RoIs) indicated by LVL1 are collected and prepared. Feature extraction (FEX) is performed for each detector system, starting with the confirmation of the LVL1 RoI in the system from which it originated (e.g. calorimeter), followed by the confirmation in other systems, for example the tracking system. Features from different systems are combined to form identified LVL2 trigger objects that are candidates for electrons and photons. Finally a global decision is taken based on trigger menus. An average processing time of \(\sim\)10 ms per event is currently assumed for the LVL2 trigger.

This note presents the status of work to develop the electron/gamma FEX algorithm and extends the reports given in the trigger performance report (TPSR) [6-1] and in Ref. [6-2]. It explains and justifies the choices that were made for the algorithm and the trigger selections. The signal consists of genuine electrons and photons, whereas the background is completely dominated by di-jet events. The LVL2 'features' are parameters which describe E\({}_{\rm T}\), position and shape of the electromagnetic (e.m.) cluster. The performance obtained in terms of efficiency and background-rejection determines the overall performance of the LVL2 trigger. The preceding data-collection and preprocessing step is important and may be time consuming, but the bulk of the algorithmic complexity lies in the feature extraction.

The algorithm presented in this note should be seen as a prototype for the one that will be used in the online LVL2 trigger. It demonstrates the feasibility of obtaining the required trigger performance in terms of signal efficiency and background rejection, while using an algorithm simple enough to implement in the LVL2 trigger. Timing studies have confirmed that the algorithm is fast enough when used in the online environment. The 'benchmark' figures and optimization for online implementation will be described in a forthcoming note.

Section 2 presents the data sets, the geometry used by the simulation and the calibration applied in preparing the input for the algorithm. The present note should be considered as reference for further studies. The LVL1 electromagnetic algorithm is described in Section 3. This is followed by the description of the LVL2 implementation of the e.m. algorithm and its performance in terms of efficiency and background rejection in Section 4. Section 4.3.3 describes the optimization of the selections. Some of the fine corrections applied in the offline reconstruction are not used at LVL2; this is justified in Section 4.4. For the identification of electrons the calorimeter information is matched to the tracker information; this step is described in a separate note [6-3]. The refinement of the identification of photons is described in Ref. [6-4].

At the time the studies presented in this note were performed, the ATLAS pileup simulation program was being upgraded (Section 2.2). Several LVL2 studies are therefore not yet complete.

## 2 Monte Carlo data sets

### Data sets

The Monte Carlo data sets used for the studies include full simulation of single photons, single electrons, minimum bias events and di-jets. The list of the data sets can be found in References [6-5]. Details on the data sets are described in the TPSR [6-1], Chapter 4. Efficiency studies were carried out on samples of single-particle events generated at a fixed \(\mathrm{E_{T}}\) and over various ranges of \(\eta\). Background rates were evaluated with a large sample of di-jet events, kinematically preselected in order to eliminate events that would normally not pass the LVL1 trigger [6-6]. The di-jet sample consists of jets from QCD processes and few signal processes (mainly top, Z's, W's, and prompt photons). The pre-selection includes requirements on the hard-scattered partons of \(\mathrm{p_{T}}>17\) GeV and \(|\eta|<2.7\).

### Pile-up simulation

In order to study the effect of pile-up at high luminosity, minimum-bias events are added to both signal and jet data samples. Two different methods for simulation of the pile-up are used. The commonly applied method assumes an average effective number of minimum bias events, which are added to both the tracker and calorimeter. The effective number for high luminosity is 48 events for all calorimeters; in the e.m. LAr calorimeter this number reproduces correctly the r.m.s. of the pile-up noise, but produces an offset of the mean value [6-7]. The second method, which reproduces more closely the hardware, uses the peaking time structure of the calorimeter response to account for the time dependence of the pile-up contributions [6-8]. The average of the pile-up contribution is then centred at zero. At the time the studies reported in this note were done, the last method was only working at the calorimeter level, so that the correlations between the calorimeter system and the tracker system could not be studied. Unless otherwise noted, all evaluations of trigger performance presented in this note are carried out with the first method. No pile-up was added to low luminosity events.

### Geometry

The detector layout used for this study corresponds to the final detector design [6-8]. Table 2-1 summarizes the granularities and longitudinal segmentation of the calorimeters used for \(\mathrm{e}/\gamma\) identification (\(|\eta|<2.45\)). Few small adjustments to the geometry were made after the data sets had been simulated (see footnotes of the table).

The e.m. calorimeters consist of a barrel part (\(|\eta|<1.475\)) and two end-caps (\(1.375<|\eta|<3.2\)). The end-caps are subdivided into the outer wheel (\(1.375<|\eta|<2.5\)) and the inner wheel (\(2.5<|\eta|<3.2\)). For \(|\eta|<1.8\), a presampler is mounted in front of the calorimeter to correct for the energy loss in the material of the inner detector and the magnet coil. The hadronic calorimeters cover \(|\eta|<4.9\) and consist of the barrel tile calorimeter (\(|\eta|<1.0\)), extended barrel Tile calorimeter (\(0.8<|\eta|<1.7\)), liquid-argon end-cap calorimeter (\(1.5<|\eta|<3.2\)), and the forward calorimeters (\(3.1<|\eta|<4.9\)). Scintillators are installed between \(1.0<|\eta|<1.55\); they improve the energy resolution in the barrel/end-cap transition region.

\begin{table}
\begin{tabular}{|l|l|l|l|l|} \hline \multicolumn{4}{|c|}{**Hadronic calorimeters**} \\ \hline  & \multicolumn{2}{|c|}{**Barrel Tile**} & \multicolumn{2}{|c|}{**Extended barrel tile**} & \multicolumn{2}{|c|}{**LAr end-cap**} \\ \hline Coverage & \(|\eta|<1.0\) & \(0.8<|\eta|<1.7\) & \(1.5<|\eta|<3.2\) \\ \hline Longitudinal segmentation & 3 samplings & 3 samplings & 4 samplingsa  & \\ \hline Granularity & \(\Delta\eta\times\Delta\phi\) & \(\Delta\eta\times\Delta\phi\) & \(\Delta\eta\times\Delta\phi\) & \\ sampling 1 \& 2 & \(0.1\times 0.1\) & \(0.1\times 0.1\) & \((1.5<|\eta|<2.5)\) \\  & & & \(0.2\times 0.2\) & \((2.5<|\eta|<3.2)\) \\ sampling 3 & \(0.2\times 0.1\) & \(0.2\times 0.1\) & \(0.1\times 0.1\) & \((1.5<|\eta|<2.5)\) \\ (\& 4 in the endcap) & & \(0.2\times 0.2\) & \((2.5<|\eta|<3.2)\) \\ \hline \multicolumn{4}{|c|}{**Electromagnetic calorimeters**} \\ \hline  & \multicolumn{2}{|c|}{**Barrel**} & \multicolumn{2}{|c|}{**End-cap**} \\ \hline Coverage & \(|\eta|<1.475\) & \(1.375<|\eta|<3.2\) & \\ \hline presampler & 1 sampling & \(|\eta|<1.52\) & 1 sampling & \(1.5<|\eta|<1.8\) \\  & \(\Delta\eta\times\Delta\phi\) & \(\Delta\eta\times\Delta\phi\) & \\  & \(0.025\times 0.1\) & \(0.025\times 0.1\) & \\ \hline Longitudinal segmentation & 3 samplings & \(|\eta|<1.35\) & 3 samplings & \((1.5<|\eta|<2.5)\) \\  & 2 samplings & \(1.35<|\eta|<1.475\) & 2 samplings & \((1.375<|\eta|<1.5,\) \\  & & & \(2.5<|\eta|<3.2)b  \\  & & & \(2.5<|\eta|<3.2\) \\ \hline Granularity & \(\Delta\eta\times\Delta\phi\) & \(\Delta\eta\times\Delta\phi\) & \\ sampling 1 & \(0.003\times 0.1\) & \(|\eta|<1.4\) & \(0.025\times 0.1\) & \((1.375<|\eta|<1.5)\) \\  & \(0.025\times 0.1\) & \(1.4<|\eta|<1.475\) & \(0.003\times 0.1\) & \((1.5<|\eta|<1.8)\) \\  & & & \(0.004\times 0.1\) & \((1.8<|\eta|<2.0)\) \\  & & & \(0.006\times 0.1\) & \((2.0<|\eta|<2.4)\) \\  & & & \(0.025\times 0.1\) & \((2.4<|\eta|<2.5)\) \\  & & & \(0.1\times 0.1\) & \((2.5<|\eta|<3.2)\) \\ sampling 2 & \(0.025\times 0.025\) & \(|\eta|<1.4\) & \(0.025\times 0.025\) & \((1.375<|\eta|<2.5)\) \\  & \(0.075\times 0.025\) & \(1.4<|\eta|<1.475\)c  & \(0.1\times 0.1\) & \((2.5<|\eta|<3.2)\) \\ sampling 3 & \(0.05\times 0.025\) & \(|\eta|<1.35\) & \(0.05\times 0.025\) & \((1.5<|\eta|<2.5)\) \\ \hline \end{tabular}
\end{table}
Table 1: Rapidity coverage, granularity and longitudinal segmentation of the ATLAS calorimeters, which participate in the e/\(\gamma\) trigger.

### Calibration and thresholds

The trigger simulation makes at present use of the unpacking of simulated 'raw data' and the cell calibration of the offline reconstruction (routines ClUnpk, CaloCali). The offline cell calibration is derived as a function of \(\eta\) for photons of 50 GeV by summing up the _total_ energy per sampling in the calorimeters. The total energy is given by

\[\mathrm{E_{tot}}=\mathrm{w_{gl}}(\mathrm{w_{ps}}\mathrm{E_{ps}}+\mathrm{E_{1}}+ \mathrm{E_{2}}+\mathrm{E_{3}})\]

where \(\mathrm{w_{gl}}\) is the global calibration factor, \(\mathrm{w_{ps}}\) is the presampler weight (-3.5), which accounts for the loss of energy in front of the calorimeter, and \(\mathrm{E_{ps}}\), \(\mathrm{E_{1}}\), \(\mathrm{E_{2}}\) and \(\mathrm{E_{3}}\) are the energies measured in the presampler, in the first, the second, and the third sampling of the e.m. calorimeter, respectively. The same cell calibration is applied for low and high luminosity. Once clusters are found, a correction factor is applied to its \(\mathrm{E_{T}}\) to compensate for the energy outside the cluster window. The scintillator energy is added in the barrel/end-cap overlap region1. Both corrections depend only on \(\eta\) and the window size. The trigger \(\mathrm{E_{T}}\)-thresholds are significantly lower than the \(\mathrm{E_{T}}=50\) GeV, used for deriving the calibration. Due to the slight \(\mathrm{E_{T}}\)-dependence of the calibration, a small adjustment may be applied to preserve the sharp rise of the trigger threshold. Figures 2-2 show the \(\mathrm{E_{T}}\) distribution before correction for electrons and photons: The calibration depends on particle type; no correction as function of particle type is applied at LVL2 (see Section 4.4).

Footnote 1: For some studies an \(\eta\)-dependent correction factor was applied instead of adding the scintillator energy.

A small threshold was applied to the cell energies (E \(>\) 0.1 MeV). Thresholds have not yet been optimised, because the commonly used pile-up method (see Section 2.2) introduces a shift in energy; threshold studies are therefore not meaningful. When the more realistic pile-up simula

Figure 2-1: Sketch of the three samplings of the barrel e.m. calorimeter (from [6-8]).

tion is available, the possibility of applying thresholds to remove small signals will be investigated. Removing small signals that do not improve the rejection of the background but dominate the number of cells over which the algorithm has to loop could potentially reduce the algorithm computing time dramatically.

## 3 LVL1 Rols and LVL1/LVL2 interface

The LVL1 calorimeter algorithms are described in the TPSR [6-1], Chapter 6; more details and a discussion of their hardware implementation can be found in [6-9].

The LVL1 algorithm works on matrices in \(\eta\times\phi\), which store the \(\mathrm{E_{T}}\) per trigger tower separately for e.m. and hadronic calorimeters with a typical granularity \(\Delta\eta\times\Delta\phi=0.1\times 0.1\). Truncating the digitized values for the tower energies to eight bits effectively applies a 1 GeV threshold to each trigger tower. The LVL1 electron/photon trigger algorithm is based on a window of 4\(\times\)4 towers in the electromagnetic and hadronic calorimeters in the region \(|\eta|<2.5\), and consists of four elements:

* a 2\(\times\)2-tower e.m. cluster, used to identify the position of candidate RoIs (local \(\mathrm{E_{T}}\) maximum);
* there are four such regions within the RoI cluster, and the most energetic of these is used;
* a ring of 12 electromagnetic towers surrounding the clusters, which is used for isolation tests in the e.m. calorimeter;
* the 16 hadronic towers behind the electromagnetic clusters and isolation ring, which are used for isolation tests in the hadronic calorimeters1.

The window slides in steps of one trigger tower in both the \(\eta\) and \(\phi\) directions. The LVL1 selections, which were used for this note, are listed in Table 3-1.

For each LVL1 trigger, RoI information is transmitted to the LVL2 trigger giving the (\(\eta\), \(\phi\)) position and \(\rm E_{T}\) range of identified objects. Due to the choice of the local \(\rm E_{T}\) maximum and the step size of 0.1, the RoI position is provided with a resolution of \(\Delta\eta\times\Delta\phi\sim 0.1\times 0.1\). The precision of the LVL1 RoI position is shown in Figures 3-1 and 3-2. The \(\Delta\phi\) distribution has the expected box-shape with resolution 0.1/\(\sqrt[]{1}\) - 0.029, and is somewhat degraded in the barrel/end-cap overlap region. The \(\Delta\eta\) distribution is wider (rms = 0.038) and shows tails due to the spread of the primary vertex region, \(\sigma_{\rm Z}\) = 5.6 cm. Both distributions have offsets of \(\sim\) 0.03 due to the "corner-blasing" of the LVL1 e.m. algorithm.

The events selected by the LVL1 trigger are dominated by photons from \(\pi^{0}\)s and \(\pi^{+}/\pi^{-}\) charge exchange. Figure 3-3 shows the particle content after the LVL1 trigger. For those LVL1 RoIs, which are associated to photons, Figure 3-4 shows the \(\rm E_{T}\) of the cluster versus the \(\rm E_{T}\) of the most energetic photon (\(\gamma_{\rm I}\)) and the two most energetic associated photons (\(\gamma_{\rm I}\)+\(\gamma_{\rm I}\)). The figure demonstrates that most of the time both photons (from \(\pi^{0}\) or \(\eta\)) contribute to the energy in the LVL1 cluster.

## 4 LVL2 e/\(\gamma\) trigger algorithm

### Overview

The LVL2 e/\(\gamma\) trigger is the starting point for the formation of LVL2 electron and photon trigger objects. This calorimeter-only trigger takes as input the RoI selected by the LVL1 e/\(\gamma\) trigger. The LVL2 trigger refines the LVL1 information using full-granularity, full-precision information from the calorimeters. The LVL2 trigger also profits from improved though not final calibrations and thresholds, which can be optimised and adapted to the luminosity conditions.

First, the cluster position in \(\eta\) and \(\phi\) is improved before further analysis in windows centred at the improved position. The measurement of \(\rm E_{T}\) at LVL2 results in sharper thresholds and allows tighter \(\rm E_{T}\) cuts. Because of the steeply falling \(\rm E_{T}\) spectrum of the background, the \(\rm E_{T}\) selection is one of the main handles to control the LVL2 output rate. The LVL2 trigger builds shower shape variables, which together with the transverse energy, discriminate e.m. clusters from jets.

After the FEX quantities are calculated, a decision is made based on how compatible the shape parameters are with a single e/\(\gamma\) cluster at the given E\({}_{\rm T}\). The actual values of the selection cuts depend in general on the cluster position \(\eta\) and energy E\({}_{\rm T}\). The selection cuts depend in addition on the type of trigger object and object multiplicity specified in the trigger menu table.

The trigger simulation code (ATRIG) is oriented towards studying the selections rather than rejecting events within the shortest possible processing time. For example, the LVL1 cluster E\({}_{\rm T}\) is recalculated at LVL2, but the event not rejected if the E\({}_{\rm T}\) is below threshold. Rather, the full chain of calculation is carried through and the values of the cut quantities stored in an NTuple. The selection can then be done interactively from this NTuple. This procedure is necessary for optimising the selections. The objective for the e.m. trigger online code [6, 7, 8, 9, 10], on the contrary, is to make a decision as fast as possible. To this end the optimised selections are applied and events rejected, as soon as they fail one of the selections.

The trigger objects are named e.g., E20I (LVL1) and e20i (LVL2) for e/\(\gamma\) candidates with E\({}_{\rm T}>20\) GeV. These names hide the details of the selections, which may depend on E\({}_{\rm T}\) and \(\eta\) of the object. These detailed selection were shown in Table 3-1 for LVL1, and will be explained in Section 4.3.3 for the LVL2.

### Verification and improvement of LVL1

#### 4.2.1 Rol size

The detector data are collected from the readout buffers (ROBs) in \(\Delta\eta\times\Delta\phi\) regions of a size determined by the precision of the LVL1 object position and by the type of LVL2 algorithm. It is important to keep the size of this collection region small in order to minimize the data transfer from the ROBs to the LVL2 processors. The LVL2 algorithm therefore does not repeat the LVL1 isolation criteria since it would require analysis in a ring of twelve towers around the LVL1 Rol. It verifies instead the shape parameters of the cluster, for which a window size of \(\Delta\eta\times\Delta\phi=0.175\times 0.225\) (\(7\times 9\) standard cells in the second e.m. sampling) is sufficient. The size of the collection region (also called 'Rol size') is then the sum of the LVL1 precision in RoI position (\(\Delta\eta\times\Delta\phi=0.1\times 0.1\)) and the size of the LVL2 window. For all studies reported in this note a region of \(0.4\times 0.4\) was chosen for collecting the 'raw' data at LVL2.

The additional rejection that can be achieved by applying isolation cuts in a 'ring' around the cluster or by applying a cut on the largest single deposition in this ring, will be studied in the future. The possible gain in rejection has to be weighed against the increase in data transfer. This needs careful evaluation of the uncertainty owing to the background from pile-up and the underlying event. The theoretical uncertainty on the multiplicity of minimum bias events is about a factor of two; the uncertainty is even larger for the underlying event, which in addition varies with the event type.

#### 4.2.2 LVL1 verification and refinement

The first step of the LVL2 trigger algorithm is the refinement of the calorimeter information contained in the LVL1 Rol. By using the full calorimeter granularity and a LVL2-specific energy calibration, the LVL1 position is improved by searching for the highest-E\({}_{\rm T}\) cell. This position (\(\eta_{1}\), \(\phi_{1}\)) is then further refined by calculating in the second sampling the energy weighted position (\(\eta_{c}\), \(\phi_{c}\)) in a window of \(\mathrm{d}\eta\times\mathrm{d}\phi=3\times 7\), centred at (\(\eta_{1}\), \(\phi_{1}\)). The second sampling contains most of the energy and has the same fine granularity both in \(\eta\) and \(\phi\) (see Figure 2-1). The pre-shower has very fine granularity in \(\eta\) but only a small fraction of the energy is deposited there. All subsequent calculations use windows centred at the new position (\(\eta_{c}\), \(\phi_{c}\)). No further position corrections are applied (see Section 4.4).

### LVL2 Trigger selections

In what follows the efficiency is evaluated for trigger thresholds of 20 GeV and 30 GeV at low and high luminosity, respectively, in accordance with the standard electron and photon trigger-menu thresholds (see TPSR [6-1], Chapter 11). The background rates are calculated from simulated jet events at low and high luminosity and the rates are corrected for kinematic acceptance effects [6-6].

#### Transverse energy per sampling

The algorithm calculates the energies contained in windows of size \(\mathrm{d}\eta\times\mathrm{d}\phi=3\times 3\), \(3\times 7\), \(7\times 7\), and \(7\times 9\) and per sampling. About 20-30% (depending on \(\eta\)) of the electrons loose half of their energy because of bremsstrahlung, and 15-30% of the photons (depending on \(\eta\)) are converted in the material of the inner detector. The windows are therefore larger in \(\phi\) than in \(\eta\) in order to accept the radiated energy and reduce the low-\(\mathrm{E}_{\mathrm{T}}\) tails. The total cluster transverse energy \(\mathrm{E}_{\mathrm{T}}\) is calculated by using the e.m. calorimeter layers and the presampler contained in a window of \(3\times 7\) cells. The \(\mathrm{E}_{\mathrm{T}}\) is then corrected for lost energy due to the finite window size (see Section 2.4) and the scintillator energy is added. No correction is applied to \(\mathrm{E}_{\mathrm{T}}\) values used in the calculation of \(\mathrm{E}_{\mathrm{T}}\) ratios, which quantify the lateral shower shape.

The energy that leaks into the hadron calorimeter, \(\mathrm{E}_{\mathrm{T}}^{\mathrm{had}}\), is calculated in a window of size \(\Delta\eta\times\Delta\phi=0.2\times 0.2\), centred on (\(\eta_{c}\), \(\phi_{c}\)).

The energy deposits in the \(\eta\)-strips of the first calorimeter sampling are used to extract information about the early shower development. All strips within a window of \(\Delta\eta\times\Delta\phi=0.125\times 0.2\) at (\(\eta_{c}\), \(\phi_{c}\)) are associated to the \(\mathrm{e}/\gamma\) cluster. The energies of the two strips in \(\phi\) are summed into a single strip.

#### LVL2 e/\(\gamma\) trigger features

In the results that follow the LVL1 e/\(\gamma\) trigger has been applied and the trigger thresholds were set such that the LVL1 e/\(\gamma\) trigger rates are 25 kHz and 7 kHz at high and low luminosity, respectively, compatible with the expected LVL1 e/\(\gamma\) trigger performance (see TPSR Chapter 6 and Table 3-1). The following sections describe those LVL2 trigger quantities, which were found to be most efficient in preserving the signal while efficiently rejecting the background. Care was taken to use quantities that are approximately independent of each other. Though the shape parameters are correlated for the signal because of the well defined shape of an e.m. shower, the correlations are much smaller for the background, where fluctuations are large.

#### 4.3.2.1 Transverse energy in the e.m. calorimeter

Owing to the energy dependence of the QCD background, a cut on \(\mathrm{E_{T}}\) provides the best rejection against LVL1 triggered jets for a given high-\(\mathrm{p_{T}}\) signal process. The transverse energy \(\mathrm{E_{T}}\) is calculated by using the e.m. calorimeter and the presampler over \(3\times 7\) cells in \(\eta\) and \(\phi\). The \(\mathrm{E_{T}}\) distribution is shown in Figures 4-1 and 4-2 for \(\mathrm{E_{T}}=20\) GeV (30 GeV) electrons and jets at low (high) luminosity after the LVL1 trigger and before any other cuts. In the figure, the number of background events is much reduced at lower \(\mathrm{E_{T}}\) because the jet sample was generated with \(\mathrm{p_{T}}^{\mathrm{parton}}>17\) GeV and because the LVL1 energy thresholds reject low-energy jets.

The electronics of the e.m. calorimeter is designed such that the contributions to the \(\mathrm{E_{T}}\) resolution from electronic noise and pile-up are about the same. The threshold curves are therefore not significantly degraded when comparing low and high luminosity operations, see Figures 4-1 and 4-2.

##### 4.3.2.2 Transverse energy in the hadronic calorimeter

Photons and electrons typically deposit very little of their energy in the hadronic calorimeter. For LVL1 e.m. triggered jets, however, about 5% of the energy is deposited in the hadronic calorimeter; this hadronic energy can be used to tag jets, as can be seen in Figures 4-3 and 4-4. The e.m. energy that leaks from genuine \(\mathrm{e}/\gamma\) clusters into the hadronic calorimeter increases with the incident \(\mathrm{e}/\gamma\) energy; for low energy it is not significant when compared with the contributions from noise and pile-up. To be efficient for \(\mathrm{e}/\gamma\) clusters at high \(\mathrm{E_{T}}\), however, the hadronic isolation requirement must take this energy dependence into account. In the LVL2 trigger algorithm discussed here, the energy dependence has been implemented as a series of \(\mathrm{E_{T}}\) thresholds (see Table 4-1).

#### 4.3.2.3 Lateral shape in the second sampling

Photon and electron showers have on average a lateral size of one Moliere radius, whereas the lateral size of showers initiated by jets is dominated by fragmentation and the hadronic interaction length. Most of the energy of e.m. showers (typically more than 70%) is deposited in the

Figure 4: The upper plot shows the \(\mathrm{E_{T}}\) distribution in the hadronic calorimeter for jets and for 20 GeV single electrons at low luminosity after the LVL1 trigger. The lower plot shows the signal and background efficiency as a function of the trigger \(\mathrm{E_{T}}\) threshold.

second sampling of the e.m. calorimeter. This sampling is therefore also relatively less affected by noise and pile-up. Thus, in order to distinguish between e/\(\gamma\) clusters and jets, the quantity \(\mathrm{R_{\eta}^{shape}}=\mathrm{E_{3\times 7}/E_{7\times 7}}\), the ratio of the cell energies in a \(3\times 7\) window to a \(7\times 7\) window, is calculated for the second calorimeter sampling. As for \(\mathrm{E_{\eta}}\) a wider window in \(\Delta\phi\) allows for photon conversions and electron radiation so that most of the photon and electron energy is well-contained. The ratio \(\mathrm{R_{\eta}^{shape}}\) is typically larger than 0.9 for e.m. clusters, as shown for 20 GeV (30 GeV) electrons and jets at low (high) luminosity in Figures 4-5 and 4-6.

##### 4.3.2.4 Lateral shape in the first sampling

After applying the cuts in the hadronic calorimeter and the second sampling of the e.m. calorimeter, only jets with very little hadronic activity and narrow showers in the calorimeter re

Figure 4: Lateral shower distribution with respect to the centre of gravity of the shower in the first sampling of the e.m. calorimeter for (a) to (c) jets and for (d) a photon. These distributions are for single events at low luminosity.

main. These 'electromagnetic' jets frequently consist of single or multiple \(\pi^{0}\)s or \(\eta\)'s decaying to two photons. In order to reject these jets the very fine granularity of the first sampling of the e.m. calorimeter can be exploited by looking for substructures and by analysing the shower shape. This analysis can only be done if enough energy is deposited in the first sampling. Thus, before applying the following selection, it is required that at least 0.5% of the total energy is deposited in the first sampling. Figure 4-7 shows examples of the early development of jet and photon showers in the first sampling. In the case of jets one might find two maxima, _e.g._ from the two photons of a \(\pi^{0}\) decay. Sometimes more than two maxima are found (_e.g._ in jets containing several \(\pi^{0}\)s). In order to reject these events, an algorithm which searches for secondary maxima is applied.

In this algorithm, the energy deposited in a window of \(\Delta\eta\times\Delta\phi=0.125\times 0.2\) in the first calorimeter sampling is examined on a strip-by-strip basis. The two \(\phi\)-bins are summed and the shower is scanned in the \(\eta\)-direction for a first and a second local maximum. Here a local maximum is defined as a single strip with energy greater than its two adjacent strips. In case more than two maxima are found the second highest maximum is considered. After the first two maxima are found, the ratio \(\rm R_{\eta}^{strip}=(E_{1st}-E_{2nd})/(E_{1st}+E_{2nd})\) is formed, where \(E_{1st}\) refers to the energy of the highest-energy strip maximum and \(E_{2nd}\) is the energy of the second-highest-energy strip maximum. This ratio is found to be stable against fluctuations and no improvement is obtained if two or even three strips are considered to characterize the second maximum. Furthermore, since the strips are parallel to the \(\phi\)-direction, this quantity is not affected much by photon conversions or radiation off electrons. Figures 4-8 and 4-9 show this quantity for 20 GeV (30 GeV) electrons and jets at low (high) luminosity after the LVL1 trigger. The shape parameter in the first sampling is one of the most powerful selections after the \(E_{T}\) selection.

The selection using the lateral shape \(\rm R_{\eta}^{strip}\) is a powerful tool to reject photons that originate from \(\pi^{0}\)s (or \(\eta\)'s). This is demonstrated in Figures 4-10 and 4-11 for low and high luminosity, respectively. The rejection of photons is nearly independent of the fraction of energy carried by the highest-\(E_{T}\) photon, except when the photon acquires more than 95% of the \(\pi^{0}\) energy. The re jection is, however, very sensitive to the separation of the two photons in \(\eta\). Better rejection can be achieved at low luminosity, where the energy threshold is lower, and the average energy of the LVL1-triggered \(\pi^{0}\)s is smaller and hence the separation in \(\eta\) of the photons is larger.

#### LVL2 \(e/\gamma\) trigger performance

After defining the four LVL2 trigger quantities, the next step is to evaluate the trigger performance in terms of overall efficiency (LVL1\(\times\) LVL2) and background rate. In terms of implementation, the LVL2 \(e/\gamma\) trigger consists of a series of trigger menus requiring at least one or two trigger objects per event. Each threshold setting in the menus may correspond to the application of a set of several threshold ranges as shown in Table 4. For each \(\mathrm{E_{T}}\)-range the shower shape selections may change as a function of \(\eta\) and \(\mathrm{E_{T}}\) to achieve uniform efficiency for \(\mathrm{E_{T}}\)'s above threshold and over the full \(\eta\) range. Most results presented here are for the single-object triggers.

\begin{table}
\begin{tabular}{l l l l l l} \hline \hline
**Luminosity** & **Trigger** & \(\mathrm{E_{T}}\)**(GeV)** & \(\mathrm{R_{\eta}}^{\mathrm{shape}}\) & \(\mathrm{R_{\eta}}^{\mathrm{strip}}\) & \(\mathrm{E_{T}}^{\mathrm{had}}\)**(GeV)** \\ \hline High & e30i & 25.5 & 0.88 & 0.70 & 2.2 \\  & & 60.0 & 0.88 & 0.70 & 4.0 \\  & & 120.0 & 0.88 & 0.70 & 999.0 \\ \hline Low & e20i & 17.0 & 0.92 & 0.75 & 0.49 \\  & & 25.0 & 0.92 & 0.75 & 0.49 \\  & & 60.0 & 0.92 & 0.75 & 999.0 \\ \hline \hline \end{tabular}
\end{table}
Table 4: Values of the optimised selection cuts for an electron efficiency of \(>\)90% for 20 GeV and 30 GeV electrons at low and high luminosity, respectively, and for the LVL2 \(e/\gamma\) single-object trigger. The efficiencies and rates corresponding to these cuts are listed in Table 4.2.

Figure 4: The figure at left (a) shows the fraction of energy carried by the most energetic photon from a \(\pi^{0}\) after the LVL1 (solid) and LVL2 (dashed) trigger at low luminosity. The figure at right (b) shows the separation in \(\eta\) for the \(\pi^{0}\) photons after the LVL1 (solid) and LVL2 (dashed) triggers.

#### 4.3.3.1 Optimization of selections

The strategy followed in optimising the LVL2 e/\(\gamma\) trigger selections is to obtain high efficiency while keeping the cuts simple. This allows further refinement in the electron and photon trigger stage (e.g. \(\eta\)-dependent cuts) while maintaining a common set of cuts for the e.m. cluster trigger. Also for this reason the cuts are chosen such that unconverted and converted photons are affected in the same way.

The optimal cut values for the four LVL2 trigger quantities are found by a procedure which scans the allowed four-dimensional parameter space and finds, for each efficiency, the set of cut values which gives the lowest background rate. The method is illustrated in Figure 4-12: The parameter space is scanned in equal probability bins for reasonable values of the selections; Figure 4-12 shows the efficiency for signal and the background rate corresponding to each parameter set at high luminosity. The left edge of the collection of points corresponds to the parameter sets with highest efficiency and lowest background, i.e., the curve of Figure 4-14. Each point on the curve represents a set of selections, which give the best performance. This procedure takes into account all possible correlations between the trigger quantities. Figures 4-13 and 4-14 show the resulting efficiency versus rate curve for \(\rm p_{T}=20\) GeV and 30 GeV electrons at low and high luminosity, respectively. As an example, Table 4-1 lists a set of cuts, which give efficiencies above 90% and reduction factors with respect to the LVL1 trigger of about seven. The evolution of the cuts in each quantity as a function of the signal efficiency is illustrated in Figures 4-15 to 4-18 for low and high luminosity. These figures show the relative stability with efficiency of the selections for each trigger quantity. The small fluctuations at medium efficiencies are due to the correlations in the four quantities and to the presence of multiple minima. The larger fluctuations at high efficiencies are statistical in nature and are a reflection of the saturation in efficiency: higher efficiencies cannot be obtained without additional information.

Figures 4-15 to 4-18 also show that, even though the actual cut values are different, the dependence (i.e., the "shape") on efficiency of the optimised cuts is very similar at high- and low-luminosity. The biggest difference in shape is evident for \(\rm E_{\gamma}{}^{had}\) (Figure 4-18), where the pileup noise is expected to dominate. Other differences are evident in the offsets due to the nominal electron

Figure 4-11: Same as Figure 4-10 but at high luminosity.

energies used in the optimization procedure at high- (30 GeV) and low-luminosity (20 GeV), which in turn are evident in the optimised energy thresholds (Figures 4-15 and 4-18). This means that the values for the trigger cuts have to be slightly modified in order to keep the trigger performance stable during a fill of the LHC machine, during which the luminosity will decrease significantly [6-1].

Figure 4-12: The optimization procedure finds the best efficiency possible for a given rate by scanning the four-dimensional space of all possible cut combinations. This example shows the efficiency and rate results for four quantities scanned in 30 equal probability bins.

#### 4.3.3 Overall performance

After defining a set of LVL2 trigger cuts, the overall performance of the e/\(\gamma\) trigger can be evaluated. The efficiencies for electrons of 20 GeV (30 GeV) and the background rates are summarized in Table 4.2. The LVL2/LVL1 rejection factors are 7.5 and 6.3 at low and high luminosity, respectively. The efficiency for 20 GeV photons at low luminosity, using the cuts optimised with 20 GeV electrons, is \(88.9\pm 0.3\%\).

Since the lateral and longitudinal extent of both e.m. and hadronic showers depend on the incident energy, the shape-dependent trigger quantities depend on \(\mathrm{E_{T}}\). For example, as showers become more energetic, they deposit more energy in the hadronic calorimeter and in the last sampling of the e.m. calorimeter. This \(\mathrm{E_{T}}\) dependence of the hadronic energy is taken into account in the trigger decision in the form of \(\mathrm{E_{T}}\)-dependent thresholds for \(\mathrm{E_{T}}^{\mathrm{had}}\) (see Table 4-1). Figures 4-19 and 4-20 show the efficiency as function of the cluster-\(\mathrm{E_{T}}\) for the 20 GeV and 30 GeV trigger thresholds at low and high luminosity, respectively. The efficiency is constant or increases for higher \(\mathrm{E_{T}}\), within the \(\mathrm{E_{T}}\) range shown (data samples at higher \(\mathrm{E_{T}}\) were not available).

The detector acceptance has also a significant role in the LVL2 trigger performance. Figure 4-21 shows the LVL2 trigger efficiency as a function of \(\eta\) for 80 GeV photons at low luminosity. The trigger efficiency is constant except for the difficult barrel/end-cap transition region (seeTable 2-1), where a large fraction of the energy of an e/\(\gamma\) cluster can be lost. This region is included in the efficiencies given so far. The last column in Table 4-2 lists the efficiencies excluding this region. The \(\eta\)-dependence can be taken into account by optimising the trigger quantities in different \(\eta\) bins. This is particularly important in the case that a set of strict trigger cuts is chosen. Increasing the efficiency in the overlap region by choosing looser cuts, however, results in a large increase in background contribution.

Figure 4-22 shows the particle content of the RoIs after the LVL1 and the LVL2 trigger. After the LVL2 trigger, most of the rate is dominated by isolated photons and electrons while the RoIs that pass the LVL1 due to pion charge exchange are essentially eliminated.

#### 4.3.3 \(\mathrm{E_{T}}\)-dependence of selections and trigger rate

The rates presented here have generally large uncertainties: up to a factor of two uncertainty due to the K-factor for jet production and about 30% uncertainty owing to the restricted Monte Carlo simulation (TPSR [6-1], Section 4.1). A particular concern in the design of any trigger system is that the actual trigger rate, due to unforeseen circumstance, might be higher than the specifications of the system. In such a case, it is good to have a way of controlling the trigger rate in a simple and predictable manner. The LVL2 e/\(\gamma\) trigger provides such a handle in the \(\mathrm{E_{T}}\) cut. Figures 4-23 and 4-24 show the trigger rate as a function of the threshold in \(\mathrm{E_{T}}\) for jets at low and high luminosity, respectively. For example, at high luminosity, in order to decrease the trigger rate by a factor of two, the \(\mathrm{E_{T}}\) threshold has to be increased by 5 GeV. The figure also shows the effect of the shape cuts applied sequentially. The shape cuts alone provide a reduction factor of five to eight in addition to the reduction due to the \(\mathrm{E_{T}}\) cut. However, the \(\mathrm{E_{T}}\) cut provides the best handle since very large reductions can be achieved while maintaining a good efficiency for the interesting very high-\(\mathrm{p_{T}}\) physics. The rate reduction from the \(\mathrm{E_{T}}^{\mathrm{had}}\) cut is small (-0.8), which suggests that this selection may be dropped; this would reduce substantially the data requests to hadronic ROBs.

#### 4.3.3.4 Two-object triggers

The background rates for two-object triggers have also been evaluated. Since there is an object multiplicity requirement of two, the \(\mathrm{E_{T}}\) thresholds can be set lower than for the single-object triggers. However, since the jet samples were generated with \(\mathrm{p_{T}}\) \(>\) 17 GeV and the trigger \(\mathrm{E_{T}}\) thresholds for multi-object triggers are at or below this level, the rates presented here are a lower estimate only. A LVL1 and LVL2 energy threshold of \(\mathrm{E_{T}}\) \(>\) 16 GeV yields a LVL2 rate for two-object triggers of \(15\pm 11\) Hz at high luminosity.

##### 4.3.3.5 Differences in pile-up methods

The two pile-up methods outlined in Section 2.1 yield different rate estimates for equivalent \(\mathrm{e}/\gamma\) efficiencies. For example, after optimising the cuts for 90% efficiency, the pile-up method which takes into account the time structure of the calorimeter signals yields a 10% lower rate than the method used here. At a trigger rate of 5 kHz, the method used here gives an efficiency 1.5% lower than the other method.

### Fine corrections

The LVL2 algorithm is intentionally kept simple. Several fine corrections, which are applied in offline reconstruction (see Ref. [6-2], Sections 4.3 and 4.4), are not used at LVL2, because so far no need for the increased precision has been identified. These corrections are small, \(O\)(1%), and/or depend on particle type. They are functions of \(\eta\), \(\mathrm{E_{T}}\) and of the position of the shower within a cell. To apply these corrections would take little processing time, because they are available as functions or tables, and are applied once per trigger object only.

#### Correction of \(\mathrm{E_{T}}\)

The calibration of the cell energies was discussed in Section 2.4. The cluster energy is corrected for the finite window size. An additional \(\eta\)-dependent correction can be applied to obtain for the lowest trigger threshold an \(\eta\)-independent cluster calibration and thus ensure a sharp threshold.

The total energy resolution at LVL2 is shown in Figure 4-25. The figure shows that \(\sigma/\mathrm{E}\) vs. \(1/(\sqrt{\mathrm{E}})\) follows a straight line for electrons, as expected. A fit to \(\sigma/\mathrm{E}=\mathrm{a}/(\sqrt{\mathrm{E}})+\mathrm{b}\) yields \(\mathrm{a}=(0.10\pm 0.02)\sqrt{(1/(\mathrm{GeV}))}\) and \(\mathrm{b}=(0.3\pm 0.2)\%\) for low luminosity electrons. A slight degradation in resolution is evident at high luminosity.

The following \(\mathrm{E_{T}}\) corrections are not applied and are \(<\)1% if not mentioned differently.

* refined weight factor for the presampler, as function of \(\eta\) and \(\mathrm{E_{T}}\) (the fractional energy loss in the dead material is larger for small energy objects);
* weight factor for the back sampling (since this correction is of no importance for LVL2 due to the fact that the thresholds are significantly below the \(\mathrm{E_{T}}\) values for which the correction matters);
* \(\phi\) correction as function of the cluster position in the cell (to compensate for the imperfect thickness of the absorber);
* dependence on \(\eta\)-position within a cell, as function of \(\eta\) (shower leakage out of the \(\eta\) window); the energy changes by up to 5% from the center of the cell to the cell edge.

#### Correction of the position (\(\eta\), \(\phi\))

The cluster position in \(\eta\) and \(\phi\) is important for the matching of the e.m. cluster to the inner detector track. The measurement of the position as described in Section 4.2.2, could be improved

Figure 4-25: Energy resolution at LVL2 for electrons at low- and high-luminosity. The resolution is shown for electrons with \(|\eta|<0.8\).

by recalculating the position in optimal windows. In the reconstruction several corrections are applied, which are not used at LVL2.

* The measurement of the \(\phi\)-position is (to first order) unaffected by bremsstrahlung in the inner detector. The \(\phi\)-position is measured in the second compartment. There is an offset in the measured \(\phi\)-position, which depends on the depth of the shower and thus on rapidity; no correction is applied for this small deviation of \(<\)1 mrad (see Ref. [6-7], Section 2.5).
* The \(\eta\)-position is also measured in the second compartment. The S-shape correction is not applied (see Ref. [6-7]); it depends on the \(\eta\)-position within the cell. This correction is at most an offset of 0.004 in \(\eta\) and should be applied in future versions of the LVL2 algorithm.
* The \(\eta\)-position is also calculated for the strip compartment, but no use of its value is yet made at LVL2, _e.g._ to compare it with the \(\eta\) from the second sampling.
* The window size could be adapted to the \(\eta\) region, e.g. by choosing larger windows in \(\eta\) in the end-cap. This is connected to the study of thresholds and calibration. Only minor improvements are expected.

## 5 Summary and outlook

The function of the LVL2 e/\(\gamma\) trigger, the pre-selection of trigger objects to be processed by the photon and electron trigger, is achieved with a relatively simple set of cuts for both low and high luminosity. After optimising the cuts at energies close to the threshold, it is found that the electron efficiency is as good or even better at higher \(\mathrm{E_{T}}\).

There are various ways in which the e/\(\gamma\) trigger can still be improved.

* The calibration for LVL2 will be stored in a database, independent from the calibration for reconstruction, though guided by the values for the latter. Parameters for typical trigger thresholds and cell thresholds will be stored. This will allow optimal calibration for LVL2, adapted to the cell threshold and the cluster thresholds applied at LVL2.
* Since e.m. showers leak very little energy into the hadronic calorimeter, only the first sampling of the hadronic calorimeter could be used to extract \(\mathrm{E_{T}}^{\mathrm{had}}\). This will reduce noise and pile-up contributions.
* A detailed study of the e/\(\gamma\) trigger performance should be done in a real physics environment (e.g. \(W\)\(\rightarrow\)\(\mathrm{e}\nu\)) in order to evaluate the effect of the presence of other particles from the signal event on the trigger efficiency.
* Additional rejection from the use of the isolation may be achieved, either by using the isolation ring around the cluster corresponding to about 12 towers, or more efficiently, by requiring that no single deposition in the ring is above a given threshold.
* Finally, a re-evaluation of this performance should be done with another minimum-bias model. The estimation of rates presented here may be pessimistic due to the method used to add minimum bias, which does not take into account calorimeter-signal timing information.

## 6 References

* [1] ATLAS Trigger Performance Status report, CERN/LHCC 98-15, June 1998.
* [2] ATLAS Detector and physics performance technical design report, CERN/LHCC/99-14 and CERN/LHCC/99-15 (May 1999).
* [3] J. Baines _et al._, _Identification of high-\(p_{T}\) electrons by the second level trigger of ATLAS_, ATL-COM-DAQ-99-007 (1999).
* [4] M. Wileers, _Photon identification with the ATLAS detector_, ATL-PHYS-99-016 (Nov 1999).
* [http://www-wisconsin.cern.ch/](http://www-wisconsin.cern.ch/)\(\sim\)atsaul/egamma/data/dice/ ATrig hbook output
* [6] A. Dell'Acqua _et al._, ATLAS note PHYS-NO-102, 1997.
* [7] ATLAS calorimeter performance technical design report, CERN/LHCC/96-40, ATLAS TDR-1, January 1997.
* [8] ATLAS Liquid argon calorimeter technical design report, CERN/LHCC 96-41, December 1996.
* [9] ATLAS level-1 trigger technical design report, CERN/LHCC 98-14, ATLAS TDR-15, June 1998.
* [10] S. Gonzalez _et al._, First Implementation of Calorimeter FEX Algorithms in the Level-2 Reference Software, May 1999, [http://www.cern.ch/Atlas/project/LVL2testbed/www/doc/physics/calo/notes/caloalgo.ps](http://www.cern.ch/Atlas/project/LVL2testbed/www/doc/physics/calo/notes/caloalgo.ps)