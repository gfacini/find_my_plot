###### Abstract

A quantitative description of calibration pulses is made, using measured properties of detector cells, and preamplifiers and shaping amplifier characteristics. The calculations are compared to commissioning data taken with the electromagnetic liquid argon calorimeter installed in the Atlas pit. Using the obtained results, physics pulses are also predicted, and compared to a few selected pulses from cosmic events.

## Introduction

The aim of the work presented in this note, conducted on the ATLAS electromagnetic calorimeter [1], is threefold:

* for this particular channel, with a minimum set of adjustable parameters.
* predict, with the same set of numbers and adjusted parameters the shape of the physics signal expected from energy deposits in the calorimeter.
* predict for each channel the ratio of peak values of calibration and physics signals resulting each from a normalized impulse, in order to correct for the associated systematic effect between calibration and physics.

Different ways of addressing points (2) and (3) are already available in ATLAS [2].

An attempt is also made here to describe, in amplitude and shape, the dominant cross-talk signals observed in calibration.

The note is organised as follows. Section 1 presents the basic assumptions for signal generation and propagation. Section 2 describes the different measurements used in this study. In section 3 are presented some results obtained on a test bench. The cross-talk is discussed in section 4. The commissioning data are analysed in section 5, and the combined test beam data are discussed in section 6.

## 1 Basic assumptions for signal generation and propagation

The analysis presented below is based on the generation in shape and amplitude of a signal, function of time (t) resulting from a pulse produced at the calorimeter, either from the calibration source, or from an energy deposit in the calorimeter body, and processed through the Liquid Argon calorimeter front end electronics (preamplifier, shaping amplifier).

Several attempts to a similar purpose were made already [3], with a limited success due in particular to a too large number of parameters to be fitted from the data, consisting only of calibration signals recorded in a sub-sample of calorimeter channels (modules exposed to test beam).

In order to avoid such a limitation, the approach presented here relies on a set of measurements realized first (either on the bench for preamplifiers and feedthroughs, or on the calorimeter itself using commercial equipment [4]), in order to limit the number of free parameters in the comparison between calculations and recorded signals.

In the following (section 3 to 6) the number of parameters will actually be limited to a maximum of four: the time constant of the shaper \(\tau_{sh}\), the impedance of the cold signal cable \(Z_{S}\), the overall normalisation of the pulse height and the time difference \(\Delta t\) between the measured and predicted pulses. More parameters are needed for cross-talk description.

The fact that \(\tau_{sh}\) and \(Z_{S}\) are "by construction" allowed to vary only in a narrow range provides a useful check of how well the procedure works. Similarly the range of variation of the calculated signal amplitude wrt the measured one should not be larger than what is expectedfor the gain dispersion of the preamplifier and shaper chain.

As usual in this kind of work, the calculations are made in the frequency domain (actually using \(\omega=2\pi\nu\) as the working variable), and at the end, a Fourier transform is made to go to the time domain.

The calculations below follow to a large extend the formulas of [5], with the caveat that the calculations in [5] are made with Laplace transforms.

The simplified electrical scheme used is shown in figure 1.

The initial current pulse i is decomposed in \(\omega\), and each frequency component is propagated forward along the signal cable, being first partially reflected at the feedthrough. The part transmitted by the feedthrough arrives to the preamplifier, where the component transmitted gives rise to the main component of the signal while the reflected part propagates backward. Arriving at the detector, each backward propagating component is again reflected and moves forward toward the preamplifier, producing a "reflected component" and so on. For practical reasons, only components with 2 or less forward+backward (F+B) reflections are kept (ie 4 reflections in total). It was verified that already the "double reflection" is in all practical cases a small correction to the single (F+B) reflection.

The reflections internal to the calorimeter cell, along the electrode strip are not taken into account here. Given the length of the cell they would be in general of too high frequency to give a visible effect after the amplifier and shaper. The effect of such oscillations may be relevant for accurate timing studies, not considered here [6].

The signal path on the mother board is a short section of transmission line designed to be of the same impedance as the signal cable [7]. In the following it is considered as part of the signal cable, although this is only an approximation when either the mother board line, or the signal line differ from nominal. As opposed to this, the signal path along the summing board was designed to act as a fixed inductance, independent of its length-directly related to the azimuthal position of a cell in a module, and could not be at the same time of fixed impedance. In reality a small dependance of \(L_{SB}\) on the azimuth remains, for middle and back cells, and is

Figure 1: _Electrical scheme._

taken into account in the calculation (typically \(L_{SB}\) varies from 13 to 15 nH). The capacitance C\({}_{SB}\) and inductance L\({}_{SB}\) of the summing boards are thus treated as local impedances and participate, together with the detector proper, to the calorimeter cell impedance (see 1.1).

Calculations are done with real numbers, taking care of the modulus \(H(\omega)\) and phase \(\Phi(\omega)\) of the current components separately.

At the end, when making the final Fourier transform to get the signal in the time domain, the quantity of relevance (because the signal in the time domain is real) is the even part of the signal in the frequency domain, namely H\((\omega)cos(\phi(\omega)+\omega t)\).

Given the numerical values involved in the problem, and in particular the time constant of the shaping amplifier, the range in frequency was limited to 50 MHz, having verified that extending it further (with a fixed \(\Delta\nu\)-see below) did not change the result. An important other parameter is the size \(\Delta\nu\) of the bins in \(\nu\). It was found that steps larger than 10 kHz were affecting the precision of the results, and this value of \(\Delta\nu\)=10 kHz or smaller was kept all along.

### Detector Impedance and resonance frequency

The detector impedance Z\({}_{D}\), considered as local, corresponds to what is on the left of point D in figure 1. Beside calculations of detector capacitance C\({}_{D}\) and inductance L\({}_{D}\), and bench measurements of summing board inductance and capacitance, this impedance Z\({}_{D}\) was probed globally (see section 2.3) by scanning in frequency at the feedthrough output and looking for the resonance frequency \(\nu_{0}\) channel by channel [4].

The measurement of \(\nu_{0}=\omega_{0}/(2\pi)\) allows to get L\({}_{D}\) once the other parameters are known from bench measurements (C\({}_{SB}\), L\({}_{SB}\)) or calculations (C\({}_{D}\)).

In the simplifying case where the resistances r\({}_{SB}\) and r\({}_{D}\) associated to L\({}_{SB}\) and L\({}_{D}\) are neglected the relation reads:

\[L_{D}=\frac{1-L_{SB}(C_{D}+C_{SB})\omega_{0}^{2}}{C_{D}\omega_{0}^{2}(1-L_{SB} C_{SB}\omega_{0}^{2})} \tag{1}\]

This value of the inductance is larger, (by about \(C_{SB}/C_{D}\)) than what one gets assuming -as was done usually in previous analyses - that the two capacitances just add - up as well as the two inductances, in which case

\[L_{D}=\frac{1-L_{SB}(C_{D}+C_{SB})\omega_{0}^{2}}{(C_{D}+C_{SB})\omega_{0}^{2}} \tag{2}\]

### Propagation along calibration and signal lines

Propagation along lines (calibration, signal, feedthroughs) appears as a phase shift combined with some attenuation. The relevant constants are the speed of signal propagation (assumed independent of \(\omega\)), and the skin effect constant (function of \(\omega\)).

In the central conductor of a coaxial cable of radius r, electrical conductivity \(\sigma\), and vacuum permeability \(\mu\), the skin effect constant is equal to K=1/(2\(\,\pi\)r)\(\sqrt{(\mu/\sigma)}\)[8]. The associated modulus and phase are given by:

\[H_{\mathit{line}}(\omega) = \exp\left[-\frac{KL}{2Z}\sqrt{\frac{\omega}{2}}\right]=\exp(-R_{ SE}/2Z) \tag{3}\] \[\Phi_{\mathit{line}}(\omega) = -\frac{KL}{2Z}\sqrt{\frac{\omega}{2}}-\omega\ L/\mathit{v}_{ \mathit{line}} \tag{4}\]

Where L and Z are the length and characteristic impedance of the cable respectively, \(\mathit{v}_{\mathit{line}}\) being the propagation speed.

The constant K can be calculated from the geometric parameters of the line and the copper resistance (linear function of absolute temperature T). As a further check, the propagation characteristics (attenuation, phase shift) of a given length of cable (about 4 m) were measured using a network analyser which gives as a function of frequency the amplitude and phase shift at the cable end for a normalized cosine wave at the input. For illustration, the amplitude at the output of a 50\(\Omega\) cable at liquid nitrogen temperature is shown in figure 3. It exhibits the expected \(\sqrt{\omega}\) behaviour. The constant found after correction for a short section of the cable at room temperature (0.162 /m\(\sqrt{\mathrm{MHz}}\)) is however significantly larger (about a factor 2) than expected from application of the formula to the internal conductor only. A similar effect, although with a smaller ratio (\(\simeq 1.5\)), is found for the 25\(\Omega\) cable. The occurrence of a \(\sqrt{\omega}\) term in the phase was checked by comparing the frequencies at which the phase reaches \(-\pi\) and then \(-3\pi\), and a good correspondence with the absorptive term found. The term linear in \(\omega\) was used to calculate the speed.

### Calibration pulse

As documented in [9], the calibration signal consists of the superposition of a constant step (of amplitude \(F_{\mathit{step}}\)) and of an exponentially decaying step, of amplitude \(1-F_{\mathit{step}}\), and time constant \(T_{\mathit{cali}}\).

Figure 2: _Electrical scheme for equation (1)._

It is injected at point C on the electric diagram on Fig. 1. The description of this simple case can be written as

\[H_{cali}^{0} = \frac{1}{\omega}\sqrt{\frac{F_{step}^{2}+(\omega\ T_{cali})^{2}}{1+ (\omega\ T_{cali})^{2}}} \tag{5}\] \[\Phi_{cali}^{0} = \arctan(\frac{\omega\ T_{cali}}{F_{step}})-\arctan(\omega\ T_{cali })-\frac{\pi}{2} \tag{6}\]

This simple description corresponds to the ideal case when the calibration signal is terminated on its characteristic impedance at both ends, and when the perturbation introduced by the feedthrough is neglected. When the receiving end impedance (\(R_{T}\)) is not identical to the calibration cable impedance, or because of the low impedance of the feedthrough, a reflected pulse is generated which propagates back toward the calibration board. At this emitting end, the impedance is not exactly 50\(\Omega\) since the physical resistance (\(R_{C}\)=50 \(\Omega\) with a 0.1% accuracy) is actually in parallel with the calibration circuit impedance \(L_{self}\simeq 11.5\mu H\), a not so large impedance for the frequency range of interest (750 \(\Omega\) at 10 MHz). Multiple reflections can occur if the termination resistance \(R_{T}\) is different from the calibration cable impedance \(\mathbb{Z}_{C}\), and the calibration board impedance. The effect of a non ideal termination has been investigated in this study. Starting from Eqs. 5 and 6 one has to add the following terms:

\[H_{cali} = H_{cali}^{0}(\frac{2R_{T}}{R_{T}+R_{C}})\frac{1}{\sqrt{D_{1}^{2}+ D_{2}^{2}}} \tag{7}\] \[\Phi_{cali} = \Phi_{cali}^{0}-\arctan(\frac{D_{2}}{D_{1}}) \tag{8}\]

with:

\[D_{2} = 1-(\frac{R_{T}-R_{C}}{R_{T}+R_{C}})\frac{\sqrt{(Re[Z_{ter}]-R_{C} )^{2}+Im[Z_{ter}]^{2}}}{\sqrt{(Re[Z_{ter}]+R_{C})^{2}+Im[Z_{ter}]^{2}}})\.(H_{line}^{C})^{2}. \cos(\Phi_{D}) \tag{9}\]

Figure 3: _Ratio of output to input amplitude measured as a function of frequency at liquid nitrogen temperature (Axon cable 50\(\Omega\), 4m long)_

\[D_{1} = -(\frac{R_{T}-R_{C}}{R_{T}+R_{C}})\frac{\sqrt{(Re[Z_{ter}]-R_{C})^{2}+ Im[Z_{ter}]^{2}}}{\sqrt{(Re[Z_{ter}]+R_{C})^{2}+Im[Z_{ter}]^{2}}})\.(H_{line}^{C})^{2}\.\sin(\Phi_{D}) \tag{10}\] \[\Phi_{D} = \arctan(\frac{Im[Z_{ter}]}{Re[Z_{ter}]-R_{C}})-\arctan(\frac{Im[Z_ {ter}]}{Re[Z_{ter}]+R_{C}})-2\omega\ L_{C}/v_{line}+2\Phi_{line}^{c} \tag{11}\]

where the \(2\omega\ L_{C}/v_{line}\) term takes into account an additionnal shift for propagation along the calibration cables, and :

\[|Z_{ter}|^{2} = \frac{(R_{self}\ R_{C})^{2}+(R_{C}\ L_{self}\ \ \omega)^{2}}{(R_{ self}+R_{C})^{2}+(L_{self}\ \ \omega)^{2}} \tag{12}\] \[\Phi(Z_{ter}) = \arctan(\frac{L_{self}\ \omega}{R_{self}})-\arctan(\frac{L_{ self}\ \omega}{R_{self}+R_{C}}) \tag{13}\]

In this case \(T_{cali}\) is no longer a free input but a value correlated with \(L_{self}\), \(R_{self}\) (the internal resistance of the calibration inductance) and the apparent termination resistance built from \(R_{C}\) and \(R_{T}\) in parallel:

\[T_{cali}=\frac{L_{self}}{R_{self}+\frac{R_{C}\ R_{T}}{(R_{C}+R_{T})}} \tag{14}\]

It is to be remarked at this point that an improper termination (\(R_{T}\neq R_{C}\)) affects the normalisation of the calibration pulse at point D because of the factor \(2R_{T}/(R_{T}+R_{C})\).

### Signal fraction sampled by the current preamplifier

If a current component i(\(\omega\)) flows from the calibration source (see figure 1) only its component i\({}_{1}(\omega)\) will propagate in the signal cable in the direction of the preamplifier, the other two components (i\({}_{2a}\) and i\({}_{2b}\)) being absorbed to ground locally in the detector and summing board.

The ratio i\({}_{1}\)/i, called \(H_{det}\), with a phase \(\Phi_{det}\) is one of the main components of the final Fourier amplitude.

The calculation is shown below, with \(\tau_{R}=r_{D}C_{D}\) and \(\tau_{R}^{SB}=r_{SB}C_{SB}\), \(\omega_{0}^{SB}=1./\sqrt{L_{SB}C_{SB}}\). The detector circuit is damped by the internal resistances (r\({}_{D}\), r\({}_{SB}\)) as well as by the preamplifier

Figure 4: _Electrical scheme for equation (14)._

input impedance, seen through the - rather long - signal output cable. As documented in [8], for high frequencies, the detector sees more the signal line impedance, while at low frequency, the preamplifier impedance would be the relevant one. Given this uncertainty, we tried both on a representative set of \(50\Omega\) and \(25\Omega\) channels, and decided to use the signal cable impedance, as it gave a more uniform normalisation between the two sets. In both cases the impedance was augmented by R\({}_{SE}/2\) (see section 1.2), in order to take into account the skin effect in both the signal cable and the feedthrough. We have thus in the following:

\[Zline_{eff}=Z_{S}+0.5(R_{SE}^{signal\ line}+R_{SE}^{feedthrough}). \tag{15}\]

\[H_{det} = \frac{|Z_{det}|}{\sqrt{(Zline_{eff}+Re[Z_{det}])^{2}+(Im[Z_{det}] )^{2}}} \tag{16}\] \[\Phi_{det} = \arctan(\frac{T_{4}}{T_{3}})-\arctan(\frac{T_{2}}{T_{1}})-\arctan (\frac{Im[Z_{det}]}{Zline_{eff}+Re[Z_{det}]}) \tag{17}\]

with:

\[T_{1} = \omega\left(C_{D}-C_{SB}(\frac{\omega^{2}}{\omega_{0}^{2}}-1)\right) \tag{18}\] \[T_{2} = \tau_{R}\ C_{SB}\ \omega^{2}\] (19) \[T_{3} = r_{SB}\ T_{1}+\tau_{R}\ \omega\ (1.-(\frac{\omega}{\omega_{0}^{SB}}) ^{2})\] (20) \[T_{4} = (\frac{\omega}{\omega_{0}})^{2}-1+\tau_{R}\ \tau_{R}^{SB}\ \omega^{2}+L_{SB}\ C_{D}\ \omega^{2}\ (\frac{\omega}{\omega_{0}^{SB}})^{2}\ (\frac{\omega^{2}}{ \omega_{0}^{2}}-1)\] (21) \[Z_{det} = \frac{\sqrt{T_{3}^{2}+T_{4}^{2}}}{\sqrt{T_{1}^{2}+T_{2}^{2}}}\exp \left(i(\arctan(\frac{T_{4}}{T_{3}})-\arctan(\frac{T_{2}}{T_{1}}))\right) \tag{22}\]

\(|Z_{det}|\). \(Re[Z_{det}]\), and \(Im[Z_{det}]\) are respectively the modulus, the real and the imaginary part of the detector impedance Z\({}_{D}\).

### Reflection/transmission at the feedthrough

In order to save in design, test, and production money it was decided early in the Atlas Liquid Argon calorimeter project to make a single type of feedthrough to be used both with the middle and back cells (nominal signal cable impedance \(Z_{S}\) of \(25\Omega\)) and front and presampler cells (nominal impedance \(Z_{S}\) of \(50\Omega\)), as well as for calibration (\(50\Omega\)).

This means a rupture of impedance for both types, and thus a first reflection at this transition. The critical parameters are the feedthrough impedance (\(Z_{FT}\)), length (L), attenuation (K) and the propagation speed (\(v_{line}\)). Actual values and bench measurements are discussed in section 2.4.

To be specific, a wave propagating forward on a transmission line of impedance \(Z_{1}\), and arriving on a second line of impedance \(Z_{2}\) (or on a local impedance \(Z_{2}\)) undergoes a reflection such that:

\[\begin{array}{lclcl}\mbox{Transmitted voltage}&V_{2}&=&V_{1}(1+R)\\ \mbox{Transmitted current}&I_{2}&=&I_{1}(1-R)\\ \mbox{Reflected voltage}&V_{1}^{\prime}&=&V_{1}R\\ \mbox{Reflected current}&I_{1}^{\prime}&=&I_{1}R\end{array} \tag{23}\]with

\[R=\frac{Z_{2}-Z_{1}}{Z_{2}+Z_{1}} \tag{24}\]

one verifies that \(V_{2}/I_{2}=Z_{2}\) and \(V_{1}^{\prime}/I_{1}^{\prime}=Z_{1}\) when \(V_{1}/I_{1}=Z_{1}\), the transmitted power being \(V_{1}I_{1}(1-R^{2})\) and the reflected power \(V_{1}I_{1}R^{2}\). For a signal going backwards at the same transition point, the sign of R changes.

The important element at this stage is the value of the reflection coefficient (\(H_{R1}\)) given from \(Z_{S}\) and \(Z_{FT}\) using relation (24). The main transmitted current component is then to be multiplied by the transmission coefficient (\(1-H_{R1}\)).

Given the relatively high absorption in the feedthrough [10], some calculation tests were made using an impedance depending on \(\omega\), and having an imaginary component, but no concrete improvement could be obtained, and in the end, the code used for the results presented below uses only a real impedance, independent of \(\omega\).

### Reflection/transmission at the preamplifier

The transmitted component just discussed above arrives then on the local preamplifier input impedance, in general different from \(Z_{FT}\). The transmitted component of the current gives rise to the measured signal. It is obtained by further multiplying by \(H_{trans}(\omega)\) the other factors already discussed, and adding as well a phase shift \(\Phi_{trans}\). Like above \(H_{trans}=1-R_{PA}^{FT}\) where \(R_{PA}^{FT}\) is the reflection coefficient at the feedthrough to preamplifier transition, obtained from Eq 24.

Unlike above, the preamplifier input impedance is a strong function of \(\omega\), and its imaginary part cannot be neglected.

### Preamplifier and shaper transfer function

The preamplifier transfer functions were supposed to be flat in the frequency region of interest, given the rest of the chain (shaping amplifier in particular). Measurements (see section 2.1) made for the purpose of the present work showed that while this is rather the case for the 25\(\Omega\) preamplifiers, this is not the case for the 50\(\Omega\) type. A transfer function \(H_{PA}\) and a phase \(\Phi_{PA}\) were introduced to take account of the actual values, obtained from measurements.

A technical difficulty arose at this point, which is considered in Appendix 1.

The shaping amplifier [11], of the \(CR-RC^{2}\) type, has a well known transfer function which depends on one parameter: the shaper time constant \(\tau_{sh}\). This function reads:

\[H_{shp} = \frac{\omega\tau_{sh}}{(1+(\omega\tau_{sh})^{2})^{3/2}} \tag{25}\] \[\Phi_{shp} = \pi/2-3\arctan(\omega\tau_{sh}) \tag{26}\]

Another remark is in order here. Given the transfer functions of the preamplifier and of the shaper, the output signal (see more details below) is proportional to the first derivative of the injected current. This means that the integral (net area) of the output signal is proportional to the difference of the current before the pulse is emitted, and at the end of it. This difference is zero for the exponential part, if one waits long enough for the exponential to fully decay away, meaning a null area for the corresponding part of the pulse. The same thing applies to the physics signal (see section 1.16) which also decays to zero. This null area result does not however applies to the fraction of the calibration signal corresponding to \(F_{step}\), for which the generated impulse remains constant for ever. As a consequence the area of the signal generated by our calibration system is non-zero, and its value depends directly on \(F_{step}\).

### Directly transmitted component

Taking into account all the factors described above, one obtains the expression of the main component of the signal at the output of the shaper.

Its direct amplitude and phase are given by:

\[H_{tot} = H_{line}^{FT}\cdot H_{line}^{C}\cdot H_{cali}\cdot H_{det}\cdot H _{line}^{S}\cdot H_{line}^{FT}\cdot(1-H_{R1}).\ H_{trans}\cdot H_{PA}\cdot H_{ ship} \tag{27}\] \[\Phi_{tot} = 2\ \Phi_{line}^{FT}+\Phi_{line}^{e}+\Phi_{cali}+\Phi_{det}+\Phi_ {line}^{S}+\Phi_{trans}+\Phi_{PA}+\Phi_{shp} \tag{28}\]

Those equations reflects the way the signal propagates through the whole electronics chain. After going through the feedthrough (\(H_{line}^{FT}\)) and the calibration cable (\(H_{line}^{C}\)), the injected calibration signal (\(H_{cali}\)) arrives on the detector (\(H_{det}\)) before continuing into the signal cable (\(H_{line}^{S}\)). Only a fraction of it (\(1-H_{R1}\)) passes through the feedthrough (\(H_{line}^{FT}\)). At the end of the chain, the fraction not reflected (\(H_{trans}\)) at the preamplifier (\(H_{PA}\)) arrives on the shaper (\(H_{shp}\)).

### Back reflections at the detector

The signals reflected at the signal cable-feedthrough transition, or at the feedthrough-preamplifier transition travel backwards and eventually reach the detector where they are reflected once more, and move forward again, like the main signal, but with some delay and a spectral function (\(\omega\)) modified with respect to H(\(\omega\)) by the frequency dependence of the transmission or reflection coefficients.

This is in particular the case for the reflection at the detector. At low frequency, being capacitance dominated it appears as an open circuit, and the reflection coefficient is equal to 1 Instead, when the frequency reaches the resonant frequency \(\nu_{0}\), the detector appears as a short circuit, and the reflection coefficient is equal to -1.

This behaviour is included in the functions \(H_{refl}\) and \(\Phi_{refl}\) calculated from Eq. 24 with \(Z_{2}\) = \(Z_{det}\) and \(Z_{1}\) = \(Z_{S}\).

A typical behaviour of a middle cell detector impedance \(Z_{det}\) and the associated reflection coefficient from a \(Z_{S}\) = 25\(\Omega\) cable are shown in figure 5. One can remark at this point (see also next section) that the variation with \(\omega\) of the phase of the reflection coefficient induces an apparent delay of the pulse reflected at the detector, which adds up to the "real" propagation time back and forth along the signal cable. As a comparison the phase is shown on figure 6 in the case of a low capacitance detector (front cell) and a 50\(\Omega\) signal cable. Replacing this actual phase by 0 advances the reflected pulse by about 20 ns.

### Overall H(\(\omega\)), including reflection up to second order

There are 3 terms with reflection of the first order. If we call (1) the transition between signal cable and feedthrough, (2) the transition between feedthrough and preamplifier, and (D) the transition between signal cable and detector, these 3 terms called \(H_{1D}(\omega)\), \(H_{21}(\omega)\) and \(H_{2D}(\omega)\) correspond respectively to a reflection at the feedthrough, and back on the detector, at the preamplifier, and back at the detector, and at the preamplifier and back at the feedthrough (see figure 1). The different contributions can be written as:

\[H_{1D} = H_{tot}\.\ H_{R1}\.\ H_{refl}\.\ (H_{line}^{S})^{2} \tag{29}\] \[\Phi_{1D} = \Phi_{tot}+\Phi_{refl}+2\Phi_{line}^{S}\] (30) \[H_{21} = H_{tot}\.\ H_{PA}^{FT}\.\ (-H_{R1})\.\ (H_{line}^{FT})^{2}\] (31) \[\Phi_{21} = \Phi_{tot}+\Phi_{PA}^{FT}+2\Phi_{line}^{FT}\] (32) \[H_{2D} = H_{tot}\.\ H_{refl}^{FT}\.\ H_{refl}\.\ (H_{line}^{S})^{2}\.\ (H_{line}^{FT})^{2}\.\ H_{T1}\] (33) \[\Phi_{2D} = \Phi_{tot}+\Phi_{refl}+2\Phi_{line}^{S}+\Phi_{PA}^{FT}+2\Phi_{line} ^{FT} \tag{34}\]

where \(H_{T1}=(1-H_{R1}^{2})\).

Proceeding in the same way, there are 9 terms contributing to the reflections of the second order (see Appendix 2).

### Signal as a function of time

The Fourier transform being linear, the signal in the time domain was calculated separately for the directly transmitted signal, the signal consisting of reflections of first order, and the signal

Figure 5: _Impedance (modulus and phase) and reflection coefficient (modulus and phase) as a function of frequency (MHz). Detector cell parameters: C\({}_{D}\) = 1.5 nF, \(\nu_{0}\) = 26.6 MHz, r = 0.2\(\Omega\)._

consisting of reflections of the second order. Examining visually each of these components was helpful in describing the data.

In a first approach, the signal at time t is calculated by summing up in \(\omega\) the function \(H_{tot}(\omega)\cos[\Phi_{tot}(\omega)+\omega t]\). As an illustration, figure 7 shows the direct, the first and the second order reflections for a typical case. The double peak structure of the single reflection component is easily understood looking at figure 8 in which the 3 components coming from \(H_{1D}\), \(H_{2D}\) and \(H_{21}\) are plotted. \(H_{21}\) comes earlier because of the shorter path of the reflected part, and \(H_{2D}\) and \(H_{1D}\), of opposite sign, largely cancel leaving a net positive component about three times larger than \(H_{21}\).

With bins of less than 10 kHZ, a frequency range from 0 up to 50 MHz, and 800 bins of 1ns in time, the procedure which consists for each value of t, in calculating a sum in \(\omega\) by bins of \(\Delta\omega\), is rather time consuming. In order to save in computing time, and for having a fast feedback when iterating on the parameters for a best possible description, a version using a Fast Fourier transform FFTW (Fastest Fourier Transform in the West) [12] was implemented. This C routine library allows computing the discrete Fourier transforms of complex data. The input data, namely \(H_{tot}\) (real and imaginary parts) is given in \(\omega\) bins. The output data is then obtained per time bins. Only the real part is kept.

### Normalisation

No attempt was made to calculate the absolute normalisation of a given signal function of time, starting from the DAC value. By convention, the maximum height of the primarily generated calibration or physics pulse as a function of \(\omega\) is taken equal to 1. However following the normalisation (height of the peak) when one changes a given parameter provides interesting constraints. The output of two channels pulsed with the same DAC value and having the same calibration resistance value should be equal if their preamp and shaper have the same

Figure 6: _Phase of the reflection coefficient as a function of frequency (MHz), for a low capacitance cell._

gain, and if all their other parameters are equal. In practice it is known that within a subset of preamplifier types (50\(\Omega\), 25\(\Omega\)-10 mA, 25\(\Omega\)-5mA) the gain dispersion has an rms of a few %. Any other variation, like due to a different value of capacitance, or inductance, or any other electrical parameter of the channel should be accounted for by the calculation. This means that for a subset of channels as defined above the ratio of measured amplitude to calculated amplitude (including DAC value and calibration resistance value) should not have a dispersion larger than a few %, and should not present a measurable trend as a function of capacitance, or inductance,... Taking into account the DAC values used during the acquisition of the pulses and the nominal values of the calibration resistances (see Section 2.6) also allows to compare the calculated normalisation of middle, front and presampler cells. The same should apply when, for a given channel, one goes from warm to cold conditions, a change to which is associated a change of cell capacitance, and attenuation along cold cables. In practice (see sections 1.5, 1.6, 1.7), it was found that this factorization does not always work perfectly.

Practical use of the normalisation constraint will be found in the following sections.

### Capacitive cross-talk at the detector

Up to now it has been assumed that each detector cell communicates with a single low impedance device only (the preamplifier) through the associated signal cable. In reality a given detector cell can communicate with its neighbours via a local coupling (cross-talk) and thus indirectly with another low impedance device (the neighbour preamplifier).

Care was taken in the design of the detector to minimize cross-talk, but unavoidably some unwanted couplings remain. The largest ones are between neighbouring narrow strips of the front section, for which the capacitance between neighbours (or cross-talk capacitance) is not negligible with respect to the capacitance to ground (see Ref [13]).

Figure 7: _Signal directly transmitted (light blue), first reflection (pink), second reflection (yellow) and total (dark blue) (\(C_{D}=1.5\)nF, \(Z_{S}=25\Omega\), \(Z_{FT}=42\,\Omega\), \(\tau_{sh}=12\)ns, signal cable length: 3m, and \(Z_{pa}\) as in figure 14)._

In this case the signal (physics or calibration) splits up between a main component to the directly connected preamplifier and two components capacitively coupled to the neighbour left and right preamplifiers (see figure 9). This extra element on the line (the cross-talk capacitance \(C_{X}\)) introduces to first order a derivative - or a multiplication by \(\omega\) - on the part of the signal going to neighbour preamplifiers.

Knowing the size of the coupling (given by \(C_{X}\)) one calculates like before cross-talk signals in the frequency domain by introducing a "modified" calibration signal. The calculation actually gives i'\({}_{1}\)/\({}_{11}(\omega)\) referring to notations of figure 9, this ratio being then multiplied by Hcali, with the corresponding operation for the phase.

For the capacitive cross talk through \(C_{X}\), the main calibration function of Eqs. 7 and 8 turn to:

\[H^{C}_{cali} = \frac{H_{cali}}{\sqrt{(1+Re[Z_{cross}])^{2}+Im[Z_{cross}]^{2}}}. \ H_{refl} \tag{35}\] \[\Phi^{C}_{cali} = \Phi_{cali}-\arctan\frac{Im[Z_{cross}]}{1+Re[Z_{cross}]}+\ \Phi_{ refl} \tag{36}\]

where \(H_{refl}\) and \(\Phi_{refl}\) correspond to the reflexion on the detector (cf. section 1.9), and with:

\[|Z_{cross}| = \frac{\sqrt{(Re[Z_{pa}]_{R}+Re[Z_{det}])^{2}+(Im[Z_{pa}]_{R}+Im[Z_ {det}])^{2}}}{|Z_{pa}|_{R}\.\ |Z_{det}|\.\ C_{X}\.\ \omega} \tag{37}\] \[\Phi_{cross} = \arctan\left(\frac{Im[Z_{pa}]_{R}+Im[Z_{det}]}{Re[Z_{pa}]_{R}+Re[ Z_{det}]}\right)-\Phi(Z_{pa})_{R}-\Phi(Z_{det})-\frac{\pi}{2} \tag{38}\]

where \([Z_{pa}]_{R}\) is the preamplifier impedance as seen at the end of the signal cable, ans calculated using the general formula:

\[Z_{R} = \frac{Z+iZ_{c}\tan(\omega\tau_{D})}{1+i\frac{Z}{Z_{c}}\tan(\omega \tau_{D})} \tag{39}\]

Figure 8: _Signal directly transmitted (dark blue) and first reflection (pink) with the three components of the first reflection \(H_{21}\) (yellow), \(H_{1D}\) (green) and \(H_{2D}\) (light blue) (same parameter as in figure 7)._

This being done, the cross-talk contribution above (times two corresponding to the contributions of the two first neighbours) can be subtracted from the direct signal as calculated in previous sections, giving thus the modified main signal in the presence of cross-talk. It is important to remark that the magnitude of the cross-talk contribution relative to the main component is given by the calculation (based on the value of \(C_{X}\) and to a lesser extend of the other parameters) making the comparison with data in both magnitude and shape rich of information.

Another approach, actually followed for the front calorimeter section, see below, is to "regenerate" the calibration pulse in the absence of cross-talk, by adding together the main pulse, and its neighbours, or pulsing all channels simultaneously.

### Capacitive cross-talk near the preamplifier

While the largest cross-talk contributions encountered in the following are of the type discussed in section 1.13, namely capacitive coupling inside the detector part, another type of capacitive cross-talk was identified as taking place near the preamplifier, most likely in the AMP connector of the crate base-plane (see Appendix 3). This is the case for the next-to-next neighbours of a cell in the front part of the calorimeter.

In this situation (see Fig. 10) the transmitted current component i3 splits in more or less two equal parts, as on one side is located the preamplifier, and on the other the signal cable, of similar impedances.

The component \(i^{\prime}_{2}\) going towards the detector on figure 10 is reflected there, with a reflection coefficient close to 1 for all frequencies in the case of the low capacitance strips, giving rise to a pulse of similar magnitude as the one generated by \(i^{\prime}_{1}\), but delayed by twice the transit time along the signal cable and the feedthrough.

Figure 9: _Capacitive cross-talk at the detector._

This particular "twin" signal is taken care of by the approximate formulas as shown below:

\[H^{P}_{cali} = |H^{P_{1}}_{cali}\,\exp\left[i\,\Phi^{P_{1}}_{cali}\right]\ +\ H^{P_{2}}_{cali}\,\exp\left[i\,\Phi^{P_{2}}_{ cali}\right]| \tag{40}\] \[\Phi^{P}_{cali} = \Phi(H^{P_{1}}_{cali}\,\exp\left[i\,\Phi^{P_{1}}_{cali}\right]\ +\ H^{P_{2}}_{cali}\,\exp\left[i\,\Phi^{P_{2}}_{ cali}\right])\] (41) \[H^{P_{1}}_{cali} = \frac{H_{cali}\,\,\,\omega\,\,\tau_{x}}{\sqrt{4+\omega^{2}\tau_{x }^{2}}}\] (42) \[\Phi^{P_{1}}_{cali} = \Phi_{cali}+\frac{\pi}{2}-\arctan(\frac{\omega\tau_{x}}{2})\] (43) \[H^{P_{2}}_{cali} = H^{P_{1}}_{cali}\ H_{refl}\] (44) \[\Phi^{P_{2}}_{cali} = \Phi^{P_{1}}_{cali}+\Phi_{refl}-2\omega\tau_{D}-2\omega\tau_{FT} \tag{45}\]

with

\[\tau_{x}=Zline_{eff}\.\ C_{X2} \tag{46}\]

### Inductive cross-talk

If the current component i1 (see Fig. 11) is coupled by a mutual inductance\(M_{X}\) to the line going to a neighbour preamplifier a signal will appear on this neighbour preamp.

For the coupling by mutual inductance, \(H_{cali}\) and \(\Phi_{cali}\) are modified like:

\[H^{I}_{cali} = \frac{H_{cali}\,\,M_{X}\,\,\omega^{2}\,\,C_{D}}{\sqrt{(F_{pole}- \omega C_{D}Im[Z_{ind}])^{2}+(\omega C_{D}(r_{D}+Re[Z_{ind}]))^{2}}} \tag{47}\] \[\Phi^{I}_{cali} = \Phi_{cali}-\arctan(\frac{\omega C_{D}(r_{D}+Re[Z_{ind}])}{F_{ pole}-\omega C_{D}Im[Z_{ind}]}) \tag{48}\]

where \(Z_{ind}\) is the preamplifier impedance at the end of the signal cable seen from the place where the mutual coupling takes place.

Figure 10: _Capacitive cross-talk near the preamplifier._

\[F_{pole} = 1-\frac{\omega^{2}}{\omega_{0}^{2}} \tag{49}\]

If the coupling is along the other part of the calibration current path (namely to the detector side where \(i_{2}\) flows), the formula is different. See comparison with data, later in the text for further details.

### Physics signal

As it is well known, the current from a "physics" signal in a parallel plate detector has a triangular shape for uniform ionisation across the gap. Two modifications to this simple approach are however necessary.

First, in the case of the "accordion" geometry, the part of the gaps in the bends sees a lower field, to which corresponds a triangle with a longer base. Detailed simulations [14] have shown that the actual signal can be represented by the sum of two triangles, with the amplitude at t=0 and the length of the base being respectively: (0.93, 0.07) and (0.469\(\mu\)s, 0.921 \(\mu\)s). For completeness, this is shown in figure 12. Those values are given for a 2000V signal. If the voltage is reduced to 1600V, the drift times are increased by a factor 1.076. For the presampler,built out of parallel plate electrodes with a mean gap of 1.95mm,a single triangle with a base of 0.457\(\mu\)s was used.

Second, using calculated shapes, including bends as described above, it was furthermore found (see section 5.3.2) that real signals often show a longer and shallower tail than the calculation. Several sources for such a discrepancy were investigated. An effect resulting from the non-ideal centring of the readout electrode in between the absorbers [1] seems to reproduce

Figure 11: _Inductive cross-talk schematics_.

reasonably well the observed shape (see section 5.3.2). This effect applies also to the presampler.

In the case where the readout electrode is off-centred by a fraction \(x\) of the gap \(d\), the current at \(t=0\) in the gap of width \(d(1-x)\) is

\[I_{0}=I^{nom}(1+x/3) \tag{50}\]

and the drift time is

\[T_{D}=T_{D}^{nom}(1-4x/3). \tag{51}\]

Where _nom_ applies to \(x=0\), and where a drift speed dependence on the field like \(E^{1/3}\) is being used, together with the assumption that \(x<<1\). Assuming a full anticorrelation between the two half gaps, namely one has a with \(d(1-x)\) when the other one has a with \(d(1+x)\), one obtains the two contributions to the current as shown in figure 13. Their sum displays a main triangle, followed by a second one extending beyond \(T_{D}^{nom}\).

Given the accuracy of the electrode centring, defined by the difference between the nominal gap and the honeycomb thickness [1], one can expect \(x\) values up to \(\sim\)0.15. It is important to note that the effect does not depend upon the sign of \(x\), meaning that an electrode floating between values of say between +0.15 and -0.15 induces a response corresponding to a non zero value of \(x\) (presumably around 0.075).

In order to calculate the induced signal after the shaping amplifier, one has to:

* replace \(H_{edi}\) and \(\Phi_{cali}\) by the formulas corresponding to the triangular shape above.
* replace the signal fraction sampled by the preamplifier by new formulas corresponding to a sharing of the signal current different for physics and calibration (see figure 1): \(H_{det}\) and \(\Phi_{det}\) are different.
* replace \(H_{tot}\) and \(\Phi_{tot}\) by the correct formula taken into account the electronics chain viewed by the physics signal injected in the detector \[H_{tot} = H_{cali}\.\ H_{det}\.\ H_{line}^{S}\.\ H_{line}^{FT}\.\ (1-H_{R1}).\ H_{trans}\.\ H_{PA}\.\ H_{ship}\] (52)

Figure 12: _Physics signal in the detector [courtesy G. Unal]._

\[\Phi_{tot} = \Phi_{cali}+\Phi_{det}+\Phi_{line}^{S}+\Phi_{line}^{FT}+\Phi_{trans}+ \Phi_{PA}+\Phi_{shp} \tag{53}\]

The equivalent of the formulas in section 1.4 now read:

\[H_{det} = \frac{1}{\sqrt{(M_{2})^{2}+(M_{4})^{2}}} \tag{54}\] \[\Phi_{det} = -\arctan(\frac{M_{4}}{M_{2}}) \tag{55}\]

with:

\[M_{2} = 1-C_{D}\ \omega(r_{D}+L_{D}\ \omega+M_{3}\.\ M_{1})-C_{SB}\ \omega\ \ M_{3} \tag{56}\] \[M_{4} = C_{D}\ \omega\ \tilde{Zline}_{eff}\ M_{1}+C_{SB}\ \omega\ \tilde{Zline}_{eff} \tag{57}\]

and:

\[M_{1} = 1-L_{D}\ C_{SB}\ \omega^{2} \tag{58}\] \[M_{3} = r_{SB}+L_{SB}\ \omega+Im[Z_{pa}] \tag{59}\]

The cross-talk contribution in the strips is much smaller than for calibration since, for electron or photon showers the signal extends, with comparative magnitude, over several neighbour strips.

## 2 Measurement of "known" quantities

The preamplifier characteristics as well as the detector parameters, both function of the frequency were measured using a network analyzer.

Figure 13: _Current in two half gaps of width 10% smaller (larger) than nominal in green (red). The sum (in black and red) is equal to nominal for \(t\to 0\), but extends beyond the nominal drift time (450 ns)._

For bench measurements at Orsay we have used the HP 8753-D device which can sample from its two terminals the reflected and transmitted signal. Its bandwidth extends up to 6GHz. The calibration with reference elements (open, short, and nominal 50\(\Omega\) load) was made putting them at the end of a precision short 50\(\Omega\) cable, which in turn was used to connect the measuring device to the test board where the preamplifier hybrid (with 4 identical channels) was located, or directly to the FEB input connector.

### Preamplifier input impedance

This was measured in the single terminal reflection mode. For the 25\(\Omega\) preamp case we have added a 23\(\Omega\) resistance in series in order to have better accuracy (small reflection), but data recorded without the 23\(\Omega\) gave consistent results with the other measurement.

The quantities recorded are the real and imaginary part of the reflection coefficient (ratio of input and reflected amplitude, and phase shift). From this, one recalculates the real and imaginary part of the impedance, inverting R=(Z2-Z1)/(Z2+Z1)(see section 1.5) and then subtracts the precisely measured added resistance in case there was one.

The impedances of a small set of preamplifiers, from each of the two manufacturers were measured from 0 to 100 MHz, with the maximum allowed number of frequency bins (1600).

The results obtained are depicted in figure 14 for the 25\(\Omega\) case (5mA and 10mA type separately), and figure 15 for the 50\(\Omega\) case. In the case of the 25\(\Omega\) the results obtained are similar to earlier measurements carried out in Milano on development versions of the preamplifiers [15].

Measurements were also carried out with the preamplifier hybrid located in situ on the Front End Board (FEB). The impedance obtained in this case is very close from the results with the test board at low frequency, but differ somewhat at high frequency (see figure 15). The voltages of the supplies were verified to be identical. The difference may come from the fact that the 3 other channels of the hybrid are properly terminated (to the shaper) on the front end board, and not on the test board (there need to be some small coupling between the channels to give rise to a difference of behaviour). The measurement for the INFN 25\(\Omega\)-5mA preamplifiers made on the bench board are very close to the measurements on the FEB in the frequency regime up to 40MHz (see Fig. 11a). Because the measurements on the FEB present some unphysical oscillations, it was decided to use the measurement on the bench board in the following sections. Concerning the 25\(\Omega\)-10mA preamplifiers, no measurement were done on the FEB in the frame of this analysis. Assuming that, as for the 25\(\Omega\)-5mA case, the measurements of the two different supports are similar below 50 MHz, the measurement on the bench board for the 25\(\Omega\)-10mA will also be used in the following sections. For the 50\(\Omega\), the situation is different : it remains some discrepancy between the measurements on bench board and FEB. Because the source of this difference is not well understood, the FEB measurement has been prefered for the following studies.

### Preamplifier transfer function

For this measurement the network analyser was operated in the transmission mode, recording the ratio ( real and imaginary part) between the output and the input sine waves. The input cable was terminated at the preamplifier with a \(50\Omega\) resistor to ground, and the signal injected in the preamplifier through a \(3\mathrm{k}\Omega\) resistor just upstream of the termination, like the calibration signal is injected in the calorimeter.

The transfer function obtained for the \(25\Omega\) cases is rather flat (see Fig. 16a). On the contrary the transfer function for the \(50\Omega\) case is rather steep (see Fig. 16b). It's net effect on the electronics chain is to slow down the response and increase the apparent time constant

Figure 14: _25\(\Omega\) Preamplifier impedance as a function of the frequency (MHz). a) 25\(\Omega\)-5mA. In red the signal for an INFN preamplifier measured on the bench board, in blue for a BNL preamplifier on the bench board, and in black for an INFN signal measured on a FEB. b) 25\(\Omega\)-10mA, with the same convention for the red (INFN) and blue (BNL) curves._

Figure 15: _50\(\Omega\) preamplifier input impedance (modulus) as a function of the frequency (MHz). In red the signal for an INFN preamplifier measured on the bench board, in blue for a BNL preamplifier on the bench board, and in black for an INFN signal measured on a FEB._

of the shaping amplifier by about 2ns (ie to obtain a similar description without the transfer function one needs to increase the shaper time constant by about 2 ns).

In order to check the actual behaviour of the shaper, we have measured its transfer function as a function of frequency. The results obtained for one particular chip are shown in figure 17. The high and medium gains follow rather closely the expected behaviour (the time constant was matched to reproduce the peak value). It was checked that the difference between the expected shape and the actual one in high gain had no visible effect on the calculated global response. The rather unexpected response of the low gain was not investigated further at this stage, and needs confirmation.

Figure 16: _Preamplifier transfer function as a function of frequency (MHz): modulus on (a), phase on (b); red=25\(\Omega\)-10mA, blue=25\(\Omega\)-5mA, black=50\(\Omega\)._

Figure 17: _Shaping amplifier transfer function, in black for high gain, in blue for medium gain, in green for low gain, and in red the calculation corresponding to formula 25. All functions are normalized to 1 at their maximum._

### Detector, Summing board, Mother board impedance

These quantities are of course essential for understanding the detector behaviour. Their measurements are described in [4] for cells of the middle compartment. The numbers were obtained in situ at CERN during the calorimeter integration using a somewhat less performant network analyzer. The emitted signal was connected (at the base plane level) to the \(50\Omega\) calibration input, and the output pin of the corresponding signal output was connected to the receiving terminal.

The quantities recorded are the ratio of received to emitted sine waves as a function of frequency, in amplitude and phase. The resonance (minimum of ratio) gives directly \(\nu_{0}\). The ratio of measurements at the resonance and at low frequency gives \(r\). The shape of the curve can give in principle C and L. It was decided to use C from calculations, and deduce L from \(\nu_{0}\). A correction is made (see section 1.1) to take properly into account the inductance and capacitance of the summing board, obtained from bench measurements.

The measurements were carried out while the calorimeter was warm, and then again when it was cold and full of liquid argon. This allowed interesting checks described in [4].

### Signal and calibration cables speed, impedance and attenuation

The characteristics of the signal and calibration mini-coaxial cables were defined in [8], where in particular the maximal dispersion of \(\pm 10\%\) around the nominal impedance was justified.

Continuous checks made along the production allowed to reject samples out of this window. It was found during these tests that "batches" produced at a given time tend to have a narrower dispersion than what is found from batch to batch [16].

Despite the fact that the impedance and attenuation depend on the same parameters (albeit in a different functional way) it was decided to use a fixed value of the propagation speed (function of the dielectric only), and of the attenuation, while keeping the impedance as a parameter allowed to move by less than \(\pm 10\%\) around nominal 1.

Footnote 1: Some Time Domain Reflectometry data provided to us by the Milano group indicate that impedance and speed vary actually in opposite direction, as expected from the fact that their product, proportionnal to cable impedance, does not depend from the dielectrics.

The values used are grouped in the tables 1 and 2.

The \(50\Omega\) cables used to propagate the calibration signals were selected at the production level among those with an impedance closer to nominal. As already mentioned, the (small) dispersion of impedance of the calibration cables has a negligible impact on the results.

\begin{table}
\begin{tabular}{|l|l|l|l|} \hline
**25\(\Omega\) signal cables** & **Value at warm** & **Value at cold** & **Remark** \\ \hline Characteristic impedance (\(\Omega\)) & 25 & 25 & Allowed to vary by \(\pm\) 3\(\Omega\) \\ \hline Signal propagation (ns/m) & 5.7 & 5.5 & \\ \hline Skin effect constant(\(\Omega\)/m\(\sqrt{\mathrm{MHz}}\)) & 0.18 & 0.09 & \\ \hline \end{tabular}
\end{table}
Table 1: Main parameters of the 25 \(\Omega\) cables as used in the predictionsThe lengthes of harnesses used were taken from a data base, filled from datasheets given by the factory.

### Feedthrough impedance, propagation speed, attenuation

From the electrical point of view, the feedthroughs consist of two sections of flat polyimide cables (with copper strips for signal and ground facing each other) connected in series through the pin carrier. In normal calorimeter operating conditions, the upstream cable section (41 cm long) is under vacuum, at low temperature (equal or close to the temperature of the liquid argon bath), while the downstream section (28.5 cm long) is at room temperature. The geometry of the two sections are nearly identical. In order to limit the heat transfer from the warm side to the liquid argon bath the cross sections of the signal and ground copper strips were made thin, which in turn increased their electrical resistance, measured at warm to be about \(0.9\Omega\) for the vacuum cables (dc value).

As explained in [10], detailed measurements of the cable characteristics were made (at warm) as a function of frequency. The main values are summarized in table 3.

The measured attenuation, compatible with a \(\nu^{1/2}\) variation, corresponds to a skin constant \(K\) of 0.6 at warm (see section 1.2). It was decided to reduce it to 0.4 at cold, since only half of the cable is cold in operating conditions. For the predictions, taking also into account our bench measurements (see next section) the values quoted in table 4 were finally used.

\begin{table}
\begin{tabular}{|l|l|l|l|} \hline
**Parameter** & **Value** & **Value** & **Remark** \\  & **at warm** & **at cold** & \\ \hline Characteristic impedance (\(\Omega\)) & 42 & 42 & For all frequencies up to 50 MHz \\ \hline Signal propagation time (ns) & 4.75 & 4.75 & Includesconnects \\ \hline Skin effect constant(\(\Omega\)/m\(\sqrt{\mathrm{MHz}}\)) & 0.6 & 0.4 & \\ \hline \end{tabular}
\end{table}
Table 4: Feedthrough parameters used in the predictions

\begin{table}
\begin{tabular}{|l|l|l|l|} \hline
**50\(\Omega\) signal cables** & **Value at warm** & **Value at cold** & **Remark** \\ \hline Characteristic impedance (\(\Omega\)) & 50 & 50 & Allowed to vary by \(\pm\) 5\(\Omega\) \\ \hline Signal propagation (ns/m) & 5.2 & 5 & \\ \hline Skin effect constant(\(\Omega\)/m\(\sqrt{\mathrm{MHz}}\)) & 0.324 & 0.162 & \\ \hline \end{tabular}
\end{table}
Table 2: Main parameters of the 50 \(\Omega\) cables as used in the predictions

### Calibration signal parameters

The calibration boards produce precision voltage signals, transported along the calibration cables, and transformed into current pulses on the mother boards using precision resistors.

For completeness one can recall at this point that the termination resistance \(R_{T}\) is actually made out of a physical resistance to ground \(R_{G}\), in parallel with the n calibrations resistances \(R_{cal}\) through which the signal is distributed to cells on the mother boards [4, 9].

For the middle and back compartments, n=8. In electrode A the nominal value is \(R_{cal}=500\Omega\) to which corresponds \(R_{G}\)= 250\(\Omega\). In electrode B the nominal value is \(R_{cal}=1k\Omega\), to which corresponds \(R_{G}\)= 83\(\Omega\). For the front compartment n=32, and the nominal calibration resistance value is \(R_{cal}=3k\Omega\), to which corresponds \(R_{G}\)=107\(\Omega\).

Each of the calibration resistance \(R_{cal}\) goes to ground through the detector cell impedance in parallel with the preamplifier input impedance (see Fig. 1). These are small enough - a few \(\Omega\) - (see also Fig. 5a) in order not to affect, in principle, the global termination value \(R_{T}\).

For the presampler the termination network is somewhat different. It insures a local termination to 50\(\Omega\) independent of the detector and/or preamplifier being physically connected. The nominal \(R_{cal}\) value is \(R_{cal}=2\,k\Omega\), and n=16 (except for the last sector for which n=10, giving pulses 1.6 times larger).

## 3 Results of bench tests

In order to validate each part of the model previoulsy described, bench measurements have been performed in various configurations. For all measurements the input signal was provided by an ATLAS production calibration board. The output signal of the "simulated detector" was read through a CR-RC\({}^{2}\) shaper (not the ATLAS one) with a 1 GHz sampling and digitising board. In order to minimize the noise, one thousand signals are averaged for each measurement.

#### 3.0.1 LC network

First configuration consists of a small board with a capacitor (C=1.52 nF) and an inductance (L= 33 nH) with a 2k\(\Omega\) resistor to inject the calibration signal. The strip line connecting these components in the printed circuit acts as an inductor which can be deduced from the frequency resonance of the circuit measured to be \(\nu_{0}=20.35\,MHz\). This setup is the most easy case and will be used to fix some of the parameters in the next measurement as the shaper time constant. Only the cable impedance \(Z_{S}\) is used as a free parameter. To test the description of the reflection, three measurements have been performed :

* the readout signal of the board was read by a 25 \(\Omega\) (5mA) ATLAS preamplifier connected to the LC board directly by a 25 \(\Omega\) cable (in fact two BNC in parallel). The use of a long cable allows a clear separation of the direct and reflected pulse. Such a signal is presented in figure 18a with the model prediction using the preamplifier characteristics described in sections 2.1 and 2.2. The reflection due mainly to the non nominal impedance of the preamplifier is clearly visible and well reproduced.
* An additional 50 \(\Omega\) lemo cable (8 ns propagation) to simulate an impedance breakdown, as with the feed through in ATLAS configuration, has been inserted between the BNC cable and the preamplifier. In this case preamplifier to lemo and lemo to 25 \(\Omega\) reflection needs to be introduced in the description. Again the description is still valid as displayed in figure 18b* The feed through has also been simulated by two ATLAS warm cables (called "warm feedtrough") instead of a lemo cable. The distribution is displayed in figure 19a. The reflection coefficient is expected smaller (42 \(\Omega\) impedance cable). The agreement is still acceptable although not as good as with the lemo. It might be attributed to the warm cable impedance variation with the frequency not used in the model.

Similar plots are shown for the 50 \(\Omega\) preamplifier in figure 20. While the middle pulse descriptions are done with a shaper time constant of 14 ns, the front measurements are better described with a time constant of 16ns. Such a difference will be also observed later with the full ATLAS readout and seems to demonstrate residuals imperfections in the input impedance or the transfer function of the 50 \(\Omega\) preamplifier.

The validation of the description of the attenuation by skin effect and the determination of the speed propagation in the axon cable has also been achieved with this detector simulation replacing the BNC cable by an long (8.50 m) ATLAS cable. The result is displayed in figure 19b. A good agreement is obtained at warm temperature (with 24 \(\Omega\) taken for the impedance of the axon cable). Not taken into account the attenuation as presented in the same figure will prevent any good description of the waveform and will strongly biased the absolute energy scale. Starting from these numbers, the temperature variation of the skin effect has been checked during the cooling down of the ATLAS barrel calorimeter.

Figure 18: _Amplitude (in ADC counts) as a function of time (in bins of 1ns): in black the data and in red the prediction. The detector is simulated here by the small LC board. The signal cable is of 25\(\Omega\) BNC type with a propagation time equal to 54ns. On plot a, the signal enters directly into the preamplifier of type 25\(\Omega\) 5mA. The green curve represents the prediction with preamplifier of fixed 25\(\Omega\) input impedance and a flat tranfert function (the normalisation of this prediction has been reduced by a factor 1.14 with respect to the red one). On plot b, a 50\(\Omega\) lemo cable of 8ns is used before entering the preamplifier._

Figure 19: _Amplitude (in ADC counts) as a function of time (in bins of 1ns): in black the data and in red the prediction. The detector is simulated by the small LC board. The signal cable is of 25\(\Omega\) BNC type with a propagation time of 54ns for plot a and is an Axon cable of 8m50 (i.e. a propagation time of 52ns) for plot b with \(Z_{S}\) fixed to 24\(\Omega\). In each cases, a warm feedthrough is used as well as a 25\(\Omega\), 5mA preamplifier. On plot b, the green curve represents the prediction in case of no attenuation in the signal cable._

Figure 20: _Amplitude (in ADC counts) as a function of time (in bins of 1ns): in black the data and in red the prediction. The detector is simulated by a local LC board. On plot a, the signal cable is of the BNC type with a propagation time of 52ns entering directly into the preamplifier is of type 50\(\Omega\). On plot b, the signal cable is shorter (45 ns) but followed by a 25\(\Omega\) lemo cable of 8ns before the 50\(\Omega\) preamplifier._

#### 3.0.2 Calorimeter mock-up measurement

All the previous measurements were done with static components while most of the detector parts show a distributed impedance, for instance the electrodes or the summing boards. In order to study how the description behaves in such a condition, a calorimeter mock-up made of six electrodes and absorbers was used. The calibration signal was injected through the motherboard resistance network connected to the detector with the summing boards. The detector capacitance \(C_{D}\), the resonance frequency \(\nu_{0}\) and the summing board capacitance (100 pF) were taken from direct measurements on the ATLAS calorimeter. Two typical examples obtained at various rapidity are presented on figure 21. The agreement is correct and no attempt has been done to improve it as the cell characteristics used are probably not the optimal ones.

## 4 Cross-talk signals

Cross-talk between neighbouring cells, either inside a given compartment, or from one compartment (middle for example) to the others (either front or back) has been studied already in some detail, for example during "module zero" qualification [17].

The work reported here is aiming at describing the observed cross-talk pulses, both in amplitude, shape and timing with respect to the main signal with the same formalism and if possible the same parameters as used for the "main pulsed cells". However, being in general much smaller than the main pulse in the directly connected channel, cross-talk pulses are "contaminated" by several small effects, in general too small to affect the quality of electromagnetic shower reconstruction, but large and diverse enough to preclude a description at the same level of precision as is being done for the main pulse.

Figure 21: Amplitude (in ADC counts) as a function of time (in bins of 1ns). The Calorimeter mock-up is used. The measurement are done at different rapidities: eta=0 (C=923pF) on plot a and eta=40 (C=1357pF) on plot b. In each cases, the signal cable is an cable of 5m25 with Z fixed to 22\(\Omega\). A standard feedthrough is used as well as a 25\(\Omega\) preamplifier. For these two plots, the normalisation is determined from plot a and fixed to that value on plot b, with a nice agreement.

### Cross-talk between front cells

* **Cross-talk in the nearest neighbour** The calibration system allows to pulse one strip out of 4 in the front compartment. By looking at signals in the three channels in between, one gets immediately access to cross-talk signals. As already indicated in section 1.13 the geometry of the strips in this compartment (width of 5 mm), and the distance between them (0.5 mm) generates a sizeable cross capacitance between neighbour cells. An example of signal in the nearest neighbours is shown in figure 22c, where signals in strips 8 and 10 are added when one is pulsing channel 9 for FT21A in run 8023 (Fig. 22b). The procedure as described in section 1.13 gives a fair description of the pulse shape with \(C_{D}\)= 124 pF, \(C_{SB}\)=30 pF, \(L_{SB}\)=13.5 nH, \(\nu_{0}\)=83.64 MHz and \(\tau_{sh}\)=13.65 ns. The value at maximum in this particular case (167 counts against 2292 counts in channel 9 when all channels are pulsed together-ie no cross-talk-) is reproduced when one chooses \(C_{X}\)=50 pF from the pulsed cell to each neighbour, a value in fair agreement with expectations [4, 13].

Figure 22: Amplitude (in ADC counts) as a function of the time (in bins of 1.04 ns) in the front compartment. Signal corrected for xtalk contribution a), signal in the pulsed cell b), the nearest neighbours c) and the next to nearest neighbours d) ; black curve = data, red curve = calculation (see text for the value of the parameters).

* **Cross-talk in the next to nearest neighbour** An example of a signal in such a situation is given in figure 22d where the pulse in channel 7 (in reality half the sum of channel 7 and 11) is depicted when one pulses channel 9 (and 5, and 13,..), like in the example above. The signal observed (39 counts at maximum in this example), typical of what is found in all other channels in the same configuration of pulsing, at similar \(\eta\), was first rather unexpected, and incompatible with the small pulse "nearest neighbour like" expected from a "cross-talk to cross-talk in the detector".

An explanation which fits the "double peak" structure is given by invoking cross-talk near the preamplifier, as explained in section 1.14. In order to reproduce quantitatively the height of the first pulse, a capacitance of 15 pF is needed. Such a coupling with the next to next neighbour can be found at least qualitatively in the VME/AMP connector bringing signals inside the FEB: signals like 9 and 7, separated by signal 8 in the detector are neighbour on the connector (see Appendix 3). The signals being next to each other downstream of this point, the cross-talk can also originate at the level of the preamplifier hybrid. The time in between the two peaks fits with the time needed to go from the preamplifier to the detector and back (see 1.14 and Fig. 10). For strips at larger \(\eta\) equipped with shorter signal cables, the distance between the two peaks shrinks accordingly to the cable length (not shown).

### Cross-talk between middle cells

In this compartment as well the calibration system allows to pulse "one channel out of 4" in \(\eta\), with a pattern like in figure 23. As an illustration of the signals observed when one cell out of 4 are pulsed, figure 24 shows the main signal in channel 24, and the signals in the neighbours channels 20, 25, and 28. The peak values of cross-talk signals are about 2% of the main pulse.

From the detector geometry (grounded absorbers separate each electrode from the next) there could not be significant capacitive coupling between two neighbouring channels in \(\phi\), like for example between 24 and 25. Indeed the signal in 25 starts with a negative pulse, characteristic of an inductive coupling. The procedure described in section 1.15 gives a reasonable description of the pulse - see figure 25 -, and the magnitude is reproduced with an inductive total coupling of 24 nH. The origin of such a coupling could be found in the "low profile connector", known

Figure 23: _Pattern of cells pulsed by one calibration line in the middle compartment. Numbers indicate the position of cells on the FEB._

[MISSING_PAGE_EMPTY:31]

between neighbours is half of this, namely 12 nH.

The other channels neighbour in \(\eta\) of the pulsed ones (like 20 and 28) produce signals of a different shape from 25, but of comparable magnitude at their peak.

Actually, by subtracting an "inductive pulse" given by channel 25 from the signal on channel 20, one gets a signal which is "capacitive cross-talk" like (Fig. 26). Its shape can be described by the formulae of section 1.13, and the magnitude is reproduced with \(C_{X}\)= 40pF. This is in fair agreement with the expectations ([4, 13]) of cross talk coupling at the detector level. A similar situation happens with channel 28 which is neighbour of the pulsed cell 26 on the AMP/VME connector (see Appendix 3).

At this point one can remark that the ratio of capacitive cross-talk to main signal (measured at the maximum of each signals), for a given \(C_{X}\)=50 pF, is a factor 1/17 in the front (taken with a capacitance of 120 pF + 27 pF (CSB), and a factor 1/70 in the middle (with a capacitance of 1.4 nF). Instead the ratio of inductive to main is essentially independent of the detector capacitance.

This confirms that, as observed, inductive cross-talk is more likely to be visible in cells with large capacitances (middle or back) than in the front.

### Cross-talk between middle and front compartments

The gain of the preamplifiers of the front compartment being larger than for middle cells (factor about 4 for \(\eta<0.8\)), the cells of this compartment are sensitive to even tiny cross-talk from the middle compartment. Furthermore, since the high voltage is distributed from the back of the calorimeter, a small resistive coupling is expected between middle and front, with an amplitude linked to the actual value of resistors on the HV layers of the electrodes.

Figure 26: _Difference of signals in middle cells 20 and 25 (actually channel20+channel28-2*channel25 in black) renormalized to one, with superimposed signal resulting from capacitive coupling between 2 neighbours in \(\eta\) in the detector (prediction in pink), as a funtion of time (in 1.04 ns bins)._

Figure 28: _Signals (in ADC counts) in front cells 0 to 7 as a function of time (in bins of 1.04 ns), when the other set of middle cells resistively connected to them are pulsed._

Figure 27: _Signals (in ADC counts) in front cells 0 to 7 as a function of time (in bins of 1.04 ns), when one set of middle cells resistively connected to them are pulsed._

[MISSING_PAGE_EMPTY:34]

Figures 27 and 28 do show a positive signal, with a shape similar to the one in a cell directly pulsed. Figure 30 shows the superimposition of a calculated signal in the strip with the one observed. Only the normalisation is free. The agreement is good. The normalisation corresponds to an average value of middle-strips resistive pads of about 400 k\(\Omega\), in qualitative agreement (albeit somewhat smaller) with what is expected.

Comparing in more detail figure 27 and figure 28 one can see that 2 channels (3 and 7 in Fig. 27) (2 and 6 in Fig. 28) have an early negative signal, of similar height as the positive lobe. This negative signal can be associated to an inductive coupling in the VME connector by which the calibration signal transits when going from the calibration board to the feedthrough. As a matter of fact the pins carrying the first two calibration signals (pins 5 and 6) to middle cells are neighbours on this connector of the last two carrying signals to the front (pins 3 and 4) which corresponds to cells where the negative pulse is observed.

Such an inductive signal can be isolated, for example in strip 15 when pulsing the first set of the middle cells. Figure 31 shows that an inductive cross-talk fits well the observed shape. The normalisation is reproduced with a coupling of 22 nH. When pulsing through pin 7, further away from the pins pulsing the front, no such signal is visible (Fig. 29). Finally the small negative early pulse visible on all other channels, and the only one present on figure 29 has no known origin at this point of the analysis. Its shape is indicative of an inductive coupling. This signal is also present on cell 0, not connected to a physical strip [16] in the detector and thus not showing a (positive) resistively coupled signal.

### Strategy for the following

The crosstalk signals being reasonnably well understood, in shape and size, it was decided in the following analysis:

* to add-up signal from neighbours (or take runs where all channels are pulsed) for analyses

Figure 31: _Signal (with arbitrary normalisation) in strip 15 when pulsing the first set of middle cells (fig. 27). Superimposed in blue is a calculated signal resulting from an inductive coupling._

in the front compartment, where the crosstalk is large (\(\simeq 8\%\) at the peak),
* to analyse the signal as observed in pulsed cells for presampler, middle and back where the crosstalk is below the \(2\%\) level.

## 5 Study of Commissioning data

For completeness, one can recall that a given feedthrough (FT) corresponds to half a front-end crate in which are located, for the barrel:

* 1 presampler board, located in slot 1,
* 7 front end boards located in slot 2 to 8
* 2 back boards located in slot 9 to 10
* 4 middle boards located in slot 11 to 14 (the last one is half populated)

In total there are 1728 channels in one half front-end crate (or FT).

The so called "delay pulses" are obtained by assembling 24 sets of calibrations pulses shifted one with respect to the preceeding one by 25/24=1.04 ns. Each of the 24 calibration pulses is sampled every 25 ns. The "delay pulse" obtained this way mimics a sampling every 1.04 ns, with the important difference that there is no correlation between neighbours from different curves due to the finite bandwidth of the electronics. The electronics bandwidth affects in each curve the points taken every 25 ns.

To predict the calibration pulse shape, a \(\chi^{2}\) minimization is performed with Minuit++[18] using as input data the average of 100 measured pulses associated with their corresponding errors as a function of time. The errors obtained in this way, 1/10 of the noise, are very small, less than one ADC count. Their values are reported in table 5 for the presampler and the three calorimeter compartments. As will be seen in the following, except in rare cases of exceptionally good description, the \(\chi^{2}\) is dominated by systematic effects between the description and the measurements. In these conditions, we found inappropriate to introduce the correlation between samples every 25 ns which is relevant when the electronics noise is dominant. Typical values of the systematic differences are around 10 ADC counts (\(\sim 0.5\%\) of the maximum amplitude, and about 2 times the noise for a single measurement) giving \(\chi^{2}/ND\) typically between 100 and 400.

Footnote 2: All the known cable lengths have been put in the model.

Otherwise explicitly stated, the fit contains 4 free parameters : \(\tau_{sh}\), \(Z_{S}\), the normalisation of the pulse and a time delay \(\Delta t\) to take into account possible time differences between channels not considered in the model3. The values of C\({}_{D}\) and \(\nu_{0}\) (see section 2.3) are taken from [4].

\begin{table}
\begin{tabular}{|l|c|} \hline Presampler & 0.84 \\ Front & 0.8 \\ Middle 0,1 & 0.5 \\ Middle 2,3 & 0.36 \\ Back & 0.53 \\ \hline \end{tabular}
\end{table}
Table 5: Mean values of the errors (in ADC counts) for the presampler and the three calorimeter compartmentsIn order to fit all channels, the grid was used to run the jobs for each slot in several feedthroughs.

The parameters extracted from the fit on a calibration pulse are then used to predict the physics signal pulse. In addition the ratio of the maxima of the physics to the calibration pulse, called the \(Mphys/Mcal\) factor, is also determined.

The results shown in the next sections (5.3-5.6) have been extracted from high gain data: it has been checked on a data subset that the values of \(Z_{S}\) are stable when considering medium gain data (the mean difference between both fitted value being \(0.03\pm 0.2\Omega\)): the normalisation and \(\tau_{sh}\) are not expected to remain exactly the same according to what has been observed in monitoring runs. The residual difference for the predicted \(Mphys/Mcal\) for both data is \((0.1\pm 0.5)\%\).

The section 5.2 deals with data taken at different temperatures during the cooling down. The following ones (5.3-5.6) focus on commissioning data at cold.

### Bias on the calibration slope Tcali

In a first analysis of the commissioning data (sections 5.3 and 5.5), it was found, looking at the signals \(\sim\)200ns after the peak, that a best fit to this smooth region was calling for different values of \(T_{cali}\) (slope of the calibration pulse) for front and presampler channels (\(50\Omega\)) as opposed to

Figure 32: _Pulse description (in ADC counts) as a function of time (bins of 1.04ns) in the middle (Slot 11 Channel 5 FT 18C) for four different runs corresponding to a temperature of \(230K\) in (a), \(160K\) in (b), \(90K\) without Argon in (c) and \(90K\) with Argon in (d). In black the data, in red the prediction. The parameters \(\tau_{sh}\), \(Z_{S}\) and the normalisation are fixed to the (d) case and used for the other cases._

middle and back cells (\(25\,\Omega\)). Several investigations were carried out to find the origin of this difference. As explained in section 1.3, a bad termination of the calibration cables could induce such a difference. This was not a priori excluded given the distributed nature of the termination resistance of the calorimeter calibration signals (see section 2.6). An examination of TDR data 3 showed no difference between middle and front calibration lines, nor with presampler calibration lines for which the termination is locally matched [19], which ruled out this explanation. Going then step by step with all contributions to the calculated shape, it was found that the exponential tail was actually quite sensitive to the low frequency response of the chain (below 1 MHz) to which lesser attention had been paid initially. In the end the reason of the difference was tied to a mis-measurement of the \(50\Omega\) preamplifier transfer function (saturation?) in this frequency range, corrected since then. In the end we used \(T_{cali}=395\) ns for middle and back cells and 405 ns in front and presampler cells, as a result of a best fit in the region from 400 to 700 in bins of 1.04 ns (which means 416 to 728 ns) after the beginning of the pulse. The impact of this small difference is discussed in section 5.3.4.

Footnote 3: supplied by D. Banfi from Milano

### Data taken during the cooling down

Commissioning data have been taken since February 2006, the first data corresponding to warm temperature measurements and the last ones with the electromagnetic calorimeter cold

Figure 33: _Pulse description (in ADC counts) as a function of time (bins of 1.0\(\mu\)ns) in the front (Slot 2 Channel 9 FT 18C) for three different runs corresponding to a temperature of \(160K\) in (a), \(90K\) without Argon in (b) and \(90K\) with Argon in (c). In black the data, in red the prediction. The parameters \(\tau_{sh}\), \(Z_{S}\) and the normalisation are fixed to the (c) case and used for the other cases._

and the cryostat filled with liquid argon. The evolution of the delay pulses from \(T\sim 2\,30K\) to \(90K\) has been studied.

The modification of the height and shape of the pulses from \(230K\) to \(160K\) and then to the "cold without Argon" scenario are compatible with the temperature evolution of the skin effect parameters. The transition from "cold without Argon" to "cold with Argon" is compatible with multiplying the cell capacitance value by 1.37 [4]. Figures 32(resp. Fig. 33) present the pulse description of one channel in the middle (resp. front) at different times of the data taking. The residuals are smaller than 1% in the middle and smaller than 2.5% in the front in the peak region. The parameters are extracted from the "cold with Argon" case and then propagated to the other configurations. The agreement between predictions and data in all different cases shows that the attenuation as well as the capacitance change between cold and room temperature is under control. It should be reminded at this point that during the cooldown the temperature uniformity of the detector (and of the cold cables) is not granted.

### Results of Commissioning tests with middle cells

The results presented in the following sections, all taken at cold, have mainly been obtained from three runs: 8045 for middle and back cells, 8027 for front cells when all the cells are pulsed at the same time and 8093 for the presampler.

#### 5.3.1 Extraction of parameters

Figure 34: _Middle compartment values of the four free parameters of the fit : (a) \(Z_{S}\), (b) \(\tau_{sh}\), (c) Normalisation, (d) \(\Delta t\), as a function of the channel numbers for the middle (FT 21A)._

The parameters extracted in the middle from the fit for each channel of FT 21A are presented in figure 34. The following values were used for the summing board: \(C_{SB}=75\)pF and \(L_{SB}=12,\ 13,\) or \(15\)nH depending on the \(\Phi\) value. The vertical lines indicate the slot change.

The impedance of the signal cable \(Z_{S}\) is found around \(24\Omega\), with some structures associated to slots. The mean value of the shaping time \(\tau_{sh}\) is found around \(13.5\) ns with some rising evolution as a function of the channel number (and thus \(\eta\)). A few points get a \(\tau_{sh}\) value smaller than \(10\) ns and correspond to well known fast shaper channels: the fit analysis performed in this section is also a way to track these particular channels.

The normalisation is defined as "measured data = Norm \(\times\) predicted pulse" (cf. section 1.12). The fact that \(\tau_{sh}\) is low and the normalisation factor is somewhat higher in electrodes A than in electrode B indicates that capacitances may be overestimated in electrode A, or that the parameters of preamplifiers measured from a small set are not representative of the full lot.

V structures show up in the evolution of the \(\Delta t\) parameter, within a FEB. This behaviour,already observed during FEBs bench tests, can be associated to layout features of the boards.

As far as the correlation between the parameters is concerned, the values are given in table 6. The parameters are highly correlated: mainly \(\Delta t\) and \(\tau_{sh}\) and \(\tau_{sh}\) and the normalisation.

The \(\chi^{2}\) per degree of freedom is presented in figure 35a. The values obtained are rather uniform in the 4 slots. The average value of about 100 corresponds to a mean deviation (see also Fig. 35b) of about 5 ADC counts or 0.4% of the maximum amplitude.

Figure 36 shows on the left hand side a superposition of data (in black) and fit (in red) for a specific channel. The residuals are also computed for the 800 ns pulse length and plotted (see Fig. 35b): the maximal deviation is of the order of 1.8% of the peak value for the whole FT. There are clearly two populations: one peaking at slightly positive values and corresponding to

Figure 35: _(a) \(\chi^{2}\) per degree of freedom of the fit with 4 free parameters shown as a function of the channel numbers (b) Residuals between fit and data normalized to MCal for FT 21A computed on 800 ns._

Figure 37: _For each considered FT quoted on the x axis: mean value of the difference between the fitted value of the four parameters and the value found for FT21A. The error bars reflect the resolution of the determination of the mean value using a gaussian fit on the distributions._

Figure 36: _(a) Calibration pulse for a middle cell with measured error bars (Slot 11 Channel 5 FT 21A) : ADC counts as a function of time (with bins of 1.04 ns), black = data, red = fit, cyan = (fit-data)/MCal (the axis on the right hand side gives the value of this residual), (b) calculated physics signal shape as a function of time (with bins of 1.04 ns)_

Figure 37: _For each considered FT quoted on the x axis: mean value of the difference between the fitted value of the four parameters and the value found for FT21A. The error bars reflect the resolution of the determination of the mean value using a gaussian fit on the distributions._

the points above 300 ns, while another gaussian peaking around -0.002 corresponds to the signal peak. The corresponding predicted physics pulse is shown on the right hand side of figure 36.

The results are quite uniform over all the tested feedthroughs as shown on figure 37 where, for each parameter, the mean value of the difference between the fitted value of the corresponding FT and the one found for FT21A (taken as a reference) is shown. The dispersion of the ratios for the normalisation is below the percent level which is as expected.

The study has also been done with \(Z_{S}\) fixed to the average value found at low \(\eta\), without any significant difference on the pulse description.

#### 5.3.2 Comparison of predicted and observed physics pulses

During 2007, the cosmic trigger periods allowed to record some events with large energy deposits in calorimeter cells, which were then compared to the predictions obtained from a fit with the present description,to the calibration pulse. Figure 38 shows the data-calculation comparison for the middle cell of FT 23A, slot 11, channel 31. The time shift between the actual physics event and the 40 MHz clock used to sample signals every 25 ns was used to produce a physics shape with the appropriate phase. The amplitude of the pulse was adjusted to fit best the maximum and its left and right neighbours. Four curves are drawn, corresponding to perfectly centred electrodes in black, i.e. a single main triangle, and electrodes offset by 0.1, 0.15 and 0.2 mm respectively in light blue, dark blue and pink (see section 1.16). The same contribution from the bends (6%) is added in all cases.

Shapes with a non-zero offset give a better description of the data (for this particular pulse and several others, not shown).

The deviation between the measured signal and the calculated shape for a deviation of 0.15mm (\(x\)=0.075),which by eye gives the best description, is shown in green. One can note that all points above 200 ns are positive, meaning that the used time drift (482 ns for \(x\)=0) was probably too short by a few percents.

More statistics (ideally pointing electrons from proton-proton collisions in the LHC) are obviously necessary to fully qualify the description.

#### 5.3.3 Mphys/Mcal

As mentioned previously, the \(Mphys/Mcal\) ratio is also extracted in this procedure. It is presented in figure 39. It shows some discontinuities from slot to slot. In order to compare to

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline  & \(Z_{S}\) & \(\tau_{sh}\) & Norm & \(\Delta t\) \\ \hline \(Z_{S}\) & 1 & 0.17 & -0.43 & 0.25 \\ \hline \(\tau_{sh}\) & 0.17 & 1 & -0.90 & 0.91 \\ \hline Norm & -0.43 & -0.90 & 1 & -0.84 \\ \hline \(\Delta t\) & 0.25 & 0.91 & -0.84 & 1 \\ \hline \end{tabular}
\end{table}
Table 6: Typical correlation matrix between fitted parameters for the slot 11 in the middle Figure 39: \(Mphys/Mcal\) ratio as a function of the channel number, all the middle slots put one after the other, for FT 21A. The red ratio is extracted with the four free parameter fit procedure. The blue points are the ratio extracted from the RTM method after correction for attenuation.

Figure 38: _A cosmic pulse sampled every 25 ns (red dots) compared to predictions with a single main triangle (black) and two triangles to represent the case of electrodes offset by 0.2 mm (pink), 0.15 mm (dark blue), 0.1mm (light blue). The green dots represent the difference between data and calculation (0.15 mm), the corresponding axis is given on the right part of the figure._

[MISSING_PAGE_FAIL:44]

#### 5.3.5 Channel to channel timing dispersion

The channel to channel timing dispersion can be extracted from the fitted values of the \(\Delta t\) parameter. For each FT independently, a first correction is made to take into account the measured time offsets per calibration lines [9]. Then the Vshape effect is removed by fitting the mean value and the slope for each group of 64 channels which is induced by the signal distribution within a FEB and which incorporates any offset from FEB to FEB. Still a \(\Phi\) effect remains, which is shown on figure 40a, expected from the signal distribution on the summing boards and corrected for. At this stage two residual effects remain and are corrected for: the mean values of the \(\Delta t\) distributions are opposite for off and even values of \(\eta\) (separated by 0.14 ns), and the distribution of the measurements per calibration line still exhibits some structures which are also taken into account. At the end the observed dispersions are quoted in Table 9 for all the tested FT (an example for FT 21A is given in figure 40b): for all the FT the dispersion is of the order of 0.41 ns. When considering all the tested FT at once, the dispersion is found to be larger in slots 13 and 14 as it is shown on the Table 9 on the right.

A large fraction of this dispersion (about 0.2 ns) can be attributed to the tolerance on the calibration and signal cable time propagation. The time dispersions as obtained here would appear as a minimum constant term in any global time analysis over the barrel calorimeter. For measurements requiring a better accuracy (otherwise limited by noise and shower fluctuations) a channel by channel correction of the dispersion found here will be necessary.

Figure 40: _(a) Remaining effect in \(\Phi\) in the time estimation after calibration line and Vshape correction. (b) Time dispersion in ns obtained for FT21A._

\begin{table}
\begin{tabular}{|l|l|l|l|} \hline FT & Barrel A/C & \(\sigma\)(ns) \\ \hline

[MISSING_PAGE_POST]

 \hline \end{tabular}
\end{table}
Table 9: Time dispersion for each tested FT in the middle after corrections (see text for details)

### Results of commissioning tests with back cells

#### 5.4.1 Extraction of parameters

The fit results shown here were obtained applying the same procedure as for the middle.

The capacitances were taken as an intermediate solution (see Fig. 41a) between the geometrical estimate of each cell size on the electrodes, and the computation taken into account the cross-talk between cells (as it is done for the middle). The values of the resonance frequency were extracted from the measurement made on a single module, with the calorimeter cold and full (see Fig. 41b). The extraction of this parameter is not always easy due to the presence of double-dips, and of several reflections.

The parameters extracted from the fit on each channel of FT21A are presented in figure 42. The correlation matrix between the parameters are given in table 10.

The \(\chi^{2}\) per degree of freedom is presented on figure 43a. Cells with a higher capacitance have a smaller \(\chi^{2}\), the pulse being somewhat smoothed in this case. In some cases, like presented in figure 44a (C\({}_{D}\) = 1597 pF, L\({}_{D}\) = 10 nH, \(\nu_{0}\) = 26.7 MHz, \(Z_{S}\) = 21.9\(\Omega\), \(\tau_{sh}\)= 13.66 ns), the description is particularly good, with a \(\chi^{2}\) of about 13, meaning that the systematic effects are at the level of about 4 times the noise averaged over 100 pulses, or about 2 ADC counts. For cells at lower \(\eta\) (and smaller capacitances), the measured pulse show some structures at the level of the dip (not shown) that the model does not fully describe. In average, the residuals between fit and data are smaller than 2.5% of the peak value as seen on figure 43b. As opposed to the middle cells for which all parameters were stable within a FEB slot, one observes here

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline  & \(Z_{S}\) & \(\tau_{sh}\) & Norm & \(\Delta t\) \\ \hline \(Z_{S}\) & 1 & 0.65 & -0.81 & 0.50 \\ \hline \(\tau_{sh}\) & 0.65 & 1 & -0.85 & 0.88 \\ \hline Norm & -0.81 & -0.85 & 1 & -0.69 \\ \hline \(\Delta t\) & 0.50 & 0.88 & -0.69 & 1 \\ \hline \end{tabular}
\end{table}
Table 10: Typical correlation matrix between fitted parameters for the back (FT 21A, Slot 9, Channel 10)

Figure 41: _(a) Capacitances (in \(\mu\)F) and (b) resonance frequencies (in MHz) for the back as a function of \(\eta\)._a significant variation of \(\tau_{sh}\). Normalisation and \(\chi^{2}\) within a slot,which may be related to an imperfect description of the strong variation of capacitances with pseudorapidity. Cross-talk with neighbour back and middle cells, not corrected for as opposed to what is done for the front compartment, may also play a significant role.

Figure 43: _(a) \(\chi^{2}\) of the fit shown as a function of the channel numbers, the two back slots are put one after the other. (b) Residuals between fit and data normalized to MCal for FT 21A._

Figure 42: _Back compartment values of the four parameters of the fit: (a) \(Z_{S}\), (b) \(\tau_{sh}\), (c) Normalisation, (d) \(\Delta t\), as a function of the channel numbers, for FT 21A._

#### 5.4.2 \(Mphys/Mcal\)

The \(Mphys/Mcal\) ratio is presented in figure 45. The points from the RTM method have been corrected for attenuation, with factors highly dependent of the \(\eta\) value of the cell: see table 11.

Table 12 gives the mean and rms of the distribution of the difference between both methods for each slot.

Figure 44: _On the left hand side: Calibration pulse for a back cell (FT 21A) in ADC counts as a function of time (in bins of 1.04 ns), black = data, red= fit, cyan: (data-fit)/MCal, on the right hand side: corresponding predicted physics pulse as a function of time (in bins of 1.04 ns)._

Figure 45: \(Mphys/Mcal\) ratio as a function of the channel numbers, all the back slots put one after the other, for FT 21A. The red ratio is extracted with the three free parameter fit procedure. The blue points are the ratio extracted from the RTM method with correction for attenuation.

### Results of commissioning tests with front cells

#### 5.5.1 Extraction of parameters

The fit results shown here were obtained applying the same procedure as for the middle but to the calibration pulses obtained when all the cells have been pulsed at the same time. Using directly pulsed cells (1 out of 4) to which are afterwards added the neighbours gave very similar results (not shown).

As input to the fit, the calculated values of \(C_{D}\) have been used. For the resonance frequency, some measurements exist at warm temperature. An average value of 90 MHz was taken for slots 2 to 5. In the electrode B, some dependances in \(\eta\) were kept: 114 MHZ for slot 6, 106 MHz for slot 7 and 114 MHz for slot 8. These values have then been extrapolated to cold temperature. In addition, the values taken for the summing boards are: \(C_{SB}=30\)pF and \(L_{SB}=13.5\)nH (from direct bench measurements).

The parameters extracted from the fit on each channel of FT21A are presented in figure 46. In this case the impedance of the signal cable \(Z_{S}\) has been fixed to \(52\Omega\) (value obtained at low \(\eta\) where \(Z_{S}\) and \(\tau_{sh}\) are not too much coupled) in order to avoid a sizeable and unphysical rising evolution of \(\tau_{sh}\)4. The offset observed on the \(\Delta t\) distribution for slot 4 is not a systematic effect: it only show up for this particular FT.

Footnote 4: The sometimes observed - in particular in the front- coupling between a rising \(Z_{S}\) and a rising \(\tau_{sh}\) as a function of \(\eta\) is due to a lack of separation between the direct and reflected pulse at high \(\eta\) which is interpreted by the minimization programme as no reflection (high \(Z_{S}\)) and thus high \(\tau_{sh}\) (the pulse is globally wide).

As for the middle the correlations between parameters are illustrated in table 13. The parameters are highly correlated.

The shaping time \(\tau_{sh}\) is found around 14.6 ns. The normalisation is relatively uniform on the whole front range. The \(\Delta t\) parameter exhibits the V structures coming from the FEB behaviour.

\begin{table}
\begin{tabular}{|l|l|l|} \hline Factor & \(\eta\) range \\ \hline
1.042 & \(|\eta|<\)0.4 \\
1.041 & 0.4\(\leq|\eta|<\) 0.5 \\
1.039 & 0.5\(\leq|\eta|<\) 0.6 \\
1.038 & 0.6\(\leq|\eta|<\) 0.7 \\
1.035 & 0.7\(\leq|\eta|<\) 0.8 \\
1.041 & 0.8\(\leq|\eta|<\) 0.9 \\ \hline \end{tabular} 
\begin{tabular}{|l|l|l|} \hline Factor & \(\eta\) range \\ \hline
1.037 & 0.9\(\leq|\eta|<\) 1.0 \\
1.036 & 1.0\(\leq|\eta|<\) 1.1 \\
1.034 & 1.1\(\leq|\eta|<\) 1.2 \\
1.036 & 1.2\(\leq|\eta|<\) 1.3 \\
1.044 & 1.3\(\leq|\eta|\) \\ \hline \end{tabular}
\end{table}
Table 11: Correction factor for the attenuation effect for different bins in \(|\eta|\) in the back.

\begin{table}
\begin{tabular}{|l|l|l|} \hline Slot & Mean (\(10^{-2}\)) & RMS (\(10^{-2}\)) \\ \hline
9 & -1.1 & 0.88 \\
10 & -0.97 & 0.78 \\ \hline \end{tabular}
\end{table}
Table 12: Mean and RMS of the difference between the values of \(Mphys/Mcal\) extracted from the FPM and the one found with the RTM method for each slot (FT 21A) for the back.

To illustrate the quality of the fit, the \(\chi^{2}\) per degree of freedom is presented on figure 47a. An example of the calibration pulse - fit and data - and the corresponding physics pulse is

Figure 47: _(a) \(\chi^{2}\) of the fit with fixed \(Z_{S}\) and 3 free parameters shown as a function of the channel numbers, all the front slots are put one after the other. (b) Residuals between fit and data normalized to MCal for FT 21A._

Figure 46: _Front compartment values of the four parameters of the fit, 3 of them being fitted and the first one being fixed: (a) \(Z_{S}\), (b) \(\tau_{sh}\), (c) Normalisation, (d) \(\Delta t\), as a function of the channel numbers, for FT 21A._

represented on figure 48. The residuals between fit and data are smaller than 3% of the peak value as seen on figure 47b. The fit does not succeed in reproducing the behaviour of the data between 120-300 ns: this region would prefer a smaller effective value of \(T_{cali}\). In this region, the cross-talk plays an important role (see Fig. 22). To be less sensitive to it, it was decided to increase by a factor 2 the errors of the data measurement in this zone.

A comparison between this FT (21A) and the other ones is given on figure 49 where is shown the mean value of the difference of the fitted value of the parameters for each considered FT and the value of FT21A.

#### 5.5.2 \(Mphys/Mcal\)

The \(Mphys/Mcal\) ratio is presented in figure 50. It shows a relatively flat behaviour on the whole range. The structure can be associated to the attenuation in the calibration cables whose lengths are different from electrode A to electrode B and inside electrode B (see also Fig 51). The RTM method values are thus corrected for the attenuation by a factor depending on \(\eta\) : 1.0474 in Slot 2 to 5, 1.050 in Slot 6, 1.0515 in Slot 7 and 1.0546 in Slot 8. After correction, the RTM method shows values globally shifted from the FPM method. A global normalisation between both methods of 1.008 still remains without explanation. Table 7 gives the mean and rms of the distribution of the difference between both methods for each slot and then globally: apart from the global shift the agreement is good.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline  & \(\tau_{sh}\) & Norm & \(\Delta t\) \\ \hline \(\tau_{sh}\) & 1 & -0.84 & 0.88 \\ \hline Norm & -0.84 & 1 & -0.76 \\ \hline \(\Delta t\) & 0.88 & -0.76 & 1 \\ \hline \end{tabular}
\end{table}
Table 13: Typical correlation matrix between fitted parameters for the front

Figure 48: _On the left hand side: Calibration pulse for a front cell (FT 21A) in ADC counts as a function of time (in bins of 1.04 ns), black = data, red= fit, cyan: (data-fit)/MCal, on the right hand side: corresponding predicted physics pulse as a function of time (in bins of 1.04 ns)._

Figure 49: _Comparison for each fitted parameters of the mean value of the distribution between the FT quoted in the x axis and FT21A in the case where \(Z_{S}\) is fixed. The error bars reflects the resolution of the determination of the mean value using a gaussian fit on the distributions._

Figure 50: \(Mphys/Mcal\) ratio as a function of the channel numbers, all the front slots put one after the other, for FT 21A. The red ratio is extracted with the three free parameter fit procedure. The blue points are the ratio extracted from the RTM method after corrections for attenuation and bad termination.

#### 5.5.3 Systematics

The correlation between \(\tau_{sh}\) and \(Mphys/Mcal\) is shown in figure 51. A clear anticorrelation is observed, with a magnitude of about \(2.10^{-3}\) per ns of \(\tau_{sh}\). The shifts associated to different calibration cable lengths(thus different absorptions)are well visible.

#### 5.5.4 Channel to channel timing dispersion

Applying the same corrections as for the middle (cf. section 5.3.5), except for the odd and even channels effect, one can extract the channel to channel timing dispersion from the \(\Delta t\) determination. The results are quoted in table 15 on the left for all the tested FT of the front, the variations from slot to slot are small as it is shown on the same table on the right.

\begin{table}
\begin{tabular}{|l|l|l|} \hline Slot & Mean (\(10^{-3}\)) & RMS (\(10^{-3}\)) \\ \hline
2 & 7.9 & 0.74 \\
3 & 7.0 & 0.80 \\
4 & 8.4 & 0.89 \\
5 & 7.7 & 0.82 \\
6 & 4.9 & 0.63 \\
7 & 6.1 & 0.51 \\
8 & 5.7 & 0.78 \\ \hline \end{tabular}
\end{table}
Table 14: Mean and RMS of the difference between the values of \(Mphys/Mcal\) extracted from the FPM and the one found with the RTM method for each slot (FT 21A) of the front.

Figure 51: _Correlation of \(Mphys/Mcal\) with \(\tau_{sh}\) (ns) for FT 21A, in black for Slot 2, red for Slot 3, green for Slot 4, dark blue for Slot 5, yellow for Slot 6, pink for Slot 7 and light blue for Slot 8._

### Results of commissioning tests with presampler cells

Capacitance and resonance frequency of the presampler cells were mesured 5 recently using two sectors (3 and 8) remaining from production. Both measurements were done at room temperature.

Footnote 5: measurements made in collaboration with B. Lund Jensen.

The capacitances measured at warm are a factor 1.31 smaller than calculated in liquid argon [19]. This ratio is similar (albeit even a bit smaller) to what was obtained for the calorimeter (average ratio = 1.37). As a consequence we kept the calculated values.

The resonance frequencies gave a surprisingly large value of the inductance (about 53nH) probably associated to the two parallel wires connecting electrodes together.Very similar values of inductance were found for type 3 and type 8 modules. As a further check, it was verified that the fit had a smaller \(\chi^{2}\) with this value of L, as compared to much lower values (\(\simeq 10\)nH) used precedently in our work.

The signal and calibration cable lengths are increased by \(\simeq\)30cm to take into account the rather long path in mother boards, as opposed to much shorter ones (few cms) in the calorimeter mother boards.

For the summing boards, which do not exist as a separate element in the presampler, the following values were used: \(C_{SB}=5\)pF and \(L_{SB}=2\)nH. The parameters extracted from the fit on each channel of the FT21A are presented in figure 52. The shaping time \(\tau_{sh}\) is found around 14.15 ns. The normalisation is flat and similar to what was found for the front (\(\simeq\)650.000).

The correlation matrix is given in table 16.

\begin{table}
\begin{tabular}{|l|r|r|r|} \hline  & \(\tau_{sh}\) & Norm & \(\Delta t\) \\ \hline \(\tau_{sh}\) & 1 & -0.79 & 0.87 \\ \hline Norm & -0.79 & 1 & -0.68 \\ \hline \(\Delta t\) & 0.87 & -0.68 & 1 \\ \hline \end{tabular}
\end{table}
Table 16: Typical correlation matrix between fitted parameters for the presampler

\begin{table}
\begin{tabular}{|l|l|r|} \hline FT & Barrel A/C & \(\sigma\)(ns) \\ \hline
7 & C & 0.36 \\
8 & C & 0.33 \\
9 & C & 0.36 \\
10 & C & 0.33 \\
21 & A & 0.34 \\
22 & A & 0.33 \\
23 & A & 0.32 \\
24 & A & 0.30 \\
26 & A & 0.33 \\ \hline Total & & 0.34 \\ \hline \end{tabular} 
\begin{tabular}{|l|l|l|l|} \hline Slot & \(\sigma\)(ns) \\ \hline
2 & 0.34 \\
3 & 0.35 \\
4 & 0.32 \\
5 & 0.38 \\
6 & 0.33 \\
7 & 0.32 \\
8 & 0.30 \\ \hline \end{tabular}
\end{table}
Table 15: On the left: Time dispersions for each tested FT in the front after corrections (see text for details). On the right: Time dispersions per slot for all tested FT.

The \(\chi^{2}\) is presented in figure 53a for FT 21. For illustration, the residuals are also plotted on figure 53b. In the whole range the residuals are below 2 %.

A comparison of data and fit for a particular channel is shown in figure 54. A "ringing"

Figure 53: _(a) \(\chi^{2}\) of the fit with 3 free parameters shown as a function of the channel numbers for the presampler (b) Residuals between fit and data normalized to MCal for FT 21A._

Figure 52: _Presampler compartment values of (a) \(Z_{S}\) and the three free parameters of the fit : (b) \(\tau_{sh}\), (c) Normalisation, (d) \(\Delta t\), as a function of the channel number, for FT 21A._

indicative of non negligible pick-up is visible. It contributes to the residuals and the \(\chi^{2}\).

The \(Mphys/Mcal\) ratio is presented in figure 55. It shows a small increase (2.0%) with \(\eta\) as in the front. Small jumps by group of 4 channels - possibly associated to amplifiers or shapers have not yet been investigated.

Figure 54: _Calibration pulse for a presampler cell with measured error bars (Slot 1 Channel 100 FT 21A) in ADC counts as a function of time (in bins of 1.04 ns), black = data, red= fit, cyan = (fit-data)/MCal (the axis on the right hand side gives the value of this residuals) (a) and physics signal shape as a function of time (in bins of 1.04 ns)(b)_

Figure 55: \(Mphys/Mcal\) ratio as a function of the channel number for the presampler. The ratio is extracted with the three free parameters fit procedure (FT21A).

### Results of commissioning tests : Summary

As a summary of the sub-sections above, dedicated to commissioning data, with middle, back, front and presampler cells, the values obtained for \(Z_{S}\), \(\tau_{sh}\), Normalisation, and \(\Delta t\) are shown in figure 56. It shows that the time alignement is understood globally to a few ns. The variation in \(\tau_{sh}\) and Normalisation is largest in the middle cells which exhibit the largest capacitances. A certain fraction of the represented data points are significantly away from the bulk of the data. Corresponding cells need to be investigated, both at the raw data level, and for what concerns the convergence of the fit and the \(\chi^{2}\).

The \(\chi^{2}\) and \(Mphys/Mcal\) are shown in Fig. 57 and 58 respectively. The values of \(Mphys/Mcal\) go from 1.06 (in the front) up to 1.12 (in the middle).

Figure 56: _Values of the four free parameters of the fit for the complete FT21A: (a) \(Z_{S}\), (b) \(\tau_{sh}\), (c) Normalisation, (d) \(\Delta t\), as a function of the channel numbers for the presampler, front, back and middle._

## 6 Study of Combined test beam data

After the standalone testbeams up to 2002, it was realized that the contacts in one of the feedthroughs had became too resistive, and it was decided to replace this feedthrough by a spare from the barrel construction. This feedthrough is called in the following FT0 and has, like the final barrel calorimeter, signal pigtails of 90cm for the whole presampler and the front sampling up to \(|\eta|<\)0.6, and 70cm for the rest, the calibration pigtails being everywhere of 70cm.

Figure 57: \(\chi^{2}\) _values for the complete FT21A, as a function of the channel numbers for the presampler, front, back and middle._

Figure 58: \(Mphys/Mcal\) _values for the complete FT21A, as a function of the channel numbers for the presampler, front, back and middle._Figure 59: _Values of the four free parameters of the fit : (a) \(Z_{S}\), (b) \(\tau_{sh}\), (c) Normalisation, (d) \(\Delta t\), as a function of the channel numbers for middle cells of FT0 in black and FT1 in red._

Figure 60: _Values of the four free parameters of the fit : (a) fixed \(Z_{S}\), (b) \(\tau_{sh}\), (c) Normalisation, (d) \(\Delta t\), as a function of the channel numbers for front channels of FT0 in black and FT1 in red._

The remaining "old" feedthrough, called FT1 in the following, had pigtails all of the same length (1.5m).

The corresponding length differences affect both the absorption, the phase of reflected signals and the time delay.

As a further specific condition, in the half-create corresponding to FT0, middle slots of electrode A were equipped with FEBs normally dedicated to electrode B, and vice-versa (i.e. a 10mA against 5mA preamp type swap).

The \(T_{cali}\) value was also very different for the half crate corresponding to FT1 (\(\simeq\)330 ns in the middle and in the front) because an early version of the calibration board had been used.

For FT0 and FT1, the parameters obtained are shown in Fig. 59 for the middle and in Fig. 60 for the front. Note that the time delay (see fig 59d and 60d) is not directly comparable in absolute to the commissioning data. The \(\chi^{2}\) are given in Fig 61 and some signal shapes are presented in Fig. 62. To predict the calibration pulse shape, the same strategy as in section 5 has been used.

The resulting \(Mphys/Mcal\) ratio is shown in figure 63 for both FT0 and FT1 for the middle and in figure 64 for the front, it is compared to the result of the RTM method. Significant differences are observed.

Given the rather large difference observed in \(Mphys/Mcal\) for middle cells between FT0 and FT1, a detailed study was undertaken, starting from FT1 parameters and recalculating \(Mphys/Mcal\) after having introduced one after the other the specific values characterizing FT0:

* cable lengthes
* cable lengthes + \(T_{cali}\)
* cable lengthes + \(T_{cali}\) + FEB swap

It is interesting to note (see Fig 65) that the biggest step affecting slot 13 (channels 257 to 384) is induced by the change in cable lengthes. This is possibly associated to a different

Figure 61: _chi2 values (a) for the middle and (b) for the front, for the FT0 in black and FT1 in red._

Figure 63: \(Mphys/Mcal\) ratio for middle cells as a function of the channel number for FT0 in black and FT1 in red. In blue (for FT0) and green (for FT1) are superimposed the values extracted from the RTM method, multiplied by correction factors for attenuation.

Figure 62: _4 examples of pulses (in ADC counts) in the FT1 as a function of time (bins of 1.04ns) for (a) Slot 2 Channel 40, (b) Slot 6 Channel 40, (c) Slot 11 Channel 1 and (d) Slot 14 Channel 1, black = data, red= fit, cyan = (fit-data)/MCal (the axis on the right hand side gives the value of this residuals)._

interplay between direct and reflected signals (see Fig 8) when exchanging at the same time cable lengthes and physics/calibration signals.

Having modified the \(Mphys/Mcal\) of FT1 for the three effects listed above, one falls very

Figure 64: \(Mphys/Mcal\) ratio for front cells as a function of the channel number for FT0 in black and FT1 in red. In blue (for FT0) are superimposed the values extracted from the RTM method, multiplied by some correction factors for attenuation.

Figure 65: \(Mphys/Mcal\) ratio for middle cells as a function of the channel number: in black for FT0 and in red for FT1 (as in the figure 63. The intermediate conditions between FT0 and FT1 are studied in other colors : in dark blue when using the lengths of FT0 for FT1, in light blue when using lengths and \(T_{\rm cali}\) values of FT0 for FT1, and in green with FT0 lengths, \(T_{\rm cali}\) and inverted FEB conditions.

close to what is observed directly in FT0. This means that, as expected, the two halves of the exposed module behave intrinsically in the same way, the observed difference being due to the ancillary effects of cables and \(T_{cali}\). This same difference is also relevant for the path between the scanning conditions at fixed energy in stand-alone test beam (similar to FT1) and the forthcoming LHC data (well represented by FT0 conditions).

The shift in timing of about 10 ns observed at large \(\eta\) for both front and middle cells could originate from a wrong setting of the internal delay affecting this \(\eta\) range, in the calibration board.

## 7 Accuracy on signal reconstruction

To estimate how the shape description could affect the amplitude accuracy, a simplified optimal filtering signal reconstruction is applied with an autocorrelation function taken as the identity matrix. Assuming the phase of the signal is known the coefficients used to compute the amplitude are given by:

\[a_{i}=\frac{R^{-1}g}{g^{T}R^{-1}g}=\frac{g}{g^{T}g} \tag{60}\]

The predicted pulse shape has been used to compute the coefficients \(a_{i}\) which are applied to the calibration data signal iself. The figure 66 presents for the 128 channels of a front slot the dependance of the reconstructed amplitude as a function of the phase: the maximal deviation is \(\pm\) 0.4 %. In ATLAS, in synchronous mode, one sample will be taken near the peak of the signal. The average value and the RMS on the reconstructed amplitude for a few feedtroughs has been done with this assumption and is presented in figure 67 integrated over the front or the middle layer. The maximal bias is about 0.2 % and the RMS about 0.2 %. These numbers can be considered as the accuracy of the signal reconstruction for physics signals if the model describes correctly the difference between the calibration and physics signals.

Figure 66: _Dependance of the reconstructed amplitude as a function of the phase for the 128 channels of Slot 2 (FT 21A)._

## Conclusions

The calculations as described in this note are ready for use in the commissioning, as a further debugging tool. Examination of some of the plots for data taken so far do show that a small fraction of the analysed channels have a peculiar behaviour (parameters far from the average, bad \(\chi^{2}\)) which need to be understood.

The fit procedure has shown that some of the parameters are correlated. The consequences of fixing some of them (in particular Zs, the impedance of the signal line) have to be further assessed, in particular looking at the systematic differences that fixing a parameter or not induces on physics shape and Mphys/Mcal.

The allocation of preamplifier type (BNL or Milano) to each channel needs to be finalised.

The physics shape produced after fitting the calibration pulses channel by channel are available. It will be important to confront them to LHC data (some work with cosmic data has started already). With enough statistics one may be able to gain further insight in the model or its parameters.

The Mphys/Mcal values compare rather well with those obtained by the RTM method. Differences remain in some specific regions, or between "layers" which need to be resolved.

The fit of the time alignment channel by channel gives a first indication of the remaining systematic effects in time measurements. Further work is needed to bring the accuracy reached in the present work (\(\sim\)0.4 ns) down to the 100 ps range, necessary to exploit the constraints that the timing accuracy of the calorimeter can bring to some physics channels.

Figure 67: _Average value and the RMS on the reconstructed amplitude for different feedroughs (quoted on the x axis) (a) for the front and (b) for the middle._

## Acknowledgements

The work presented here could not have been done without frequent and often illuminating discussions with C.De la Taille, nor without his help for several measurements. We also benefited from discussions with M.Citterio, R.Chiche, J.Colas, M.Delmastro, F.Lanni, S.Simion, G. Unal and D.Zerwas. We thank L. Iconomidou-Fayard for many discussions and for her contribution to several measurements. The use of the grid was made possible thanks to the help of L.Duflot, G.Philippon and M. Jouvin. The text was put in shape with the help of C.Bourge. Finally, we thank W. Cleland for a critical reading of the manuscript and for several suggestions.

## Appendix 1 Causality condition

The calculation of the pulse as a function of time (see section 1.8) covers in principle from \(t=-\infty\) to \(t=+\infty\). Subtracting the time shift induced by the calibration and signal cables, in order to have the pulse starting at t=0 (with a rising time constant defined by the elements of the chain), the calculated pulse at t\(<\)0 should be identical to 0. This rather obvious causality feature is however non trivial in the calculation. Indeed, the pulse values at t\(<\)0 (like for t\(>\)0) result from an integration over \(\omega\), and the null value results from an accurate cancellation. Introducing measured quantities in the overall \(H(\omega)\) induced a violation of this cancellation, creating thus an unwanted "pedestal" whose magnitude(a few percent of the peak amplitude) was also indicative of the inaccuracy of the measurements. In order to restore the "causality condition" for the preamplifier transfer function (or any other multiplicative term in \(H(\omega)\)) one can use the fact that a function \(f(t)\) identical to 0 for t\(<\) 0 is half the sum of an odd function \(f_{1}\) and an even function \(f_{2}\), with \(f_{1}(t)\) and \(f_{2}(t)\) being equal to \(f(t)\) for t\(>\) 0.Using furthermore the condition that the transfer function is a real function of time, one obtains that \(g_{2}(\omega)\),the fourier transform of the even function \(f_{2}(t)\) is real and can be written as:

\[g_{2}(\omega) = 2\int_{0}^{\infty}f(t)\cos(\omega t)dt \tag{61}\]

and similarly the fourier transform of \(f_{1}\) is imaginary and can be written as:

\[g_{1}(\omega) = 2i\int_{0}^{\infty}f(t)\sin(\omega t)dt \tag{62}\]

Inverting these relations, and using again the above symetries, one gets two independent ways of calculating \(F(t)\) from the measured real and imaginary part of the transfer function \(G(\omega)\) in the \(\omega\) space.

\[F_{1}(t) = 2\int_{0}^{\infty}Re[G(\omega)]\cos(\omega t)d\omega \tag{63}\] \[F_{2}(t) = 2\int_{0}^{\infty}Im[G(\omega)]\sin(\omega t)d\omega \tag{64}\]

Having selected one of these two intermediate functions (\(F_{1}\), \(F_{2}\) or their average) one projects back using Eqs.62 and 61 to get two new \(G_{1}(\omega)\) and \(G_{2}(\omega)\) which "by construction" respect the causality condition.

We found that the two "reconstructed" \(F(t)\) were indeed slightly different, and that using the one derived from the measured imaginary part was giving the best results(ie \(F(t)\) for t\(<\) 0 closer to 0). This is what is being used in the calculations. The shapes in the t\(>\)0 region are hardly different visually from the one obtained using directly \(g_{1}\) and \(g_{2}\) instead of \(G_{1}\) and \(G_{2}\).

As a side remark, one can point out here that the half sum of \(g_{1}\) and \(g_{2}\) which is the fourier transform of \(f\) can be written as:

\[g(\omega)=\int_{0}^{\infty}f(t)\exp[i\omega t]dt \tag{65}\]

which is the Laplace transform of \(f\) where the Laplace variable "p" is formally replaced by \(i\omega\).

The transfer function of resistive cables (Eqs 3 and 4) satisfies this condition, as well as the shaper transfer function.

## Appendix 2

**Terms for second order reflections**

Here are the details of the second order reflections

\[H_{1D21} = H_{1D}.H_{21}/H_{tot} \tag{66}\] \[\Phi_{1D21} = \Phi_{1D}+\Phi_{21}-\Phi_{tot}\] (67) \[H_{2D21} = H_{2D}.H_{21}/H_{tot}\] (68) \[\Phi_{2D21} = \Phi_{2D}+\Phi_{21}-\Phi_{tot}\] (69) \[H_{1D1D} = H_{1D}.H_{1D}/H_{tot}\] (70) \[\Phi_{1D1D} = \Phi_{1D}+\Phi_{1D}-\Phi_{tot}\] (71) \[H_{1D2} = H_{1D}.H_{2D}/H_{tot}\] (72) \[\Phi_{1D2D} = \Phi_{1D}+\Phi_{2D}-\Phi_{tot}\] (73) \[H_{2D2} = H_{2D}.H_{2D}/H_{tot}\] (74) \[\Phi_{2D2} = \Phi_{2D}+\Phi_{2D}-\Phi_{tot}\] (75) \[H_{2121} = H_{21}.H_{21}/H_{tot}\] (76) \[\Phi_{2121} = \Phi_{21}+\Phi_{21}-\Phi_{tot} \tag{77}\]

When summing all the second order contributions, the \(H_{1D2D}\), \(H_{1D21}\) and \(H_{2D21}\) have to be taken into account twice.

[MISSING_PAGE_FAIL:68]

Given the fact that the connector has 4 rows, some signals have neighbours in the connector that are far away in the detector: like signal 9, on pin 14 is close to signal 25 on pin 40.
* _Middle+Back:_ the same pattern applies

**Warning! In figure 68 signals and pins are counted 1, 2, 3,..., while in all other places they are counted 0, 1, 2,...**

Figure 68: _Location of signals (green dots) and ground pins (red dots) on the MicroD connector (left), and on the ATI connector (right) (signals are red and ground contacts are green)._

[MISSING_PAGE_EMPTY:70]

Figure 70:

## References

* [1] "ATLAS Liquid Argon Calorimeter TDR", CERN LHCC/96-41
* [2] "Cell response equalization of the ATLAS electromagnetic calorimeter without the direct knowledge of the ionization signals", Banfi D., Delmastro M., Fanti M., SN-ATLAS-2005-054; Published in: J. Instrum.: 1 (2006) pp.P08001
* [3] "Understanding the ATLAS electromagnetic barrel pulse shapes and the absolute electronic calibration", Neukermans L., Perrodo P., Zitoun R., ATL-LARG-2001-008
* [4] "Electrical measurements on the Atlas electromagnetic barrel calorimeter", S. Baffioni et al., ATLAS note LARG-2006-009
* Paris 1966
* [6] "Time resolution of the ATLAS barrel liquid argon electromagnetic calorimeter", I. Nikolic-Audit and L. Serin, ATL-LARG-2004-002.
* [7] Barrel Mother boards: see [http://www.usatlas.bnl.gov/detector/lar/mb](http://www.usatlas.bnl.gov/detector/lar/mb)
* [8] "Transmission line connections between detector and front-end electronics in liquid argon calorimetry", R.L. Chase, C. de la Taille, S. Rescia, and N. Seguin, NIM A330(1993) 228-242
* [9] "Radiation hard micro-coaxial cables for the Atlas liquid argon calorimeters", W. Bonivento, E. Collet, P. Imbert and C. de la Taille, NIM A451 (200) 492
* [10] "Electronics calibration board for the liquid argon calorimeter" J. Colas et al. ATL-LARG-2007-xx
* [11] "Signal feedthroughs for the ATLAS barrel and endcap calorimeters", D. Axen et al., ATL-LARG-2004-013 and Journal of Scientific Instruments
* [12] "A fast monolithic shaper for the ATLAS electromagnetic calorimeter" Chase et al., ATL-LARG-95-10
* [13] "Fastest Fourier Transform in the West' [http://www.fftw.org/](http://www.fftw.org/) and the design and implementation of FFTW3", Frigo M. and Johnson S., Proceedings of IEEE (2005), 93, 2, 216
* [14] "Cross-talk in the Atlas electromagnetic calorimeter", J. Colas et al., ATL-LARG-2000-004
* [15] Current in the detector, communication with G.Unal.
* [16] "Preamplificateur de courant bas bruit pour le calorimetre electromagnetique d'ATLAS" Y. Jacquier, these-Universite Paris Sud (1997) "Stability of a line receiver preamplifier connected to a capacitive detector via a transmission line", G. Battistoni et al., NIM A424 (1999) 533-544.
* [17] "Construction, assembly and tests of the ATLAS electromagnetic barrel calorimeter", B. Aubert et al., NIMA A558 (2006) 388-418
* [18] "Performance of the Atlas electromagnetic calorimeter barrel module 0", B. Aubert et al., NIM A500(2003),202-231.
* [19] Z. Szkutnik. Minuit++ replacement for minuit and hep statistical tools: user requirements document. Minuit-URDDraft, October 1997. (see also: [http://wwwinfo.cern.ch/asd/lhc++/requirements/stable/URD/html/](http://wwwinfo.cern.ch/asd/lhc++/requirements/stable/URD/html/)).
* [20] "Construction and Test of the first two sections of the ATLAS barrel liquid argon presampler", M. L. Andrieux et al., NIM A479 (2002) 316-333.