The ATLAS Level-1 Calorimeter trigger (L1Calo) identifies high-\(p_{T}\) objects like electrons, jets and taus in LHC collision events and determines total and missing \(E_{T}\) deposited in the Tile and Liquid Argon Calorimeters. The timing synchronization of 7168 L1Calo Trigger Towers with respect to the LHC clock is derived from digitized signals by means of a special fit method. The method which emulates the analogue calorimeter signal shape has been validated to within a statistical and systematical accuracy of \(\pm 3\,\mathrm{ns}\). This precision is required for a reliable bunch-crossing identification, accurate Level-1 energy measurement, and thus stable operation of the ATLAS trigger system, including high Level-1 trigger efficiencies. To maintain and refine the synchronization during 2010 and 2011, six updates of the timing synchronization as well as three additional cross-checks were conducted with data from \(pp\)-collisions at \(\sqrt{s}=7\,\mathrm{TeV}\). Since the first update in July 2010, the mean required timing adjustments per calorimeter layer have been smaller than approximately \(\pm 1.5\,\mathrm{ns}\), and the average spread between trigger towers has been reduced to around \(1\,\mathrm{ns}\) towards the end of 2011. The note presents the fit method and describes the updates in the timing synchronization in 2010 and 2011.

Introduction

The Large Hadron Collider (LHC) at CERN is designed to search for physics beyond the Standard Model at the TeV energy scale by colliding protons at centre-of-mass energies up to \(14\,\mathrm{TeV}\) and instantaneous luminosities up to \(10^{34}\,\mathrm{cm}^{-2}\mathrm{s}^{-1}\). Online selection of the relevant collision events is performed at the ATLAS detector [1] by a 3-stage trigger system. The Level-1 (L1) trigger operates at \(40\,\mathrm{MHz}\), the same frequency as the bunch-crossing rate of the LHC, and provides within a fixed latency of \(2.5\,\mathrm{\mu s}\) a decision based on fast processing of data with coarsened detector granularity. The Level-1-Accept (L1A) is generated by the Central Trigger Processor (CTP) which receives information mainly from the Level-1 calorimeter (L1Calo) and the Level-1 muon trigger (L1Muon) but also includes the Minimum Bias, forward detectors and Beam Pickup triggers. The hardware-based L1-system is designed to reduce the trigger rate to \(75\,\mathrm{kHz}\). Level-2 (L2) trigger and Event Filter (EF) access the full detector granularity for event reconstruction and are devised to lower the event rates to \(3.5\,\mathrm{kHz}\) after the L2-decision and to \(200\,\mathrm{Hz}\) after EF-decision. Both consist mainly of a network of commercially available computers and together form the Higher Level Trigger (HLT). Events having passed the EF selection are stored for offline analysis with event sizes of \(\sim 1.3\,\mathrm{MB}\)[1]. The quality of the event selection, especially on Level-1, depends on a number of calibrations. For the L1Calo trigger, the timing synchronization of the handled signals is of large importance.

The L1Calo system processes 7168 analogue signals from the Liquid Argon (LAr) and Tile Calorimeters of the ATLAS detector [2][3]. These signals originate from energy depositions of ionizing particles measured in the respective active material of the finely segmented calorimeters. For triggering, the high calorimeter granularity and thus the number of processed signals is reduced by merging groups of calorimeter signals on the calorimeter front-end electronics to so-called Trigger Tower (TT) signals. These TTs consist of up to 60 calorimeter cells and provide a coverage of \(0.1\times 0.1\) in \(\Delta\eta\times\Delta\phi\)1 in the central calorimeter regions with precise transverse energy measurement and a larger coverage in the outer calorimeter regions. For the L1Calo trigger, the analogue TT signals are transferred to the L1Calo Receiver where an analogue calibration is applied by means of variable gain amplifiers. A conversion from energy \(E\) to transverse energy \(E_{T}\) is performed depending on the calorimeter region either on the calorimeter front-end electronics or in the Receivers. Subsequently to the Receiver, the signals are sent to the PreProcessor system (PPr). Here, the signals are synchronized and digitized every \(25\,\mathrm{ns}\). Their bunch-crossing is identified (BCID) and the transverse energy determined. The digital output of the PPr system is processed by the Cluster Processor (CP) and Jet/Energy-Processor (JEP) which search for and identify high-\(p_{T}\) electrons/photons, taus/hadrons and jets using sliding window algorithms [4]. The object multiplicities per selected threshold from CP and JEP and information on the total and missing \(E_{T}\), provided also by the JEP system, are transmitted to the Central Trigger Processor. In conjunction with information from other L1 systems, the L1A is generated which triggers a complete readout of the detector, including data from the L1 system, to the Data Acquisition System (DAQ). For more details about the L1Calo system see [5].

Footnote 1: The ATLAS experiment uses a right-handed coordinate system with the origin at the nominal interaction point in the centre of the detector and the z-axis pointing in the direction of the beam pipe. In the transverse detector plane, cylindrical coordinates \((r,\phi)\) are often used with \(\phi\) being the azimuthal angle around the beam pipe. The pseudorapidity \(\eta\) is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan\left(\theta/2\right)\).

Within the PPr system, the signal digitization can be adjusted in time for every TT in order to synchronize the digitization of the TT signals with respect to the LHC clock and with respect to each other. A TT-specific and individually-adjustable delay register (FIFO) is used for a coarse timing adjustment in steps of \(25\,\mathrm{ns}\). A finer timing adjustment is enabled by the PHOS4 chip which allows to shift the digitization point for each TT individually in 25 steps of \(1\,\mathrm{ns}\). Together, both procedures allow to set the sampling of the analogue TT signal directly to the maximum of the analogue signal peak for the central digitized time-slice. Incorrect digitization leads to changes in the shape of the digitized signals which influence the results of the BCID logic in the PPr system. For non-saturated signals, this logic consists mainly of a peak-finding algorithm combined with a finite-impulse-response-filter which is tuned for the expected signal shape, while for saturated pulses the BCID algorithm is mainly based on the constant rise time of the calorimeter signals [5].

Thus, the timing synchronization of the TT signals strongly affects the identification of the correct bunch-crossing and, furthermore, the measurement of deposited energy in the TTs. For a stable operation of the BCID determination for non-saturated pulses, a sampling of the analogue pulse with a precision of \(\pm 10\,\mathrm{ns}\) is required. Correct bunch-crossing identification is, in turn, a prerequisite for the simultaneous processing of signals belonging to the same bunch-crossing in the CP and JEP systems and, thus, for the object identification by these processor systems. Even more sensitive than the BCID logic is the L1-energy measurement. In order to achieve an accuracy better than \(2\,\mathrm{\char 37}\) for the energy measurement of non-saturated pulses, a precision of the timing synchronization of \(\pm 5\,\mathrm{ns}\) is needed. Therefore, the aim for the timing synchronization of the L1Calo trigger was to develop and apply a method which achieves a precision of the timing synchronization at the level of a few nanoseconds.

The results of the timing synchronization from data of proton-proton (\(pp\)) collisions in 2010 and 2011 with \(\sqrt{s}=7\,\mathrm{TeV}\) were obtained with a special fit method for TT signals [6] and are presented in this note as follows. A general discussion of the fit method used for synchronizing the L1Calo TTs including a performance estimate using calibration signals is given in section 2, with the fit functions per calorimeter region discussed in particular in section 2.1 and the quality selection of the applied fits in section 2.2. The procedure for the application of the fit method to collision data is explained in section 3 and the effect of the L1Calo timing synchronization on the efficiency of individual L1 trigger items in section 4. Section 5, finally, provides an overview of the updates of the timing synchronization conducted in 2010 and 2011 and the evolution of the timing synchronization throughout this time (sections 5.1 and 5.2, respectively).

## 2 Fit method for L1Calo timing synchronization

The timing synchronization of the L1Calo system requires the determination of the hardware digitization settings for which the signals of deposited energy in each TT are sampled at the maximum of the analogue signal peak. This then ensures the correct operation of the BCID logic, a precise L1Calo energy measurement and the parallel processing of associated signals in the CP and JEP systems. However, the time-of-flight of the particles that generate the signals and the duration of the signal transfer from the calorimeters to the L1Calo hardware depend strongly on the location of the TT within the calorimeter system. The signal transfer cables, for example, vary in length between \(30\,\mathrm{m}\) for the shortest LAr barrel cables and \(70\,\mathrm{m}\) for the longest Tile extended barrel cables. Hence, the propagation delays of the calorimeter signals need to be determined for each TT individually. First approximate settings for the timing synchronization were derived using calibration data and so-called LHC splash events in 2009 and early 2010 [7] where splash events result from single beams interacting with collimators in the beam pipes at \(\pm 145\,\mathrm{m}\) from the centre of the ATLAS detector. Since the precise determination of the timing synchronization including the correct estimation of the particle time-of-flight is however only possible with collision data, since July 2010, improved settings for the timing synchronization have been incrementally applied to the L1Calo TTs using \(pp\)-collision data at \(\sqrt{s}=7\,\mathrm{TeV}\).

As the analogue calorimeter pulses are not easily available during collision-data taking, the L1Calo timing synchronization must be inferred using the read-out TT signals sampled with \(40\,\mathrm{MHz}\), i.e. one sample every \(25\,\mathrm{ns}\). In order to derive the timing synchronization with a nanosecond precision from these digitized signals, the fit method presented here has been developed.

The main idea of the fit method is to reconstruct the analogue pulse, or at least its maximum position and height, from the digitized calorimeter pulses using a fit with an optimized function. This fit function tries to emulate the analogue pulse shape such that the fit result is independent of the current digitization point and hence gives a measure for the correction which is needed in order to achieve the timing synchronization. Signal pulses which arrive at the L1Calo system, however, vary in shape depending on their calorimeter region of origin due to differences in production and electronic processing. These pulse shape variations have to be incorporated and reflected by the fit method in order to achieve the required precision. Thus, whereas the general principle for the timing synchronization is identical throughout the entire calorimeter, modifications in the fit method according to the calorimeter region and to a lesser extent for each TT are required as an essential part of the timing procedure.

### Calorimeter regions and analytic pulse description

In the electromagnetic barrel and end-cap calorimeters, signals are produced by ionization of liquid argon between accordion-shaped lead electrodes. The resulting triangular-shaped signals of approximately 450 ns duration are shortened via electronic shaping into a bipolar pulse with the positive part of approximately 150 ns, i.e. 6 bunch-crossings duration and the height of the pulse being proportional to the deposited energy. The electronic shaping also generates a long negative signal part, the so-called undershoot, which reaches in the electromagnetic barrel calorimeter a height of approximately 20 % of the positive signal height. These signal features are the result of the production mechanism and the electronic processing of the ionization signals. Although for the hadronic end-cap, the forward and the hadronic Tile calorimeters different geometries and technologies are used, the general shape of signal pulses is nonetheless similar to the signal shape in the electromagnetic barrel and end-cap calorimeters. The exact numbers for specific signal features such as the height of the undershoot are, however, only consistent within the calorimeter regions and differ notedly between different regions.

For the fit method for L1Calo timing synchronization, TTs with equal pulse shape features are thus grouped together according to their calorimeter region, where the following regions, henceforth called calorimeter divisions, are distinguished for the fit method: electromagnetic barrel calorimeter (EMB), electromagnetic end-caps (EMEC), electromagnetic overlap region (emOverlap), forward calorimeters both in the electromagnetic and hadronic calorimeter layer (FCal), hadronic Tile calorimeter (Tile) and the hadronic end-cap calorimeter (HEC). Details on the calorimeter divisions are listed in Table 1, together with information on the fit method which will be discussed in the following.

Depending on the calorimeter division, TT signals from events of \(pp\)-collisions (see section 3 for the selection criteria), sampled every 25 ns, are fitted with a conjunction of a Gaussian and a Landau function (GLu) or two Landau functions (LLu). Due to the asymmetry of the pulses, combined functions which are joined at the maximum (such as the mentioned ones) have been found to describe the pulses best. The GLu and LLu fit procedures employed here were tested in many different ways to ensure a reasonable stability of the fits and a high reliability of the fit results. The mathematical expression for the GLu fit function is given in equations (1) and (2).

\[f\left(x\leq x_{max}\right)=A\cdot\exp\left(-\frac{\left(x-x_{max}\right)^{2}} {2\cdot\sigma_{Gauss}^{2}}-\frac{1}{2}\right)+C \tag{1}\]

\[f\left(x>x_{max}\right)=\left(A+e^{+1/2}\cdot D\right)\cdot\exp\left(-\frac{1 }{2}\left(\frac{x-x_{max}}{\sigma_{Landau}}+\exp\left(-\frac{x-x_{max}}{ \sigma_{Landau}}\right)\right)\right)-D+C \tag{2}\]

The parameter \(x_{max}\) denotes the maximum position of the signal in units of ns, \(A\) the amplitude of the signal fit in the hardware units of the digitization, i.e. in ADC counts, and \(\sigma_{Gauss}\) and \(\sigma_{Landau}\) the fit widths in ns for the rising and trailing edge of the pulse, respectively. \(C\) stands for a constant offset or pedestal of the pulse, and \(D\) allows the fit to fall below its pedestal value, which is important for pulses with an undershoot, especially in the LAr calorimeter. Both \(C\) and \(D\) are given in units of ADC counts. For the LLu, the fit function is similar to equations (1) and (2) but where the Gaussian has been replacedby another Landau function like equation (2) however with parameter \(D=0\). The parameters \(x_{max}\) and \(A\) are designed to be identical2 for both parts of the fit function which for \(A\) results in the fact that the amplitude \(A\) of the pulse fit is different from the pulse height \(y=f\left(x=x_{max}\right)=A\cdot\exp\left(-1/2\right)+C\).

Footnote 2: In the case of parameter \(A\), this is ensured with the \(\exp\left(-\frac{1}{2}\right)\)-term in the Gaussian part and the \(e^{+1/2}\)-term in front of the first mentioning of parameter \(D\) in the Landau part, since then the terms containing D cancel and \(f\left(x\right)\) reduces to the same expression for \(x=x_{max}\) for both function parts.

An example of how the fit method for the timing synchronization works is given in Figure 1. Here, a calibration pulse is shown which was sampled with two different digitization settings in the L1Calo PPr system. The pulse in Figure 1(a) is well timed, i.e. it was digitized close to the analogue signal peak which results in two distinct features of the digitized pulse. First, the pulse maximum is unambiguously identifiable and lies in the central time-slice of the readout window for the signal. Second, the energy of the digitized samples to the left and the right of the maximum is similar but with an asymmetry leading to a slightly higher energy on the right side of the maximum. The pulse in Figure 1(b) is however obviously mistimed. It shows no clear maximum but rather two values of approximately the same height. As a result, the identification of the bunch-crossing the signal belongs to is ambiguous, and the energy which is derived from the pulse height is underestimated. To both pulses in Figure 1, a GLu fit has been applied. The fit reconstructs the shape and, especially, the maximum position and amplitude of the analogue TT pulse before digitization. It is required to be independent of the current digitization setting and the fit results for the maximum position and amplitude are thus expected to be identical for both pulses. In Figure 1, the maximum positions (in ns) and amplitudes determined by the two GLu fits agree as required within the uncertainties, apart from a 12 ns shift due to the different digitization settings of the two calibration pulses. For the timing synchronization from collision data, no correction is therefore needed for a signal with a pulse shape akin to the calibration pulse in Figure 1(a), whereas a correction of 12 ns in the timing synchronization is required for a TT with signals similar to the pulse in Figure 1(b).

While for calibration pulses 15 time-slices of a TT pulse are read out from the L1Calo trigger system as displayed in Figure 1, during normal collision data-taking only 5 time-slices of the TT signals can be handled by the DAQ system as a result of the high luminosity of \(pp\)-collisions at LHC and the finite data bandwidths for the detector readout. This restricts the fit range for the GLu and LLu functions quite significantly and is the reason why only 4 time-slices (or 3 in FCal) around the signal peak are used for the fit method for timing synchronization (see Figure 1). The fit ranges as well as the functions used for the individual calorimeter divisions are listed in Table 1 where the respective fit functions have been chosen according to their performance in identifying the analogue pulse maximum as accurately as possible. Due to the complexity of the GLu and LLu functions and the limited fit range, the number of fit parameters must be restricted and specifically tuned in order to obtain a reliable and stable fit result.

\begin{table}
\begin{tabular}{l c c c c c}
**Calorimeter** & **Fraction** & \(\eta\)**-range** & **Granularity in** \(\Delta\eta\times\Delta\phi\) & **Fit procedure** & **Fit range** **[\#samples]** \\
**divisions** & **of TTs** & & & **dure** & **[\#samples]** \\ \hline EMB & 25.0 \% & \(|\eta|<1.4\) & \(0.1\!\times\!0.1\) & GLu & 4 \\ emOverlap & 1.8 \% & \(1.4<|\eta|<1.5\) & \(0.1\!\times\!0.1\) & GLu / LLu & 4 \\ EMEC & 21.4 \% & \(1.5<|\eta|<3.2\) & \(0.1\!\times\!0.1\) & \((1.5<|\eta|<2.5)\) & LLu & 4 \\  & & & \(0.2\!\times\!0.2\) & \((2.5<|\eta|<3.1)\) & & \\  & & & \(0.1\!\times\!0.2\) & \((3.1<|\eta|<3.2)\) & & \\ FCal & 3.6 \% & \(|\eta|>3.2\) & \(0.4\!\times\!0.4\) & LLu & 3 \\ Tile & 26.8 \% & \(|\eta|<1.5\) & \(0.1\!\times\!0.1\) & GLu & 4 \\ HEC & 21.4 \% & see EMEC & see EMEC & LLu & 4 \\ \end{tabular}
\end{table}
Table 1: List of the calorimeter divisions and the fit procedures for the individual calorimeter divisions, including the range of the fit application.

The number of free parameters for the 6-parameter GLu / LLu fits as defined in equations (1) and (2) is reduced by fixing the widths \(\sigma_{Gauss}\) and \(\sigma_{Landau}\) and the undershoot-to-amplitude ratio \(D/A\) to predefined values derived from calibration data. The pedestal parameter \(C\) is fixed to the values for the signal baseline per TT which are set in the L1Calo hardware before digitization. Only the maximum position \(x_{max}\) and the amplitude \(A\) are allowed to vary freely within constraints.3 Especially important in this context is the correct determination of the \(\sigma\)-widths of the applied fits as they strongly influence the fit success. The \(\sigma\)-widths are determined on a TT-basis from calibration signals. For some calorimeter divisions, however, calibration and collision signals differ in signal widths which reduces the fit efficiency if the collision signals are fitted with the widths obtained from calibration data. Aiming to optimize the fit efficiencies in these regions, \(\eta\)-dependent scaling factors between collision and calibration signals were thus estimated. For the EMEC calorimeter, for example, the discrepancies in signal widths were found to be on the order of magnitude of 5-15 %, while for the hadronic forward calorimeters they were estimated to reach even up to approximately 20-30 %. In the absence of a detailed study of the pulse shapes of collision signals with respect to calibration signals, these estimates are used to scale the \(\sigma\)-widths in some calorimeter regions for the GLu / LLu fits for the timing synchronization since November 2010.

Footnote 3: An exception are signals in the EMB. For the GLu fit of these signals, the undershoot parameter \(D\) is allowed to vary freely in addition to the maximum position \(x_{max}\) and the amplitude \(A\).

Estimated from calibration data, the fit method for the timing synchronization has a \(\pm 2\) ns statistical uncertainty and \(\pm 1\) ns systematic uncertainty for collision data. The statistical uncertainty arises from fluctuations of the fit results when fitting various collision signals in each TT. This can however be reduced to some degree with increasing statistics per TT. The systematic uncertainty estimated from calibration signals results mainly from the choice of the fit procedure. For collision signals however, the systematic uncertainty is in fact dominated by the imprecise knowledge of the scaling factors between the collision and calibration signal widths. The effect of misestimations of the differences in signal widths has been investigated and for discrepancies in fit \(\sigma\)-widths of \(\leq\pm 10\) % found to correspond to a systematic uncertainty in the fitted time of \(\lesssim\pm 3\) ns [6]. Together, these uncertainties therefore result in a combined statistical and systematic uncertainty of \(\sim\pm 3\) ns. With respect to the precision of the digitization point setting of 1 ns in the L1Calo hardware, the method's accuracy lies well within the targeted precision of \(\pm 5\) ns which is required for correct BCID and L1Calo energy measurement.

Figure 1: Calibration signal pulse for one TT in the EMB which was recorded with two different digitization settings in the L1Calo PPr system. The deposited energy (in hardware units of ADC counts) is plotted versus the time duration of the pulse using an arbitrary starting point for the time. (a) A well timed pulse. (b) A pulse with the timing shifted by 12 ns. Both pulses were fitted using the GLu function.

### Fit quality selection

A quality selection for the applied fits based on empiric fit quality criteria has been developed and is employed to mark fits as successful or failed and exclude the latter. The cuts for this selection were optimized to keep the statistics in the TTs as high as possible, not introduce any bias and still ensure a good quality of the fits classified as successful. The selection results in a proportion of more than 90 % of successful fits for most calorimeter divisions, and thus ensures that bad fits do not influence the derived corrections for the timing synchronization.

In detail, the fit quality selection requires the convergence of the ROOT fit-algorithm, a good agreement between the fit and the digitized TT pulse shape and restricts discrepancies between an additional parabola matching in the peak range4 of the pulse and the main fit procedure to limits of less than 10 ns in maximum position and less than 10 % in fit height. If one of the quality criteria fail, the fit and the TT signal are excluded from further analysis, other signals and fits in the same event are however kept if classified as successful fits. Owing to its high stability, the parabola provides a good reference for comparison below the 25 ns-sampling of the pulse. As a result of its symmetric nature but the asymmetry of the analogue signals, the parabola however yields systematically wrong results on the relevant ns-scale. This reduces the precision of the parabola matching significantly compared to other asymmetric fit functions, such that it cannot be used as actual fit procedure for the L1Calo timing synchronization.

Footnote 4: The parabola is applied on the 3 signal samples around and including the maximum of the signal. Since the function itself also has 3 parameters, the parabola is thereby fully constrained, i.e. has no degree of freedom. This fact makes it very stable but not necessarily precise.

## 3 Timing Synchronization with Collision Data

At the beginning of 2010, the LHC for the first time collided protons with \(\sqrt{s}=7\,\mathrm{TeV}\), starting at low luminosities. While the analysis of the LHC splash events with relatively high signal-occupancies in the TTs had provided the first approximate timing synchronization, both in 2009 and early 2010 [7], with the constantly increasing luminosities during collisions in 2010, by July the amount of data collected within a few days was sufficient to determine the first L1Calo timing synchronization from collision data. The digitization settings implemented then were hence checked and improved by applying the developed fit method (as presented in section 2) to signal pulses from \(pp\)-collisions. The procedure for the selection of proper collision events and the determination of the final timing adjustments required for the 7168 L1Calo TTs is discussed in this section.

### Event and pulse selection

A crucial point for the timing synchronization is to ensure that only signal pulses caused by particles from the primary \(pp\)-interaction in the event are fitted and employed for the derivation of the required timing adjustments. Possible contaminations from beam-gas events, calorimeter noise, etc. therefore need to be minimized by several cuts which can be divided in an event selection and a pulse selection. The precise requirements have evolved several times in 2010 and 2011, mostly to adapt for the increasing LHC luminosities. Therefore, mainly the selection at the end of 2011 is discussed in the following, and differences to earlier versions are only indicated if appropriate.

The event selection ensures a certain basic data quality of the analyzed LHC collisions. Events are considered only if they were taken during stable beam conditions, with the detector, in particular the calorimeters, fully operational. A primary vertex with a maximum displacement along the z-direction of the detector is required in addition, as well as a minimum number of tracks from the vertex. These requirements enhance the probability for the analyzed signals to originate from head-on \(pp\)-collisions,instead of beam-gas events or low-energy grazing collisions which might yield imprecise time-of-flight estimates.

The pulse selection aims to ensure a good quality of the signals by reducing the number of faulty pulses and low-energy signals which mainly result from calorimeter noise. On the L1Calo side, faulty or noise pulses are characterized by distorted signal shapes which differ significantly from calibration or collision signals. For calorimeter divisions which are especially susceptible to calorimeter noise, e.g. the HEC calorimeter, a special noise suppression is therefore applied based on a comparison of signal shapes of the individual calorimeter-cell signals to signal template pulses whose results are merged for the L1Calo TTs. In case of large discrepancies, the corresponding TT signals are excluded from the L1Calo timing analysis. For the HEC calorimeter, this noise suppression has been in use since July 2010, while for the other calorimeter divisions this noise cut with looser limits has been in place only since August 2011, except in the Tile calorimeter where a noise suppression as described is not necessary. Another, noise suppression is given through the fit quality selection as described in section 2.2. Distorted, i.e. faulty / noise pulses lead to failing fits and therefore also to an exclusion of the TT signal from further analysis. This fit-based method of noise suppression has been applied for all calorimeter divisions since July 2010. Finally, for all signals a minimum transverse energy of approximately 7 GeV measured by the L1Calo trigger is required.

Figure 2 shows \(\eta\)-\(\phi\)-maps of the distribution of the number of signal pulses in the electromagnetic and hadronic calorimeter layers after the application of the event and pulse selections. The distributions are based on an integrated luminosity of approximately 30 nb\({}^{-1}\) and represent the data set that was used for the first L1Calo timing synchronization from collision data in July 2010. The data samples for the timing synchronization consist largely of QCD di-jet and multi-jet events. This ensures a reasonable signal coverage throughout the calorimeter since jets affect both the electromagnetic and the hadronic calorimeter layer. Variations in the number of analyzable signals with respect to \(\eta\), as visible in Figure 2, are the outcome of geometrical and calorimeter division related differences in the signal occupancy. These variations always entailed special difficulties for the timing synchronization in regions with very few signal numbers, e.g. at \(\eta=3.15\) in Figure 2(b). White regions in the \(\eta\)-\(\phi\)-maps mark TTs with no usable signal within the analyzed data set, whereas the horizontal white stripes in the Tile calorimeter

Figure 2: Distribution of the number of signal pulses corresponding to energy deposits of more than approximately 7 GeV in the electromagnetic calorimeter layer (a) and in the hadronic calorimeter layer (b) for a data set from the beginning of July 2010. This data set was employed for the first L1Calo timing synchronization with 7 TeV \(pp\)-collision data.

(Figure 2(b), \(|\eta|<1.5\)) are the result of non-functional calorimeter modules leading to the absence of signals. In the more central parts, however, numbers of signals on the order of several hundreds up to thousand pulses in the electromagnetic calorimeter layer and on the order of hundred signals in the hadronic calorimeter layer were available for the timing analysis.

### Timing corrections for L1Calo trigger towers

After the event and pulse selection, the L1Calo TT signals are fitted according to the method described in section 2. The fitted maximum position (in ns) is compared to the centre of the signal readout window, i.e. the middle of the third signal sample in case of a 5-slice readout. The differences between these two values are determined for all fitted signals for a specific TT and are expected to result in a Gaussian distribution around the required timing correction. An example of the distribution of timing differences for one TT in the EMB is given in Figure 3. For comparison only, a fit with a simple Gaussian function is applied to the distribution. Figure 3 shows that the distribution, especially the mean and RMS values, agree very well with the maximum position and the \(\sigma\)-width of the Gaussian fit. The distribution mean is therefore taken as correction \(t^{j}_{\rm corr}\) which is applied for the _j_th TT in the L1Calo hardware settings. The RMS \(t^{j}_{\rm RMS}\) of the distribution of timing differences for the _j_th TT provides a good measure for statistical fluctuations. For the timing correction, a minimum number of more than 10 events is required since \(\leq 10\) events often coincide with a large scattering of the fit results which renders any timing correction obtained from this arbitrary.

The \(t^{j}_{\rm RMS}\) of the distribution of timing differences per TT also indicates the resolution of the applied fit method which lies below around 1.5-2.5 ns for roughly 95 % of the TTs. The sensitivity of the fit method, however, has been found to lie more in the ns / sub-ns range and can roughly be identified with the uncertainty of the maximum position of the Gaussian fit in the distribution of timing differences. In Figure 3, the uncertainty on the fit result for the maximum position is approximately 0.1 ns. This is really a lower estimate for the sensitivity but corresponds to the right order of magnitude on which relative shifts in the timing synchronization can and have been observed. Systematic offsets in the timing synchronization, however, which represent an important source of systematic uncertainties of the fit method

Figure 3: Distribution of the difference between the fitted maximum position and the middle of the central read-out time-slice for one TT in the EMB from the first timing synchronization in July 2010. The mean value of the distribution determined from 523 fits to collision signals indicates a timing correction of 1.8 ns for the given TT. For comparison, a simple Gaussian fit was applied to the distribution.

cannot be inferred from the distributions of timing corrections, as in Figure 3. The high sensitivity of the fit method, therefore, only holds for relative changes of the timing synchronization but not for the determination of the absolute values.

The preliminary timing corrections \(t_{\mathrm{corr}}^{j}\) per TT, derived from distributions of timing corrections as in Figure 3, are visualized in \(\eta\)-\(\phi\)-maps in Figure 4. Figure 5 displays in addition the \(t_{\mathrm{RMS}}^{j}\) from the distributions of timing differences per TT. Both figures show the status of the timing synchronization as it was on 4-5 July 2010 when the \(pp\)-collisions analyzed for the first timing synchronization were recorded. As visible in Figure 4, the L1Calo timing synchronization was already rather good, i.e. within roughly \(\pm 2\,\mathrm{ns}\) in the central regions of the calorimeter (EMB and Tile) and also in the HEC calorimeter. The smallness of the \(t_{\mathrm{RMS}}^{j}\) in Figure 5 which are \(\lesssim 2\,\mathrm{ns}\) for the majority of TTs, furthermore, illustrates the good accuracy of the fit method. Empty bins in Figures 4 and 5 correspond to TTs with an insufficient number

Figure 4: Preliminary timing corrections \(t_{\mathrm{corr}}^{j}\) in [ns] for the electromagnetic calorimeter layer (a) and the hadronic calorimeter layer (b). The timing corrections per TT were derived from the data of \(pp\)-collisions used for the first timing synchronization in July 2010.

Figure 5: Spread or RMS \(t_{\mathrm{RMS}}^{j}\) of the distributions of timing corrections per TT in [ns] for the electromagnetic calorimeter layer (a) and the hadronic calorimeter layer (b) for the same data set as in Figure 4.

of signals for determining a timing correction from the analyzed data set. For less central calorimeter regions like the outer (and here also the inner) part of the EMEC and, of course, the FCal, slightly larger timing corrections on the order of 5-8 ns were determined from the collision data in July 2010, since the previous timing synchronizations from non-collision data could not fully account for the time-of-flight corrections. These are, of course, larger and more relevant in the outer calorimeter regions.

One special calorimeter region throughout 2010 and the beginning of 2011 was the electromagnetic overlap region (emOverlap) at \(1.4<|\eta|<1.5\) (see the low occupancy stripes in Figure 2(a), and stripes with larger TT timing corrections in Figure 4(a)). TT signals in the emOverlap region consist of an EMB and an EMEC signal component which are merged in the Receiver system of the L1Calo trigger. The synchronization of their relative timings was conducted at the beginning of 2011, based on a separate study of data from 2010, and finalized in May 2011 with the first collision data from 2011. Since then, the TTs of the emOverlap region have attained signal occupancies similar to those of the neighbouring TTs in EMB and EMEC. Due to the synchronization of the two emOverlap signal components, furthermore also the formerly often problematic behaviour of those TTs in the fit method application for the L1Calo timing synchronization has diminished. However, since systematic tests of the fit method in the emOverlap region have not been possible to the same extent as in other calorimeter parts, the timing results there have larger uncertainties and detailed studies would be required for a refinement of the fit method in the emOverlap region.

### Full signal delays and classification of TT timing corrections

The largest contribution to the timing delay from the production of a secondary particle in a \(pp\)-collision at the LHC until the arrival of the consequential calorimeter signal at the L1Calo electronics originates from the signal transfer in the cables and is at the order of 100 ns-200 ns. A smaller contribution of approximately 6 ns for the central EMB up to almost 18 ns for the hadronic FCal arises from the time-of-flight for the distances \(d_{\mathrm{PVtx}\rightarrow\mathrm{Calo}}\) from the primary collision vertex to the corresponding calorimeter cell with \(2\,\mathrm{m}\lesssim d_{\mathrm{PVtx}\rightarrow\mathrm{Calo}}\lesssim 5\, \mathrm{m}\) (compare [7]). At a nominal bunch-crossing frequency of 40 MHz, the time-of-flight, though much smaller than the contribution from the signal transfers, nevertheless corresponds to 24 %-72 % of the time between two subsequent bunch-crossings and, therefore, represents a non-negligible factor for the L1Calo timing synchronization.

Figure 6: Full signal delays in [ns] for the electromagnetic calorimeter layer (a) and the hadronic calorimeter layer (b). The shown full signal delays were implemented for the L1Calo TTs in the hardware system for the first timing synchronization with data from \(pp\)-collisions in July 2010.

The full signal delay \(D\) from the collision event until the signal arrival at the L1Calo system is then given by \(D_{\rm full}=D_{\rm tof}+D_{\rm cable}\) which has to be realized in the corresponding hardware delay settings as \(D_{\rm full}=D_{\rm FIFO}+D_{\rm Phos4}\). In practice, however, only the changes to the current full signal delays have to be implemented which result in new L1Calo hardware settings according to \(D_{\rm new}=D_{\rm old}-t_{\rm corr}\). As an example for the full signal delays which are loaded into the hardware database at the end of the L1Calo synchronization process, the \(\eta\)-\(\phi\)-maps of \(D_{\rm new}\) from the first timing synchronization with LHC collision data in July 2010 are given in Figure 6. Regions with large full signal delays - red areas - correspond to parts of the calorimeter which lie very close to the location of the L1Calo hardware in a cavern next to the ATLAS detector. Thus, signals from those regions have to wait longest in the pipeline memories of the L1Calo electronics before they can be processed in parallel with signals from the farther regions.

Before determining the new full signal delays, different cases are distinguished for the timing corrections per TT. These cases were motivated by the \(\eta\)-\(\phi\)-maps as shown in Figures 4 and 5. In Figure 4, the majority of TTs shows timing corrections which are in good agreement to their neighbours and only indicate potential timing offsets of larger regions of the calorimeter. Since the timing synchronization in July 2010 was the first with LHC collision data, such timing offsets were to be expected and simply corrected with the update of the timing synchronization. In this case, the new full signal delays \(D_{\rm new}^{j}\) per TT were derived directly from the above determined timing corrections \(t_{\rm corr}^{j}\).

For a minority of differently behaving TTs, however, some special treatments were developed, namely a flagging of bad channels, the possibility of manual corrections and - only in 2010 - an averaged correction for TTs with very low statistics. For the bad-channel flagging, the determined preliminary timing corrections \(t_{\rm corr}^{j}\) for the 7168 TTs are scanned for two characteristics. First, a TT is marked as bad if the spread of the distribution of timing differences \(t_{\rm RMS}^{j}\) exceeds the empirically determined limit of approximately 3 ns. Larger distribution spreads were often found to indicate either outliers or even more severe problems with the hardware like lost hardware settings, problematic or broken modules, etc. Secondly, each timing correction \(t_{\rm corr}^{j}\) is compared to the average timing correction of the 24 TTs in a window of 5x5 TTs surrounding the investigated TT. A discrepancy of more than 5 ns also leads to the flagging of the corresponding TT as bad channel, since above this empiric limit the discrepancy is unlikely to result just from statistical fluctuations of approximately similar timing corrections. This procedure of bad-channel flagging provides a good way to automatically spot problematic TTs or timing corrections and mark them for further manual inspection. If, however, the manual inspection results in no new manual timing correction for various reasons - at best simply the validation of the correctness of the determined value, then the determined correction \(t_{\rm corr}^{j}\) is still employed to derive the new full signal delay \(D_{\rm new}^{j}\) for the \(j\)th TT. An additional strategy was employed only in 2010 to provide timing corrections for TTs that had too poor statistics to determine a timing correction by means of the fit method. Under certain conditions, e.g. \(>60\,\%\) of the TTs at the same \(\eta\) with a valid \(t_{\rm corr}^{j}\), the timing correction was determined from an averaging procedure making use of the rather uniform distribution of \(t_{\rm corr}^{j}\) within either the electromagnetic or hadronic calorimeter layer and at the same \(\eta\)-value but different \(\phi\). In case of doubt concerning the required amount of timing correction \(t_{\rm corr}^{j}\) for an individual \(j\)th TT, however, the full signal delays were left unchanged. For the updates of the timing synchronization in 2010 and 2011 this resulted on average in timing corrections for approximately 95 % of the TTs.

## 4 Effect of timing synchronization on L1 trigger efficiencies

The L1Calo timing synchronization plays a fundamental role for the correct operation of the BCID logic and the achievement of the intended accuracy for the energy measurement of the Level-1 trigger. Increasing precision on BCID and L1 energy measurements, in turn, enhances the general trigger efficiencies of different L1 trigger items. After the first timing synchronization using \(pp\)-collision data, the improvement of the trigger efficiencies was investigated for the L1_EM5 trigger item.

L1_EM5 identifies _regions of interest_ (RoI) in the electromagnetic calorimeter layer, each consisting of two TTs with \(|\eta|<2.5\) and an L1-energy greater than 5 GeV. These are matched offline to uncalibrated electromagnetic clusters (em raw cluster) with \(\Delta R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}<0.15\) and transverse energy \(E_{T}^{\rm raw}\) which does not include any corrections due to dead material, etc. The efficiency \(\varepsilon\) of the L1_EM5 trigger is given by the ratio of the number of L1_EM5 triggered RoIs, \(N_{\rm L1\_EM5}\), and the number of offline identified electromagnetic clusters, \(N_{\rm offline}\), as defined in equation (3). For both numbers, the firing of a reference trigger, here a minimum bias trigger, is required in addition.

\[\varepsilon=\frac{N_{\rm L1\_EM5\ \&\ Ref\ Trig}}{N_{\rm offline\ \&\ Ref\ Trig}} \tag{3}\]

Figure 7(a) shows the trigger efficiency for the L1_EM5 trigger as determined from collision data that was recorded after the listed updates of the timing synchronization in 2009 and 2010 [8]. The improvement of the timing synchronization results in a sharpening of the trigger turn-on behaviour near the L1_EM5 threshold. It is a consequence of the synchronization that L1-energy measurements in different TTs for the same amount of deposited energy agree with higher precision after each update and thus refine the energy resolution. This effect is, of course, more explicit for the first two timing synchronizations from beam splash events [7], since the corrections there were in general larger compared to the first collision timing. For later updates of the timing synchronization with collision data, the applied corrections were in general too small to produce a significant and easily visible effect on the L1 trigger efficiencies. The improvement with the first timing synchronization from collision data is even better seen in Figure 7(b) which shows the integrated trigger efficiency \(\varepsilon_{\rm int}\)5 as a function of \(\eta\). Here, the first update from collision data enhanced the trigger efficiency from a previous integrated efficiency \(\varepsilon_{\rm int}\) of about 98 % from splash events to nearly 100 % at almost all \(\eta\)-values.

Footnote 5: For the determination of \(\varepsilon_{\rm int}\), events with energies of \(E_{T}^{\rm raw}\geq 10\) GeV were integrated.

The timing synchronizations from beam splashes in 2009 and early 2010 therefore provided a good approximate timing synchronization, whereas the timing synchronization from \(pp\)-collision data in July

Figure 7: Trigger efficiency of the L1_EM5 trigger for LHC collisions after different updates of the timing synchronization in 2009 and 2010. (a) Trigger efficiency of the L1_EM5 trigger with respect to the uncalibrated energy \(E_{T}^{\rm raw}\) of offline electromagnetic clusters [8]. (b) Integrated efficiency \(\varepsilon_{\rm int}\) with respect to \(\eta\). Each update entailed an improvement of the L1_EM5 trigger efficiencies where the improvement from the first timing synchronization with collision data (black dots) is most explicitly visible for the integrated efficiency.

2010 clearly improved and fine-tuned the synchronization status. Regular updates and monitorings of the timing synchronization are thus advisable to maintain high L1-trigger efficiencies.

## 5 Updates of the timing synchronization in 2010 and 2011

After the first timing synchronization from collision data, the synchronization status was checked with new collision data in regular intervals over the course of 2010 and 2011. This provided an important means to monitor the stability of the timing synchronization and thus ensure a stable and reliable BCID and energy measurement of the L1Calo trigger. Updates of the timing synchronization were conducted 6 times throughout this time period in order to adjust the digitization settings for possible changes. An overview of the applied updates and the additional cross-checks which are especially important after the implementation of new digitization settings is given in the following.

### Timing corrections with collision data in 2010 and 2011

In 2010 and 2011, the status of the L1Calo timing synchronization was checked 9 times using the described fit method analysis, resulting in 6 updates of the timing synchronization from \(pp\)-collision data. This corresponds to almost one check of the timing synchronization per month of LHC collision data-taking with a larger gap during the winter 2010/2011 when no collisions were taking place. A complete list of the timing updates and cross-checks is given in Table 2.

With the increasing luminosity provided by the LHC, the amount of data available for the timing analyses has grown by almost 4 orders of magnitude in 2010 and 2011. The gain in statistics, therefore,

\begin{table}
\begin{tabular}{c c c c}
**Measure- ment** & **Date of data taking** & **Integrated luminosity of data set** & **Changes in the detector** \\  & & [pb\({}^{-1}\)] & \\ \hline
1* & 4-5 July 2010 & 0.03 & _First timing synchronization from pp-collisions_ \\
2* & 1-2 August 2010 & 0.10 & Global LHC clock shift of 2 ns \\
3* & 27-28 October 2010 & 6.29 & - \\
4* & 22-24 March 2011 & 13.40 & Repair of several broken Tile-modules during winter shutdown \\
5 & 20-22 April 2011 & 26.50 & - \\
6* & 19-22 May 2011 & 61.82 & LAr hole: Reduced efficiency and energy in region of 30 TTs in EMB and emOverlap due to failing middle and back calorimeter layers \\
7 & 20-23 July 2011 & 123.70 & Partial repair of LAr hole resulting in the recovery of \(\sim\) 90 \% of the signal \\
8* & 18-22 August 2011 & 114.94 & - \\
9 & 13-14 September 2011 & 189.94 & - \\ \end{tabular}
\end{table}
Table 2: List of timing analyses conducted with \(pp\)-collision data over the course of 2010 and 2011. Given are the dates of data taking, the analyzed data volumes as well as important changes in the detector condition. Measurements marked with a * were _updates_ of the timing synchronization in contrast to _cross-checks_ only. For an update, the new full signal delays \(D_{\mathrm{new}}^{j}\) per TT calculated from the determined timing corrections \(t_{\mathrm{corr}}^{j}\) were implemented in the ATLAS database, whereas for a _cross-check_, the timing corrections were only determined but not implemented for data-taking.

Figure 8: Distribution of the determined timing corrections \(t_{\text{corr}}^{j}\) per TT in the electromagnetic calorimeter layer (a) and in the hadronic calorimeter layer (b) in July 2010. The distribution in (a) was fitted with a double Gaussian due to different offsets of the timing synchronization of EMB and EMEC/FCal. To better show the two independent offsets in the timing synchronization, both components of the fit in (a) were drawn separately. The mean timing correction \(\langle\ell_{\text{corr}}^{\text{em}}\rangle\) is determined as the average between the two peak positions of the distribution (blue line). The spread \(\langle\ell_{\text{corr}}^{\text{em}}\rangle_{\text{wh}}\) is given by the distance between the outer Gaussian \(\sigma\)-positions from the fit (green lines). In (b), \(\langle t_{\text{corr}}^{\text{had}}\rangle\) corresponds directly to the peak position \(x_{max}\) of the fitted Gaussian and \(\langle t_{\text{corr}}^{\text{had}}\rangle_{\text{wh}}\) to \(2\sigma_{Gauss}\).

Figure 9: Distribution of the determined timing corrections \(t_{\text{corr}}^{j}\) per TT in the electromagnetic calorimeter layer (a) and in the hadronic calorimeter layer (b) in September 2011. In both (a) and (b), \(\langle t_{\text{corr}}^{\text{layer}}\rangle\) corresponds to the peak position \(x_{max}\) of the fitted Gaussian function and \(\langle t_{\text{corr}}^{\text{layer}}\rangle_{\text{wh}}\) to \(2\sigma_{Gauss}\).

Note: Due to the very narrow distribution peak, the x-axis has been zoomed in with respect to Figure 8.

rendered also timing corrections in low statistics areas possible, although the simulanteous tightening of the criteria in ATLAS for the reduction of processed and stored data diminished the effect to a considerable degree, especially in 2011. Also listed in Table 2 are examples for operational issues in 2010 and 2011 which required updates of the timing synchronization. These issues include a timing shift of the global LHC clock signal, or a localized electronics failure in the EMB, the so-called LAr hole. The latter meant that for approximately 3 months, on average only 30 % of the incident energy of a jet could be measured in this region due to missing signals from calorimeter cells in the middle and back LAr calorimeter layers. Throughout 2010 and 2011, also the fit method for the timing synchronization evolved. Mostly, additional cross-checks for the determined timing synchronization were implemented, however, in a very few cases, also refinements of the fit method such as the introduction of scaling factors for the signal widths (see section 2.1) were applied.

In general, the L1Calo timing synchronization has been very stable and reliable over the course of the 15 months from July 2010 until September 2011. The timing corrections \(t_{\mathrm{corr}}^{j}\) which were applied with the different updates (after the first one in July 2010) were usually on the order of 0-2 ns, mainly reducing the remaining differences between neighbouring TTs. Larger corrections mostly occured for TTs which were synchronized or re-synchronized due to changes in the hardware. Several faulty and in 2010 disabled modules of the Tile calorimeter were, for example, restored to functionality during the winter shutdown 2010/2011 and were seeing signals from LHC collisions for the first time at the beginning of 2011. Thus, timing corrections up to approximately 6-7 ns applied in March 2011 were required for these TTs in order to synchronize them with the neighbouring TTs of the Tile calorimeter.

### Evolution of timing corrections in 2010 and 2011

A general picture of the status of the L1Calo timing synchronization can be gained by investigating the distributions of the determined timing corrections \(t_{\mathrm{corr}}^{j}\) per calorimeter layer for the conducted timing analyses in 2010 and 2011. Figure 8 shows these distributions for the first timing synchronization with collision data in July 2010. Expected is a Gaussian distribution of the \(t_{\mathrm{corr}}^{j}\) around a mean timing correction \(\langle t_{\mathrm{corr}}^{\mathrm{layer}}\rangle\) with a spread (or width) \(\langle t_{\mathrm{corr}}^{\mathrm{layer}}\rangle_{\mathrm{uth}}\) around it. For cases where different calorimeter divisions in one layer have differing offsets of the timing synchronization, more than one peak is expected for the distribution of timing corrections as visible in Figure 8(a). A Gaussian or double Gaussian fit is applied to the distribution and the values for \(\langle t_{\mathrm{corr}}^{\mathrm{layer}}\rangle\) and \(\langle t_{\mathrm{corr}}^{\mathrm{layer}}\rangle_{\mathrm{uth}}\) are determined from the fit results.

For July 2010, the mean timing correction in the electromagnetic calorimeter layer \(\langle t_{\mathrm{corr}}^{\mathrm{em}}\rangle\) was found to be approximately -2.5 ns as a result of a large shift of the timing synchronization in the EMEC and electromagnetic FCal calorimeters of almost -5 ns and a reasonably good timing synchronization of the EMB (see Figure 8(a)). In the hadronic calorimeter layer, the timing synchronization in July 2010 was already rather good with a mean timing correction \(\langle t_{\mathrm{corr}}^{\mathrm{had}}\rangle=-0.6\) ns (see Figure 8(b)) owing to the previous synchronizations with beam splashes [7]. In this layer, however, basically only Tile and HEC contributed to \(\langle t_{\mathrm{corr}}^{\mathrm{had}}\rangle\), while the more difficult hadronic FCal mostly had too few signals for the determination of timing corrections. The variations in the timing corrections within the different calorimeter divisions (EMB, EMEC/FCal, Tile/HEC) were on the order of approximately \(\pm 1.5\) ns around the mean timing correction for the corresponding calorimeter part. For July 2010, this then yielded a \(\langle t_{\mathrm{corr}}^{\mathrm{had}}\rangle_{\mathrm{uth}}\) of approximately 3 ns in the hadronic calorimeter layer and slightly more than 7 ns for \(\langle t_{\mathrm{corr}}^{\mathrm{em}}\rangle_{\mathrm{uth}}\) in the electromagnetic calorimeter layer due to the two peaks in the distribution.

When comparing the distributions from July 2010 (Figure 8) to the distributions obtained for the timing synchronization in September 2011, i.e. 15 months later (shown in Figure 9), the improvement of the timing synchronization is obvious. For both the electromagnetic and the hadronic calorimeter layer, the mean timing correction \(\langle t_{\mathrm{corr}}^{\mathrm{layer}}\rangle\) for September 2011 was found to be only 0.2-0.3 ns with a spread of \(\langle t_{\mathrm{corr}}^{\mathrm{layer}}\rangle_{\mathrm{uth}}=2\cdot \sigma_{Gauss}<1\) ns. The updates in the timing synchronization in 2010 and 2011 have therefore moved the mean timing correction for all calorimeter divisions close to zero, and reduced the Figure 10: Evolution of the timing synchronization over the course of 2010 and 2011. The upper plots show the evolution for the electromagnetic calorimeter layer with the mean timing correction \(\langle\ell^{\rm em}_{\rm corr}\rangle\) (a) and the spread in the timing corrections \(\langle\ell^{\rm em}_{\rm corr}\rangle_{\rm wth}\) (b). The lower two plots display the corresponding evolution of the mean timing correction \(\langle\ell^{\rm had}_{\rm corr}\rangle\) (c) and the spread in the timing corrections \(\langle\ell^{\rm had}_{\rm corr}\rangle_{\rm wth}\) (d) for the hadronic calorimeter layer. The horizontal black line in Figures (a) and (c) marks the case of zero timing correction. The vertical lines in all plots indicate the dates when new digitization settings as derived by the fit method were implemented in the ATLAS database.

variations between individual TTs within a calorimeter division by a factor of \(\gtrsim 3\) between July 2010 and September 2011. This validates the convergence of the timing synchronization by means of the fit method.

In more detail, the evolution of the timing synchronization can be traced by plotting \(\langle t_{\text{corr}}^{\text{layer}}\rangle\) and \(\langle t_{\text{corr}}^{\text{layer}}\rangle_{\text{with}}\) versus the time of data-taking of the corresponding data set for the timing synchronization as shown in Figure 10. Figures 10(a) and (c) illustrate that, since the initial update with collision data in July 2010, the mean timing correction \(\langle t_{\text{corr}}^{\text{layer}}\rangle\) was within \(\pm 1.5\,\text{ns}^{6}\) for both the electromagnetic and hadronic calorimeter layers. Towards the end of 2011, this has even been improved to \(<\pm 0.5\,\text{ns}\). With this, the variations in the timing synchronization throughout 2010 and 2011 lie well within the method accuracy of \(\pm 3\,\text{ns}\) and are better than the required precision of \(\pm 5\,\text{ns}\). The improvement in \(\langle t_{\text{corr}}^{\text{layer}}\rangle_{\text{with}}\) is shown in Figures 10(b) and (d). In 2010 and 2011, the spread in the timing corrections for the 3584 TTs per calorimeter layer was lowered to a ns-level and in the hadronic layer even a sub-ns level, i.e. below the hardware setting accuracy of \(1\,\text{ns}\)-steps. The most significant reduction can be seen between the first timing synchronization with collision data in July 2010 and the subsequent cross-check in August 2010. As a result of the first update of the timing synchronization, the \(\langle t_{\text{corr}}^{\text{layer}}\rangle_{\text{with}}\) was reduced by more than \(65\,\%\) and even almost \(80\,\%\) in the electromagnetic calorimeter layer. A reduction of \(\langle t_{\text{corr}}^{\text{layer}}\rangle_{\text{with}}\) is visible in general after each implementation of new L1Calo digitization settings, however, of course, on smaller scales due to the already better previous synchronization. Only at the beginning of 2011, larger timing corrections for formerly disabled TTs and mainly a modification in the fit parameters of the fit method introduced an enlargement of \(\langle t_{\text{corr}}^{\text{layer}}\rangle_{\text{with}}\) in both calorimeter layers, whereupon the fit parameter modification was reverted again directly with the following update of the timing synchronization.

Several other interesting features about the evolution of the timing synchronization are observable in Figure 10. For example, when considering the points for the July and August 2011 analyses, a distinct difference in the mean timing correction \(\langle t_{\text{corr}}^{\text{layer}}\rangle\) is observable in Figures 10(a) and (c), although no modification of the timing synchronization was implemented in between. At the same time, however, the spread \(\langle t_{\text{corr}}^{\text{layer}}\rangle_{\text{with}}\) in Figures 10(b) and (d) does not exhibit a similar change but stays constant. As the behaviour is visible in both calorimeter layers on the same order of magnitude, this is consistent with a general timing shift by 0.8-0.9 ns which can be attributed to a shift of the LHC clock signal. Cross-checking the monitoring information of the beam phase with respect to the LHC clock signal yielded a LHC clock shift by a few hundred picoseconds during the recording of the two data sets used for the July and August 2011 analyses. Both were corrected shortly after the analyzed data sets were taken, but since the LHC clock shifts during the two relevant data taking periods went in opposite directions, they added up to a \(1\,\text{ns}\) LHC clock shift difference which nicely corresponds to the global shift in timing synchronization which is seen by the fit method analysis. This case demonstrates the high sensitivity of the fit method for L1Calo timing synchronization which is, at least for relative shifts in the timing synchronization, more precise than the combined statistical and systematical uncertainty of \(\pm 3\,\text{ns}\).

## 6 Conclusion

Synchronizing the trigger tower (TT) signals of the Level-1 calorimeter (L1Calo) trigger with respect to the LHC clock and with respect to each other, as well as maintaining and refining the timing synchronization, are important measures to ensure a stable and reliable operation of the ATLAS trigger system. Bunch-crossing identification of signals (BCID) and energy measurement in the L1-trigger thereby ne cessitate an accuracy of \(\pm 5\,\mathrm{ns}\) for the timing synchronization. A good timing synchronization, therefore, results in high efficiencies of the various Level-1 trigger items for data-taking of proton-proton collisions at the LHC.

The fit method which has been developed and employed to attain the timing synchronization is based on emulating the analogue calorimeter signal by means of a special fit to the digitized TT signal pulses. The application of these fits to on average several hundred signals per TT in the central regions of the calorimeter, e.g. in the EMB, results in the determination of timing corrections and thus new digitization settings in the L1Calo hardware for the 7168 TTs of the L1Calo system. Due to missing data in some TTs, however, on average approximately \(95\,\mathrm{\char 37}\) of the TTs are synchronized within one update of the timing synchronization.

Over the course of 2010 and 2011, the fit method has been applied nine times to data from proton-proton collisions at the LHC with \(\sqrt{s}=7\,\mathrm{TeV}\). The first timing synchronization with collision data was conducted in July 2010 and substantially improved the previous timing synchronizations from beam splashes in 2009 and early 2010. Since July 2010, the mean timing corrections required per calorimeter layer have been \(\lesssim\pm 1.5\,\mathrm{ns}\) with the spread between TTs of one calorimeter layer decreasing to around \(1\,\mathrm{ns}\) towards the end of 2011 for both calorimeter layers. Considering the combined statistical and systematic uncertainty of \(\pm 3\,\mathrm{ns}\) of the fit method, the timing updates and additional cross-checks between updates have demonstrated the stability and reliability of the L1Calo timing synchronization.

In conclusion, the fit method for determining the correct \(1\,\mathrm{ns}\)-step hardware settings in the L1Calo electronics, and thus synchronizing the L1Calo trigger system of the ATLAS detector to high precision, has been successfully applied over the course of 2010 and 2011. The intended precision of \(\pm 5\,\mathrm{ns}\) for BCID and energy-measurement has been well surpassed.

## References

* [1] The ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) 8003-8440.
* [2] The ATLAS Collaboration, _ATLAS Liquid Argon Calorimeter Technical Design Report_, CERN-LHCC 96-041.
* [3] The ATLAS Tile Collaboration, _ATLAS Tile Calorimeter Technical Design Report_, CERN-LHCC 96-042.
* [4] E. Eisenhandler, _ATLAS Level-1 Calorimeter Trigger Algorithms_, ATLAS note, ATL-DAQ-2004-718 001 (2004).
* [5] R. Achenbach et al., _The ATLAS Level-1 Calorimeter Trigger_, JINST **3** (2008) P03001.
* [6] V. Lang, _Prazisionssynchronisierung des Level-1-Kalorimeter-Triggers am ATLAS-Experiment_, Diploma thesis, Ruprecht-Karls-Universitat Heidelberg, HD-KIP 10-63.
* [7] The ATLAS Collaboration, _ATLAS Level-1 Calorimeter Trigger: Timing Calibration with 2009 LHC Beam Splashes_, ATLAS note, ATL-DAQ-PUB-2010-001 (2010).
* [8] The ATLAS Collaboration, _Performance of the Electron and Photon Trigger in p-p Collisions at \(\sqrt{s}=7\,\mathrm{TeV}\) with the ATLAS Detector at the LHC_, ATLAS-CONF-2011-114 (2011).