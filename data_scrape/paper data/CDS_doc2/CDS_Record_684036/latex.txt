Combined muon reconstruction at Level-2

A. Di Mattia, A. Nisati, S. Robins

April 2000

###### Abstract

An algorithm is presented which combines features extracted using stand-alone Level-2 algorithms in the muon system and the Precision Tracker, to produce a combined muon object at Level-2 for the region \(\mid\!\eta\!\mid\!<\)1. Combination of the Level-2 stand-alone track and muon features is performed using fast, simple algorithms based on linear extrapolations and analytic corrections. The resulting combined muon features enable substantial rejection of non-prompt muons from \(\pi\) and K decays, and a significant improvement in the \(p_{\mathrm{T}}\) resolution with which muons are measured.

Level-2 trigger rates are calculated by convolving the extracted efficiencies of the algorithms applied with the expected cross-sections from various processes. The combined muon reconstruction algorithm is seen to gain a factor 3 reduction in the Level-2 rate from K and \(\pi\) decays, relative to that output by the stand-alone Level-2 algorithms. The total rate output from the combined Level-2 muon reconstruction is seen to be \(\sim\)2.1 kHz, for the region \(\mid\!\eta\!\mid\!<\)1, for the 6 GeV low-\(p_{\mathrm{T}}\) threshold. Initial bench-marking of the unoptimised code gives timings for the algorithm of \(\sim\)23 \(\upmu\)s per Rol on a 10 SpecINT95 machine.

## 1 Introduction

The role of the Level-2 trigger is to validate regions of interest (RoIs) passed to it by the Level-1 trigger, through the application of more sophisticated selection procedures. Level-1 triggers are passed to Level-2 at a total rate of up to 75 kHz1, with muon \(p_{\mathrm{T}}\) thresholds able to be set at either low-\(p_{\mathrm{T}}\) (nominally 6 GeV) or high-\(p_{\mathrm{T}}\) (nominally 20 GeV) [1]. The low-\(p_{\mathrm{T}}\) threshold is designed largely to provide a trigger for inclusive muons produced in b events during running at low luminosity. The input to the B physics trigger at Level-2 will be muon objects selected through the combination of Muon Spectrometer and Inner Detector information. Strict limits are set on the input rate (of the order of 9kHz [2]) that can be tolerated by the Level-2 B physics trigger. The combined Level-2 muon trigger must effectively discriminate K/\(\pi\) decays to \(\mu\) and prompt muons below the 6 GeV \(p_{\mathrm{T}}\) threshold, from prompt muons above threshold. During high luminosity running the muon trigger will offer discrimination between isolated muons from W and Z decays (required for search physics), and those from semi-leptonic b decays.

Footnote 1: Where this is expected to be upgraded to a rate of 100 kHz.

The primary contributions to the low-\(p_{\mathrm{T}}\) rate are secondary muons arising from the decay of K and \(\pi\) mesons to muons, and prompt muons close to, but below, the nominal 6 GeV trigger threshold. In the Level-2 trigger, algorithms are run using information from both the muon trigger chambers (TGCs and RPCs) and the precision chambers of the Monitored Drift Tubes (MDTs). Such algorithms can reduce the rate of muon candidates significantly, through the rejection of backgrounds. In this study the muon algorithm \(\mu\)FAST [3] and the Precision Tracker algorithm T2SC [4] are used.

The Level-2 muon algorithm \(\mu\)FAST receives RoIs from the Level-1 muon trigger, and processes those in the region \(\left|\,\eta\,\right|<\)1, using information from both RPCs and MDTs. Fast tracking is performed to extract a measurement of the sagitta of the muon track candidate in the muon system, and a look-up table (LUT) used to convert this into a transverse momentum measurement. The improved resolution offered by this algorithm over that possible at Level-1 enables a sharper \(p_{\mathrm{T}}\) threshold to be applied, reducing the rate relative to that seen at Level-1 through the rejection of muons with \(p_{\mathrm{T}}\) below the 6 GeV low-\(p_{\mathrm{T}}\) threshold and the rejection of fake muons. This algorithm however, since it uses only information from the muon system, offers little rejection of muons arising from K/\(\pi\) decays where the decay muon is above the low-\(p_{\mathrm{T}}\) threshold. By combining the muon identification capabilities offered by the tracking in the muon system of the \(\mu\)FAST algorithm with the track reconstruction capabilities of the Inner Detector, substantial K/\(\pi\) rejection can be achieved.

The ATLAS Precision Tracker consists of the Semi-Conductor Tracker (SCT) and the pixel detector system. The Precision Tracker has been designed to be read-out, and offer initial data processing that can provide track-finding on a timescale that enables the output of such track-finding to be used in the Level-2 trigger. Independent Level-2 algorithms have been produced that use Transition Radiation Tracker (TRT) information, but these are not yet used in the combined muon reconstruction. Algorithms to find tracks and make detailed selection of specific decay channels are an essential component of the Level-2 trigger. The input to the Level-2 algorithms that will make such specific triggers for B physics channels is an object that combines information from the muon system and the Inner Detector (ID). The first stage of those algorithms processing muon candidates is to identify tracks in the Inner Detector as muons using information from the muon system. This allows the reduction of the rate of muon candidates coming from the stand-alone muon algorithms through the use of the superiorresolution of the Precision Tracker at lower \(p_{\mathrm{T}}\), and the rejection of K/\(\pi\) decays through the kink-finding potential of ID algorithms. Here studies have been made with a fast algorithm that performs track-finding in the Precision Tracker using a histogramming method employing Hough transforms to select sets of points forming track candidates. Bench-marking of this algorithm suggests it takes -18.5 ms per RoI on a machine of 10 SPECINT95 units [4]. This algorithm has been incorporated into the ATLAS trigger simulation package ATRIG, and will be referred to here as the T2SC algorithm. Further details can be found in [4].

The Level-2 muon (\(\mu\)FAST) and Precision Tracker (T2SC) algorithms have been combined in the framework of the ATRIG package using the output of the two algorithms. Both the \(\mu\)FAST and T2SC algorithms have been driven by the Level-1 muon RoIs - i.e. T2SC performs its track search, and \(\mu\)FAST its muon track fitting, only within RoIs delivered by the Level-1 muon trigger. A \(\chi^{2}\) approach has been developed that uses both the spatial (i.e. \(\eta\), \(\phi\)) and \(p_{\mathrm{T}}\) features of muon candidates extracted by both algorithms. They are combined to provide a \(p_{\mathrm{T}}\) measurement superior to that offered by either algorithm independently, and thus a sharper trigger threshold. By measuring \(p_{\mathrm{T}}\) differences in the two detector systems K/\(\pi\) to \(\mu\) decays that have not been rejected by the T2SC track-finding can be rejected as prompt muon candidates.

The studies of this note concentrate on the use of combined muon reconstruction at Level-2 in low luminosity running, when a low-\(p_{\mathrm{T}}\) trigger for b-physics is the priority for the muon trigger. Whilst the algorithm presented here is also appropriate for studies of a high-\(p_{\mathrm{T}}\) trigger at nominal luminosity, the dominant issue for such a trigger is the isolation of the muon - in order to reject muons from b hadron decays, in favour of those from the decays of W and Z bosons. Studies of muon isolation for such a high-\(p_{\mathrm{T}}\) trigger will begin shortly, using the algorithm described here as a starting point.

## 2 The combined muon algorithm

The aim of this study is to demonstrate that significant reductions in Level-2 output rate can be achieved, without compromising efficiency to prompt muons above threshold, by combining muons found in the Inner detector and the muon system at Level-2. Here this has been done by developing very simple algorithms, that have been seen to work in the offline analysis environment. Maintaining a simple combination procedure guarantees that the resulting algorithm will satisfy the rigid timing constraints of the online environment the Level-2 trigger must work in. Since the \(\mu\)FAST algorithm is presently constrained to run only in the barrel region (\(|\,\eta\,|<\)1) of the detector, the combination algorithm described here has been developed and investigated only in that region. Future studies will consider the entire acceptance of the muon system.

The muon algorithm (\(\mu\)FAST) produces muon features in terms of the \(\eta\), \(\phi\) and \(p_{\mathrm{T}}\) of the muon candidate, as well its direction in the muon system, whilst the Precision Tracker algorithm (T2SC) delivers a full description of the track in terms of the conventional tracks parameters (\(p_{\mathrm{T}}\), \(\eta\), \(z0\), \(\mathrm{d}0\)). The muon features extracted by \(\mu\)FAST describe the track at a radius of -450 cm, the centre of the inner MDT station, whereas the Precision Tracker feature extraction is performed at the vertex. The radius at which matching is performed was chosen after studying the angular resolution at several potential matching surfaces. It was seen that the angular resolution was superior at a point lying before the Muon Spectrometer, but beyond the volume of the calorimeter, at a radius of 425 cm. This is assumed to be a consequence of the resolution at lower \(p_{\mathrm{T}}\) being dominated by multiple scattering which occurs largely in the material of the calorimeter. The matching surface is thus defined as a cylinder of radius 425 cm, around the beam axis and extending to the limit of the acceptance of the analysis, \(|\,\eta\,|=\)1.

Extrapolation of the ID and muon tracks to the matching surface must be performed in both the z and r-\(\phi\) projections; here, for simplclity, they are treated independently. The angular resolution of the Precision Tracker features is superior to that from the muon system features for all \(p_{\mathrm{T}}\). The \(p_{\mathrm{T}}\) resolution of the Precision Tracker features is superior at 6 GeV, but inferior at 20 GeV, since the \(p_{\mathrm{T}}\) resolution on the muon features is a strong function of \(p_{\mathrm{T}}\). \(p_{\mathrm{T}}\) resolution at 6 and 20 GeV is summarised in Figure 1.

### Matching in \(\phi\)

In \(\phi\), the ATLAS magnet and return yoke system has been designed so that a charged particle passing through the full field region (i.e. with an origin at the nominal vertex) and the return yoke of the calorimeter material will emerge with a direction pointing to the vertex. However, the \(\phi\) angle of the position of the track at the exit of the calorimeter will be rotated relative to the track position at the origin. The size of this \(\phi\) shift will be a function of the \(p_{\mathrm{T}}\) of the track. The inverse of the residual, \(\Delta\phi\), between the T2SC track (at the vertex) and the \(\mu\)FAST track (in the muon system) as a function of \(p_{\mathrm{T}}\) is shown in Figure 2, for several values of \(p_{\mathrm{T}}\) and has been fit to a straight line. It can be seen that there is an inverse linear relationship between \(\Delta\phi\) and \(p_{\mathrm{T}}\). This is expected where

\[\Delta\phi\ =\ \alpha/(p_{\mathrm{T}}-p_{\mathrm{T}}^{0})\]

and \(\alpha\) is related to the field integral, \(\int\)Bdl, and \(p_{\mathrm{T}}^{0}\) is related to the \(p_{\mathrm{T}}\) loss, where this should be independent of \(p_{\mathrm{T}}\). \(p_{\mathrm{T}}^{0}\) is measured to be -1.5 GeV.

In the current study this parametrisation, and the resulting extraction of \(\alpha\) and \(p_{\mathrm{T}}^{0}\) has been performed using a single fit to all data; i.e. averaging over all \(\eta\) and \(\phi\). The dependence of these constants on the muon position in the detector will be investigated in the future to improve the accuracy of the correction procedure.

Figure 1: Input \(p_{\mathrm{T}}\) resolutions from the Precision Tracker and muon system stand-alone Level-2 algorithms.

The matching in \(\phi\) is thus performed by correcting the \(\phi\) measured at the vertex by T2SC, where \(\alpha\) and \(p_{\mathrm{T}}^{0}\) are extracted from the fit of Figure 2. The resulting distributions of residuals (\(\phi_{\mathrm{SCT}}\) - \(\phi_{\mathrm{\mu FAST}}\)) are shown in Figure 2. The same procedure has been performed using in place of the Level-2 features the full machinery of the offline analysis software, i.e. MUONBOX for muon reconstruction and XXalman for track reconstruction. In this case the extrapolation has been performed taking full account of the magnetic field map, and the multiple scattering etc. A comparison of the resolution on the \(\phi\) residuals at 6 GeV, shows a width of 27 mrads in the 'fast' Level-2 treatment as against 19 mrads using the full offline software capability. This demonstrates rather powerfully that the fast algorithms envisaged for Level-2 have a quality that falls only slightly short of that ultimately achievable.

### Matching in z

Matching in z is similarly performed in a simple way by using the measured theta angles from the two independent feature extraction algorithms to extrapolate to the matching radius, and construct a residual. The theta measured at the vertex by T2SC, and the local theta measured in the middle MDT station by \(\mu\)FAST are used. The resulting residuals are seen to have a less obvious dependence on \(p_{\mathrm{T}}\) than that seen for \(\phi\), and thus a correction is extracted in a more ad hoc way. Currently a correction is applied as a function of \(p_{\mathrm{T}}\). The resulting residual distribution, for muons with \(p_{\mathrm{T}}\) in the range 6 - 15 GeV, is shown in Figure 3. It can be seen that even using this simple correction the width of the extracted residual distribution is comparable with the resolution of the input trigger features.

The reason that the correction is less effective in z is the result of the field in the region between the exit of the calorimeter and the entrance to the Muon Spectrometer. A better treatment of z can probably be achieved by considering the dependence of the z residuals on \(\eta\) and \(\phi\). It is likely that the use of a look-up table to perform such a correction would improve the quality of the z matching further.

#### 2 The combined muon algorithm

Figure 3: The z residuals, \(z_{\mathrm{SCT}}z_{\mathrm{\mu FAST}}\) after correction, for prompt muons with \(p_{\mathrm{T}}\) in the range 6-15 GeV

Figure 2: The fit to the \(\phi\) residuals, \(\phi_{\mathrm{SCT}}\) - \(\phi_{\mathrm{\mu FAST}}\), as a function of \(p_{\mathrm{T}}\).

### Matching and construction of the \(\chi^{2}\)

Matching is performed geometrically by making window cuts on the size of the residuals in each of \(z\) and \(\phi\). This procedure is considered adequate for this simple treatment, where residuals have been measured in single muon events. To complete this study full events containing background will be used so that the geometrical matching between the track and muon features can be optimised.

The resolution on the measurement of residuals of the matching variables (\(z\), \(\phi\)) as a function of \(1/p_{T}\) are shown in Figure 4, and seen to be rather linear. Parametrisations of this behaviour have been extracted in each case, and for \(\Delta z\) these are made independently for the small and large chambers of the MDTs. Using these parametrised resolutions, for each muon feature found in the Precision Tracker a 3\(\sigma\) cut is applied in both \(z\) and \(\phi\) and the track considered only if a muon feature from \(\mu\)FAST is seen in the matching window.

Once a geometrical match is found, much of the power of the algorithm, particularly in rejecting \(K\) and \(\pi\) decays, arises from consideration of the two available \(p_{T}\) measurements. Since any \(K/\pi\) decay that gives a good track in the T2SC algorithm will be a track fit to both tracks either side of the 'kink', the measured \(p_{T}\) in the Precision Tracker will be lower than the true decay muon \(p_{T}\). Thus a comparison of the \(p_{T}\) measurements from each of the Inner Detector and muon system can allow the discrimination of \(K/\pi\) decays from prompt muons. Figure 5 shows the difference in measured \(p_{T}\) from T2SC and \(\mu\)FAST, for prompt muons and muons from \(K\) and \(\pi\) decays, for various values of muon \(p_{T}\) close to the low-\(p_{T}\) 6 GeV threshold.

The resolution on \(p_{T}\) from each of the two feature extraction procedures, as a function of \(p_{T}\), can be extracted by examining high statistics samples of single prompt muons generated at various values of \(p_{T}\). The resolutions from T2SC and \(\mu\)FAST are shown as a function of \(p_{T}\) in Figure 8, together with the expected resolution of the combined muon object. The matching is performed using \(1/p_{T}\) since the resolution on \(1/p_{T}\) is linear with respect to \(p_{T}\). Parametrisation is performed similar to that used for the geometrical matching variables. This treatment allows the two \(p_{T}\) measurements, weighted by their respective resolutions, to be combined. A \(\chi^{2}\) is then

Figure 4: The resolution on the residuals from the muon-Precision Tracker feature matching in \(z\) and \(\phi\). (For the \(z\) residuals, only the large chambers are shown.) Matching windows are constructed by using parametrisations extracted from the fits shown, to apply 3\(\sigma\) windows.

constructed by considering the significance of the difference between the combined measurement and the two contributing resolutions. The probability of this \(\chi^{2}\) for both prompt muons and K/\(\pi\) decays, is shown in Figure 6. The distribution is far from flat for prompt muons, showing a large peak in the high probability region. This is assumed to arise from the fact that the resolution distributions are far from Gaussian, and for A cut on the \(\chi^{2}\) probability at 0.02 is then made to define the set of candidates considered to be good prompt muons.

## 3 Performance

The criterion by which any trigger algorithm must be judged is its relative acceptance to signal, in this case prompt muons, and background. For the Level-2 combined muon we demonstrate that rates are reduced through the suppression of backgrounds, notably those from K and \(\pi\) decays, without compromising the efficiency to prompt muons above the required threshold. We also verify the speed of the algorithm.

Figure 5: The difference in measured 1/\(p_{\rm T}\) values from the muon system and the Precision Tracker. Plotted is (1/\(p_{\rm T}\)) \(\mu\)FAST - (1/\(p_{\rm T}\)) SCT for _top_: 6 GeV prompt muons, _centre_: \(\pi\) to \(\mu\) decays, for 6 and 8 GeV meson \(p_{\rm T}\), and _bottom_: K to \(\mu\) decay, 6 and 8 GeV.

For the \(\mathrm{K}/\pi\) decays the efficiency of the algorithm is a function of both the \(p_{\mathrm{T}}\) of the decay muon and that of the initial meson. This is considered in the efficiency calculation by weighting the muon \(p_{\mathrm{T}}\) spectrum by the relative production cross-section of the initial meson, as a function of \(p_{\mathrm{T}}\). Figure 7 shows the efficiency of the stand-alone muon algorithm, \(\mu\)FAST, and the combined algorithm relative to the Level-1 efficiency. This is shown, after the \(p_{\mathrm{T}}\) matching cut, for both prompt muons and \(\mathrm{K}\) and \(\pi\) decays. Above the nominal 6 GeV threshold the acceptance to \(\mathrm{K}/\pi\) decays is much reduced relative to the prompt muon efficiency. Immediately below the threshold, acceptance to \(\mathrm{K}/\pi\) decays is slightly enhanced relative to the prompt efficiency. This is due to the non-pointing nature of the decay muons from mesons.

The rate from prompt muons is further reduced through the increase in the transverse momentum resolution as a result of the combination of the muon and ID track features. The \(p_{\mathrm{T}}\) of the combined muon object is constructed using the measurement from the Precision Tracker and the muon system, combined such that each measurement is weighted by its resolution. The resolution from each of the stand-alone algorithms is parametrised using the curves of Figure 8. The resulting momentum measurement is superior to both the contributing measurements, on average. The cumulative effect of the improving resolution of the 6 GeV, low-\(p_{\mathrm{T}}\) threshold can be seen in Figure 9, where the efficiency of the Level-1 muon, the Level-2 muon system, and Level-2 combined muon triggers are compared.

Figure 6: The \(\chi 2\) matching probability for the 1/\(p_{\mathrm{T}}\) matching procedure, for prompt muons and \(\pi\) and \(\mathrm{K}\) decays to \(\mu\). All samples used have muon \(p_{\mathrm{T}}\) in the region 5 - 12 GeV.

Figure 7: The efficiency of the \(\mu\)FAST algorithm and the combined muon reconstruction algorithm, relative to the Level-1 output, for prompt muons and K/\(\pi\) decays, as a function of \(p_{\rm T}\).

Figure 8: The measured resolution on 1/\(p_{\rm T}\), from the stand-alone features extraction of the Precision Tracker, the muon system (\(\mu\)FAST) and the combined muon feature.

Figure 9: The efficiency of the low-\(p_{\rm T}\), 6 GeV muon trigger for the Level-1 muon trigger, the Level-2 muon trigger using only the muon system (\(\mu\)FAST), and the combined Level-2 muon trigger.

The output rates of the stand-alone muon algorithm and the combined reconstruction have been calculated by convolving the calculated efficiencies with cross-section estimates from Monte Carlo programs. PYTHIA has been used for the prompt cross-sections and DPMJET for the \(\mathrm{K}/\pi\) to \(\mathrm{\upmu}\) cross-sections. If the PYTHIA estimate for the \(\mathrm{K}/\pi\) to \(\mathrm{\upmu}\) cross-section is considered, all \(\mathrm{K}/\pi\) rates are seen to fall by a factor 2. Rates from decay of W, Z and top have been considered and found to be negligible. Rates arising from cavern background, in particular charged particles of momentum 100 MeV have been neglected since the rates seen from the stand-alone muon algorithm are negligible. The output rates are tabulated for the low-\(p_{\mathrm{T}}\), 6 GeV threshold in Table 1

The high-\(p_{\mathrm{T}}\), 20 GeV threshold has not yet been investigated in detail. The task of the high-\(p_{\mathrm{T}}\) trigger will be to discriminate isolated muons, likely to be products of W and Z decays, from those that are heavy flavour products which will be embedded in jets. Work to optimise the combined muon reconstruction for such topologies will begin shortly.

The timing of the algorithm has been investigated in its current environment, namely an desk-top cpu. A timing routine from the CERN libraries [5] has been used to measure the speed of the algorithm, which is seen to take \(\mathrm{\sim}\)23 \(\mathrm{\upmu}\)s per RoI on a 10 SPECINT95 machine. The timing distribution is observed to be very narrow and independent of the \(p_{\mathrm{T}}\) or position of the RoI. Such a performance suggests that the combined muon algorithm, in its existing form, will make a negligible contribution to the processing time of the Level-2 trigger algorithms. It also indicates that there is ample room to increase the sophistication of the algorithm, and further improve performance, without threatening cpu constraints.

## 4 Conclusions

A conceptually simple Level-2 algorithm for the combination of trigger features from the muon system and the Inner Detector has been developed. It has been integrated into the ATLAS trigger simulation framework ATRIG, and detailed studies have been made of the performance of the algorithm, when it is used to combine the results of the stand-alone algorithms, T2SC in the Inner Detector, and \(\mathrm{\upmu}\)FAST in the muon system. The algorithm is seen to offer significant discrimination between prompt muons from b decays and those from the decay of K and \(\pi\) mesons, for muon \(p_{\mathrm{T}}\) in the vicinity of the 6 GeV low-\(p_{\mathrm{T}}\) threshold. It also allows for a significant improvement in the resolution with which \(p_{\mathrm{T}}\) is measured relative to the stand-alone muon input features, allowing a sharper trigger threshold to be applied. For low luminosity running, this offers the possibility to reduce the trigger rate seen at Level-2 from \(\mathrm{K}/\pi\) decays by a factor 3. Globally the muon trigger rate in the barrel region (\(\,|\,\eta\,|<\)1) is reduced to 2.1 kHz. Timing properties of the algorithm are seen to be highly suitable for the Level-2 environment.

\begin{table}
\begin{tabular}{l c c} \hline  & \multicolumn{2}{c}{**trigger rate, kHz**} \\  & & \multicolumn{2}{c}{**combined \(\mathrm{\upmu}\)**} \\  & \(\mathrm{\upmu}\)FAST** & **reconstruction** \\
**contribution** & (\(|\eta|\)**\(<\)**1.)** & (\(|\eta|\)**\(<\)**1.)** \\ \hline \(\mathrm{K}/\pi\) decays & 3.13 & 0.98 \\ b decays & 0.97 & 0.73 \\ c decays & 0.51 & 0.37 \\ \hline Total & 4.62 & 2.08 \\ \hline \end{tabular}
\end{table}
Table 1: Total output rates of the stand-alone Level-2 muon trigger (\(\mathrm{\upmu}\)FAST) and the combined muon reconstruction algorithm, with the low-\(p_{\mathrm{T}}\) 6 GeV threshold at low luminosity.

## References

* [1] ATLAS Collaboration, _Level-1 Technical Design Report_, CERN/LHCC/98-14, ATLAS TDR 12, 24 June 1998.
* [2] ATLAS Collaboration, _Trigger Performance Status Report_, CERN/LHCC/98-15, 1998.
* [3] A. Di Mattia et al, _A muon trigger algorithm for Level-2 feature extraction_, ATL-COM-DAQ-2000-023, March 2000.
* [4] J. Baines, R. Dankers and S. Sivoklokov, _Performance of a Level-2 Trigger Feature Extraction Algorithm for the Precision Tracker_, ATL-DAQ-99-0113, October 1999.
* [5] DATIME, CERNLIB, _CERN Long write-up_, June 1996.