# Exponential Optical Model for Attenuation in Tiles in G4 Simulation

David J. Lawlor

_University of Chicago Chicago, IL_

December 11, 2006

###### Abstract

Changes made to the ATLAS Tile Calorimeter simulation to include the effect of light attenuation within the scintillating tiles are presented. The effect of attenuation was studied using data from the test beam as well as \({}^{90}\)Sr source scans. A comparison with the default G4 simulation is presented, as are instructions to use this model in Athena release 12.0.0.

## 1 Introduction

The ATLAS Tile Calorimeter is a hadronic sampling calorimeter employing plastic scintillating tiles as the active material and iron as the passive material. Eleven different sizes of tiles are placed in planes perpendicular to the beam axis with a periodic structure. The smallest tiles are placed closest to the beam axis with larger tiles at larger radii. Each scintillating tile is read out on two sides by wave-length shifting (WLS) fibers into separate photomultipliers (PMTs). A detailed description of TileCal geometry can be found in the Technical Design Report [1]. A schematic drawing of a TileCal module is shown in figure 1.

During the TileCal test beam periods, a number of modules were exposed to particles of various energies in the H8 beam line at CERN. In August 2002, four TileCal modules were used: the prototype Module 0, a production barrel module, and two production extended barrel modules. These were stacked on top of each other and placed on a table which was rotated to expose the modules to the beam at various angles. Cherenkov detectors were placed upstream of the modules to help identify particles, as were beam chambers to determine impact position. The test beam setup is shown in figure 2.

## 2 Muon Data from August 2002 Test Beam

### Run Structure

In order to understand the effect of light attenuation across a tile, a scan of 180 GeV pions (with significant muon and slight proton contamination) was done along the \(y\) coordinate in August 2002.1 A step size of 25 mm was used, rangingfrom the middle of Module 0 to the middle of the Extended Barrel module. All runs were taken at the center of tile row 10.

### Analysis

To select muon events from the other particles in the data, a simple cut on the total energy deposited in the modules was applied: \(\sum_{i=1}^{6}E_{i}<20\) pC, where \(i\) runs over the 6 modules in the testbeam setup. Another simple cut was applied on the beam impact position: \(|X_{\mathrm{imp}}|<10\) mm and \(|Y_{\mathrm{imp}}|<10\) mm. For each point in the vertical scan the distribution of reconstructed energy was

Figure 1: The structure of a TileCal module, showing the scintillating tiles interspersed in the iron frame and the readout by WLS fibers routed into PMTs. The holes for \({}^{137}\)Cs source tubes, used for calibration, are also shown.

Figure 2: The August 2002 TileCal test beam setup. It consists of 4 modules: Barrel Module 0, Barrel JINR-01, and Extended Barrels IFA-09 (\(\eta>0\)) and ANL-27 (\(\eta<0\)).

fit with a convolution of a Landau distribution with a Gaussian,2 which is a good parametrization of the muon response in TileCal [2]. This was done for individual PMTs reading out D-cells, the D-cells themselves, and also the entire module. Figure 3 shows an example distribution in a single PMT.

Footnote 2: The ROOT macro is available at root.cern.ch/root/html/examples/langaus.html

The most probable value (MPV) of the Landau-Gauss convolution was then plotted as a function of the \(y\) coordinate of the run and fit with a simple exponential function of the form

\[E=C_{\pm}e^{-(L\mp y)/\lambda_{\pm}} \tag{1}\]

for a single PMT, and as the sum of two such functions, one with a positive exponential and one with a negative exponential, for a cell. Here \(C_{\pm}\) is a scale factor, \(L\) is the half-width in \(y\) of the tile in question at the impact position (in our case, \(L_{\mathrm{tile\,10}}=170.6\) mm), and \(\lambda_{\pm}\) is the attenuation length of the tile. For the fit, both \(C_{\pm}\) and \(\lambda_{\pm}\) are free parameters (the \(\pm\) refers to the sign of the slope of the exponential.) Examples of the exponential parametrization for one and two PMT readout are shown in figures 4 and 5 respectively. The attenuation length was determined for each PMT reading out D cells (which contain tile row 10), then averaged to give \(\lambda_{\mathrm{tile\,10,\,TB}}=416.3\) mm. This corresponds to the average attenuation length of about 300 tiles.

## 3 \({}^{90}\)Sr Source Measurements

The testbeam data include a \(y\)-scan only for tile row 10. However, A. Miagkov _et al._ performed a series of \({}^{90}\)Sr source scans for few scintillators of each size.3 The tiles were read out on one side only with a WLS fiber connected directly to a PMT (no light mixer was used). For a fixed \(z\) value (see figure 7) the PMT

Figure 3: Muon response in channel 43 of the production module.

current (in arbitrary units) was recorded as a function of \(y\). An example plot for tile size 10 is shown in figure 6. The PMT response also shows a very weak dependence on \(z\) which we can safely ignore.

For each tile size, attenuation lengths were calculated using the same exponential parametrization used for the testbeam data, although the range of the fit was restricted to avoid edge effects. Table 1 shows the attenuation lengths thus obtained along with the tile dimensions.

Comparing the estimated attenuation lengths for tile 10 between the two methods (muon data vs. \({}^{90}\)Sr scans) we observe a 25% difference. In addition to the many differences between the two setups (DC vs. AC coupled measurements, different optical coupling between WLS fibers and PMTs, different PMTs, etc.) this discrepancy can also be due to variations of optical properties among different batches of tiles [3].

Tiles of size 10 were produced in three different batches. Batch 1 used PSM polystyrene, while Batches 3 and 4 used BASF polystyrene. The BASF polystyrene gives about 25% more light, and can have a different attenuation length. The tiles used in the scan with \({}^{90}\)Sr do not necessary belong to the same batch used to instrument the modules at the test beam.

We can also notice that the attenuation lengths generally increase with the tile dimensions with the exception of a few cases. This seems to indicate that the measurements are accurate to about 15%. For all these reasons, and to minimize the number of parameters in the Monte Carlo, we decide to neglect the differences between tiles of the same height and use one average attenuation length within each group of tiles.

A conversion factor between the testbeam and \({}^{90}\)Sr data was calculated as

\[\frac{\lambda_{\text{tile 10, TB}}}{\lambda_{\text{tile 10, }^{90}\text{Sr}}}=\frac{416.3}{537.4}=0.7747\]

and used to scale the attenuation lengths measured with the source scans on

Figure 4: An example plot of the muon response as a function of the impact position for channel 43 of the production barrel module.

the different tile sizes. Shown in the last column of table 1 are the four final numbers that we will use in the simulation. As described below, these numbers are read from a file at initialization and can be easily changed or optimized if additional information becomes available.

## 4 Optical Models in G4

### Default Optical Model

The scintillating tiles in each cell are read out through WLS fibers by two independent PMTs. It is desirable to describe this double readout in the simulation

\begin{table}
\begin{tabular}{c|c|c|c|c} Tile Size & Avg. Width (\(y\)) [mm] & Height (\(z\)) [mm] & \(\lambda_{{}^{\mathrm{aeg}}\mathrm{S}}\) [mm] & \(\lambda_{{}^{\mathrm{MC}}}\) [mm] \\ \hline
1 & 226.15 & 97 & 336.7 & 263.5 \\
2 & 236.05 & 97 & 318.5 & 263.5 \\
3 & 245.8 & 97 & 365.2 & 263.5 \\ \hline
4 & 255.75 & 127 & 482.3 & 362.0 \\
5 & 268.55 & 127 & 462.6 & 362.0 \\
6 & 281.25 & 127 & 456.8 & 362.0 \\ \hline
7 & 295.05 & 147 & 513.0 & 403.5 \\
8 & 309.8 & 147 & 583.3 & 403.5 \\
9 & 324.5 & 147 & 490.1 & 403.5 \\ \hline
10 & 341.2 & 187 & 537.4 & 406.2 \\
11 & 359.85 & 187 & 511.3 & 406.2 \\ \end{tabular}
\end{table}
Table 1: Tile dimensions and attenuation lengths from \({}^{90}\)Sr source data and values used in the simulation.

Figure 5: An example plot of the muon response as a function of the impact position for cell D3 of the production barrel module.

to some extent. During the tracking of particles in the simulation, energy hits are deposited in the active material of the detector. The visible energy is then rescaled according to Birks' saturation law for organic scintillators.4 The simulation must then divide the "light" produced by the hit between the two PMTs. The manner in which this division is made is referred to as the "optical model." Figure 7 shows a scintillating tile (not to scale) and the names of the variables used below.

Footnote 4: This effect has not been studied for the type of scintillator used by TileCal. Default parameters are taken from \(|4|\).

In the default optical model, the deposited energy \(E\) is divided between the two PMTs according to the following:

\[E_{\rm PMT~{}1}^{\rm DEF}=E\frac{L_{2}}{2L} \tag{2}\]

Figure 6: Data from a \({}^{90}\)Sr source scan along tile 10. Note that the range of the fit is restricted to neglect the edge effects at \(y=\pm 17\) cm.

Figure 7: A scintillating tile with coordinates and variable names used in this note. Note that the figure is not to scale.

\[E^{\rm DEF}_{\rm PMT\ 2}=E\frac{L_{1}}{2L} \tag{3}\]

This parametrization simply scales the energy deposited in a PMT to the distance between the hit and the opposite PMT. It is rather crude and unphysical; for instance, a hit at the PMT 1 edge of the tile would deposit all of its energy in PMT 1 and none in PMT 2. Furthermore, since \(L_{1}+L_{2}=2L\), the readout of any one cell (\(E_{\rm PMT\ 1}+E_{\rm PMT\ 2}\)) is constant in \(y\).

### Exponential Optical Model

Using the scaled attenuation lengths from the \({}^{90}\)Sr data it is a simple matter to implement an exponential optical model for light attenuation within the tiles. Equations (2) and (3) become

\[E^{\rm EXP}_{\rm PMT\ 1}=kEe^{-L_{1}/\lambda} \tag{4}\]

\[E^{\rm EXP}_{\rm PMT\ 2}=kEe^{-L_{2}/\lambda} \tag{5}\]

where \(k\) is a normalization constant.

The normalization is chosen so that the average response of the tile over \(y\) equals that of the default optical model. We require

\[\int_{-L}^{L}(E^{\rm DEF}_{\rm PMT\ 1}+E^{\rm DEF}_{\rm PMT\ 2})dy=\int_{-L}^{ L}(E^{\rm EXP}_{\rm PMT\ 1}+E^{\rm EXP}_{\rm PMT\ 2})dy\]

Substituting equations (2)-(5) we have

\[\int_{-L}^{L}(E\frac{L_{2}}{2L}+E\frac{L_{1}}{2L})dy=k\int_{-L}^{L}(Ee^{-L_{1} /\lambda}+Ee^{-L_{2}/\lambda})dy\]

The integral on the left is just \(2LE\), while the integral on the right evaluates to \(2\lambda E(1-e^{-2L/\lambda})\). Solving for \(k\) we have

\[k=\frac{L}{\lambda}\frac{1}{1-e^{-2L/\lambda}}\]

### Implementation

The division of energy between PMTs is done in the TileG4/TileGeoG4SD package within the ProcessHits() function. The following lines are equivalent to equations (2) and (3):

\begin{tabular}{l} edge\_up = edge*dy1Local/(2*halfYLocal); \\ edge\_down = edge - edge\_up; \\ \end{tabular}

while equations (4) and (5) are implemented as

\begin{tabular}{l} edge\_up = edge*exp(-dy2Local/AttenuationLength)/Izero; \\ edge\_down = edge*exp(-dy1Local/AttenuationLength)/Izero; \\ \end{tabular}

The attenuation lengths listed in table 1 are stored in TileAttenuation.dat located in the share directory of the package. In Athena release 12.0.0 exponential light attenuation is switched off by default. To activate it simply add the following to your jobOptions:theApp.Dls += ["TileSimUtils"]  theApp.CreateSvc += ["TileSimInfoLoader"]  TileSimInfoLoader = Service("TileSimInfoLoader")  TileSimInfoLoader.DoExpAtt = True

## 5 Comparison with Test Beam Muon and Pion Data

Figures 8 and 9 confirm that the modified (exponential) optical model performs as expected. In both figures, fits to simulated muon data using both optical models are superimposed on muon data from the test beam. The procedure of SS2 was used for the simulated data as well. From the figures we can clearly see that the exponential model more accurately describes the \(y\)-profile of the muon response of the calorimeter, for both single and double PMT readout.

As a final check, simulated pion data using both the default and exponential optical models were compared to test beam pion data. These runs are the same as those used in the muon analysis earlier in this note. To select pion events some simple cuts were used: \(\sum_{i=1}^{6}E_{i}>50\) pC to eliminate muons, while requiring Cherenkov counts to be above a certain threshold5 to reduce proton contamination. Cuts on \(|X_{\rm imp}|<10\) mm and \(|Y_{\rm imp}|<10\) mm were also used.

Footnote 5: Cher1 > 210.

In figure 10 the mean of the pion response in the impact cell (D3) is plotted as a function of the impact position. The pion response in all 6 modules was also fit with a Gaussian, the mean of which was then plotted as a function of the vertical position (figure 11). In the central region of the production barrel module (\(|y|\leq 125\) mm) the mean percent difference between the data and the default model is 2.5%, while for the exponential model this drops to 1.2%.

Figure 8: Muon response in Module P1, Channel 40 vs. \(y\). Also shown are fits to the simulated data with the default and exponential optical models.

An interesting feature of figure 11 is the disagreement between the testbeam data and both simulations at \(y=\pm 175\) mm. This can be explained by looking at the response in cells outside of the shower containment. Figure 12 shows the various cells of a TileCal module. The larger of the two shaded regions is cell D3--the impact cell--while cell A9 is the smaller of the shaded regions. In figure 13, the mean of the pion response in the PMTs reading out cell A9 is plotted as a function of \(y\). This cell is well outside of the pion shower containment, but shows a significant increase in pion response around \(y=\pm 175\) mm.

As shown in figure 1 the WLS fibers which read out the tiles pass along the edges of the module to the PMTs. The increase in pion response at the edges of the modules can then be interpreted as coming from Cherenkov light being produced directly in the WLS fibers. This effect is not yet taken into account in the simulation, leading to the disagreement with the testbeam data at \(y=\pm 175\) mm in figure 11.

## 6 Conclusions

An exponential optical model for light attenuation in tiles based on testbeam and \({}^{90}\)Sr source data was presented. This model more closely matches the testbeam data at 90\({}^{\circ}\) than the default and can easily be implemented in Athena release 12. The effect of Cherenkov light production within the WLS fibers has also been observed in the testbeam data, and is not accounted for in the simulation.

## 7 Acknowledgements

Thanks are due to Alexei Miagkov _et al._ from Protvino for conducting the \({}^{90}\)Sr source scans. I would also like to thank Ana Henriques, Martina Hurwitz, Jim

Figure 9: Muon response in Module P1, Cell D1 vs. \(y\). Also shown are fits to the simulated data with the default and exponential optical models.

Pilcher, Sasha Solodkov, and Giulio Usai for their guidance, suggestions, and editorial comments.

## References

* [1] ATLAS Tile Calorimeter Collaboration. _Tile Calorimeter Technical Design Report_ CERN/LHCC 96-42, 15 Dec 1996.
* [2] T. Davidek, R. Leitner. _Parametrization of the Muon Response in the Tile Calorimeter_. ATL-TILECAL-97-114, 10 Apr 1997.
* [3] A. Henriques _et al._ Note currently in preparation available at: [http://atlasinfo.cern.ch/Atlas/SUB_DETECTORS/TILE/production/optics/instrumentation/monitor/modules_lightyield.pdf](http://atlasinfo.cern.ch/Atlas/SUB_DETECTORS/TILE/production/optics/instrumentation/monitor/modules_lightyield.pdf)
* [4] R. L. Craun, D. L. Smith. _Analysis of response data for several organic scintillators_. NIM A **80**, 15 Apr 1970, pp. 239-244.

Figure 10: The mean of the pion response in Module P1, Channel 43 as a function of \(y\) for the test beam data and the simulation with the default and exponential optical models. This PMT reads out cell D3, the impact cell for these runs.

Figure 11: The mean of a Gaussian fit of the pion response in all 6 modules is plotted as a function of \(y\) for the test beam data and the simulation with the default and exponential optical models. Default simulation data were unavailable for \(y=150\) mm. The prototype Module 0, which has a different calibration, is located in the region \(y<-175\) mm. Note the increase in test beam response at \(y=\pm 175\) mm. This is due to Cherenkov light produced in the WLS fibers between the modules, and is not accounted for in the simulation.

Figure 12: The impact cell for the August 2002 pion runs is D3, the larger of the two shaded regions. Cell A9, which shows an increase in response around \(y=175\) mm, is the smaller of the shaded areas.

Figure 13: The mean of the pion response in Module P1, Channels 38 and 39. These PMTs read out the A9 cell, which is well outside of the shower containment.