**ATLAS Muon Note**

**16. April 1999**

**Obtaining the Space-Time**

**Relationship of Drift Tubes from the Drift-Time Spectrum**

M. Deile1, N.P. Hessey2

Footnote 1: University of Munich

Footnote 2: NIKHEF

**Abstract**

Autocalibration of MDT chambers requires a good start-value for the space-time relationship. This note presents two improvements on the "Integration Method": the first corrects for \(\delta\)-rays, the second also takes into account resolution and efficiency effects. Both methods use only the drift-time spectrum. The new methods improve the rms error from \(345\,\mu\)m to \(80\,\mu\)m and \(18\,\mu\)m respectively.

[MISSING_PAGE_EMPTY:2]

Introduction

Several studies have shown that for the correct convergence of autocalibration to the true space-time (r-t) relationship a good start r-t relationship is necessary. This is especially important with low angular spread of tracks, because then autocalibration cannot uniquely determine the r-t relationship [1], [2]. It is also important in the presence of a background, where track finding is harder. A good start value also saves on computing power needs.

In the past, the following approaches have been used to derive an initial r-t relationship:

* Straight line: Even for highly linear gases like the "Datcha gas" (Ar / N 2 / CH = 91 / 4 / 5) this approximation yields very bad results (upto 700 \(\mu\)m out). For non-linear gases like Ar / CO\({}_{2}\) mixtures it completely fails.
* Simulation with Garfield [3]: Garfield is interfaced to the packages MAGBOLTZ [4] (gas properties and transport equations) and HEED [5] (interaction of particles with matter) and provides the best available knowledge about the detector response. Its prediction of the r-t relationship is therefore quite accurate (upto 200 \(\mu\)m out). A full simulation is required to reach this accuracy, for each magnetic field value etc. And still there are variations not taken into account such as temperature and water content of the gas.
* Integration Method [6]: This approach is based on the MDT data itself, and takes into account variations such as water content automatically. However, since it ignores important effects like \(\delta\)-rays, resolution and efficiency, it gives bad results (upto 450 \(\mu\)m out).

Figure 1 compares the accuracy of these techniques for the "Datcha gas". We have looked for an improvement on the integration method, whilst retaining its advantage of automatically accounting for local variations in operating conditions. This also retains the full spirit of having a self-calibrating detector, unlike resorting to Garfield; but of course Garfield remains a very good method. The new methods take into account more knowledge of the drift-tube response and give a much better precision than Garfield.

Our knowledge about the detector response stems from measurements with a 30 cm long bundle of 16 drift tubes in the H8 test beam in 1997. The tubes were operated with the "Datcha gas" at 3 bar pressure and with a gain of \(2\cdot 10^{4}\). As external reference system we used ODYSSEUS [7], a beam telescope with a resolution of 5 \(\mu\)m for the track position at the chamber.

Our parametrization of the detector response has also been used for the development of a maximum likelihood method for track reconstruction [8].

## 2 Methods of Extracting the r-t Relationship from the Drift-Time Spectrum

The drift-time spectrum of a drift tube is determined by the radial illumination spectrum and the detector response. The latter can be described by \(P(t|r)\), i.e. the probability of measuring a drift time \(t\) under the condition that the muon track had a minimum distance \(r\) from the wire.

From the product rule for probabilities (see e.g. [9])

\[P(t,r)=P(t|r)\cdot P(r) \tag{1}\]

where \(P(t,r)\) is the 2-dimensional probability density for having a muon track at a distance \(r\) and measuring a time \(t\) (figure 2). Marginalization yields

\[P(t)=\int_{0}^{\infty}\,P(t,r)dr=\int_{0}^{\infty}\,P(t|r)\cdot P(r)\,dr\quad. \tag{2}\]

Recognizing that \(P(t)\) is the normalized drift time spectrum \(T(t)\), and \(P(r)\) is the normalized radial distribution of tracks \(R(r)\) giving hits in the tube, we have

\[T(t)=\int_{0}^{\infty}\,P(t|r)\cdot R(r)\,dr\quad. \tag{3}\]

This is the basic equation for our following considerations. Our task will be to unfold (3) and to extract the r-t relationship which is a component of the detector response function \(P(t|r)\). As we shall see, for simple response functions this inversion problem can be solved exactly, whereas for more realistic descriptions a numerical approach has to be made.

Figure 1: _Comparison of the performance of three usual techniques for determining a start r-t relationship for autocalibration. The plot shows the difference between the estimated and the true track radius at a given drift time \(t\)._

### Integration Method

Let's first consider the approximation of an ideal detector response, i.e.

\[P(t|r)=\delta(t-\tau(r))\quad, \tag{4}\]

where \(\tau(r)\) is the correct r-t relationship. Then (3) becomes

\[T(t) = \int_{0}^{\infty}\,\delta(t-\tau(r))\cdot R(r)\,dr \tag{5}\] \[= \int_{0}^{\infty}\,\delta(r-\rho(t))\cdot\frac{d\rho}{dt}\cdot R( r)\,dr\] (6) \[= R(\rho(t))\cdot\frac{d\rho}{dt} \tag{7}\]

Here the (reasonable) assumption has been made that \(\tau(r)\) is monotonous and therefore has an inverse function \(\rho(t)=\tau^{-1}(t)\), and that \(d\tau/dr\) is never zero: this may be invalid near the wire.

Integrating gives

\[\int_{-\infty}^{t}\,T(t^{\prime})\,dt^{\prime}=\int_{0}^{\rho(t)}\,R(r)\,dr\quad. \tag{8}\]

Usually it is assumed that the illumination is homogenous and the efficiency is 1 from \(r=0\) to the inner tube radius \(b\). For the radial hit distribution this means

\[R(r)=\frac{1}{b}\quad\mbox{if $0<r<b$ and $0$ otherwise.} \tag{9}\]

In a beam this is usually a bad approximation. If we still rely on it, (8) simplifies to

\[\rho(t)=b\int_{-\infty}^{t}\,T(t^{\prime})\,dt^{\prime} \tag{10}\]

Figure 2: _r-t Relationship of the “Datcha gas”. The track radius \(r\) was measured with the silicon telescope; \(t\) is the drift time of the first TDC hit._For a (normalized) histogrammed drift-time spectrum \(T(t_{i})\) this can be written as a sum over bin contents upto the bin containing \(t\):

\[\rho(t)=b\sum_{i=1}^{n}\,T(t_{i}) \tag{11}\]

Equation (11) is the well-known integration method. As we already pointed out in the introduction, it produces an r-t relationship which agrees very badly with the true one. The main reason is that this approach neglects \(\delta\)-rays which have a considerable influence on the shape of the drift-time spectrum. In the following section we refine the model by introducing a correction term for \(\delta\)-rays.

### Integration Method with \(\delta\)-Ray Correction

To take \(\delta\)-rays into account, we modify the perfect detector response (4) by adding a constant term \(d\) to the conditional probability density \(P(t|r)\) at drift times \(t<\tau(r)\). Although for the definition of the r-t relationship the absolute zero-point of the time measurement is arbitrary, we need to introduce a lower cutoff \(\tau_{0}\) for the \(\delta\)-ray background term. The response function is now given by

\[P(t|r)=[1-d\cdot(\tau(r)-\tau_{0})\cdot\Theta(\tau(r)-\tau_{0})]\cdot\delta(t- \tau(r))+d\cdot\Theta(\tau(r)-t)\cdot\Theta(t-\tau_{0}) \tag{12}\]

where the \(\Theta\)-functions define the cutoff times for the \(\delta\)-ray background. The factor applied to the \(\delta\)-function assures the proper normalization.

Considering the \(\delta\)-ray probability density as constant - independent of \(r\) and \(t\) - is a reasonable approximation. A more detailed treatment is described in section 2.3 where the probability density varies with \(r\), but this prevents an analytical solution.

Putting (12) into the basic equation for the drift time spectrum (3) we get after some simplifications:

\[T(t)=R(\rho(t))\cdot\frac{d\rho}{dt}\cdot[1-d\cdot(t-\tau_{0})\cdot\Theta(t- \tau_{0})]+d\cdot\Theta(t-\tau_{0})\cdot\int_{\rho(t)}^{\infty}R(r)dr \tag{13}\]

As in the simple integration method we assume flat illumination and perfect efficiency (9) and obtain, after reorganization, the differential equation

\[\dot{\rho}(t)\,[1-d\cdot(t-\tau_{0})\cdot\Theta(t-\tau_{0})]-\rho(t)\cdot d \cdot\Theta(t-\tau_{0})=b\cdot T(t)-b\cdot d\cdot\Theta(t-\tau_{0}) \tag{14}\]

This equation can be solved analytically. The resulting r-t relationship is given by

\[\rho(t)=\frac{b}{1-d\cdot(t-\tau_{0})\cdot\Theta(t-\tau_{0})}\cdot\left[\int_ {-\infty}^{t}\,T(t^{\prime})\,dt^{\prime}-d\cdot(t-\tau_{0})\right] \tag{15}\]

The improvement with respect to the conventional integration method is demonstrated by figure 3: The rms deviation of the reconstructed r-t relationship from the true one is reduced from \(345\,\mu\)m to \(80\)\(\mu\)m. The assumption of a flat illumination is a very poor approximation for the H8 beam (see figure 4). This is probably a major contribution to the 80 \(\mu\)m rms deviation.

The bad agreement near the wire is not only to blame on the integration methods. The determination of the r-t relationship with the silicon telescope is based on gaussian fits to the distribution of \(r_{hit}-r_{SILI}\) in drift-time slices. Near the wire however these residuals are very non-gaussian and the fits determine the r-t relationship only badly. Therefore also the error of the reference r-t relationship contributes to the deviation.

To improve the precision of the calculated r-t relationship we will in the following chapter introduce all known details of the detector response into our description.

### Unfolding the Detector Response

In both the preceding methods, the integral in (3) could be evaluated, and with simplifying assumptions for \(R(r)\) analytical forms for \(\rho(t)\) were obtained. With more realistic responses, the integral is difficult to solve and we resort to numerical methods. In the unfolding technique, \(P(t|r)\) and \(R(r)\) are parametrized, and the spectrum \(T(t)\) evaluated by numerical integration of (3) with some initial set of parameters. The parameters for resolution, efficiency and \(\delta\)-rays are all taken from silicon telescope measurements. The r-t relationship starts with, say, a straight-line guess. The resulting spectrum is compared to the measured

Figure 3: _Comparison between the simple and the \(\delta\)-ray-corrected integration method for a \(\delta\)-ray probability density \(d\) = 0.00024 ns\({}^{-1}\). The plot shows the difference between the estimated track radius and the one determined by the r-t relationship measured with the silicon telescope._

drift-time spectrum \(T_{m}(t)\) by calculating the following chi-squared:

\[\chi^{2}=\sum_{\rm bins}\frac{[T_{m}(t)-T(t)]^{2}}{T_{m}(t)} \tag{16}\]

Then the parameters for the r-t relationship are varied to minimize \(\chi^{2}\).

The drift-time spectrum has contributions from all muons giving a hit: over most of the tube, the hit efficiency is very close to 1, but near the wall it drops rapidly. The efficiency is taken into account by writing \(R\) as a product of the beam profile \(b\) and efficiency \(\epsilon\):

\[R(r)=b(r)\cdot\epsilon(r) \tag{17}\]

The beam profile is parametrized by

\[b(r)=\sum_{i=0}^{2}b_{i}\,y^{i}\quad\mbox{where $y=5.89\pm r$} \tag{18}\]

where y is the position of the muon (in mm) in the coordinate system used in the data analysis. Since the beam profile is not symmetric about the wire, the integral in (3) is carried out separately for the two halves, and then the two contributions are added together. Figure 4 shows the measurement of the beam profile with the silicon telescope, with a fit superposed.

Figure 4: _Beam profile measured with the silicon telescope with the fit superimposed. The tube covered the region (\(5.89\pm 15\)) mm as indicated._

The inefficiency (figure 5) can be fitted reasonably well with

\[1-\epsilon(r)=\frac{1}{2}\left[\mbox{erf}\left(\frac{r-r_{max}}{w}\right)+1\right] \tag{19}\]

where

\[\mbox{erf}(x)\equiv\int_{0}^{x}\frac{1}{\sqrt{2\pi}}e^{-\frac{(x^{\prime})^{2} }{2}}\,dx^{\prime}\quad. \tag{20}\]

\(r_{max}\) is the radius with \(50\,\%\) efficiency which from silicon telescope measurements is very close to the tube inner radius (\(14.75\) mm for the \(250\,\mu\)m thick tubes used for this study, \(14.6\) mm for standard MDT tubes). The parameter \(w\) is a measure of the width of the region where the efficiency drops. In practice it is different on opposite sides of the tube due to the wire being off-centre. We have taken the average of the parameter fit values for the two sides.

The drift tube response \(P(t|r)\) has been determined by fitting the time distributions in r-slices of the measured r-t distribution (figure 2). Two typical response examples are given in figure 6, one near the wire, the other further away. The fits superimposed over the spectra are performed with the following function (based on work in [8]):

\[P(t|r) = d(r)\cdot\theta(t,r)+f(r)\frac{1}{\sigma}e^{(\Delta-e^{\Delta}) }+[1-f(r)-D(r)]\frac{1}{\sqrt{2\pi}\,\sigma}\,e^{-\frac{\Delta^{2}}{2}} \tag{21}\] \[\Delta \equiv \frac{\tau(r)-t}{\sigma(r)}\] (22) \[\theta(t,r) \equiv \Theta(\tau(r)-t)\cdot\Theta(t-\tau_{0})\] (23) \[D(r) \equiv \int_{-\infty}^{+\infty}d(r)\cdot\theta(t,r)\,dt=(\tau(r)-\tau_{ 0})\,d(r) \tag{24}\]

Figure 5: _Inefficiency as a function of the track position in the regions near the tube walls measured with the silicon telescope. The superposed fit is explained in the text. The vertical lines at \(\pm 14.75\) mm indicate the nominal positions of the inner wall surfaces._

The \(\delta\)-ray probability density (first term in (21)) is taken to be a flat box in time from \(\tau_{0}\) (close to \(0\)) to \(\tau(r)\), with magnitude \(d(r)\) as a fit parameter. Figure 7(a) shows the fit results as a function of \(r\) with the following Legendre polynomial parametrization superimposed:

\[d(r)=\sum_{m=0}^{6}d_{m}\,P_{m}(u)\quad\mbox{with $u\equiv\frac{2\cdot r}{14.75\, \mbox{mm}}-1$}\quad. \tag{25}\]

The assumption of \(\delta\)-rays being evenly distributed in time is an oversimplification but difficult to improve on, owing to the low statistics for the \(\delta\)-ray part. Figure 2 shows that the \(\delta\)-ray density (density of points below the main band in the r-t distribution) is approximately constant. This box form gives a sharp step at \(t=\tau_{0}\) in the drift-time spectrum. We have found that \(\tau_{0}=10\,\mbox{ns}\) gives a better \(\chi^{2}\) than \(\tau_{0}=0\) because the step then coincides with the maximum of the time spectrum and is easier to accommodate. Setting it to zero has little effect on the unfolded r-t relationship.

The total probability to have a \(\delta\)-ray at radius \(r\) is \(D(r)\), defined in (24). It is plotted in figure 8 and agrees well with previous measurements of this quantity.

The main part of the response has 3 parameters: the fraction \(f(r)\) of extreme-value function in it (which accounts for the asymmetric tail near the wire), a width parameter \(\sigma(r)\) which is a measure of the time-resolution (close to, but not equal to the rms), and the position \(\tau(r)\) of the maximum of the response. We _define_ the r-t relationship as the locus \(\tau(r)\) of the maximum of the response with \(r\). This coincides with the usual definition when the response is Gaussian. These three parameters are extracted from fits as in figure 6 for each \(r\). Their variation with \(r\) has been plotted in figure 7, with the following parametrizations superimposed:

Figure 6: _Typical drift tube time-responses near the wire (a: \(0\leq r\leq 0.2\,\mbox{mm}\)) and far from the wire (b: \(6.6\,\mbox{mm}\leq r\leq 6.8\,\mbox{mm}\)) measured by the silicon telescope, with parametrized fit superimposed._

\[f(r) = f_{0}\,e^{-f_{1}\,r} \tag{26}\] \[\tau(r) = \sum_{m=0}^{7}a_{m}\,P_{m}(u)\quad\mbox{with }u\equiv\frac{2\cdot r}{14.75\,\mbox{mm}}-1\] (27) \[\sigma(r) = s_{0}\,e^{-s_{1}\,r}+s_{2}+s_{3}\,r+s_{4}\,r^{2}+e^{\frac{r-s_{5} }{s_{6}}} \tag{28}\]

In the parametrization of \(\sigma(r)\), the first exponential deals with the poor resolution near the wire, the second with the deterioration near the wall. The parameter \(s_{5}\) is sensitive to the tube radius; for tubes with \(400\,\mu\)m wall thickness it should be reduced by \(0.150\,\mbox{mm}\).

Figure 7: _Variation of response parameters with \(r\). (a) \(\delta\)-ray probability density \(d(r)\); (b) fraction \(f(r)\) of extreme-value function (asymmetry); (c) true space-time relationship \(\tau(r)\) (not used for the unfolding); (d) width parameter \(\sigma(r)\). The curves show the fitted parametrizations._

separately,

\[\int_{-\infty}^{+\infty}P(t|r)\,dt=d+f+(1-f-p)=1 \tag{29}\]

\(\tau(r)\) is the quantity to be determined by the unfolding process; the fit from the silicon telescope gives us the true value with which to compare the unfolded relationship. We have used Legendre polynomials for the parametrization because their orthogonality gives a much more diagonal error matrix and hence speeds up the minimization and makes it more stable. In early work the fit did not converge (more than 24 hours cpu) for ordinary polynomials of 7th order or higher, whereas with Legendre's 8th order fits take about 3 minutes on a 233 MHz Pentium processor.

Table 1 gives the values of all coefficients for the parametrization of \(R(r)\) and \(P(t|r)\). With these, but with a straight-line start value for \(\tau(r)\), the unfolded \(\tau(r)\) has been extracted using a C-program called dt2rt. This uses the NAGLIB routine E04FDF to carry out the minimization.

\begin{tabular}{r l} \(b_{i}\) & 3393. -0.01536 -1.073 \\ \(r_{max}\) & 14.75 \\ \(w\) & 0.067 \\ \(d_{i}\) & 0.2142e-03 0.8729e-05 0.7319e-05 0.1145e-03 -0.3554e-04 0.9082e-04 \\ \(f_{i}\) & 0.8718 0.4527 \\ \(a_{i}\) & 237.0 255.2 -2.430 -7.737 9.262 -4.444 1.316 0.1209 \\ \(s_{i}\) & 3.1026 3.9725 4.6233 -0.15388 0.53083e-02 14.5 0.27998 \\ \end{tabular}

Table 1: _All parameters used for \(P(t|r)\) and \(R(r)\). The units of length and time are mm and ns. The values of \(a_{i}\) correspond to the true r-t relationship and are only used for comparison with the fit result._

Figure 8: \(\delta\)_-ray probability \(D\) as a function of \(r\)._

To evaluate the result, the unfolded relationship is compared to the measured one. This is done by calculating \(\tau(r)\) at 0.3 mm steps. Both relationships have small time offsets at \(r=0\) (1.7 ns and 1.1 ns) which have been subtracted from all times before making the comparison: they represent a \(t_{0}\) which is usually better calculated by other means more accurately (e.g. Fermi-function fit to the leading edge of the drift-time spectrum). In any case, the difference is small, so the method may have some use in determining \(t_{0}\) too. Figure 9a shows the time difference of the results. The difference is always less than 1.2 ns, and the rms difference is 0.6 ns. Multiplying the time differences by the local drift

Figure 10: _The drift time spectrum used for unfolding \(T_{m}(t)\). The smooth curve is the folded spectrum \(T(t)\) with the final parameters._

Figure 9: _a: Difference between unfolded and true \(\tau(r)\). b: Time difference converted into a radius difference using the local drift velocity._

velocity yields the radial deviations shown in figure 9b. Figure 10 shows the input drift-time spectrum with that resulting from the final values of the parameters. The agreement is excellent.

At ATLAS, drift tubes will be operated at different magnetic fields, temperatures and other things. These change not only the r-t relationship, but the whole response function. In practice we cannot measure the response under all conditions; we will use one (or a small number of) response functions for unfolding the r-t relationship. The accuracy will depend on how much the response differs from the one used. We expect efficiency and \(\delta\)-ray probability to be rather independant of the conditions; it is mainly the resolution that will be affected. However it is a slow function of conditions, and the results away from the wire and wall are insensitive to the resolution, at least for linear gases. This insensitivity prevents us from also extracting the resolution from unfolding.

In ATLAS the drift-time spectrum will have a significant background contribution. This will have to be subtracted before unfolding, and the weights in (16) modified. This background subtraction needs great care and may turn out to be the factor limiting the accuracy of unfolding.

The problem of uneven illumination in test beams will be much reduced within a domain of autocalibration in ATLAS. The spectra from all tubes in such a zone (about 100) would be summed (after \(t_{0}\) correction); this means that there would be very high statistics.

Note that the numbers presented here are for tubes with \(250\,\mu\)m walls and require modification for tubes with the now standard \(400\,\mu\)m wall thickness. In particular the \(\delta\)-ray probability changes: not only does the rise at the wall start \(150\,\mu\)m earlier, but the overall level is higher due to the extra material.

Conclusion

Three methods for obtaining the r-t relationship from the drift time spectrum have been described. Figure 11 compares their accuracy. The rms deviations from the true r-t relationships are 345, 80 and 18 \(\mu\)m for the traditional integration, integration with \(\delta\)-ray correction, and unfolding techniques respectively. Clearly the new methods are much more accurate; unfolding is the most accurate method so far, even better than Garfield which has an rms deviation of 109 \(\mu\)m. The accuracy of the result shows that we have a very good understanding of the response of the drift-tube.

In both test-beam data analysis and for calibration in the ATLAS spectrometer, the new methods provide an extremely good start position for autocalibration. This will not only save computing effort, but will improve the end result because the outcome of autocalibration still has some dependance on the start r-t relationship, especially when only a narrow range of track-angles is present.

Figure 11: _Comparison of the accuracies of all described methods for obtaining a first order r-t relationship._

## References

* [1] T. Sammer, Autokalibration von Driftrohrkammern fur das ATLAS-Myonenspektrometer, diploma thesis in german, LMU Munich 1997
* [2] P. Creti et al.: Testbeam Results from the Calypso MDT Chamber. Muon-No-196, 24 October 1997.
* [3] R. Veenhof, GARFIELD: Simulation of gaseous detectors, CERN, writeup: [http://wwwinfo.cern.ch/writeup/garfield](http://wwwinfo.cern.ch/writeup/garfield)
* [4] S. Biagi, MAGBOLTZ, program to compute gas transport parameters, CERN.
* [5] I. Smirnov, HEED, program to compute energy loss of fast particles in gases, CERN.
* space relation for HPDT, ATLAS Muon Note 40, CERN 1994
* a Silicon Telescope for Test Beam Experiments, System Description and User Manual for the Data Analysis, LMU Munich 1998, available on the WWW-page: [http://www.etp.physik.uni-muenchen.de/atlas/testbeam.html](http://www.etp.physik.uni-muenchen.de/atlas/testbeam.html)
* [8] M. Deile, N. Hessey, A. Staude: MDT Track Fitting with the Maximum Likelihood Method, ATLAS Muon Note 240, CERN 1998.
* A Bayesian Tutorial, Oxford 1996