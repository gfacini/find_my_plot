January 13, 1999

Pseudorapidity determinat ion with the electromagnetic end cap calorimeter

Christos Liapis

_Universidad Aut'onoma de Madrid_

Possible improvements in the pseudorapidity determination using the end cap of the electromagnetic calorimeter are examined. A method for determining the shower barycenters in the calorimeter samplings is presented. In addition, a new S-shape correction function in the form of a truncated Fourier series is calculated separately for each \(\eta\) value. These methods are applied to the measurement of the pseudorapidity and vertex z-coordinate using the end cap of the electromagnetic calorimeter. The pseudorapidity resolution is compared with that required for the detection of the decay H \(\rightarrow\gamma\gamma\).

[MISSING_PAGE_EMPTY:2]

deposition in each sampling defines a hit. In the simplest approach, the reconstructed track is the straight line joining the two hits. The reconstruction takes place in the plane of constant \(\,\phi\) that is defined by the beam axis and the track. Once this plane has been determined, the cylindrical coordinates \(z\) and \(R\) suffice to specify the hit. Instead of \(R\) one may use the polar angle measured from the center of the ATLAS detector (see Fig. 1), which is also the origin of the coordinate system used in the analysis. In this way a correspondence is made with the case of a particle originating at the center of the detector. This correspondence is useful because of the projective property of the calorimeter, which means that the \(\eta\) cells in each sampling point back to the center of the detector. They can therefore be labelled by the pseudorapidity of a hypothetical track joining the center of the detector to the center of the cell. These labels will be used in the determination of track directions.

In what follows, the "pseudorapidities" corresponding to the hits in samplings 1 and 2 are denoted \(\eta_{S1}\) and \(\eta_{S2}\), respectively. These are obtained using the standard reconstruction algorithm [2]. I used the 97_12 version of the libraries. One exception concerning the S-shape correction was mentioned in the introduction: the correction function has been modified so as to depend on pseudorapidity. In addition, it is obtained from the same Monte Carlo sample that is used in the reconstruction instead of being derived from events with vertices at \(z=0\). To complete the calculation one needs to estimate \(z\) in the two samplings. A new method has been used for this purpose and is detailed below.

### S-shape correction

Because of the appreciable size of the calorimeter \(\eta\) cells, hits in \(\eta\) are reconstructed with a bias that depends on their position with respect to the cells that collect their energy. This systematic bias can be corrected once its form is known. It can in fact be deduced from the available Monte Carlo data. One complication, however, is that \(\eta_{S1}\) and \(\eta_{S2}\), the quantities measured in the first two calorimeter samplings, represent a pseudorapidity only in the case of particles that emanate from the coordinate origin. For such particles, the bias could be studied by generating a sample of Monte Carlo events with the primary vertex at the origin and comparing the true ("generated") \(\eta\) to the "reconstructed" variables \(\eta_{S1}\) and \(\eta_{S2}\).

This comparison cannot be made for the purpose of studying the S-shape effect when the vertex is not at the origin. Instead, two new variables are introduced, one for each sampling. In a sense that will be described below, these are the "generated" quantities that correspond to the reconstructed \(\eta_{S1}\) and \(\eta_{S2}\). Then, for the first sampling, the difference between the "generated \(\eta_{S1}\)" and the reconstructed \(\eta_{S1}\) is obtained from the Monte Carlo as a function of the reconstructed \(\eta_{S1}\). It is an additive correction that can be used to recover the "generated \(\eta_{S1}\)" from the reconstructed \(\eta_{S1}\). An entirely similar correction can be applied in the second sampling in order to recover the "generated \(\eta_{S2}\)." These corrected quantities do not exhibit any significant S-shape bias and can be used in the subsequent stages of track reconstruction.

The meaning of the "generated" quantities may be understood as follows. Each hit in a calorimeter sampling corresponds to a signal from an appropriately chosen group of adjacent cells. The (energy-weighted) mean of the pseudorapidity values of the cells in such a cluster is assigned to the hit. As mentioned above, these values correspond to the pseudorapidities of particles originating at the center of the detector. This motivates the following definition. The "generated" quantity corresponding to the reconstructed pseudorapidity in the sampling (\(\eta_{S1}\) or \(\eta_{S2}\)) will be taken as the pseudorapidity of the imaginary straight line joining the hit in the sampling to the coordinate origin (see Fig. 1). The angle between this line and the beam axis (the "reduced" angle corresponding to the polar angle of the particle) is given by

\[\tan\theta_{\rm red}=\frac{z_{\rm hit}-z_{\rm vtx}}{z_{\rm hit}}\tan\theta,\]

where \(z_{\rm hit}\) is the coordinate of the hit along the beam axis and \(z_{vtx}\) is the coordinate of the vertex. For the pseudorapidities we have

\[\sinh\eta_{\rm red}=\frac{z_{\rm hit}}{z_{\rm hit}-z_{\rm vtx}}\sinh\eta\]

and \(\eta_{\rm red}\) is the "generated" quantity that can be directly compared to \(\eta_{S1}\) or \(\eta_{S2}\).

A scatter plot relating the generated and reconstructed quantities for the second sampling around \(\eta=1.7\) is displayed in Fig. 2. The periodic S-shape form is obvious. It is convenient to redefine the variable \(\eta_{S2}\) so that it is zero at the center of each read-out cell, taking advantage of the S-shape periodicity in order to combine data from adjacent cells in a new scatter plot (see Fig. 3). Now the ordinate is the difference between the generated and the reconstructed \(\eta_{S2}\). This is the correction that must be added to the measured \(\eta_{S2}\) in order to recover the generated \(\eta_{S2}\). It should be noted that this plot includes all \(z_{vtx}\) values that occur in the Monte Carlo sample.

Figure 1: Definition of the reduced angle as the angle formed by the beam axis and the line that joins the hit (H) to the coordinate origin. The particle vertex lies at \(z=z_{vtx}\) and the polar angle of the track is \(\theta\).

Figure 3: The scatter plot gives the difference between the generated and the reconstructed \(\eta_{S2}\) vs. the reconstructed \(\eta_{S2}\). The data belong to a pseudorapidity interval of width 0.05 (twice the cell size) around \(\eta=1.7\) and zero corresponds to the center of the cell. A profile histogram is obtained from the scatter plot. Then a fit to the histogram is made in the form of a truncated Fourier series. The result of the fit is taken as the S-shape correction function.

Figure 2: Reconstructed \(\eta_{S2}\) in terms of generated \(\eta_{S2}\). The pseudorapidity interval shown corresponds to two calorimeter cells, the boundary between them being at \(\eta=1.7\).

Figure 4: Variation with pseudorapidity of the sampling 2 parameters. From top to bottom: \(p_{0}\) - \(p_{3}\).

Figure 5: Parameters of S-shape correction function for sampling 1. The index along the horizontal axis denotes the granularity segment (see Table 2).

The profile histogram obtained from the scatter plot of Fig. 3 closely approximates a sine function that vanishes at the center and the boundaries of read-out cells, as expected for the S-shape correction function. The addition of a few more trigonometric terms gives a better fit to the profile. In all, three sine terms are used, which preserve the behavior of the function at the cell center and boundaries. However, the addition of a small overall constant term turns out to improve the fit further. The final form of the correction function for sampling 2 is

\[s(x)=p_{0}+p_{1}\sin(\pi x/a)+p_{2}\sin(2\pi x/a)+p_{3}\sin(3\pi x/a),\]

where \(a\) is half the cell width and \(x\) is the position with respect to the center of the cell (where \(x=0\)). The values of the fitted parameters are given in Table 1 for the various Monte Carlo samples and are plotted as a function of pseudorapidity in Fig. 4. At \(\eta=1.8\) and \(\eta=2.3\) Monte Carlo samples with different energies were available. There is no significant disagreement between the corresponding parameters, so an average over the energies should be taken in general. Furthermore, the variation of the parameters with \(\eta\) is smooth. At different pseudorapidity values than those given in the table, they may therefore be obtained by interpolation. Only pseudorapidity values greater than 1.6 were used. For smaller values the determination of the barycenter by the method presented below is problematic because of the substantial presence of dead material in front of the calorimeter.

The same correction method could in principle be used for sampling 1, although in practice the finer granularity of this sampling makes the S-shape less pronounced (see Fig. 6). The smaller cell size implies, however, that the systematic error due to the S-shape bias is now smaller, so correcting for this effect is less important for the first sampling. Because of the smearing in the S-shape, the method described above does not give as good a fit for sampling 1 as for sampling 2. In order to have a converging fit, only one constant term and one sine term are used. The results do not permit establishing an \(\eta\) dependence of the parameters, especially since only a few \(\eta\) points are available in each granularity segment. One set of parameters is therefore used for each granularity segment, obtained by averaging over \(\eta\). The final averages are shown in Table 2 and are plotted in Fig. 5.

\begin{table}
\begin{tabular}{|c|r|r|r|r|r|r|r|r|r|} \hline \(\eta\) & \(E_{t}\) & \(p_{0}\) & \(e_{0}\) & \(p_{1}\) & \(e_{1}\) & \(p_{2}\) & \(e_{2}\) & \(p_{3}\) & \(e_{3}\) \\  & (GeV) & \(10^{-4}\) & \(10^{-4}\) & \(10^{-2}\) & \(10^{-4}\) & \(10^{-3}\) & \(10^{-4}\) & \(10^{-3}\) & \(10^{-4}\) \\ \hline
1.7 & 25 & -.538 &.15 &.398 &.22 &.587 &.23 &.259 &.22 \\
1.8 & 50 &.544 &.42 &.403 &.56 &.587 &.53 &.155 &.55 \\
1.8 & 80 & 1.29 &.18 &.403 &.24 &.473 &.28 &.269 &.27 \\
1.9 & 50 &.958 &.18 &.399 &.25 &.455 &.29 &.284 &.28 \\
2.0 & 50 & 1.09 &.33 &.381 &.41 &.391 &.43 &.323 &.53 \\
2.2 & 80 & 1.24 &.23 &.380 &.34 &.334 &.39 &.174 &.37 \\
2.3 & 25 &.786 &.24 &.365 &.35 &.192 &.35 &.152 &.34 \\
2.3 & 50 &.935 &.33 &.365 &.44 &.283 &.44 &.117 &.50 \\ \hline \end{tabular}
\end{table}
Table 1: Parameters (\(p\)) of S-shape correction functions for sampling 2 and associated errors (\(e\)), calculated by fitting. Note the power of 10 multiplying each entry.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline Granularity & \(\eta\) & \(p_{0}\) & \(e_{0}\) & \(p_{1}\) & \(e_{1}\) \\ \hline
1 & 1.7, 1.8 &.156E-04 &.52E-05 & 0.546E-03 &.67E-05 \\
2 & 1.8, 1.9, 2.0 &.238E-04 &.70E-05 & 0.718E-03 &.83E-05 \\
3 & 2.0, 2.2, 2.3 &.574E-04 &.59E-05 & 0.109E-02 &.69E-05 \\ \hline \end{tabular}
\end{table}
Table 2: Parameters of S-shape correction functions for sampling 1. Three different granularity regions were considered. The eta values of the Monte Carlo tracks used in obtaining the parameters are shown in the leftmost column.

Figure 6: S-shape effect for sampling 1 at \(\eta=1.7\). Fitting as for sampling 2 is now considerably more difficult due to the larger relative spread of the points. The fit is less crucial than for sampling 2, however, because the absolute spread is smaller as a result of the finer granularity.

### Bary center determination

It was mentioned above that the hits in each of the first two samplings are obtained by estimating the barycenters of the energy deposition in the samplings. The barycenter estimates rely on the "shower profile" (the mean energy loss per radiation length along the particle trajectory) given in Eq. 23.25 of the Review of Particle Properties [3]:

\[f(t)=\frac{b}{,\,(a)\,}(bt)^{a\,-\,1}e^{-bt}, \tag{1}\]

where \(t\) is the distance in radiation lengths along the track of the initial particle and \(f\) is the fraction of the initial energy that is deposited per radiation length and is normalized to unit area. The energy dependence of the parameters \(a\) and \(b\) was obtained from a fast Monte Carlo developed for the ZEUS calorimeter [4]. This calorimeter has a different geometry and material composition than the ATLAS electromagnetic calorimeter, but we expect that the profile in terms of radiation lengths carries over to our experiment.

In the case of electromagnetic cascades initiated by electrons, the parameter dependence

Figure 7: Energy loss per radiation length along the electron track. The curve is normalized to unit area. The distance along the track is in radiation lengths. As the energy of the incident particle increases, the cascade becomes wider and its peak decreases and is displaced towards longer distances. The curve with the highest peak is for an energy of 10 GeV, while successive curves correspond to an incident energy difference of 100 GeV.

on the energy (expressed in GeV) is given by

\[\ln a = 0.1\,430\ln E+1.160 \tag{2}\] \[\ln b = 0.0\,201\ln E-0.9388 \tag{3}\]

and the resulting profiles are shown if Fig. 7. To make a correspondence with photons, 7/9 of a radiation length must be subtracted from the calculated distances to account for the delay in the start of the cascade (conversion length).

The barycenter positions are calculated by means of the following algorithm.

1. The particle direction is approximated as given by \(\eta_{S1}\) or \(\eta_{S2}\), according to the sampling.
2. The particle energy deposited in a \((\eta,\phi)\)-window with dimensions 3x7 is computed. Using a window of a slightly different size (for example, 5x5) has no appreciable effect for our purposes.
3. The barycenter position in each sampling, measured along the particle track, is calculated by integrating the profile corresponding to this energy between the known limits (in radiation lengths) of each of the first two calorimeter samplings. These limits, which are known as a function of pseudorapidity [5], are taken at the pseudorapidity value previously estimated for the track. The electron profiles of eqs. 2 and 3 are used and the electron cascade barycenters are shifted by 7/9 of a radiation length to give the positions of the photon barycenters, as explained above.
4. The calculated barycenter positions are converted from radiation lengths to centimeters through multiplication by a conversion factor, which may be considered an effective radiation length. This factor can be estimated from the sampling thicknesses, which (as a function of pseudorapidity) are known both in centimeters [6] and in radiation lengths [5]. Two estimates have been obtained, one from each sampling, taking the depths of samplings 1 and 2 equal to 6 and 18, respectively. The estimates are shown as a function of pseudorapidity in Fig. 8. We see that the effective radiation length decreases with pseudorapidity. This is expected, because the liquid argon gap decreases with \(\eta\), so a larger fraction of the particle trajectory lies in lead, the material with the shorter radiation length. At small and large pseudorapidity values the two curves are in reasonable agreement but disagree in a region around \(\eta=1.9\), where the one computed from the first sampling has an abrupt step. Because of the smaller thickness of the first sampling, taking its thickness in radiation lengths as a constant leads to a larger relative error than is sampling 2. For this reason we consider the effective radiation length from sampling 2 to be more accurate and use it throughout the analysis.
5. Finally, the z-coordinate of each barycenter is calculated, using once again the approximate pseudorapidity of the particle (\(\eta_{S1}\) or \(\eta_{\,S2}\)).

The energy dependence of the z-coordinate of the shower barycenters in samplings 1 and 2 has been calculated for tracks with several pseudorapidity values using the effective radiation length calculated from sampling 2. The results are shown in Fig. 9.

The barycenter z-coordinate depends on the total energy of the particle in an approximately logarithmic fashion, as expected. Furthermore, if the energy is kept constant, the depth generally decreases with pseudorapidity. This is due to the decrease with pseudorapidity of the effective radiation length. By contrast, the increase in the z-coordinate of the barycenters due to the increase in the length of projections along the z-axis as \(\eta\) increases has a much smaller effect.

It may be seen from Fig 8, however, that the computed effective radiation length is not exactly monotonic and shows a sudden jump at \(\eta=1.9\) (especially for the curve calculated from sampling 1, which is not used any further). This is an artifact of the calculation as explained in the figure caption and causes a systematic error in the computation of the barycenters, manifested in the plots of Fig. 9 as a disruption in the ordering of the curves: at a given energy, the barycenter normally decreases with pseudorapidity, but this trend does not hold for \(\eta\) around 1.9.

Another source of error in the barycenter determination is the fluctuations in the profile of the individual showers. Since the profiles described by (1) give the mean energy deposition in a cascade, the barycenter of any individual shower may differ from that calculated by the above method. In order to study this effect we simulated the longitudinal profile of showers with an energy of 70 GeV using the fast Monte Carlo [4] and calculated the barycenter distributions in the first two samplings (see Fig. 10). These distributions are approximately Gaussian and have a standard deviation equal to 0.2 radiation lengths in sampling 1 and 0.8 radiation lengths in sampling 2. Considering the effective radiation length of Fig. 8 and projecting the track onto the z-axis, one concludes that the standard deviation of the barycenter z-coordinate due to shower fluctuations does not exceed about 0.4 cm in sampling 1 and 1.5 cm in sampling 2.

Figure 9: Energy dependence of the z coordinate of the shower barycenters in samplings 1 (left) and 2 (right).

Figure 10: Distribution of shower barycenters in samplings 1 and 2, measured in radiation lengths in the direction of the incident photon. The curves are Gaussian fits to the histograms. The total photon energy is 70 GeV.

### Track reconstruction

Once the cascade barycenters have been determined in the first two samplings, they are used to reconstruct the path of the original particle.

#### 2.3.1 Straight line through two points

There are several schemes one could use to reconstruct tracks in the end cap of the electromagnetic calorimeter. As mentioned above, the simplest reconstruction method consists in joining the two points by a straight line. This method clearly does not exploit all the available information in a H \(\rightarrow\gamma\gamma\) event, as it uses only one track. It also ignores constraints on the track, such as the location of the primary vertex, which is known _a priori_ to an accuracy of a few centimeters.

The effect on reconstruction of the corrections described above is studied by comparing the resolution in the reconstruction of the pseudorapidity and the primary vertex z-coordinate with and without the corrections. The simple two-point track reconstruction method is used, which is the one implemented in the current software.

For the sample with generated pseudorapidity around 1.7, the difference between the reconstructed and the "generated" pseudorapidity is shown in Fig. 11 and is compared to the plot obtained by the previous reconstruction method. A similar comparison for the vertex resolution is made in Fig. 12. The improvement in the pseudorapidity resolution is about 30% and is typical of the entire pseudorapidity range, as shown in Table 3. From the table one sees that the resolution in both the vertex position and the pseudorapidity deteriorates as the transverse energy is lowered to 25 GeV, as expected.

The z-resolution is at best slightly better than 4 cm. This rather poor value, comparable to the spread of the collision points (5.6 cm), is due to the extrapolation from the two barycenters, which lie a few tens of centimeters apart, to a distance nearly four meters away. This drawback will be removed once information from the other detectors is included, for example, the inner detector, which permits tracking with high resolution. An alternative is to exploit the available information about the z-intercept of the track from the barrel of the electromagnetic calorimeter.

#### 2.3.2 Track reconstruction by means of a three-point fit

The barrel offers the advantage of a more precise determination of the primary vertex than the end cap because of the smaller extrapolation distance involved. In events where two photons are created at the same primary vertex and are detected one by the barrel and the other by the end cap, one may include in the part of the reconstruction that involves the end cap an estimate of the vertex position that takes advantage of the barrel. For example, a weighted average of the z-intercepts obtained from the barrel and the end cap could be used as the vertex estimate.

To illustrate the possible improvement, Section 3 presents resolution results assuming a fixed \(\sigma_{z}\) cm that is attainable in the detection of tracks by the barrel. More complicatedFigure 11: Pseudorapidity resolution for \(\eta=1.7\) with the new (solid line) and the old (dashed line) reconstruction method. Each curve is a Gaussian fit to the corresponding histogram.

Figure 12: Vertex resolution for \(\eta=1.7\) with the new (solid line) and the old (dashed line) reconstruction method. Each curve is a Gaussian fit to the corresponding histogram.

methods of doing the fit are also possible in two-track events, for example, a simultaneous fit of all hits under the constraint that tracks have the same z-intercept.

### Required \(\eta\) resolution

We now turn to the question of the pseudorapidity resolution that the end cap must achieve in order to make possible the detection of the Higgs boson in the decay mode \(\mathrm{H}\rightarrow\gamma\gamma\). We first express the mass resolution in terms of the resolution in the measurement of the photon energies and pseudorapidities.

The Higgs mass is measured as the invariant mass of the two-photon system that arises in the decay \(\mathrm{H}\rightarrow\gamma\gamma\):

\[M^{2}=2E_{1}E_{2}(1-\cos\alpha),\]

where \(M\) is the invariant mass, \(E_{1}\) and \(E_{2}\) are the energies of the two photons and \(\alpha\) is the opening angle between them. From this formula one can calculate the fractional error in the measurement of \(M^{2}\) in terms of the errors in the energies and the opening angle. The result is (assuming the errors in different quantities are uncorrelated)

\[\left(\frac{\sigma_{M^{2}}}{M^{2}}\right)^{2}=\left(\frac{\sigma_{E_{1}}}{E_{ 1}}\right)^{2}+\left(\frac{\sigma_{E_{2}}}{E_{2}}\right)^{2}+\left(\frac{ \sigma_{\cos\alpha}}{1-\cos\alpha}\right)^{2} \tag{4}\]

The fractional error in the mass can now be calculated using

\[\sigma_{M}/M=\sigma_{M^{2}}/2M^{2} \tag{5}\]

The size of the energy terms in (4) follows from the expected fractional energy resolution of the calorimeter, which is given by

\[\left(\frac{\sigma_{E}}{E}\right)^{2}=\frac{0.10^{2}}{E(\mathrm{GeV})}+0.01^{2}\]

\begin{table}
\begin{tabular}{|c|r|r|r|r|r|r|} \hline \(\eta\) & \(E_{t}\) (GeV) & \(z_{1}(cm)\) & \(z_{2}(cm)\) & new \(\sigma_{\eta}\) & old \(\sigma_{\eta}\) & new \(\sigma_{z}\) & old \(\sigma_{z}\) \\ \hline
1.7 & 25 & 375.89 & 392.65 & 0.014 & 0.022 & 5.7 \(\pm\) 0.1 & 8.8 \(\pm\) 0.2 \\
1.8 & 50 & 375.87 & 393.43 & 0.009 & 0.017 & 3.8 \(\pm\) 0.2 & 6.3 \(\pm\) 0.6 \\
1.8 & 80 & 375.98 & 394.52 & 0.009 & 0.015 & 3.6 \(\pm\) 0.1 & 6.1 \(\pm\) 0.2 \\
1.9 & 50 & 375.89 & 393.67 & 0.010 & 0.015 & 4.0 \(\pm\) 0.1 & 5.9 \(\pm\) 0.2 \\
2.0 & 50 & 375.99 & 394.21 & 0.011 & 0.020 & 4.3 \(\pm\) 0.3 & 8.1 \(\pm\) 0.8 \\
2.2 & 80 & 375.28 & 391.99 & 0.010 & 0.015 & 4.0 \(\pm\) 0.2 & 6.0 \(\pm\) 0.3 \\
2.3 & 25 & 375.02 & 389.70 & 0.015 & & 6.0 \(\pm\) 0.1 & 8.4 \(\pm\) 0.2 \\
2.3 & 50 & 375.15 & 391.04 & 0.011 & 0.017 & 4.3 \(\pm\) 0.2 & 6.5 \(\pm\) 0.5 \\ \hline \end{tabular}
\end{table}
Table 3: Pseudorapidity and vertex resolution at various transverse energies and pseudorapidities calculated with the new and the old methods. The z-coordinates of the shower barycenters in the two samplings are also shown. The error in \(\sigma_{\eta}\) is never larger than 0.001. The quoted resolutions correspond to the standard deviation of a Gaussian fit. The RMS of the corresponding histogram is larger in some cases. All distances are measured in centimeters from the center of the detector.

As a rather conservative estimate for the photon energy we take 100 GeV. Taking the energies of the two photons to be equal, the sum of the first two terms in (4) is then \(4\times 10^{-4}\), a value which will be used in all subsequent calculations. It follows from (5) that the contribution of these terms to the fractional mass resolution is 1 %. As mentioned in the Introduction, this is the mass resolution required of the calorimeter. The addition of the angular term in (4) degrades the resolution beyond this point.

This angular term can be calculated in terms of the pseudorapidities and the azimuthal angles of the two photons. We must first express the uncertainty in the determination of the opening angle in terms of the resolutions in the \(\eta\) and \(\phi\) measurements. However, since \(\sigma_{\phi}\) for photons with energy around 100 GeV is of the order of \(10^{-4}\)[8], only the uncertainty in \(\eta\) is appreciable. Introducing the pseudorapidities of the two photons, \(\eta_{1}\) and \(\eta_{2}\), we have

\[\sigma_{\cos\alpha}^{2}=\left(\frac{\partial\sigma_{\cos\alpha}}{\partial \eta_{1}}\right)^{2}\sigma_{\eta_{1}}^{2}+\left(\frac{\partial\sigma_{\cos \alpha}}{\partial\eta_{2}}\right)^{2}\sigma_{\eta_{2}}^{2} \tag{6}\]

Using the well-known formula for the unit vector in the direction determined by \(\theta\) and \(\phi\),

\[\hat{u}=\sin\theta(\cos\phi\hat{x}+\sin\phi\hat{y})+\cos\theta\hat{z},\]

where \(\hat{x}\), \(\hat{y}\) and \(\hat{z}\) are the unit vectors along the Cartesian axes, we get

\[\cos\alpha=\hat{u}_{\,1}.\hat{u}_{\,2}=\sin\theta_{1}\sin\theta_{2}\cos(\phi_ {1}-\phi_{2})+\cos\theta_{1}\cos\theta_{2}.\]

After expressing the sine and cosine of the angles in terms of the pseudorapidities by means of the relations \(\sin\theta=1/\cosh\eta\) and \(\cos\theta=\tanh\theta\) we obtain

\[\cos\alpha=\frac{\cos(\phi_{1}-\phi_{2})+\sinh\eta_{1}\sinh\eta_{2}}{\cosh\eta _{1}\cosh\eta_{2}} \tag{7}\]

and

\[1-\cos\alpha=\frac{\cos(\eta_{1}-\eta_{2})-\cos(\phi_{1}-\phi_{2})}{\cosh\eta _{1}\cosh\eta_{2}} \tag{8}\]

Differentiating (7) with respect to \(\eta_{1}\) gives

\[\frac{\partial\sigma_{\cos\alpha}}{\partial\eta_{1}}=\frac{-\sinh\eta_{1}\cos (\phi_{1}-\phi_{2})+\sinh\eta_{2}}{\cosh^{2}\eta_{1}\cosh\eta_{2}},\]

and squaring gives

\[\left(\frac{\partial\sigma_{\cos\alpha}}{\partial\eta_{1}}\right)^{2}\leq \left(\frac{\sinh|\eta_{1}|+\sinh|\eta_{2}|}{\cosh^{2}\eta_{1}\cosh\eta_{2}} \right)^{2} \tag{9}\]

A similar inequality holds for the derivative of the cosine with respect to \(\eta_{2}\). It follows from (6), (9) and (8) that

\[\left(\frac{\sigma_{\cos\alpha}}{1-\cos\alpha}\right)^{2}\leq\left(\frac{ \sinh|\eta_{1}|+\sinh|\eta_{2}|}{\cosh(\eta_{1}-\eta_{2})-cos(\phi_{1}-\phi_{ 2})}\right)^{2}\left(\frac{\sigma^{2}\eta_{1}}{\cosh^{2}\eta_{1}}+\frac{ \sigma^{2}\eta_{2}}{\cosh^{2}\eta_{2}}\right)\]

To estimate the right-hand side in the last equation, we first note that \(\cos(\phi_{1}-\phi_{2})\) will be negative and close to -1, since the produced Higgs have a small transverse momentum.

The quantity resulting by omitting \(\cos(\phi_{1}-\phi_{2})\) will therefore be larger than the original. Secondly, we approximate both1\(\sigma_{\eta_{1}}^{2}\) and \(\sigma_{\eta_{2}}^{2}\) by \(\sigma_{\eta}^{2}\). The resulting inequality is

Footnote 1: In principle, these two quantities could be different in different regions of the calorimeter. For instance, the resolution could be better in the barrel than in the end cap. Such differences would however be offset, at least in part, by the hyperbolic cosine in the denominator, which varies by a factor of 4 between 0.5 and 1.5.

\[\left(\frac{\sigma_{\cos\alpha}}{1-\cos\alpha}\right)^{2}\leq\left(\frac{\sinh| \eta_{1}|+\sinh|\eta_{2}|}{\cosh(\eta_{1}-\eta_{2})}\right)^{2}\left(\frac{1}{ \cosh^{2}\eta_{1}}+\frac{1}{\cosh^{2}\eta_{2}}\right)\sigma_{\eta}^{2} \tag{10}\]

Using (10), one may calculate, for given combinations of \(\eta_{1}\) and \(\eta_{2}\), the value of \(\sigma_{\eta}\) that makes the angular term in (4) equal to the sum of the energy terms in the same equation. We may assume for the sake of clarity that \(0<\eta_{1}<\eta_{2}\). Then, for each \(\eta_{2}\)-value, we choose a number of \(\eta_{1}\)-values and compute the corresponding \(\sigma_{\eta}\). To simplify the presentation, we then average the results separately for each of the following \(\eta_{1}\)-regions: (a) from 0 to 0.5, (b) from 0.5 to 1.0, (c) from 1.0 to 1.5 and (d) from 1.5 to 2.5 (where the outer wheel of the end cap ends). In this way we obtain, for each of the these \(\eta_{1}\)-regions, the required resolution (\(\sigma_{\eta}\)) as a function of \(\eta_{2}\).

In the following section, the results of such a calculation are shown and compared to the \(\sigma_{\eta}\) achieved for two- and three-point tracks going through the end cap.

## 3 Results and conclusions

The pseudorapidity resolution that is required in order to make the contribution of the angular uncertainty to the Higgs mass error equal to the contribution of the energy uncertainty was calculated as explained in the previous section. Four separate curves were obtained (with \(\eta_{2}\) as abscissa) according to the \(\eta_{1}\)-values and are shown as continuous lines in Fig. 13. Given \(\eta_{2}\), the required resolution becomes finer as \(\eta_{1}\) increases, because the opening angle between the photons decreases.

The pseudorapidity resolution for the detection of single photon tracks by the end cap is compared to the required resolution in the same plot. The resolution of the calorimeter has been calculated for various photon transverse energies using the two methods of Section 2.3: a) the two-point method and b) the three-point method, assuming that the primary vertex z-coordinate was measured independently of the end cap with a resolution of 2 cm, which can easily be achieved by the barrel [7]. The resolution given in the TDR [7] is also shown for comparison.

In all cases, the new results lie below those in the TDR, for which the criterion on the size of the angular term is not satisfied for the end cap even when the other photon has \(\eta_{1}<0.5\). Provided that \(\eta_{1}\) is in this interval, this criterion is satisfied for the new method, with the exception of two pseudorapidity values at the lowest transverse energy when the two-point method is used. For the two-point method, the criterion is not met when both photons pass through the end cap.

Assuming that one photon arrives at the barrel, the three-point method always provides the desired accuracy. The same conclusion holds when both photons pass through the Figure 13: The continuous curves give, for various combinations of \(\eta_{1}\) and \(\eta_{2}\) (see the previous section), the pseudorapidity resolution that is required in order for the angular and energy contributions to the mass error to be equal. The \(\eta_{1}\) range for each curve is the following: (a) from 0 to 0.5, (b) from 0.5 to 1.0, (c) from 1.0 to 1.5 and (d) from 1.5 to 2.5 (under the restriction that \(\eta_{1}<\eta_{2}\). The required resolution can be compared with that obtained for various photon transverse energies when the two-point or the three-point track reconstruction methods are used. In the latter case, the primary vertex is assumed known with a standard deviation of 2 cm. The TDR results for the resolution in the pseudorapidity measurement are also shown. Note that open symbols are used for the TDR resolution, while filled black symbols with the same shape are shown for the two-point method.

end cap assuming the assumed accuracy in the z-coordinate of the vertex is obtained by other means, for example by using the inner detector.

## References

* [1] ATLAS Collaboration, _Technical Proposal for a General-Purpose pp Experiment at the Large Hadron Collider at CERN_, CERN/LHCC/94-43, LHCC/P2.
* [2] Jerome Schwindling, _The reconstruction code for the electromagnetic calorimeter in ATRECON, Version 97\(3\), available on the world-wide web. See [http://atlasinfo.cern.ch/Atlas/GROUPS/PHYSICS/EGAMMA/egamma.html](http://atlasinfo.cern.ch/Atlas/GROUPS/PHYSICS/EGAMMA/egamma.html) See also the ATRECON subdirectories on the ATLAS Work Group Server.
* [3] C. Caso _et al_, _Europ. Phys. Jour._ C3 (1998) 1.
* [4] J. del Peso and E. Ros, _Nucl. Instr. and Meth._ A306 (1991) 485.
* [5] F. Djama, L. Hervas and C.P. Marin, ATLAS Internal Note, LARG-No-088.
* [6] The actual sampling limits in centimeters have been included in routine ENDC-STEP of the DICE detector simulation package. Monika Wielers, private communication.
* [7] ATLAS Collaboration, _ATLAS Calorimeter Performance Technical Design Report_, CERN/LHCC 96-40.
* [8] Gaston Garcia Lopez, ATLAS Internal Note, LARG-No-098.