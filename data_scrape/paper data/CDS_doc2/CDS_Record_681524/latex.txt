**Momentum measurement for on-line event selection in the ATLAS muon spectrometer**

P.Branchini, F.Petrucci

Dipartimento di Fisica "E. Amaldi" - Universita degli studi Roma Tre

INFN Sezione di Roma Tre

D. Rebuzzi, A.Rimoldi

Dipartimento di Fisica - Universita degli studi di Pavia

INFN Sezione di Pavia

**Abstract**

A fast method for the measurement of muon momenta in the ATLAS spectrometer is described. The method, inserted in the Calib framework, has been developed for the barrel region, makes use of MDT data and has been proved to be accurate (few %) and fast enough (few ms) to be used at an on-line level. The performance have been evaluated on a set of MonteCarlo data generated with the Geant4 description of the spectrometer.

Introduction

Muon momentum resolution is crucial for the ATLAS experiment at trigger and analysis level. The method proposed here for momentum measurement is intended to be accurate and fast enough to be used as an on-line event selection. It has been designed within the Calib framework (a package developed for the analysis of MDT data) which has proved to be a reliable analysis tool both in test sites and in the H8 test beam [1],[2]. The structure of the Calib package is described in [3].

In the current software, the description of the muon system geometry and of the magnetic field are provided by ASCII databases for both simulation and reconstruction wich therefore completely agree on the detector description.

In what follows a method for the measurement of muon momenta using the information of the ATLAS spectrometer is described in detail and some results on the performances are outlined.

## 2 Simulated data

Physics events are generated using Geant4 (version 4.4.0) within the FADS framework which allows dynamic loading of the different ATLAS subdetectors, each one being conceived as an independent implementation.

The simulation environment provides a detailed description of the Muon Spectrometer [5]. The geometrical information needed for setting up the simulation is read from an external database and handled by a set of classes that redirect information about detector positions, sizes and internal structure. The detector/material setup is here fixed by the muon chamber layout M2.8 described in the \(amdb\_simrec.m2.D\) database [4]. A script reading the ATLAS fieldmap invokes the Magnetic Field to allow particle deflection. All the physics processes for muons interacting with the detector, such as \(\delta\)-ray production, multiple scattering and \(dE/dx\) energy loss, are switched on.

Muons interact with materials along their path causing ionization of the detector gas (the sensitive volume) in the simulated MDT chambers. In the present digitization code, when a track enters the MDT gas volume, a straight line in the direction of the particle three-momentum is created. The distance \(r\) of this line from the wire, the impact parameter, is transformed into a drift time according to a realistic \(r-t\) relation. The digitization procedure for the moment only takes into account a gaussian smearing of the drift radius according to the proper tube resolution function. The signal propagation along the wire and the effect of the Lorentz angle are not taken into account.

During the tracking, each hit is recorded together with the corresponding impact parameter, drift time and position in the global/local coordinate reference system. The detector element in which the hit occurs is characterized by chamber type, volume type, etc. At the end of the event the program dumps a list of muon hit and digit information together with the corresponding detector element identifier, the drift time and the impact parameter into an ASCII output file using the MUONBOX standard format. The ASCII file is read by Calib and the reconstructed quantities are then used for the analysis.

Large samples (10 Kevt each) of single muons with the same charge have been simulated at different momenta (10 GeV, 25 GeV, 50 GeV, 100 GeV, 200 GeV, 300 GeV, 500 Gev and 1 TeV) with tracks covering one large and one small sector of the barrel (-0.2\(<\phi<\)0.55 and -1\(<\eta<\)1).

Figure 1 shows a three-dimensional view of the ATLAS detector simulated by Geant4. Some muon chambers are removed to show the inner structure of the detector and the generated muon tracks.

## 3 Tracking in magnetic field

The trajectory in the the ATLAS toroidal magnetic field is approximated with a circle. In order to get the momentum of the muon, given this initial assumption, the formula:

\[p=0.3B_{l}R_{c} \tag{1}\]

is used, where p(GeV) is the momentum of the muon in the z-R plane, \(R_{c}\)(m) is the computed radius of curvature and \(B_{l}\)(T) is the mean value of the magnetic field along the track path \(l\) between the first and the last measured points in the spectrometer. The procedure to determine the radius of curvature is described in the next two section, while a description of the properties of the ATLAS magnetic field is given in section 3.3. As the toroidal magnetic field is generated from a finite number of wires, it varies with respect to \(\phi\) (polar angle in the plane perpendicular to the beam axis). In that plane, where MDT chambers give no position information, the position is obtained

Figure 1: Generated muon tracks in a three dimensional view of the muon spectrometer.

directly from the hits given by the MonteCarlo because the read-out of the RPC trigger chambers (that provides a measurement also in the \(\phi\)-R plane) is still not complete in the Calib framework.

### Track points determination

The hits belonging to the two multilayers of the same MDT chambers are the starting point to determine the informations to be used in the track fit.

Figure 3: Tube resolution function used in the simulation program.

Figure 2: Description of the track element calculation.

The four possible tangents to the first and last drift circles are computed. Among these straight lines, the one having the smallest \(\chi^{2}\) with respect to the other drift circles is choosen as the \(reference\)\(line\) (see figure 2(a)). Then, for any pair of adjacent tubes other four tangents are computed and the tangent points closest to the reference line are used as track points (_pseudo measurements_, figure 2(b)). To each _pseudo measurement_ is assigned an error defined by the tube resolution function. The choosen resolution function, which has been computed with real data, is shown in figure 3.

### Radius of curvature determination

The information used are the _pseudo measurements_. They are fitted with a circle using the fast minimization procedure described in the following. The radius of curvature \(R_{c}\) is the outcome of the fit. The calculation simplifies if a \(\chi^{2}\) function is minimized with respect to \(R_{c}^{2}\) instead of \(R_{c}\). This is correct because \(R_{c}\) is defined positive. The \(\chi^{2}\) function is

\[\chi^{2}=\sum_{i}\frac{[f\left(x_{c},y_{c}\right)]^{2}-R_{i}^{2}}{\sigma_{i}^{2}} \tag{2}\]

where i runs over all the _pseudo measurements_ and

\[f\left(x_{c},y_{c}\right)=(x-x_{c})^{2}+(y-y_{c})^{2} \tag{3}\]

where \(x_{c}\), \(y_{c}\) are the coordinates of the centre of the circle in the bending plane.

The first _pseudo measurement_\((x_{1},\,y_{1})\) (at the entrance of the muon spectrometer) is forced to belong to the track

\[(x_{1}-x_{c})^{2}+(y_{1}-y_{c})^{2}-R_{c}^{2}=0 \tag{4}\]

Figure 4: Distribution of the radius of curvature for 25 GeV muons.

and is used as origin for the other _pseudo measurements_

\[X_{i}=x_{i}-x_{1};Y_{i}=y_{i}-y_{1} \tag{5}\]

Using equations 4, 5 and approximating \(R_{i}^{2}\sim R_{c}^{2}\), the function \([f(x_{e},y_{e})]^{2}-R_{i}^{2}\) becomes

\[X_{i}^{2}+Y_{i}^{2}+2X_{i}(x_{1}-x_{e})+2Y_{i}(y_{1}-y_{e})=0 \tag{6}\]

This enables to find the point \((x_{e},\,y_{e})\) which minimizes the \(\chi^{2}\) analitically. Also the Hessian is computable exactly. \(R_{c}^{2}\) is then obtained from eq. 4.

The distribution of the curvature radius reconstructed with the method described above, is shown with respect to \(\eta\) and \(\phi\) in figure 4 and 5 for 25 GeV and 50 GeV muons respectively. The curvature radius is slowly varying in large sectors and takes its highest value in the middle of the chamber (where the field is lower); in small sectors the distribution varies rapidly and assumes its lowest value in the middle of the chamber (on the magnet coil).

### Magnetic field informations

The value of the quantity \(B_{l}\) quoted in equation 1 is given by :

\[B_{l}=\frac{\int_{l}Bdl}{\int_{l}dl} \tag{7}\]

where \(l\) is the particle track between the first and the last points in the spectrometer. The field integral in 7 is evaluated numerically using the field in each point of the track path. In the integration 7, only the \(B_{\phi}\) component of the field (orthogonal to the z-R

Figure 5: Distribution of the radius of curvature for 50 GeV muons.

plane) is taken into account. The distribution of the track lenght \(\int_{l}dl\) is shown in figure 6 for 25 GeV muons; the lenght difference for the opposite \(\eta\) sides of the spectrometer is due to the different curvature of same charge particles in the two regions (the same difference occurs for particles of different charge in the same \(\eta\) side).

The field integral \(\int_{l}Bdl\) is given in figure 7 for 25 GeV muons with respect to \(\eta\) and \(\phi\). The bending power is higher at high \(\eta\) and close to the magnet coil (\(\phi\sim 0.4\)). Only

Figure 6: Track lenght distribution for 25 GeV muons.

Figure 7: Field integral distribution for 25 GeV muons.

the distributions for 25 GeV muons are shown since track lenghts and field integrals are slowly varying with the momentum.

## 4 Performances

### Momentum determination and resolution

In figure 8 reconstructed momenta distribution is shown as a function of \(\eta\) and \(\phi\) for 25 GeV muons. The distribution is not flat in \(\phi\) due to the fact that the assumption of circular trajectories is not accurate enough in the region of the coils where the field changes rapidly. This is true for all momenta. This discrepancy can be regarded as a correction to be applied in small sectors; the value of this correction can be parametrized for all momenta with a 3 parameter function.

Also the scale factor of the measurements has to be taken into account; if the value of the momentum at the entrance of the spectrometer has to be returned it has to be increased by 12% in large sectors and by 20% in small sectors. These corrections are based on the montecarlo simulation but in principle it should be possible to determine the value of the few (5) parameters involved using real data (for example muons from Z decay).

The resolution in momentum measurement is shown in figure 9 with respect to generated momenta for four different cases (large and small sectors, \(\eta>\)0. and \(\eta<\)0.). The resolution in large sectors is 3.5% at low momenta and goes up to 12% at 1 TeV. In small sectors the resolution is 3.7% at 10 GeV, goes down at 2.8% at 50 GeV and than goes up again to 7% at 1 TeV. The better resolution at high momenta in small sector is due to the fact that the field is stronger and the track lenght is longer.

Figure 8: Distribution of measured momenta for 25 GeV muons.

In figure 10 the value of the difference \((p_{gen}-p_{rec})/p_{gen}\) is shown with respect to the generated momentum. Reconstructed momentum is underestimated mainly in large sector and for momenta value higher than 300 GeV.

Figure 9: Distribution of the resolution w.r.t generated momentum.

### Systematics

In order to understand the systematics of the method, the effects of changing the tube resolution function and the r-t relation have been studied.

The resolution in momentum measurement is shown in 4 different cases in figure 11. One is the resolution quoted in section 4.1 (reported here for an easy comparison), one is the resolution if we do not take into account the the tube resolution function (no error on tube measurements) and the last two cases are obtained considering a constant tube resolution function of 60 \(\mu\)m and 80 \(\mu\)m respectively. In the second case the resolution decreases very slowly with the momentum (multiple scattering effects) and goes from

Figure 10: Distribution of the difference between generated and reconstructed momentum w.r.t generated momentum.

3.6% to 3.3% in the large sectors and from 3.6% to 2.6% in the small sectors. In the cases of constant tube resolution, this contribution becomes important at 200 GeV and the resolution on the measured momentum goes up to \(\sim\)8.5% ( \(\sim\)10.5%) at 1 TeV for 60 \(\mu\)m (80 \(\mu\)m) in the large chambers and to \(\sim\)5% (\(\sim\)6%) at 1 TeV for 60 \(\mu\)m (80 \(\mu\)m) in the small chambers.

The reconstruction of tracks using an r-t relation different from the one used in the simulation has also been attempted. A real situation in which the r-t relation can be different for different tube samples has been reproduced. In particular a case in which the drift time spectrum increases of a quantity \(\Delta\)t for each tube of a triplet

Figure 11: Momentum resolution distribution w.r.t generated momentum for different values of tube resolution function.

in the same layer has been implemented. This effect has been reproduced changing properly the r-t relation in data simulation (assuming a linear correction) and events have been reconstructed using the same r-t relation for each tube (this is the case when we calibrate the chambers using all the tubes togheter). In figures 12 and 13, the resolution and the difference between generated and reconstructed momenta are shown in two different cases (\(\Delta\)t=10 or 20 ns). This effects worsen the resolution and the momentum estimate only for momenta larger than 100 GeV.

Figure 12: Distribution of the resolution w.r.t generated momentum.

### Processing time

A study of the execution time of the algorithm as been performed on a 600 MHz pentium III processor.

For each track, less than 10 ms are needed to obtain momentum measurement. The code is not optimized and 2.5 ms per track that are now spent in the search for hits in the whole detector can be easily gained.

Figure 13: Distribution of the difference between generated and reconstructed momentum w.r.t generated momentum.

The pattern recognition and the reconstruction of the track in each chamber takes about 2.5 ms while the execution of the algorithm for momentum computation lasts 2.2 ms. In particular the field integral takes 1.7 ms while radius of curvature computation lasts 150 \(\mu\)s.

## 5 Conclusions

A new fast and robust method for muon momentum measurement in the ATLAS spectrometer has been developed in the Calib framework and described here.

The main results claim a mean resolution in the whole barrel \(\eta\)-\(\phi\) range ranging from \(\sim\)3.5% at 25 GeV up to \(\sim\)10% at 1 TeV. There is no bias in momentum measurement up to momenta as high as 200 GeV. The processing time for this algorithm is of the order few ms per track and these performances should be adequate for an on-line event selection.

## References

* [1] G.Avolio et al.; **First results of the 2001 MDT chamber beam test** ATL-COM-MUON-2002-001
* [2] L.La Rotonda, E.Meoni, A.Baroncelli, M.Iodice, F.Petrucci; **Bil chamber autocalibration results with 2001 H8 test beam data.** Note in preparation.
* User Manual** ATL-COM-MUON-2002-004.
* [4] Saclay Muon Group; **Atlas Muon DataBase** http//atlas.web.cern.ch/Atlas/GROUPS/MUON/AMDB_SIMREC/amdb_simrec.html
* [5] A. Rimoldi, J. F. Laporte, A. Dell'Acqua, M. Virchaux and L.Chevalier; **The ATLAS Muon Spectrometer Simulation Using Geant4** ATL-MUON-2000-020.