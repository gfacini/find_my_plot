# Uniformity of the 2000 test beam module with the new optimal filtering coefficients

L. Di Ciaccio, L. Neukermans, P. Perrodo, R. Zitoun

_LAPP (Annecy)_

###### Abstract

An original method to reconstruct electron and pion signals in the Liquid ARGon barrel calorimeter (LARG) is applied to test beam data collected at the H8 line of the CERN North Area in July and August 2000. The method is based on the use of optimal filtering coefficients and takes into account the electrical description of the read-out electronics in the reconstruction of the physics pulses [1]. Results on improvements in the LARG response and in particular on the energy uniformity of the calorimeter are shown.

## 1 Introduction

In July and August 2000, data were collected at the test facility H8 at the CERN North Area with a prototype module of the ElectroMagnetic Barrel (EMB) calorimeter. Several parameters characterizing the behaviour of the detector were measured. The analysis of the data showed an apparent non uniformity in the energy response along the \(\eta\) direction bigger than the one required to reach the desired calorimeter performances [2, 3]. Several efforts were made to understand this effect. Among these efforts, the study of the best way of reconstructing the physics signals of the individual calorimeter cells has brought to define a method which, once applied, has restored in a significant way the uniformity. The method is explained in detail in a separate note [1]. In the present paper, results obtained applying this procedure to test beam data are presented. After the description in section 2 of the event sample used, distributions of the reconstructed electron energy versus the \(\eta\) coordinate obtained with different methods of signal shape reconstruction are compared in section 3. In section 4 and 5 results on energy resolution and noise reduction obtained with the proposed method are shown.

## 2 Event Sample and Selection

A module (Module 0) of the EM barrel calorimeter was exposed to a beam of electrons with energy ranging between \(\approx\) 20 GeV and \(\approx\) 250 GeV and to a beam of photons with energy between a few GeV and \(\approx\) 60 GeV. The results shown in this note were obtained using electron beam data.

Technical runs were also recorded in order to measure pedestals and to perform time and amplitude calibrations. These calibrations compensate in principle differences in the electronics and cell geometry.

The geometry and electronics of the studied module is final, but only part of the detector was equipped with final electrodes. The electrodes of the LARG barrel calorimeter consist in two separated parts: electrode A covers the region \(0.<\eta<0.8\) (where the lead thickness is 1.1 mm) and electrode B the region \(0.8<\eta<1.475\) (where the lead thickness is 1.3 mm). The coordinate \(\eta=0.8\) corresponds to the end of the middle cell \(\eta_{\rm numb}\)= 31.

The cryostat containing the module is laid down on a moving table. The translation and rotation of the table allow the study of the energy response of the detector as a function of the angular coordinates \(\eta\) and \(\phi\), keeping the projectivity of the calorimeter with respect to the incident beam.

More than 10 000 events were collected per run. Each run corresponded to different particle energies and to the beam impinging to the center of one of the \(\eta\) and \(\phi\) cells of the calorimeter middle layer. In particular 'uniformity scans' were recorded at 20 and 250 GeV.

A set of scintillator counters and of multiwire proportional gas chambers (MWPC) was used to monitor the beam, to trigger [4] and to reject particles at the minimum of ionization and particles interacting before the calorimeter, as explained later in this section.

The raw data from the test beam detectors were read and analysed with the EMTB package [5]. The program performs the energy reconstruction of the electromagnetic clusters in each of the four layers (presampler, front, middle and back) of the calorimeter after having subtracted the pedestals and applied calibration gains [6]. A correction for temperature variations to the deposited charge is also applied [7]. The standard clustering algorithm was used. The default options for the cluster size [5] were chosen in most of the described analyses.

The event preselection criteria, applied at the level of the off-line analysis to reject minimum ionizing particles and particles interacting before the calorimeter, consisted in requiring that the signal in the scintillator counter behind the calorimeter was less than 520 counts, that all four MWPC had at least 1 hit and that not more than one of these chambers had more than one hit. Furthermore it was required that the energy deposited in the front layer was above 1 GeV. These criteria rejected \(\approx 38\%\) of the events in the runs at 20 GeV and \(\approx 34\%\) in the runs at 250 GeV.

## 3 \(\eta\) Uniformity Studies

Among the analyses in which the EM calorimeters of ATLAS will play an important role, the searches for H \(\rightarrow\gamma\gamma\) and for H \(\to 4e\) are the most demanding in terms of calorimeter performances. The Higgs mass range in which these two decays are considered to be the most promising modes is between \(\approx 100\) and 200 GeV/c\({}^{2}\). Due to the high background cross section and to the intrinsic expected width of the Higgs, the possibility of observing a signal peak in the \(\gamma\gamma\) invariant mass distribution over the background continuum depends crucially on the energy and angular resolution of the LARG. For the energy resolution it is required that the constant term is less than 0.7 %. In order to achieve this figure a careful study and understanding of the calorimeter uniformity is needed. Several measurements have been made to understand all the effects which play an important role in determining this constant term and in particular the effect of the pulse shape reconstruction. This reconstruction plays a role since, to measure the energy deposited in the calorimeter by a particle, the maximum amplitude of the electric signals produced on the electrode cells by this event has to be evaluated. After amplification and shaping the analog signals from each calorimeter cell are sampled at a frequency of 40 MHz (which is the LHC beam crossing frequency) and after digitization, typically five samples are available for further analysis. In LHC conditions one of the samples will be near the pulse peak and a small correction using two more samples on each side will be applied; this is the basis of the optimal filtering method which, in addition, allows noise reduction. In test beam conditions the pulse peak is totally random with respect to the clock and the pulse height reconstruction with five measured points requires a precise knowledge of the pulse shape. In the following subsections results obtained applying three different methods of signal reconstruction to estimate the peak height are shown : the parabola method, an optimal filtering method and a third method (also based on optimal filtering) which in addition takes into account the electrical description of the read-out electronics.

In all runs analysed in this section, the beam particles hit the calorimeter around the position \(\phi\)=0.257 rad corresponding to the center of cell \(\phi_{\rm numb}\)=10 of the middle layer.

To avoid non uniformities due to possible cell edge effects, the analysis has been restricted to electrons which hit the middle layer at a \(\phi\) angular coordinate within \(\pm\)0.0025 rad ( 20% of the cell \(\phi\) width) of the center of the cell. The variable used to apply this selection is the barycenter along \(\phi\) of the energy deposited in the middle layer computed by the clustering algorithm. The '\(\phi\) modulation' due to the accordion geometry as well as possible non uniformities due to cell edge effects will be corrected at a later stage and these corrections will not affect the conclusions of this paper.

The total energy was computed summing the reconstructed cluster energy in the four layers and applying a weight of 1.5 to the energy in the presampler to correct for the energy lost by electrons upstream of the calorimeter.

### Results with the Parabola Method

The first method to estimate the peak height of the pulse from the five samples is based on fitting, after pedestal subtraction, with a parabolic function three of the five points: the maximum and one point on each side of the peak. Details about this method are described in [5, 8].

Figure 1 shows the total energy as function of the \(\eta\) position of the barycenter of the energy distribution in the front layer for electrons of 20 GeV and 250 GeV, respectively. The values reported on the horizontal axis represent the barycenter value in the front layer cells(=strips) in cell units. The multiplicative factor to convert this quantity to \(\eta\) values is 0.003125 ; therefore the shown \(\eta\) region extends up to \(\eta\)= 1.225 which corresponds to the end of cell 48 (along \(\eta\)) of the middle layer. This ensures that even the shower axis with the highest \(\eta\) value crosses all four calorimeter layers.

A 'jump' in the energy is visible between electrodes A and B and a loss of energy is seen at the right edge of channel 256 which is the last channel of the front layer belonging to electrode A.

The characteristic shape with modularity of one cell of middle layer, due to the limited extension of the chosen cluster size, is also visible. This effect can be easily corrected at a later stage; therefore in the following analyses only events corresponding to particles crossing the central zone of a middle cell in \(\eta\) within \(\pm\) 0.0025 (20 % of the cell \(\eta\) width) have been considered.

A repetitive pattern with modularity of eight cells (i.e. 64 channels in strip units) of middle layer appears in figure 1, apparently less pronounced in the 20 GeV data. Inside each pattern (i.e. going from channel 0 to 64, then from channel 65

Figure 1: Total reconstructed energy in GeV versus the barycenter position along the \(\eta\) direction (strip units) measured in the front layer for 20 and 250 GeV electrons. In these plots the nominal position of the beam corresponds to events crossing the calorimeter at \(\phi=0.257\pm 0.003125\) (cell number 10 in the \(\phi\) coordinate of the middle layer). The parabola method was used.

to 128 and so on) the energy increases with \(\eta\). In addition, inside each electrode (A and B) separately, the general trend of the energy with increasing \(\eta\) is also to increase.

Cell 9 of the middle layer (channels 80-88 in figure 1) has gain coefficients varying abnormally with time [6, 9]; for this reason, in the estimation of the energy spread, events corresponding to particles impinging on it have been excluded. Events impinging on cell 1 are also excluded in order to ensure that the shower is laterally fully contained in the calorimeter.

The 20 GeV and 250 GeV results are compared in Figure 2.

To make easier the comparison, the data at 250 GeV are multiplied by 0.081 for electrode A and by 0.079 for electrode B. These factors were computed as the ratio between the measured mean energy at 20 GeV and at 250 GeV in each electrode separately (after having excluded events impinging on cells 1 and 9). The reasons for having obtained two different ratios could be due to the non containment of the showers at 250 GeV, as explained later in section 3.4.

Figure 2: Energy versus the barycenter position measured in the front layer along the \(\eta\) direction (in middle cell units) at 20 (open circles) and 250 GeV (stars). The points at 250 GeV are scaled as explained in the text. The parabola method was used.

Figures 3(a) and 3(b) show the distributions in electrode A of the mean cell energy for 20 GeV and 250 GeV electron data, respectively. The same distributions for the full calorimeter (electrodes A+B) are shown in figures 3(c) and 3(d). To account for possible differences arising from the different sampling ratios in electrode A and B (see the electrode description in section 2), in these figures electrode B data are scaled by applying a multiplicative factor computed as the ratio between the mean energy in electrode A and B, for each energy separately. The multiplicative factor is 1.021 at 20 GeV and 0.990 at 250 GeV, corresponding to an effect of +2 % and -1% at the two energies, respectively. The difference between these values could be due to the fact that the \(\pi^{0}\)-\(\pi^{0}\)-\(\pi^{0}\) interaction is not a significant effect.

Figure 3: Energy spread among events crossing different cells of the middle layer for 20 GeV and 250 GeV electrons (\(\phi_{\rm numb}\)=10). In the plots one entry corresponds to the mean energy of events crossing one middle cell. Figures (a) and (b) show the result for events crossing cells belonging to electrode A, figures (c) and (d) show the result for the whole calorimeter. The parabola method was used.

be due to the non containment of the showers at 250 GeV (see section 3.4). Figure 3 indicates that the energy spread among events crossing 46 cells of the middle layer (\(0.<\eta<1.225\) ) evaluated as the ratio between the r.ms. and the mean of the distributions, is 1.1% at 20 GeV and to 1.7% at 250 GeV.

### Results with Optimal Filtering

The second method to evaluate the energy deposited in the calorimeter by a particle is based on an Optimal Filtering (OF) procedure. This method, described in detail in note [10], reconstructs from five samples the complete signal shape. The pulse shapes are reconstructed from electron data and 25 sets of OF weights are computed for 25 bins of 1 ns width in the event arrival time with respect to the sampling clock.

Figure 4 shows the total energy deposited in the calorimeter versus the \(\eta\) position of the barycenter of the energy deposited in the front layer by electrons of 20 GeV and 250 GeV. To superimpose the different data sets, the 250 GeV data are

Figure 4: Energy versus the barycenter position measured in the front layer along the \(\eta\) direction (in middle cell units) at 20 (open circles) and 250 GeV (stars). The points at 250 GeV are scaled as explained in the text. The OF procedure of section 3.2 was used.

multiplied by 0.081 for electrode A and by 0.079 for electrode B, following the same procedure described in section 3.1 for figure 2.

In figure 4 the general trend of the energy to increase with increasing \(\eta\), inside each electrode separately, is still present even though the effect is reduced with respect to the parabola method. This effect is stronger at 250 GeV than at 20 GeV.

Figure 5 shows that the energy spread among events crossing 46 different cells of the middle layer has decreased to 1.0% at 20 GeV and to 1.4% at 250 GeV. This improvement could be explained by the fact that the real pulse shape is not parabolic and, in the procedure of peak determination, the OF method is better at

Figure 5: Energy spread among events crossing different cells of the middle layer for 20 GeV and 250 GeV electrons (\(\phi_{\rm numb}\)=10). In the plots one entry corresponds to the mean energy of events crossing one middle cell. Figures (a) and (b) show the result for events crossing cells belonging to electrode A, figures (c) and (d) show the result for the whole calorimeter. The OF procedure of section 3.2 was used.

taking into account cross-talk effects which influence the real pulse shape.

As explained in section 3.1 for figure 3, in figure 5, electrode B data are corrected to account for possible differences arising from different sampling ratios in electrode A et B (see the electrode description in section 2).

### Results with Optimal Filtering taking into account the electric description of the pulses

A third method to evaluate the energy deposited by a particle in the calorimeter with the preceding OF procedure was developed and is based on an electrical description of the physics pulses starting from calibration pulses. This method, described in detail in [1], takes into account the real signal shape and the variation of the peak height.

Figure 6 shows the total energy deposited in the calorimeter as function of the \(\eta\) position of the barycenter of the energy in the front layer for electrons of 20 GeV

Figure 6: Energy versus the barycenter position measured in the front layer along the \(\eta\) direction (in middle cell units) at 20 (open circles) and 250 GeV (stars). The points at 250 GeV are scaled as explained in the text. The OF procedure of section 3.3 was used.

and 250 GeV. As in previous similar plots, the 250 GeV data are scaled by 0.081 for electrode A and by 0.079 for electrode B.

In figure 6 the general trend of the energy to increase with increasing \(\eta\) inside each electrode is greatly reduced with respect to figure 4, especially at 20 GeV.

Figure 7 shows that the uniformity has improved in a significant way: the energy spread among events crossing 46 different cells of the middle layer is now 0.8% at 20 GeV and to 1.1% at 250 GeV. The reason for the improvement could be understood as due to a better evaluation of the parasitic self-inductances of the different readout cells which is obtained with the third method.

As explained in section 3.1 for figure 3, in figure 7, electrode B data are corrected to account for possible differences arising from different sampling ratios in electrode

Figure 7: Energy spread among events crossing different cells of the middle layer for 20 GeV and 250 GeV electrons (\(\phi_{\rm numb}\)=10). In the plots one entry corresponds to the mean energy of events crossing one middle cell. Figures (a) and (b) show the result for events crossing cells belonging to electrode A, figures (c) and (d) show the result for the whole calorimeter. The OF procedure of section 3.3 was used.

A et B (see the electrode description in section 2). The correction factor, given by the ratio between the mean energy in electrode A and B, is now 1.025 at 20 GeV and 1.010 at 250 GeV.

Figure 8: Energy difference between the 250 GeV data (scaled) and the 20 GeV data of figure 6 versus \(\eta\) in middle cell units. The straight lines are drawn to exhibit the general trend of the energy difference that, in each electrode separately, increases with \(\eta\). For the same reason cell 1 and 9 (bad cells) are not shown. The OF procedure of section 3.3 was used.

Figure 9: Energy leakage in GeV for 250 GeV simulated showers (fast simulation) versus \(\eta\).

### Corrections for Leakage

The different values of the energy spread between the 20 and 250 GeV data could be explained by the fact that at 250 GeV the electromagnetic showers are not fully contained in the calorimeter and the energy leakage is different at different \(\eta\) values. This hypothesis is suggested by figure 8 where the behaviour of the difference between the data at 250 GeV(scaled) and at 20 GeV of figure 6 is shown as function of \(\eta\).

To correct for energy leakage, a factor, depending on the \(\eta\) value of the shower, was applied to the 250 GeV data. This correction was computed with a fast MonteCarlo which gives the energy leakage, \(\rm{Eleak}(\eta)\), versus \(\eta\) for 250 GeV simulated showers. This distribution was fitted with a half gaussian for \(\eta<0.8\) and an exponential for \(\eta>0.8\) (see figure 9).

The correction factor is therefore:

\(\rm{Corr}(\eta)\) = \(\rm{Eleak}(\eta)/250\). * \(\rm{E_{A/B}}\)

where \(\rm{E_{A/B}}\) represents the measured mean energy of events in electrode A or B,

Figure 10: Energy versus the barycenter position measured in the front layer along the \(\eta\) direction (in middle cell units) at 20 (open circles) and 250 GeV (stars). The points at 250 GeV are corrected for leakage and scaled as explained in section 3.4. The OF procedure of section 3.3 was used.

respectively. Figure 10 shows the comparison between the 20 GeV data (no leakage corrections) and the 250 GeV data after the leakage correction. The two data sets look more similar and at 250 GeV the increase of the energy with \(\eta\) in each electrode is reduced with respect to figure 6. The energy spread at 250 GeV is now 0.75% as shown in figure 11.

At 250 GeV after the leakage correction, the ratio of the mean energy in electrode A and B is 1.020 closer to the value of 1.025 which was found for the 20 GeV data. This fact seems to indicate that the factor to account for the different sampling ratio in electrode A and B has to be corrected by \(\approx\) 2 %.

## 4 Energy Resolution

The optimal filtering method described in section 3.3 improves and makes more uniform the energy resolution across all the calorimeter. The total energy was computed by summing the reconstructed cluster energy in the four layers and applying a weight of 1.5 to the energy in the presampler. This factor, which takes into account the energy lost by the electrons upstream of the calorimeter, was not specially tuned in this study, since it is believed that the conclusion of this section does not depend on its final optimization.

Figure 11: Energy spread among events crossing 46 different cells of the middle layer for 250 GeV electrons after applying the leakage correction, as explained in section 3.4. One entry represents the mean energy of events crossing one middle cell. The OF procedure of section 3.3(\(\phi_{\rm{num}}\)=10) was used.

[MISSING_PAGE_EMPTY:14]

\(\eta_{\text{numb}}\)= 35, \(\phi_{\text{numb}}\)= 10, while going from the parabola method to the OF method described in section 3.3.

## 5 Noise Reduction

In figure 13 the distributions of the collected energy for events recorded with a random trigger (therefore not associated to the presence of a particle crossing the calorimeter) is presented, for two different runs. Plots (a1) and (b1) were obtained with the parabola method, plots (a2) and (b2) with the OF method described in

Figure 13: Noise level for 2 different runs. Plots (a1) and (a2) (alternatively (b1),(b2)) refer to the same run. Plots (a1) and (b1) were obtained with the parabola method, plots (a2) and (b2) were obtained by applying the OF method described in section 3.3.

section 3.3. Plots (a1) and (a2) (alternatively (b1) and (b2) ) refer to the same run. As expected all these histograms are centered around 0. The r.m.s. of the distributions represents the noise level. The noise level is reduced by a factor of \(\approx\) 1.6.

## 6 Conclusions

Three different methods of signal reconstruction were applied to the analysis of 20 and 250 GeV electrons collected in July and August 2000 at the Liquid Argon test beam: the parabola method, the optimal filtering method and an original method using an optimal filtering procedure together with the electric description of the read-out electronics.

To evaluate the uniformity of the calorimeter response a parameter (energy spread) was defined as the ratio between the r.m.s. and the mean of the energy distribution for events crossing 46 different cells (at different \(\eta\) and same \(\phi\)) of the middle layer.

The first method gives an energy spread of 1.1% at 20 GeV and of 1.7% at 250 GeV, the second method gives an energy spread of 1.1% at 20 GeV, and of 1.4% at 250 GeV, the third method improves significantly the result giving an energy spread of 0.8% at 20 GeV, and of 1.1% at 250 GeV. This improvement is due to the better evaluation of the parasitic self-inductances of the different read-out cells obtained with the third method.

The residual difference in energy spread between the 20 and 250 GeV energies is probably due to the shower non containment at 250 GeV. After leakage correction the energy spread at 250 GeV is 0.75% (i.e. the same as at 20 GeV).

Furthermore the results obtained seem to indicate that the factor which takes into account the different sampling ratios in electrode A and B has to be corrected by \(\approx\) 2%.

Considering events crossing two different cells at different \(\eta\) and same \(\phi\), the third method improves the energy resolution which goes, at 250 GeV on average, from 1.04% (parabola method) to 0.93%.

As expected the optimal filtering procedure also allows a reduction of the noise level. By applying the OF method described in section 3.3 the reduction factor is \(\approx\) 1.6.

## References

* [1] L. Neukermans, P.Perrodo, R Zitoun; _Understanding the ATLAS electromagnetic barrel pulse shapes and the absolute electronic calibration_ ATL-LARG-2001-008
* [2] ATLAS Collaboration; _Liquid Argon Calorimeter Technical Design Report_ CERN/LHCC/96-40, 15 December 1996.
* [3] ATLAS Collaboration; _Detector and Physics Performances_ CERN/LHCC/99-14 (Volume I) and CERN/LHCC/99-15 (Volume II), 25 May 1999.