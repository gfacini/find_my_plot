###### Abstract

A GEANT4 simulation of photon testbeam setup has been built in order to study the data taken in August 2000 with ECAL barrel module 0. This simulation takes into account the material found in the beam in 2001. This note describes the simulation and presents a comparison between data and GEANT4 for different variables relevant to \(\gamma\) identification. This work validates the GEANT4 module 0 simulation for most of these parameters, in particular for \(\gamma/\pi^{0}\) rejection variables, and could be considered as a first step in GEANT4 validation of Ecal barrel photon response.

**ATLAS electromagnetic barrel photon testbeam response compared to GEANT4 simulation**

S. Viret

_Laboratoire de Physique Subatomique et de Cosmologie, Grenoble, France_

[MISSING_PAGE_EMPTY:2]

Introduction

GEANT4 [1] is a simulation toolkit based on oriented object technology. It provides flexibility and adaptability, particularly with physics processes implementation and program architecture.

ATLAS detector implementation within GEANT4 framework started in 1999 at the beginning of software validation. GEANT4 simulation of liquid argon calorimeter is now validated [2] and has reached at least the same level of precision than its GEANT3-based predecessor.

Up to now, photon have not been used in validation studies. Photons represent only a very small fraction of the data collected during the whole testbeam period. In addition they were polluted by material accidentally present in the beamline. Photon data could nevertheless be exploited, for shower shape validation for example.

To this end, a simulation of the photon beamline has been built. The elaboration of this simulation, and results of the comparisons between data and GEANT4, are presented in this note.

The outline is as follows: in section 2 the photon testbeam experimental setup is presented. Elaboration and optimization of the simulation are presented in section 3. The section 4 presents the different parameters which have been compared in this work, and describes the analysis strategy. Data selection and the comparison of the results are then presented in section 5. Finally, conclusions and perspectives are given in section 6.

## 2 Photon Testbeam Experimental Setup

The photon beam setup is described in fig.1. The experimental setup in front of the first beam chamber (BC1) and behind the cryostat (muon and pion counters) is identical to the classic one1. Details concerning the classic setup can be found in [3].

Footnote 1: From now on, electron testbeam setup (resp. simulation) will be refered as the classic setup (resp. simulation).

Starting from a 178 \(GeV\) electron beam (noted **0** on fig.1), the photon beam is built in two steps:

* **1. Photon creation:** this task is handled by the target placed just behind BC1. The photons were created here, mainly by _brehmstrahlung_. Different target types have been tested. The photons used for this study were created by a Lead plate of 0.1 \(X_{0}\) thickness2. Footnote 2: We have, for Lead, 1 \(X_{0}=\) 0.56 _cm_
* **2. Electron deviation:** just after the target, the beam contains both photons and electrons. In order to obtain a clean photon beam, electrons were deviated by a magnetic field of 4 \(Tm\) intensity. The field is produced by a coil of 1 \(m\) radius placed about 25 \(m\) in front of the module, called M0. EleM0 entrance (marked as d on fig.1) is given by the relation:

\[d=\left(\frac{3060}{E_{e}}\right)cm \tag{1}\]

where \(E_{e}\) is the electron energy (in \(GeV\)). This distance measures about 4 Ecal Middle cells for a 178 \(GeV\) electron (1 Middle cell \(\approx\) 4 \(cm\)). Consequently the deviation between photons and electrons in M0 measures **at least** 4 Middle cells.

Data acquisition is initiated by 2 scintillators (S1 and S4). The position of S4 could be changed in order to trigger on different photon energy ranges3. The third scintillator (S3) is combined with a Lead converter (1 \(X_{0}\) thickness) in order to reject multiphoton events. The role of S3 will be developped in section 5.

Footnote 3: Equation (1) shows that electron position and photon energy are correlated.

## 3 Photon beam simulation

As was written in the introduction, GEANT4 simulation of different LArg subdetectors are developped since the end of 1999. The ECAL barrel part has been built by G.Parrour, K.Kordas, and D.Benchekroun [4]. Our simulation is largerly based on their classic test-beam model. In particular, physics processes and physics cuts have not been modified. Our implementation introduces two points: beam geometry and reconstructed data a structure, described here after.

Figure 1: _H8 Beamline in the Photon Configuration_

### Beam Geometry

During the tests, the beam position is fixed in space. Beam chambers, scintillators, and other beam components did not move. The \((\eta,\phi)\) scans are obtained by rotating the cryostat containing M0. In the classic simulation, we have the opposite situation: the beam structure rotates and the cryostat is fixed. As beam material in front of the cryostat is neglected by the simulation, beam rotation is straightforward. In the photon case, elements outside the cryostat like the target, the converter, or the magnetic field, could not be neglected. Consequently the beam geometry has to be redefined for each \((\eta,\phi)\) position. This was not a problem in our case, as the whole photon event sample was done with the cell \((\eta,\phi)=(28,10)\).

Like in the classic simulation, beam chambers and scintillators have been neglected. They represent a very small amount of material. So finally, four pieces have been added: the target, the converter, the magnetic field, and the material found in the beam in 2001 [5]. We will discuss the two last point in more details.

#### 3.1.1 Magnetic Field

The magnetic field is produced by a coil placed about 25 \(m\) in front of the cryostat, in order to separate the photons from the electrons. This field, which is perpendicular to the beam direction, has an integrated intensity of about 4 \(Tm\).

The field profile is shown on fig.2. There are 2 distinct parts: a parabolic shape inside the coil (radius \(<\) 1 \(m\)), and an exponential tail outside. This profile has been reproduced with the tails up to 3 \(m\) radius.

#### 3.1.2 Beam material

The accidental presence of material along the beamline was confirmed in 2000 by the photon runs. A significant photon production was indeed observed without any target.

Figure 2: _Magnetic field profile_.

Fig.3 shows that the beam particles are crossing non-uniform quantity of matter. The \((\eta,\phi)\) profile of the beam spot confirms this hypothesis: an object, looking like a fork, was in the beam!

This object was finally found, only4 at the end of 2001. Its description is presented on fig.4. The shape of these three iron rods was completely compatible with the presampler observation.

Footnote 4: the presampler showed its shape but, unfortunately, not its position.

The effect of this object on the energy resolution was significant, mainly because that material was non-uniformly distributed along the beam spot. In this case, the presampler was not so efficient and could not correct for the degradation of the energy resolution. We will present this problem in more details in the section dedicated to the energy calibration. Energy spectra with and without beam material will then be compared.

#### 3.1.3 Particle generation (beam shape)

In order to obtain a realistic simulation, particle are generated as follows: **1.** A space coordinate is chosen randomly inside the beam profile obtained using BC1 information. **2.** A \(178~{}GeV\) electron is generated at the same distance than BC1, its position in the beam plan was determined during the previous step.

### Data Structure

Simulation output should contain all the parameters needed for a shower shape study. In the EMTB package [6], a specific **PHOTON** card should be activated in order to reconstruct photon runs. The main differences with a classical reconstruction are described below:

* **Two clusters:** the most significant difference comes from the fact that 2 particles enter M0 simultaneously. Therefore, in order to keep information of both particles, 2 clusters are needed. Finding a second cluster is not difficult, but should be done carefully. In particular, one should verify that the second candidate does not belong to the first cluster.
* **Specific shape parameters:** energy profile in the strips, cluster width,... should be defined. This is not the case in the classical reconstruction.

All these parameters have been added to the classical simulation, so that the output file of our special simulation looks exactly like a ROOT file reconstructed by EMTB with **CARD_PHOTON=1** option. The only difference concerns the energy calibration: EMTB output is in \(GeV\), while simulation output is in \(\mu A\).

### Geometry validation

After these modifications, and before the energy calibration, a first control of the beam geometry and the magnetic field is performed. To this end, energy profiles in the strips and the middle parts of the Ecal are compared.

This comparison is shown on fig.5. We observe two peaks, electrons at left and photons at right. Their position in simulation and data are in complete agreement. The distance between the two peaks is the same, thus validating the magnetic field modelisation. The widths of the photon peaks are also identical, thus validating the beam simulation.

### Energy Calibration

In the classical simulation, the results are given in terms of current. In addition, the values for the current are given without correction factors, in particular for the presampler. In the output, we have for each cluster:

\[I_{total}=I_{PS}+I_{strips}+I_{middle}+I_{back} \tag{2}\]

At the first order, cluster energy is obtained by applying the following relation:

\[E_{total}=\beta(\alpha I_{PS}+I_{strips}+I_{middle}+I_{back}) \tag{3}\]

where \(\beta\) is a global scaling factor, and \(\alpha\) the specific presampler coefficient, depending on the amount of upstream material. A minimal set of coefficients for M0 implies only twovalues for \(\beta\) (one for each electrode A & B) and one \(\alpha\) value for each PS cell. The situation is actually rather more complex, and at the end nearly each cell has its own optimized weight. Weight calculation implies minimization methods [7] which are difficult to apply in our case, because of the non-uniform material. In addition, we are just looking in one \((\eta,\phi)\) direction, therefore we could use a minimal solution, with only two coefficients.

For the calibration, a beam with fixed energy is needed. Therefore we used \(245\;GeV\) electron runs to determine \(\alpha\) and \(\beta\). These runs were taken during the same period as the photons at the same \((\eta,\phi)\) position: \((28,10)\). To compute the coefficients, we have proceeded as follows.

The \(\eta\) and \(\phi\) energy dispersions due to the detector granularity were corrected. In order to reduce this effect, only events with a barycenter contained in a window \((\Delta\eta,\Delta\phi)=(0.5,0.5)\) around the center of the cell were selected. Then mean values of energy (or current) in barrel and PS were determined for both simulation and real data. These values leads to the following relations for \(\alpha\) and \(\beta\):

\[\left\{\begin{array}{rcl}\alpha\beta&=&\frac{<E_{ps}^{\text{data}}>}{<l_{ps }^{\text{sim}}>}\\ &&\\ \beta&=&\frac{<E_{total}^{\text{data}}>-\alpha\beta<l_{ps}^{\text{sim}}>}{<l_{ tonnea}^{\text{sim}}>}\end{array}\right. \tag{4}\]

Figure 5: _Photon beam: energy deposit of the incident particles._

The energy of the simulated electrons could then be calculated, and the energy resolution determined. Energy spectra are shown on fig.6 & 7. The effect of non-uniform material is clearly seen and sizeable. Without the material (fig.6), GEANT4 simulation resolution is 20% smaller than for the data. This discrepancy disappears when the material is added to GEANT4 simulation, as shown in fig.7. In this configuration, simulation and data are in good agreement.

The results including non-uniform material are satisfactory. The coefficients calculated in this configuration (\(\alpha=2.68\) and \(\beta=5.80\)) have been used in all the results which will be presented below.

## 4 Description of the analysis

The purpose of this section is to introduce the analysis presented in part 5 of this note. The variables which are compared are presented and their choice is discussed. Then, the principle of the study is explained in more details.

### Shower shape parameters

Our goal is to compare real photon showers to simulated ones. There are several interesting parameters from which we have chosen the most relevant to our study:

Figure 6: _Energy spectra after calibration. Simulation is done without non-uniform material._

* **Energy fraction in the first sampling:** this variable characterizes the shower longitudinal profile in the strips. It is defined as: \[E_{1}^{E_{tot}}=\frac{E_{photon}^{strips}}{E_{photon}}\] (5)
* **Leakage in the strips:** the leakage is related to the shower lateral profile. The leakage in the strips, as the previous parameter, can also be defined in the middle compartment of the Ecal5. We called it \(E_{1}^{core}\), and it is shown on fig.8.

Figure 8: _Shower lateral profile in the strips: \(E_{1}^{core}\) definition._

Figure 7: _Modelisation of the non-uniform material and energy spectra including this effect._

* \(\gamma/\pi^{0}\) **rejection parameters:** neutral pions are one of the most significant background for photons. The pion decays into two side-by-side photons, giving a single cluster in Ecal. It is still possible, thanks to the strips high granularity, to separate photons from pions with a correct accuracy. To this end, cluster energy profile in the strips is exploited. The profile differences between \(\gamma\) and \(\pi^{0}\) are shown on fig.9. The \(\pi^{0}\) profile has clearly a second maximum6, contrarily to the \(\gamma\) one. In order to estimate the \(2^{nd}\) maximum significance, two parameters are considered: the value of the \(2^{nd}\) maximum \(E_{max}^{2}\) and the "valley" significance \(E_{max}^{d}\). Both are shown on fig.9. Footnote 6: This plot is an idealistic view. The \(2^{nd}\) maximum is, unfortunately, not always so clean.

* **Shower widths:** they are extensively used for \(\gamma\) identification, as hadronic showers are known to be wider than electromagnetic ones. The value of the width depends on the number n of strips with which it is computed. We have: \[W^{n}_{photon} = \sqrt{\sum_{i=\eta^{n}_{strips}-\frac{n-1}{2}}^{\eta^{n}_{strips} +\frac{n-1}{2}}(i-\eta^{n}_{strips})^{2}\times\frac{E_{strip}(i)}{E_{strips}}}\] (6) \[with \eta^{n}_{strips} = \sum_{i=i_{max}-\frac{n-1}{2}}^{[i=i_{max}+\frac{n-1}{2}}i\times \frac{E_{strip}(i)}{n_{strip}(i)}]\] \[and E_{strips} = \sum_{i=\eta^{n}_{strips}-\frac{n-1}{2}}^{\eta^{n}_{strips}+\frac{ n-1}{2}}E_{strip}(i)\]where \(i_{max}\) is the strip with the largest energy deposit, and \(\eta^{n}_{strips}\) the strip containing the barycenter7. As we do not always have \(i_{max}=\eta^{n}_{strips}\), particularily for large \(n\), \(W^{n}_{photon}\) is computed using \(\eta^{n}_{strips}\).

Footnote 7: The barycenter is computed on \(n\) strips around \(i_{max}\).

### The principle of the study

Most of the variables presented in the last paragraph, except \(\gamma/\pi^{0}\) rejection parameters, are largerly dependent on the energy. Consequently an energy independent comparison implies a loss of information. But how do we get the information on the photon energy?

This problem could be solved with the electron barycenter in the strips. Assuming that a single photon is created, the correlation between the photon energy and the electron position is clear as we have:

\[d=\left(\frac{3060}{178-E_{\gamma}}\right)cm \tag{7}\]

This correlation is shown on fig.10. Therefore a natural cut on the photon energy could be obtained using a cut on the electron position.

However, the photon selection should be very strict, since relation 7 works only if we have only one photon created in the final state. The data selection will be now discussed.

## 5 Data/GEANT4 comparison

### Data Selection

For the data selection we have to consider two points:

Figure 10: _Correlation between electron strips position and photon energy._

* **Multiphotons:** in several cases, more than one photon is created before arriving in M0. This problem is naturally emphasized by the presence of the non-uniform material. As all incoming photons are superimposed, it is generally difficult to distinguish a multiphoton event from a single photon event. The role of the converter which is placed just in front of S3 is to reveal the multiphoton. A photon arriving in the converter has a 55% probability to form a \(e^{+}e^{-}\) pair (converter thickness is 0.1 \(X_{0}\)). This pair is then detected in S3. The more incoming photons you have in the converter, the higher is the probability to observe a non-zero signal in S3. Consequently, by rejecting a non-zero signal in S3, we reject a lot of multiphotons and few correct events. Nevertheless, the converter is a passive filter, so that the multiphoton rejection should be completed by further cuts.
* **Electron position dispersion:** the beam is not point-like, and the smearing we observe on photon position in the strips (see fig.5) is the same for the electron position. As we cut on the electron position, this bias should be reduced.

Electron position and photon position in the strips are correlated. The easiest way to reduce electron position dispersion is then to reduce photon position dispersion. Consequently only photons with an \(\eta\) within the following range are selected:

\[\mathbf{Cut1:226.5<\eta_{strips}^{\gamma}<229.5} \tag{8}\]

Concerning the multiphoton, it was already shown that their rejection start with a cut in the S3 signal. This signal should be compatible with the S3 pedestal value. Using RANDOM events, we find the following range8 for the S3 pedestal: [450, 480]. The photon candidate is selected if:

Footnote 8: In ADC counts.

\[\mathbf{Cut2:450<S_{3}^{counts}<480} \tag{9}\]

After this cut we still have multiphotons. Two different situations are possible:

* **At least one photon is converted:** therefore, at least one \(e^{+}e^{-}\) pair is created and there are two possibilities. **1.** the pair arrives in M0 at the same position than the photon. In this case, it is detected by S3 and then rejected by the previous cut. **2.** At least one particle is lost before arriving in M09, or even if this particle arrives in M0, it would not be contained in the reconstructed clusters. In this case the expected energy will not be collected into the two clusters. In addition, the complete barrel energy should be close to the two clusters energy sum. It follows: \[\left\{\begin{array}{ll}\mathbf{Cut3:}&\mathbf{0.93<\frac{E_{electron}+E_{ photon}}{E_{calc}}<0.96}\\ \\ \mathbf{Cut4:}&E_{calc}>175\ \mathbf{GeV}\end{array}\right.\] (10) The upper limit is set to reject superimposed clusters. The value of 0.96 has been prefered to 1.0 because a \(3\times 3\) cluster contains about 95% of the shower energy.

* **All the photons passed the converter:** in this case cuts 3 & 4 are passed. All the photons are recovered in a unique cluster. The profile of such an event in the strips is less peaked than for a normal event. It leads to: \[\left\{\begin{array}{ll}{\bf Cut5:}&E_{max}^{1}>{\bf 0.5}\ {\bf GeV}\\ \\ {\bf Cut6:}&W_{photon}^{21}<{\bf 6}\ {\bf strips}\end{array}\right.\] (11)

Finally, in order to suppress all the low energy noise, an overall cut on photon cluster energy is applied:

\[{\bf Cut7:}\ E_{photon}>{\bf 5}\ {\bf GeV} \tag{12}\]

Once all these cuts are applied to the data10, a sample of about 4000 good photons remains for our study. In order to obtain the same amount of statistic with the simulation, about 70000 events have been produced. The comparison of the two samples is described in the next section.

Footnote 10: Only data with the converter have been used, thus reducing significantly the available statistic.

### Results of the analysis

All the plots presented below follow the same convention: the data are plotted in red and the GEANT4 simulation results are plotted in black. In the simulation, the crosstalk11 and the random electronic noise were added. Coherent noise has been neglected.

Footnote 11: Only the effect in the strips was considered. A 4.1% value at signal peak **[3]**, has been assumed.
Figs. 11 & 13 show the parameters \(E_{1}^{E_{tot}}\) and \(E_{1}^{core}\) respectively. Some differences between the data and the simulation are visible, mainly for \(E_{1}^{core}\). This effect is confirmed with the energy dependent results which are presented on figs.12 & 14.

The showers look deeper and wider in the data. These discrepancies were already observed with GEANT3 [8], and seem independent from the photon energy.

Concerning \(E_{1}^{E_{tot}}\), a recent study concerning the electrons [9] has shown that the total energy in the strips may be overestimated in a proportion of about 6%. This problem comes from the cell calibration, which did not take into account the crosstalk effects. A strip cell shares about 8% [3] of its current with its closest neighbours by capacitive couplings. Therefore, if the same effect is present here and is not corrected in the calibration runs, the strips energy might be overestimated in the data.

But it was also shown in [9] that the material present in front of Module 0 was not correctly modelized in the first G4 model of the testbeam setup. In particular, the cryostat wall thickness was overestimated (9 _cm_ instead of 8 _cm_) and the liquid argon present in front of the PS was not taken into account. Finally, the material budget before M0 was overestimated in the classical simulation by a quantity of nearly 0.1 \(X_{0}\). With more upstream material, shower developpement before M0 should be more important, therefore \(E_{1}^{E_{tot}}\) and \(E_{1}^{core}\) could be overestimated by the simulation. But this is not the case for \(E_{1}^{core}\).

Results presented in [9] shows that significant improvments could be reached with a better experimental setup modelisation in GEANT4.

Nevertheless, there are not only geometrical problems, and a good understanding of the crosstalk effect on intercalibration between the different sampling is compulsory to reproduce correctly the shower shape parameters.

#### 5.2.2 \(\gamma/\pi^{0}\) identification

The results for \(E_{max}^{d}\) and \(E_{max}^{2}\) are presented on figs.15 & 16. Contrarily to the previous variables, data and simulation were here in good agreement.

#### 5.2.3 Cluster widths

Cluster width study largerly depends on the number of strips used for the calculation. With n small we will be very sensitive to the crosstalk and the granularity, whereas for large n, electronic noise effect will become significant, mainly at low energy. That's why we separate two classical cases.

\(\Rightarrow\)**n=21:** This parameter is relatively easy to deal with, because it is not sensitive to the detector granularity. Figs.17 & 18 show a very good agreement between GEANT4 and the data. As it is seen on fig.18, the energy dependancy of this parameter is well reproduced by the simulation.

\(\Rightarrow\)**n=3:** This variable is more complex to analyze, mainly because of the granularity effect. The effect is sketched on fig.19: if you measure the width on a small number of strips, the cluster barycenter position introduces a non-negligible bias in the final result.

This effect is clearly visible in both data and simulation, as shown on fig.20. The width on 3 strips is represented as a function of the barycenter position in the strips12. A comparison can be performed only if this distribution is flat13.

Footnote 12: This barycenter is computed on 3 strips.

Footnote 13: Without correction, photons with the same energy have differents \(W_{photon}^{3}\) values. The energy dependency comparison is consequently not possible.

In order to suppress this effect, correction factors, for each position, were calculated using \(5^{th}\)order polynomial fits of the distributions shown in fig.20. The value chosen asa reference for the width was the smallest one (when barycenter is at the middle of the strip), i.e. \(W^{3}_{photon}=\mathbf{0.629}\).

The results obtained after this correction were presented on figs.21 & 22. As it is with the parameter \(W^{21}_{photon}\), a good agreement data/simulation has been observed.

#### 5.2.4 Overview

Except for the shower profile parameters \(E^{E_{tot}}_{1}\) and \(E^{\alpha re}_{1}\), a very good agreement between GEANT4 and the data has been observed. In particular, the \(\gamma/\pi^{0}\) rejection parameters are well reproduced with the GEANT4 model of photon beam setup. Concerning the widths, the situation is relatively encouraging.

In all cases, it seems that the differences we have observed in \(E_{1}^{E_{tot}}\) and \(E_{1}^{core}\) are caused by our model and by the data quality, but surely not by GEANT4. The profile variables imply more complex mechanisms and suggest more refined modelization (mechanisms and refinements which are more related to our understanding of cell calibration and experimental setup geometry than to GEANT4 itself).

## 6 Conclusions & perspectives

A simulation of the photon test beam experimental setup has been built using the GEANT4 simulation toolkit. This simulation, taking into account the electronic noise, the crosstalk in the strips, and the non-uniform material accidentaly present in the beam in 2000, has shown a good agreement with the data for most of the compared paramaters. These parameters (cluster widths, shower profiles,...) were chosen accordingly to their relevance to the photon identification. Discrepancies were observed for the shower profile parameters, they were already observed with GEANT3 and were supposed to be caused by modelization and crosstalk problems.

Because of the small amount of data, and the poor beam quality, these differences were difficult to investigate. Nevertheless, first results are quite encouraging for GEANT4, as we have obtained the same results than GEANT3. They could be considered as a first step in GEANT4 validation of Ecal barrel photon response. Next step will be the photon runs which are foreseen for 2004 combined test beam period.

## References

- A simulation toolkit "_
- NIM A506(2003), 250-303
* _"Comparisons of the Electron and Muon Testbeam Response of the ATLAS Liquid Argon Calorimeters with GEANT4 Simulations"_
* _"Performance of the barrel module 0 of the ATLAS electromagnetic calorimeter"_
- NIM A500(2003), 202
* Proc. IX Int. Conf. on Calorimetry in High Energy Physics (Annecy 2000)
- Frascati Physics Series, Vol. XXI(2000), 475-484
* _"H8 electron beam quality improvements during 2001"_
- CERN-SL Note-2002-018(2002)
* _"EMTB User Guide V.1-5"_
* _"Energy resolution optimization through layers measurements weighting: analytical solutions and numerical strategies"_
* private communication
* _"Linearity of the response to test beam electrons for EM Barrel module P13"_