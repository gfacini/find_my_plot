A newly developed algorithm called the jet vertex charge tagger, aimed at identifying the sign of the charge of jets containing \(b\)-hadrons, referred to as \(b\)-jets, is presented in this note. In addition to the well established track-based jet charge determination, this algorithm introduces the so-called _jet vertex charge_ reconstruction, which exploits the charge information associated to the displaced vertices within the jet. Furthermore, the charge of a soft muon contained in the jet is taken into account when available. All available information is combined into a multivariate discriminator produced using an artificial neural network method. The algorithm has been developed on jets matched to truth level \(b\)-hadrons provided by \(t\bar{t}\) events simulated at \(\sqrt{s}\)=13 TeV using the full ATLAS detector simulation and reconstruction.

Introduction

Final states with multiple jets containing \(b\)-hadrons, called \(b\)-jets, such as those involving top quarks, Higgs bosons decaying into a \(b\bar{b}\) pair, or new heavy states like supersymmetric or vector-like quarks, often suffer from large combinatorial backgrounds. The possibility of distinguishing between jets originating from \(b\)-quarks and \(\bar{b}\)-quarks provides information potentially useful for reducing this background. However, \(b\)-quarks (as well as other quarks except the top quark, and gluons) hadronise before their electric charge can be measured, so that the charge information of the initial quark is diluted. A method of indirectly inferring the electric charge of a hadronised object was first proposed by Field and Feynman [1]. In this method, the charge of a jet is reconstructed as a sum of the charges of all charged-particle tracks associated to it, weighted by their transverse momenta to maximise the sensitivity to the leading particles, which tend to carry most of the information of the fragmenting parton, while suppressing the impact of fluctuations. Jet charge observables motivated by this method have already been investigated extensively within the ATLAS Collaboration. A study of jet charge performance was carried out with dijet, \(t\bar{t}\) and \(W\)+jets events [2], while a measurement of jet charge was performed in dijet events [3], both using \(pp\)-collision data at 8 TeV. Reconstruction of \(b\)-jet charge was used in the context of \(CP\) violation studies in the \(B_{s}\) system [4] and for the measurement of the top quark charge in \(pp\)-collision data at \(\sqrt{s}=7\) TeV [5].

In this note, a novel method is described, representing an evolution of these ideas aimed at improving the charge reconstruction for \(b\)-jets. In addition to the established jet charge information, called \(Q_{\mathrm{j}}\) in the following, this method exploits the topology and kinematics of \(b\)-hadron decays more extensively. With a mean lifetime of \(\sim 10^{-12}\)s, \(b\)-hadrons make a characteristic secondary vertex (SV) displaced from the primary vertex (PV) by \(\mathcal{O}\)(mm), often followed by a tertiary vertex (TV) resulting from the subsequent decay of the resulting charmed hadron.1 In addition, both \(b\)- and \(c\)-hadrons have substantial branching ratios for decays involving leptons (11% and 10%, respectively, for semimuonic decays [6]). The method presented in this note, called the jet vertex charge (JVC) tagger, makes use of the reconstructed displaced vertices by computing further charge variables, the so called secondary vertex charge \(Q_{\mathrm{SV}}\), and tertiary vertex charges \(Q_{\mathrm{TV}}\), using the tracks associated to the respective vertices. Displaced vertices are reconstructed using the JetFitter algorithm [7]. The charge of a soft muon present within the jet, \(Q_{\mu}\), is also taken into account. A final discriminant is formed by combining the aforementioned information using a multi-variate analysis (MVA). The final discriminant is then interpreted as the ratio of likelihoods for a \(b\)-jet to be positively and negatively charged.

Footnote 1: The mean \(c\tau\) for \(B\) mesons is \(\approx 492\mu\)m, while for \(D^{0}/D^{\pm}\) mesons it is only \(\approx 123/312\)\(\mu\)m, respectively [6].

This note is organised as follows. In Section 2, the simulated sample used is described, while in Section 3 the relevant object definitions are presented. In Section 4, the input variables, the details of the MVA application, and the combination of results in a single discriminant are elaborated. The performance of the algorithm is discussed in Section 5. Conclusions are drawn in Section 6.

## 2 The ATLAS detector and Monte Carlo samples

The ATLAS detector [8], one of four particle detectors along the LHC circular accelerator [9], has a near cylindrical geometry2 and consists of an inner tracking detector (ID) surrounded by a 2 T super conducting solenoid, electromagnetic and hadronic calorimeters, and a muon spectrometer (MS) with a toroidal magnetic field. The ID provides tracking of charged particles for \(|\eta|<2.5\). It consists of silicon strip (SCT) and pixel detectors surrounded by a straw tube tracker (TRT) which also provides transition radiation measurements for electron identification. A new detector, the Insertable B-Layer (IBL), has been installed closer to the beam pipe [10] before the start of Run 2 of the LHC, increasing the precision in the reconstruction of displaced vertices. The electromagnetic and hadronic calorimeter system covers the pseudorapidity range \(|\eta|<4.9\). The MS covers the range \(|\eta|<2.7\).

The optimisation and the performance evaluation of this algorithm are carried out using a sample of \(t\bar{t}\) events corresponding to 13 TeV \(pp\) collisions simulated with Powheg+Pythia[11, 12], considering only single- and dilepton final states. EvtGen[13] is used to model the decays of \(b\)- and \(c\)-hadrons. Minimum bias interactions consistent with the expected 2015 run conditions are generated with Pythia8 [14] and are overlaid on the \(t\bar{t}\) events. The propagation of particles through the detector and the detector response are simulated fully using a GEANT4 [15] based framework [16].

## 3 Object definition, selection and flavour labelling

Jets are reconstructed using the anti-\(k_{t}\) algorithm [17] with a radius parameter of \(R=0.4\) from topological clusters built from energy deposits in the calorimeter, where clusters are calibrated at the electromagnetic scale and the hadronic scale is obtained through a \(p_{\mathrm{T}}\) and \(\eta\) dependent correction factor. A preliminary Run 2 calibration is applied [18].

After energy calibration only jets with transverse momentum greater than 20 GeV and \(|\eta|<2.5\) are used. In order to reject jets coming from pileup, jets with \(p_{\mathrm{T}}<50\) GeV and \(|\eta|<2.4\) are rejected if the so-called "jet vertex tagger" variable (JVT) is less than 0.641. The JVT algorithm [19] is a newly developed algorithm that combines two track-based variables, sensitive to the origin of the jet, in a likelihood discriminant. This working point has an expected efficiency of about 92% for jets from the hard-scatter and of nearly 100% for tagged \(b\)-jets, and an efficiency of about 2% for pileup jets.

The flavour of the simulated jet is assigned within a cone-labelling scheme: if a weakly decaying \(b\)-hadron with \(p_{\mathrm{T}}>5\) GeV, at the generator level, is found within the jet in a cone of \(\Delta R<0.3\), the jet is labelled as a \(b\)-jet. This association is done in an exclusive way: the \(b\)-hadron is matched only to the closest jet in \(\Delta R\). A priority order is used: if a \(b\)-hadron is found within the jet it is labelled as a \(b\)-jet, otherwise the procedure is repeated for \(c\)-hadrons and subsequently \(\tau\) leptons. If no match is found the jet is labelled as a light-flavour jet. The charge of the \(b\)-jet is then assigned by looking at the quark composition of the \(b\)-hadron matched to the jet: if the hadron contains a \(b\)-quark the jet is assigned a negative truth charge, the opposite happens for \(\bar{b}\)-quarks. If more than one \(b\)-hadron is found inside a jet, the one with highest \(p_{\mathrm{T}}\) is chosen to tag the truth charge of the jet. Such jets will be referred to as _truth \(b\)-jets_ in this note. It should be noted that the use of the weakly decaying \(b\)-hadron ignores the effects of \(B\)-meson mixing [6]. These effects are studied by considering the parentage of the weakly decaying \(b\)-hadron: if any of its parents contains a \(b\) (\(\bar{b}\)) quark while the \(b\)-hadron contains a \(\bar{b}\) (\(b\)) quark, \(B\)-meson mixing is considered to have occurred. In the final performance evaluation this effect is properly accounted for.

The Jet Vertex Charge algorithm uses inner detector tracks to produce the input variables for the final MVA-based discriminant. Tracks are first associated to calorimeter jets based on their angular separation \(\Delta R\)(track,jet). The \(\Delta R\) association requirement varies as a function of the jet \(p_{\mathrm{T}}\), resulting in a narrower cone for jets at high \(p_{\mathrm{T}}\), which are more collimated. Each track can be associated only to a single jet; the nearest jet is chosen if the association requirement is satisfied for multiple jets.

The tracks used to calculate the \(Q_{\mathrm{j}}\) variable are required to satisfy \(p_{\mathrm{T}}>500\) MeV, \(|\eta|<2.5\) and \(\chi^{2}/N_{\rm df}<5\). Additionally, their transverse impact parameter with respect to the beam line, \(d_{0}\), must satisfy \(|d_{0}|\leq 3.5\) mm; and the distance between the \(z\) coordinates of the track and the PV at the track's position closest to the beam line, \(z_{0}\), must satisfy \(|z_{0}\sin\theta|\leq 4.5\) mm, with \(\theta\) being the polar angle of the track. Furthermore, the minimal number of required hits is one in the pixel detector, four in the SCT, nine in pixel and SCT combined, and nine in the TRT, with at most one hit shared between different tracks. The initial track selection was adopted from Ref. [3], and then adjusted in an iterative procedure to yield the best discrimination power of the \(Q_{\rm j}\) variable between positively and negatively charged \(b\)-jets.

The reconstruction of displaced vertices within the jet is done with JetFitter, an algorithm able to resolve the SV from TV, providing sensitivity to the separate decays of \(b\)- and \(c\)-hadrons. The main assumption of JetFitter is that \(b\)- and \(c\)-hadrons decay vertices lie on the same line defined by the \(b\)-hadron flight axis, which is constrained to the jet direction. An iterative clustering is performed by progressively merging single tracks fitted to intersect the \(b\)-hadron flight direction into vertices. Merging proceeds until all fitted vertices, including the primary vertex, are less compatible than 0.2% among each other. This procedure results in a number of vertices reconstructed as the intersection of a single track and the flight axis (the so-called single-track vertices). While the JetFitter approach offers an important advantage, because it allows for a separation between SV and TV even in topologies where one would expect exactly one track at the SV3, it leads to a significant rate of fake vertices. The number of reconstructed vertices at this stage can be easily greater than the two expected. In order to remove fake vertices, only vertices in the \(b\)-hadron decay chain having a fit \(\chi^{2}/N_{\rm df}<5\), and with an error on the reconstructed flight length (\(\Delta L_{\rm 3D}\)) less than 5 mm, are retained. Furthermore, vertices with fitted flight lengths \(L_{\rm 3D}>250\) mm are discarded to improve the separation power of the \(Q_{\rm SV}\) variable while taking as many SVs into account as possible. The remaining vertices are ordered according to the distance with respect to the PV: the closest vertex is assumed to be the SV, even if it is a single-track vertex, whereas all the other displaced vertices are combined into a single vertex, identified as the TV. It is found that for single-track vertices, the observed charge corresponds to the expected one in about 65% of the cases. This is the same fraction found for multi-track SV, lending evidence for the hypothesis that the SV reconstruction is not significantly affected by fake tracks.

Footnote 3: For example, the decay of \(B^{*}\to\overline{D}^{0}l^{*}\nu_{l}\), which has a branching fraction of 2.27%. [6]

_Combined_ muons, i.e., muons with a reconstructed track both in the ID and in the MS, are used if they are found within a cone of radius of \(\Delta R=0.3\) around the jet direction. Their transverse momentum is required to be \(p_{\rm T}>5\) GeV and \(|\eta|<2.5\). Furthermore, the \(\chi^{2}/N_{\rm df}\) of the match between the track reconstructed in the ID and the MS must be less than 5. In order to avoid using isolated muons, the sum of the \(p_{\rm T}\) of tracks within a cone of radius 0.3 around the muon must be \(I_{\mu}=\Sigma p_{\rm T}/p_{\rm T}^{\mu}>0.05\).

## 4 Algorithm

The jet vertex charge algorithm uses basic tracking and jet kinematics information to construct three different jet charge variables, either inclusive or based on a SV and a TV inside the jet reconstructed with the JetFitter algorithm. A final discriminant is then constructed by means of a multivariate method.

### Jet Charge Variables

The simplest variable used to estimate the charge of a jet is the \(p_{\rm T}\)-weighted sum of the charges of the tracks associated to the jet:\[Q_{\rm jet}=\frac{\sum_{i\in{\rm Trk}}q_{i}\cdot p_{\rm T}^{\star}_{i}}{\sum_{j\in{ \rm Trk}}p_{j}\tau_{j}^{\star}} \tag{1}\]

where Trk is the set of tracks associated to the jet and \(q_{i}\) is the charge of track \(i\), while \(p_{\rm T}{}_{i}\) is its transverse momentum. \(\kappa\) is a free parameter tuned to maximise the separation power between the distribution of positive and negative \(b\)-jets. In the denominator the simple sum of the tracks \(p_{\rm T}\) is preferred to other normalisations, notably the jet transverse momentum, in order to avoid relying on the jet energy scale calibration.

Depending on the subset of tracks used, three different jet charges are defined:

* the jet charge \(Q_{\rm j}^{\rm all\,tracks}\), constructed using all reconstructed tracks associated to the jet;
* the jet charge \(Q_{\rm j}\), constructed using all selected tracks associated to the jet;
* the secondary vertex charge \(Q_{\rm SV}\), constructed using only the tracks associated to the SV;
* the tertiary vertex charge \(Q_{\rm TV}\), constructed using only the tracks associated to the TV.

Different definitions of the jet charge can be constructed using different weighting schemes. A straightforward variation is the use of \(p_{\rm T}^{\rm Rel}\) or \(p_{\rm T}^{\rm Long}\), the component of the momentum perpendicular to or along the jet axis, instead of the simple \(p_{\rm T}\). Both definitions have been tested with no noticeable difference, therefore the simple \(p_{\rm T}\) of the track is used as weight for the track charge.

The jet charge \(Q_{\rm j}\) variable is calculated using the tracks selected as explained in Section 3, and the optimal value of the \(\kappa\) parameter (as obtained by studying the separation power of the \(Q_{\rm j}\) variable for a number of different parameter values) was found to be \(\kappa=1.1\). The same value of the \(\kappa\) parameter is used for the computation of the \(Q_{\rm j}^{\rm all\,tracks}\) variable, which is used only when no other charge information is available.

Tracks used for the reconstruction of \(Q_{\rm SV}\) and \(Q_{\rm TV}\) are those refitted by the JetFitter vertex reconstruction and passing the fake track cleaning explained in Section 3. While for the computation of \(Q_{\rm SV}\) all selected vertices are used, the set of tracks used to compute the \(Q_{\rm TV}\) is further refined. If an odd number of tracks are associated to the TV, the lowest-\(p_{\rm T}\) track is ignored. This choice is motivated by the fact that, according to MC studies, the majority of \(c\)-hadrons that decay into the TV are \(D^{0}/\overline{D^{0}}\)4 and the decay topology of these mesons gives always an even number of prongs [6]. Removing these tracks results in a separation that is improved by a few percent (in terms of either negative \(b\)-jet rejection for a fixed positive \(b\)-jet efficiency, or positive \(b\)-jet efficiency for a given negative \(b\)-jet rejection). The values of \(\kappa\) for the \(Q_{\rm SV}\) and \(Q_{\rm TV}\) are chosen to be the same and equal to \(\kappa=0.7\). These values have been adjusted by a performance scan as a function of the \(\kappa\) parameter.

Footnote 4: The fraction of \(D^{0}/\overline{D^{0}}\) mesons corresponds to 55.2% of the total, followed by \(D^{\pm}\) (23.9 %), \(D^{\pm}_{s}\) (14.0 % ), \(\Lambda^{\pm}_{c}\) (4.3%). Other baryons contribute the remaining 2.6 %.

In Figure 1 the distributions of the basic charge variables are shown, for _truth b-jets_ with \(p_{\rm T}>\)20 GeV and \(|\eta|<2.5\) passing the JVT cleaning. The aforementioned jet (vertex) charge variables show regular distributions in the interval \((-1,+1)\) with a broad peak around 0. These smooth shapes are accompanied by spikes at the values of \(\pm 1\), populated by the jets in which the charge in question is computed using a single track, or a number of tracks with the same charge. This behaviour is negligible in the \(Q_{\rm j}^{\rm all\,tracks}\) variable.

Figure 1: Distributions of the basic charge variables, when they can be computed, for positive (full line) and negative (dashed line) truth \(b\)-jets, normalised to unity: \(Q_{\rm j}\) (1a), \(Q_{\rm j}^{\rm all\,tracks}\) (1b), \(Q_{\rm SV}\) (1c), \(Q_{\rm TV}\) (1d), and \(Q_{\mu}\) (1e). The peaks at values of \(\pm 1\) arise when all particles considered have the same charge.

### Soft Muon Charge

Semi-leptonic \(b\)-hadron decays are a source of valuable information; the charge of the lepton carries the same sign of the charge of the \(b\)-quark contained in the weakly decaying \(b\)-hadron, while the opposite happens if the muon comes from the subsequent \(c\)-hadron decay, i.e., the muon then carries the opposite charge of the aforementioned \(b\)-quark. Muons selected as described in Section 3 are used in this algorithm. If more than one muon is associated to the jet, only the muon with the highest \(p_{\rm T}\) is considered. The charge of the considered muon, \(Q_{\mu}\), is shown in Figure 0(e).

Understanding the origin of the muon is a crucial point; therefore additional variables are employed in order to identify the decay vertex that it originated from. These variables are the \(p_{\rm T}^{\rm Rel}\) and \(p_{\rm T}^{\rm Long}\) of the muons, which are the momentum of the muon perpendicular to and along the jet plus muon axis, respectively. Muons originating from \(b\)-hadron decays have a harder spectrum than muons originating from \(c\)-hadron decays. In addition, muons stemming from \(c\)-hadron decays tend to have a smaller \(\Delta R\) between the muon and the jet, due to the smaller \(c\)-hadron masses. In Figure 0(e), no distinction is made between the muons originating \(b\)- and \(c\)-hadrons, which results in the similar rates of the muons with the same and opposite charge.

### Multivariate Analysis

The basic charge variables described above, i.e. the jet charges, the jet vertex charges and the soft muon charge, are sensitive to the charge of the quark that triggered the jet formation but individually do not provide optimal discrimination. Jets initiated by \(b\) and \(\bar{b}\) quarks populate different regions in the phase-space of these variables. To best recognise these regions and separate them from one another, an MVA is employed.

The MVA optimisation has been performed on truth \(b\)-jets passing the selection described in Section 3. No \(b\)-tagging requirement has been imposed on the truth \(b\)-jets in order to keep the algorithm independent from any \(b\)-tagging algorithm. To keep the analogy of the jet charge sign and the numerical values of the MVA discriminators, \(\bar{b}(b)\)-initiated jets are considered signal (background) in the MVA trainings.

#### 4.3.1 Jet Categories and Training Configuration

To best exploit the available information, \(b\)-jets are grouped into eight exclusive categories according to the availability of the basic charge variables, as summarised in Table 1. The available charges are indicated by the subscript of the category names. The relative abundance of each category is shown further below in Section 5.2. For the categories \(\rm C_{j,\,\mu}\), \(\rm C_{j,\,\rm SV}\), \(\rm C_{j,\,\rm SV,\mu}\), \(\rm C_{j,\,\rm SV,\,TV}\), and \(\rm C_{j,\,\rm SV,\,TV,\mu}\), available information is combined in the corresponding MVA discriminator trained using the Multi-layer Perceptron (MLP) method implemented in the TMVA toolkit [20]. A single hidden layer network architecture has been used in all categories, with the number of hidden nodes varying as a function of the number of input variables used. For the categories \(\rm C_{j}\) and \(\rm C_{\rm SV}\), no significant improvement has been found in the efficiency region of interest from training a dedicated MLP containing the charge information and corresponding auxiliary variables. Thus, the discrimination between the positive and negative \(b\)-jets relies only on the charge information available in this category, i.e. the \(Q_{\rm j}\) and \(Q_{\rm SV}\) variables respectively. In the \(\rm C_{all\,tracks}\) category, the only available charge information, the \(Q_{\rm j}^{\rm all\,tracks}\) variable, is used.

To improve the performance of the MVA and to lessen the impact of the spikes in the input variables onto the shape of the MVA output, further variables are included in the machine learning procedure.

\begin{table}
\begin{tabular}{l|l l l l l} \hline \hline \multicolumn{1}{l|}{Category} & \multicolumn{1}{l}{\(Q_{\rm j}\)} & \multicolumn{1}{l}{\(Q_{\rm SV}\)} & \multicolumn{1}{l}{\(Q_{\rm TV}\)} & \multicolumn{1}{l}{\(Q_{\mu}\)} & \multicolumn{1}{l}{\(Q_{\rm j}^{\rm all\ tracks}\)} \\ \hline \(C_{\rm j}\) & \(\bullet\) & \(\circ\) & \(\circ\) & \(\circ\) & – \\ \(C_{\rm j,\mu}\) & \(\bullet\) & \(\circ\) & \(\circ\) & \(\bullet\) & – \\ \(C_{\rm SV}\) & \(\circ\) & \(\bullet\) & – & – & – \\ \(C_{\rm j,\,SV}\) & \(\bullet\) & \(\bullet\) & \(\circ\) & \(\circ\) & – \\ \(C_{\rm j,\,SV,\mu}\) & \(\bullet\) & \(\bullet\) & \(\circ\) & \(\bullet\) & – \\ \(C_{\rm j,\,SV,\,TV}\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\circ\) & – \\ \(C_{\rm j,\,SV,\,TV}\), \(\mu\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\circ\) & – \\ \(C_{\rm j,\,SV,\,TV,\mu}\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & – \\ \(C_{\rm all\,tracks}\) & \(\circ\) & \(\circ\) & – & – & \(\bullet\) \\ \hline \hline \end{tabular}
\end{table}
Table 1: Availability of basic charge variables per category. The meaning of the symbols is: \(\bullet\) variable is available, \(\circ\) variable is not available, – variable was not asked for.

\begin{table}
\begin{tabular}{l|l} \hline \hline \multicolumn{1}{l|}{Variable} & \multicolumn{1}{l}{Description} \\ \hline \(Q_{\rm j}\) & See Sec. 4.1 for a detailed explanation \\ \(Q_{\rm j}^{\rm all\,tracks}\) & See Sec. 4.1 for a detailed explanation \\ \(Q_{\rm SV}\) & See Sec. 4.1 for a detailed explanation \\ \(Q_{\rm TV}\) & See Sec. 4.1 for a detailed explanation \\ \(Q_{\mu}\) & Charge of the muon associated to the jet \\ \hline \(N_{\rm trk}(Q_{\rm j})\) & Number of tracks used to compute \(Q_{\rm j}\) \\ \(p_{\rm T}^{\rm trk}(Q_{\rm j})\) & \(p_{\rm T}\) of the hardest track used to compute \(Q_{\rm j}\) \\ \hline \(N_{\rm trk}(\rm SV)\) & Number of tracks in the SV \\ \(p_{\rm T}^{\rm trk}(\rm SV)\) & \(p_{\rm T}\) of the hardest track used to compute \(Q_{\rm SV}\) \\ \(L_{\rm 3D}\) (SV) & Distance between the SV and the PV along the jet-axis \\ \(\Delta L_{\rm 3D}\) (SV) & Error on the fitted SV position \\ \(m(\rm SV)\) & Invariant mass of the SV computed under the hypothesis that all the particles are pions \\ \hline \(N_{\rm trk}(\rm TV)\) & Number of tracks used to compute \(Q_{\rm TV}\) \\ \(L_{\rm 3D}\) (TV) & Distance between the TV and the PV along the jet-axis \\ \(\Delta L_{\rm 3D}\) (TV) & Error on the fitted TV position \\ \(m(\rm TV)\) & Invariant mass of the TV, computed under the hypothesis that the most \\  & energetic particle is a kaon and the remaining particles are pions \\ \hline \(p_{\rm T}^{\rm Rel}\) (\(\mu\)) & Muon momentum component orthogonal to the jet plus muon axis \\ \(p_{\rm T}^{\rm Long}\) (\(\mu\)) & Muon momentum component parallel to the jet plus muon axis \\ \(\Delta R(\mu,{\rm j})\) & \(\Delta R\) angle between the muon and the jet axes \\ \(I_{40}^{\rm VarPr}(\mu)\) & Track momentum sum contained in the \(p_{\rm T}\)-dependent cone of the maximal size of \\  & \(\Delta R=0.4\) around the muon \\ \hline \hline \end{tabular}
\end{table}
Table 2: List of the auxiliary variables and their description.

Variables describing the vertex reconstruction quality and the corresponding track multiplicity help the MVA to distinguish well reconstructed vertices from those that are poorly reconstructed, and thus give them a higher importance. Variables describing kinematics of the assigned muon help the MVA differentiate between same-sign and opposite-sign muon charge cases. These variables will be referred to as _auxiliary variables_ in the following.

Each basic charge variable is supported by a set of corresponding auxiliary variables. The \(Q_{\mathrm{j}}\) variable is accompanied by the number of tracks used in the computation, and the \(p_{\mathrm{T}}\) of the hardest track. The SV and TV are characterised by the multiplicities of associated tracks, the \(p_{\mathrm{T}}\) of the corresponding hardest track, as well as a number of variables arising from the JetFitter algorithm, such as the distance to the PV, the error on the vertex position, the \(\chi^{2}\) of the fit, and the invariant mass of the tracks associated to the vertex. The invariant mass of a SV has been computed under the hypothesis that all tracks stemming from it correspond to pions, while in case of a TV the most energetic track is assumed to originate from a kaon. The muon is described by its \(p_{\mathrm{T}}^{\mathrm{Rel}}\) and \(p_{\mathrm{T}}^{\mathrm{Long}}\) momentum components, and the \(\Delta R\) angle between the muon direction and the jet axis. A summary of all auxiliary variables, along with a brief description, can be found in Table 2. For each category, several MLP configurations have been tested using various sets of auxiliary variables. The configuration chosen is the one that ensured the best "quality" of training, defined as a low level of over-training (leading to variables being pruned until a performance loss is observed) while providing regular shapes of the MVA responses, as well as symmetry between the corresponding MVA distributions populated by positive and negative \(b\)-jets. Typically, in categories with fewer basic charges available, more auxiliary variables are needed to provide a good quality of the training. The full list of the variables used in each category is presented in Table 3.

Finally, the best available JVC discriminator, referred to as the _JVC weight w_, is constructed for each category, relying on a single variable in three categories and the corresp

\begin{table}
\begin{tabular}{l|c c c c c} \hline \hline  & C\({}_{\mathrm{j,\mu}}\) & C\({}_{\mathrm{j,SV}}\) & C\({}_{\mathrm{j,SV},\mu}\) & C\({}_{\mathrm{j,SV,TV}}\) & C\({}_{\mathrm{j,SV,\mu}}\) \\ \hline \(Q_{\mathrm{j}}\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \(N_{\mathrm{trk}}(Q_{\mathrm{j}})\) & \(\bullet\) & & & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \(p_{\mathrm{T}}^{\mathrm{trk}}(Q_{\mathrm{j}})\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \hline \(Q_{\mathrm{SV}}\) & & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \(N_{\mathrm{trk}}(\mathrm{SV})\) & & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \(p_{\mathrm{T}}^{\mathrm{trk}}(\mathrm{SV})\) & & \(\bullet\) & & \(\bullet\) & \\ \(L_{\mathrm{3D}}\) (SV) & & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \(\Delta L_{\mathrm{3D}}\) (SV) & & \(\bullet\) & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \(m(\mathrm{SV})\) & & & & \(\bullet\) & \\ \hline \(Q_{\mathrm{TV}}\) & & & & \(\bullet\) & \(\bullet\) \\ \(N_{\mathrm{trk}}(\mathrm{TV})\) & & & & \(\bullet\) & \(\bullet\) \\ \(L_{\mathrm{3D}}\) (TV) & & & & \(\bullet\) & \(\bullet\) \\ \(\Delta L_{\mathrm{3D}}\) (TV) & & & & \(\bullet\) & \(\bullet\) \\ \(m(\mathrm{TV})\) & & & & \(\bullet\) & \(\bullet\) \\ \hline \(Q_{\mathrm{\mu}}\) & \(\bullet\) & \(\bullet\) & & \(\bullet\) & \(\bullet\) \\ \(p_{\mathrm{T}}^{\mathrm{Rel}}\) (\(\mu\)) & \(\bullet\) & & \(\bullet\) & \(\bullet\) & \(\bullet\) \\ \(p_{\mathrm{T}}^{\mathrm{Long}}\) (\(\mu\)) & \(\bullet\) & & & \(\bullet\) & \(\bullet\) \\ \(\Delta R(\mu,\mathrm{j})\) & \(\bullet\) & & & & \\ \(I_{\mathrm{40}}^{\mathrm{var}_{\mathrm{T}}}(\mu)\) & \(\bullet\) & & & & \\ \hline \hline \end{tabular}
\end{table}
Table 3: List of input variables (as detailed in Table 2) used in each MVA category. The definitions of the categories correspond to those in Table 1. For the explanation of the variable definitions see the main text of this section.

the other five categories. The JVC weight distributions normalised to unity are shown in Figure 2 for all eight categories. The plots show the overlaid distributions for the positive (solid line) and negative (dashed line) \(b\)-jets. Different ranges of the JVC discriminator across the categories is due to different MLP settings.

### Combining the Categories

Given the different shapes of the JVC discriminators across the categories, a given JVC weight value \(w\) corresponds to different positive \(b\)-jet efficiency and the negative \(b\)-jet rejection depending on the category to which the jet in question belongs. Thus, a more general discriminator with a unique interpretation across the full spectrum of its values is constructed.

For each separate given category, the JVC weight distributions for positive \(b\)-jets, \(\bar{b}(w)\), and for negative \(b\)-jets, \(b(w)\), are normalised to unity. For a given jet with a jet vertex charge \(w\), the logarithm of the likelihood ratio \(\lambda_{\text{JVC}}(w)\equiv\ln\left(b(w)/\bar{b}(w)\right)\) is used, as the variable offering the best discrimination between positive and negative \(b\)-jets.

The \(\lambda_{\text{JVC}}\) distribution for all categories combined is presented in Figure 3.

## 5 Performance

The performance of the final \(\lambda_{\text{JVC}}\) discriminant is evaluated in terms of the negative \(b\)-jet (background) rejection as a function of the positive \(b\)-jet (signal) efficiency for the sample containing all categories combined. The background rejection is defined as (\(1-\) background efficiency); if a negative (positive) \(b\)-jet is identified to be the result of \(B\)-meson mixing, in the following it is considered as a positive (negative) \(b\)-jet. Discrimination power curves based on the final \(\lambda_{\text{JVC}}\) discriminant for all individual categories are compared to each other in Figure 3(a). The overall improvement of the \(b\)-jet charge reconstruction is illustrated in Figure 3(b), where the separation power of the final JVC discriminant is compared to that of the \(Q_{j}\) variable. This figure shows that for a given signal efficiency in the range 50-80%, the background rejection improves by \(\sim\) 6-8%.

Since the inputs used in the construction of the final JVC discriminant rely on quantities that have a substantial dependence on the jet kinematics, it is to be expected that this dependence is also reflected in the JVC performance. A study of the JVC performance in different kinematic regimes is presented in Section 5.1. Furthermore, the information exploited in the JVC reconstruction overlaps to some extent with that used in the \(b\)-tagging algorithms, so that the JVC performance is expected to depend upon the \(b\)-tagging requirement. These effects are studied in Section 5.2.

### Jet Kinematics

Variables such as multiplicities and momenta of tracks and muons produced within a jet are rather correlated to its transverse momentum. The track momentum then affects the track charge reconstruction efficiency, which significantly drops at high transverse momentum. On the other hand, jets with a direction close to the edge of the angular acceptance of the inner detector are likely to lose some tracks due to the acceptance loss, which also affects the JVC performance. These effects are demonstrated in the plots in Figure 5, which show the JVC separation power curves split in intervals of \(p_{\text{T}}\) and \(\eta\) of the jet. The figures show that the JVC algorithm performs better for lower jet \(p_{\text{T}}\) (up to 250 GeV). Above 250 GeV, the separation power weakens significantly. As a function of \(\eta\), the performance is rather stable up to \(|\eta|<2.1\), above which it slowly deteriorates, following the degradation of the track reconstruction performance in the forward region.

Figure 2: JVC weight distributions normalised to unity for \(b\)- (dashed lines) and \(\bar{b}\)-jets (solid lines) for the categories: \(\rm C_{all\,tracks}\) (2a); \(\rm C_{j}\) (2b); \(\rm C_{SV}\) (2c); \(\rm C_{j,\,\mu}\) (2d); \(\rm C_{j,SV}\) (2e); \(\rm C_{j,SV,\,\mu}\) (2f); \(\rm C_{j,SV,\,TV}\) (2g); \(\rm C_{j,SV,\,TV}\) (2h).

Figure 4: Performance comparison between different categories (4a), and a comparison of the separation power based on the \(Q_{\rm j}\) variable and the \(\lambda_{\rm JVC}\) discriminant for all categories with a reconstructed \(Q_{\rm j}\) (4b). In the latter figure, the kinks in the \(Q_{\rm j}\) curve are due to jets with a reconstructed \(Q_{\rm j}=\pm 1\).

Figure 5: Background rejection curves for all categories combined decomposed in intervals of jet \(p_{\rm T}\) (5a) and \(|\eta|\) (5b).

Figure 3: \(\lambda_{\rm JVC}\) distributions normalised to unity for positive (solid line) and negative (dashed line) truth \(b\)-jets. The irregular features reflect the binning used for the input JVC weight distributions.

### \(b\)-tagging Working Points

The interplay of the JVC algorithm and \(b\)-tagging has been studied by evaluating the JVC performance with and without requirements on the \(b\)-tagging weight provided by the MV2c20 algorithm [21]. Notably, \(b\)-tagging affects the relative abundance of the \(b\)-jet categories, as shown in Table 4. The fraction of \(b\)-jets not containing displaced vertices decreases noticeably as the \(b\)-tagging requirement is tightened. In Table 5, the efficiencies of selecting the positively charged, and rejecting the negatively charged truth \(b\)-jets are presented for a range of representative requirements on the JVC discriminant. The numbers are obtained using the samples of untagged \(b\)-jets as well as those tagged using requirements (working points) on the MV2c20 discriminant yielding truth \(b\)-jet tagging efficiencies of 85%, 77%, 70%, and 60%. It is seen that for a loose requirement \(\lambda_{\mathrm{JVC}}>0\), both the positive \(b\)-jet efficiency and the negative \(b\)-jet rejection improve by \(\sim 1\%\) by the use of the 70% MV2c20 working point.

## 6 Conclusions

A new algorithm for inferring the charge of \(b\)-jets called the jet vertex charge algorithm has been developed. The algorithm relies on the reconstructed jets, inner detector tracks assigned to the jet and to the displaced vertices found within it, as well as the associated combined muons. Using these objects, five basic charges are reconstructed: two jet charges computed using selected or non-selected tracks, a secondary and a tertiary vertex charge computed using the tracks associated to the respective vertices,

\begin{table}
\begin{tabular}{l|r r r r r} \hline \hline Category & Untagged & 85\% eff. & 77\% eff. & 70\% eff. & 60\% eff. \\ \hline \(\mathrm{C_{j}}\) & 11\% & 4.4\% & 2.8\% & 2.2\% & 1.6\% \\ \(\mathrm{C_{j,\mu}}\) & 2.0\% & 0.95\% & 0.62\% & 0.49\% & 0.33\% \\ \(\mathrm{C_{SV}}\) & 3.0\% & 3.3\% & 3.3\% & 3.2\% & 3.1\% \\ \(\mathrm{C_{j,\,SV}}\) & 53\% & 58\% & 58\% & 58\% & 57\% \\ \(\mathrm{C_{j,\,SV,\,\mu}}\) & 10\% & 11\% & 11\% & 11\% & 11\% \\ \(\mathrm{C_{j,\,SV,\,TV}}\) & 15\% & 18\% & 19\% & 20\% & 22\% \\ \(\mathrm{C_{j,\,SV,\,TV,\,\mu}}\) & 3.5\% & 4.1\% & 4.4\% & 4.6\% & 5.0\% \\ \(\mathrm{Call\,tracks}\) & 1.3\% & 0.71\% & 0.49\% & 0.38\% & 0.28\% \\ \hline \hline \end{tabular}
\end{table}
Table 4: Relative abundance per category measured on the sample of simulated \(t\bar{t}\) events at \(\sqrt{s}=13\) \(\mathrm{Te\kern-1.0ptV}\) as a function of the MV2c20 working points. Only truth \(b\)-jets with \(p_{\mathrm{T}}>20\)\(\mathrm{Ge\kern-1.0ptV}\) and \(|\eta|<2.5\) and passing the JVT requirement are considered. For category definitions see Table 1.

\begin{table}
\begin{tabular}{l|r r|r r|r r|r r|r r} \hline \hline Tag configuration & \multicolumn{2}{c}{\(\lambda_{\mathrm{JVC}}>-0.3\)} & \multicolumn{2}{c}{\(\lambda_{\mathrm{JVC}}>-0.1\)} & \multicolumn{2}{c}{\(\lambda_{\mathrm{JVC}}>0\)} & \multicolumn{2}{c}{\(\lambda_{\mathrm{JVC}}>0.1\)} & \multicolumn{2}{c}{\(\lambda_{\mathrm{JVC}}>0.3\)} \\  & \(b\) eff. & \(b\) ref. & \(b\) ref. & \(b\) ref. & \(b\) ref. & \(b\) ref. & \(b\) ref. & \(b\) ref. & \(b\) ref. & \(b\) ref. \\ \hline Untagged & 78.1\% & 46.7\% & 68.4\% & 58.4\% & 63.3\% & 63.8\% & 59.6\% & 68.2\% & 47.1\% & 77.8\% \\ MV2c20 at 85\% & 78.1\% & 47.8\% & 68.7\% & 59.3\% & 63.9\% & 64.3\% & 59.4\% & 68.6\% & 48.1\% & 77.8\% \\ MV2c20 at 77\% & 78.2\% & 48.3\% & 68.9\% & 59.6\% & 64.2\% & 64.5\% & 59.8\% & 68.8\% & 48.6\% & 77.9\% \\ MV2c20 at 70\% & 78.2\% & 48.7\% & 69.1\% & 59.9\% & 64.5\% & 64.8\% & 60.1\% & 68.9\% & 49.1\% & 78.0\% \\ MV2c20 at 60\% & 78.3\% & 49.5\% & 69.3\% & 60.4\% & 64.8\% & 65.2\% & 60.5\% & 69.2\% & 49.7\% & 78.1\% \\ \hline \hline \end{tabular}
\end{table}
Table 5: Signal efficiencies and background rejection for representative requirements on the \(\lambda_{\mathrm{JVC}}\) discriminant obtained using the untagged truth \(b\)-jets, as well as those tagged at various working points of the MV2c20 \(b\)-tagging algorithm.

and the charge of the muon. Jets are categorised according to the availability of these basic charges, resulting in three categories relying on single variables for the discrimination between positively and negatively charged \(b\)-jets, as well as five further categories based on MLP discriminants. All categories are combined by providing a likelihood ratio based discriminant, with a universal interpretation for all categories. The final discriminant can be calibrated with the early LHC Run-2 data at 13 TeV, exploiting a kinematic reconstruction of \(t\bar{t}\) candidate events. This variable can be particularly useful to reduce the combinatorial background in analyses with a high \(b\)-jet multiplicity.

## References

* [1] R.D. Field and R.P. Feynman, _A parametrization of the properties of quark jets_, Nucl. Phys. B **136** (1978) 1-76.
* [2] ATLAS Collaboration, _Jet Charge Studies with the ATLAS Detector Using \(\sqrt{s}=8\) TeV Proton-Proton Collision Data_, ATLAS-CONF-2013-086, 2013. [https://cds.cern.ch/record/1572980](https://cds.cern.ch/record/1572980).
* [3] ATLAS Collaboration, _Measurement of jet charge in dijet events from \(\sqrt{s}\) =8 TeV pp collisions with the ATLAS detector_, ATLAS-CONF-2015-025, 2015. [https://cdsweb.cern.ch/record/2037618](https://cdsweb.cern.ch/record/2037618).
* [4] ATLAS Collaboration, _Flavor tagged time-dependent angular analysis of the \(B_{s}\to J/\psi\phi\) decay and extraction of \(\Delta\Gamma_{s}\) and the weak phase \(\phi_{s}\) in ATLAS_, Phys. Rev. **D90** (2014) 052007, arXiv:1407.1796 [hep-ex].
* [5] ATLAS Collaboration, _Measurement of the top quark charge in pp collisions at \(\sqrt{s}\) = 7 TeV with the ATLAS detector_, JHEP **1311** (2013) 031, arXiv:1307.4568 [hep-ex].
* [6] Particle Data Group Collaboration, K.A. Olive et al., _Review of Particle Physics_, Chin.Phys. **C38** (2014) 090001.
* [7] G. Piacquadio and C. Weiser, _A new inclusive secondary vertex algorithm for b-jet tagging in ATLAS_, J.Phys.Conf.Ser. **119** (2008) 032032.
* [8] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003.
* [9] L. Evans and P. Bryant, _LHC Machine_, JINST **3** (2008) S08001.
* [10] ATLAS Collaboration, _ATLAS Insertable B-Layer Technical Design Report_,. [https://cdsweb.cern.ch/record/1291633](https://cdsweb.cern.ch/record/1291633).
* [11] P. Nason, _A New method for combining NLO QCD with shower Monte Carlo algorithms_, JHEP **11** (2004) 040, arXiv:hep-ph/0409146.
* [12] T. Sjostrand, S. Mrenna, and P.Z. Skands, _PYTHIA 6.4 Physics and Manual_, JHEP **05** (2006) 026, arXiv:hep-ph/0603175 [hep-ph].
* [13] D. Lange, _The EvtGen particle decay simulation package_, Nucl. Instrum. Meth. **A462** (2001) 152-155.
* [14] T. Sjostrand, S. Mrenna, and P.Z. Skands, _A Brief Introduction to PYTHIA 8.1_, Comput. Phys. Commun. **178** (2008) 852-867, arXiv:0710.3820 [hep-ph].
* [15] GEANT4 Collaboration, S. Agostinelli et al., _Geant4: A simulation toolkit_, Nucl. Instrum. Meth. **A506** (2003) 250-303. [http://geant4.web.cern.ch/geant4/](http://geant4.web.cern.ch/geant4/).
* [16] ATLAS Collaboration, _The ATLAS Simulation Infrastructure_, Eur. Phys. J. **C70** (2010) 823-874, arXiv:1005.4568 [physics.ins-det].