# A Fast Active Linear Gate for Experiments in Nuclear and Particle Physics

Augusto S. Cerqueira, Jose Manoel de Seixas, Luiz P. Caloba

###### Abstract

This paper presents an active linear gate that is able to transmit fast pulses with minimum distortion. The gate exhibits switching times better than 3 nanoseconds, null pedestal and a feedthrough of 0.3%. In the field of experimental high-energy physics, the gate was successfully used in measuring the speed response of a fast scintillating calorimeter.

 linear gate, serial switch, calorimeters, charge collection time

## I Introduction

A linear gate should transmit a pulse with minimum distortion when a gate control signal is present at the gating input [1]. When the gate control signal is active and there is no input signal to be transmitted, the linear gate should exhibit a minimum shift in the output voltage, which is called pedestal. Also, when the gate is inactive because of the absence of the gating pulse, there should be as small as possible amount of transmission, or feedthrough, of the input pulse. These operation requirements can become quite demanding when high-performance is needed and the pulse to be gated is reasonably fast. In such circumstances, fast switching times and low transient distortions represent additional requirements for the linear gate design.

In this paper, a DC coupled fast active linear gate is presented. It aims at gating fast signals with minimum feedthrough and null pedestal effect. Based on wideband transistors and providing DC stabilization, the gate achieves high-performance with very fast switching times. The paper also describes a practical application of the proposed linear gate circuit in the field of high-energy physics. For this, experimental data are used to evaluate the speed response of a calorimeter (energy measurement). The linear gate cuts the signal in slices and allows to measure the charge collection time for the detector.

The next section describes in details the proposed circuit. Section 3 shows results from simulation and measurements in the lab, which characterize the performance of the circuit. Section 4 discusses such application of the linear gate in the field of high energy physics. Finally, Section 5 derives some conclusions

## II The Active Linear Gate

The linear gates may be seen as serial or parallel switches (or even a combination of both), where the gating pulse controls the conduction state of the switch. Problems may arise in practice due to imperfections of the switches. When the gating pulse is present but there is no input signal to be transmitted, the gate may produce a pedestal and possibly some transients, when the gate is turned on and off. When both input and gating pulses are present, the output signal will be the input signal superimposed on this pedestal and with possible additional distortions introduced by the linear gate. On the other hand, in the off condition of the gate, the finite ratio of on-to-off conductance of the active switch results on some signal feedthrough, in the case a signal arrives to the gate input. Finally, the switching time of the linear gate imposes additional constraints on the speed of the input signals to be transmitted through the gate. These malfunctions of the linear gate have been faced by different design approaches [2].

### _Proposed Linear Gate_

The block diagram of the proposed linear gate is shown in Fig. 1. The linear gate is fed from the analog input signal \(V_{S}\). This signal passes through a voltage-to-current converter, the fast signal amplifier, and through the switching circuit, which is commanded by the control switching circuit. This part of the circuit will control the state of the gate by means of the logic pulse \(V_{C}\). At the gate output \(O\), the resulting signal may be a replica of the input signal \(V_{S}\) or just a slice of it, according to the gating pulse \(V_{C}\).

The circuit diagram is shown in Fig. 2. The circuit acts as a DC coupled serial switch. The supply voltages are +24, +/-12 and +6 Volts. The circuit provides two fully complementary outputs (out1 and out2), and both input and output nodes are 50 \(\Omega\) matched. The biasing circuit is formed by two current sources (T7 and T8), and when an input signal is applied to the gate, the corresponding pulse current is transmitted to the output stage. The gating signal controls to which output node the gated signal will be transmitted. DC stabilization is achieved by means of a feedback loop controlled by a general-purpose operational amplifier (OP1).

The circuit input stage is a current-voltage converter. It is composed by an emitter follower (T1) and a common base transistor (T2). The emitter follower has a voltage gain close

Fig. 1: The block diagram of the proposed linear gate.

to one; therefore, on the T1 emitter we should have \(\approx V_{I\,N}\). The current on the collector of T2 is \(\approx V_{I\,N}/R_{2}\), as T2 acts as a current buffer. Finally, the emitter follower configuration has high input impedance, showing good stability for variations of \(V_{BE}\) with the temperature.

The switching circuit (Fig. 3) comprises four transistors (T3, T4, T5 and T6), which act as a serial switch for the signal. Depending on the voltage level of \(A\) (the base of transistors T3 and T6), T4 and T5 or T3 and T6 are cut off. When T4 and T5 are conducting, the signal from T2 is present on the output 2 and there is no signal on the output 1 because T3 is off. The transistor T5, in the conducting state, keeps a zero DC level at output 1. When T4 and T5 are off, T3 and T5 begin to conduct and the signal from T2 is present at output 1. Zero DC level of the output 2 is kept by T6 that is in the conducting state.

The switching control circuit controls the voltage level of \(A\) and \(A^{\prime}\). In this way, it controls the conduction state of the switching circuit depending on the gate control signal \(V_{c}\) applied at its input. The gate control signal should be a logic pulse with two levels, 0 and -0.7 V. When the gate control signal is 0 V, only \(T_{A^{\prime}}\) is conducting and \(|V_{A}-V_{A^{\prime}}|\) commutes the state of the transistors (T3, T4, T5 and T6). When the control signal is -0.7 V, both transistors (\(T_{A}\) and \(T_{A^{\prime}}\)) are in the conducting state, and \(|V_{A}-V_{A^{\prime}}|\) will change to \(\approx\) 0 V, commuting again the transistors of the switching circuit. The potentiometer P6 adjusts the limits of \(V_{A}\) and \(V_{A^{\prime}}\) to \(0.16<|V_{A}-V_{A^{\prime}}|<0.8\). Thus, P6 adjusts the amplitude of the transient and the circuit feedtrough. In addition, P5 acts on the transient amplitude.

The proposed linear gate has a DC stabilization system to avoid variations on the DC voltage level of the output node in consequence of temperature fluctuations. The idea is to compare both input and output DC levels and produce a negative feedback to correct any difference. This is implemented by using the operational amplifier shown in the Fig. 4. The input and output signals of the linear gate are compared and the amplified difference appears at the output of the op amp. This difference controls the current source used by the transistors T3 and T4 of the switching circuit.If a small increase of the

Fig. 3: The switching circuit.

Fig. 2: The linear gate circuit.

DC level occurs at the output 1, caused by a variation of the temperature, the op amp increases the voltage level of \(B\) (see Figure 2), decreasing the current furnished by the current source to T3 and T4 and so decreasing the DC voltage level of output 1.

Wideband transistors1 are used at the signal path of both input and output stages and at the switching circuit, in order to provide good signal transmission and fast switching capacity. General purpose transistors and opamps are used in the biasing and DC stabilization circuit.

Footnote 1: BFQ23 (PNP) and BFR96S (NPN) were used during the experimental tests.

The maximum input voltage swing expected is 300 mV for an unitary gain. A number of adjustments are provided by the circuit in order to optimize the main parameters of the linear gate in a given application. The potentiometers P6 and P5 adjust the switching time, the feedthrough and the transient, P3 adjusts the pedestal, P1 sets the zero level for the input, P2 and P4 adjust for any op amp offset and P7 allows to optimize the low frequency response (tilt) of the gate.

## III Circuit Performance from Simulation and Lab Tests

### _Simulation Tests_

The simulation of the proposed circuit was performed using a SPICE like simulator. After performing the required adjustments, the main parameters of the proposed linear gate were obtained, as shown in Table I. As it can be seen from this table, it was achieved a null pedestal effect, low feedthrough and fast switching time. The frequency response was measured to be from DC up to 200 MHz, for a 3 dB cutoff frequency. For all simulations, the gate pulse was obtained from a block pulse with 0.7 V amplitude, having null DC level, and 1 nanosecond rise and fall times.

The input pulse was formed by combining two exponentials, one with +5 nanosecond time constant and lasting for 10 nanoseconds, and another with -10 nanosecond time constant starting at the end of the first exponential. This input pulse simulated reasonably well the actual pulse shape of the target application in calorimetry (see next section).

### _Experimental Tests_

The circuit was also tested in the laboratory. A pulse generator2 was used to provide both the gate and the input pulses. The gating pulse was a block having 20 nanosecond rise and fall times and variable width (see Fig. 5).

Footnote 2: HP 8012A Pulse Generator.

After adjustments, the main features of the circuit were measured (see Table I). Good signal transmission was achieved for an input pulse with a voltage swing of 300 mV, 2 ns rise and fall times and 50 ns width. Both input and output pulses can be seen at Fig. 5, for a gate signal of 90 ns duration. The distortion occurred at the output before the pulse beginning was caused by the gate pulse used, and the duration of this distortion corresponds to the rise time of the gate pulse. The rise and fall times of the gate control signal should be faster to avoid such effect. Fig. 6 shows the switching time effect when a gate signal of 200 ns duration is used to control the gate.

It can be seen from Table 1 that for most of the parameters the lab measurements perfectly agree with simulation. The

Fig. 4: The DC stabilization circuit.

Fig. 5: Signal transmission through the gate. From the top to the boton are shown the input signal, the gate output and the gate control signal. Amplitudes are in Volts and time is in seconds.

differences, which were noticed in the transient response and feedthrough, result from the slower rise and fall time features of the gating pulse that was used in the lab, with respect to simulation.

## IV Application in High-Energy Physics

Linear gates have been used for detector measurements and analog signal processing in experimental high-energy physics and nuclear physics, as it is shown in [3]. In this section, the application of the proposed linear gate to the measurement of the charge collection time of a hadronic calorimeter is described.

The LHC (Large Hadron Collider), the new generation collider machine that is currently being constructed at CERN (European Laboratory for Particle Physics, Switzerland), aims at probing deeper into matter than ever before [4]. Planned to become operational by the year 2007, LHC will collide a bunch of protons at an energy of 14 TeV and at periods of 25 nanoseconds. This means that LHC can be considered as a harsh environment for detectors. In this field, in order to avoid pile-up effects in the measurements, the collider experiments typically require fast signal features of the detectors, which are used to readout electronically the resulting reactions.

Among detectors, calorimeters will play a major role at LHC. These highly segmented detectors are used to measure the energy of the incoming particles by total absorption [5]. Typically, calorimeter designs are optimized for a specific class of particles. Thus, electromagnetic calorimeters are specialized to measure the energy of electrons, for instance, whereas hadronic calorimeters deal with hadronic interactions. The application to be described here refers to a hadronic calorimeter that is being designed for the LHC experiment, the so called Tilecal (Tile calorimeter) [6]. Tilecal is the hadronic calorimeter of ATLAS [7], one of the LHC main detectors.

The Tile Calorimeter [8] makes use of steel as absorber material and samples the absorbed energy of the incoming particles by means of scintillating plates (tiles), which are readout by wavelength shifting fibers (WLS). It consists of a cylindrical structure divided into 64 modules, and on the longitudinal direction it is further divided into three parts: the central one, called the barrel, and two extended barrels (see Fig. 7).

The optical fibers guide the light from the scintillating tiles up to the bottom of the module, where the signal is converted to electrical current by means of a photomultiplier tube. Both free sides of the tiles are readout (see Fig. 8). Each barrel module comprises 45 cells while the extended barrel comprises 16 cells. Fig. 9 shows the cell geometry for half of the barrel module and the corresponding extended barrel. In this figure, the three sampling layers of the barrel module are labeled as A, BC and D (D0 cell spans \(\eta\) range from -0.1 to 0.1), and for the extended barrel they are labeled as A, B and D.

The application concerns an on-line measurement of the signal speed of the detector. Due to the speed requirements at LHC, it is important to know how much energy is collected by the calorimeter for a given gate width of the data acquisition (DAQ) system. This can be extracted from a curve that displays

Fig. 8: Detection concept of Tilecal.

Fig. 6: Circuit transients (when the control signal activates the gate and there is no signal to be gated). The amplitude is in Volts and the time is in seconds.

Fig. 7: The Tile Calorimeter.

Fig. 9: The cell geometry of the Tilecal.

the fraction of the charge collected by the detector as a function of time.

For beam tests of the calorimeter prototypes, typical acquisition gate widths amount to 400 nanoseconds, when data are readout by means of charge A-D converters. These converters open up a gate of controlled duration and integrate the calorimeter signal along the duration of the gate control signal [2]. The resulting charge measured is then linearly converted into a digital value which is stored on tape by the DAQ system. Therefore, one possible way to perform the on-line measurement of the charge collection time is to combine linearly a number of cells of the calorimeter, readout this resulting signal by a charge ADC, and continually reduce the gate width of such ADC, in order to have the calorimeter signal cut into slices and the resulting charge values readout by the charge ADC [9]. However, the pedestal noise introduced by the ADC may vary significantly as the gate width is reduced, so that the resulting distortions in the acquired signals may degrade the resolution of the measurement.

The charge collection time can alternatively be obtained from a linear gate, which improves measurement accuracy. One can keep constant the gate width of the ADC that will readout the gated output signal (say, at 400 nanoseconds) and produce slices of the signal with minimum distortion and at programmable time durations, according to the gate control signal. In this way, the ADC can work at nominal conditions and the linear gate simply transmits to its output the desired fraction of the signal that results from the linear combination of calorimeter cells.

### _Offline Analysis_

Experimental data were used to evaluate the capability of the proposed linear gate in measuring the charge curve. Data were acquired from the setup shown in Fig. 10. For this, five modules of a previous generation prototypes were put together and the particle beam was focused to hit the central module. Beam chambers (BC1-2) were used to define accurately the beam line and scintillating counters (S1-3) helped in rejecting undesired cosmic ray interactions with the detector. Outsider muons in the beam were also rejected from a muon wall detector. A fast signal adder [10] was used to combine linearly 40 cell signals produced by the central module and the resulting signal was digitized by a digital storage oscilloscope (DSO)3. Data comprised pion beams of 100 GeV.

Footnote 3: TEK TDS 520, 500 MHz bandwidth, 2 nanosecond sampling period.

The curve of the charge collection time for the Tilecal was previously obtained offline by means of a numerical integration of such calorimeter signals [11]. In order to check the feasibility of an on-line measurement using the proposed linear gate, an offline analysis was first performed on the digitized calorimeter pulses. The simulation model of the linear gate circuit was used to process an average signal that was formed from hundreds of digitized signals. Due to time jitters on the calorimeter signals and as the time resolution of the DSO was not enough to enable good offline time alignment, the original digitized pulses were linearly interpolated and the resulting signals were fed into a low pass digital filter that was maximally flat in the passing band (Butterworth) [12]. This filter had a cutoff frequency of 125 MHz, in order to cope with the signal bandwidth of the DSO.

After being interpolated, pulses were time aligned by means of their discrete derivative. The time alignment of pulses allowed to obtain the desired average pulse, which was then fed into the input node of the linear gate for simulation. This pulse was gated for different time duration values and the output of the gate was then numerically integrated in order to obtain the charge curve of the detector. To evaluate the accuracy of the linear gate, the charge curve was also obtained by direct numerical integration of the averaged pulse. The results are shown in Table II. As it can be seen from this table, the agreement between the two methods was better than 1% and this result also agreed with the previous work [11].

Fig. 10: The experimental setup.

### _On-line Measurement_

The on-line measurement of the charge collection curve for Tilecal was performed with a last generation prototype, which includes upgrades on the mechanical, optical and electrical parts of the detector, with respect to the prototypes used in the offline analysis.

The resulting calorimeter pulse shape is observed to be different from the one previously used for the offline analysis, due to changes in the shaper design [13]. The actual pulse shape for on-line measurements (one calorimeter cell) can be seen in Fig. 11. This pulse has \(\approx\) 25 ns rise and fall times and 50 ns FWHM (full width half maximum). The charge collection curve for this typical signal was obtained from numerical integration and can be seen in Fig. 12, which shows that 90% of the charge is retained in less than 100 ns.

The calorimeter setup used for the on-line measurement with the linear gate is shown in Fig. 13. A barrel module was surrounded by the five prototype modules previously used (Fig. 10), in order to minimize energy leakage. Trigger tower signals [14] from the barrel module were used. These signals are formed by adding, in \(\eta\) direction (particle incident angle), the energy deposited in calorimeter cells along the three sampling layers of the detector. The trigger towers are shown in Fig. 9, in which both barrel and extended barrel sections can be seen. A specific active adder [15] is used for building each trigger tower signal.

The calorimeter signals were sent out from the electronics drawer [8] by coaxial cables and were acquired by 10-bit charge ADCs4[16] located 50 m away from the calorimeter, in the control room.

Footnote 4: 2280 System from Lecroy Coorporation

We profited from 3 trigger tower signals (each one resulting from the sum of five cell signals in \(\eta\) direction), which were added by means of an external high performance adder [10]. In this way, the charge collection time could be measured from the summation of 15 calorimeter signals. Thus, using a 100 GeV pion beam for the measurement, almost the entire energy being deposited in the detection could be sampled. The output of the external adder was fed into the linear gate and its output connected to a charge ADC. The gate control signal was provided by a pulse generator5 triggered by a coincidence signal provided by the calorimeter triggering system. The complete setup can be seen in Fig. 14.

Footnote 5: HP8012A Pulse Generator

About 10,000 pions were acquired. They were hitting the trigger tower located in the middle of the three ones combined

Fig. 11: Calorimeter pulse shape.

Fig. 12: Charge collection curve for a single calorimeter cell measured by numerical integration.

Fig. 13: Calorimeter setup for on-line measurements.

by the external adder. Five gate widths were selected for data acquisition by varying the pulse width of the generator. Thus, about 2000 events were acquired per gate width.

Results are shown in Table III and the measured charge collection curve is plot in Fig. 15. From this measurement, 94 % of the signal charge is retained before 120 ns. It can be observed that the charge collected time measured on-line was slower than the one shown in Fig. 12. This can be explained by the the fact that Fig. 12 considers only one calorimeter signal, while the on-line procedure treated a combination of 15 calorimeter signals. Thus, pion signal development is sampled in more details in this case, revealing better well known slower signal components [17].

## V Conclusions

A fast active linear gate design was presented. Simulation and laboratory measurements shown that the proposed circuit has very good signal transmission, a switching time of 3.3 ns, symmetrical transients of 15 mV pp, feedthrough smaller than 0.3%, and null pedestal effect.

In order to evaluate the application of such circuit in the measurement of the signal speed of a high-energy calorimeter, experimental data were used to obtain an evaluation of the charge collection time of the Tilecal detector. The linear gate proved to work well for this purpose.

As a result of such studies, the linear gate circuit was installed in an experimental setup for an on-line measurement of the charge collection time of the Tilecal detector. Particle beams of 100 GeV were sent to the calorimeter and a linear combination of cells was processed by the linear gate. The results for the Tilecal module shown that 94% of the charge is retained in less than 120 ns of the pulse.

## Acknowledgments

We are thankful to the financial support that has been provided by CAPES, CNPq, FAPERJ (Brazil), and CERN (Switzerland) to this work. We also thank the Tilecal Collaboration at CERN for providing the data sets used in this work and to make possible the arrangement of the experimental setup.

## References

* [1] P. W. Nicholson, _Nuclear Electronics_. John Willey & Sons, 1974.
* [2] W. R. Leo, _Techniques for Nuclear and Particle Physics Experiments_. John Willey & Sons, 1974.
* [3] L. Busso, A. Feliciello, S. Marcello, O. Mera, and A. Ponlarsa, "A linear gate and transmitter for improving localization using the charge division method," _Nuclear Instruments and Methods Res_, vol. A, no. 485, pp. 640-644, 2002.
* [4] L. Smith and C. Hubert, "Lhc project overview," in _International Symposium on LHC Physics and Detectors_, Dubna, Russia, July 1995, pp. 15-66.
* [5] R. Wigmans, "Sampling calorimetry," _Nuclear Instruments and Methods Res_, vol. A, no. 494, pp. 277-287, 2002.
* [6] F. Arnirizabal et al, "Construction and performance of an iron-scintillator hadron calorimeter with longitudinal tile configuration," _Nuclear Instruments and Methods Res_, vol. A, no. 349, pp. 384-397, 1994.
* [7] P. Jenni, "The lhc project and the atlas experiment," in _International Conference on Physics Since Purity Symmetry Breaking_, Nanjing, China, 1997, pp. 331-341.
* [8] ATLAS/Tile calorimeter "Collaboration," Tile calorimeter technical design report," CERN, Technical Design Report LHCC 96-42, 1996.
* [9] D. Acosta et al, "The performance of a lead/scintillating-fiber calorimeter at hlhcS compendible gate widths," _Nuclear Instruments and Methods Res_, vol. A, no. 314, pp. 431-449, 1992.
* [10] J. M. Seixas, L. P. Caloba, and M. N. Souza, "A fast signal adder for applications with calorimeters," _Nuclear Instruments and Methods Res_, vol. A, no. 350, pp. 300-304, 1994.
* [11] J.M. Seixas et al, "Time-digitized signal analysis for a scintillator tile hadron calorimeter," in _Proc. of VII International Conference on Calorimetry for High Energy Physics_, Frascati, Italy, 1996, pp. 791-797.
* [12] N. K. Bose, _Digital Filters: Theory and Applications_. Krieger Publishing Company, 1993.
* [13] K. Anderson et al, "A low noise, high rate shaper for the tileal detector," in _First International Workshop on Electronics for LHC Experiments_, Lisbon, Portugal, 1995.
* level-1 technical design report," CERN, Technical Design Report LHCC 98-16, 1998.
* [15] J. M. Seixas, L. P. Caloba, and A. S. Cerqueira, "Summation for the scintillating tile calorimeter," in _Third International Workshop on Electronics for LHC Experiments_, London, England, 1997.
* [16] Lecroy Coorporation, Application Note AN-12, 1979.
* [17] D. Acosta et al, "Electron-pion discrimination with a scintillating fiber calorimeter," _Nuclear Instruments and Methods Res_, vol. A, no. 302, pp. 36-46, 1991.

Fig. 15: Charge collection curve measured on-line using the linear gate.