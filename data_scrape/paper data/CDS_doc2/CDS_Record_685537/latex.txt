# Position resolution of an ATLAS electromagnetic calorimeter module

Roberto Sacco

LAL, Orsay, France

###### Abstract

In this note, an analysis done on test-beam data collected with a series module of the ATLAS liquid Argon calorimeter is presented. Various methods of S-shape correction are presented and the resolution along \(\eta\) calculated. The vertex and pointing resolution in the ATLAS reference frame are also presented.

It is well known that the finite granularity of pad detectors gives rise to a systematic shift of the shower centre of gravity toward the centre of the cell. In the case of the ATLAS accordion calorimeter, this is especially true in the \(\eta\) view, whereas in the \(\phi\) view the accordion waves induce a better energy sharing between neighbouring cells. This effect can be observed in the test-beam data, where the reconstructed shower barycentre can be plotted against the "true" position measured by a set of beam chambers. The resulting S-shapes can be fitted and used to correct the barycentre position and subsequently calculate the position resolution as a function of energy and direction.

Once the best method of calculating the S-shape correction is defined, it is possible to consider the module in the ATLAS \((Z,R)\) reference frame and calculate vertex and pointing resolution.

## 1 Experimental setup

The beam tests of the ATLAS barrel modules were carried out on the CERN H8 beam line. Electron or positron beams, as secondary and tertiary beams, with energies ranging from 10 to 245 GeV were used. The module considered in this analysis, P13, was tested in July-August 2002. It covered an angle of \(\frac{2\pi}{16}\) in \(\phi\) and the region between 0 and 1.475 in \(\eta\). Cells were numbered from 0 to 15 along \(\phi\) and from 0 to 56 along \(\eta\). A detailed description of one of the modules along with the test beam setup can be found in reference [1]; however, in order to better understand the variation in \(\eta\) of some quantities, it is useful to recall that the accordion absorbers are made of lead sheets 1.53 mm thick for \(\eta<0.8\) (_i.e._ cell 32) and 1.13 mm thick for \(\eta>0.8\). They are glued between two 0.2 mm thick stainless steel sheets by resin-impregnated glass fibre fabric; the fabric compensates for the difference in thickness of the two types of lead plates so that the nominal thickness of an absorber is 2.2 mm.

The test beam layout is shown in figure 1. The beam line was equipped with three scintillators in front of the calorimeter for triggering purposes. The size of the last two (\(4\times 4\) cm\({}^{2}\)) defined the beam acceptance; the beam divergence was measured to be less than 0.1 mrad. The beam line was also instrumented with four multi-wire proportionalchambers [2]. The first two were read out via threshold discriminators, whereas the others were read out via constant fraction discriminators to achieve better resolution. The cryostat housing the module was mounted on a remote controlled table, that allowed movements in \(\eta\) and \(\phi\) while ensuring nominal incident angles as in ATLAS in all positions. However, the distance of the calorimeter face from the last beam chamber was kept constant within a few centimetres. For this reason, and to take into account the uncertainty in the exact positioning of the cryostat, in the following the resolution is measured in units of pseudorapidity and, except when the ATLAS reference frame is considered (section 5), it does not show the expected \(\cosh\eta\) behaviour. For the same reason, the beam chambers resolution is independent on the absolute value of \(\eta\).

## 2 Event selection and correction technique

### Data quality

To perform this analysis, only data taken with module P13 were used. For reasons of economy, only odd-numbered cells at \(\phi=10\) were considered. The \(\eta\)-scan was done at an electron energy of 245 GeV. Cells for which no optimal filtering coefficients were available were excluded from the analysis; the scanned region was therefore reduced to \(1\leq\eta\leq 45\), in cell units. In addition, for three cells at \(\phi=11\), \(\eta=13,27,38\), a large number of events was accumulated; these cells were therefore used to calculate the variation of the resolution within the cell (see section 4.1).

Data were processed using the EMTB-1-9 package [3]; the event energy and position were reconstructed with a cluster size \(\Delta\eta\times\Delta\phi\) of \(3\times 1\) cells for the front and \(3\times 3\) cells for the middle layer. The energy deposited in each cell was reconstructed using the optimal filtering technique [4]. Random, muon- and pion-like events were discarded using trigger and scintillation counters information. To ensure the best pion rejection, it was required that \(-2<(E_{peak}-E)/\sigma<3\), where \(E_{peak}\) was the fitted peak value of the Gaussian energy distribution and \(\sigma\) the width of the Gaussian (figure 2). Other constraints were imposed on the signal coming from the four beam chamber TDCs to guarantee a good track reconstruction and accidental background rejection. Finally, the reconstructed \(\eta\) and \(\phi\) barycentres were required to lie within a single cell of the middle compartment. In general, about 12% of the events satisfied all the requirements at the end of the selection routine, as summarised in table 1.

\begin{table}
\begin{tabular}{c c} \hline \hline Requirement & Number of events \\ \hline No requirement applied & 9990 \\ No random events & 9145 \\ No muon-like events & 9135 \\ No counts on scintillator S3 & 7311 \\ No counts on pion counter & 7197 \\ No hits outside selected cell & 6082 \\ Total energy inside selected window & 3808 \\ Good vertical BC reconstruction & 2289 \\ Good horizontal BC reconstruction & 1184 \\ \hline \hline \end{tabular}
\end{table}
Table 1: List of the requirements applied in the analysis and their effect on the event selection.

### Track reconstruction and S-shape optimisation

The four beam chambers were positioned at -31.8 m, -22.7 m, -4.4 m and -2.9 m with respect to the virtual ATLAS interaction point, _i.e._ about 1.5 m upstream of the cryostat. A straight-line fit of the hits allowed the reconstruction of the electron track and its subsequent extrapolation to the detector. Figure 3 shows the difference between the \(x\) position in the last beam chamber and the same position calculated from a straight-line fit involving only the first three chambers; the fit with a sum of two Gaussians indicates that some badly reconstructed tracks remain in the data sample and have to be taken into account in the calculation of the calorimeter resolution, as pointed out in section 4.

After performing the straight-line fit of the points identified by the beam chambers for each event, the distribution of the residuals was used to calculate each chamber's resolution. A toy simulation was then used to extrapolate the global resolution at the calorimeter; its value was found to be about 250 \(\mu\)m (_i.e._\(1.5\times 10^{-4}\) in units of pseudorapidity).

To allow a direct comparison between the position measured by the beam chambers and the one measured by the module, the track direction has to be expressed in terms of pseudorapidity and azimuthal angle. This is done in the track reconstruction routine by requiring as input the extrapolation distance, _i.e._ the position in the module along the beam direction where to stop the track extrapolation. Due to the fact that the electron beam was "parallel" (as opposed to "divergent" in ATLAS conditions, where the tracks originate from a single interaction point), different extrapolation distances would result in different determinations of \(\eta\).

In order to calculate the optimal extrapolation distance for each run, \(\eta_{C}\), the \(\eta\) position measured by the module in the middle compartment, was plotted against \(\eta_{BC}\), the \(\eta\) position extrapolated by the beam chambers, and the extrapolation distance varied until the correction to be applied to \(\eta_{C}\) at the centre and borders of the cell reached its expected value, _i.e._ zero (figure 4). It was also checked that this distance corresponded to a minimum of the position resolution for the middle compartment.

The same technique was applied to the simulation, obtaining for the extrapolation distance a result that, in general, differed from the one obtained for the data. This can be explained by pointing out that the position of the cryostat with respect to the beam chambers reference frame was known with an uncertainty of a few centimetres.

This optimisation method could not be used for the front compartment because of the higher level of cross-talk between neighbouring cells that distorted the S-shapes. A detailed description of the material in the accordion module was therefore used1 and can be seen is figure 5. The front compartment was divided into layers perpendicular to the beamline direction; a parametrisation of the shower longitudinal development as function of the incident beam energy and amount of traversed matter [5] allowed the determination of the shower energy deposit for each layer and therefore the barycentre of the energy deposit in the compartment for each cell in \(\eta\).

Footnote 1: The detector thickness in radiation length units was calculated using GEANT3 as adapted to test-beam conditions by Gaston Parrour.

### Logarithmic weighting

Logarithmic weighting (LW) provides an alternative way of correcting the S-shapes [6]. The standard position reconstruction in EMTB linearly weights the cluster cell positionswith the cell energy, for each compartment:

\[\eta_{C}=\frac{\sum_{i}w_{i}\eta_{i}}{\sum_{i}w_{i}}, \tag{1}\]

where the index \(i\) runs over the cells belonging to a given cluster in a compartment and \(w_{i}=E_{i}\), the cell energy.

To keep into account the exponential lateral spread of the shower, it is possible to introduce a new kind of weighting by using

\[w_{i}=\max(0,w_{0}+\ln(E_{i}/E_{C})), \tag{2}\]

\(E_{C}\) being the total energy deposited in a given compartment and \(w_{0}\) a free adimensional parameter that serves two purposes: first, it defines a threshold on the fraction of the shower energy that a cell must exceed in order to be taken into account and, secondly, it sets the relative importance of the tails of the shower in the weighting. In this case the S-shape modulation disappears and \(\eta_{C}\) can be directly compared with \(\eta_{BC}\) without further corrections. In the present case, the value of \(w_{0}\) was varied until a minimum for the resolution was reached, at which point it was found to be 2.0 for the front and 4.4 for the middle compartment at \(\phi=10\). Given the granularity of the front compartment, at different \(\phi\) positions the energy may be shared between two different \(\phi\) cells, and the amount of energy deposited in each cell is therefore smaller. This means that the weights to be applied change accordingly; in particular, the value of \(w_{0}\) was found to be 2.3 at \(\phi=11\).

A plot showing the variation of the resolution for the front and middle compartments as a function of \(w_{0}\) at \(\phi=10\) is shown in figure 6 and 7.

## 3 Monte Carlo samples

GEANT3 adapted to simulate test beam events was used to generate several Monte Carlo samples, one for each odd cell at \(\phi=10\), consisting of about 3000 events each. Three samples at \(\phi=11\) containing about 10000 events were also generated to study the cells for which a large number of events was available (\(\eta=13,27,38\)). The samples were analysed with the EMTB-1-10 package in which the clustering routine was modified to take into account electronic noise and cross-talk. The cell noise level for presampler, front, middle and back compartments was set at 45, 15, 30 and 25 MeV respectively. The cross-talk was set at 4.1% and 1% between neighbouring cells of the front and middle compartment respectively.

The agreement between data and Monte Carlo is shown in figure 8, where \(\eta^{*}\) is the \(\eta_{C}\) normalised value in the cell, _i.e._\(\eta^{*}=\mod(\eta_{C},a)/a-0.5\), \(a\) being the cell width.

## 4 Resolution calculation

Unfortunately, the beam chamber information lacked of an absolute measurement of the incident beam direction. The data contained only an identification of the cell hit by the electrons and nothing more; it was impossible to know where across the cell the electron actually impinged. This meant that the \(\eta\) average values calculated by the beam chambers were shifted with respect to those measured by the module by a fraction of cell. In order to overcome this difficulty, a constant value was added to \(\eta_{BC}\) run by run so that its average value coincided with \(\eta_{C}\), the latter calculated using the logarithmic weighting method in order to avoid the bias introduced by the S-shape.

Once \(\eta_{BC}-\eta_{C}\) and \(\eta_{C}^{*}\) were plotted against each other, it was possible to fit the resulting S-shape for the middle compartment with the function

\[S(\eta_{C}^{*})=P_{1}+P_{2}\ \eta_{C}^{*}+P_{3}\arctan(P_{4}\ \eta_{C}^{*}), \tag{3}\]

where \(\eta_{C}^{*}\) was \(\eta_{C}\) normalised to the cell width, as illustrated by figure 8. The variation along \(\eta\) of the fit parameters is shown in figure 9.

The fit was performed on Monte Carlo samples and the resulting correction applied directly to the data. The corrected value for the barycentre was then confronted with the one obtained by track extrapolation. The resulting \(\eta_{corr}-\eta_{BC}\) distribution was fitted with a sum of two Gaussians, a broad one that took into account the tails due to residual badly reconstructed events in the beam chambers, and a narrow one that measured the resolution at the peak, as shown in figure 11. The parameters of the two Gaussians were defined by

\[f(x)=P_{1}\ e^{-\frac{1}{2}(\frac{x-P_{2}}{P_{3}})^{2}}+P_{4}\ e^{-\frac{1}{2} (\frac{x-P_{5}}{P_{6}})^{2}}. \tag{4}\]

The contribution of the beam chambers was finally quadratically subtracted. The result for the middle compartment is presented in the upper half of figure 12.

Using the value of the pseudorapitity at small \(\eta\) and the appropriate extrapolation distance for the two compartments, it was possible to give an estimate of 240 \(\mu\)m for the front and 540 \(\mu\)m for the middle compartment resolution.

For the middle compartment, the use of the logarithmic weighting was also attempted. This method yielded a resolution that was worse than the one calculated with the S-shape fit for every cell, as shown in figure 10.

For the resolution calculation in the front compartment, it was found that the analytical fit of the S-shape and the logarithmic weighting method gave identical results, within the experimental error. Furthermore, the LW method could be applied to the cells for which lack of statistics made it impossible to have a good S-shape fit. The resolution for the front compartment is shown in the bottom half of figure 12. Every point along \(\eta\) was obtained by averaging the measurements for four different strips to increase the statistics; the beam chambers contribution was quadratically subtracted.

### Resolution variation within a cell

Using the runs for which a large number of events was accumulated, it was possible to check how the resolution varied within a single cell of the middle compartment. After calculating the S-shape correction with a fit on the Monte Carlo sample, the cell was divided into 10 slices in \(\eta\) and the correction applied. Again, the \(\eta_{corr}-\eta_{BC}\) distribution was fitted in each slice with a sum of two Gaussians, and the narrowest width compared to the prediction from Monte Carlo. The variation of the resolution across a single cell is shown in figures 16, 17 and 18 for \(\phi=11\) and \(\eta=13,27,38\), respectively.

### Resolution energy dependence

Several samples were considered at \(\eta=27,\phi=11\) and different energies in the range 20 to 245 GeV. The \(\eta\) resolution was calculated as already described, and the resulting variation with the energy fitted with a function of the form

\[R(E)=R_{1}\oplus\frac{R_{2}}{\sqrt{E}}\oplus\frac{R_{3}}{E}, \tag{5}\]

\(E\) being the beam energy. The result of the fit is presented in figure 19 and table 2.

## 5 Pointing resolution

From the corrected shower barycentre it was possible to extract the virtual vertex position and the direction of the incident electron, relying only on calorimeter information, and check it against the value measured by the beam chambers - for the data, or generated - for the simulation. In figure 13 the symbols used in the following are explained. Starting from the barycentre coordinates in a \((Z,R)\) reference frame, where \(Z\) is the coordinate along the ATLAS beam line and \(R\) the radial coordinate with respect to the same beam line, the vertex \(Z\) position is given by

\[\frac{Z_{2}-Z_{\rm vertex}}{Z_{2}-Z_{1}}=\frac{R_{2}}{R_{2}-R_{1}}\quad \Rightarrow\quad Z_{\rm vertex}=\frac{Z_{1}R_{2}-Z_{2}R_{1}}{R_{2}-R_{1}}. \tag{6}\]

The direction of the incident electron can be calculated through the formula

\[\theta=\arctan\frac{Z_{2}\tan\theta_{2}-Z_{1}\tan\theta_{1}}{Z_{2}-Z_{1}}, \tag{7}\]

where \(\theta_{i}\) are the barycentre angles for the front and middle compartment respectively. The resulting resolutions are plotted in figure 14 and 15.

The vertex and pointing resolutions as a function of the beam energy were also calculated using the energy scan at \(\eta=27,\phi=11\). The results are presented in figure 20 and 21 respectively.

## 6 Neural network analysis

An attempt was made to correct the S-shapes by using a neural network approach. For the middle compartment, a _perceptron_[7] was adopted. In its simplest form, a 2-layer perceptron, the neurons of the output layer receive synaptic (_i.e._ neuron to neuron) signals from those of the input layer but not vice-versa, and the neurons within one layer do not communicate with each other; the flow of information is therefore strictly directional and we have a feed-forward network. It is possible to introduce an iterative algorithm for constructing the synaptic couplings in such a way that a specific input pattern is transformed into the desired output pattern. The introduction of a _hidden layer_ make it possible to create algorithms classified as _supervised learning_: at each step the network is adjusted by comparing the actual output with the desired output. Such step in the algorithm is defined as _epoch_.

\begin{table}
\begin{tabular}{c c c c} \hline \hline  & \(R_{1}\) & \(R_{2}\) & \(R_{3}\) \\ \hline Strips & \((0.40\pm 0.88)\times 10^{-4}\) & \((1.91\pm 0.22)\times 10^{-3}\) & \((1.03\pm 0.13)\times 10^{-2}\) \\ Middle & \((1.20\pm 0.50)\times 10^{-4}\) & \((5.05\pm 0.20)\times 10^{-3}\) & \((0.65\pm 1.14)\times 10^{-2}\) \\ \hline \hline \end{tabular}
\end{table}
Table 2: Parameters defined in equation 5 for front and middle compartment.

For the S-shape correction in the middle compartment a perceptron was used with four input variables: \(\eta_{C}\), \(\eta^{*}\) and the energy fractions deposited in the preshower and front compartment. 16 were the hidden layers and the required output was the difference \(\eta_{BC}-\eta_{C}\).

It was found that, for a given odd-numbered cell, the best resolution could be obtained using as learning sample the Monte Carlo sample relative to the same cell, after about 6000 epochs and applying the correction directly to the data.

However, contrasting results were found for different cells: for some of them the resolution was better than the one obtained with the ordinary method by as much as 10%, but for other cells the resolution was worse, as figure 22 shows. A reason for this behaviour may be the way in which the energy fractions deposited in the calorimeter's layers were calculated: there are differences between data and Monte Carlo that have to be taken into account using a weighting procedure that, at the time of the editing of this note, was not fully understood.

For a more detailed description of how a perceptron can be used to correct S-shapes, refer to [8].

## 7 Conclusions

A study of the position resolution along the \(\eta\) coordinate of a module of the ATLAS electromagnetic calorimeter was presented.

An S-shape correction strategy based on logarithmic weighting for the front compartment and analytical fit for the middle compartment was used. Some of the difficulties encountered in this approach were outlined, such as the lack of an absolute measurement of the incident beam direction, and should be taken into account in the planning of future tests. The resulting distribution of the position resolution in \(\eta\) for test-beam data and simulation were found to be in good agreement, and the variation of the resolution with energy was also shown. The pointing resolution was found to be in agreement with what was shown in the Technical Design Report [9].

Some results related to a neural network approach to the S-shape correction were also presented, suggesting that more work in that direction may be fruitful.

## Acknowledgements

Special thanks to Daniel Fournier, Gaston Parrour, Patrik Puzo, Laurent Serin, Dirk Zerwas for the useful discussions.

## References

* [1] B. Aubert _et al._, "Performance of the ATLAS electromagnetic calorimeter barrel module 0", NIM A500:202-231, 2003.
* a users guide", SL-Note-98-023(BI), 1998.
* [3] R. Lafaye _et al._, "EMTB User Guide Version 1-9", [http://atlas.web.cern.ch/Atlas/GROUPS/LIQARGON/EM_Calo/TestBeam/www_emtb/manual-1-9.ps](http://atlas.web.cern.ch/Atlas/GROUPS/LIQARGON/EM_Calo/TestBeam/www_emtb/manual-1-9.ps).