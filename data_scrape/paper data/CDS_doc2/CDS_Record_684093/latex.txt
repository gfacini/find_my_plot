**ATLAS Internal Note**

**MUON-NO-150**

**16 April 1997**

**Pattern Recognition with**

**MDT Chambers**

J. Shanka, K. Sliwa, F. Taylor, B. Zhoua

Boston Muon Consortium

a Boston University, \({}^{\rm b}\) Tufts University, \({}^{\rm c}\) Massachusetts Institute of Technology

April 3, 1997

## 1 Summary

An MDT pattern recognition algorithm for the ATLAS muon system has been developed and used to study the performance for 3 vs. 4 layer-multilayer and single-hit vs. two-hit readout options. The reconstruction efficiency and momentum resolution were computed vs. the level of random noise which simulates background from neutrons and converted gamma rays from neutron capture. The 4 layer system design, with single-hit readout, has a better performance in terms of reconstruction efficiency and momentum resolution at the pattern recognition level. The two-hit readout scheme is shown to have a slightly improved performance over single-hit readout at high noise levels. The conclusions are that 3 layers with single-hit readout has a degraded performance at \(\geq 30\%\) random noise. A muon system based on this design, especially in the endcaps, will be vulnerable to a marginal performance at the highest luminosities. A'spread sheet' statistical model which permits an intuitive understanding of the efficiency of reconstruction vs. system design is given in the Appendix.

## 2 Introduction

There are a number of design considerations of the ATLAS muon system which can be only addressed with detailed hit-level simulations where facsimile information is generated and reconstructed in much the same manner as real data. Much work has already been done by the Saclay group and others on this objective. The intent of this work is develop an independent approach for algorithm development and cross checking of the MDT pattern recognition.

The following questions are addressed:

* How do the performances of 3-layer vs. 4 layer multilayers compare?
* What is the benefit of 2 hit readout vs. 1 hit readout?
* What is the sensitivity to out-of-time tracks?
* How well can tracks close in space and momentum be separated?

The tools developed to address these questions are based on the Saclay magnet interpolation software (M. Virchaux, L. Chevalier, J.F. Laport et al. Ref. [1] ) which describes the components of the ATLAS B-field with contributions of the solenoid, iron flux return and the barrel and endcap toroids as a function of position. Tracks are generated through the complete ATLAS detector by swimming in the B-field while undergoing multiple scattering and energy loss. Hits are generated in the MDT chamber planes and in the trigger chambers and are written to a data file. The data file is later reconstructed by recognition of the pattern of MDT and trigger chamber hits which are used to ascertain the superlayer hits. The superlayer hits are in turn used to find the momentum and distance-of-closest-approach (DOCA) with the intersection point (IP) of the event.

The program which generates Monte Carlo data is called ATTRACK_RECONGE and the reconstruction routine is named ATTRACK_RECHIT. There is a suite of subroutines which control the geometry, readout simulation, etc. The code executes on both VAX and UNIX operating systems and is available on the BMC Web page.

The number of MDT planes in a multilayer, the noise level, type of readout (1 hit or multi-hits ) and timing of the readout all can be varied in order to simulatethe performance of the muon system under various conditions. An event display routine was developed to show MDT hits and the local segment of the reconstructed track.

## 3 Simulation of ATLAS Detector

The following is brief description of the elements of the simulation of the ATLAS detector.

### Magnetic Field

The interpolation routine of the Saclay Group is used to describe the B-field. Simulations were performed with the 3 dimensional description **BMAGATLAS01.DATA**. Trajectories were computed by a linear integration of the equations of motion in small steps of roughly 3 cm. Fig. 1 shows the B-field encountered by trajectories at \(\eta\)=0.1 and \(\phi\)=0.1 and \(\eta\)=2.4 and \(\phi\)=0.1 followed by a 100 GeV muon. The central solenoid, flux return and toroids are evident.

### Model of the Material

A simple model of the calorimeter material, iron flux return and coils was adopted. The amount of material traversed by a muon ranged from approximately 90 X0 to some 200 X0. Fig. 2 shows the material (in radiation lengths) as a function of \(\eta\) for \(\phi\)=0.1. For every step of the trajectory integration inside material, the track swimmer computed the multiple scattering and energy loss with associated statistical fluctuations. Gaussian errors were assumed for the multiple scattering and a scaled Landau distribution was used for the energy loss fluctuations. Fig. 3 indicates the energy loss with fluctuations of a 100 GeV muon distributed flat in \(0\leq\eta\,\mid\,\leq 2.5\). Such details as the material distribution of the chamber support system and magnetic struts were not simulated - although a simple model of the material of the toroid coils and cryostat was included.

### Chamber Digitization and Simulated Operation

The chamber geometry was modeled by specifying the location of the midplane of each multilayer. The details of the multilayer geometry were developed from their midplanes. For example, all the chamber material for multiple scattering was assumed to be located at the multilayer midplane location. Hence, the geometry could be changed rather easily with all the associated parameters being carried along. In keeping with the limited goals of this simulation, certain details, such as the overlap of chamber boundaries, holes in the chamber coverage (except in the transition region where the barrel coils intrude in the first superlayer location) and odd chamber regions around the toroid support legs, were not simulated. The Cathode Strip Chambers in the high rapidity region of the endcaps were not simulated. The chambers were placed according to Layout Version I.

Hits in the MDTs were generated during the swimming of the muon trajectory. By knowing the local slope the trajectory (assumed to be straight line - a good approximation for all except very low momentum) and the multilayer hit positions the impact radius of each wire of each MDT was computed. The RPC and TGC hits were computed by a similar linear interpolation scheme.

Essential details of the MDT performance were included, such as the resolution as a function of impact radius, inefficiency of charge collection (small \(\leq 2\%\)) and the operation of the readout. For single hit data collection only the lowest radius was recorded. For the 2 hit readout simulation the first hit was assumed to have the same resolution and efficiency as the first hit in the 1-hit readout case and subsequent hits (larger impact radii) were assumed to be detectable with a 60% efficiency if they were more than 2.25 mm larger radii (75 ns) than the last hit. In addition to true second hits, noise pulses associated with the 2-hit readout were simulated. (See Hazen, Shank, Huth, Oliver and Riegler, Ref. [2]. ) No attempt was made to include the imperfect compensation for the Lorentz angle or additional errors associated with the details of the drift, charge collection or discriminator threshold.

The RPC and TGC systems were treated as simple strips running perpendicular to the MDT wires at their respective midplane locations. The trigger chamber layout was assumed to be congruent with the MDT layout with the same \(\eta\) and \(\phi\) boundaries except displaced in front and in back of MDT locations.

Random noise hits were simulated by a flat radius distribution according to the noise fraction assumed. For example, when a 30% noise fraction was being simulated 30% of the MDTs within the trigger road were assumed to have an extra hit which was distributed flat in radius. If the radius of a noise hit was smaller than the track radius when the single hit readout mode is being simulated only the noise hit was recorded.

## 4 Event Reconstruction

Events were reconstructed by translating all MDT, RPC/TGC hit information through the pattern recognition algorithm to the 6 effective hits in the multilayers (3 superlayers - each with 2 multilayers). In effect, all reconstructed events had 7 space points (6 in the muon chamber superlayers - one for each multilayer - and the IP) which were used for the momentum reconstruction.

### MDT Pattern Recognition Algorithm

The impact circles and the wire centers in a search region defined by the trigger chambers constitute the input information of the MDT pattern recognition algorithm. Local track candidates are selected from the 4 tangent lines taken between pairs of hit tubes, one in each multilayer of each superlayer over all combinations of the 3 vs. 3 or 4 vs. 4 tube layers in the multilayers of a superlayer. The minimum hit configuration is taken to be a "1 & 2" ("2 & 1") pattern, where at least one of the two multilayers has at least 2 tubes consistent with a good local track. Over that distance (\(\leq 40\) cm) the track is assumed to be a straight line which roughly points back to the IP - even though the actual trajectory is bending in the toroidal field.

The search region is defined by the RPC/TGC systems in the barrel/endcaps, respectively. In the barrel region the search roads are assumed to be 9, 5 and 5 tubes wide for superlayers 1, 2 and 3, respectively, which roughly follows the projective errors of the trigger chambers. The corresponding road for the endcap region is 5, 5 and 9 tubes.

Note that the pattern recognition of the MDT hits operates independently for each superlayer with no trigger information except that which is supplied by rather wide trigger roads. To determine a full 3 dimensional track the superlayer hits (2 for each superlayer - corresponding to one for each multilayer) have to be correctly associated with the orthogonal coordinate information and with other superlayers. For the "3 vs. 4" study this association was assumed to be unique.

The MDT pattern recognition is performed in 3 levels - each with a further degree of refinement, which generally converges on the true hits and local track even in the presence of noise.

**Level 1:**

All tangent lines are formed between all pairs of hit tubes in each multilayer of a superlayer. Only those tubes which are roughly projective with the IP and within the trigger roads are accepted. The projectivity with respect to the IP is computed by limiting the "turning" angle of the line segments normalized by the magnetic path length in the toroid. This selection parameter is computed by the following expressions for the barrel and endcaps, respectively:

\[T_{B}=\left\langle Tan^{-1}(a)\ - Tan^{-1}(\frac{X_{tc}}{Z_{tc}})\right\rangle Sin[Tan^{-1}(\frac{X_{tc}}{Z_{tc}})] \tag{1a}\] \[T_{EC}=\left\langle Tan^{-1}(a)\ - Tan^{-1}(\frac{X_{tc}}{Z_{tc}})\right\rangle Cos[Tan^{-1}(\frac{X_{tc}}{Z_{tc}})] \tag{1b}\]

where a = the local slope in the drift coordinate (a = dx/dz) and Tan^1(\(\frac{X_{tc}}{Z_{tc}}\)) is the angle of the hit tube with respect to the IP. Typically, we require \(T\leq 0.2\) which cuts out most of the unphysical combinations. The cut is applied for each superlayer separately.

**Level 2**

Two figures of merit based on consistency of hits with a straight line and adjacency of lines in slope and intercept are used to select local track candidates in a given superlayer.

Lines which pass the cuts of Level 1 are projected through the hit tubes to find the number, n_c i, which are impacted by the line (impact radius of line lies inside the tube) and the corresponding \(\chi^{2}\). The adjacency number for each line, (a,b)i, characterized by a slope, a, and intercept, b, is determined by counting how many other lines {a,b}j satisfy the cuts:

\[|a_{i}\ -\ a_{j}|\leq 0.025;|b_{i}\ -\ b_{j}|\leq 0.30\ \text{m} \tag{2}\]

[MISSING_PAGE_EMPTY:7]

### Momentum Reconstruction

Momenta are reconstructed in three analysis stages: (1) use the MDT hits and RPC/TGC information to determine the superlayer hits by means of the pattern recognition algorithm, (2) use the track sagitta computed from superlayer hits to compute through a look-up calibration file the momentum, DOCA and \(\chi^{2}\) of the trial momentum (**Level 1** reconstruction), and (3) by a 5 parameter fit of the superlayer hits (3 components of momentum and 2 spatial dimensions) with correlated errors (**Level 2** reconstruction). The second stage acts as the starting momentum for the 5-parameter fit. It was determined for the studies of this note that only **Level 1** momentum reconstruction was needed.

The muon system was calibrated by calculating the sagitta for 100 GeV muons of both charges in a 50x50 grid of rapidity and azimuthal angle in the range \(\mid\eta\mid\leq 2.5\) and \(\phi\leq\pi/2\). Muon tracks were propagated through the ATLAS detector from the IP with all sources of random errors such as multiple scattering and fluctuations of energy loss turned off. The hit position in the outer most chamber plane was recorded as well as the final momentum (after energy loss in the calorimeter) and track sagitta. The momentum is determined by:

\[\mathrm{p0=p_{f}\,s_{\mathrm{c}al}}, \tag{4}\]

where \(\mathrm{p_{0}}\) = initial momentum at the IP (100 GeV/c in this case), \(\mathrm{p_{f}}\) = final momentum at the last chamber plane (associated with the calibration sagitta), \(\mathrm{s_{c}al}\) = calibration sagitta at that grid point and \(\mathrm{s_{meas}}\) = measured sagitta of reconstructed track. The track hit in the last chamber plane was matched to the nearest calibration point in the grid in order to select the sagitta and final momentum used in eq. 4. (The momentum resolution for Level 1 reconstruction could have been improved somewhat by interpolating between calibration points.) The sign of measured sagitta determined which of the two calibration files was used. Fig. 4 shows the calibration data plotted as a function of rapidity and azimuthal angle for positive charge. The complexity of the calibration points in this plot indicates the measurement challenge of the ATLAS muon system. The calibration file was certified by reconstructing the calibration data.

The first guess momentum, given by the calibration files, was checked by swimming the muon from the hit position in the outermost chamber back to the IP adding the average energy loss in each section of material traversed. In this manner the momentum of the muon at the IP was reconstructed. In the range of 10 to 300 GeV/c the momenta are reconstructed to about 5% gaussian \(\sigma\) and the mean DOCA of the IP is \(\approx 6\) cm with an R.M.S. of 15 cm. The 5-parameter fit does not seem to reduce the error of the reconstructed momentum significantly (the energy loss fluctuations are not compensated in either reconstruction) but does reduce the DOCA of the IP by about a factor of 3.

Various quality factors, as well as cuts used to select data, were recorded in a "quality matrix". The elements of this matrix were stored in an ntuple at the time of reconstructing the simulated data so that later analysis could be made on correlations of parameters and optimization of cuts.

The observables of the momentum reconstruction such as DOCA with the IP and the quality of the fit were used as the last stage of the pattern recognition. Finding a bad DOCA or quality-of-fit was taken to be an indicator that hits in the MDTs and trigger chambers were incorrectly identified.

## 5 Event display

We found a one-event display to be a very useful aid in debugging the pattern recognition algorithm and monitoring the performance of the code. The display routine reads the raw hit bank and shows the hits in "chamber space" (wires into the screen) at two spatial scales. The large scale allows examination of all three superlayers simultaneously for a global view of the track reconstruction and the small scale permits a single superlayer to be inspected closely. The track found by the Level 3 MDT pattern recognition algorithm described above is superimposed on the hit tubes. A color coding is used to indicate whether an impact ring was used in the fit and whether or not it was a noise or real hit. Fig. 5 shows a typical event displayed at these two scales.

Appendix A shows the structure of the event generation and reconstruction-display code.

## 6 Results

A number of configurations of the ATLAS muon system were simulated to determine the efficiency and quality of the track reconstruction as a function of configuration of the muon system. To set the scale of expected noise we plot in Fig. 6 the predicted occupancy in the MDTs is plotted as a function of rapidity with a conservative multiplicative factor of 20 over the background estimates of A. Ferrari [Ref. [3]]. We have assumed an MDT drift time of 500 ns. Actually, CSCs will be located in the \(\mid\!\eta\!\mid>2\) region of the first layer of the endcaps, where the MDT occupancy indicated in Fig. 6 becomes large. Even though the figure shows that MDT occupancies larger than 30 % for \(\mid\!\eta\!\mid<2\) are unlikely, we will adopt a very cautious attitude and investigate how our pattern recognition algorithm and momentum reconstruction works at occupancies up to 50% - a level that, we hope, will never be encountered.

### Noise Extinction

The critical first step in the analysis of data is to optimize the efficiency for reconstructing real hits while minimizing the efficiency of noise. Of the many quality factors stored in the quality matrix it was found that the sum of the number of hits (Sum Q ) which lay on the local tracks through all three superlayers was a very potent discriminator of noise. Fig. 7 indicates a typical noise extinction plot computed for the 4-3-3 configuration (4 tube layers in each multilayer of superlayer 1, etc.) with the additional requirement of DOCA \(<0.5\) m and \(\chi^{2}<\)200. Note that the efficiency for reconstructing noise hits decreases quite rapidly as the Sum Q cut value is increased, whereas the efficiency for reconstructing all hits (true and noise hits) remains essentially constant. A cut at Sum Q \(\geq 10\) effectively eliminates the noise.

### Acceptance Criteria

The other observables of the event reconstruction are the reconstructed DOCA of the IP and the \(\chi^{2}\) of the reconstructed track. The errors entering in the computation of the \(\chi^{2}\) from the 7 contributing points were estimated by propagating the errors in the last chamber hit position and the angles back to the IP. Correlations from multiple scattering were only accounted for in the Level 2 reconstruction. Fig. 8 shows typical DOCA and \(\chi^{2}\) distributions for tracksgenerated flat in \(10\leq p\leq 300\) GeV/c, \(1\eta\,|\leq 2.5\) and \(0\leq\phi\leq\pi/2\). Our cuts DOCA<0.5 m and \(\chi^{2}<\)200 contain most of the good events.

An overall quality factor useful in estimating the performance of the reconstruction code was the error in the momentum. Cuts were made on \(\Delta p/p\leq 0.5\) for acceptance as a successful reconstruction. Fig. 9a shows a typical momentum resolution plot in the absence of random noise with all other sources of resolution errors operative for the 4-3-3 configuration and Fig. 9b for 50% random noise. Note that the presence of noise leads to the momentum being reconstructed to a lower value.

### Performance versus Construction of Multilayer

A crucial parameter in the design of the ATLAS muon system is how many tube layers are needed in each multilayer. Note that a system of MDTs presupposes many tube layers - at least two hit tubes are needed to compute precision coordinates (4 tangent lines) and a third layer is needed to resolve the 4-fold ambiguity. Given the minimal requirements for track reconstruction being at least 3 layers, the pattern recognition was based on an entire superlayer which has at least 6 tube planes. Further, for good local track angle determination, we have required at least one good hit in one multilayer and two good hits in the other.

In order to investigate the operation of the muon system for different MDT chamber configurations we have generated and reconstructed muons flat from 10 to 300 GeV and 0\(\leq\)1\(\eta\,|\leq\)2.5. Fig. 10a shows the reconstruction efficiency vs. MDT chamber configuration for 30% random noise level in all superlayers for single hit readout. In this figure 333 denotes the MDT configuration where each multilayer has 3 tube layers, etc. Note that the 333 case performs much more poorly as compared to the 444 case and that there is an improvement as the number of tube layers in a multilayer increases. In Fig. 10b we plot the plateau reconstruction efficiency as a function of configuration for 0%, 30% and 50% random noise levels in all superlayers. At 50% noise level the 444 layer case is significantly more robust. Finally, Fig. 10c shows the reconstruction efficiency for Sum Q cut \(\geq\) 10 needed to suppress noise reconstructions for the 333 and 433 cases as a function of noise. In this figure we have simulated the indicated noise fraction in the first superlayer and 1/3 the same fraction in the other two superlayers as would be expected from the simulations of Ferrari [3]. This figure is a strong indication of the need to have 4 tube layers in the first superlayer.

Fig. 11 shows the corresponding momentum resolution for the two extreme chamber cases as a function of the noise level where one observes that 4 layers out performs the 3 layer case.

The greatest difficulty in estimating the background in MDT system is in the first superlayer. This layer lies just outside the calorimeter and is therefore sensitive to EM debris and other soft tracks which will leak out the back surface. Hence, we propose that the first superlayer be constructed out of 4 tube layers. For this note we adopt as our simulation baseline design the 4-3-3 configuration.

### Single Hit versus Double Hit Readout

The inefficiency of the reconstruction algorithm in the presence of random noise is directly attributable to loss of information occurring when a noise hit preempts a true hit. Making use of the second hit increases the amount of information thereby improving the reconstruction efficiency which, for a perfect readout system and random noise, is roughly equivalent to doubling the number of layers in a multilayer. The realization of a double readout will be less than this ideal owing to the dead time between pulses, lower spatial resolution and inefficiency for the second pulse and noise introduced by the differentiator of the readout electronics. Fig. 12 shows the efficiency and resolution of the second hit readout in a "realistic" multihit readout scheme. Are there benefits of a double hit readout, even within the limitations of a "realistic" scheme?

To address this question we have simulated the baseline 4-3-3 configuration for the single and realistic double hit readout as a function of random noise. We found that in the double hit readout case most of the track information is in the position of the two hits with the smallest impact parameters and the larger impact radii tend to be caused by the arrival of late charge clusters. The noise extinction curves are shown in Fig. 13 for 1 hit readout, and Fig. 14 for double hit readout. Here we applied the following requirements: (1) the DOCA of the IP must be within 50 cm, and (2) the \(\chi^{2}\) of the first guess momentum tracked back to the IP must be less than 200. We note that the double hit readout results in only a marginal improvement in the reconstruction performance. However, the efficiency plateaus are somewhat wider and the reconstruction efficiency is slightly better. We suspect that the double hit readout is degraded by the presence of noise readout pulses. These tend to obscure the true hits and sometimes confuse the pattern recognition algorithm. A simple model of the pattern recognition efficiency is discussed in Appendix B.

### Sensitivity to Out-of-Time Events

The muon system will flooded with charged tracks which will not satisfy the trigger. The question naturally arises as to what the reconstruction efficiency is for these events given an accidental association of a trigger road with an out-of-time track. In order to simulate this effect we generated true tracks in the muon system but shifted all impact radii in the MDTs by an additive factor \(\pm\) n (25ns/500ns)x15 mm simulating the wrong beam crossing association. Fig. 15 show the resulting efficiency vs. beam crossing displacement (time translated to distance). For the 4-3-3 configuration the reconstruction efficiency for all out-of time events (flat time offset distribution) is about 12%. The standard DOCA and \(\chi^{2}\) cuts were applied as well as the noise extinction cut Sum Q \(>\)10.

The reconstructed out-of-time events tend to be at small time displacements and seem to reconstruct to the correct momentum with a resolution roughly 2x worse (gaussian measure) than the in-time events. From Fig. 15 we conclude that the sensitivity extends to \(\pm\) 6 mm /15 mm corresponding to an effective time resolution of \(\pm\) 200 ns, or \(\pm\) 8 beam crossings.

Using the event display, we find that the successful reconstructions are mostly superlayer tracks with either 'outside' or 'inside' tangent lines through the MDT circles and not 'cross' tangents. It was found that the out-of-time tracks tend to reconstruct in the regions of the muon system which have MDTs accidentally aligned with the IP, suggesting a high energy effect. Therefore, a close examination of the out-of-time events was conducted with 1 TeV tracks in the 4-4 configuration. For geometry Version I, definite peaks are observed in the reconstructed track polar angle at roughly 0.2, 0.4, 0.75 and 1.25 radians. The topology selection effect persists at lower momentum where enhancements at 0.2 and 0.8 are observed in the entrance angle to the last superlayer (roughly equal to the track polar angle at high p\({}_{0}\)) for 10 \(\leq\) p\({}_{0}\)\(\leq\) 300 GeV/c in the 4-3-3 configuration.

In this momentum range, the out-of-time reconstruction efficiency increases from 7% at 25 GeV/c up to about 16% at 300 GeV/c.

The sensitivity to out-of-time tracks can be reduced (at cost) by staggering the tubes in a chamber so that tangent lines will not to point back to the IP. Some reduction can be obtained with a large Sum Q cut, but this strategy must be balanced against the need for high pattern reconstruction efficiency.

### Separation of Tracks

The baseline design of the ATLAS muon system has the second coordinate, determined by the trigger chambers, orthogonal to the drift coordinate (from MDT). Thus, for every n tracks through a given MDT-trigger chamber overlap region, there will be n\({}^{2}\) hit candidates. With no additional information, these n\({}^{2}\) hits will be indistinguishable at the superlayer level. Without a cross chamber plane, the general way in which "reals" can be distinguished from "ghosts" is by requiring that they make up a track reconstruction of high quality defined by a good DOCA and \(\chi^{2}\).

The combinatorial problem is exacerbated by the large number of links between hits ("reals" and "ghosts") in a superlayer with the hits in the other superlayers which must be searched in order to find the "real" track. This general strategy follows because the ATLAS muon system is a sparse deployment of chambers with only a few measurement stations separated by large distances inside a complicated magnetic field. The number of links to be examined is given by N=n\({}_{1}\)\({}^{2}\) n\({}_{2}\)\({}^{2}\) n\({}_{3}\)\({}^{2}\), where n\({}_{1}\)\({}^{2}\) is the number of track segments in superlayer 1, etc. For two real tracks there are 64 candidates which must be examined, leading to an expensive and slow analysis. Some of the combinations may be reduced in situations where the bending is small and the two track can be recognized in projection. In this case there would be only 4 combinations to search. Unfortunately the general case is more complicated.

Several questions naturally arise: (1) How likely is for two tracks to hit a trigger MDT overlap region?; (2) How close can the tracks be in phase space and still be distinguished?; (3) What is the separation efficiency for like-sign and opposite-sign tracks as a function of opening angle and momentum difference?; and (4) In practice, how can the best two tracks be distinguished from the other 62candidates? In order to address these points versions of the ATTRACK_RECONGE and ATTRACK_RECHIT were written which generated and analyzed two real tracks close in phase space.

The likelihood that two track are coincident in a trigger chamber can be estimated by the charged background rate of A. Ferrari [3]. For 1 m\({}^{2}\) of chamber in a high \(\eta\) region of the endcap with a rate of 0.1 kHz/cm\({}^{2}\) and a 10ns resolution time the accidental doubles rate is 1% of the singles rate. If we take our conservative factor of 20 enhancement of background rate we would have a 20% accidental rate. Moreover, there are'real' processes such as muon tridents which result in opposite sign dimuons with a small opening angle. A rough estimate is that between 0.5% and 1% of high energy muons will have an associated dimuon. Most of the accidentals will be well-separated in momentum, as would be the muon tridents, so most of the multiple tracks can be separated after analysis. However, the analysis of so many combinations will be a formidable task.

To illustrate the combinatorial problem we plot in Fig. 16 the reconstructed momentum (Level 1) of the 640 candidates of 10 events with a 100 GeV and 300 GeV track against the \(\chi^{2}\) of the first guess 'fit'. Note that bands at 100 and 300 GeV are clearly evident with manifestly better \(\chi^{2}\) than the ghost reconstructions. The same behavior is seen when the reconstructed momentum is plotted against DOCA. Even though they are correlated, we take as the figure of merit the product of DOCA * \(\chi^{2}=\zeta\). In the situation of Fig. 16 most of the ghost solutions reconstruct to lower momentum and worst quality. However, there are "closely-related ghosts" which contribute to the tails of the momentum resolution. Taking the track pair with the best two values of \(\zeta\) results in selecting the "real" hits most of the time. The best two candidates can be used later for a refined Level 2 momentum fit.

More problematical is the situation plotted in Fig. 17 which shows the solutions for 4 events with \(\pm\) 300 GeV/c muons with \(\theta_{12}\) = 0. In event 1 (upper left hand corner) only one of the muons is reconstructed at 300 GeV/c and in event 4 (lower right hand corner) there are several candidate tracks with roughly equal quality.

To be more quantitative, we have performed two tests of the track separation. In **Test 1** we generate dimuons of opposite charge but equal momentum for various values of momentum and separation angle. For **Test 2** same sign dimuons are generated but with different momenta. In both analyses it was assumed that there were two good tracks to be found. These were identified by choosing the best two \(\zeta\) values from the ensemble of 64 candidates. If the best two tracks had opposite signs then the choice is retained. If the best two had the same sign then it was required that they be at least 10% different in momentum.

The resulting efficiencies are plotted in Fig. 18 for **Test 1**. Note that the separation efficiency improves for lower momentum and for higher opening angle and noise tends to degrade the two track efficiency. A J/\(\Psi\) would correspond to \(\theta_{12}=0.6\) degrees and the dimuon mass is roughly linear in \(\theta_{12}\). The inefficiency at small separation angles is primarily from the best two choices being a same charge sign dimuon. If we require that the best two tracks have opposite charges then the efficiency at \(\theta_{12}=0\) improves to 87% from 55%. The invariant mass distributions tend to peak at the right value, but at high mass develop a low tail and at low mass a high tail. Presumably better fitting (Level 2) and fixing the DOCA to a common IP will improve the mass resolution.

Fig. 19 is a summary of the efficiency for **Test 2**. In this situation we find that the efficiency degrades slowly for decreasing momentum difference between the two tracks even in the extreme case of \(\theta_{12}=0\). Plotted in the same figure is the reconstruction efficiency for same sign dimuons when the opening angle is 2 degrees. This reconstruction efficiency is lower than for the \(\theta_{12}=0\) case because wrong combinations lead to very different momenta which become obvious failures.

The number of candidate tracks can be reduced by exploiting the fact that the track in the coordinate orthogonal to the MDT drift direction is generally 'nonbending'. Taking these nearly-straight lines reduces the number of combinations from 64 to 16. Following the 'heritage' of the reconstructed tracks we find that the bad fits tend to come from the wrong associations of the drift coordinates of the superlayers, whereas the 'near ghosts' come from wrong associations of the orthogonal coordinate with the drift coordinate. The bad fitstend to be eliminated by the DOCA and \(\chi^{2}\) fits, whereas the 'near ghosts' often are good fits but frequently lead to a worse momentum reconstruction.

Building a cross plane in each superlayer would eliminate the wrong associations and clean up the momentum reconstruction tail. A rough simulation of the operation of the muon system with cross planes was accomplished by forcing the pattern recognition software to use only the correct associations. Unfortunately, it was determined that cross planes are needed in all of the superlayers before the momentum tails are completely eliminated, but consideration should be given to resolving the multitracks in the first superlayer where the background is expected to be large.

We find the lack of a cross plane to resolve the track ambiguities a reason for concern - especially in the large \(\eta\) region where high rates are anticipated. The large number of combinations which explode as the number of multitracks increases will result in a large analysis burden and degraded performance. The multi-track separation problem seems most acute in the opposite sign case at small opening angle where the best two tracks frequently have the same sign. The efficiency of the algorithm can be improved somewhat by requiring the dimuon to be opposite sign. The inefficiency for this event topology unfortunately has experimental consequences. More analysis of this effect is clearly needed.

## 7 Conclusions

We have developed a pattern recognition/reconstruction algorithm and event display for the ATLAS MDT muon system. On the basis of this algorithm and estimates of the chamber occupancy we recommend that the muon system be constructed with the first two multilayers having 4 tube planes each to have a more secure operation in the midst of possible large backgrounds. In addition, we suggest that the MDT electronics be constructed to make possible an upgrade to double hit readout if it is found through operating experience to be required. Further study is warranted on the two track separation issue. We are concerned with the large number of combinations resulting from having no cross planes, leading to ambiguities of track reconstruction for close tracks and degraded momentum reconstructions. Consideration should be given to the improvement afforded by a cross plane in at least the first superlayer.

Clearly more simulation studies are warranted. Work is in progress to install the software within the standard DICE framework. This will enable details of the chamber geometry to be simulated, as well as the operation of the system under correlated backgrounds, such as \(\delta\)-rays and bremsstrahlung and related EM showers. In addition, simulations should be performed with the full rate 'burden', including the time structure of the beam crossings as well as the constant gamma and neutron background flux.

## References

* 1. J. F. Laporte et al. ATLAS Internal Note MUON-NO-126, 21/8/96; and M. Virchaux et al., MUONBOX and associated programs.
* 2. E. Hazen, et al., LHC Exp. Balatonfured, Hungary 23/9/96, and W. Riegler, ATLAS Internal Note MUON-NO-137 (22/1/1997).
* private communication.
List of Figures

Fig. 1

(a) B-field components vs. "swim" distance from IP for track at \(\eta\) = 0.1 and \(\phi\) = 0.1

(b) B-field for \(\eta\) = 2.4 and \(\phi\) = 0.1. Both trajectories are for a 100 GeV/c muon.

Fig. 2

Penetrated material for trajectories as a function of \(\eta\) for \(\phi\) = 0.1 radians.

Fig. 3

(a) Correlation of energy loss with fluctuations vs. X0 for 100 GeV/c muons.

(b) Energy loss with fluctuations of 100 GeV/c muons integrated over the material distribution shown in Fig. 2.

Fig. 4

Calibration data for q=+ 100 GeV/c muons plotted as a function of \(\eta\) (4a) and \(\phi\) (4b).

Fig. 5

A typical muon track is shown with the display routine in both the large scale (Fig. 5a) and small scale (Fig. 5b). Rings which are enhanced are used in the fit.

Fig. 6

The expected occupancy with a conservative factor of 20 x from the background calculations of A. Ferrari [3] for both barrel region and endcap region. Note that CSCs are placed the high \(\eta\)>2 region of the inner superlayer. The placement of the transition between the two technologies is evident.

Fig. 7

A typical noise extinction plot where the efficiency for momentum reconstruction for all (left-hand scale) and only noise hits (right-hand scale) are plotted as function of the sum of the number of hit tubes laying on all three track segments in all three superlayers. Note that tracks with a sum hits \(\geq\) 10 are composed of only true hits and no noise. The shorthand notation used is for example 433-030-0-a means 4 layers/multilayer in the first superlayer, etc; 030-> 30% random noise; 0->1 hit readout; a-> all hits analyzed.

Fig. 8 Typical DOCA of the IP and \(\chi^{2}\) of the fitted momentum are shown for the 4-3-3 single-hit readout configuration at 30% random noise. Typical cuts used for this analysis are DOCA \(\leq\) 0.5 m, \(\chi^{2}\) \(<\) 200.

Fig. 9 Typical resolution of the reconstructed momentum in the 4-3-3 configuration for no noise 1 hit readout (9a). In this case roughly 1 % of the tracks fail the Ap/p \(\leq\) 0.5 cut. In (9b) we show the momentum reconstruction in the presence of 50% random noise. Note that noise gives rise to a low momentum tail.

Fig. 10a The noise extinction curves are plotted for various chamber configurations at 30% random background. Sum Q is the number of tube layers required for the track reconstruction. A good track in the 333 case would hit a mean of 18 tube layers. To be completely efficient a cut Sum Q \(\geq\) 10 is typical for the 333 case.

Fig. 10b Comparison of the track reconstruction plateau efficiencies vs. MDT chamber configuration for various random noise levels. Note that the DOCA of the IP and \(\chi^{2}\) of fit cuts were employed.

Fig. 10c The reconstruction efficiency as a function of random noise level is plotted for the 333 and 433 configurations. In this case the standard DOCA IP and \(\chi^{2}\) cuts have been made as well as Sum Q \(\geq\) 10 needed to suppress noise hit reconstructions. Further, we have made the noise in the first superlayer to be the level indicated but have simulated the corresponding noise in SL2 and SL3 to be 1/3 the level in SL1 as indicated roughly by Fig. 6.

Fig. 11 The momentum resolution for the two multilayer designs [(3-3-3) and (4-4-4)] vs. noise for single-hit readout. At high noise levels the reconstructed momentum tends to be smaller than the true momentum since the probability of finding a bending trajectory is higher than a straighter one. See Fig. 9b.

Fig. 12

The efficiency of the second hit readout for a "realistic" two-hit readout scheme in the 4-3-3 configuration (W. Riegler [3]).

Fig. 13

The noise extinction curves for single hit readout are plotted as a function of level of random noise. For this analysis we have applied Sum Q, DOCA and \(\chi^{2}\) cuts.

Fig. 14

The noise extinction curves for double hit readout. Note that the efficiency for the 4-3-3 0% noise with two-hit readout is slightly less efficient than the corresponding single-hit readout because sometimes the pattern recognition uses a readout noise hit instead of the true hit. The plateau curves are slightly higher and broader.

Fig. 15

Sensitivity to out-of-time tracks for the 4-3-3 configuration (no random noise). The standard analysis cuts were imposed (DOCA and \(\chi^{2}\) cuts and Sum Q > 10). The offset time, DTIME, has been quantified in beam crossings but has been expressed in distance (meters). For \(10\leq p0\leq 300\) GeV/c the average efficiency for reconstruction of out-of-time tracks is 12 %, but shows a bias towards high momentum.

Fig. 16

The reconstructed momentum (Level 1) of the 640 candidates of 10 events with a 100 GeV and 300 GeV track are plotted against the \(\chi^{2}\) of the first guess 'fit'. Note that bands at 100 and 300 GeV are clearly evident with manifestly better \(\chi^{2}\) than the ghost reconstructions which are at lower momentum.

Fig. 17

The solutions for 4 events with \(\pm\) 300 GeV/c muons with \(\theta_{12}\) = 0. The best two tracks are not always the \(\pm\) 300 GeV/c pair.

Fig. 18

The results of Test 1 are shown for opposite sign dimuons as a function of momentum and separation angle. The muon configuration was taken to be the simulation baseline 4-3-3. Requiring the best two tracks to be of opposite sign improves the efficiency for \(\theta_{12}=0\) from 55% to 87%.

Fig. 19

The results of Test 2 where same sign dimuons were analyzed with different momentum.

[MISSING_PAGE_EMPTY:28]

Figure 5a

Figure 5b

Figure 9a

## Appendix A Structure of Generation/Reconstruction/Display Code

Event Generator: Attack_Reconge.f

[MISSING_PAGE_FAIL:43]

## Appendix B Spread Sheet Model of Reconstruction Efficiency

In the limit where random and uncorrelated processes is the dominate source of noise the reconstruction efficiency should be controlled by statistics alone. It is therefore interesting to follow the determining factors from the tube efficiency to the efficiency for detecting the minimal pattern required by our track recognition algorithm. A comparison of the model with the full simulation may indicate how much of the inefficiency comes from statistics alone vs. from other factors, such as tube resolution and readout noise. According to this view, we hypothesize that the relative differences between single hit readout for 3 vs. 4 tube layers per multilayer should follow from simple statistical considerations. Further, in the absence of readout noise we expect that the double hit readout should be governed by the same statistics. And conversely, the extent to which the double hit readout efficiency does not follow from statistics would then be a measure of the other factors controlling the reconstruction efficiency.

### Tube Efficiency

The tube efficiency is the probability for detecting a true hit in the presence of noise. In the case of single hit readout the tube efficiency is determined by the probability for the true hit to be at the smallest radius and is given by the following average value:

\[\epsilon_{1}=1-\frac{1}{2}\,f_{n}\]

where \(f_{n}\) is the fraction of noise. Hence the single hit efficiency for detecting a true hit will go roughly from \(0.5\leq\epsilon_{1}\leq 1\) for \(1\geq f_{n}\geq 0\).

In the case of double hit readout the tube efficiency will be determined again by the relative placement of the true hit and the noise hit:

\[\epsilon_{2}(r_{t})=1+\frac{1}{2}\epsilon_{n}\bigg{[}P_{2}\frac{r_{0}-r_{t}- \Delta r}{r_{0}-r_{t}}-1\bigg{]}\]

where \(r_{0}\) is the tube radius, \(r_{t}\) is the radius of the true hit, \(\Delta r\) is the dead region between the first and second hit and \(P_{2}\) is the efficiency for detecting the 2nd hit.

Integrating over \(r_{t}\) the average efficiency is:

\[\epsilon_{2}=\int_{0}^{r_{t}}\frac{dr}{r_{0}}=1+\frac{1}{2}f_{n}\left[P_{2}\left( 1-\frac{\Delta r}{r_{0}}+\frac{\Delta r}{r_{0}}\ln(\frac{\Delta r}{r_{0}})\right) -1\right].\]

When \(P_{2}=\)0 we recover the single hit efficiency given above. In Fig. B1 we plot the efficiencies for detecting the true hit as a function of the noise fraction \(f_{n}\) for the two readout cases. For the two-hit readout we have taken a dead region of 2.25 mm in which no second hit can be detected and have considered two cases where the efficiency of second hit detection is 80% (optimistic) and 60% (realistic).

### Efficiency of Minimal Pattern

The second factor controlling the efficiency for pattern recognition is the requirement that at least the "1&2" pattern be detected in all 3 superlayers. Fig. B2 shows the reconstruction efficiency versus the tube efficiency for various 3 and 4 plane systems. The 4-4-4 configuration efficiency is maintained at \(>\) 90% for tube efficiencies \(>\) 67%, whereas in the 3-3-3 case the tube efficiency must be greater than 78% for the same performance.

### Results

Fig. B3 shows the reconstruction efficiency of this model as a function of noise fraction for the single hit readout case for the 3-3-3 and 4-4-4 configurations. Plotted in the figure are the results of the efficiency computed from the full simulation described in this memo. We have taken the reconstruction efficiency to be the plateau numbers shown in Fig. 10 normalized to 1 at \(f_{n}\)=0 to eliminate resolution effects of the DOCA and \(\chi^{2}\) cuts (3% correction). We note reasonable agreement exists between the simple model and the full simulation. Hence we conclude that in the single-hit readout case the pattern recognition efficiency is controlled by the statistics of detecting the true hit in an MDT.

Fig. B4 are comparisons of various 3 vs. 4 layers configurations for both single vs. double hit readout. Comparing with Fig. 13b we note that the double hit readout performs less well than predicted from our spread-sheet model. In fact, as Fig. 13a and 13b indicate, the double hit readout is only marginally better than the single hit readout. We attribute this reduced performance to the readoutnoise associated with the two-hit readout electronics. The readout noise pulses can obscure a real second pulse. Further, the pattern recognition algorithm does not have a good way to discriminate readout noise from true second hits. More work is clearly needed here.

Figure B1

Figure B3

Figure B4a

[MISSING_PAGE_EMPTY:49]