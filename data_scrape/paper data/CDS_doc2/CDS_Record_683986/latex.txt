# _Atlas Muon Discussion Note_

###### Abstract

This document presents the Muon reconstruction software status and future evolutions for the coming years.

J.F.Laporte, DAPNIA/SPP CEA

## 0 Introduction

This document presents the Muon reconstruction software status and future evolutions for the coming years.

### 0.1 Introduction

This document presents the Muon reconstruction software status and future evolutions for the coming years.

### 0.2 ATLAS Reconstruction Software

The impressive work done for the Physic TDR has demonstrated the power of the existing ATLAS reconstruction software. Putting aside the problem of the tools and media for the storing and management of data, the status of the ATLAS offline software could be considered as particularly mature. Had the start of LHC been closer, this would have been acknowledged more widely.

The ATLAS Computing Review had clearly stated that it's mandatory for the success of the ATLAS software to maintain the high performance level reached by existing software through the coming change of software paradigm. This performance orientation should be one of the main driving principles of reconstruction software development.

Although the level of sophistication of the ATLAS software reconstruction in general and for the Muon reconstruction in particular, is impressive, it could not be considered that there is nothing more or little to do in this field.

Besides some pending issues specific to the reconstruction in the Muon System, the extensive use of reconstruction software during the latest months has clearly revealed that the modularity as well as users access to the outputs should be improved.

Futhermore, the coming changes of the software framework including Detector Description and Event access issues, have a direct impact on reconstruction software. Finally, it is highly desirable to facilitate the involvement of new groups as test beam analyzer teams or developers groups aiming to develop new reconstruction packages.

### 3.0 Pending issues

#### CSCs

The CSC chambers were not simulated neither for the Muon TDR nor for the Physics TDR. They have recently been included in the reconstruction algorithm but the corresponding version of the Muonbox is still to be released. The performance of the Muon System with the CSCs included is currently being evaluated.

#### Alignment

Although the task is not too problematic, according to the experts, a reconstruction algorithm taking into account the alignment corrections does not exist today. The test beam will offer an unique opportunity to test such algorithm in a realistic situation. It should be noticed that this issue leads to concrete requirements on how the Detector Description and the alignment corrections should be provided to offline reconstruction.

#### Event Filter

Although some preliminary studies exist, the Event filter requirements had up to now little impacts on Muon reconstruction software. It's far to be clear how to tune the offline Muon reconstruction control parameters in order to match those requirements. In particular the time constraints of the Event Filter step are so tiny that the use of Muon offline code at this step could be questioned.

### 4.0 New Framework and related issues

The ATLAS software framework has been up to now a traditional Fortran one. It has been decided to change it and to adopt a fully OO/C++ framework. Although it is not clear today what will be concretely the future architecture of the ATLAS software, the impacts on reconstruction software will be important.

It does not concern only the input and the output of the Muon reconstruction packages, but also the role and definition of these packages in this framework. Obviously, changing the paradigm is going to have strong impact on packages development which will be discussed in the next section.

#### Input

In the existing framework, the Description of all the subsystems but the Muon System is lying in the simulation code. In the foreseen new framework, this detector description will be provided centrally and independently of any applications having to use it.

There is a long experience in the Muon community on the questions concerning the interactions between the simulation, the reconstruction and the Detector Description. Indeed the use of a Description external to the code is one of the specificities of the Muon software w.r.t. other subsystems.

The benefits for the reconstruction are important (for example it could be "completely" decoupled from the simulation) but the pitfalls of such an approach are many although well known. In particular, this scheme has consequences on the Event model and for example it requires that each hits/digits should be accompanied by an identifier allowing to point unambiguously the detector element from which it originates. The consistency of this identifier mechanism is thus a key, even critical, issue for the reconstruction software.

A temporary C++ framework for ATLAS, PASO, has been developed in order to provide data access through C++ objects. Although PASO should not be considered as the prototype of the future ATLAS framework, it offers the opportunity to test Event access and Detector Description services prototypes. On short term, the Muon reconstruction software should be made available in this framework in order to evaluate the convenience of its services for the Muon software needs1.

Footnote 1: It is also highly desirable to access calorimeters data as easily as in the existing software (energy losses corrections purpose).

_Comment:_

Those issues are also of great importance for beam test activities related to reconstruction. Indeed, in order to involve these activities in the Muon offline software, it's mandatory to give the same format to the tests beams data and to the ones managed in the offline software. This is the preliminary work which would permit the test beam analyzers to participate to the offline software by effectively providing the same framework to these developers. Futhermore, this would allow to improve the realism of the Event model by incorporating data such as alignment data which are not yet included in the offline reconstruction as explained in the preceding section.

**Output**

There is no doubt that C++ classes offer an easy and simple user access to package outputs. Constructive proposals on track classes design have been made and discussed between the Inner Detector and Muon System communities. In addition, some more global views on reconstruction objects exist (the D.Rousseau's "ATLAS reconstruction entity list"; cf Atlas Reconstruction Web page) which make us confident about the developments on this side.

For the muon reconstruction software, the Physics TDR studies have provided invaluable experience on concrete and realistic requirements: they range from the simpler ones of the physics analyzer who wants to use directly the tracks reconstructed in the Muon System to the more demanding ones of the Muon combined reconstruction which needs access to more details. Some prototypes are being developed and will be released in the coming months.

**Role of the reconstruction packages**

The foreseen granularity of the software pieces in the new ATLAS software have not been yet defined. This architecture question is of great importance for what concerns the modularity in the ATLAS software.

It is essential to obtain the acknowledgment of the package granularity, i.e the one which goes from raw data to reconstructed tracks. This would not preclude any functional internal subdivisions of the package but would insure an effective modularity, i.e the possibility to switch in a transparent manner from a given muon reconstruction package to an other one. Futhermore, to acknowledge the importance of this granularity level, it would be a powerful guideline to re duce, as far as possible, the dependence between different packages deriving from the dependence between their internal components.

### Muon Reconstruction Packages

In this section, one first reviews the presently available reconstruction packages before envisioning what could be a possible model for the Muon reconstruction package development.

**Muonbox**

Today, the Muonbox package dominates largely the field of Muon reconstruction. This package has been the only one which had allowed the muon community to study the reconstruction performance of the Muon Spectrometer in the Muon TDR and to participate to the Physics TDR.

Due to the great experience which it encapsulates, there will be for a while no alternative package allowing to address the Muon System or Muon combined reconstruction at the same level of complexity and realism.

Muonbox is a pure Fortran package. As clearly stated by its main author, this package will not be translated into C++ but it will be made available into a C++ framework by wrapping means. Given the importance of this package for the study of the detector, none responsible software policy could be conceived which would lead to the explicit or implicit exclusion of this package.

_Comment:_

The main problem of the Muon Software reconstruction is not the refusal of the C++ translation of Muonbox. Had it been translated, this package would remain the unique package presenting performance comparable to the packages of the other subsystems. The main problem of the Muon Software reconstruction is that there was and there is still no alternative package as mature. The question of the language is largely irrelevant to this respect. The Muon reconstruction software situation would be improved if, as in the Inner Detector reconstruction, at least two packages could compete. It is thus of great importance to promote the development of additional Muon reconstruction packages.

**Amber**

Amber is a full C++ package. It is one of the very few really OO engineered ATLAS packages. This package is today the only existing alternative to Muonbox. It has clearly not the same level of maturity. This should not be a inhibitory problem if the medium/long term maintenance situation of this package is clarified.

The use of Amber having been limited to a very restricted number of users, it would not be sensible to envision the necessary adaptations to the coming new framework nor the necessary tuning of the algorithms, which all imply deep changes at the implementation level, without the involvement of the authors.

Clear commitment for the maintenance of Amber is mandatory for the future of this package.

### New package development

A scenario could be envisioned on a collective basis provided that few institutes accept to commit effectively and firmly themselves to contribute to a new package1.

Footnote 1: This would be mandatory if no institute is willing to take the responsibility to maintain Amber nor to develop a new package.

Indeed, there are enough documents publicly available around both on Muonbox and Amber designs, to envision that a team of developers from different institutes can design from scratch a new realistic design. Proceeding with careful realism, this could lead to a partitioning of the package between the different participants for the implementation work.

To start from scratch is here mandatory, in order to be free w.r.t. to design and implementation. Also it's more than probable that this kind of project imposes a small number of participants both for the effectiveness of the collective work and in order to preserve a sensible size to the partitioned pieces.

In this scheme, the Muon reconstruction responsible could be expected to provide the initial elements of this project and help to manage it at least at the beginning. On the medium term, however, this project should gain its complete autonomy.

The above scenario is no more than a way to promote the development of an additional Muon reconstruction package by involving institutes willing to contribute to such package without having the possibility to take the responsibility a of complete package. This project is thus very specific to the actual Muon Reconstruction situation. It would be highly experimental since it has no antecedent elsewhere in ATLAS Reconstruction software. Finally, it should be decoupled from any premature considerations on MOU for the offline software which could jeopardize its success.

### Time Table

#### Short term (up to February 2000)

1. The latest Muonbox version including the CSCs in the reconstruction algorithm should be released and the evaluation of resulting performance should be completed
2. Amber should be made available on Unix platforms provided that Amber maintenance is insured
3. Muonbox should be made available in a C++ framework by wrapping means
4. In order to maintain working chain from simulation to reconstruction, the G4 simulation based on AMDB (the existing Muon Detector Description) should be completed and tested by Muon reconstruction packages

#### Medium Term (Up to Summer 2000)

1. A common track class should be defined to be used both by Muon System and ID reconstructions
2. A plan should be set to evaluate the Amber performance3. Contact should be established with the Event Filter group in order to define a working procedure to investigate the needs of this group.
4. The Muon community interest for a new Muon reconstruction package development on a collective basis should be evaluated. If participants are found, the work of the design should start soon after.
5. The Muon reconstruction software should be made available in the PASO framework in order to test and to evaluate of the Event access and Detector Description services.
6. The convenience for the Muon reconstruction software of the recent Detector Description in the XML format, AGDD, should be evaluated
7. Reconstruction algorithms including the alignment corrections should be developed.

### Summary

There is confidence that the few issues on the reconstruction in the Muon System which are still pending would be solved in the short/medium term.

The change of software framework and paradigm is going to have great impacts on the Muon reconstruction software. Although the Muon community is well positioned, thanks to its past experience on these issues, the change of inputs, namely the Detector Description and Event model are critical points for the reconstruction. In particular, special emphasis should be put on these issues in order to define a common framework to beam test and offline softwares.

Although the Muon community has a powerful package at its disposal with Muonbox, additional packages should be promoted. There are some concerns about the most obvious alternative package, Amber. In consequence, one should be ready to envisage specific scenario for the development of a new Muon reconstruction package on a collective basis.