EUROPEAN ORGANIZATION FOR NUCLEAR RESEARCH

**ATLAS Internal Note MUON-NO-1051 February 1995 Charge Division and Intrinsic Pulse Shaping in Drift Tubes**

M. Deile, J. Dubbert, N.P. Hessey University of Munich

**Abstract**

We present an analytical calculation of the pulse shaping due to the tube and associated passive electronics components. The calculations include the skin effect and the tube's properties as a coaxial transmission line. The formulae also give the fraction of charge arriving at the preamplifier end as a function of time. This fraction is important in determining the gas gain.

In addition our method yields the dependence of the collected charge on the event position along the tube.

Introduction

Figure 1 shows the typical drift tube setup including the passive electronics components. For ATLAS MDT's the high voltage end will be "correctly" terminated according to the tube's wave impedance in order to reduce reflections that can deteriorate the signal shape. The signal end will have a protective resistance of about 30 \(\Omega\) plus the preamplifier input impedance which will be kept low. This maximizes the signal into the preamplifier. The formulae for the termination impedances are given in section 4.

The tube's properties as a coaxial transmission line as well as the high-voltage-decoupling capacitors at both ends of the anode wire introduce the complication of frequency dependent impedances resulting in pulse distortions even before reaching the preamplifier.

Therefore we calculate the current signal on the wire, which is induced by positive ions drifting to the cathode, and compute its frequency spectrum by Fourier Analysis. Using a complex frequency dependent transfer function we can then determine the signal seen by the preamplifier. This is important in many fields, e.g. computer simulation of drift tubes.

Only a fraction of the signal charge deposited on the wire is extracted by the preamplifier, the rest is lost at the high voltage end. From the input and output signals one can calculate the charge fraction arriving within an ADC gate, so that the total charge can be inferred from the charge measured by an ADC. This is an important ingredient in gas gain studies.

The signal seen by the preamplifier depends on where along the wire the avalanche

Figure 1: Schematic of the setup

occurs. For a 6 m tube, for short integration times (about 20 ns) the signal height from the remote end is about half that from the near end (section 7).

## 2 Generation of the Signal on a Wire

Consider an electron avalanche arriving at the wire in the longitudinal position \(x_{0}\). For simplicity we neglect the avalanche's lateral extent. In the following we will focus on one particular ion with charge \(+e\), which is created at the time \(t=0\) near the surface of the wire at a radial distance \(r_{0}\) and then drifts towards the tube wall.

Our first aim is to determine the current signal \(j(t)\) induced in the anode wire. Under the assumption that the wire is kept at a constant potential by a large charge reservoir - in our case realized by the big capacitors \(C_{1}\) and \(C_{2}\) - we may apply Ramo's theorem [1]:

\[j(r)=-\frac{e}{V}\,v(r)\cdot E(r)\,, \tag{1}\]

where \(r\) is the actual radial position of the ion, \(V\) the high voltage and \(E\) the electric field. For tubes with a central wire

\[E(r)=\frac{V}{r\,\ln\frac{b}{a}}\,, \tag{2}\]

where \(a\) is the wire radius and \(b\) the inner radius of the tube. So we obtain \(j(t)\) parametrized in terms of \(r\):

\[j(r)=-\frac{e}{\ln\frac{b}{a}}\cdot\frac{v(r)}{r} \tag{3}\]

\[t(r)=\int_{r_{0}}^{r}\frac{dr^{\prime}}{v(r^{\prime})} \tag{4}\]

Usually only the case of low electric fields is considered, where \(v(r)=\mu\,E(r)\) with a constant ion mobility \(\mu\). Then it is straightforward to show that

\[j(t)=\begin{cases}\frac{e}{2\ln\frac{b}{a}}\cdot\frac{1}{t+t_{0}}&\text{for } 0\leq t\leq t_{max},\\ 0&\text{otherwise}.\end{cases} \tag{5}\]

The time constant \(t_{0}\) (12.5 ns for a 50 \(\mu\)m wire) is given by

\[t_{0}\equiv\frac{r_{0}^{2}}{2\,\mu\,V}\ln\frac{b}{a} \tag{6}\]

and \(t_{max}\) is the arrival time of the ion at the tube wall (around 4 ms):

\[t_{max}\equiv\int_{r_{0}}^{b}\frac{dr^{\prime}}{\mu\,E(r^{\prime})}=\frac{b^{ 2}-r_{0}^{2}}{2\mu V}\ln\frac{b}{a}\,. \tag{7}\]

\(j(t)\) has the form \(1/(t+t_{0})\) whenever the mobility is proportional to a real power (except 2) of the field \(E\). At high fields \(\mu\propto E^{-\frac{1}{2}}\). Therefore the current has the \(1/(t+t_{0})\) shape, but with a different \(t_{0}\).

The important field region for triggering the discriminator is that near the wire surface. For our typical operating conditions (\(V=3.1\) kV, gas mixture containing essentially Argon at 3 bar) \(E(a)\) is between the two limiting cases which makes a numerical solution of (3) and (4) necessary (figure 2).

Figure 3 compares the pulse shapes for a realistic \(\mu(E)\) (numerical calculation for the above given example with \(r_{0}=a\)) with that for a constant \(\mu\). The realistic pulse has much less amplitude at \(t=0\) (68 %) but is broader: Its FWHM is 23 ns compared to 13 ns for the constant mobility case.

Figure 2: Ion velocity in Ar as a function of the reduced electric field (from [1])

Propagation of the Signal along the Tube

The wire resistance \(R\) depends on the angular frequency \(\omega\) of the propagating wave via the skin effect. We approximate it, following [3] and [4], by

\[R(\omega)=\begin{cases}\frac{1}{\pi\,\sigma\,a^{2}}\,+\,\frac{\sigma\,\mu_{B}^{2 }\,a^{2}}{19\,2\,\pi}\,\omega^{2}&\text{for}\,\,\,\omega<\frac{8}{a^{2}\, \sigma\,\mu_{0}}\\ \frac{1}{2\,\pi\,\alpha}\,\sqrt{\frac{\mu_{0}\,\omega}{2\,\sigma}}\,+\,\frac{1 }{4\,\pi\,\sigma\,a^{2}}\,+\,\frac{3}{32\,\pi\,a^{3}}\,\sqrt{\frac{2}{\sigma^{3 }\,\mu_{0}\,\omega}}&\text{for}\,\,\,\omega>\frac{8}{a^{2}\,\sigma\,\mu_{0}} \end{cases} \tag{8}\]

where \(\sigma\) is the conductance of the wire material. Figure 4 shows \(R(\omega)\).

In the wire the signal current splits up in two equal portions travelling towards the tube ends. The propagation along the tube is ruled by the properties of a coaxial transmission line with the characteristic complex wave impedance [2] depending on the frequency:

\[Z_{0}(\omega)=\sqrt{\frac{R(\omega)+i\,\omega\,L}{G(\omega)+i\,\omega\,C}}\,. \tag{9}\]

In a gas-filled drift tube the transconductance \(G\) vanishes. Therefore (9) becomes:

\[Z_{0}(\omega)=\sqrt{\frac{L}{C}\bigg{(}1+\frac{R(\omega)}{i\,\omega\,L}\bigg{)}} \tag{10}\]

Figure 5 shows \(Z_{0}(\omega)\) with its well-known limiting behaviour for high frequencies:

\[Z_{0}(\omega)\rightarrow\sqrt{\frac{L}{C}}\,. \tag{11}\]

which gives the correct termination resistance \(R_{1}\). Table 1 shows termination resistances for various wire diameters.

Figure 4: Resistance of a 50 \(\mu\)m wire (CuBe) per unit length

\(L\) and \(C\), the inductance and capacitance per unit length, are determined by the tube's geometry:

\[L = \frac{\mu}{2\,\pi}\,\ln\,\frac{b}{a} \tag{12}\] \[C = \frac{2\,\pi\,\varepsilon}{\ln\frac{b}{a}} \tag{13}\]

For gases the dielectric and diamagnetic constants are \(\varepsilon\approx\varepsilon_{0}\) and \(\mu=\mu_{0}\).

The wire resistance gives rise to dispersion [2] that is characterized by the wave number \(k(\omega)\) and the attenuation coefficient \(\alpha(\omega)\):

\[k(\omega) = \sqrt{\frac{1}{2}\,\left[\omega\,C\,\sqrt{R^{2}(\omega)+\omega^{ 2}\,L^{2}}+\omega^{2}\,L\,C\right]} \tag{14}\] \[\alpha(\omega) = \sqrt{\frac{1}{2}\,\left[\omega\,C\,\sqrt{R^{2}(\omega)+\omega^{ 2}\,L^{2}}-\omega^{2}\,L\,C\right]} \tag{15}\]

\begin{table}
\begin{tabular}{|c|c|} \hline Wire diameter \(2\,a\) [\(\mu\)m] & Terminator \(R_{1}\) [\(\Omega\)] \\ \hline
30 & 413 \\
40 & 395 \\
50 & 382 \\
60 & 371 \\
70 & 362 \\
100 & 340 \\
160 & 312 \\ \hline \end{tabular}
\end{table}
Table 1: Terminators for various wire diameters (inner tube radius = 1.46 cm)

Figure 5: Wave impedance of a drift tube with \(a=25\)\(\mu\)m, \(b=14.6\) mm (left: modulus, right: phase)

Figure 6 shows \(k(\omega)\) and \(\alpha(\omega)\).

The consequence of dispersion and attenuation is that after travelling a distance \(\Delta x\) along the tube, each Fourier component of the signal current is modified by the propagator

\[T(\Delta x)\equiv e^{-|\alpha(\omega)-ik(\omega)|\,\Delta x} \tag{16}\]

## 4 Reflections at the Tube Ends

What happens when the pulse reaches the tube ends?

To be strictly accurate, we would have to take the impedance of the end plug into account, which is different from the tube impedance due to a different geometry and the solid dielectric around the wire. However, these end plugs being very short (2 cm) compared to the tube, their influence will be restricted to wavelengths meeting the condition \(\lambda<2\) cm corresponding to frequencies \(f>15\) GHz or time structures \(<0.07\) ns which is outside the relevant range. We will therefore neglect the end plug effects and only consider reflections occurring at the interfaces between the tube and the terminations, which are assumed pointlike.

From figure 1 we can immediately write down the HV end and signal end termination impedances \(Z_{1}\) and \(Z_{2}\):

\[\frac{1}{Z_{1}} = \frac{1}{R_{0}}+\frac{1}{R_{1}+\frac{1}{i\,\omega\,C_{1}}} \tag{17}\] \[Z_{2} = R_{2}+\frac{1}{i\,\omega\,C_{2}} \tag{18}\]

Figure 6: Wave number (left) and attenuation (right) as a function of frequency

The reflection coefficients \(\rho_{1}\) and \(\rho_{2}\) are given by [2]:

\[\rho_{1}(\omega) = \frac{Z_{1}(\omega)-Z_{0}(\omega)}{Z_{1}(\omega)+Z_{0}(\omega)} \tag{19}\] \[\rho_{2}(\omega) = \frac{Z_{2}(\omega)-Z_{0}(\omega)}{Z_{2}(\omega)+Z_{0}(\omega)} \tag{20}\]

and the preamplifier side transmission coefficient

\[\tau_{2}(\omega)=1-\rho_{2}(\omega) \tag{21}\]

The reflected part of the pulse travels back to the other end of the tube where it is again partially reflected and so on.

## 5 The Transfer Function

We can now define a complex transfer function \(\Psi(\omega)\) by

\[\tilde{I}(\omega)=\Psi(\omega)\cdot\tilde{j}(\omega) \tag{22}\]

where \(\tilde{j}(\omega)\) and \(\tilde{I}(\omega)\) are the Fourier transforms of the initial ion signal and the output current seen by the preamplifier.

Summing up the contributions to \(\tilde{I}(\omega)\) from all possible paths to the preamplifier yields

\[\Psi=\frac{1}{2}\tau_{2}\,T(l-x_{0})+\frac{1}{2}\tau_{2}\,T(l)\,\rho_{1}\,T(x _{0})+\frac{1}{2}\tau_{2}\,T(l)\,\rho_{1}\,T(l)\,\rho_{2}\,T(l-x_{0})+\cdots \tag{23}\]

where \(T\) is the propagator defined in (16). This infinite geometric series gives:

\[\Psi=\frac{1}{2}\,\tau_{2}\,T(l-x_{0})\,\frac{1+\rho_{1}\,T(2\,x_{0})}{1-\rho_ {1}\,\rho_{2}\,T(2\,l)} \tag{24}\]

Substituting for \(T\) from (16) one finally obtains

\[\Psi(\omega)=\frac{1}{2}\,\tau_{2}(\omega)\,e^{-|\omega(\omega)-i\,k(\omega)| \,(l-x_{0})}\,\frac{1+\rho_{1}(\omega)\,e^{-|\alpha(\omega)-i\,k(\omega)|\,2x _{0}}}{1-\rho_{1}(\omega)\,\rho_{2}(\omega)\,e^{-|\alpha(\omega)-i\,k(\omega)| \,2l}} \tag{25}\]

Note that \(\Psi\) is sensitive to the longitudinal avalanche position \(x_{0}\)!Figure 7 shows \(\Psi(\omega)\) for the setup we used for our beamtest measurements at CERN:

\(R_{0}=1\) M\(\Omega\), \(R_{1}=382\)\(\Omega\), \(R_{2}=55\)\(\Omega\), \(C_{1}=C_{2}=470\) pF, \(a=25\)\(\mu\)m, \(b=14.6\) mm, \(l=1\) m, \(x_{0}=0.5\) m, Cu Be-wire: \(\sigma=9\cdot 10^{6}\)\((\Omega\,\mathrm{m})^{-1}\).

We see four frequency domains:

* Below \(10^{3}\) s\({}^{-1}\) no signal is extracted on the preamplifier side because all the charge leaks out through the HV resistor \(R_{0}\) at the HV end.
* Between \(10^{3}\) and \(10^{7}\) s\({}^{-1}\), the termination impedances \(Z_{1}\) and \(Z_{2}\) are dominated by the capacitors \(C_{1}\) and \(C_{2}\). Since \(C_{1}=C_{2}\) we have a plateau at \(\frac{C_{2}}{C_{1}+C_{2}}=\frac{1}{2}\).
* Between \(10^{7}\) and \(10^{10}\) s\({}^{-1}\), \(Z_{1}\) and \(Z_{2}\) are dominated by the resistors \(R_{1}\) and \(R_{2}\) which gives a plateau near \(1-\frac{R_{2}}{R_{1}}\).
* Beyond \(10^{10}\) s\({}^{-1}\), \(\Psi(\omega)\) approaches 0 because for these high frequencies the attenuation becomes important (\(\alpha\sim 1\,\mathrm{m}^{-1}\) as shown in figure 6).

Beyond \(\omega\sim 10^{9}\) s\({}^{-1}\) the tube becomes a resonant cavity for all frequencies \(\omega_{n}=n\cdot\frac{2\pi}{l}\) with \(l=1\) m. This causes the phase oscillations in figure 7 which look chaotic due to the logarithmic scale and the finite plot resolution.

Figure 7: Modulus (left) and phase (right) of the transfer function (for parameters see text)

Fourier Transform of the Ion Pulse and Composition of the Output Current

The Fourier transformation of the current signal, defined by

\[\tilde{j}(\omega)=\frac{1}{\sqrt{2\,\pi}}\,\int_{-_{\infty}}^{\infty}\,j(t)\,e^ {-i\omega t}\,dt \tag{26}\]

has to be performed numerically. Figure 8 shows the Fourier transform of an ion pulse at \(V=3.1\,\)kV for one elementary charge. The input pulse was taken from the numerical solution of (3) and (4) with variable \(\mu(E)\).

Referring to (22) we can finally determine the output current

\[I(t)=\frac{1}{\sqrt{2\,\pi}}\,\int_{-_{\infty}}^{\infty}\,\tilde{I}(\omega)\,e^ {i\omega\,t}d\omega=\frac{1}{\sqrt{2\,\pi}}\,\int_{-_{\infty}}^{\infty}\,\Psi( \omega)\,\tilde{j}(\omega)\,e^{i\omega\,t}d\omega \tag{27}\]

and the charge collected by the preamplifier within the time \(t\):

\[Q(t)=\int_{0}^{t}\,I(t^{\prime})\,dt^{\prime} \tag{28}\]

Both Fourier integrals were approximated using discrete Fast Fourier Transformation routines for a periodically continued input pulse with a length of \(4.5\,\)ms (= total ion drift time). For achieving an output resolution of \(8\,\)ns we had to perform the transformations with \(2^{19}=524288\) points, which led to big data files (25 Mb) and necessitated a large amount of computing time (\(1\,\)h for the complete procedure). With the routines that we currently use, an improvement by a factor 2 would extend this time to more than a day. We are however working on improvements in this field.

Figures 9 and 10 compare the output current and charge with the corresponding input quantities for the parameter values given on page 8.

Figure 8: Modulus (left) and phase (right) of an ion pulseâ€™s Fourier transform

[MISSING_PAGE_FAIL:11]

[MISSING_PAGE_EMPTY:12]

Effect of Avalanche Position along the Wire

Finally we investigated the dependence of the charge seen by the preamplifier, \(Q_{out}(t)\), on the position \(x_{0}\) of the avalanche along the wire.

\(Q_{out}(t)\) at short times (\(\sim\) 20 ns) determines the trigger time and hence affects resolution; at longer times (ADC gate width \(\sim\) 0.5 - 10 \(\mu\)s) it is important for gain calculation.

To illustrate and quantify the effect, we plot \(Q_{out}(t)/q_{in}(t)\) for various \(t\) as a function of avalanche position \(x_{0}\) (figure 12). Normalizing to \(q_{in}(t)\) (rather than to the total charge \(q_{in}(\infty)=e\)) illustrates better the effect of charge division and dispersive shaping on \(Q_{out}(t)\).

As expected, the nearer to the preamplifier the avalanche occurs, the larger is the output signal. For 6 m tubes at short times (\(\sim\) 20 ns), which are important for the discriminator, signals from the HV end will be about half those from the preamplifier end.

For \(x_{0}=l\) where there is no attenuation, shorter times have higher \(Q_{out}/q_{in}\) because they involve higher frequencies, for which the preamplifier termination has lower impedance (see equation (18)).

The slope of the curves is due to the attenuation of the signal as it travels along the tube. The attenuation is greatest for high frequencies, and so the curves are steeper for shorter times.

In long tubes the attenuation in the tube is enough to cause the curves for different times to cross. So below some \(x_{0}\), the order of the curves is inverted. The lines all cross at one point (\(X_{0}\) on the plot), which seems to be related to the transfer function being flat over the frequency range corresponding to the time range covered in figure 12. This means that there is no distortion of frequency components within the considered range.

Figure 12: Charge fraction for different collection times as a function of the avalanche position \(x_{0}\)

Conclusions

We have described the current signal on the wire, including the effects of non-constant mobility. Formulae for the propagation of the signal to the preamplifier have been derived which can be applied generally to any input pulse. Numerical calculations give the signal shape as seen by the preamplifier.

The method is useful for modelling pulse shapes, calculating gas gains, studying the dependence of signal shape on position of avalanche along the wire, and in many other regions.

## References

* [1] W. Blum, L. Rolandi: Particle Detection with Drift Chambers, Springer 1993, chapters 2 and 5
* [2] W. R. Leo: Techniques for Nuclear and Particle Physics Experiments, Springer 1994, chapter 13
* [3] J. Babion: Messung des Hochrequenzverhaltenseines Myonen- Detektor-Prototypen (Driftrohr) fur das ATLAS-Projekt des LHC, Practicum Report, University of Munich 1993, unpublished
* [4] Becker, Sauter: Theorie der Elektrizitat I, Teubner 1959, SS60
* [5] C. Blocker et al.: Noise Considerations for the Atlas Muon Front End Electronics, ATLAS Muon Note 80