# B-physics performance with Initial and Complete Inner detector layouts in Data Challenge 1

N. Benekos\({}^{1}\), H. Bilokon \({}^{2}\), E. Bouhova-Thacker\({}^{4}\), B. Epp\({}^{3}\), V.M. Ghete\({}^{3}\), R. Jones\({}^{4}\), V. Kartvelishvili\({}^{4}\), T. Lagouri\({}^{9}\), J.F. Laporte\({}^{6}\), A. Nairz\({}^{3}\), N. Nikitine\({}^{5}\), P. Reznicek\({}^{7}\), S. Sivoklokov\({}^{5}\), M. Smizanska\({}^{4}\), M. Testa \({}^{8}\), K. Toms\({}^{5}\).

\({}^{1}\)Max-Planck-Institut fur Physik, Munchen, Germany

\({}^{2}\)INFN, Frascati, Italy

\({}^{3}\)Institute for Experimental Physics, University of Innsbruck, Austria

\({}^{4}\)University of Lancaster, Lancaster, UK

\({}^{5}\)Moscow State University, Russia

\({}^{6}\)CEA, Centre d'Etudes de Saclay, Gif-sur-Yvette, France

\({}^{7}\)Charles University, Prague, Czech republic

\({}^{8}\)Universit di Roma I "La Sapienza", Italy

\({}^{9}\)High Energy Physics Department, Aristotle University of Thessaloniki, Thessaloniki, Greece

###### Abstract

The B-physics performance for the Initial and the Complete Inner Detector layouts is presented. Selected types of B-physics events were simulated, reconstructed and analyzed using the software tools of ATLAS Data Challenge-1 (DC1). The results were compared to those obtained with an older ATLAS detector design the so-called TDR layout. Within the limitations of the DC1 software tools an attempt was made to evaluate the performance loss due to missing detector parts in the Initial layout in comparison with the Complete detector.

###### Contents

* 1 Introduction
* 2 Tools and datasets
	* 2.1 Preparation of the data sets
		* 2.1.1 Physics channels, Event Generation
		* 2.1.2 Inner Detector layouts
		* 2.1.3 Detector simulation
	* 2.2 Reconstruction software
		* 2.2.1 Releases, versions used in B-physics studies
		* 2.2.2 Pattern recognition options
		* 2.2.3 Pixel clusters errors
		* 2.2.4 Track Selection
	* 2.3 Software used for physics analysis
	* 2.4 Methods of physics analysis
		* 2.4.1 \(\mathrm{B_{s}}\)\(\rightarrow\mathrm{D_{s}}\pi\)
		* 2.4.2 \(\mathrm{B_{s}}\)\(\rightarrow\mathrm{J/\psi\phi}\)
		* 2.4.3 \(\mathrm{B_{d}}\)\(\rightarrow\mathrm{J/\psi K_{s}^{0}}\) and \(\Lambda_{\mathrm{b}}^{0}\)\(\rightarrow\mathrm{J/\psi\Lambda^{0}}\)
		* 2.4.4 \(\mathrm{B_{s}}\)\(\rightarrow\mu\mu\)
		* 2.4.5 \(\mathrm{J/\psi\rightarrow\mathrm{ee}}\)
* 3 Validation of software and of reconstruction algorithms
	* 3.1 Checks of mass reconstruction precision
	* 3.2 Selection of the optimal reconstruction for B events
	* 3.3 Athena versus atrecon - sensitivity to simulation details
	* 3.4 Conclusions about software validation
* 4 Performance for single particles
	* 4.1 Transverse impact parameter resolution
	* 4.2 Single track momentum resolution
* 5 B-physics performance
	* 5.1 Consequences of ID changes on mass reconstruction
	* 5.2 Proper-time resolution: impact of the new b-layer radius and material increase
	* 5.3 Difference due to longer b-layer pixels
	* 5.4 Sensitivity of results to differences between Initial and Complete layouts
		* 5.4.1 Signal events without pile-up
		* 5.4.2 Signal events with pile-up
* 6Conclusions
* 7 Acknowledgements
* A Appendix
* A.1 Electron reconstruction in \(\mathrm{B_{d}}\to\mathrm{J}/\psi(\mathrm{ee})\;\mathrm{K_{s}^{0}}\) comparison to TDR
* A.2 \(\Lambda^{0}\) reconstruction, changes since the TDR
* A.3 \(\mathrm{K^{0}}\) reconstruction, changes since the TDR
Introduction

The ATLAS detector design has evolved since the Physics TDR [1] was written, and these changes have been implemented in the DC1 software. DC1 therefore provided the first opportunity to study the B-physics performance of the detector that will be available in the initial LHC period (the so-called 'Initial layout", [2]). Another goal of the study was to determine the improvement in performance which can be expected when the detector parts missing in the Initial layout, are finally installed.

In addition, the new ATLAS software required for the performance study had to be validated. Both the validation and the performance studies had to be done simultaneously.

Several iterations were carried out, following the main releases of the DC1 software and taking into account their readiness for different versions of the new detector layouts. In this document the emphasis is on the successful releases, while the ones in which serious errors were detected are mentioned only briefly (although these were important in the validation process).

The document is divided into three main parts. The first part (section 2) describes the preparation of the datasets, software tools and methods of analysis. The second part follows the software validation (section 3). The third part occupies the bulk of the document. It presents the performance results for single particles (section 4) and for B-physics events (section 5). Following the conclusions (section 6), the three appendices are devoted to particular problems of the \(\mathrm{J}/\psi\rightarrow\mathrm{ee}\), \(\Lambda^{0}\rightarrow\mathrm{p}\pi\) and \(\mathrm{K}^{0}_{\mathrm{S}}\rightarrow\pi^{+}\pi^{-}\) reconstruction.

## 2 Tools and datasets

### Preparation of the data sets

The institutes used local installations of the ATLAS DC1 software using RPM [3]. A small part of the work was done at CERN using afs. The files were finally transfered to CERN from the outside institutes using ftp and stored in CERN Castor [4]. All B-physics events were concentrated at a place dedicated to the B physics group /castor/cern.ch/atlas/project/bphys/ with read access to the whole ATLAS community.

The studies consisted of four steps. The first, called generation, used an interface to Pythia to generate p-p collisions. The so called Generator events produced in this step were written to persistent output files and served as inputs to the second step - a detector simulation. The third step consisted of digitization and the reconstruction of the Simulated events. The final step was physics analysis of the reconstruction output. The generation and the reconstruction, were already part of the new ATLAS software package Athena [5] and were written in C++. The detector simulation and the physics analysis of the reconstructed events were not part of Athena in the DC1 period.

#### 2.1.1 Physics channels, Event Generation

Most of the Generator events used in the present study were generated in the TDR period (1996-2001), using a fortran interface atgenb [6], to Pythia5.7. The files were written in ZEBRA format. In several channels additional events were produced in DC1 using a dedicated Athena algorithm, PythiaB [7], an interface to Pythia6.2. A special set of Pythia parameters was tuned using CDF B-production data and LEP B-decays results. The output files were written in Root format. Both ZEBRA and Root format were allowed as an input into the detector simulation. The selection of physics channels for validation was driven by the following criteria:

* Different topologies: a B-decay with large opening angle (\(\rm B\rightarrow\mu\mu\)), a four-hadrons final state channel with several sub-mass constraints like \(\rm B_{s}\ \rightarrow\rm D_{s}\pi\).
* Secondary particles decaying in channels favourable for detection: \(\rm J/\psi\rightarrow\mu\mu\), \(\rm J/\psi\rightarrow\rm ee\), \(\rm\phi\rightarrow\rm K^{+}K^{-}\).
* Secondary particle with problematic reconstruction: \(\rm K^{0}_{S}\) and \(\Lambda\).
* available experts and well documented TDR results.

The summary of the Pythia events used in this document is in Table 1.

#### 2.1.2 Inner Detector layouts

Over the period 1996-2001 the B-physics group used the so called TDR layout [8]. The changes in the detector geometry since the TDR were implemented in the DC1 software used in this study. The Beauty physics performance is expected to be influenced most strongly by the changes in the pixel modules. The radius of the innermost pixel layer (b-layer) has been increased from 4.3 cm to 5 cm to accommodate a larger diameter beam-pipe and the material in the pixel modules has increased by a factor of 1.5 after the final engineering designs. The material distribution in the Inner detector is shown in Fig 1, where it can be seen that the combined radiation length of all detectors is around \(0.3X_{0}\) at \(\eta=0\) and \(1.0X_{0}\) at \(|\eta|=2\) in DC1, Fig 1.a, while for the TDR the values were around \(0.28X_{0}\) at \(\eta=0\) and \(0.6X_{0}\) at \(|\eta|=2\), Fig 1.b.

The present study compares the B-physics performance of four different Inner detector layouts with the principal parameters summarized in Table 2. For B-physics the most relevant is the so called 'Initial' layout, that will be installed for first data-taking. In this configuration the second pixel layer will be only partially installed and inactive. The other parts which will be missing in the Initial layout are the second pixel disk and the forward TRT wheels. The missing parts will be installed later and the corresponding layout is called 'Final' layout ( or 'Complete' layout ). In both of these layouts the new longitudinal size of the b-layer pixels is \(400\ \mu m\) instead of the originally designed \(300\ \mu m\). To be consistent with other DC1 validation teams we have taken into account another, so called 'DC1-300' layout, which is consistent with the 'Final' layout with the b-layer pixels size decreased to \(300\ \mu m\).

\begin{table}
\begin{tabular}{l|l l l l} \hline Channel & \(p_{\rm T}\) cuts at & Stat & Group & DSET \(\#\) \\  & generator & Evts & in charge & \\  & level, in GeV & & & \\ \hline \(\rm B_{s}\ \rightarrow\rm D_{s}\pi\), \(\rm D_{s}\rightarrow\phi(K^{+}K^{-})\pi\) & \(\pi 0.5,\ \rm K0.5\) & 50k & Innsbruck & 012600 \\ \(\rm B_{s}\ \rightarrow\rm J/\psi(\mu\mu)\ \phi(K^{+}K^{-})\) & \(\mu 6\mu 3,\ \rm K0.5\) & 12k & Lancaster, & 011849-50 \\  & & & Thessaloniki & 011798-802 \\ \(\rm B_{d}\rightarrow\rm J/\psi(ee)\ K^{0}_{s}(\pi^{+}\pi^{-})\) & \(\rm e4e4,\ \pi 0.5\) & 8k & Lancaster & 010136 \\ \(\rm B_{d}\rightarrow\rm J/\psi(\mu\mu)\ K^{0}_{s}(\pi^{+}\pi^{-})\) & \(\mu 6\mu 3,\ \pi 0.5\) & 8k & Lancaster, & 010714-8 \\  & & & Roma,Saclay & \\ \(\rm B_{s}\rightarrow\mu\mu\) & & \(\mu 6\mu 5\) & 30k & Moscow & 012467 \\ \(\rm\Lambda^{0}_{b}\ \rightarrow\rm J/\psi(\mu\mu)\ \Lambda^{0}\ (p\pi)\) & \(\mu 6\mu 3,\,p0.5,\ \pi 0.5\) & 20k & Prague & 010137-9 \\ \hline \end{tabular}
\end{table}
Table 1: B-physics channels selected for Data Challenges 1 validation and the institutes in charge of the simulation, reconstruction and validation analyses.

#### 2.1.3 Detector simulation

The detector simulation was done with atlsim [9], an ATLAS interface to geant3 written in fortran. In the DC1 period simulation was not implemented in Athena. Several interfaces allowed different types of input files: ZEBRA, Root and Objectivity.

The B-physics validation work started with the atlsim release 3.2.1, a branch frozen since 9th July 2002. This version was adopted to simulate all Inner detector layouts needed for our study; however several corrections had still to be made. Most of the validation studies used atlsim release 6.0.3 which accepted input Generator files written in Root format, and it included corrections to the RPC digits and to the TRT high energy thresholds.

In the silicon detectors the single channel noise and inefficiency were randomly generated in the simulation with specifications similar to those applied for the Physics TDR.

The events were simulated in an inhomogeneous magnetic field, i.e. a realistic magnetic field in the

\begin{table}
\begin{tabular}{|l|l l l l|} \hline Inner detector & TDR & ’DC1-300” & Initial & Final \\ Layout & & & & (Complete) \\ \hline Radius of b-layer & \(4.3\) cm & \(5.05\) cm & \(5.05\) cm & \(5.05\) cm \\ Radius of middle pixel layer & \(11.0\) cm & \(8.85\) cm & staged & \(8.85\) cm \\ Radius of last pixel layer & \(14.2\) cm & \(12.25\) cm & \(12.25\) cm & \(12.25\) cm \\ Pitch Z in b-layer & \(300\)\(\mu\)m & \(300\)\(\mu\)m & \(400\)\(\mu\)m & \(400\)\(\mu\)m \\ Number of Pixel disks & 4 & 3 & 2 & 3 \\ End-cap TRT ’C’ wheels & present & present & staged & present \\ \hline \end{tabular}
\end{table}
Table 2: Summary of the changes in the geometry - most relevant for the B-physics performance - for the four Inner Detector layouts, the TDR - used in 1996-2001, the DC1 layout used at the beginning of the DC1 studies and the Initial and Final( Complete) layouts that will be installed by ATLAS.

Figure 1: Cumulative distribution of material distribution in number of radiation lengths as a function of \(\eta\) for pixels, SCT, TRT and external services. (a) New detector (DC1) layout [2] ; (b) TDR layout [8]Inner detector. \(\rm K^{0}\) and \(\Lambda\) hyperons were first decayed in Pythia - in case if they were part of a signal B-hadron chain. Then they were re-taken by atlsim and allowed to traverse and interact with the detector. In case a hyperon did not interact inelastically it was 'decayed' again: its original Pythia decay was transfered into a new vertex.

Part of the study was done with the B signal events combined with pile-up corresponding to a luminosity of \(2\cdot 10^{33}{\rm cm}^{-2}{\rm s}^{-1}\). We used the minimum bias events generated and simulated by other DC1 groups [10]. The detector simulation done with atlsim release 6.0.3. For mixing of B-signal events with minimum bias events atlsim release 7.0.2 was used.

### Reconstruction software

#### 2.2.1 Releases, versions used in B-physics studies

The reconstruction software changed in DC1 from the older - atrecon or atlsim environments to reconstruction in Athena. However all three environments: atrecon [12], atlsim and Athena were supported through all DC1 releases, which enabled multiple consistency checks.

Table 3 summarizes the software packages and releases used in B-physics simulation and reconstruction in each process. The studies presented in this document were done for the Inner Detector only. The Initial detector layout was available in Athena starting from release 6.0.3, while the DC1-300 and Complete layouts were available since the beginning of DC1. Using the same input events we have compared the reconstruction results of the releases 4.- 7. At the end of DC1 the Inner detector reconstruction software achieved some degree of consistency, and allowed us to draw conclusions about the influence of the detector layout changes on the B-physics performance.

For two physics channels \(\rm B_{s}\to J/\psi(\mu\mu)\;\phi(K^{+}K^{-})\) and \(\rm B_{d}\to J/\psi(\mu\mu)\;K^{0}_{s}\) the reconstruction has been extended to the Muon detector. However the muon simulation and software in DC1 were not achieved in a coherent fashion and we decided not to include the results in the present note and leave the muon reconstruction studies for the future.

#### 2.2.2 Pattern recognition options

The missing second pixel layer in the Initial layout increases the probability that the pattern recognition algorithm will find a wrong hit in the b-layer. This probability depends on the event properties. It decreases with increasing \(p_{\rm T}\) of the tracks and increases with the number of tracks in the event (or the number of piled-up minimum bias events.)

XKalman [11] starts the reconstruction from three space-points. First, the algorithm selects all 3-space-point combinations consistent with track candidate and starts a local pattern recognition in the precision detectors. It is possible to investigate all 3-space-point combinations or alternatively part of them (to save computer time). XKalman has nine levels of selectivity (in Athena the relevant user parameter is called 'XKalMan.Selectivity'). By increasing the level of selectivity xKalman decreases the number of 3-space-point combinations it uses for local pattern recognition.

For the Initial layout the best performance was achieved with selectivity level 4. The details are given in section 4.2. The main goal of this study is to investigate the differences between the Initial and Complete detector layouts and in order to avoid any sources of difference originating in the reconstruction method we used this selectivity level for the Complete layout as well.

#### 2.2.3 Pixel clusters errors

B-physics results are sensitive to the different methods used for the calculation of pixel clusters position errors. The reconstruction in Athena for both iPatrec and xKalman gave very similar results. On the other hand, reconstruction in atrecon gave better proper time resolution then in Athena. We have proven by doing a cross check, see section 4.4, that most of the difference is due to the calculation of the errors associated with the pixel cluster position. In atrecon the errors are tabulated as a function of pixel cluster width in the two directions and in pseudorapidity. In the case of Athena the programs used simplified errors calculated as cluster-width/sqrt(12). The cross check consisted of using the Athena-like errors inside atrecon (a private version prepared by Igor Gavrilenko). The analyses of the B proper-time proved that the pixel errors are responsible for the differences between the atrecon and Athena performance.

#### 2.2.4 Track Selection

In the track reconstruction the following set of parameters was required:

* at least 7 silicon clusters per track
* no cut on the number of hits in the pixel layers (including B-layer)
* minimal number of no-shared hits (belonging only to the track) = 4 ( xKalman default 5)
* xKalMan.Selectivity = 4
* min.number of TRT clusters per track = 9
* max number of holes = 22

In the physics analyses the tracks from the signal B-decay chain were required to have a hit in the B-layer except for \(\mathrm{K}^{0}_{\mathrm{s}}\) and \(\Lambda^{0}\) tracks.

### Software used for physics analysis

After the reconstruction, all of the event information was contained in Combined Ntuples and no other persistency was produced. For the physics analyses each group used their own versions of stand-alone fortran programs to analyze the information read from the Ntuples, calculate physics variables, apply cuts and fill histograms. For the reconstruction of B-hadron decay vertices these programs used a program CTVMFT [13], adapted from CDF code. The vertex algorithm used a uniform magnetic field of 2T in teh Inner detector and has not been updated for the realistic magnetic field. However, a check was done which proved that this simplification has a negligible impact on proper time resolutions.

### Methods of physics analysis

In all channels, the reconstructed particles were matched (if possible) to generated ones using the true information associated to the reconstructed tracks. The resolution of physics variables characterizing a decay was obtained by examining the difference between the reconstructed quantity and the corresponding generated quantity. In addition, the generated (true) primary vertex was used in all analyses, as its reconstruction in DC1 failed.

#### 2.4.1 \(\rm B_{s}\ \to D_{s}\pi\)

Reconstruction of \(\phi\) and \(D_{s}\): The \(\phi\) decay vertex was first reconstructed by considering all combinations of pairs of oppositely-charged tracks with \(p_{\rm T}>1.5\) GeV for both tracks. Kinematic cuts on the angles between the two tracks \(\Delta\varphi_{KK}<10^{\circ}\) and \(\Delta\theta_{KK}<10^{\circ}\) were also imposed. Here \(\varphi\) denotes the azimuthal angle and \(\theta\) the polar angle of a track. The two-track vertex was then fitted assigning the kaon mass to both tracks. Combinations passing a fit-probability cut of 1% with the invariant mass within \(3\sigma_{\phi}\) of the nominal \(\phi\) mass were selected as \(\phi\) candidates. The \(\phi\) mass resolution was obtained from the \(M_{KK}\) invariant mass of those combinations which match a true \(\phi\) meson.

To all accepted \(\phi\) candidates, a third negative track with \(p_{\rm T}>1.5\) GeV was added. The pion mass was assigned to the third track and a three-track vertex was refitted. Combinations of three tracks which had a fit probability greater than 1% and an invariant mass within \(3\sigma_{D_{s}}\) of the nominal \(D_{s}\) mass were selected as \(D_{s}^{-}\) candidates. The \(D_{s}\) mass resolution was obtained from the \(M_{KK\pi}\) invariant mass of those combinations which match a true \(D_{s}\) meson.

\(\rm B_{s}\) reconstruction: The \(\rm B_{s}\) decay vertex was reconstructed by considering all \(D_{s}^{-}\) candidates and adding a fourth track from the remaining tracks in the event. This track was required to have opposite charge with respect to the pion track from the \(D_{s}^{-}\) and \(p_{\rm T}>1\) GeV. A four-track vertex fit was performed including \(\phi\) and \(D_{s}^{-}\) mass constraints, and requiring that the total momentum associated to the \(\rm B_{s}\) vertex pointed to the primary vertex (within the primary vertex spatial resolutions of \(\sigma_{x}=\sigma_{y}=28\ \mu\)m and \(\sigma_{z}=46\ \mu\)m) and the momentum associated to the \(D_{s}^{-}\) vertex pointed to the \(\rm B_{s}\) vertex. In order to be selected as \(\rm B_{s}\) candidates, the four-track combinations were required to give a probability greater than 1% for the vertex fit. The signed separation between the reconstructed \(\rm B_{s}\) vertex and the primary

\begin{table}
\begin{tabular}{l|c c|l l} \hline  & \multicolumn{2}{c|}{Detector simulation} & \multicolumn{2}{c}{Reconstruction} \\  & DC1-300 & Initial, Final & DC1-300 & Initial, Final \\ \hline \(\rm B_{s}\ \to D_{s}\pi\) & atlas3.2.1 & atlas6.0.2 & atrecon4.0.0 & atrecon6.0.3, 6.6.0 \\  & & & (xKalman ) & Athena6.0.3, 7.0.0 \\  & & & & ( xKalman ) \\  & & & & Athena6.0.3 \\ \hline \(\rm B_{s}\ \to J/\psi\phi\) & ” & ” & atrecon4.5.0 & atrecon6.5.0 \\  & & & & Athena7.0.0 \\  & & & (xKalman) & (xKalman) \\ \hline \(\rm B_{d}\to J/\psi(ee)\ K_{s}^{0}\) & atlas4.0.0 & not & atrecon4.4.0 & not \\  & & done & & done \\  & & & (xKalman ) & \\ \hline \(\rm B_{s}\to\mu\mu\) & atlas3.2.1 & atlas6.0.2 & atlas4.5.0 & atrecon6.0.3, 6.5.0 \\  & & & (xKalman) & (xKalman) \\ \hline \(\rm B_{d}\to J/\psi(\mu\mu)\ K_{s}^{0}\) & ” & ” & atrecon4.5.0 & atrecon6.0.3, 6.5.0 \\  & & & & Athena6.0.3, 7.0.0 \\  & & & (xKalman) & (xKalman) \\ \hline \(\rm\Lambda_{b}^{0}\ \to J/\psi\Lambda^{0}\) & not & ” & not & atrecon6.0.3, 6.5.0 \\  & done & & done & Athena6.0.3, 7.0.0 \\  & & & & (xKalman) \\ \hline \end{tabular}
\end{table}
Table 3: Software for simulation, reconstruction used for validation of B-physics events.

vertex, and between the \(D_{s}^{-}\) and \({\rm B_{s}}\) vertex were required to be positive (the momentum should not point backward to the parent vertex). To improve the purity of the sample, further cuts were imposed: the accepted \({\rm B_{s}}\)  candidates were required to have a proper decay time greater than 0.4 ps, an impact parameter smaller than 55 \(\mu\)m and \(p_{\rm T}>10\) GeV.

For each \({\rm B_{s}}\)  meson one defines the \(d_{xy}\) transverse decay length as the distance between the interaction point (primary vertex) and the reconstructed \({\rm B_{s}}\)  decay vertex, projected onto the transverse plane. One also defines a \(g\)-factor as \(g=M_{\mbox{$\rm B_{s}$}}\,/(cp_{\rm T})\), where \(p_{\rm T}\) is the transverse momentum and \(c\) is the speed of light. The \({\rm B_{s}}\)  proper time is then computed as \(t=d_{xy}g\), with the proper time resolution defined as \(t-t_{0}\). Here \(t\) denotes the reconstructed value, while \(t^{0}\) denotes the true value.

The selections made in the TDR study for this channels can be found in [14].

#### 2.4.2 \({\rm B_{s}}\ \to{\rm J}/\psi\phi\)

The reconstruction procedure for the \({\rm B_{s}}\to{\rm J}/\psi(\mu\mu)\ \phi({\rm K^{+}K^{-}})\) channel used only the reconstructed tracks, matched to the two muons and two kaons from the \({\rm J}/\psi\) and \(\phi\) decays. The MC truth information was used for this purpose. A three-dimensional kinematic fit was performed if all four signal tracks had been reconstructed.

A 3D fit was performed with the requirement that all four tracks originate from the same vertex. The di-muon mass was constrained to the nominal \({\rm J}/\psi\) mass and the B momentum was required to point to the primary vertex. Cuts were applied on the \({\rm B_{s}}\) vertex fit probability (\(>0.02\)) and the proper-time (\(\tau>0.5\) ps). In the TDR the reconstruction of the events proceeded in three steps for the reconstruction of \({\rm J}/\psi\), \(\phi\) and \({\rm B_{s}}\) candidates. A number of cuts at each stage were used to get rid of the background. For the DC1 studies we used only signal events and MC truth information to determine the mass and proper-time resolutions. As a consequence, only a subset of the TDR cuts were applied.

The \({\rm B_{s}}\) mass was calculated using the track parameters resulting from the vertex fit with the \({\rm J}/\psi\) mass constrained to the nominal mass. The \({\rm B_{s}}\) proper-time was calculated from the distance between the true primary vertex and the reconstructed \({\rm B_{s}}\) vertex using the track parameters resulting from the vertex fit. The \({\rm J}/\psi\) mass resolution was derived from the xKalman track parameters.

The selections done in the TDR study of this channel can be found in [15].

4.3 \({\rm B_{d}}\to{\rm J}/\psi{\rm K^{0}_{s}}\)  and \(\Lambda^{0}_{\rm b}\ \to{\rm J}/\psi\Lambda^{0}\)

The reconstruction of B-decays with strange hyperons \(({\rm V^{0}})\) requires optimization of the track finding selection criteria to maximize the reconstruction efficiency.

First, the default criteria for track selections were used. They are that there be at least seven silicon clusters per track, no requirement on the number of hits in the pixel layers (including the B-layer) and that the number of no-shared hits (belonging only to the track) be at least 4. By relaxing the criteria to allow tracks with only six silicon clusters, the efficiency of \(\Lambda^{0}\) finding increased from 30.0% to 31.4%. The effect is most pronounced for \(\Lambda^{0}\) particles decaying in the region between the first and second SCT layer where the difference is 10% to 25%.

Only events with \({\rm K^{0}}\) (\(\Lambda^{0}\)) decays with radii in the interval 1-37 (1-40) cm were selected. The low-end limit was justified in the TDR studies to eliminate background. This cut was used in the present study - as no re-analysis of the background rejection was performed.

As in other cases the signal tracks were selected using the MC truth information; however, as the background processes are not included. This does not imply any essential simplification in comparison to 'blind' analyses.

Reconstruction of \({\rm B_{d}}\) and \(\Lambda^{0}_{\rm b}\) : leptons and hadrons coming from \({\rm J}/\psi\) and \({\rm K^{0}}\) (\(\Lambda^{0}\)) were used in reconstructing \({\rm B_{d}\to J/\psi K^{0}_{s}}\) and \(\Lambda^{0}_{\rm b}\to{\rm J}/\psi\Lambda^{0}\)  decays. The \({\rm B_{d}}\) and \(\Lambda^{0}_{\rm b}\) were reconstructed by performing a three dimensional kinematic fit to four tracks applying vertex and mass constraints on both \(\mu\mu\) and \(\pi^{+}\pi^{-}\) (\(\rm p\pi^{-}\)) systems. At the same time \({\rm K^{0}}\) (\(\Lambda^{0}\)) were required to point to the \({\rm J}/\psi\) vertex and the momentum of the B-hadron to the primary vertex. Cuts were applied on the B-vertex fit probability (\(>0.02\) ) and on the B proper-time (\(\tau>0.5\) ps).

The selections done in the TDR studies can be found in [16] for the \({\rm B_{d}}\) channel and in [17] for the \(\Lambda^{0}_{\rm b}\) channel.

#### 2.4.4 \({\rm B_{s}\to\mu\mu}\)

In the analyses of the \({\rm B_{s}\to\mu\mu}\) events pairs of opposite-charge muons were fitted into a common vertex and their invariant mass was calculated. Successfull candidates were required to have a probability greater than 0.02 for the vertex fit. In the TDR study of the \({\rm B_{s}\to\mu\mu}\) channel further criteria were developed to reject the huge background, [18]. The present study, limited itself to understanding the signal reconstruction and so does not include these dedicated cuts.

#### 2.4.5 \({\rm J}/\psi\to{\rm ee}\)

The study dedicated to an optimal low \(p_{\rm T}\) electron reconstruction in \({\rm J}/\psi\to{\rm ee}\) events with \({\rm B_{d}\to J/\psi K^{0}_{s}}\) addressed different problems to those considered in the other analyses. It is discussed in a separate paragraph in the Appendix. The TDR \({\rm J}/\psi\to{\rm ee}\) reconstruction is described in [16].

## 3 Validation of software and of reconstruction algorithms

### Checks of mass reconstruction precision

In the early DC1 releases (4.0.0-5.5.0) clear evidence was found that the particle masses reconstructed from xKalman tracks were shifted with respect to those generated, see Table 4. The problem was found independent of the framework - atlsim, atrecon or Athena - in which xKalman was run. The shifts were different in the barrel and the end-cap. The problem was tracked to the level of single tracks parameters using samples of muons simulated with a single \(p_{\rm T}\) value. The largest shift, see Table 4, was found for low \(p_{\rm T}\) muons (\(p_{\rm T}=1~{}GeV\)), in the pull distribution of \(1/p_{\rm T}\), defined as

\[(1/p_{\rm T}{}_{rec}-1/p_{\rm T}{}_{true})/\sigma(1/p_{\rm T}), \tag{1}\]

where \(\sigma(1/p_{\rm T}\) ) is the error on \(1/p_{\rm T}\) - one of the diagonal elements of the track fit error matrix. In contrast, muons with \(p_{\rm T}=200~{}{\rm GeV}\) were reconstructed with shifts consistent with zero.

After many corrections were made to the reconstruction software in releases 6 and 7, the shifts from the true values became smaller, as seen in Table 4. However, in most cases the shifts were still not consistent with zero within the statistical precision. The reconstructed mass values were now higher than the true values, while in releases 4.0.0-5.5.0 they had been shifted to lower than the true values.

This situation makes an assessment of the physics performance problematic, and may mask or interfere with the other effects studied. Given the controlled environment of the simulation, tracking must give rise to a reconstructed mass consistent with the input value within the statistical precision. The reconstruction software needs to be fully understood before the start of experimental data taking and should not introduce any shifts.

### Selection of the optimal reconstruction for B events

The default xKalman pattern recognition strategy is suited mainly to high transverse momentum events. The typical B-decay tracks are at lower transverse momentum, and therefore require a different tracking strategy. In addition, for the Initial detector layout the pattern recognition may fail to find a track or else may find tracks with an incorrect hit in the b-layer due to the missing second pixel layer. Again, it may be appropriate to use a non-default tracking strategy. Various options were considered and the best selected.

For the default xKalman track search strategy (program parameter setting 'XKalMan.Selectivity =7'), a comparison was made of the same events reconstructed with Initial layout and with Complete layout. The efficiency of B-signal finding (including both track reconstruction and vertex fit efficiencies) was lower by \(\sim\) (15-25)% for the Initial layout than for the Complete layout, see Table 5. In the case of \(\rm B_{s}\,\rightarrow\rm J/\psi\phi\) decays the loss of efficiency was \(\sim\) 14.5%, 5.6% being due to the failures in track finding, with the remainder coming from the B-vertex fit efficiency and quality cuts. The reconstruction failures due to vertexing contained at least one track with an incorrect hit in the b-layer. In addition, the analysis of \(\rm B_{s}\rightarrow\mu\mu\) showed a larger loss in the end-cap than in the barrel. This is attributed to the larger search region in the b-layer in the end-cap because of the lower angle of incidence and increased multiple scattering, both factors increasing the probability of an incorrect hit association in the b-layer.

Using an alternate xKalman pattern recognition strategy (parameter setting "XKalMan.Selectivity =4") the results for the Initial layout improve. The number of reconstructed signal B-hadrons is reduced by only (4-6)% compared to the Complete layout. In the case of \(\rm B_{s}\,\rightarrow\rm J/\psi\phi\), the loss is 5.4%, 4.9%of which due to track finding inefficiency and only 0.5% due to track reconstruction inefficiency. For this channel, the improved efficiency is seen in both the barrel and end-cap regions, but for \(\mathrm{B_{s}}\rightarrow\mu\mu\) the difference between barrel and end-cap of about 9 %, remains.

The impact of the alternate strategy on the reconstruction of physics variables such as invariant masses of the B-hadrons, of the sub-systems in cascade decays and of the B-proper-times was also studied. Figure 2 shows one example, the invariant mass distribution for the same \(\mathrm{B_{s}}\ \rightarrow\mathrm{J}/\psi\phi\\) events reconstructed with the default strategy (a) and with the more efficient strategy (b). In both cases the distribution was made before the vertex quality selection cuts were applied, so the cases which fail the vertex cuts are present in the distributions. Figure 2b shows that the more efficient strategy also decreases the tails of the distribution; indeed, it produces invariant mass distributions that are very similar for the Complete and Initial layouts in both the peak and tail regions. These results are reproduced in the rest of the channels studied.

There was therefore good reason to select the alternate strategy as the new default for B-events. Comparisons of CPU time used in both strategies showed negligible differences, and so the further studies presented here use only the alternate reconstruction strategy.

### Athena versus atrecon - sensitivity to simulation details

In DC1 the xKalman reconstruction was available in three different software environments: atlsim, atrecon and Athena. Comparison of atrecon and Athena using the same events allowed us to test the'sensitivity' of the results to several options in the simulation-reconstruction chain. We anticipate that neither of these software environments in DC1 were providing sufficiently correct event simulation. The differences in atrecon and Athena relevant to our studies were the following: the pixel clusters errors calculation was more realistic in atrecon then in Athena; the noise and inefficiency were underestimated in atrecon. More detailed explanation of both is given in section 'Reconstruction software" of this document.

The comparison was done in the Initial layout for four B-signal processes: \(\mathrm{B_{s}}\ \rightarrow\mathrm{D_{s}}\pi\\), \(\mathrm{B_{s}}\ \rightarrow\mathrm{J}/\psi\phi\\)\(\mathrm{B_{d}}\rightarrow\mathrm{J}/\psi\mathrm{K^{0}_{s}}\\) and \(\Lambda^{0}_{\mathrm{b}}\ \rightarrow\mathrm{J}/\psi\Lambda^{0}\\). The results are summarised in Table 6. The resolution of proper time was most sensitive to the differences. In Athena it was worse by \(\sim 10\) % than in atrecon, see Table 6 for details. In addition we used a private atrecon version with the 'wrong calculation of pixel errors' - as in Athena. The degradation of proper time resolution versus'standard' atrecon was \(\sim(6-8)\) % for all processes. This means that most of the degradation in proper time resolution was due to incorrect

\begin{table}
\begin{tabular}{l|c c} \hline Process & ATLAS Default tracking & Alternate tracking \\  & \multicolumn{2}{c}{\(\mathrm{R=N_{acc}^{\mathrm{Ini}}/N_{acc}^{\mathrm{Compl}}}\)} \\ \hline \(\mathrm{B_{s}}\ \rightarrow\mathrm{D_{s}}\pi\\), \(\mathrm{D_{s}}\rightarrow\phi(\mathrm{K^{+}K^{-}})\pi\\) & 85.4 \% & 93.7 \% \\ \(\mathrm{B_{s}}\ \rightarrow\mathrm{J}/\psi(\mu\mu)\ \phi(\mathrm{K^{+}K^{-}})\) & 82.3 \% & 93.4 \% \\ \(\mathrm{\Lambda^{0}_{\mathrm{b}}}\ \rightarrow\mathrm{J}/\psi(\mu\mu)\ \Lambda^{0}\ (\mathrm{p}\pi)\) & 84.1 \% & 95.9 \% \\ \(\mathrm{B_{s}}\rightarrow\mu\mu\) & & \\ \(\mathrm{B_{s}}\rightarrow\mu\mu\) barrel & 84.5 \% & 98.9 \% \\ \(\mathrm{B_{s}}\rightarrow\mu\mu\) end-cap & 74.9 \% & 90.1 \% \\ \hline \end{tabular}
\end{table}
Table 5: Comparison of the B-signal fi nding effi ciency using the Initial layout compared to the Complete layout including tracking and vertex reconstruction for default xKalman and alternate xKalman track fi nding. The values in percents are the ratios \(\mathrm{R=N_{acc}^{\mathrm{Ini}}/N_{acc}^{\mathrm{Compl}}}\) of the number of events reconstructed in Initial \(N_{acc}^{Ini}\) and Complete layouts \(N_{acc}^{Compl}\).

pixel errors calculation, while the reconstruction does not appear to be particularly sensitive to noise or inefficiency differences.

The pixel error calculation was corrected in Athena, however not in the DC1 phase. The conclusion from DC1 is that Athena gives worse results than those that would correspond to the correct pixel error calculation, however it is understood that at the same time the DC1 software was not ready to simulate other features, such as misalignment, that would allow a more realistic simulation of performance.

Thus it was accepted that the Athena DC1 performance results are closer to the expected and we decided to favour them to those obtained from atrecon in the final stage of the DC1 studies.

### Conclusions about software validation

During DC1 the software evolved and many corrections were applied; however even in the final DC1 release, 7.0.3, the software did not fulfill the needs of the analyses. The changes of software needed to increase the precision and reliability of the performance simulations are summarized in the following list.

\begin{table}
\begin{tabular}{|l|c c c c|} \hline  & \multicolumn{5}{c|}{B-proper-time resolution \(\sigma\), [fs]} \\  & \(\rm B_{s}\,\rightarrow\rm D_{s}\pi\) & \(\rm B_{s}\,\rightarrow\rm J/\psi\phi\) & \(\rm\Lambda_{b}^{0}\,\rightarrow\rm J/\psi\Lambda^{0}\) & \(\rm B_{d}\rightarrow\rm J/\psi K_{s}^{0}\) \\ \hline atrecon 6.5.0 & \(89.1\pm 1.7\) & \(81.6\pm 0.9\) & 92.9 & \(89.6\pm 1.4\) \\ Athena 7.0.0 & \(98.5\pm 1.9\) & \(91.9\pm 1.1\) & 107.7 & \(99.2\pm 1.9\) \\ atrecon 6.5.0 – & \(95.3\pm 1.9\) & \(86.7\pm 0.9\) & 103.9 & \(96.0\pm 1.6\) \\ private version & & & & \\ \hline \end{tabular}
\end{table}
Table 6: Comparison of B-proper-time resolution using the xKalamn reconstruction package in Athena and atrecon. The third line shows results with the private atrecon version using calculation of pixel cluster errors as in Athena.

1. The identification of the reasons why the reconstruction program introduces shifts to reconstructed invariant masses.
2. The use of realistic detector efficiencies, noise and correct pixel cluster errors in the simulation.
3. The provision of some truth information (even if limited) for pile-up tracks. The B-physics group is preparing a document defining the requirements for true information in AOD.
4. The completion of the combined muon reconstruction.
5. The physics analysis software should move to Athena to allow the use of new Athena vertexing Algorithms.
6. Different vertexing methods should be tried and optimized to increase the precision of vertexing. Vertexing should take into account realistic magnetic field.
7. Misalignment studies should be performed at least for some selected channels.

Several changes required in the list have already been introduced in the first releases of the DC2 series. In particular the Physics Analysis code for B-physics applications has been introduced in Athena since release 8.7.0.

## 4 Performance for single particles

To understand the changes in performance for B-hadrons due to the changing detector layout and software a parallel study was done for more elementary objects - single muons. The same detector layouts and the same simulation and reconstruction software were used as for Beauty events. Each sample consisted of 50000 single muons generated with one of the following \(p_{\rm T}\) values: 1 GeV, 6 GeV, 20 GeV and 200 GeV, isotropically in azimuthal angle \(\phi\) in the interval \((-\pi;\pi)\) and in two pseudorapidity intervals \(|\eta|<~{}0.25\) and \(|\eta|<2.5\).

### Transverse impact parameter resolution

The transverse impact parameter resolution for single muons as a function of \(p_{\rm T}\) in \(|\eta|<0.25\) for Complete, Initial and TDR Inner detector layouts are shown in Figures 4a-c. Using a minimal \(\chi^{2}\) fit the plots were approximated by a function of the form (2)

\[\sigma({\rm d}_{0})={\rm sqrt(A^{2}+B^{2}/{p_{\rm T}}~{}+C^{2}/{p_{\rm T}}^{~{ }2})}. \tag{2}\]

The values of the parameters A, B, C are summarized in Table 7. The fit apparently needs a linear term depending on \(1/{p_{\rm T}}\). In the Inner Detector TDR document [8] the corresponding function was \(\sigma({\rm d}_{0})={\rm sqrt(A^{2}+B^{2}/{p_{\rm T}}^{~{}2})}\), \({\rm A}=10.9~{}\mu{\rm m}\), \({\rm B}=57.2~{}\mu{\rm mGeV}\), however two middle points (at 5 GeV and 20 GeV) reveal a small deviation from this function. Including a linear term gives a better fit (Figures 4 a-b.). The B and C terms dominate at small \(p_{\rm T}\). The resolution \(\sigma(d_{0})\) is sensitive to \(p_{\rm T}\) and between Initial and TDR layouts it changed by a factor varying between (1.65 - 1.0) within the interval \(1{\rm GeV}<p_{\rm T}~{}<200~{}{\rm GeV}\), see Fig.4c. At high \(p_{\rm T}\) values where the \(\sigma({\rm d}_{0})\) function reaches a plateau the Initial resolution is the same as in the TDR, however, as the results suggest, the beginning of the plateau regime has shifted towards the higher \(p_{\rm T}\) values. The Initial layout results are slightly different to those for the Complete layout, Figures 4a-b. The difference depends on the reconstruction program. For Athena-xKalman the \(\sigma(d_{0})\) for Initial layout is larger for all \(p_{\rm T}\) values. Atrecon-xKalman in the interval of \(p_{\rm T}~{}=(6-20)~{}{\rm GeV}\) gives the same resolution \(\sigma(d_{0})\) for both Initial and Complete layouts.

Figure 3: Transverse impact parameter resolution of single muons as a function of \(p_{\rm T}\) in \(|\eta|<0.25\) for Complete(Final), Initial and TDR Inner detector layouts. (a) Complete and Initial layouts reconstructed with xKalman in Athena 7.0.2; (b) Complete and Initial layouts reconstructed with xKalman in atrecon 6.5.0; (c) Function defi ned by equation (2) with parameters from a fit to Initial layout reconstruction with Athena-xKalman divided by the same type of function fitted to TDR. (d) Transverse momentum distributions of secondary particles from two B-hadron decays for the events that passed the cuts used in TDR physics analyses. \({\rm B_{s}}~{}\to{\rm D_{s}}\pi\) (full line) - example of low \(p_{\rm T}\) channel and \({\rm B_{s}}\to\mu\mu\) (dashed line) - example of high \(p_{\rm T}\) channel. The vertical normalization is in arbitrary units.

Thus the single muon events allow us to draw a conclusion that the absence of the second pixel layer plays much smaller role in performance degradation then the increased b-layer radius. The second conclusion is that the results are sensitive to the difference between the two programs used for this study. Both conclusions correspond to those derived from the B-events studies.

### Single track momentum resolution

While transverse impact parameter and proper-time reconstructions are most sensitive to changes in the innermost pixel layers, the momentum and invariant mass resolutions reflect the properties of the whole Inner detector. An important factor is whether the simulation was done with an inhomogeneous magnetic field or with an idealized (uniform) one.

For single muons with momenta \(p_{\rm T}~{}=1~{}{\rm GeV}\) and \(p_{\rm T}~{}=20~{}{\rm GeV}\) the \(\sigma(1/p_{\rm T}~{})\) resolution was studied as a function of \(|\eta|\) for an inhomogeneous magnetic field, Figs. 4.a-b, and compared with TDR results, Figs. 4.c-d.

In the case of \(p_{\rm T}~{}=1~{}{\rm GeV}\) in the TDR only uniform field study is available, Figs. 4.c. In this case the difference to DC1 is due both to detector changes and realistic field shape. The \(\sigma(1/p_{\rm T}~{})\) increased by values varying within (10-40) % in the interval \(|\eta|<1.8\). In the very forward part, \(|\eta|\sim 2.4\), the change is as large as 160%.

For \(p_{\rm T}~{}=20~{}GeV\) both uniform and inhomogeneous field TDR studies are available. The comparison of the curve corresponding to an inhomogeneous field in the TDR, Fig. 4.d, with the current DC1 result allows to check the \(\sigma(1/p_{\rm T}~{})\) degradation due to detector changes only. For \(|\eta|<1.8\) the \(\sigma(1/p_{\rm T}~{})\) increase follows approximately the increase of Inner detector material, varying in this \(|\eta|\) within values of (10-50) %. In the very forward region, as \(|\eta|\) is approaching the value of \(\sim 2.4\), the \(\sigma(1/p_{\rm T}~{})\) apparently grows faster than the material, relative to TDR, even if the comparison is done for an inhomogeneous field in both cases.

## 5 B-physics performance

The main task of the present study was to update the old B-physics performance data obtained for the TDR detector layout which is now obsolete. Using the final (most reliable) DC1 releases the performance for the three versions of the new detector layout: Initial, Complete and DC1-300 were studied.

[MISSING_PAGE_EMPTY:18]

### Consequences of ID changes on mass reconstruction

The reconstruction of invariant masses has changed since the TDR, see Table 8. The factors that induced the changes are: the material and geometry changes in the ID and the magnetic field: the TDR B-physics was done with a uniform field, while DC1 used a realistic field.

The differences between the three new detector layouts have no impact on the mass reconstruction within the statistical precision and uncertainties of the DC1 tools.

Mass resolutions obtained from a single-Gaussian fit to the distributions of reconstructed invariant masses are wider than in the TDR by values between (10-23)%. The actual value in each channel depends on a combination of several factors including the sub-mass constraints, the cuts and the difference between the masses of the mother and the daughter particles. To avoid differences due to \(\eta\) and distributions, for the present study we used in each channel the same generator events (or events with identical kinematics) as were used for the TDR. For long-lived particles such as \(\rm K^{0}_{S}\) and \(\Lambda^{0}\) the mass resolution is influenced by another factor, the decay radius of the reconstructed particles, which is sensitive to changes in the ID geometry since the TDR. As the comparison with the TDR results is more complicated than in the other cases the sections dedicated to V0 reconstruction are appended.

### Proper-time resolution: impact of the new b-layer radius and material increase

Since the TDR the proper-time resolutions in all observed channels, see Table 9, have increased by factors varying within the interval (42-48%). Despite the different topologies, the degradations are similar. This similarity may be just the result of a combination of several factors: as multiplicities of vertex tracks and kinematics, for instance the higher cuts in two-body decay and lower cuts in 4-body decay.

The largest performance changes are observed comparing the TDR and the new layouts, while the differences between the three new layouts are smaller, see Tables 9 and 10. This means that the larger b-layer radius and the material increase had stronger influence then the two other factors: a longer pixel size and a missing second pixel layer.

### Difference due to longer b-layer pixels

The impact of the longitudinal pixel-size change was studied by a comparison of the B-hadron proper-time resolutions of two detector layouts: DC1-300 with pixel size in the b-layer \(300\mu\) and Complete layout with size \(400\mu\). As DC1-300 layout was studied only with atrecon, the comparison uses atrecon results also for the Complete layout (see Table 10) to avoid uncertainties due to differences in the simulations between Athena and atrecon. These appear to be larger (see Table 6) than the effect due to pixel-size change. In all three channels the proper-time resolutions obtained are larger in the \(400\mu\) case, although the difference appears to be within \(3\sigma\) of the statistical error. There was no point in increasing the statistics of the event samples because the effects due to insufficiently detailed simulation in both atrecon and Athena are larger than the statistical errors.

### Sensitivity of results to differences between Initial and Complete layouts

We investigated carefully the differences between the Initial and Complete layouts, because there is still a possibility that the missing layers will be returned to the detector in time for the B-physics data taking.

#### 5.4.1 Signal events without pile-up

The proper-time resolutions obtained with the events simulated without pileup and reconstructed with xKalman in Athena are summarized in Table 9. The results for the Initial and Complete layouts are similar. Paradoxically, the Complete layout has slightly worse resolution in all channels, although the difference is within the statistical errors. The same is observed for a higher \(p_{\mathrm{T}}\) version of the events

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline Single-Gauss fit to & TDR & Initial & Complete & \\ \(\tau_{\mathrm{rec}}-\tau_{\mathrm{true}}\) distribution & tdr-xKalman & Athena7.0.0 & Athena7.0.0 & \\ \cline{2-5} of the process & \multicolumn{4}{|c|}{\(\sigma\) [fs]} & R\({}_{\mathrm{Ini,TDR}}\) [\% ] \\ \hline \(\mathrm{B_{s}}\,\rightarrow\mathrm{D_{s}}\pi\) & \(66.1\pm 1.4\) & \(98.5\pm 1.9\) & \(99.1\pm 1.4\) & \(49\pm 4\) \\ \(\mathrm{B_{s}}\rightarrow\mu\mu\) & \(69\) & \(98\pm 1\) & \(99\pm 1\) & \(42\pm 2.5\) \\ \(\mathrm{B_{d}}\rightarrow\mathrm{J/\psi K_{s}^{0}}\) & \(69\pm 0.4\) & \(98.9\pm 1.9\) & \(102.7\pm 2.0\) & \(43\pm 2.9\) \\ \(\Lambda_{\mathrm{b}}^{0}\,\rightarrow\mathrm{J/\psi\Lambda^{0}}\) & \(73\pm 1.5\) & 108.1\(\pm\)2.2 & 121.3\(\pm\)2.4 & \(48\pm 4.9\) \\ \(\mathrm{B_{s}}\,\rightarrow\mathrm{J/\psi\phi}\) & \(63.2\pm 0.5\) & \(91.9\pm 1.1\) & \(96.2\pm 1.2\) & \(45\pm 2.1\) \\ \(\mathrm{B_{s}}\,\rightarrow\mathrm{J/\psi\phi}\) (\(p_{\mathrm{T}}\,(\mathrm{b})>50\) GeV) & not done & \(61.0\pm 1.3\) & \(63.4\pm 1.5\) & - \\ \hline \end{tabular}
\end{table}
Table 9: Comparison of the B-hadron proper-time resolutions for the Inner Detector layouts. The distributions obtained from the differences between reconstructed and true proper-times have been fi tted using a single-Gauss function for the bins with a content higher than 10% of the maximum. The ratio \(\mathrm{R}\) was calculated as \(\mathrm{R_{Ini,TDR}}=(\sigma_{\mathrm{Initial}}-\sigma_{\mathrm{TDR}})/\sigma_{ \mathrm{TDR}}\), where \(\sigma_{Initial}\) and \(\sigma_{TDR}\) are the proper-time resolutions in Initial and TDR layout respectively.

\({\rm B_{s}}\ \to{\rm J}/\psi(\mu\mu)\ \phi({\rm K^{+}K^{-}})\) generated with the requirement that the \({\rm B_{s}}\) meson is produced from a beauty quark with \(p_{\rm T}\ \geq 50{\rm GeV}\). These events were generated in order to have kinematics similar to the events studied by the b-jet group.

The results on the B proper-times contradict the single particle studies of the transverse impact parameter reconstruction, where Athena-xKalman gives better resolution for the Complete layout, although the difference is within a few percent, Fig. 4 a. The origin of the contradiction with the single particle study was not understood. It has been decided to test the reconstruction in the presence of pile-up, to study the possible impact of the higher detector occupancy.

#### 5.4.2 Signal events with pile-up

\({\rm B_{s}}\ \to{\rm D_{s}\pi}\) and \(\Lambda^{0}_{\rm b}\ \to{\rm J}/\psi\Lambda^{0}\) signal events were'mixed' with pile-up corresponding to a luminosity of \(2\cdot 10^{33}{\rm cm^{-2}s^{-1}}\). The B-hadron performance changes due to the presence of pile-up are negligible as is illustrated in Table 11 for the process \({\rm B_{s}}\ \to{\rm D_{s}\pi}\).

The case of \(\Lambda^{0}_{\rm b}\ \to{\rm J}/\psi\Lambda^{0}\)  is different. In the Initial layout up to 6% of \(\Lambda^{0}\)  were reconstructed with wrong hits (see Fig.5a). This arises from \(\Lambda^{0}\)  decaying at radii larger than \(\sim 10\ cm\). The proton and \(\pi^{-}\) from \(\Lambda^{0}\) decay are reconstructed with the same probability as without pile-up, but they tend to include an incorrect silicon or TRT-straw hit. This can alter the direction of the reconstructed \(\Lambda^{0}\) and as a consequence the \(\Lambda^{0}_{\rm b}\)  vertex reconstruction fails, see Fig.5b comparing the \(\chi^{2}\) distributions of the \(\Lambda^{0}_{\rm b}\)  vertex fit with and without pile up for the same signal events. Similar problems occur using the Complete layout, where the signal loss due to pile-up is 5%.

A small broadening of the proper-time resolution due to pile-up was found in \(\Lambda^{0}_{\rm b}\ \to{\rm J}/\psi\Lambda^{0}\)  in the Initial layout. However despite of that the resolution still remained narrower than in the Complete layout.

In order to trace the problem of the sensitivity to pile-up down to the level of individual tracks, the variable \(f\), defined as the fraction of tracks reconstructed with an incorrect hit in the b-layer, was compared between non-pile-up events and events with pile-up. Both Initial and Complete layout cases were considered. Figure 5a shows the dependence of the fraction \(f\) on \(p_{\rm T}\). In all four cases the shape of \(f\) remains similar. For both layouts the value of \(f\) increases in the presence of pile-up, the increase being greater for the Initial layout, especially in the lowest \(p_{\rm T}\) region \((0.5-1.5)\ GeV\). The increase of \(f\) was however not large enough to affect the vertex reconstruction of B-hadrons.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline Single-Gauss fit to & Complete & DC1-300 & \\ \(\tau_{\rm rec}-\tau_{\rm true}\) distribution & atrecon6.5.0 & atrecon 4.5.0 & \\ \cline{2-4} of the process & \multicolumn{2}{|c|}{\(\sigma\) [fs]} & \({\rm R_{400,300}\) [\% ]} \\ \hline \({\rm B_{s}}\ \to{\rm D_{s}\pi}\) & \(89.6\pm 1.9\) & \(84.1\pm 2.1\) & \(6.5\pm 3.3\) \\ \({\rm B_{s}}\ \to\mu\mu\) & \(98.1\pm 1.0\) & \(92.2\pm 1.1\) & \(6.4\pm 1.6\) \\ \({\rm B_{s}}\ \to{\rm J}/\psi\phi\) & \(85.0\pm 0.9\) & \(82.2\pm 1.1\) & \(3.4\pm 1.8\) \\ \({\rm B_{s}}\ \to{\rm J}/\psi\phi\)  (\(p_{\rm T}\ ({\rm b})>50\ {\rm GeV}\)) & \(55.0\pm 1.1\) & \(53.9\pm 1.1\) & \(2.0\pm 2.9\) \\ \hline \end{tabular}
\end{table}
Table 10: Comparison of the B-hadron proper-time resolutions of two detector layouts: DC1-300 with pixel size in the b-layer \(300\mu\) and Complete layout with size \(400\mu\). The ratio \({\rm R}\) was calculated as \({\rm R_{400,300}}=(\sigma_{\rm Complete}-\sigma_{\rm DC1-300})/\sigma_{\rm DC1- 300}\), where \(\sigma_{Initial}\) and \(\sigma_{TDR}\) are the proper-time resolutions in Initial and TDR layout respectively.

## 6 Conclusions

The TDR Pythia events were re-simulated, reconstructed and analysed with all main DC1 releases. The most reliable (final) DC1 release, was chosen for comparison of the performance of the four detector layouts: TDR, Initial, Complete and DC1-300.

The mass resolutions have degraded since the TDR by between 10 and 23%. The degradation is a consequence of the detector changes and also in part due to the magnetic field shape. (The TDR field was uniform while the DC1 one was inhomogeneous.) No significant differences were found between the masses reconstructed in the three new detector layouts. In all channels the reconstructed masses were shifted from their true values, even with the final DC1 release and in both Athena and atrecon. This should be corrected in DC2.

For the proper-time reconstruction of B-hadrons the most important change since the TDR was an increase of the b-layer radius and of the ID material, while the longitudinal pixel-size change had negligible impact. Within the limitations of the DC1 tools it was impossible to prove any degradation of performance due to the missing second pixel layer and other layers in the Initial layout. Paradoxically, worse resolution was achieved with the Complete layout, however the effect was within 3 \(\sigma\) of the statistical precision. The same result was observed for a higher \(p_{\mathrm{T}}\) version of the B events (\(p_{\mathrm{T}}\) (\(\mathrm{b-quark})\geq 50\mathrm{GeV}\)) kinetically similar to the events studied by the b-jet group. Adding pile-up corresponding to a luminosity of \(2\cdot 10^{33}\mathrm{cm^{-2}s^{-1}}\) had no significant effect on the performance, except for a small broadening of the \(\Lambda_{\mathrm{b}}^{0}\) proper-time resolution in Initial layout.

Understanding the differences between the Initial and the Complete layouts is needed for the preparation of strategies for the B-physics program so it is important to repeat these studies using DC2 tools, with more accurate simulations. The plan is to revise and optimize the B-hadron vertexing algorithms

Figure 5: (a) Fraction of tracks with a wrong hit in the b-layer as a function of \(p_{\mathrm{T}}\) for the Initial layout with pile-up (empty circles) without pile-up (full circles) and for the Complete layout with pile-up (crosses) and without pile-up (stars). The signal events were of the type \(\Lambda_{\mathrm{b}}^{0}\ \to\mathrm{J}/\psi\Lambda^{0}\). The reconstruction was done with xKalman using ReconstrucitonStrategy parameter \(\simeq\)4 for the Initial layout. (b) \(\chi^{2}\) distribution from the \(\Lambda_{\mathrm{b}}^{0}\) vertex-fit t for events with no pile-up ( hash histogram ) and with pile-up ( non-hash histogram).

and eventually develop new ones. Misalignment studies will also play an important role.

## 7 Acknowledgements

The authors would like to thank Dario Barberis, Igor Gavrilenko, David Rousseau, Markus Elsing and Alan Poppelton for detailed and useful discussions. Many thanks to Igor Gavrilenko for the preparation of a dedicated (private) version of atrecon allowing a detailed comparison with Athena reconstruction.

## Appendix A Appendix

Electron reconstruction in \(\mathrm{B_{d}}\rightarrow\mathrm{J/\psi(ee)\ K_{s}^{0}}\) comparison to TDR

The 8000 generator-level events with \(\mathrm{B_{d}}\rightarrow\mathrm{J/\psi K_{s}^{0}}\) , \(\mathrm{J/\psi\rightarrow e^{+}4e^{-}4}\)  used earlier for the TDR study, have been re-simulated with the DC1 software, release 4.0.0 and reconstructed with atrecon 4.4.0 using xKalman. The goal was to understand \(\mathrm{J/\psi\rightarrow e^{+}e^{-}}\)  reconstruction in Inner detector. The study does not yet include the TRT electron identification, nor calorimetry. No attempt was made to reconstruct the B decay vertex from the \(\mathrm{J/\psi}\) and \(\mathrm{K_{S}^{0}}\), despite the secondary vertex code having been used to refine the \(\mathrm{J/\psi\rightarrow e^{+}e^{-}}\)  decay.

In order to achieve full compatibility between the TDR and DC1 physics analyses, the TDR detector-simulated events were reconstructed in this study again with atrecon 4.4.0 using the data-cards requiring the TDR geometry and a uniform field.

In the setup for the xKalman\(++\) track reconstruction, two separate values of the parameter BREMOPT were used: BREMOPT\(=\)0 (default), meaning that no bremsstrahlung recovery attempt is made, and BREMOPT\(=\)61, recommended by the author for maximum (best) bremsstrahlung recovery. So, for each layout, two separate Combined Ntuples were obtained, one with BREMOPT\(=\)0 and the other with BREMOPT\(=\)61, and the subsequent analysis was performed on these Ntuples independently. No attempt has been made to use the calorimetric information either during the reconstruction, or during the analysis.

The analysis was kept as close as possible to the one described in the Physics Performance TDR, vol.II, sect. 17.2.2.1. The identification of electrons from \(J/\psi\) decays was made based on the MC truth information. Pairs of reconstructed opposite-charge electrons from \(J/\psi\) decays were fitted to a common

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline  & \multicolumn{2}{c|}{Proper-time} & \multicolumn{2}{c|}{Mass} & \multicolumn{2}{c|}{Relative acceptance [\%]} \\  & \multicolumn{2}{c|}{resolution \(\sigma\) [fs]} & \multicolumn{2}{c|}{resolution \(\sigma\) [MeV]} & \multicolumn{2}{c|}{pileup/nopileup} \\  & \multicolumn{2}{c|}{Initial} & Complete & \multicolumn{2}{c|}{Initial} & Complete & Initial & Complete \\ \hline \(\mathrm{B_{s}\ \rightarrow\ D_{s}\pi}\) & & & & & & \\ no pileup & \(98.5\pm 1.9\) & \(99.1\pm 1.4\) & \(46.3\pm 0.8\) & \(46.9\pm 0.8\) & \(99\pm 1.3\) & \(99\pm 1.3\) \\ pileup & \(97.2\pm 2.0\) & \(102.8\pm 2.0\) & \(46.0\pm 0.8\) & \(46.4\pm 0.8\) & & \\ \hline \(\Lambda_{\mathrm{b}}^{0}\rightarrow\mathrm{J/\psi\Lambda^{0}}\) & & & & & & \\ no pileup & \(108.1\pm 2.2\) & \(121.3\pm 2.4\) & \(26.9\pm 0.6\) & \(25.5\pm 0.6\) & \(94\pm 1.5\) & \(95.2\pm 1.5\) \\ pileup & \(115.2\pm 2.6\) & \(120.1\pm 2.6\) & \(28.4\pm 0.8\) & \(26.9\pm 0.6\) & & \\ \hline \end{tabular}
\end{table}
Table 11: Comparison of the B-signal reconstruction with and without pileup, using xKalman reconstruction with optimized track search. In all cases both the proper-time resolutions and the mass distributions were fit tied using a a single Gaussian function for the bins higher than 10% of maximum.

vertex, and successful fits with (\(\chi^{2}/{\rm n.d.f.}<6\)) were retained. The fitted transverse decay length of the reconstructed \(J/\psi\) was required to be greater than 250 \(\mu\)m.

The \(J/\psi\) reconstruction efficiency was assessed separately for the barrel region (both electrons have their true pseudorapidity \(\eta\) within \(\pm 0.7\)), the end-cap region (at least one electron has \(|\eta|>0.7\)), and for the full \(\eta\) range. The full efficiency of the \(J/\psi\) reconstruction, \(\varepsilon_{R}\), was calculated as the ratio of the number of reconstructed \(J/\psi\to e^{+}e^{-}\) decays which satisfy the above cuts to the number of generated \(J/\psi\to e^{+}e^{-}\) decays. In order to calculate the \(J/\psi\) reconstruction efficiency within a mass window, \(\varepsilon_{W}\), cuts were applied on the invariant mass of the electron-positron pair, with an asymmetric window around the nominal \(J/\psi\) mass, \(M_{J/\psi}=3096\) MeV. The asymmetry was set to take into account the energy losses by electrons due to bremsstrahlung, which depends on the amount of material traversed by the electrons, and is thus different for the barrel and end-cap parts of the inner detector. So, the mass window was set to \([-5\sigma,+3\sigma]\) and \([-7\sigma,+3\sigma]\) for \(|\eta|<0.7\) and \(|\eta|>0.7\), respectively. The effective resolution \(\sigma\) was chosen to be 60 MeV, as suggested by a Gaussian fit to the overall mass distribution.

The resulting efficiencies of \(J/\psi\) reconstruction for various layouts, bremsstrahlung recovery options and pseudorapidity ranges, are presented in Table 10. The electron pair invariant mass distributions for all these cases are shown in fig. 6, where the solid lines correspond to the bremsstrahlung recovery option switched on, while the dashed lines describe the same distributions without bremsstrahlung recovery.

All of the distributions shown were fitted using an asymmetric Gaussian function with different values of \(\sigma\), \(\sigma_{\rm left}\) and \(\sigma_{\rm right}\), either side of the fitted peak mass \(m_{0}\). The parameter \(\sigma_{\rm right}\) characterizes the effective resolution in the invariant mass of the pair, while \(\sigma_{\rm left}\) is a measure of the deterioration of this resolution due to bremsstrahlung. The fits were performed in a narrow mass interval, between 2.85 and 3.15 GeV. The fit quality was generally good, and the fitted values for the parameters \(\Delta m_{0}\equiv m_{0}-M_{J/\psi}\), \(\sigma_{\rm left}\) and \(\sigma_{\rm right}\) are shown in Table 10.

As seen from the figure and confirmed by the Table, at this level of statistical precision there seems

\begin{table}
\begin{tabular}{|l l c|c c c|c c|} \hline  & Brem. & \(|\eta|\) & \(\Delta m_{0}\), & \(\sigma_{\rm left}\), & \(\sigma_{\rm right}\), & \(\varepsilon_{R}\), & \(\varepsilon_{W}\), \\  & Rec. & range & MeV & MeV & MeV & \(\%\) & \(\%\) \\ \hline TDR & Yes & \(<0.7\) & \(-14\pm 5\) & \(94\pm 5\) & \(42\pm 4\) & 79.4 & 66.6 \\  & No & \(<0.7\) & \(-17\pm 5\) & \(97\pm 5\) & \(41\pm 4\) & 74.1 & 62.8 \\ NEW & Yes & \(<0.7\) & \(-21\pm 5\) & \(117\pm 6\) & \(38\pm 4\) & 76.4 & 58.6 \\  & No & \(<0.7\) & \(-27\pm 5\) & \(119\pm 6\) & \(36\pm 3\) & 71.6 & 55.1 \\ \hline TDR & Yes & \(>0.7\) & \(-24\pm 6\) & \(141\pm 8\) & \(46\pm 5\) & 74.5 & 58.5 \\  & No & \(>0.7\) & \(-42\pm 6\) & \(128\pm 8\) & \(50\pm 4\) & 64.1 & 50.4 \\ NEW & Yes & \(>0.7\) & \(-80\pm 13\) & \(130\pm 17\) & \(80\pm 10\) & 69.1 & 45.6 \\  & No & \(>0.7\) & \(-101\pm 9\) & \(128\pm 19\) & \(82\pm 6\) & 57.9 & 39.3 \\ \hline TDR & Yes & All & \(-18\pm 2\) & \(122\pm 3\) & \(43\pm 2\) & 75.9 & 61.0 \\  & No & All & \(-27\pm 3\) & \(118\pm 4\) & \(45\pm 3\) & 67.2 & 54.2 \\ NEW & Yes & All & \(-39\pm 6\) & \(140\pm 7\) & \(52\pm 4\) & 71.3 & 49.6 \\  & No & All & \(-42\pm 3\) & \(157\pm 9\) & \(47\pm 3\) & 62.1 & 44.1 \\ \hline \end{tabular}
\end{table}
Table 12: Asymmetric Gaussian fit results to the reconstructed electron-positron invariant mass distributions from \(J/\psi\to e^{+}e^{-}\) decays, in the mass interval between 2.85 and 3.15 GeV. \(J/\psi\) reconstruction effi ciencies \(\varepsilon_{R}\) (full) and \(\varepsilon_{W}\) (within an asymmetric \(\eta\)-dependent mass window) were calculated as described in the text.

to be no significant difference in the effective resolutions between the TDR and the new layout at the higher mass slope, but the deterioration of resolution due to bremsstrahlung, clearly visible at the lower mass tail, is more significant with the new detector geometry. Compared to the TDR, there is a noticeable increase in the low mass tail, resulting in the overall broadening and shifting of the \(J/\psi\) peak, which is linked to the increase of material inside the detector, especially at high \(\eta\) values.

The use of the bremsstrahlung recovery option allows to recover the \(J/\psi\to e^{+}e^{-}\) decays in some cases, but the low-mass tail still remains visibly larger than in the TDR. The bremsstrahlung recovery option gives some improvement in the shift of the peak mass from its nominal value, but the shift itself is significantly bigger in the new layout. In both layouts, the use of the bremsstrahlung recovery option results in a modest (\(\sim 10\%\)) improvement in the \(J/\psi\) reconstruction efficiency. However, the efficiency in the new layout is about 20% lower, than in the TDR.

### \(\Lambda^{0}\) reconstruction, changes since the TDR

For the TDR studies of the decay \(\Lambda^{0}_{\rm b}\ \rightarrow{\rm J}/\psi(\mu\mu)\ \Lambda^{0}\ ({\rm p \pi})\) various cuts on track and vertex quality were used [17]. As the simulation and reconstruction tools have significantly developed since the TDR, the cuts are not directly usable for the present analysis. The following describes the differences between the TDR and DC1 results. Due to its long lifetime, the \(\Lambda^{0}\) decay vertex position can easily be found tens of centimeters away from the primary vertex (see figure 7). The properties of the pion and (anti)proton tracks coming from a \(\Lambda^{0}\) decay are more sensitive to changes in the reconstruction software compared to those of tracks which originate near the primary vertex. This is due to the fewer number of space-points forming the \(\Lambda^{0}\) daughters tracks. As a result the DC1 \(J/\psi\) mass resolution is quite close to the TDR one, while \(\Lambda^{0}\) (and \(\Lambda^{0}_{\rm b}\), which is affected by \(\Lambda^{0}\) ) differs more.

In the TDR studies, only \(\Lambda^{0}\) decaying at radii between 1 and 44 cm were accepted. The lower bound was applied to eliminate background from \(\Lambda^{0}\) coming directly from the primary interactions, while the upper one is the limit of the reconstruction algorithms [11]. In the main table 8 for the DC1 analysis, only events where the \(J/\psi\), \(\Lambda^{0}\) and \(\Lambda^{0}_{\rm b}\) reconstructed masses were within 3\(\cdot\sigma\) of the nominal masses were accepted (the \(\sigma\) are shown in the table). The fit-in-\(\Lambda^{0}_{\rm b}\) -vertex condition was found to be restrictive enough for the combinatorial background (around 1% of \(\Lambda^{0}\) were wrong). For the TDR \(\Lambda^{0}\) mass resolution calculation, the \(\Lambda^{0}\) were not required to fit in the \(\Lambda^{0}_{\rm b}\) vertex (and mass). A comparison of the \(\Lambda^{0}\) reconstruction efficiency as a function of the decay vertex radius \(R_{gen}\) is shown in figure 8. As expected from the discussion above, the cuts in the DC1 analysis are more restrictive in accepting \(\Lambda^{0}\) than the cuts in the TDR. One can clearly see that the present reconstruction algorithm has lower efficiency in the region \(R_{gen}<\)30 cm. This is due to the different reconstruction strategy in xKalman [11] which used to start from the TRT, but now starts from the silicon detectors. Also the minimum number of precision hits required per track is different. To see the effect of the number of precision hits, this bound was lowered from the default seven to six. This significantly increased the reconstruction efficiency between the first and second SCT layer.

In figure 9 the \(\Lambda^{0}\) mass resolution as a function of \(R_{gen}\) is plotted. Due to a lack of statistics, it is difficult to find the core to be fitted and the mass resolution was estimated using all \(\Lambda^{0}\) with mass less than 15 MeV away from the nominal value. There is no step apparent in the plot around \(R_{gen}=\)1 cm and therefore minor change in the \(R_{gen}\) cuts would not improve the mass resolution.

To conclude on the \(\Lambda^{0}\) reconstruction: even when accepting good quality events (with reconstructed masses of \(\Lambda^{0}\), \(J/\psi\) and \(\Lambda^{0}_{\rm b}\) less than 3\(\cdot\sigma\) away from the nominal masses), the \(\Lambda^{0}\) mass resolution is 25 % worse compared to the TDR analysis. Using all reconstructed \(\Lambda^{0}\) (by looking at MC truth infor

## 6 Conclusions

Figure 6: The electron-positron pair invariant mass distributions with the TDR layout (a,c,e) compared to the same distributions with the new layout (b,d,f): (a,b) both electrons have \(|\eta|<0.7\); (c,d) at least one electron has \(|\eta|>0.7\); (e,f) full \(\eta\) range. The dashed lines describe the spectra without bremsstrahlung recovery, while the solid lines describe the distributions with the bremsstrahlung recovery option.

## 6 Conclusion

Figure 8: \(\Lambda^{0}\) reconstruction effi ciency in Initial (a) and Complete (b) layout as a function of its decay vertex radius. The solid line corresponds to the TDR results, the circles to an analysis using MC truth information from the event generator, the stars and crosses were produced by applying 3-\(\sigma\) mass cuts on the \(J/\psi\), \(\Lambda^{0}\) and \(\Lambda^{0}_{\rm b}\). The full circles and stars show how the reconstruction effi ciency can be improved by requiring a minimum of 6 precision hits instead of 7 during the reconstruction.

Figure 7: Distribution of the \(\Lambda^{0}\) decay vertex radius. The full line corresponds to all generated \(\Lambda^{0}\), while the dashed and dotted lines show events where the \(\Lambda^{0}\) vertex was successfully reconstructed for Initial and Complete layouts.

mation from the event generator) the \(\Lambda^{0}\) mass resolution is 40 % worse than in the TDR (see Table 13). Therefore using cuts that are equivalent to those in the TDR would probably lead to a resolution in between that in the present study and that found the TDR analysis.

### \(\mathrm{K^{0}}\) reconstruction, changes since the TDR

The analysis was performed using 32000 \(\mathrm{B_{d}\to J/\psi K^{0}_{s}}\) events generated with Pythia at the time of the TDR studies. The average \(p_{\mathrm{T}}\) of the \(\mathrm{K^{0}_{S}}\) is 7.0 GeV, while the average \(p_{\mathrm{T}}\) for the 15000 events used in the TDR was 6.3 GeV [19]. The events were simulated, reconstructed and analysed with the 6.5.0 atrecon and 7.0.0 Athena releases both with Initial and Complete layouts.

The reconstruction in atrecon was done with a minimum of 7 and 6 precision hits required in the pattern recognition, the reconstruction in Athena and in the private atrecon version (using pixel errors as in Athena) was done requiring 6 precision hits.

The reconstruction procedure followed closely that described in the TDR [8]. All events were subjected to the LVL1 and LVL2 trigger selection criteria and the cuts used in the \(\mathrm{B_{d}\to J/\psi K^{0}_{s}}\) analysis for reconstructing a \(\mathrm{J/\psi}\). Using the MC truth information, the two tracks, matched to the two pions from the \(K^{0}_{S}\) decay were fitted to a common vertex and the \(\chi^{2}\) per degree of freedom was required to be \(<6\). A \(\mathrm{K^{0}_{S}}\) was considered as reconstructed if the invariant mass of the fitted pair was within 3\(\sigma\) of the nominal \(\mathrm{K^{0}_{S}}\) mass, \(\sigma\subset\) (8.0 - 8.6) MeV, and the reconstructed transverse decay radius was within the fiducial region: \(1<R(K^{0}_{S})<37\) cm and \(|z|<210\) cm. Table 14 summarizes the \(\mathrm{K^{0}_{S}}\) efficiencies after various cuts and for the different detector layouts and reconstruction strategies investigated.

Figure 10 shows the effect of the number of precision hits on the total reconstruction efficiency as a function of the decay radius for Initial and Complete layout. The results are in agreement with the TDR conclusion that relaxing the requirement on the number of precision hits increases the acceptance but also reduces the quality of the reconstruction, resulting in similar overall efficiency (see Table 14).

Figure 9: \(\Lambda^{0}\) mass resolution as a function of its decay vertex radius. The full circles correspond to an analysis using MC truth information from the event generator (all reconstructed \(\Lambda^{0}\) used), while the empty circles show results achieved by applying 3\(\sigma\) mass cuts on the \(J/\psi\), \(\Lambda^{0}\) and \(\Lambda^{0}_{\mathrm{b}}\).

Clearly a more involved reconstruction strategy, dedicated to secondary tracks reconstruction, is needed.

Figure 11 shows the total reconstruction efficiency as a function of the decay radius and the pseudorapidity for Initial and Complete layout in Athena. Apart from the overall lower efficiency the shapes of the distributions are similar to those in the TDR except for the \(|\eta|>2\) region, where the efficiency is significantly lower than the TDR one.

Figure 12 shows the mass resolution as a function of the decay radius in Athena. The TDR mass resolution was shown to vary between 4.5 and 7 MeV with the resolution much better for decays just in front of the pixel layers than for decays inside the SCT. The same holds in DC1 although the resolution is worse, varying between 5.6 and 16.5 MeV for the Initial layout and between 5.7 and 14 MeV for the Complete layout.

\begin{table}
\begin{tabular}{|l|c|c|} \hline \multicolumn{2}{|c|}{\(\Lambda^{0}_{\mathrm{b}}\rightarrow\mathrm{J}/\psi(\mu\mu)\)\(\Lambda^{0}\)\((\mathrm{p}\pi)\)} \\ \hline Analysis type & \(\Lambda^{0}\) mass resolution & Number of events \\  & \(\sigma\) [MeV] & inside 3\(\cdot\sigma\) region \\ \hline TDR & 2.5 \(\pm\) 0.04 & - \\ \hline All \(\Lambda^{0}\) using truth information & & \\ Initial layout & 3.53 \(\pm\) 0.07 & 3877 \\ Complete layout & 3.44 \(\pm\) 0.06 & 3943 \\ \hline \(\Lambda^{0}\) using 3\(\cdot\sigma\) mass cuts on \(J/\psi\), \(\Lambda^{0}\) and \(\Lambda^{0}_{\mathrm{b}}\) & & \\ Initial layout & 3.07 \(\pm\) 0.07 & 2856 \\ Complete layout & 3.13 \(\pm\) 0.06 & 3083 \\ \hline \end{tabular}
\end{table}
Table 13: \(\Lambda^{0}\) mass resolution using different cuts on the candidates.

Figure 10: \(\mathrm{K}^{0}_{\mathrm{S}}\) reconstruction effiency as a function of the decay radius in atrecon with a minimum of 7 and 6 precision hits for (a) Initial and (b) Complete layout.

## References

* [1] ATLAS Detector Performance Technical Design Report, Vol.2, CERN LHCC 99-15.
* [2] R.Hawkings, The ATLAS inner detector and flavour tagging performance, SN-ATLAS-2003-026, CERN; and N.Benekos, R.Clifft, M.Elsing, A.Poppleton, ATLAS Inner Detector Performance, ATL-INDET-2004-002; Geneva : CERN, 04 Dec 2003.
* [3] A. De Salvo, [http://classis01.roma1.infn.it/atlas-farm/atlas-kit/3.2.0](http://classis01.roma1.infn.it/atlas-farm/atlas-kit/3.2.0)
* [4] CASTOR group, [http://castor.web.cern.ch/castor/DOCUMENTATION/MAN/CASTOR/](http://castor.web.cern.ch/castor/DOCUMENTATION/MAN/CASTOR/)
* [5] ATHENA [http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/OO/](http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/OO/) architecture/General/Documentation/AthenaDeveloperGuide-8.0.0-draft.pdf
* [6] M. Smizanska, S.P.Baranov, J.Hrivnc, E. Kneringer, Overview of Monte Carlo simulations for ATLAS B-physics in the period 1996-1999, ATL-PHYS-2000-025.
* [7] M. Smizanska, PythiaB interface to Pythia6, ATL-COM-PHYS-2003-038
* [8] ATLAS Detector Performance Technical Design Report, Vol.1, CERN LHCC 99-14 or in more details ATLAS Inner Detector Technical Design Report, CERN, LHCC 97-16.
* [9] P.Nevski, ATLASIM, [http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DC/simu/](http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DC/simu/) and [http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DOCUMENTS/simulation.html](http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DOCUMENTS/simulation.html)
* [10][http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DC/DC1/DC1_2/](http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DC/DC1/DC1_2/)
* [11] I. Gavrilenko, xKALMAN, [http://atlas-sw.cern.ch/cgi-bin/cvsweb.cgi/offline/Reconstruction/xKalmanpp/xKalmanppAtrecon/](http://atlas-sw.cern.ch/cgi-bin/cvsweb.cgi/offline/Reconstruction/xKalmanpp/xKalmanppAtrecon/)
* [12] ATRECON group, [http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DOCUMENTS/reconstruction.html](http://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/DOCUMENTS/reconstruction.html)

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|} \hline  & TDR & \multicolumn{4}{|c|}{Initial Layout} & \multicolumn{4}{|c|}{Final Layout} \\ \cline{3-10} \(\mathrm{K_{S}^{0}}\) & tdr- & \multicolumn{4}{|c|}{atrecon} & Athena & \multicolumn{4}{|c|}{atrecon} & Athena \\ eff. \% & xKalman & 7 pr.h. & 6 pr.h. & Ath. err. & 6 pr.h. & 7 pr.h. & 6 pr.h. & Ath. err. & 6 pr.h. \\ \hline fiducial region & 68.6 & 66.1 & 66.1 & 66.1 & 64.7 & 66.1 & 66.1 & 66.1 & 64.7 \\ \hline Kine match & 52.8 & 41.5 & 44.5 & 48.3 & 46.5 & 42.9 & 45.4 & 49.4 & 47.4 \\ \hline after \(\chi^{2}\) cut & 43.6 & 33.0 & 34.7 & 38.8 & 36.8 & 34.1 & 35.4 & 39.8 & 37.7 \\ \hline after & 41.1 & 28.0 & 29.2 & 32.3 & 30.8 & 28.9 & 29.7 & 33.2 & 31.2 \\ all cuts & & & & & & & & \\ \hline \end{tabular}
\end{table}
Table 14: Fraction of \(\mathrm{K_{S}^{0}}\) generated within the fi ducial region, of reconstructed \(\mathrm{K_{S}^{0}}\) where both pions have been reconstructed by xKalman and the fraction of successfully fit tted \(\mathrm{K_{S}^{0}}\) after the \(\chi^{2}\) cut and after all selection cuts were applied for the different detector layouts and reconstruction strategies.