*Performance of the Fast ATLAS Tracking Simulation (FATRAS) and the ATLAS Fast Calorimeter Simulation (FastCaloSim) with single particles**

The ATLAS Collaboration

###### Abstract

Many physics and performance studies with the ATLAS detector at the Large Hadron Collider require very large samples of simulated events, and producing these using the full Geant4 detector simulation is highly CPU intensive. Often, a very detailed detector simulation is not needed, and in these cases fast simulation tools can be used. In ATLAS two complementary fast simulation programs have been developed. The _Fast ATLAS Track Simulation_ (Fatras) is a program developed for fast simulation of the ATLAS tracking systems, whilst the _ATLAS Fast Calorimeter Simulation_ (FastCaloSim) provides fast simulation of the calorimeter systems. Both these programs may be interfaced to the standard ATLAS digitization and reconstruction software. This note presents comparisons of the performance of fully reconstructed tracks simulated using Fatras to tracks simulated using the full Geant4 simulation, and a comparison of the performance of fully reconstructed topoclusters simulated using FastCaloSim compared to the full Geant4 simulation.

The ATLAS Collaboration

Many physics and performance studies with the ATLAS detector at the Large Hadron Collider require very large samples of simulated events, and producing these using the full Geant4 detector simulation is highly CPU intensive. Often, a very detailed detector simulation is not needed, and in these cases fast simulation tools can be used. In ATLAS two complementary fast simulation programs have been developed. The _Fast ATLAS Track Simulation_ (Fatras) is a program developed for fast simulation of the ATLAS tracking systems, whilst the _ATLAS Fast Calorimeter Simulation_ (FastCaloSim) provides fast simulation of the calorimeter systems. Both these programs may be interfaced to the standard ATLAS digitization and reconstruction software. This note presents comparisons of the performance of fully reconstructed tracks simulated using Fatras to tracks simulated using the full Geant4 simulation, and a comparison of the performance of fully reconstructed topoclusters simulated using FastCaloSim compared to the full Geant4 simulation.

(c) Copyright 2014 CERN for the benefit of the ATLAS Collaboration.

Reproduction of this article or parts of it is allowed as specified in the CC-BY-3.0 license.

Introduction

Simulated Monte Carlo events are a key ingredient to the majority of physics analyses and performance studies at ATLAS. In producing such events it is necessary to simulate not just the physical process of interest, but also the response of the detector. ATLAS uses a detailed detector simulation which makes use of the Geant4 [1] toolkit to model interactions between particles and the material of the detector. Unfortunately, a full simulation of such a large and complicated detector is highly CPU intensive, and often extremely large samples of simulated events are required for analysis. In some situations, such as the simulation of background events, a very detailed detector description is not needed, and in such cases fast simulation techniques may be used.

The _Fast ATLAS Track Simulation_ (Fatras) [2] is a program developed for fast simulation of the ATLAS tracking systems, and is capable of producing full track information, including hits on tracks. Fatras uses the same simplified geometry as is used in the reconstruction software, which significantly speeds up simulation compared to the complex geometry used in full simulation. The ATLAS track extrapolation engine [3] is used to transport the track parameters through the detector. Material effects are applied according to the amount of material traversed. Physics processes such as bremsstrahlung, multiple scattering, and creation of secondary particles are supported. Fatras is fully integrated into the ATLAS _Integrated Simulation Framework_ (ISF), and events simulated using Fatras can thus be passed through the standard digitization and reconstruction chain, in the same way as events simulated using Geant4.

The aim of the _ATLAS Fast Calorimeter Simulation_ (FastCaloSm) [4] package is to provide a parametrized simulation of the particle energy response and of the energy distribution in the ATLAS calorimeter and hence reduce the calorimeter simulation time to a few seconds per event. The parametrization is based on the Geant4 simulations of single photons, electrons and charged pions in a fine grid of simulated particle energies and directions. FastCaloSm is also fully integrated into the ISF.

This document compares the performance of fully reconstructed tracks simulated using Fatras to tracks simulated using Geant4, and the performance of fully reconstructed topoclusters simulated using the FastCaloSm compared to the full Geant4 simulation.

## 2 Fatras Tracking Performance

### Methodology

Single particle events are generated by "firing" particles of a specified type through the detector. The \(p_{T}\) of the particle is fixed, and the pseudo-rapidity \(\eta\) and azimuthal angle \(\phi\) are randomly drawn from a flat distribution with \(|\eta|<4.0,|\phi|<\pi\)1. Samples of electrons, muons, and pions are generated, and for each particle a sample is generated with \(p_{T}\)=5 GeV, \(p_{T}\)=20 GeV and \(p_{T}\)=50 GeV.

Footnote 1: ATLAS uses a right-handed coordinate system with its origin at the nominal interaction point (IP) in the centre of the detector and the \(z\)-axis along the beam pipe. The \(x\)-axis points from the IP to the centre of the LHC ring, and the \(y\)-axis points upward. Cylindrical coordinates \((r,\phi)\) are used in the transverse plane, \(\phi\) being the azimuthal angle around the beam pipe. The pseudorapidity is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan(\theta/2)\).

The generated events are simulated using the Integrated Simulation Framework (ISF), in two configurations. In the first, the inner detector is simulated using the standard Geant4 simulation, and in the second the inner detector is simulated using Fatras. In both configurations, the calorimeter and muon spectrometer systems are not simulated. Following simulation, the events are passed through the standard ATLAS digitization and reconstruction chain. At least 20,000 events are generated in each configuration for each particle type at each \(p_{\mathrm{T}}\) point.

The tracking performance is then compared between the two configurations. No selection requirements are applied to the reconstructed tracks, except that the reconstructed track must be matched to the generated particle by requiring that a certain fraction of the hits forming the track originated from the truth particle. This requirement ensures that only tracks from the primary particles are considered. For single particle events (as used in this study), the efficiency for the matching is 100%.

#### 2.1.1 Track Reconstruction Efficiency

The main reason for a loss of tracking efficiency for isolated single particles is material interactions. For electrons, this arises mainly as a result of bremsstrahlung, while for pions the dominant loss of efficiency is due to due to hadronic interactions. The rate of bremsstrahlung for muons is much lower than for electrons, so isolated muon tracks are expected to be reconstructed with near 100% efficiency.

The track reconstruction efficiency is defined as the ratio of the number of reconstructed tracks (matched to a truth particle) to the number of truth particles:

\[\epsilon_{track}=\frac{N_{rec}(matched)}{N_{truth}} \tag{1}\]

The resulting tracking efficiencies as a function of \(\eta\) are shown in Figure 1. For muons, the simulated efficiency is slightly higher in Fatras relative to Geant4, while for pions it is slightly lower in Fatras. For electrons, the efficiency is generally in agreement between Fatras and Geant4.

#### 2.1.2 Track Parameter Resolutions

Resolutions of the track parameters are obtained by comparing the values of the reconstructed track parameters for a given particle with the true generated value. For each reconstructed track, the difference between the reconstructed and the generated value of the parameter is computed and plotted. The resolution of the parameter in question is taken as the width of a Gaussian fitted to this distribution. In order to control outliers, the fit is restricted to the core of the distribution, and any point beyond \(\pm 2\times\)RMS of the mean of the distribution is not used. This procedure is repeated in bins of \(\eta\) of the reconstructed track.

Figure 2 shows the simulated \(z_{0}\) (the longitudinal impact parameter with respect to the interaction point), \(d_{0}\) (the transverse impact parameter with respect to the interaction point), \(q/p_{T}\) (the charge divided by the transverse momentum), \(\theta\) (the polar angle), and \(\phi\) (the azimuthal angle around the beam pipe) resolutions for muons, comparing the resolution simulated in Fatras to the resolution simulated in Geant4. The Fatras resolutions are generally in good agreement with the Geant4 resolutions, although the \(d_{0}\) and \(q/p_{T}\) resolution in Fatras is somewhat smaller than in Geant4, particularly at low \(p_{\mathrm{T}}\) and at high \(\eta\). Figure 3 shows the simulated resolutions for pions. As for muons, the simulated resolutions are slightly lower in Fatras than in Geant4. Finally, Figure 4 shows the resolutions for electrons. In this case the \(d_{0}\), \(q/p_{T}\), and \(\phi\) resolutions are slightly larger in Fatras than in Geant4, particularly at low \(p_{\mathrm{T}}\).

The material description used in the current version of Fatras includes more material than in the current version of the Geant4 simulation, especially in the Pixel detector. The agreement between Fatras and Geant4 should thus improve when the material description in Fatras is updated.

Figure 1: The simulated track reconstruction efficiency in Fatras (solid lines) and Geant4 (dashed lines) for (a) muons (b) pions and (c) electrons.

Figure 2: Reconstructed track resolutions in (a) \(z_{0}\), (b) \(d_{0}\), (c) \(q/p_{T}\) (d) \(\theta\), and (e) \(\phi\) for muons at several values of \(p_{\mathrm{T}}\). The dashed lines show the resolution in events simulated using the standard Geant4 simulation and the solid lines the resolution in events simulated using Fatras.

Figure 3: Reconstructed track resolutions in (a) \(z_{0}\), (b) \(d_{0}\), (c) \(q/p_{T}\) (d) \(\theta\), and (e) \(\phi\) for pions at several values of \(p_{\mathrm{T}}\). The dashed lines show the resolution in events simulated using the standard Geant4 simulation and the solid lines the resolution in events simulated using Fatras.

Figure 4: Reconstructed track resolutions in (a) \(z_{0}\), (b) \(d_{0}\), (c) \(q/p_{T}\) (d) \(\theta\), and (e) \(\phi\) for electrons at several values of \(p_{\mathrm{T}}\). The dashed lines show the resolution in events simulated using the standard Geant4 simulation and the solid lines the resolution in events simulated using Fatras.

FastCaloSim

The aim of the fast calorimeter simulation FastCaloSim is to provide a simulation which is fast but reproduce the key features of reconstructed object properties. Differences in details due to simplifications in the simulation model have to be accepted, but should not lead to large and unpredictable differences at the analysis level. In order to evaluate the performance of the calorimeter simulation, the inner detector and the muon system are simulated with Geant4. This combination of full and fast simulation is called Atlast-II and reduces the overall simulation time by approximately one order of magnitude.

It is clear that any significant improvement in speed must stem from simplifications in the simulation model. The simulation uses the reconstruction geometry of the calorimeter that describes calorimeter cells as cuboids in \(\eta\), \(\phi\) and the depth of the calorimeter (forward calorimeter cells are cuboids in \(x\), \(y\) and \(z\)). This is a reasonable assumption for the homogeneous regions of the electromagnetic calorimeter, but only an approximation for the other calorimeters or for calorimeter edge regions. The simulation of the development of particle showers in the calorimeter takes a large amount of time and is therefore replaced by parameterisations. The fast simulation model reproduces the longitudinal shower properties, including fluctuations and correlations, but only average lateral shower properties and uncorrelated lateral energy fluctuations.

The fast calorimeter simulation FastCaloSim is integrated into the Atlast-II simulation package [5] that is currently used within ATLAS for Monte Carlo bulk production and was used to produce approximately half of the total ATLAS Monte Carlo statistics for physics analysis. FastCaloSim is able to simulate correctly most calorimeter objects. However, in hadronic showers it fails to describe the substructure of the groups of topologically related deposits in the ATLAS calorimeter cells. Those deposits, called topoclusters [6], are the base of ATLAS jet reconstruction, and hence FastCaloSim cannot be used for analyses that need a realistic simulation of these clusters, such as jet substructure studies. This paper describes two approaches under study for improving the modelling of topoclusters. The first introduces additional statistical fluctuations in the transverse shower development and the second provides a parameterization of the probability that a single pion shower will split into two or more. A comparison of the performance of the standard FastCaloSim with a modified version that incorporates these new features is presented below.

### Methodology

The samples, at generator level, consist of single pions at a fixed energy of 50 GeV, and where the pseudo-rapidity \(\eta\) and azimuthal angle \(\phi\) are randomly drawn from a flat distribution with \(|\eta|<0.2,\ |\phi|<\pi\).

Generated events are simulated using the Integrated Simulation Framework (ISF), in three configurations. In the first, the full detector is simulated using standard Geant4 simulation, in the second the calorimeters are simulated using standard FastCaloSim  and in the third, the calorimeters are simulated using modified FastCaloSim  with the modifications explained in the sections below. Both the full and fast simulations have been run without calorimeter noise. For all configurations, following simulation, events are passed through the standard ATLAS digitisation and reconstruction chain; 5,000 events are generated in each configuration.

### Random Fluctuations

The shower shape parameterisations in the baseline FastCaloSim do not reproduce the shower-to-shower fluctuations observed in full simulation and data. Differences are observed in the distributions of the number of topoclusters resulting from a single pion. Differences in the probability of observing topoclusters at large radius \(\Delta R(\pi,cls)\) are especially sizeable, where \(\Delta R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\), \(\pi\) is the simulated pion and \(cls\) refers to one of the topoclusters in the event.

The idea behind the new random fluctuation approach is illustrated in the graphic representation in Figure 5. In the example, histograms are filled with random entries following a 2D gaussian as probability density function, and normalised to the same value. If 10,000 random numbers are used, a very regular shape is obtained, as in Figure 5 top plot. If only 100 random numbers are used, some irregularities start appearing in the obtained shape, such as in the middle plot. If only 10 random numbers are used, the final shape shows a lot of irregularities and sub-clusters, as in the bottom plots of Figure 5, where four different examples are given.

In a modified FastCaloSim using the random fluctuations approach, the distribution used as the probability density function is the energy deposit that standard FastCaloSim attributes to each cell in a given calorimeter layer. The energy in the layer is divided in a number \(N\) of energy deposits, which are deposited in cells chosen randomly, taking into account their weight. The same cell can get more than one pack of energy (which is more likely if the cell is very energetic in the standard FastCaloSim distribution) and some cells won't have energy deposited, even if they did in the standard approach. The energy in the layer is normalised, so both standard and modified FastCaloSim deposit the same energy in each layer of the calorimeter. The number of energy deposits \(N\) is a parameter which can be tuned, layer by layer.

The final result is that more clusters are created after the full simulation and reconstruction chain, giving a better agreement with the full Geant4 simulation than seen when using the standard FastCaloSim approach. However, the random fluctuation approach is not completely successful at getting the topoclusters at high \(\Delta R(\pi,cls)\), and to address this region, the splitting approach is implemented, as explained in the next section.

Figure 5: A graphical representation of how the observed fluctuations in the shower shape are affected by the number energy deposits. The top and middle plots are the shapes produced using 10,000 and 100 energy deposits respectively. The bottom plot shows four individual examples where 10 energy deposits are used. In all cases, the overall energy deposited is normalised to the same value.

### Splitting

A second method of improving the modelling of the shower shape uses a Geant4derived parameterisation of the energy deposition as a function of the distance between the pion's path. The parameterisation defines with which probability a pion will be treated as two split pions, for a given energy and angular distance. The split pions are then treated in the FastCaloSim simulation, and will originate more clusters in the far \(\Delta R(\pi,cls)\) region, where standard FastCaloSim fails to produce clusters.

The splitting approach is complementary to the random fluctuations, and the combination of both methods is expected to yield better agreement with respect to full Geant4 simulation than each of the methods separately, and than the standard FastCaloSim.

### Results

Results presented in this section were produced using full Geant4 simulation, standard FastCaloSim and modified FastCaloSim using both random fluctuations and the splitting approaches, as described in section 3.1. Modified FastCaloSim has several variables which can be tuned, layer by layer of the calorimeter. This tuning is still ongoing and all the results shown in Figs. 7-16 are made with preliminary tuning. Improvement of the agreement between modified FastCaloSim and full Geant4 simulation is expected after the final tuning is implemented.

#### 3.4.1 Cluster Variables

There are many variables which are relevant at the topocluster level, and for the testing and tuning of parameters a large number of them were taken into consideration. However, for this paper, a small set of variables was chosen, and correspond to those quantities where the differences between standard FastCaloSim and modified FastCaloSim are bigger. Those are the number of topoclusters, angular distance between topoclusters and generated pion, mean energy of a topocluster and its root mean square, energy of the leading cluster, and the ratio of energy in the second cluster and energy in all topoclusters as a function of angular distance of the cluster and generated pion.

Figure 6 shows the number of topoclusters, for inclusive \(\Delta R(\pi,2nd~{}cls)\) values. Standard FastCaloSim gives most of the events one or two topoclusters, and does not populate the tail of the distribution. Modified FastCaloSim greatly improves the tail population, but underestimates the lower values, with respect to the Geant4 simulation. Figure 7 shows the angular distance \(\Delta R\) between the pion and the second most energetic topocluster. Standard FastCaloSim shows that it gets most events concentrated in a low \(\Delta R\) value, and fails to populate the tail above \(\Delta R(\pi,2nd~{}cls)>0.1\). Modified FastCaloSim populates the tail up to \(\Delta R(\pi,2nd~{}cls)>0.16\), although in the current configuration it underpopulates the low \(\Delta R\) region. This is expected to be corrected with further tuning of parameters in the new approach.

To further assess improvements of the new FastCaloSim approach in the high \(\Delta R(\pi,2nd~{}cls)\) region, Figure 8 shows the number of topoclusters for \(\Delta R(\pi,2nd~{}cls)>0.15\). Modified FastCaloSim shows even better agreement with Geant4 compared to standard FastCaloSim than in the inclusive \(\Delta R(\pi,2nd~{}cls)\) region. Figure 9 shows the mean energy of a topocluster as a fraction of the truth energy, for inclusive and \(\Delta R(\pi,2nd~{}cls)>0.15\) regions. This quantity is related to the number of topoclusters, as the mean energy peaks around 1 when there is only one topocluster in the event, around 0.5 when there are two topoclusters, around 0.33 for three topoclusters, and so on. Standard FastCaloSim overestimates the peak around 1 and doesn't peak at all for values under 0.5. Modified FastCaloSim reproduces the Geant4 behaviour better, as it manages to get more topoclusters in one event than the standard approach. Figure 10 shows the root mean square of the energy in a topocluster as a fraction of the total energy. Modified FastCaloSim also shows better agreement with respect to Geant4 than standard FastCaloSim, in both regions of \(\Delta R(\pi,2nd~{}cls)\). Figure 11 shows the energy of the leading cluster. The modifiedapproach shows reasonable agreement, within uncertainties, and improved agreement with respect to the standard FastCaloSim in the inclusive \(\Delta R(\pi,2nd\ cls)\) region. The new tuning of the modified approach is expected to improve the agreement of this variable.

Figure 12 shows the ratio

\[R=\frac{E_{2nd\ cluster}}{E_{Topocluster}} \tag{2}\]

where \(E_{2nd\ cluster}\) is the energy in the second most energetic cluster and \(E_{Topocluster}\) the energy in all topoclusters, as a function of the \(\Delta R(\pi,2nd\ cls)\), for Geant4, standard FastCaloSim and modified FastCaloSim. The modified approach populates the high \(R\) and high \(\Delta R\) values, which were not populated in the standard FastCaloSim. Future tuning of the parameters of the modified simulation should improve the agreement of \(R\) between full and fast simulation

#### 3.4.2 Cell Level and Shower Shape Variables

Shower shape variables play an important role in lepton identification. In particular, discriminating taus from QCD jet backgrounds relies on multivariate methods that use shower shape variables. This section compares the performance of FastCaloSim to the Geant4 simulation for several variables used for tau identification. The samples at generator level are described in section 3.1, containing single pions, meaning all the taus in this comparison are fake taus coming from pion samples.

In Figure 13, the comparison is at the cell level: the plots show the \(\Delta R\)(cell, particle) for the dominant electromagnetic calorimeter layer (EM2) and the dominant hadronic tile layer (Tile0). Standard FastCaloSim was not able to reproduce the tails above \(\Delta R\)(cell, particle) \(>0.15\) for the EM2 layer and above \(\Delta R\)(cell, particle) \(>0.3\) for the Tile0 layer. Modified FastCaloSim is able to populate tails all the way up to \(\Delta R\)(cell, particle) \(=0.5\), although with some shape differences.

Figure 14 shows the root mean square of the transverse extension (second moment in \(r\)) and of the longitudinal extension (second moment in \(\lambda\)). The variables \(r\) and \(\lambda\) can be better visualised in the Figure 15, where the tau shower shape and its relevant variables is shown. The modified approach shows better agreement with respect to Geant4 when compared to the standard FastCaloSim.

Figure 6: The number of topoclusters for all regions of \(\Delta R(\pi,2nd\ cls)\) in the full Geant4 simulation (black points), standard FastCaloSim (red dashed histogram) and modified FastCaloSim (blue histogram) with random fluctuation and splitting approaches merged.

Figure 8: The number of topoclusters for \(\Delta R(\pi,2nd\ cls)>0.15\) in the full Geant4 simulation (black points), standard FastCaloSim (red dashed histogram) and modified FastCaloSim (blue histogram) with random fluctuation and splitting approaches merged.

Figure 7: The \(\Delta R(\pi,2nd\ cls)\) in the full Geant4 simulation (black points), standard FastCaloSim (red dashed histogram) and modified FastCaloSim (blue histogram) with random fluctuation and splitting approaches merged.

Figure 10: The root mean square of the energy in a topocluster as fraction of the total energy for (a) all regions of \(\Delta R(\pi,2nd\ cls)\) and for (b) \(\Delta R(\pi,2nd\ cls)>0.15\) in the full Geant4 simulation (black points), standard FastCaloSim (red dashed histogram) and modified FastCaloSim (blue histogram) with random fluctuation and splitting approaches merged.

Figure 9: The mean energy of a topocluster as a fraction of the true energy for (a) all regions of \(\Delta R(\pi,2nd\ cls)\) and for (b) \(\Delta R(\pi,2nd\ cls)>0.15\) in the full Geant4 simulation (black points), standard FastCaloSim (red dashed histogram) and modified FastCaloSim (blue histogram) with random fluctuation and splitting approaches merged.

The tau identification uses a BDT input to distinguish between real and fake taus. One of the variables which enters the BDT input, the tau isolation, is shown in Figure 16. Modified FastCaloSim once more performs in better agreement with full Geant4 simulation than standard FastCaloSim.

## 4 Conclusion

Comparisons were presented of the performance of fully reconstructed tracks simulated using Fatras with the results of full Geant4 simulation, and of the performance of reconstructed topoclusters simulated using FastCaloSim compared to Geant4.

The simulated tracking efficiency for muons is slightly higher in Fatras compared to Geant4, while for pions it is slightly lower in Fatras. The simulated electron tracking efficiency is generally in agreement between Fatras and Geant4, although the efficiency for high \(p_{\mathrm{T}}\) electron tracks in Fatras is significantly lower at high \(\eta\). For pions and muons, the resolutions of the track \(z_{0}\), \(d_{0}\), \(q/p_{T}\), \(\theta\), and \(\phi\) parameters are slightly smaller in Fatras than in Geant4, while for electrons the parameter resolutions in Fatras are slightly larger than in Geant4.

For the FastCaloSim performance, two different configurations were used: standard FastCaloSim, currently used in production at the ATLAS experiment; and modified FastCaloSim, which implements two different approaches to improve the simulation performance. The two methods address different issues seen with standard FastCaloSim: the random fluctuations approach increases the number of topoclusters created by FastCaloSim simulation, and the splitting approach increases the number of clusters created in the high \(\Delta R(\pi,cls)\) region. Each method shows improvements in the cluster variables, and the combination of the two yields better agreement with respect to full Geant4 simulation than previously obtained with standard FastCaloSim. Another validation shown was for the variables used in tau reconstruction. The modified FastCaloSim approach was able to populate tails previously underestimated by standard FastCaloSim. Although improvements at both topocluster and tau reconstruction level were seen when using modified FastCaloSim, there is room for tuning of several parameters of the new approach. The tuning effort is ongoing, and is expected to improve further the agreement between FastCaloSim and full Geant4 simulation.

Figure 11: The energy of the leading cluster for (a) all regions of \(\Delta R(\pi,2nd\ cls)\) and for (b) \(\Delta R(\pi,2nd\ cls)>0.15\) in the full Geant4 simulation (black points), standard FastCaloSim (red dashed histogram) and modified FastCaloSim (blue histogram) with random fluctuation and splitting approaches merged.

Figure 12: The ratio of the energy in the second cluster and the energy in all topoclusters, as a function of the \(\Delta R(\pi,2nd\ cls)\), for (a) full Geant4 simulation, (b) standard FastCaloSim and (c) modified FastCaloSim with the random fluctuations and splitting approaches merged.

Figure 13: The \(\Delta R\)(cell, particle) for the (a) dominant electromagnetic calorimeter layer (EM2) and (b) dominant tile layer (Tile0), for standard FastCaloSim (red), modified FastCaloSim (blue) and full Geant4 simulation (black).

Figure 14: The root mean square of the (a) transverse extension (second moment in \(r\)) and of the (b) longitudinal extension (second moment in \(\lambda\)) in the tau shower shape, for standard FastCaloSim (red), modified FastCaloSim (blue) and full Geant4 simulation (black).

Figure 15: Schematic picture of the tau shower shape and its relevant variables, such as the RMS of the transverse extension in R ( \(\sqrt{<r^{2}>}\)) and the RMS of the longitudinal extension in \(\lambda\) ( \(\sqrt{<\lambda^{2}>}\)).

## References

* a simulation toolkit_, Nuclear Instruments and Methods in Physics Research Section A: Accelerators, Spectrometers, Detectors and Associated Equipment **506** no. 3, (2003) 250
- 303. [http://www.sciencedirect.com/science/article/pii/S0168900203013688](http://www.sciencedirect.com/science/article/pii/S0168900203013688).
* [2] K. Edmonds, S. Fleischmann, T. Lenz, C. Magass, J. Mechnich, and A. Salzburger, _The Fast ATLAS Track Simulation (FATRAS)_, ATL-SOFT-PUB-2008-001. [http://cds.cern.ch/record/1091969](http://cds.cern.ch/record/1091969).
* [3] A. Salzburger, _The ATLAS Track Extrapolation Package_, ATL-SOFT-PUB-2007-005. [http://cds.cern.ch/record/103810](http://cds.cern.ch/record/103810).
* [4] ATLAS Collaboration, _The simulation principle and performance of the ATLAS fast calorimeter simulation FastCaloSim_, ATL-PHYS-PUB-2010-013. [http://cds.cern.ch/record/1300517](http://cds.cern.ch/record/1300517).
* [5] ATLAS Collaboration, _The ATLAS Simulation Infrastructure_, Eur. Phys. J. C **70** (2010) 823-874. 53 p. [http://cds.cern.ch/record/1267853](http://cds.cern.ch/record/1267853).
* [6] ATLAS Collaboration, _The performance of ATLAS detector_. Springer, Heidelberg, 2011. [http://cds.cern.ch/record/1485681](http://cds.cern.ch/record/1485681). Reprinted from The European Physical Journal C (articles published between summer 2010 and spring 2011).

Figure 16: Tau isolation variable, calculated from the energy in between \(\Delta R=[0.1,0.2]\) in a 0.2 cone, used in the tau BDT identification, for standard FastCaloSim (red), modified FastCaloSim (blue) and full Geant4 simulation (black).