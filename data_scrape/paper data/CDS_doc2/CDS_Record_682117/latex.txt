# **ATLAS Internal Note**

**LARG-NO-097**

**23 April 1998**

**Energy Resolution of the HEC**

**Prototype from the Pion'96 Data**

_A.Cheplakov, G.Gogiberidze, T.Grigalashvili, S.Kakurin, M.Kazarinov, V.Kukhtin, E.Ladygin, A.Lazarev, R.Mehdiyev, Z.Metreveli, V.Obudovsky, D.Salihagic, A.Shalyugin, S.Shilov Joint Institute for Nuclear Research, Dubna, Russia_

On leave from Institute of Physics, Tbilisi 380077, GeorgiaOn leave from Institute of Physics, Tbilisi 380077, GeorgiaPermanent address: Institute of Physics, Baku, AzerbaijanOn leave from Tbilisi State University, Tbilisi, GeorgiaPermanent address: University of Montenegro, Podgorica, Montenegro

February 18, 1998

###### Abstract

The pion energy resolution obtained in the frame of the standard approach and the neural net is presented. The analysis is performed for the full set of data without any selection of the hadronic showers with respect to the deposited energy profile. For the pion cluster selection a sigma and readout dependent noise cut has been applied.

## 1 Data Processing

The September'96 testbeam data have been analysed for the pion energies from 40 to 200 GeV. The corresponding run numbers are 6119, 6118, 6117, 6116, 6114, 6150 and 6176, which contain data with the same coordinates of the beam entry point at pad 90. To account for the hardware problems the correspondent correction factors were applied to the ADC counts.

### Selection of cells

Only the cells near the beam entry point have been taken into the consideration. To select the proper configuration the width of cell ADC distribution of "real" eventswere compared to the width of corresponding pedestals. Only cells with wide ADC distributions (ratio of the widths has to be more than 1.15\(\div\)1.20) were selected (see Fig. 1).

The same configuration of cells has been used for all energies mentioned. Analysis of Monte Carlo simulated data [1] indicates that about 96% of the shower "visible" energy are deposited within these cells.

In each event the calorimeter information from the cell was taken for the analysis only if the special noise cut described below was satisfied.

To select the proper noise cut we have compared the experimental and the Monte Carlo data. As the value of the deposited energy is not the same for various longitudinal segments, the noise cut may be also different. We have found that the cut of \((3/1)\sigma\)1 is suitable for the segments 2 and 3, which contain the main part of the hadronic showers, and the cut of \((2/1)\sigma\) is more effective for the first one and for the last two segments as it allows to collect more deposited energy.

Footnote 1: The cell is left for the analysis if the ADC count is higher than the pedestal by 3\(\sigma\) (\(\sigma\) is the width of pedestal distribution). If the ADC excess is less than 3\(\sigma\) but higher than 1\(\sigma\), the cell could be taken only if there is a neighboring cell with ADC count greater than 3\(\sigma\).

An agreement between the experimental and Monte Carlo simulated data has been observed for this readout segment dependent cut. In Fig. 2 the "linearity" at ADC level is presented. The shown is normalized to 40 GeV the ratio of ADC counts summed over the cells configuration to the beam energy E: (\(<\)ADC(E)\(>\)/E)\(\cdot\)(40/\(<\) ADC(40)\(>\)). Many combinations of the noise cut were considered and the following are presented: \(3/1\sigma\), (3,2)/1\(\sigma\) cut (3\(\sigma\) for the first three readout segments and 2\(\sigma\) for two back segments), (2,3,2)/1\(\sigma\) (the same as for (3,2)/1 but 2\(\sigma\) for the first segment) - all for the cells of selected configuration, and 4/1\(\sigma\) applied to all cells of the module.

Figure 1: _Selected configuration of the cells (ADC numbers are noticed). Dashed line shows the beam direction._

The "combined" (2,3,2)/1\(\sigma\) noise cut has been used for our analysis. We have to note that it was not possible to get a reasonable statistics based on the application of the noise cut for 20 GeV pion data from the September'96 run.

### Rejections of electrons

The "pion" events were selected by the standard trigger routine. To reject more electrons from the pion beam an additional cut was applied. The first moment of the shower longitudinal development (center of gravity) was calculated as

\[S_{1}=\sum_{j=1}^{5}j\cdot\sum_{k=1}^{N_{j}}A(k,j),\]

where \(N_{j}\) is number of cells in \(j\)-segment with the ADC signal greater then 1\(\sigma\) and \(A\) are ADC values with pedestals subtracted. In Fig. 3 an example is presented for 40 and 100 GeV pion and electron data.

For the pion event selection the cut of \(S_{1}=1.2\) was introduced. The events with the center of gravity greater then 1.2 were considered as pion events. About 10-12 % of raw events were rejected at low pion energy due to \(S_{1}\) cut. At the beam energy

Figure 2: _ADC “linearity” (normalized to unit at 40 GeV of initial energy) for different noise cut in the experiment and Monte Carlo (M.C.). In addition to the selected configuration (indicated by ‘C’) the full set of calorimeter module cells was also considered (indicated by ’F’). In this case the noise cuts were applied for all cells including those outside the selected configuration._

of 100 GeV and higher less then 3 % of data were rejected. Due to this cut some pion showers absorbed in the first segments were not considered in the analysis.

### Calibration procedure

The calibration coefficients \(c_{j}\) (\(j\) is the segment number, \(j\)=1,5) were determined simultaneously for the full set of pion energies and events by minimizing the sum:

\[\sum_{i=1}^{7}\frac{1}{N_{\mbox{\tiny{Ee}}}}\sum_{e=1}^{N_{\mbox{\tiny{Ee}}}} \frac{(E_{\mbox{\tiny{meas}}}^{(e)}-E_{\mbox{\tiny{beam}}}^{(i)})^{2}}{\sigma_ {i}^{2}},\]

where \(E_{\mbox{\tiny{meas}}}=\sum_{j=1}^{5}c_{j}\cdot\sum_{k=1}^{N_{j}}A(k,j)\). For five longitudinal compartments the following values of the calibration coefficients were obtained :

\[c_{1}=0.096,\ c_{2}=0.092,\ c_{3}=0.139,\ c_{4}=0.122,\ c_{5}=0.194.\]

In the analysis we have used these five coefficients for all energies.

## 2 Energy resolution

The deposited energy distributions obtained by means of these five calibration coefficients were fitted by the Gaussian. The values of the calculated energy and energy

Figure 3: _First moment distribution for the shower longitudinal profile for electron and pion runs (the trigger cuts are applied). The electron run numbers are 6103 and 6106._

resolution (\(\sigma_{init}\)) are presented in Table 1.

### Noise term calculations

The expected noise has been calculated from the random trigger events. When cell configuration for the "real" event is determined the same set of cells has been used for ADC summing from one of the random trigger event. The widths of corresponding distributions are presented in Fig. 4 for different nominal energies.

It is seen that noise is growing with energy. These values were subtracted quadratically from the correspondent widths of energy distribution and the results are presented in Table 1 as \(\sigma_{corr}\).

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Nominal energy, GeV & 40 & 60 & 80 & 100 & 120 & 150 & 200 \\ \hline Calculated Energy, GeV & 40.3 & 59.2 & 78.2 & 97.8 & 118.1 & 149.3 & 199.4 \\ \(\sigma_{init}\), GeV & 8.2 & 9.4 & 10.9 & 12.2 & 14.4 & 17.0 & 20.5 \\ \(\sigma_{corr}\), GeV & 7.2 & 8.5 & 10.1 & 11.6 & 13.5 & 16.2 & 19.9 \\ Number of events & 4216 & 4697 & 5711 & 6407 & 5971 & 8692 & 17774 \. & & & & & & \\ \hline \end{tabular}
\end{table}
Table 1: _Results of the Gaussian fit for different pion energies. The uncertainty of the calculated energies and \(\sigma\) is of the order of 1%. The energy resolution corrected for the noise is presented as \(\sigma_{corr}\)._

Figure 4: _The width of the noise distributions for different initial pion energies. As higher beam energy as more cells were satisfied the noise cut inside the selected cells configuration. Dashed line is the result of linear fit._

### Parameters of the energy resolution

After the noise subtraction the energy resolution of the calorimeter prototype was fitted using two parameters

\[\frac{\sigma(E)}{E}=\frac{a}{\sqrt{E}}\oplus b\]

with the sampling and constant terms

\[a=(99.8\pm 2.2)\%\mbox{ and }\mbox{b}=(7.0\pm 0.2)\%\]

Result of the fit is presented in Fig. 5 by solid line.

## 3 Neural Net Approach for the Data Analysis

The aim of the approach was to develop the neural net which may improve the energy resolution. The standard calibration of the calorimeter is the linear procedure which gives the energy value as a product of the calibration coefficients and the energy fractions deposited in different longitudinal segments. Hopefully the influence of the dead preamplifiers, cracks, energy leakages, etc., could be taken into account more accurately by the nonlinear fitting procedure.

Figure 5: _Energy resolution of the calorimeter module for the standard (solid line) and neural net (dashed line) approaches._

[MISSING_PAGE_FAIL:7]

More then one hidden layer for fitting and optimization tasks is recommended [3]. The Manhattan updating procedure is convenient for these networks [2]: \(\Delta\omega_{ij}=-\eta\cdot sign[\partial F/\partial\omega_{ij}]\). In this case the learning is bounded and it is easier to find an appropriate value for \(\eta\), which should decrease with increasing number of training.

The result of the training are the values of the connectivity weights which provide the direct functional mapping between ADC counts and beam energy values. These weights have been used later on for the experimental data analysis (the same set for all energies). Usually the uniform spectrum of initial data is used for the training. To overcome the difficulty caused by the irregular beam energy scale, the ADC counts as well as the beam energy were spread by the same factor randomly around its actual value.

As far as the beam energies were distributed irregularly on the beam energy scale, a sub-set of data events for various energies has been used for the net training (see Table 2). Also the smaller number of events for boundary energies (at 40 GeV and 200 GeV) have been used due to some particularity of the neural net.

Big number of training events (\(\sim\)30 % of the total statistics) prevents a custom of neural net to training set (it takes about 0.0001 second per event on Sun Spark 10 workstation). For the training purposes the energy was reconstructed by the standard procedure described above. Only events which have the energy close to the nominal energy (\(\pm 2\sigma\)) were considered.

For our analysis we have used the net with different number of neurons in each of 4 layers (5-6-2-1 architecture with 5 inputs and 1 output).

Five inputs were used for the net: \(x_{l=1,3}=A_{l}/2500,\ x_{l=4,5}=A_{l}/1500\), where \(A\) is the sum of ADC counts for readout segment \(l\). It is known that the neural net is operating effectively with the value from (0 - 1) interval. That is why the ADC sums were divided by the large numbers.

The target value in our case was the value of nominal energy. After the training procedure the neural network was applied for the total sample of data events including those used for the training.

### Results of the neural net approach

The energy distributions obtained by means of the neural network were fitted by the Gaussian. The fit results for different energies are presented in Table 3.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Beam energy, GeV & 40 & 60 & 80 & 100 & 120 & 150 & 200 \\ \hline Number of events & 3000 & 4000 & 5000 & 5000 & 5700 & 6000 & 3000 \\ \hline \end{tabular}
\end{table}
Table 2: _Number of events for the net training._

### Energy resolution obtained with neural net

The fit of the prototype module energy resolution after the noise corrections gave the following values for the sampling and constant terms:

\[a=(89.5\pm 2.1)\%,\ b=(6.3\pm 0.2)\%.\]

The results of the fit is presented in Fig. 5 by dashed line. The quality of the fit is not so good to insist on the advantages of the neural net method.

Probably, the noise subtraction procedure has to be implemented to the neural net scheme. Further basis has to be provided by treatment of Monte Carlo and new experimental data.

## References

* [1] Monte Carlo code at MPI
* [2] L. Lonnblad, C. Peterson and T. Rognvaldsson, Comput. Phys. Communication, **70**, No 1. (1992).
* [3] L. Lonnblad, C. Peterson and T. Rognvaldsson, "Mass Reconstruction with a Neural Networks", Phys. Lett., **B 278** (1992) 181.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline Nominal energy, GeV & 40 & 60 & 80 & 100 & 120 & 150 & 200 \\ \hline Calculated energy, GeV & 40.5 & 60.1 & 79.6 & 97.9 & 116.3 & 144.7 & 195.9 \\ \(\sigma_{init}\), GeV & 7.9 & 9.4 & 9.9 & 10.7 & 12.3 & 14.4 & 19.1 \\ \(\sigma_{corr}\), GeV & 6.8 & 8.5 & 9.1 & 9.9 & 11.2 & 13.6 & 18.4 \\ \hline \end{tabular}
\end{table}
Table 3: _Characteristics of the deposited energy distributions after the neural net procedure. The statistical uncertainties are close to those in Table 1._