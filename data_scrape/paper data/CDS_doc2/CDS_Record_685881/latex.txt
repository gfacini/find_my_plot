**ATLAS Internal Note**

**INDET-NO-044**

**19 April 1994**

**Fake Tracks in the Atlas Inner Detector with Perfect PR**

**Stephen Haywood - RAL**

## 1 Motivation

It is found that if one does PR in the context of any detector design, then in general some fraction of true particle tracks will be correctly reconstructed (the _efficiency_) while some fake tracks will also be found. In the ideal case that hits on detectors from particles or noise are not merged, and even allowing for a certain amount of (but not catastrophic) inefficiency, the efficiency for finding tracks within the fiducial volume of the tracker can always be made 100%. This can be attained trivially by forming all possible combinations of hits, for example. The downside of obtaining high efficiency may be that there are a large number of fake tracks (and it may take a very long time to test all combinations).

**One class of these fakes is random combinations of hits (some of which may be ghosts) which _within errors_ lie on a helix. The measure of how well a helix fits such candidate tracks is measured by the track \(\chi^{2}\), and _if_ one believes the description of the _errors_ on hits, then by cutting on the \(\chi^{2}\) probability, one can reduce the number of fakes, while also reducing the efficiency in a predictable manner. Such fake tracks can also be removed by demanding that hits should exist on detectors supposedly traversed by the track. Some flexibility is required to allow for inefficiencies. The occurrence of such fakes is reduced by better detector resolution.

**A second class of fake tracks arises when tracks pass through a set of detectors which measure just two distinct projections. In such a configuration, fakes arise from combining the projection of one track with the projection of a different track. These projection are \(r\phi\) and \(z\) in the case of Crossed-Strips. and \(u\) and \(v\) in the case of Stereo layers. Any detector which measures unique space-points. such as Pixels, automatically resolves any ambiguities and removes all fake tracks of this class. Similarly, if any detectormeasures a third projection, the ambiguities can be resolved. These fakes exist in 3-D only, and at the level of the projections, there is no ambiguity. So for Crossed-Strip detectors, if one works purely in \(r\)-\(\phi\), then one can correctly count the number of charged tracks and perform vertexing. Unlike the first class of fakes, it is clear when such an ambiguity arises and it can be flagged.

While the first class of fake tracks depends on the detector resolution and the PR algorithm used, and in particular, the algorithm and cuts used to remove fakes, the second class does not (although see comments in following sections). Devising efficient PR algorithms in the context of such a complex and inhomogeneous detector as that proposed by Atlas is non-trivial. The second class depends on the (logical) size of detector wafers. Further, they can be identified quite easily - no sophisticated PR is needed. Both classes depend on event topology. For these reasons, I have studied only the second class of fakes. Since they essentially look like real tracks, it is impossible to remove them and they can be considered to be an **irreducible** component of the observable set of fake tracks.

## 2 General Remarks

This work consists of two separate studies: one for Crossed-Strip detectors, and the second for detectors with a small stereo angle. Nevertheless, several features are in common:

* I have used **my own standalone simulation program**:
* Events are generated with Pythia. In collimated jets, it has been shown1 most of the ambiguities are caused by the tracks within a jet, and therefore the effect of pile-up has not been included. Footnote 1: See “Studies of Pattern Recognition in SiTV”, S.Gadomski, Indet-25 (1993).
* Detectors are represented as cylinders and planes, and there is no Multiple-Scattering.
* The detector planes are tiled in a pseudo-random manner with detectors of approximately the nominal dimensions.
* Track hits are smeared by the nominal detector resolutions.
* For each measurement, of the order of 15,000 \(t\overline{t}\) events have been used, with \(m(top)=160\) GeV.
* The studies have been made using tracks in a cone around the B-jet direction, with a half-angle of about \(10^{o}\).
* Tracks are only considered if they have \(p_{t}>2\) GeV and no more than two hits outside the jet-cone.
* This study is restricted to the **barrel** region: \(45^{o}<\theta<135^{o}\).
* The **Panel Layout** has been used, with double-sided Silicon detectors at \(r=20,30,40,50\) and \(60\) cm. As mentioned above, the Pixels were not used.
* For all these studies, the **Pixels are not used**.
* The \(r\phi\)**resolution** used for the Crossed-Strip detectors was as for the Panel Layout, while \(40\)\(\mu\)m was used for the effective resolution of a Stereo layer.
* instead, tracks have been constructed from hits using the truth information, as described in the subsequent sections.
* No **external information** (TRD, Calorimetry or Muon Chambers) has been considered. In principle, use of the electromagnetic calorimeter might allow a resolution of ambiguities when the real particle tracks are separated by a few centimetres.

Various parameters have been changed for the studies:

**Wafer size**: For example: \(3\times 6\) cm\({}^{2}\), \(6\times 6\) cm\({}^{2}\) and \(6\times 12\) cm\({}^{2}\). (12 cm comes from chaining two \(6\times 6\) cm\({}^{2}\) together.)
**Jet Boost**: Corresponding to the parameter CKIN(3) in Pythia, the top-jets can be given a \(p_{t}\) boost. This creates higher energy and more tightly collimated jets. The default unbiased events have CKIN(3)= 0.

**Stereo Angle**: For example: 17, 50, 100 and 150 mrad.

Strip detectors measure two ordinates: a trivial ordinate corresponding to the position of the detector (radius, in the case of detectors in the Barrel) and a second one corresponding to the fired strip(s). The third ordinate along the strip is constrained by the length of the detector. Therefore, it is required that any fake track constructed from a mixture of projections from different tracks must pass through the detectors on which the hits lie. This is illustrated in figure 1. This is a fairly obvious requirement for double-sided detectors, where the intersection of different fired strips may lead to several space-points, some of which are ambiguous. It is less obvious if the detectors are single-sided and separated by several centimetres.

In this study, what is quoted as the _fake rate_ is the number fake tracks per real particle track. These cannot be removed by any further cuts without reducing the efficiency in a corresponding way. The efficiency to find the real tracks is in all cases 100%. Alternatively, one might wish to remove all ambiguities by making guesses as to which are the correct tracks. This will reduce the efficiency. If the

Figure 1: Fake tracks in Crossed-Strip detectors: Hits from tracks \(T_{1},T_{2},T_{3}\) are shown as \(\bullet\)’s while ghost hits are shown as \(\circ\)’s. Fake tracks \(f_{12}\) and \(f_{21}\) can be constructed from the \(\phi\) projection of \(T_{1}\) with the \(z\) projection of \(T_{2}\) and vice-versa. It is not possible to make a fake track from the \(\phi\) projection of \(T_{1}\) with the \(z\) projection of \(T_{3}\).

fake rate is \(f\) and this is a lot less than 1, then if one makes a guess as to which is the correct combination of projections from pairs of tracks, 50% of the time one will choose the correct combination, and 50% one will be wrong. Therefore, the efficiency will be approximately \((1-\frac{1}{2}f)\).

## 3 Fake Tracks from Crossed-Strip Detectors

By default, five detector planes have been considered. Within the jet-cone, there are a set of tracks, each having a set of hits measured in the \(r\)-\(\phi\) plane and a set in the \(r\)-\(z\) plane. By considering the projections of all the tracks separately, track combinations can be formed as illustrated in table 2.

The correct combinations are those on the diagonal, while those off-diagonal are fakes. Many of the fakes do not correspond to valid combinations because one of the projections is incompatible with the positions of the wafers which measure the other projection. These have been removed. Since the TRD only measures \(r\)-\(\phi\) and the track projections have been successfully found in \(r\)-\(\phi\), nothing would be gained for the removal of fakes by using the TRD.

Because fits in the \(r\)-\(z\) plane to high \(p_{t}\) (\(>2\) GeV) tracks are fairly insensitive to the parameters measured in the \(r\)-\(\phi\) plane, the two projections are effectively decoupled. Therefore, it is impossible to identify incorrect combinations of projections using a \(\chi^{2}\) cut. Only if the \(z\) resolution is better than about 5 \(\mu\)m, is there any significant effect.

The effect of different wafer sizes are shown in table 3. Also rates are given for a scenario where only the three outer detector planes (\(r=40,50,60\) cm) are used. The fake rates are shown as a percentage of the number of true particle tracks, and can in principle exceed 100%.

The numbers correspond to samples of about 50.000 tracks. However, there are significant correlations in the occurrence of fake tracks: for \(n\) close tracks. there are \(n(n-1)\) fakes. Therefore the naive Poisson

\begin{table}
\begin{tabular}{||c c|c c c c||} \hline \hline  & & & \multicolumn{4}{c||}{\(r\)-\(\phi\) proj.} \\  & tracks & 1 & 2 & 3 & 4 &... \\ \hline  & 1 & T & f & f & f &... \\  & 2 & f & T & f & f &... \\ \(r\)-\(z\) & 3 & f & f & T & f &... \\ proj. & 4 & f & f & f & T &... \\  &... &... &... &... &... &... \\ \hline \hline \end{tabular}
\end{table}
Table 2: Tracks formed from combinations of projections: T = true track, f = fake

\begin{table}
\begin{tabular}{||c c|c c||} \hline \hline  & & & \multicolumn{2}{c||}{Fake rate (\%)} \\ W wafer size & Layers & CKIN(3)=0 & CKIN(3)=100 \\ \hline \(3\times 6\) cm\({}^{2}\) & 5 & 14.5 & 18.7 \\ \(6\times 6\) cm\({}^{2}\) & 5 & 29.6 & 38.1 \\ \(6\times 12\) cm\({}^{2}\) & 5 & 47.1 & 58.9 \\ \hline \(3\times 6\) cm\({}^{2}\) & 3 & 21.0 & \\ \(6\times 6\) cm\({}^{2}\) & 3 & 40.3 & \\ \(6\times 12\) cm\(errors for the above numbers significantly underestimate the true errors - I guess they are about 1%.2

Footnote 2: For this reason, the discrepancies between these numbers and numbers derived previously from 500 events are larger than one might have expected.

The \(p_{t}\) distribution of true tracks (open histogram) and fake tracks (shaded histogram) for a \(6\times 12\) cm\({}^{2}\) wafer with CKIN(3)=0 is shown in figure 4. In principle, the fake rate could exceed the true rate. In deed, for high \(p_{t}\), for every true particle track, there is almost one extra fake track. These arise from the combinations of the \(r\)-\(\phi\) projections of genuine high \(p_{t}\) tracks with the \(r\)-\(z\) projections of any nearby tracks.

## 4 Fake Tracks from Stereo Layers

By default, only the three outer detector planes (\(r=40,50,60\) cm) have been considered. Fakes arise from the combination of the \(u\) projection of one track with the \(v\) projection of a different track. However, unlike fake tracks in Crossed-Strips which are perfectly described by helices, fakes in Stereo layers may not be helices. For example: envisage a pair of tracks of equal \(p_{t}\) but of opposite charge emitted at \(\theta=90^{\circ}\) and with the same \(\phi\). If they are sufficiently close, then the fired strips in \(u\)-\(v\) will form diamonds at the different layers, and the fake tracks will be constructed from ghost hits which all have the same \(\phi\) but have displacements from \(\theta=90^{\circ}\) which increase quadratically with radius, see figure 2. In the \(r\)-\(\phi\) plane, the fake tracks appear to have infinite momentum, yet they have a curvature in the \(r\)-\(z\) plane - this is incompatible with a real particle helix. The ability to reject such fakes will depend on the measurements in the \(z\) direction, which for small angle stereo will not be so good. So with Stereo layers, it is possible to apply a \(\chi^{2}\) cut to remove some of the fakes, because the \(u\) and \(v\) projections are _coupled_ by the magnetic field. Further, since the TRD measures tracks in \(r\)-\(\phi\), in principle it should help identify true tracks, and hence reject fakes. In practice, for small stereo angle, if fakes exist the tracks will be so close together that it may be difficult to use the TRD information at all.

Since I treat all hits as measuring \((r,\phi,z)\) rather than \((r,u,v)\), it is not trivial to obtain the candidate fake tracks by simply looking at the tracks and their projections. Instead, a loop is made over the ghost hits and those corresponding to the \(u\) projection of one track and the \(v\) projection of a different track for the same pairs of tracks are collected to form a fake track candidate. Some of these candidates lack hits in some layers because the ghost hits have _fallen off_ the wafers. In Crossed-Strip detectors, where

Figure 2: Fake tracks in Stereo layers: viewed along the direction of the tracks with the hits from three separate layers shown. Hits from tracks \(T_{1}\) and \(T_{2}\) are shown as \(\bullet\)’s while ghost hits are shown as o’s. Fake tracks \(f_{12}\) and \(f_{21}\) are shown.

the strips are parallel to the sides of the wafers, given a pair of tracks, they will potentially form two fake tracks. If one of these is valid (ie. correctly passes through the wafers which have been hit), then so is the other. Conversely, if one is invalid, so is the other. However, with Stereo layers, if an ambiguity arises due to just two tracks, it is possible for one of the fake tracks to _fall off_ the wafers, while the other is still contained, as illustrated in figure 3. In this case, the remaining fake track can be identified and rejected. Since this is not possible in general for more than two tracks, this sort of logic has not been applied.

The fake rate in Stereo layers is reduced because the effective _cell size_ occupied by one hit is reduced from the whole wafer in Crossed-Strip detectors to something like the length of the detector multiplied by the stereo angle. The effect of different stereo angles is shown in table 4. The \(\chi^{2}\) probability for the fits to the true tracks is fairly flat and the pulls are correctly normalised.3 Fake rates are shown for no \(\chi^{2}\) cut, and a cut at 1%.4

Footnote 3: Since by construction the hit errors are correct, the \(\chi^{2}\) probability distribution should be flat and the pulls should have unit width. This is not quite true when I use the RAL AXP’s, where the pulls are 2% too large. If I use CERNVM, things are perfect. This is slightly surprising since the AXP has greater precision.

Footnote 4: The distribution of fake tracks with \(\chi^{2}\) probability falls very rapidly between 0 and 1%, and a cut at less than 1% could achieve similar effects. The fake rate as a function of the probability cut is shown in figure 5. It corresponds to the last entry in table 4. If the fakes were correctly described by helices, the plot would be linear.

For completeness, the \(z\) resolution is given, using the formula

\[\sigma_{z}=\frac{\sigma_{r\phi}}{\cos\frac{\alpha}{2}} \tag{1}\]

where \(\alpha\) is the stereo angle. The choice of stereo angle is usually considered in the context of balancing the fake rate with the \(z\) resolution. However, it is probably easier to assemble a barrel of Stereo detectors if the stereo angle is smaller because of covering overlaps. So if one considers the above rates to be acceptable, then the balance may be between \(z\) resolution and the ease of construction.

One might naively think that when the stereo angle becomes 90\({}^{\circ}\), then the results would be as for the Crossed-Strips. This is not quite true, since firstly two real hits in a wafer with Stereo layers will not necessarily allow ghost hits. Secondly, the \(\chi^{2}\) probability cut will remove some fakes. The comparison can be seen in the 4th line of table 3 and the 5th line of table 4.

Figure 3: Ghost hits in Stereo layers: where one of the hits has _fallen off_ the wafer.

[MISSING_PAGE_FAIL:7]

\(t_{2}\) and \(\lambda_{2}\), then the momentum vectors are

\[\boldsymbol{p_{1,2}}=(\boldsymbol{t_{1,2}},|\boldsymbol{t_{1,2}}|\tan\lambda_{1, 2}) \tag{2}\]

Therefore, ignoring \(m_{1,2}\), the invariant mass is

\[m_{12}^{2}=2(p_{1}p_{2}-\boldsymbol{p_{1}}\cdot\boldsymbol{p_{2}})=2(| \boldsymbol{t_{1}}|\sec\lambda_{1}.|\boldsymbol{t_{1}}|\sec\lambda_{2}- \boldsymbol{t_{1}}\cdot\boldsymbol{t_{2}}-|\boldsymbol{t_{1}}|\tan\lambda_{1}. |\boldsymbol{t_{2}}|\tan\lambda_{2}) \tag{3}\]

If the wrong combinations are made, the momentum vectors are

\[\boldsymbol{p^{\prime}_{1,2}}=(\boldsymbol{t_{1,2}},|\boldsymbol{t_{1,2}}| \tan\lambda_{2,1}) \tag{4}\]

and the invariant mass becomes

\[m_{12}^{2}=2(p^{\prime}_{1}p^{\prime}_{2}-\boldsymbol{p^{\prime}_{1}}\cdot \boldsymbol{p^{\prime}_{2}})=2(|\boldsymbol{t_{1}}|\sec\lambda_{2}.|\boldsymbol {t_{1}}|\sec\lambda_{1}-\boldsymbol{t_{1}}\cdot\boldsymbol{t_{2}}-|\boldsymbol {t_{1}}|\tan\lambda_{2}.|\boldsymbol{t_{2}}|\tan\lambda_{1}) \tag{5}\]

which is the same the expression in equation 3.

## 6 Conclusions

It should be clear from the numbers given in this note that the number of **irreducible** fake tracks one can expect with Stereo layers is a lot less than with simple Crossed-Strips. The combination of the two will reduce the number of fakes to a negligible level. None of this is unexpected.

The real question is: "While Stereo layers are obviously better for PR, is the fake rate in Crossed-Strip detectors sufficiently bad to justify a more complicated technology."

This work has focussed on **irreducible** fakes, and these are a feature of dense jets. Further, it is applicable only when Pixel layers cannot be used, which is more likely (if at all) to be in a high luminosity running period. In this case, one might ask "What physics will one want to do then and how will the presence of fake tracks render this more difficult?"

To come to definite conclusions requires studies which are based on physics.

Figure 4: (a) \(p_{t}\) distribution of true tracks in cone around B-jet (open); true tracks which have ambiguities (black); and fake tracks (grey). (b) The ratio of fake tracks to true tracks as a function of \(p_{t}\). Corresponds to \(6\times 12\) cm\({}^{2}\) wafer with Cross-Strips.

Figure 5: Fraction of fake tracks compared to all true tracks (no cuts) as a function of cut on \(\chi^{2}\) probability. The fraction of true tracks remaining will fall linearly from 1 to 0. Correspond to \(6\times 12\) cm\({}^{2}\) wafer with 150 mrad stereo angle.