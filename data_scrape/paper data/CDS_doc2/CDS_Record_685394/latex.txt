EUROPEAN LABORATORY FOR PARTICLE PHYSICS (CERN)

July 17, 2002

**Determination of the z position**

**of primary interactions in ATLAS**

**prior to track reconstruction**

Nikos Konstantinidis and Hans Drevermann

CERN - EP Division, CH-1211, Geneva 23, Switzerland

**Abstract**

We describe an algorithm that determines the z position of primary interactions in ATLAS using only space points from the precision silicon detectors (Pixel and SCT). No prior track reconstruction is required. The algorithm can be applied to either full events or regions of interest and is suitable for use at the second level ATLAS trigger. We present results and give examples demonstrating its performance at both high and low LHC luminosity.

Introduction

The position of the pp interactions in ATLAS is expected to vary within \(\pm 15\,\mathrm{cm}\) around the centre of the detector (z=0) along the beam (z) direction. A precise knowledge (\(\lesssim 1\,\mathrm{mm}\)) of the z-position (\(\mathrm{z_{V}}\)) of the interesting interaction prior to track reconstruction is of high interest, especially at the trigger level, but also offline, as it can improve performance and reduce execution time for pattern recognition in the tracking detectors of ATLAS. The gain is more significant at high LHC luminosity, when many low-\(\mathrm{p_{T}}\) pp interactions (usually referred to as pile-up or minimum bias interactions) occur in a bunch crossing together with the interaction which leads to the interesting high-\(\mathrm{p_{T}}\) physics.

In this note we describe an algorithm which evaluates \(\mathrm{z_{V}}\) using three-dimensional space points from the Pixel detector and the SCT1. The algorithm is based on the near-linear relationship between z and \(\rho\) of a track's trajectory in a uniform magnetic field, which is parallel to the z (beam) axis.

Footnote 1: Clusters in the Pixel detector provide directly a 3D measurement. In the SCT, 3D space points are calculated by combining axial and stereo clusters from corresponding detector modules.

The note is organised as follows: In Section 2, a brief reminder of the formulae describing a helix in cylindrical coordinates is given. The details of the algorithm are described in Section 3. Two events are used as examples in order to demonstrate the use and performance of the algorithm: one at low luminosity (with a total of 4905 space points) and the other at high luminosity (with a total of 39061 space points), both containing a high-\(\mathrm{p_{T}}\) interaction. To show the power of the algorithm a significant amount of additional "electronics noise" was simulated in the first event, while the second event was chosen with a space point occupancy well above the average for high luminosity events. In Section 4, results are presented demonstrating the suitability of the algorithm for use at the second level ATLAS trigger, by applying it to Regions of Interest (RoI) from single high-\(\mathrm{p_{T}}\) electrons at high luminosity and thin QCD jets, which constitute the main background to electron triggers; this is a typical case where tracking is required at the second level trigger of ATLAS. Finally, Section 5 summarises our main conclusions.

## 2 Helix description in cylindrical coordinates

The trajectory of a charged track inside a uniform magnetic field is a helix, if multiple scattering is ignored. In cylindrical coordinates, with the z axis parallel to the magnetic field, a helix passing through a vertex with coordinates (0, 0, \(\mathrm{z_{V}}\)) can be described by:

\[\rho=G\cdot\mathrm{p_{T}}\cdot\sin(\phi-\phi_{0})\simeq G\cdot\mathrm{p_{T}} \cdot(\phi-\phi_{0})=G^{\prime}\cdot(\phi-\phi_{0}) \tag{1}\]

\[z-\mathrm{z_{V}}=G\cdot\mathrm{p_{z}}\cdot(\phi-\phi_{0}) \tag{2}\]

where \(\mathrm{p_{T}}\) and \(\mathrm{p_{z}}\) are the track's transverse and longitudinal components of momentum, \(G\) a known constant that depends on the magnetic field and \(G^{\prime}=G\cdot\mathrm{p_{T}}\). From these, a third equation can be derived:

\[z-\mathrm{z_{V}}\simeq\frac{\mathrm{p_{z}}}{\mathrm{p_{T}}}\rho=C\cdot\rho \tag{3}\]which is linear to a good approximation. Therefore, if (\(z_{1}\), \(\rho_{1}\)) and (\(z_{2}\), \(\rho_{2}\)) are the coordinates of two points along a track's trajectory (with \(\rho_{1}\neq\rho_{2}\)), \(\rm z_{V}\) can be calculated by simple linear extrapolation using equation (3):

\[\rm z_{V}=\frac{z_{2}\cdot\rho_{1}-z_{1}\cdot\rho_{2}}{\rho_{1}-\rho_{2}}\,. \tag{4}\]

## 3 Algorithm for evaluating \(\rm z_{V}\)

Contrary to all other helix parameters, which are different for different tracks, \(\rm z_{V}\) is common to all tracks originating from a given primary vertex. Therefore, it seems worthwhile, as a first step in pattern recognition, to use information from many tracks in order to evaluate the one common parameter, \(\rm z_{V}\).

The principle of the algorithm is to use equation (4) with pairs of space points (lying in different detector layers), calculate the intercept with the z axis and store it in a one-dimensional histogram (called hereafter the z-histogram). The entries from pairs of space points coming from tracks that originate from the same z position, \(\rm z_{V}\), will peak around \(\rm z_{V}\) in the z-histogram.

If all pairs of space points were to be considered, any peak in the z-histogram would be swamped by combinatorial noise. In addition, at high luminosity, as mentioned previously, there are many pp interactions along the z axis but the only \(\rm z_{V}\) of interest (at least at the trigger level) is that of the high-\(\rm p_{T}\) interaction, i.e. the interaction that gives rise to most of the high-\(\rm p_{T}\) tracks in an event. Such high-\(\rm p_{T}\) tracks bend little in the x-y plane, hence giving space points with almost the same \(\phi\). In order to enhance the contribution from pairs of space points coming from high-\(\rm p_{T}\) tracks and, at the same time, reduce the combinatorial noise, only space points within thin slices of \(\phi\) are paired. Thus, the algorithm proceeds in the following steps:

* Space points are divided into sets per \(\phi\) slice and per layer.
* In each \(\phi\) slice, the intercept with the z axis is calculated using equation (4) for every pair of space points from different layers. If it is within the ranges of the z-histogram an entry is stored in the corresponding bin of the z-histogram. To avoid edge effects and take into account the \(\phi\) measurement uncertainty, space points from a given \(\phi\) slice are also paired with the ones in the two neighbouring \(\phi\) slices.
* \(\rm z_{V}\) is the z position calculated as the weighted average from the three consecutive bins with the maximum number of entries in the z-histogram.

One can estimate the reduction of combinatorial noise that is achieved by dividing the space points into \(\phi\) slices. For \(N_{\rm sp}\) space points, the number of all possible pairs is:

\[N_{\rm pairs}^{\rm max}=N_{\rm sp}\cdot(N_{\rm sp}-1)/2\simeq N_{\rm sp}^{2} /2\,.\]

If the space points are divided into \(M\) equally populated sets (\(\phi\) slices) and only space points within each set are paired, the total number of pairs is:

\[N_{\rm pairs}\simeq M\cdot(N_{\rm sp}/M)^{2}/2\simeq N_{\rm pairs}^{\rm max }/M\]Therefore, a reduction factor of \(M\) is achieved in the combinatorial noise. Correspondingly, a similar reduction is achieved in the overall execution time of the algorithm, since the bulk of it is spent in the combinatorial step, while the arrangement of space points into sets per \(\phi\) (and per layer) as well as the z-histogram scan take, comparatively, negligible time.

The algorithm is conceptually simple and only few parameters need to be adjusted to optimize its performance. These parameters are:

* The width of the \(\phi\) slices: it depends on the \(\rm p_{T}\) of the tracks that are targeted. Thinner \(\phi\) slices are better suited for higher-\(\rm p_{T}\) tracks.
* The bin width of the z-histogram: its optimal value is of the order of the \(\rm z_{V}\) resolution.
* The number of layers to be used. If several high-\(\rm p_{T}\) tracks are present, it is sufficient to restrict the combinatorics to space points in the Pixel detector.

The position of the high-\(\rm p_{T}\) interaction (at \(\rm z_{V}=-1.45\,cm\)) in the low luminosity event is clearly distinguishable from the low combinatorial background in the z-histogram shown in Fig. 1. This is also a demonstration that the algorithm is not sensitive to the noise level.

In contrast, the z-histogram for the high luminosity event with the high-\(\rm p_{T}\) interaction at \(\rm z_{V}=-7.55\,cm\), shown in Fig. 2, has a peak visible at the correct position, but the signal-to-background ratio is rather poor.

Figure 1: _The z-histogram for the low luminosity/high noise/high-\(\rm p_{T}\) event using pairs of space points from the barrel Pixel layers only (2324 space points). The number of \(\phi\) slices was set to 1000._

### Evaluation of \(\mathbf{z_{V}}\) using triplets of space points

In order to improve the signal-to-background ratio in full events at high luminosity, an extension of the above algorithm has been developed. The \(\mathrm{z_{V}}\) calculated from a pair of space points in the Pixel layers, entering the z-histogram, is accepted only if a third space point exists in a layer further out such that the triplet of space points is consistent with equations (1) and (3). The consistency criteria are the following:

\[|\mathrm{z_{v}^{12}-z_{v}^{23}}|<\Delta\mathrm{z_{V}}\]

\[|C_{12}-C_{23}|<\Delta C\]

\[|G^{\prime}_{12}-G^{\prime}_{23}|<\Delta G^{\prime}\]

where \(C_{nm}\), \(G^{\prime}_{nm}\) and \(\mathrm{z_{v}^{nm}}\) are calculated from equations (1) and (3) for two space points \(n\) and \(m\). Essentially, these criteria ensure that the three space points come from the same track. If \(N\) space points in layers further out give a consistent triplet with space points 1 and 2, \(\mathrm{z_{v}^{12}}\) will enter the z-histogram \(N\) times.

The z-histogram for the above high luminosity event using triplets of space points is shown in Fig. 3. The background level is much reduced and the peak at \(\mathrm{z_{V}}=-7.55\,\mathrm{cm}\) is very prominent.

The division of space points in \(\phi\) slices, as before, reduces drasticly the combinatorics. For \(N_{\mathrm{sp}}\) space points, the number of all possible triplets is

\[N_{\mathrm{triplets}}^{\mathrm{max}}=N_{\mathrm{sp}}\cdot(N_{\mathrm{sp}}-1) \cdot(N_{\mathrm{sp}}-2)/6\simeq N_{\mathrm{sp}}^{3}/6\,,\]

Figure 2: _The z-histogram for the high luminosity/high-\(\mathrm{p_{T}}\) event using pairs of space points from the barrel Pixel layers only (13258 space points). The number of \(\phi\) slices was set to 1000._while, after dividing them into \(M\) equally populated sets (\(\phi\) slices) and doing the combinatorics in each set separately the number of triplets is reduced by a factor \(M^{2}\):

\[N_{\rm triplets}\simeq M\cdot(N_{\rm sp}/M)^{3}/6\simeq N_{\rm triplets}^{\rm max }/M^{2}\,.\]

In practice, the space points are divided into \(\phi\) slices of equal width. As the distribution of space points is not uniform in \(\phi\) the different slices do not contain equal number of space points. Thus the actual gain in combinatorics, and hence in execution time, is smaller than \(M^{2}\) (see Table 1).

## 4 Results for the ATLAS second level trigger

As mentioned previously, the present algorithm can be used prior to track reconstruction and may result in significant gains in execution time of tracking algorithms. This is of

\begin{table}
\begin{tabular}{r|r} \hline \hline \(\phi\) slices & Time (sec) \\ \hline
10 & 1400 \\
100 & 16 \\
1000 & 0.24 \\
2000 & 0.11 \\ \hline \hline \end{tabular}
\end{table}
Table 1: _Execution times (in a PIII-400 MHz processor) when dividing the space points into different numbers of \(\phi\) slices, in the high luminosity event._

Figure 3: _The z-histogram for the high luminosity/high-\({}_{\rm PT}\) event using triplets of space points from the barrel Pixel and barrel SCT layers (22767 space points). The number of \(\phi\) slices was set to 1000._

particular interest for the second level trigger of ATLAS, where the average processing time per accepted first level trigger is about 10 msec.

The performance of the baseline version of the algorithm, using pairs of space points, was studied in RoIs containing isolated electrons with \(\rm p_{T}\)= 40 GeV/c (signal) at high luminosity. The size of the RoIs was \(0.2\times 11.5^{\circ}\) in (\(\eta\), \(\phi\)), with a spread of \(\pm 11.2\) cm in z. The average number of space points in these RoIs was 230. The optimal values for the parameters of the algorithm were found to be

* \(\phi\) bin width: \(0.2^{\circ}\)
* z-histogram bin width: \((0.02+0.01\times\eta_{\rm RoI})\) cm, which takes account of the deterioration in z-resolution with increasing \(\eta_{\rm RoI}\)
* All detector layers were included (since the signal RoIs have just a single, high-\(\rm p_{T}\) track).

The efficiency for finding the correct \(\rm z_{V}\) was

\[\epsilon=97.2\pm 0.4\%\,,\]

flat in \(\eta_{\rm RoI}\), with most of the losses being due to hard bremsstrahlung radiation (which reduced significantly the \(\rm p_{T}\) of the tracks) and detector inefficiencies. The resolution achieved on \(\rm z_{V}\) was

\[\sigma=180\pm 5\mu{\rm m}\,.\]

The timing measurements were performed on a PIII-600 MHz processor. The execution time, parametrised as a function of the number of space points, was measured to be

\[t=(35+1.24\cdot N_{\rm sp}+0.0004\cdot N_{\rm sp}^{2})\,\mu{\rm sec}\,,\]

and therefore the average execution time was 340 \(\mu\)sec. In QCD jets, which are the major background for the electron trigger the average number of space points was 250. The execution time follows the above formula. As can be seen in this formula, the quadratic term is strongly suppressed, due to the splitting of the space points in \(\phi\) slices.

## 5 Conclusions

Prior knowledge of the z-position of the interesting pp interaction in LHC events may be of great significance as it may improve the performance and reduce the execution time of tracking algorithms.

We have described an algorithm which evaluates \(\rm z_{V}\) based on pairs or triplets of space points and have given examples demonstrating its performance. We have also applied the algorithm to regions of interest containing high-\(\rm p_{T}\), isolated electrons showing that it is suitable for use at the second level trigger of ATLAS.