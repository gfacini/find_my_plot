**ATLAS Internal Note**

**INDET-NO-109**

**28 june 1995**

**Likelihood approach to pattern recognition**

V. Bryzgalov

_Institute for High Energy Physics,_

_Protvino, Moscow Region, Russia_

BRYZGALOV@ MX.IHEP.SU

BRYZ@VXCERN.CERN.CH

## 1 Introduction

The Hough transform is very popular method for pattern recognition in high energy physics. The idea of Hough transform is that for set of points \((x_{i},y_{i})\), lying on the straight line \(y=a_{0}x+b_{0}\), the relations \(y_{i}=ax_{i}+b\) have to be satisfy. These relations give the set of straight lines in \((a,b)\) coordinate system, crossing at \((a_{0},b_{0})\).

Measurement spaceIn the presence of measurement errors, i.e. if \(a_{i}+b-y_{i}=h_{i}\), where \(h_{i}\) are random variables with a known distribution \(f_{i}(x)\), one can consider the function \(H(\vec{p})=\sum_{i}f_{i}(h_{i}(\vec{p}))\), where \(\vec{p}\) is the vector of parameters, defining the pattern -- set of points, lying close to straight line (in this case \(\vec{p}=(a_{0},b_{0})\)).

The case with errors

The picture on the left shows a set of measurements of two straight lines and some noise points with a errors drawn. The Hough transform function is shown in the right picture. The maxima of this function correspond to searched patterns. One can see, that this function has a lot of local maxima; for example, arbitrary pair of measurements give such maxima.

## 2 Histograming method

The previous picture illustrate the histogramming method. Note, to not miss the point of maxima of the function, the histogram bin-widths have to be chosen small enough for precise measurements. Also the size of histogram and number of the points where function value has to be calculated will large. For example, using popular track model \(\phi_{i}=\phi+c(\rho_{i}/2)\) for TRT, \(\phi_{i}=\eta_{i}\pm t_{i}/\rho_{i}\) (here \(\rho_{i},\eta_{i}\) are the distance and azimuthal angle of center of drift tube, \(t_{i}\) -- distance of drift) to have the step of histogramming close to the accuracy of drift time digitization in TRT (0.03cm) the number of bins in histogram along \(\phi\) must be \(2\pi/(0.03/100.)\approx 2\times 10^{4}\). So, the direct use of histograming method is very expensive even in a two-dimensional case, when pattern is defined by the two parameters.

It should be stressed, that for the most of the detectors of ATLAS the condition of the closeness to helix can't be used in a two-dimensional model without the loss of accuracy even for the the primary vertex tracks.

In case of uniform distribution of measurement errors (for example, for pixels and strips of the SCT) value of function \(H(\vec{p})\) is just the number of measurements, which satisfy the inequalities \(\big{|}h_{i}\big{|}<\epsilon_{i}\), where \(\epsilon_{i}\) - is a constant, depending on the measurement error.

So, in this case Hough transform method recognition is equivalent to the task of search maximal power subset inequalities, having the solution.

It should be stressed, that this approach permits:

* use of arbitrary number of parameters, defining a track;
* use of arbitrary number of inequalities to formulate the closeness of the measurement to the path of particle.

For example, if \((r_{i},\phi_{i},z_{i})\) are coordinates of the center of axial strip SCT with size \((\epsilon_{i},\delta_{i})\), the conditions of crossing it by the helix can be written as:

\[|\phi+cr_{i}/2+d/r_{i}-\phi_{i}|<\epsilon_{i}\qquad\qquad|\!|\!|\!|r_{i}+z-z_{i }|\!|<\delta_{i}\]

Note, that for stereo strips these relations will be slightly complicated: the first inequality will contain all five parameter of helix (\(\phi\), c, d, t, z).

A program for the "solving" inequalities was used last year for the study of the performance of the barrel part ATLAS [1] with the full DICE simulation for different variant of the barrel part of detector: stand-alone TRT, SCT, combined SCT+TRT and for different layouts of the SCT: Panel, stereo strips. Two of our pictures were included in Technical Proposal [2]: 3.33 (p. 91) and 3.40 (p. 97), unfortunately, without reference to us, because our note appeared only in April.

Unfortunately, we were not able to use the full power of the package because of limitation of computer memory, and recognition was provided in \((\rho,\phi)\) and \((\rho,\mathrm{z})\) projections separately.

Taking into account this fact and the necessity to recognize tracks with low \(P_{t}\), which at energy about 1 GeV are badly described by the linear model, the new method was developed.

## 3 Likelihood approach

Well known likelihood method of estimation unknown parameters of distribution of the sample of independent random variables gets the estimation, considering the point of maximum of the likelihood function, i.e. \(\max L(\vec{p})=\prod_{i}f_{i}(\vec{p})\).

Let us consider function

\[Lh_{m}(\vec{p})=\sum_{i_{1}<\ldots<i_{m}}f_{i_{1}}(\vec{p})\times\ldots\times f _{i_{m}}(\vec{p}),\]

where summing is doing through the all possible combinations \(i_{1},..I_{m}\). It is easy to see, that for every \(\vec{p}\) function \(Lh_{m}\) will be small if the number of large \(f_{i}\) is less then \(m\). So, the valuable maxima of \(Lh_{m}\) correspond to patterns with as minimum \(m\) measurements. It means, that this function will indicate the patterns defined as "\(m\) or greater measurements, lying close to helix" (closeness is dependant on measurement errors).

Note, that \(Lh_{1}(\vec{p})\) function is just \(H(\vec{p})\) and likelihood approach can be considered as generalization of Hough transform method of pattern recognition.

[MISSING_PAGE_EMPTY:4]

Figure 1: The choice of region

Figure 2: The tracks selected

Figure 3: The jet tracks resolution

Figure 4: Residuals for whole jet

Figure 5: Residuals for whole jet

Figure 6: The improvement provided

Figure 7: The example with the EHS event

Conclusions

* Method described can be used for any part of ATLAS separately or in arbitrary "combined" mode;
* method can work for arbitrary geometry without the loss of accuracy;
* can be easy adapted for low \(P_{t}\) track;
* in principle, is able to recognize pile-up tracks and events;
* in principle permits the hardware implementation.

Author is in debted to V. Ammosov for the strong stimulation of this investigation, V. Korotkov for the very fruitful cooperation, D. Froidevaux and P. Jenni for support of this work.

## References

* [1] V.Ammosov, V. Bryzgalov, V. Korotkov. Pattern recognition study in the barrel inner tracker of the ATLAS. ATLAS Internal Note, INDET-NO-104.
* [2] ATLAS technical proposal. CERN/LHCC/94-43.