**ATLAS Internal Note**

**CAL-NO-73**

**7 february 1995**

**Study of pileup in the ATLAS electromagnetic calorimeter.**

L. Serin and V. Tisserand

Laboratoire de l'accelerateur Lineaire,

IN2P3-CNRS et Universite Paris-Sud

91405 Orsay Cedex, France.

**Abstract**

Pileup effects in the ATLAS electromagnetic calorimeter are presented at the highest LHC luminosity (\(10^{34}\) cm\({}^{-2}\)s\({}^{-1}\)). A sample of 1250 minimum bias events has been generated with PYTHIA 5.7, and energy deposition over the whole electromagnetic calorimeter coverage has been reconstructed. Calculation has been performed on the baseline option of the technical proposal : an hybrid geometry with LAr in the barrel part. Considering standard 3\(\times\)7 clusters (\(\eta\times\phi\)), an analysis including shaping shows that a pileup of \(\simeq\) 315 MeV / \(sin(\theta)\) in the barrel part and \(\simeq\) 290 MeV / \(sin(\theta)\) in the endcap part is expected. The intrinsic widening effect on invariant mass in the \(\rm H^{\parallel}\rightarrow\gamma\gamma\) and \(\rm H^{\parallel}\to ZZ^{*}\to 4\ e^{\pm}\) benchmarks channels, is respectively 490 and 840 MeV, for \(\rm m_{H^{\parallel}}=100\) and 130 GeV.

## 1 Introduction

Studies of pileup have already been done [2], [3], but many parameters have been revisited and fixed for the technical proposal [1]. We have now a full simulation of the ATLAS detector. The design of the electromagnetic calorimeter, including preshower, has undergone considerable optimization, based on test beam results and detailed simulations. The physics generator has been improved, using last data from Tevatron. The shaping function has a peaking time smaller than the one used in the RD3 test beam and has been optimized for LHC.

We have generated 1250 minimum bias events over all the electromagnetic calorimeter rapidity coverage. The generation was achieved using the generator PYTHIA version 5.7 [4], in the ATLAS software package environment DICE, with the hybrid geometry in the barrel part, parallele plates in the endcap part and liquid Argon [5], [6], [7]. The reconstruction was done using the ATRECON program and calibrations which were optimized for energy measurement with photons of \(E_{t}=40\) GeV. The values of the pileup noise energy deposition are presented, as a function of rapidity and for different sizes of clusters including the standard \(3\times 7\) cells in \(\eta\times\phi\) ( \(0.075\times 0.172\) ) [1]. Starting from the same sample of events, two different methods are presented in this note : the first one considers only an equivalent number of minimum bias events superposed in one bunch crossing, as pileup contribution, the second takes into account the signal distribution after shaping. Effects on the 2 benchmark physics processes \(\mathrm{H}^{0}\rightarrow\gamma\gamma\) and \(\mathrm{H}^{0}\to 4\ e^{\pm}\) are also presented, for invariant masses of respectively 100 and 130 GeV.

## 2 Event sample and energy reconstruction

### Event sample and kinematic of the minimum biased event

Minimum bias events have been generated with the batch system farms BASTA and CSF. Data are available at CERN on tapes SE0059, SE0060, SE0061, SE0062, LN1445 and LN1446 for tapes produced with BASTA and I06320 with CSF.

Using PYTHIA 5.7 with datacards presented in table 1[9] and GEANT 3.21, 1250 single minimum bias events of p-p interactions at \(\sqrt{s}=14\) TeV were produced. The full Atlas detector up to the end of the electromagnetic calorimeter has been simulated, keeping the information about the energy deposition in all the channels of the electromagnetic calorimeter. In table 2, the kinematics of secondary particles is presented for

\begin{table}
\begin{tabular}{||c|c||} \hline \(MSEL=1\) & jet production \\  & \(2\rightarrow\) 2 processes \\ \hline \(MSTP(2)=2\) & \(2^{n\,d}\) order running \(\alpha_{s}\) \\ \hline \(MSTP(33)=3\) & K-factor \\ \hline \(MSTP(81)=1\) & multiple interactions with \\ \(MSTP(82)=4\) & varying impact point \\ \hline \(MSTJ(22)=2\) & particle decays only if \(\tau\geq 10\) mm \\ \hline \end{tabular}
\end{table}
Table 1: _datacards used to generate minimum bias events._single minimum bias events produced in the range \(|\eta|\)\(\leq\) 2.5. The mean transverse energy \(\langle E_{t}\rangle\) and the mean multiplicities (neutral and charged particles) quoted in table 2 were obtained with the GENZ routines. Figure 1 shows the mean multiplicity distribution both for neutral and charged particles.

### Reconstruction and energy calibration

For the reconstruction, the ATRECON program was used. Calibration factors, determined by minimizing the energy resolution of photons of \(E_{t}\) = 40 GeV, were incorporated [8]. It was also checked with single electrons of \(E_{t}\) = 5 GeV, that the energy is well reconstructed with those calibration factors [5].

In the barrel part we affect a weight on the separated presampler, a second on the integrated preshower and a global weight in order to recover the generated energy. In the endcap region we just use weights of ATRECON. As lateral leakage occurs in the endcap for electromagnetic showers, we correct this leakage according to :

\[\mbox{Ecorr.}\ =\ \mbox{Erec.}\ /(1.114\ -.1086\times|\eta|) \tag{1}\]

The quality of the reconstruction can be checked in figure 2. The deep at \(\eta\)\(\sim\) 1.5 corresponds to the transition region between barrel and endcap. The plot was obtained with the photons of the decay H\({}^{0}\)\(\rightarrow\)\(\gamma\gamma\) for m\({}_{H^{0}}\) =100 GeV, and the energy reconstruction was done in clusters \(3\times 7\) cells (\(\eta\times\phi\)), which was found to be a compromise between shower containment and noise. We will discuss about the method we used to evaluate pileup noise in section 4, but as ATRECON offers the opportunity to read any cell of the calorimeter, we decided to reconstruct and to store, for each minimum bias event, all the clusters \(3\times 7\) and \(3\times 5\) (\(\eta\times\phi\)) in the range \(|\eta|\leq 3.075\), for future analysis (the granularity of the cells is \(\Delta\eta\) = 0.025 and \(\Delta\phi\) = 0.0245 (= 2\(\pi\) / 256)).

\begin{table}
\begin{tabular}{||c||c|c||} \hline  & \(\Delta\)N/\(\Delta\eta\) & \(\langle E_{t}\rangle\) \\ \hline \hline neutrals & 7.8 & 280 MeV \\  & (4.2) & (445) \\ \hline \multirow{2}{*}{chargeds} & 6.1 & 470 MeV \\  & (5.3) & (525) \\ \hline \end{tabular}
\end{table}
Table 2: _multiplicity of secondary particles and mean transverse energy deposited in the electromagnetic calorimeter by those particles (between parenthesis same numbers after a cut requiring \(P_{t}\ \geq\ 150\) MeV at the production of the particle)._Figure 2: ratio of the reconstructed energy to the generated energy ( left : before correction in the endcap, right : after).

Figure 1: multiplicity of secondary particles as a function of rapidity. on the left : neutrals, on the right : chargeds.

[MISSING_PAGE_EMPTY:5]

\[\frac{I_{pileup}}{T_{\varepsilon}}=2.18 \tag{9}\]

This result means that the fluctuation induced by pileup is \(\sim\)1.5 times the one which would be obtained by an ideal detector (very fast) sensitive to only one bunch crossing.

The proper way to take pileup into account is to sum during 550 ns and every 25 ns the energy due to \(N\) minimum bias events, with a weight given by the black dots of figure 3. These weights are given in table 3. An other way to calculate the total pileup contribution is to add an equivalent number of minimum bias events in the same bunch crossing, this number follows a Poisson distribution with a mean value of : \(18\times 2.18\ \simeq 39\).

Figure 3: _drift current versus time corresponding to the input signal (a), and response of the bipolar sharper\(t_{p}^{5\to 100\%}(\Delta)=\) 40 ns (b). The black dots indicate the beam crossings._

\begin{table}
\begin{tabular}{||c|c||} \hline time (ns) & weight of the signal \\ \hline \hline -50 &.005 \\ \hline -25 &.473 \\ \hline
0 & 1. \\ \hline
25 &.687 \\ \hline
50 &.254 \\ \hline
75 & -.006 \\ \hline
1 25 & -.1 22 \\ \hline
1 50 & -.1 66 \\ \hline
1 75 & -.1 81 \\ \hline
200 & -.1 86 \\ \hline
225 \(\rightarrow\) 375 & -.1 88 \\ \hline
4 00 & -.1 80 \\ \hline
4 25 & -.1 26 \\ \hline
4 50 & -.065 \\ \hline
4 75 & -.028 \\ \hline
500 & -.010 \\ \hline
525 & -.003 \\ \hline \end{tabular}
\end{table}
Table 3: _weights as a function of time for crossings, where time zero corresponds to the bunch crossing where signal is maximum._Pileup effects with and without shaping

The estimates of pileup effects are now reviewed. First we present an estimation of pileup with an equivalent number of minimum bias events superposed in the same crossing, then with the appropriate method that takes shaping into account.

### Pileup with an equivalent number of minimum bias event

At a given position of a cluster in \(\eta\) and \(\phi\), the 1250 minimum bias events are divided in bunch crossings. Each bunch contains \(N\) minimum bias events (each time \(N\) is choosen according to a Poisson distribution with a given mean value). The mean value of energy deposition, \(\overline{E_{i}}\), and its RMS, \(\sigma(E_{i})\) is then computed over all these bunch crossings. The same procedure is repeated for all possible clusters in \(\phi\) at the same position in \(\eta\). Finally we define as \(\langle E\rangle\) and \(\sigma(E)\) the average over each cluster in \(\phi\) of values \(\overline{E_{i}}\) and \(\sigma(E_{i})\). This procedure, used to avoid correlations, is repeated on all others positions of clusters in \(\eta\).

Figures 4 and 5 show the distributions of the mean value of energy deposition, \(\langle E\rangle\), and its RMS, \(\sigma(E)\), as a function of rapidity, for \(N\)= 1, 18 or 39. Where \(\sigma(E)\) gives the pileup contribution to the total resolution on energy. As expected \(\langle E\rangle\) is proportional to \(N\), and \(\sigma(E)\) is in first approximation proportional to \(\sqrt{N}\) (see also section 4.2.1). The same distributions with the equivalent transverse energy are presented in figure 6 and 7. \(\langle E_{t}\rangle\) is almost flat and typically 310 MeV (220 MeV) in a cluster \(3\times 7\) (\(3\times 5\)) for \(N\)= 39. As already mentionned, the deep at 1.5 corresponds to the transition region between barrel and endcap. The distribution of \(\sigma(E_{t})\) is not flat and shows a decrease of about 20 % between \(\eta\)= 0 and 3 (310 MeV at \(\eta\thicksim 0\) and 240 at \(\eta\thicksim 3\) in \(3\times 7\) clusters). We have investigated the effect of the magnetic field by simulating and studying a sample of 300 minimum bias events with \(\vec{B}\) switched off, but no difference was observed. At particle level this distribution is flat, so one possible explanation could be the following : the calibration factors determined for \(\gamma\) of \(E_{t}\)= 40 GeV, and tested to be reasonably adapted to energy measurement for electrons of \(E_{t}\)= 5 GeV, are not suited for very low \(P_{t}\) particles. Anyway, we want to estimate pileup effects in the same conditions where we measure energy of electrons or photons of higher \(P_{t}\).

Pileup with an equivalent number of minimum bias events superposed in the same bunch crossing has also been estimated using a method that will be described in section 4.2.1 (results are given in this section).

Figure 4: \(\langle E\rangle\) _versus \(\eta,\) for 3 Poisson distributions with mean values \(N\)= 1 (black dots), 18 (white squares) and 39 (stars). Left : for clusters \(3\times 7\), right : \(3\times 5\)._

Figure 5: \(\sigma(E)\) _versus \(\eta\), for 3 Poisson distributions with mean values \(N\)= 1 (black dots), 18 (white squares) and 39 (stars). Left : for clusters \(3\times 7\), right : \(3\times 5\)._

Figure 6: \(\langle E_{t}\rangle\) _versus \(\eta\), for 3 Poisson distributions with mean values N= 1 (black dots), 18 (white squares) and 39 (stars). Left : for clusters \(3\times 7\), right : \(3\times 5\)._

Figure 7: \(\sigma(E_{t})\) _versus \(\eta\), for 3 Poisson distributions with mean values N= 1 (black dots), 18 (white squares) and 39 (stars). Left : for clusters \(3\times 7\), right : \(3\times 5\)._

Figure 8: _distribution of transverse energy with an average of 39 minimum bias events in the same bunch crossing (according to Poisson distribution), for \(|\eta|\leq.9\). Left : for \(3\times 7\), right : \(3\times 5\)._

Figure 9: _distribution of transverse energy with an average of 39 minimum bias events in the same bunch crossing (according to Poisson distribution), for \(.9\ \leq|\eta|\leq 1.4\). Left : for \(3\times 7\), right : \(3\times 5\)._

\begin{table}
\begin{tabular}{||c|c|c|c|} \hline cluster type & \(|\eta|\leq.9\) & \(.9\leq|\eta|\leq 1.4\) & \(1.6\leq|\eta|\leq 2.8\) \\ \hline \hline \(3\times 7\) & 327 & 318 & 271 \\ \hline \(3\times 5\) & 261 & 240 & 212 \\ \hline \end{tabular}
\end{table}
Table 4: _pileup noise with an equivalent number of minimum bias events (N = 39), expressed as MeV / \(sin(\theta)\)._

Figure 10: _distribution of transverse energy with an average of 39 minimum bias events in the same bunch crossing (according to Poisson distribution), for \(1.6\ \leq|\eta|\leq 2.8\). Left : for clusters \(3\times 7\), right : \(3\times 5\)._

[MISSING_PAGE_FAIL:13]

Figure 11: _distribution of transverse energy with shaping for \(|\eta|\leq.9\). Left : for clusters \(3\times 7\), right : \(3\times 5\)._

Figure 12: _distribution of transverse energy with shaping for \(.9\leq|\eta|\leq 1.4\). Left : for clusters \(3\times 7\), right : \(3\times 5\)._

#### 4.2.2 Pileup as a function of area

The dependence of pileup as a function of the area of \((\Delta\eta\times\Delta\phi)\) has been investigated using shaping in the 3 previous regions and parametrized as \(a+b(\Delta\eta\times\Delta\phi)^{\varepsilon}\). The resulting fits are given in figures 14, 15 and 16 as function of \((\Delta\eta\times\Delta\phi)\) in naturals units. These plots were obtained for the 2 \(\Delta\eta\) sizes : 3 and 9 cells (in the unit \(\Delta\eta=0.025\)), and for \(\Delta\phi\), the sizes : 5, 7, 10, 14, 35, 49, 55, 77, 70, 98, 100 and 140 cells (in the unit \(\Delta\phi=2\pi\) / 256). In the figures, the 2 lower \((\Delta\eta\times\Delta\phi)\) sizes correspond to \(3\times 5\) and to \(3\times 7\) clusters. The results of the fits are given by the following equations (given in unit MeV \(/\ sin(\theta)\)):

\[\mbox{if}\ \ |\eta|\leq.9 (1\,2\!\!1\,\pm 1\,0)+(6133\pm 78)\times(\Delta\eta\times\Delta \phi)^{(.76\pm.01)} \tag{11}\] \[\mbox{if}\ \.9 \leq|\eta|\leq 1.4 (1\,06\pm 1\,0)+(6133\pm 76)\times(\Delta\eta\times\Delta\phi)^{(.79 \pm.01)}\] (12) \[\mbox{if}\ \ 1.6 \leq|\eta|\leq 2.8 (79\pm 7)+(5995\pm 76)\times(\Delta\eta\times\Delta\phi)^{(.80\pm.01)} \tag{10}\]

As expected the pileup does not scales as \(\sqrt{\Delta\eta\times\Delta\phi}\), as one could naively thinks. This is due to the existence of lateral correlations in minimum bias events. Furthermore this correlation seems to be more important at higher rapidity. Finally it can be checked that these results are in really good agreement with the one obtained in ref. [10].

Figure 14: _fit of pileup noise, in transverse energy units, as a \(+\)\(b(\Delta\eta\times\Delta\phi)^{\circ}\), for \(|\eta|\)\(\leq\).9._

Figure 16: _fit of pileup noise, in transverse energy units, as \(a+b(\Delta\eta\times\Delta\phi)^{\circ}\), for \(1.6\ \leq|\eta|\leq 2.8\)._

Effects on the benchmark physics processes

In order to study the contribution of pileup on physics channels, we have added minimum bias events to particle decay products of \(\mathrm{H^{0}}\) in the electromagnetic calorimeter, for the two benchmark physics processes \(\mathrm{H^{0}}\to\gamma\gamma\) and \(\mathrm{H^{0}}\to ZZ^{*}\to 4~{}e^{\pm}\), for invariant masses of respectively 100 and 130 GeV. The information on the energy of \(e^{\pm}\) and \(\gamma\) were taken at particle level and the usual acceptance cuts where applied 2. We have also asked that no particle is in the transition regions between barrel and endcap (\(1.42~{}\leq|\eta|\leq~{}1.57\)).

Footnote 2: For \(\mathrm{H^{0}}\to 4~{}e^{\pm}\), it is required that all the \(e^{\pm}\) are in \(|\eta|\leq 2.5\), one pair has an invariant mass of \(m_{Z^{0}}\pm 6~{}\mathrm{GeV}\), the other as an invariant mass \(>20~{}\mathrm{GeV}\), \(2~{}e^{\pm}\) have \(P_{!}~{}>20~{}\mathrm{GeV}\) and the 2 other \(P_{!}~{}>7~{}\mathrm{GeV}\). For \(\mathrm{H^{0}}\to\gamma\gamma\), it is required that the 2 \(\gamma\) are in \(|\eta|\leq 2.5\), one \(\gamma\) has \(P_{!}~{}>40~{}\mathrm{GeV}\) and the other has \(P_{!}~{}>25~{}\mathrm{GeV}\), and \(P_{!}^{1}~{}/~{}(P_{!}^{1}+P_{!}^{2})~{}<~{}0.7\).

We have applied the methods of section 4.2.1 to add pileup on the energy of \(e^{\pm}\) and \(\gamma\). For this we have used the position given by the kinematics of an interesting particle.

There are \(\simeq 3000\) clusters for a \(\mathrm{st\,and}\,\mathrm{d}3\times 7\) cluster size over all the electromagnetic calorimeter (\(\simeq 4000\) for the \(3\times 5\) cluster size). We assume an uniform angular distribution of \(e^{\pm}\) in the channel \(\mathrm{H^{0}}\to 4~{}e^{\pm}\) and apply the method including shaping, which requires the highest quantity of statistics. In that case, it can be calculated that a cluster \(3\times 7\) is used approximatively 3 times (2 times for \(3\times 5\)), with 748 events of \(\mathrm{H^{0}}\to 4~{}e^{\pm}\), after cuts and with our sample of 1250 minimum bias events.

The effects of pileup on the resolution of the invariant masses of the 2 channels are presented in table 6 and 7, for the 2 types of clusters sizes and for the 2 methods. As expected, for the method that just take into account an equivalent number of minimum bias events, a systematic shift on the mean values of invariant masses is observed (those values are roughly given in tables). So this method should be not included in studies of physics processes. In case of clusters \(3\times 7\) those numbers can be cross-checked in figures 17 and 18.

\begin{table}
\begin{tabular}{||c|c|c|c||} \hline  & RMS shaping & shift no shap. & RMS no shap. \\ \hline \hline all & 489 & 600 & 467 \\ acceptance & (380) & (4 00) & (375) \\ \hline barrel & 481 & 600 & 446 \\ part & (379) & (4 00) & (372) \\ \hline endcap & 499 & 600 & 481 \\ part & (385) & (4 00) & (377) \\ \hline \end{tabular}
\end{table}
Table 6: _pileup effects on \(H^{0}\to\gamma\gamma\) invariant mass, in standard \(3\times 7\) clusters (respectively in parenthesis \(3\times 5\)) and for the 2 methods. Barrel part means no \(\gamma\) in the endcap. Numbers are given in MeV._

\begin{table}
\begin{tabular}{||c|c|c|c||} \hline  & RMS shaping & shift no shap. & RMS no shap. \\ \hline \hline all & 840 & 1400 & 844 \\ acceptance & (626) & (1 000) & (64 0) \\ \hline barrel & 791 & 1300 & 81 7 \\ part & (579) & (900) & (601 ) \\ \hline endcap & 877 & 1 500 & 861 \\ part & (676) & (1 100) & (668) \\ \hline \end{tabular}
\end{table}
Table 7: _pileup effects on \(H^{0}\to 4\) e\({}^{\pm}\) invariant mass, in standard \(3\times 7\) clusters (respectively in parenthesis \(3\times 5\)) and for the 2 methods. Barrel part means no e\({}^{\pm}\) in the endcap. Numbers are given in MeV._Figure 17: pileup effects on \(H^{0}\to\gamma\gamma\) invariant mass, in standard \(3\times 7\) clusters for the 2 methods, left : with shaping, right : with an equivalent number of minimum bias events.

Figure 18: pileup effects on \(H^{0}\to 4\)\(e^{\pm}\) invariant mass, in standard \(3\times 7\) clusters for the 2 methods, left : with shaping, right : with an equivalent number of minimum bias events.

Conclusion

Using a full simulation of the ATLAS electromagnetic calorimeter and the latest version of PYTHIA (5.7), 1250 minimum bias events have been generated and reconstructed with the baseline option of the technical proposal. Shaping function adapted to LHC conditions has also been considered. Calculations on pileup effect either taking into account the shaping signal distribution or an equivalent number of minimum bias events (39) have been performed.

Though including shaping is the way to take pileup into account, especially in studies of physics processes, the intrinsic results are compatible for both methods. For the standard \(3\times 7\) clusters size (\(\eta\times\phi\)) a pileup of \(\simeq 315\) MeV / \(sin(\theta)\) in the barrel part and \(\simeq 290\) MeV / \(sin(\theta)\) in the endcap part is expected. Finally the intrinsic widening effect on invariant mass in the \(\mathrm{H}^{0}\to\gamma\gamma\) and \(\mathrm{H}^{0}\to ZZ^{*}\to 4\)\(e^{\pm}\,\mathrm{ben}\,\mathrm{ch}\mathrm{m}\mathrm{a}\mathrm{r}\mathrm{a}\mathrm{r}\)s channels, is respectively for \(\mathrm{m}_{H^{0}}=100\) and \(130\) GeV, \(489\) and \(840\) MeV.

## References

* [1] ATLAS Technical Proposal (CERN/LHCC/94-43 December 1994).
* [2] Y.Zolnierowski, ATLAS Internal Note C AL-NO-14 (1992).
* [3] P.Battiglia and L.Perini, ATLAS Internal Note CAL-NO-18 (1993).
* [4] T. Sjostrand CERN-TH. 7112/93.
* [5] F.Gianotti et al., ATLAS Internal Note CAL-NO-70 (1994).
* [6] F.Gianotti et al., ATLAS Internal Note CAL-NO-71 (1994).
* [7] F.Gianotti et al., ATLAS Internal Note CAL-NO-72 (1994).
* [8] M.Nessi, G.Parrour and P.Petroff, ATLAS Internal note SOFT-NO-16 (1995).
* [9] I. Wingerter-Seez, private communication.
* [10] W.E. Cleland and E.G. Stern, Nucl. Instr. and Meth., A338 (1994) 467.
* [11] C. de la Taille, ATLAS Internal Note LARG-NO-10 (1995).