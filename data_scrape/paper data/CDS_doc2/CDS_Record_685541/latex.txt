A GEANT4 simulation of not irradiated and irradiated pixel detectors

T. Lari

_Universita di Milano - Dipartimento di Fisica and Istituto Nazionale di Fisica Nucleare - Sezione di Milano, Via Celoria 16, I-20133 Milan, Italy_

_ATLAS Pixel Collaboration_

**Abstract**

This note presents a numerical simulation of the response of irradiated and not irradiated silicon pixel detectors to ionizing particles.

The simulation was developed as a stand-alone Geant4 application with the goal of understanding the response of a detector using a detailed description of the charge drift and signal induction processes. The radiation damage is simulated through the modifications it induces on the thickness of the active region, the electric field strength and distribution inside the sensor, and the charge trapping probability.

This approach is different from those used in the simulations developed in the more general framework of the ATLAS detector simulation, which is subjected to severe CPU and memory usage constraints and can not afford the detailed description of charge drift and signal induction processes described here.

The simulation strategy is described in detail. The simulated detector response before and after radiation damage is presented and it is compared with data taken at the test beam.

## 1 Introduction

The simulation presented in this note describes the response of silicon pixel sensors to ionizing particles. The output signal is computed from the geometry of the detector, the properties of charge drift in silicon, and the laboratory characterization of the readout electronics. The number of free parameters is reduced to a minimum, and the accuracy of the description has been given the priority over CPU and memory consumption issues.

This approach makes the simulation suitable to extract from test beam data microscopic sensor properties like the depleted depth and the charge collection efficiency in irradiated silicon sensors. It can also be useful in developing parameterizations of the detector response to be used in the code developed in the framework of the ATLAS detector simulation, which is subjected to severe CPU and memory usage constraints and can not afford the detailed description of charge drift and signal induction processes which is described in this note.

The simulation has been developed to describe test-beam data taken with ATLAS Pixel detectors, but it can be easily adapted to simulate laboratory measurements with radioactive sources and laser pulses, and measurements taken with other detector geometries.

## 2 The simulation strategy

### Overview

The interactions of the particle with the detector material are simulated using the Geant4 package [1], version 4.5.0. This step of the simulation produces a file with the list of the energy deposits of the particle inside the silicon sensor (Geant4 hits). For each hit, the following information is saved: the beginning and the end of the segment containing the hit charge, the energy lost by the particle in the segment, and the name of the particle.

In a second step the hits file is read and the charge of each hit is divided in small units which are distributed along the Geant4 segment. Each unit is separately drifted inside the sensor until it reaches the electrodes or it is captured by a trapping center, as described in detail in section 2.2. The final positions of electrons and holes are stored in a vector.

The charge induced on the pixels is then computed using the Ramo potential (section 2.3). After processing all the Geant4 hits of the event, the electronics effects (threshold, noise, cross-talk) are added (section 2.4).

The output of the simulation is a file containing the list of the pixels with a signal above the electronics threshold, their charge and the true position of the particle, defined as the average position of the Geant4 hits due to the primary particle.

### Charge drift in silicon

The drift direction \(\vec{n}\) is normal to the sensor surface for planar silicon detectors in absence of a magnetic field. The possibility of setting a drift angle between \(\vec{n}\) and the electric field \(\vec{E}\) allows to simulate data taken with a magnetic field [2].

Charge trapping inside irradiated silicon is simulated introducing the lifetimes \(\tau_{e}\) and \(\tau_{h}\) for electrons and holes respectively. After each drift step the charge has a probability \(1-\exp(t/\tau)\) to be captured by a trapping center. The drift time is \(l/\mu E\) where \(l\) is the drift step length, \(\mu(E,T)\) the drift mobility and \(E\) the electric field. The mobility depends on the electric field and temperature; the parameterizations reported in [3] has been used.

Diffusion is simulated by a lateral shift after each drift step. The shift is extracted from a gaussian distribution with an r.m.s.

\[\sigma=\sqrt{2Dt}\]

where \(D\) is the diffusivity and \(t\) the drift time. The diffusivity is computed with the Einstein relation \(D=\mu(E=0,T)kT/e\). The diffusivity has only a weak dependence on the electric field strength [4] which has been neglected. The diffusion r.m.s. as a function of the charge initial depth in the sensor is shown in Fig. 1 for a not irradiated detector operated at the standard bias voltage of 150 V.

In not irradiated sensors the electric field profile has a linear dependence on the distance \(z\) from the \(p-n\) junction:

\[E=(V+V_{fd})/d-2V_{fd}\cdot z/d^{2} \tag{1}\]

where \(d\) is the thickness of the sensor, \(V\) is the bias voltage and \(V_{fd}\) is the full depletion voltage (\(V>V_{fd}\) is assumed).

The ATLAS Pixel sensors [5] use \(n+/n\) implants, so that before irradiation the \(p-n\) junction is located at the backside and the electric field is minimum at the pixel plane. After heavy radiation exposure the spatial charge of the substrate changes sign and the \(p-n\) junction moves to the pixel plane; equation 1 still holds with \(V=V_{fd}\) and \(d\) equal to the depleted region thickness.

Figure 1: Charge diffusion r.m.s. as a function of the initial distance from the pixel electrodes, for a bias voltage of 150 V and two different values of the full depletion voltage (determining the electric field distribution inside the sensor).

There are indications that in heavily irradiated silicon the spatial charge concentration is not uniform. Current shape measurements point to a model with a double junction [6] with a local maximum of the electric field at both sensor sides and a minimum in the middle. The simulation allows to choose different models for the \(z\) profile of the field.

### Signal formation

The current induced by a moving charge on a pixel electrode is given by [7]

\[i(t)=q\vec{v}_{d}(t)\cdot\vec{\nabla}(V/V_{0}) \tag{2}\]

where \(v_{d}\) is the drift velocity and V is a fictitious potential (Ramo potential) obtained applying \(V_{0}=1\) V on the electrode under investigation and 0 V on any other electrode. This potential is shown in Fig. 2 as a function of depth and lateral distance from the pixel center (along a direction parallel to the short pixel side). The potential is strong in a relatively small region near the pixel electrode, so that most of the signal is generated by charges moving in this region.

The drift time in silicon is of the order of a few ns. The simulation assumes

Figure 2: Ramo potential for a pixel detector with 50 \(\mu\)m \(\times\) 400 \(\mu\)m pitch and 250 \(\mu\)m thickness. The Ramo potential is plotted in the \(xz\) plane, where \(z\) is the depth coordinate and \(x\) is the coordinate along the short pixel dimension. The pixel center at the origin of the coordinates.

that the response time of the electronics is larger than that, so that the detector is sensitive to the integral of the current, which is

\[Q=e(V_{h}-V_{e})/V_{0} \tag{3}\]

where \(e\) is the positron charge and \(V_{e}\) and \(V_{h}\) are the Ramo potentials computed at the final positions of the electron and the hole respectively.

When all the charges are collected by the electrodes \(V_{h}=0\) while \(V_{e}=V_{0}\) if the electron is collected by the pixel for which the signal is computed, \(V_{e}=0\) otherwise. Hence the signal on a pixel is simply the charge of the electrons collected by the pixel.

In irradiated silicon the charges can be trapped before reaching the electrodes, and thus Eq. 3 must be used to determine the signal induced on the pixels.

In the simulation the Ramo potential is computed during initialization by solving the Laplace equation (\(\nabla^{2}V=0\)) in three dimensions with the appropriate boundary conditions. The signal induced on the pixels is then computed using Eq. 3 with a loop on the final positions of the tracked charges.

### Electronics simulation

After tracking all the charges released by a particle in the sensor and computing the signal induced on the pixels, the front-end electronics effects are simulated. A gaussian noise is added to the charge. Cross talk between the pixels which share a long (400 \(\mu\)m) edge is applied:

\[Q_{i,j}=\epsilon(q_{i+1,j}+q_{i-1,j})+(1-2\epsilon)q_{i,j} \tag{4}\]

where \(q\) and \(Q\) are the charges prior and after cross-talk simulation, \(i\) and \(j\) are the row and column indexes and \(\epsilon\) is the cross-talk fraction. This is the dominant cross-talk contribution in ATLAS because of the 8:1 aspect ratio of the pixels.

The discriminator threshold is applied next; the threshold is extracted from a gaussian distribution to simulate threshold dispersion. Noise, threshold, threshold dispersion and cross talk are input parameters for the simulation which are taken from the front-end electronics measurements.

The list of the pixels above threshold and their charge after cross-talk and noise simulation are written on the output file. In ATLAS pixels the charge is measured using the Time Over Threshold (TOT) information [8]. The TOT is related to the charge with a calibration performed separately for each front-end electronics pixel cell with an accuracy of 10%. No attempt to simulate the charge-TOT conversion has been made yet, so the charge resolution in the simulation is expected to be better than in the data.

[MISSING_PAGE_FAIL:6]

small area with a width \(\Delta\) of about 10 \(\mu\)m micrometers, determined by diffusion. The fraction of two-pixel clusters is of the order of \(\Delta/50\)\(\mu\)m. If a threshold is changed by \(\delta t\), the fraction of two-pixel clusters changes approximatively by \(\delta t/Q\cdot\Delta/50\)\(\mu\)m, where Q is the total charge released by the particle. With \(\delta t/Q\) of the order of 0.01 and \(\Delta/50\)\(\mu\)m of the order of 0.2 this is a very small change (of the order of 0.2%). A variation of the thickness results in a cluster size change of \(\delta d/d\cdot\Delta/50\mu\)m where \(d\) is the thickness. This is again of the order of 0.2%. Thus the cluster size at normal incidence is quite insensitive to threshold and thickness variations.

At 30\({}^{0}\) incidence angle, in contrast, the charge is collected over a width equal to the projection of the track on the pixel plane. The same formulas holds with

Figure 3: Average cluster size for a not irradiated detector at normal incidence (left) and 30\({}^{0}\) incidence angle (right).

\(\Delta\simeq 150\)\(\mu\)m. Hence the cluster size is much more sensitive to the thickness of the sensor active region and the threshold.

In Fig. 4 the distributions of the charge collected by one pixel are reported. The experimental charge at normal incidence has been rescaled by the factor 0.93 as reported in the legend. This value was within the 10 % accuracy of charge calibrations and was chosen so that the position of the peak is the same in the simulation and the data. The same rescaling was applied to the data taken at 30\({}^{0}\) incidence angle, since they were taken with the same detector.

The higher peak at normal incidence corresponds to the situation when most of the charge released by the particle is collected by a single pixel. The lower peak is populated by the events in which the charge is shared by two pixels.

Figure 4: Pixel charge for a not irradiated detector at normal incidence (left) and 30\({}^{0}\) incidence angle (right).

At \(30^{0}\) incidence angle the charge is always shared between several pixels, so the double pixel structure is not observed, and the most probable charge of the single pixel is about three times lower.

Charge calibration are not simulated. Thus the simulated distribution is not affected by the error introduced by the conversion of the analog signal into an 8-bits integer. The width of the peak and the tails are however well reproduced at normal incidence, since they are dominated by the fluctuations of the energy deposited in the silicon rather than by the precision of the calibrations. Some discrepancy is observed for very low charges: the threshold cut-off is sharper in the simulation than in real data.

The same discrepancy in the threshold region is also observed at \(30^{0}\) incidence. Additionally, there is a discrepancy in the position of the peak when the same rescaling of the experimental charge used at normal incidence is applied. A deviation from linearity of the calibrated scale would give such an effect, since a single pixel collects only a third of the total charge released by the particle at \(30^{0}\), hence the distribution is peaked at a much lower value.

### Simulation of irradiated detectors

In this section the results of the simulation are compared with the data taken with an irradiated sensor. Unless otherwise stated, the comparison is made at a bias voltage of 600 V. This is the maximum operating bias voltage foreseen at the LHC. The simulation of irradiated detectors requires the introduction of two more parameters: the thickness of the depleted region, which may be less than the sensor thickness, and the charge trapping lifetime.

These parameters can both be extracted comparing the simulation with data taken at \(30^{0}\) incidence angle (Fig. 5). The knowledge of track position after the alignment of the test beam tracking telescope and the pixel detector under test [9, 19] allows to determine the average depth \(D\) of the track segment under each pixel. This is defined as the distance of the center of the track segment subtended by a given pixel from the pixel itself.

Since the entrance points of the tracks are uniformly distributed, all of the depths vary continuously and the maximum observed depth \(D\) is a measurement of the thickness of the active region of the detector [2]. This may be lower than the actual depleted thickness, as trapping makes it difficult to collect charge from the deepest zone of the depleted region. In Fig. 6 the experimental and simulated distributions of the track segment depth are reported. The simulated distributions are obtained with a depleted thickness of 250 \(\mu\)m (i.e. a fully depleted sensor) and two different values of the charge lifetime \(\tau\). It can be observed how the trapping affects the maximum depth of the distribution (which could be measured as the inflexion point of the distribution). The data are in agreement with the simulation performed with a fully depleted sensor and a lifetime of 3.5 ns.

Such an agreement would also be obtained with a lower depleted depth and a larger lifetime. The lifetime can however be measured separately using the distribution of the charge collected by a pixel as a function of the track seg ment depth [18]. Because of trapping, the charge collection efficiency decreases with increasing track depth. The experimental and simulated distributions are reported in Fig. 7. Again, a lifetime of 3.5 ns yields a good agreement between simulation and data. The measurement is reported in more detail in Ref. [18] and a lifetime of \((3.4\pm 0.4\pm 0.3)\) ns is found for this sensor (called sensor B in Ref. [18]).

It can be concluded that a depleted thickness of 250 \(\mu\)m and a lifetime of 3.5 ns are required to reproduce the experimental distribution of Fig. 6 and Fig. 7.

In Fig. 8 the experimental cluster size is compared with the predictions of the simulation obtained using these values. The simulated data obtained with a \(\tau=2\) ns are also reported to show the dependence of the distribution on the trapping lifetime.

The simulated cluster size for 3.5 ns trapping lifetime is within 2% of the experimental value both for normal incidence and at 30\({}^{0}\) incidence angle. As already observed for the not-irradiated detectors, the cluster size distribution is much more sensitive to the value of the parameters at 30\({}^{0}\) incidence angle; at this angle the simulation is much closer to the data when the measured value of the lifetime is used.

Figure 5: Schematic view of a sensor crossed by a track at 30\({}^{0}\) incidence angle.

Fig. 9 reports the comparison of the single pixel charge distributions. The measured charge has been rescaled so that position of the peak at normal incidence coincides with that of the distribution with a 3.5 ns trapping lifetime.

Figure 6: Distribution of track segment depth at 30\({}^{0}\) incidence angle. The figure reported the experimental distribution at 600 V bias voltage and two simulated ones, obtained with a depleted region depth of 250 \(\mu\)m and a charge lifetime of 2 ns and 3.5 ns respectively.

Figure 7: The simulated distribution of pixel charge as a function of track depth is reported for several values of the lifetime and compared with the data taken at 700 V. The distributions were normalized to the mean value in the interval 50 \(\div\) 80 \(\mu\)m

The same rescaling factor was used at \(30^{0}\) incidence.

The required scale factor is 0.82, which is somewhat low given the expected 10% accuracy of charge calibrations. An even lower scale factor would be required to get an agreement with the simulated charge distribution obtained with the 2 ns trapping lifetime.

As in the case of not irradiated sensors, the peak and the tails of the distribution are well described, but the threshold cut is significantly sharper in the simulation. The distribution at \(30^{0}\) would again require a more moderate rescaling of the charge.

In Fig. 10 the charge collection efficiency is shown as a function of the depth of the charge release in the sensor, for three different values of the trapping life

Figure 8: Average cluster size for an irradiated detector at normal incidence (left) and \(30^{0}\) incidence angle (right).

time. These curves require a detailed simulation of the charge drift and trapping to be computed, as they depend on the geometry of the electrodes (determining the Ramo potential distribution, Fig. 2), the trapping lifetime and the electric field distribution inside the sensor. Their parametrization can be useful in implementing radiation damage effects in the official ATLAS simulation, which can not use the CPU-consuming tracking of the charges inside the sensor done in the simulation presented in this note.

Figure 9: Pixel charge for an irradiated detector at normal incidence (left) and \(30^{0}\) incidence angle (right).

## 4 Conclusions

A simulation of the response of pixel detectors to ionizing radiation has been presented. The interactions of the incident particles with the detector material were described with the Geant4 package. The simulation of the charge collection and readout includes a detailed description of charge drift in silicon, signal induction on the pixel electrodes, and electronics readout response. Radiation damage effects were also taken into account.

The output of the simulation was compared with test-beam data taken with ATLAS Pixel detectors. A good agreement was obtained between the simulated and real pixel multiplicity distributions. The pixel charge distribution is also well described by the simulation except at very low charges, near the electronics threshold cutoff, which is sharper in the simulation. This discrepancy can probably be resolved implementing the description of the charge measurement digitization, which is not done in the current version of the program.

The effect of radiation damage on the detector response has been discussed. A method to extract the radiation damage parameters (depleted region depth and the charge trapping lifetime) from the comparison of the simulation with test-beam data was presented. The simulation was compared with data taken with an an ATLAS Pixel detector irradiated to a fluence of 1.1 \(10^{15}\) n\({}_{\rm eq}\)cm\({}^{-2}\). It was shown that the response of the detectors can be reproduced by the simulation with a depleted region depth equal to the full sensor thickness of 250 \(\mu\)m and a charge carrier lifetime of 3.5 ns. The agreement between the simulated and experimental distributions is similar to that obtained for not irradiated detectors.

The simulation described in this note can also be useful to derive fast

Figure 10: Charge Collection efficiency as a function of charge depth in the sensor.

parametrization of the charge collection properties to be used in the ATLAS Pixel official simulation, which is subjected to severe computing speed requirements and can not implement the detailed description of charge drift processes presented here.

As an example, the dependence of the charge collection efficiency on the depth of charge release in irradiated sensors was presented and discussed.

**Acknowledgments**

The pixel detectors used to take the test-beam data were the product of years of R&D made by the ATLAS Pixel collaboration. I would like to thank in particular Kevin Einsweiler (LBNL, Berkeley), John Richardson (LBNL, Berkeley) and Peter Sicho (Institute of Physics, Praha) for their contribution to PS irradiations, the extensive characterization of the electronics, and the organization of the test-beams.

Special acknowledgments are due to the Milan group of the collaboration. The reconstruction and analysis of the test-beam data are performed by code developed by A. Andreazza, C. Meroni, F. Ragusa and C.Troncon (INFN and University of Milan). A. Andreazza and S. Magni have made contributions to the code used in the simulation. I am also indebted to all the members of the group for useful discussions and advice.

## References

* [1] Geant4 collaboration home page, [http://wwwinfo.cern.ch/asd/geant4/](http://wwwinfo.cern.ch/asd/geant4/)
* [2] I. Gorelov et al., Nucl. Instr. and Meth. A481 (2002) 204.
* [3] T. Lari, _Lorentz angle variation with electric field for ATLAS silicon detectors_, ATL-INDET-2001-004.
* [4] C. Jacoboni et al., Solid State Electronics 20 (1977) 77.
* [5] I. Gorelov et al., Nucl. Instr. and Meth. A489 (2002) 202.
* [6] V. Eremin et al., Nucl. Instr. and Meth. A476 (2002) 556.
* [7] V. Radeka, Ann. Rev. Nucl. Part. Sci. 38 (1988) 217.
* [8] L. Blanquart et al., IEEE Trans. on Nucl. Sci. 49 (2002) 1778.
* [9] A. Andreazza et al., _H8 ATLAS pixel test beam analysis program User Guide_, ATL-INDET-2003-009.

* [10] E. Mandelli et al., IEEE Trans. on Nucl. Sci. 49 (2002) 1774.
* [11] K. Einsweiler, _PS irradiation of FE-I assemblies_, presentation at the ATLAS Pixel Week (CPPM Marseille, June 2002), [https://edms.cern.ch/file/348344/1](https://edms.cern.ch/file/348344/1) P. Sicho, _Irradiation plans and status at the CERN PS_, presentation at the ATLAS Pixel Week (CPPM Marseille, June 2002), [https://edms.cern.ch/file/348344/1](https://edms.cern.ch/file/348344/1)
* [12] J. Treis et al., Nucl. Instr. and Meth. A 490 (2002) 112.
* [13] G. Lindstrom et al., Nucl. Instr. and Meth. A 426 (1999) 1.
* [14] G. Lindstrom et al., Nucl. Instr. and Meth. A 466 (2001) 308.
* [15] G. Kramberger et al., Nucl. Instr. and Meth. A 481 (2002) 297.
* [16] O. Krasel et al., _Measurement of trapping time constants in silicon with the transient current technique_, talk given at the 2nd RD50 Workshop on radiation hard semiconductor devices for very high luminosity colliders, [http://rd50.web.cern.ch/RD50/2nd-workshop/default.htm](http://rd50.web.cern.ch/RD50/2nd-workshop/default.htm)
* [17] T. Lari, _Test Beam results of ATLAS Pixel sensors_, arXiv:hep-ex/0210045.
* [18] T. Lari, on behalf of the ATLAS Pixel collaboration, _Charge trapping in irradiated silicon detectors_, presented at the 9th Pisa meeting _Frontier detectors for frontier physics_, to be published on Nucl. Instr. and Meth. G. Alimonti et al., _A study of charge trapping in irradiated silicon with test beam data_, ATLAS internal note, in preparation.
* [19] T. Lari, _Alignment of irradiated and not irradiated pixel sensors in test-beam operation_, ATL-INDET-2001-002.