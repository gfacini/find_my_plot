**ATLAS-INDET-NOTE XXX**

**21 January 1998**

**Parameterisation of the Inner Detector Performance**

**Ernst-Jan Buis1, Reinier Dankers2, Armin Reichold3**

Footnote 1: email r96@nikhef.nl

Footnote 2: email r78@nikhef.nl

Footnote 3: email a.reichold@nikhef.nl

Footnote 4: email s.haywood@rl.ac.uk

NIKHEF, Amsterdam, Netherlands.

**Stephen Haywood4**

Footnote 4: email a.haywood@rl.ac.uk

Rutherford Appleton Laboratory, Chilton, Didcot, United Kingdom.

###### Abstract

A parameterisation of the track parameter resolutions in the Inner Detector of ATLAS has been used to implement a set of FORTRAN subroutines that can smear charged particle tracks according to these resolutions. The correlations between the track parameters have been taken into account. The data describing the detector performance has been intensively tested for self consistency and compared with results from the Inner Detector TDR.

[MISSING_PAGE_EMPTY:2]

Introduction

For many ATLAS physics topics, a fast parametric detector simulation is needed. Until today many studies of SUGRA physics have been done with such simulations. So far, only a rudimentary description of the Inner Detector has been available for these studies. This work presents a complete parameterisation of the ATLAS Inner Detector. This parameterisation is implemented as a set of FORTRAN subroutines and functions and is currently used in ATLFAST[5]. From a given set of track parameters a smeared set of track parameters is calculated. The resolution used to calculate the smeared set is a good approximation to the current best estimate of the Inner Detector performance [1].

Smearing is done according to the particle type. The three particle types distinguished are electrons, muons and pions. All other charged particles are treated as pions. It is assumed that the smearing of each track parameter for muons and pions can be described by two uncorrelated parts - a Gaussian centre part and a tail. The Gaussian part is identical for muons and pions; the tails are different. For electrons, the smearing is more complicated. The division in an uncorrelated Gaussian part and a tail is probably not correct. Especially important are the low energy tails caused by Bremsstrahlung. At the moment only an accurate description of the central Gaussian part for muons and pions is available. More work is required to describe the tails and the electrons.

## 2 Track parameters

A track in the magnetic field of the Inner Detector can be described by a set of 5 parameters \(\boldsymbol{p}\):

\[\boldsymbol{p}=\left(a_{0},z_{0},\phi_{0},\cot\theta,Q/p_{T}\right) \tag{2.1}\]

These parameters are shown in figure 2.1 and figure 2.2.

**Error! Not a valid link.**

**Figure 2.1** The track parameters in the \(x\)-\(y\) plane.

The transverse impact parameter \(a_{0}\) is defined as the distance of closest approach to the beam-line. The sign of \(a_{0}\) is negative if the track has positive angular momentum around the beam line. The longitudinal impact parameter \(z_{0}\) is defined as the value of \(z\) at the point on the track where \(a_{0}\) is evaluated. The angular co-ordinates are \(\phi_{0}\) and \(\cot\theta\). Parameter \(\phi_{0}\) is the angle between the track and the \(x\)-axis at the point of closest approach. The inverse slope of the track in the \(r\)-\(z\)-plane is \(\cot\theta\). The inverse transverse momentum \(Q/p_{T}\), (\(Q=\) charge of the particle), and not \(p_{T}\), is the quantity measured with Gaussian errors. The relation between \(R_{cavr}\) and \(Q/p_{T}\) is given by:

\[R_{cavr}[\mathrm{m}]=\frac{p_{T}[\mathrm{GeV}]}{0.3\cdot Q[\mathrm{e}]\cdot B [\mathrm{T}]} \tag{2.2}\]

Figure 2.2: The track parameters in the \(r\)-\(z\) plane.

[MISSING_PAGE_FAIL:4]

[MISSING_PAGE_FAIL:5]

In the endcap area \(r(z)\) and not \(z(r)\) is measured. Therefore one finds (both for the pixel and strip detectors):

\[\sigma_{r\theta}=\sigma_{T}\hskip 42.679134pt\sigma_{z}=\sigma_{L}\cot\theta \tag{3.2.10}\]

The term \((\sin\theta+\cos\theta)^{-1}\) in (3.2.9) describes the pixel resolution as function of \(\theta\). The resolution improves for increasing \(\theta\), caused by the increased cluster size. For bigger values of \(\theta\) the resolution gets worse again, because the clusters become too big and break up. The best resolution is at \(45^{\circ}\). The factor \(\Omega\) is an \(|\eta|\) dependant correction term, varying between 1 and 1.7 [4]. Both \((\sin\theta+\cos\theta)^{-1}\) and \(\Omega\) are empirical terms to tune the resolution to full simulation.

For a set of \(m=n-1\) scattering planes, the multiple scattering term \(\chi_{ms}^{2}\) is given by:

\[\chi_{ms}^{2}=\bigvee_{j}^{2}\sum_{i=1}^{m}\mathbf{p}_{i,ms}^{T}\mathbf{N}_{ii}^{-1}\bm {p}_{i,ms} \tag{3.2.11}\]

The vector \(\mathbf{p}_{i,ms}\) is given by:

\[\mathbf{p}_{i,ms}=\left(\Delta\phi_{i},\Delta\cot\theta_{i}\ \right) \tag{3.2.12}\]

The matrix \(\mathbf{N}_{ii}\) describes the rms of the scattering angle at plane \(i\):

\[\mathbf{N}_{ii}=\begin{pmatrix}\dfrac{k_{i,1}^{2}}{p_{T}^{2}}&0\\ 0&\dfrac{k_{i,2}^{2}}{p_{T}^{2}}\end{pmatrix} \tag{3.2.13}\]

The terms \(k_{i,1}\) and \(k_{i,2}\) are given by:

\[k_{i,1}=0.0136\sqrt{\left[L_{i}[1+0.038\log L_{i}\right]^{2}-L_{i-1}[1+0.038 \log L_{i-1}]^{2}}\quad k_{i,2}=\dfrac{k_{i,1}}{\sin\theta} \tag{3.2.14}\]

The term \(L_{i}\) describes the total radiation length, summed over all planes up to the current plane \(i\):

\[L_{i}=\sum_{j=1}^{i}l_{i} \tag{3.2.15}\]

The term \(l_{i}\) describes the radiation length at plane \(i\)12. Equation (3.2.14)is an empirical extension of the formula given in [6], describing a single scattering. Equation (3.2.6) and (3.2.11) can be combined in one expression if the scattering angles at each detector plane are also regarded as measurements and are always zero. The measured position at plane \(i\) is now given by:

Footnote 12: A detailed list of the radiation lengths for each plane can be found in the source code of Presol.

\[h_{i}=\left(t_{i},z_{i},0,0\right) \tag{3.2.16}\]

The predicted position \(\hat{h}_{i}\) at plane \(i\) is given by:

\[\hat{h}_{i}=\left(\hat{l}_{i}(r,\mathbf{p},\mathbf{p}_{ms}),\hat{z}_{i}(r,\mathbf{p},\mathbf{p }_{ms}),\Delta\phi_{i},\Delta\cot\theta_{i}\right) \tag{3.2.17}\]

The total error \(\chi^{2}\) is now given by:

\[\chi^{2}=\bigvee_{j}^{2}\sum_{i=1}^{n}\left(\mathbf{h}_{i}-\hat{\mathbf{h}}_{i}(r_{i}, \mathbf{p},\mathbf{p}_{ms})\right)^{\top}\mathbf{V}_{ii}^{-1}\left(\mathbf{h}_{i}-\hat{\mathbf{h}} _{i}(r_{i},\mathbf{p},\mathbf{p}_{ms})\right) \tag{3.2.18}\]

The \(4\otimes 4\) diagonal matrix \(\mathbf{V}\) is given by:

\[\mathbf{V}=\begin{pmatrix}\mathbf{R}&\mathbf{0}\\ \mathbf{0}&\mathbf{N}\end{pmatrix} \tag{3.2.19}\]

[MISSING_PAGE_EMPTY:7]

An arbitrary but useful choice is \(p_{T}\!=\!1\) GeV for the low \(p_{T}\!\) measurement and \(p_{T}\!=\!1\) TeV for the high \(p_{T}\!\) measurement. At \(p_{T}\!=\!1\) TeV the influence of the \(B\) term is negligible and \(\,\mathrm{cov}(p_{a},p_{b})\!=\!A_{ab}^{2}\,\).

In the next sections the data points calculated with Presol are compared with this model.

## 4 Resolutions and correlations

In this chapter the resolutions and correlations of all track parameters are discussed. Firstly the resolutions are discussed as functions of \(\eta\) and \(p_{T}\). Secondly the correlations are presented.

### Transverse impact parameter resolution

The resolution of the transverse impact parameter as function of \(p_{T}\) is given in figure 4.1.1 (\(|\eta|\!=\!0\), ideal field, with and without the B-layer14). With the B-layer, the resolution is significantly better, especially for \(p_{T}\!<\!10\) GeV.

Footnote 14: It is not clear if the B-layer will always be present during ATLAS running, especially at high luminosity.

With the B-layer, the \(A\oplus B\) model describes the data very well across the complete \(p_{T}\) range.

Without the B-layer, rather big discrepancies of around 20% occur for intermediate \(p_{T}\) values (\(1<p_{T}<10\) GeV).

\(\sigma(a_{0})\) as function of \(|\eta|\) for \(p_{T}\!=\!1\) TeV and \(p_{T}\!=\!0.5\) GeV is given in figure 4.1.2 and figure 4.1.3. The most important contribution to the resolution comes from the first detector layer15. In this case the resolution is nearly constant across the \(|\eta|\) coverage of the first detector layer for high \(p_{T}\) tracks. Outside this range the error increases sharply. This behaviour can be seen in figure 4.1.2 (with and without the B-layer16). The resolution even improves slightly with increasing \(|\eta|\), due to increasing cluster size. For \(|\eta|\!<\!2\) the model used for the magnetic field has almost no influence on the results. The degradation without the B-layer for \(|\eta|\!>\!2\) however strongly depends on the model used for the magnetic field.

Footnote 15: This follows directly from equation (3.3.1), since \(r_{2}\!>\!r_{1}\)

Footnote 16: The B-layer extends up to \(|\eta|\!=\!2.5\), the first barrel pixel layer only extends up to \(|\eta|\!=\!2\).

Figure 4.1.1: \(\sigma(a_{0})\) versus \(p_{T}\).

For low \(p_{T}\) tracks the resolution is almost completely determined by the multiple scattering term and increases with \(|\eta|\) (more material). Without the B-layer, the resolution improves again at \(|\eta|\!=\!2\) because the end of the coverage of the first pixel barrel layer is reached and the first measurement is now a pixel disk. This is traversed at a more favourable angle than the first barrel layer. It therefore represents less material and the multiple scattering at the first detection reduces17.

Footnote 17: Only the multiple scattering at the first measurement layer influences the resolution of the impact parameters.

### Longitudinal impact parameter resolution

In figure 4.2.1\(\sigma(z_{0})\) is given as function of \(p_{T}\) (with and without the B-layer, \(|\eta|\!=\!0\)). The beam constraint and magnetic field do not influence \(\sigma(z_{0})\) because the track parameters in the \(x\)-\(y\) and \(r\)-\(z\) planes are uncorrelated. The \(A\oplus B\) model describes the data very well across the complete \(p_{T}\) range, apart from the point at 0.5 GeV.

In figure 4.2.2 and figure 4.2.3, \(\sigma(z_{0})\) is given as function of \(|\eta|\) for \(p_{T}\!=\!1\) TeV and 0.5 GeV respectively. For \(p_{T}\!=\!1\) TeV, \(\sigma(z_{0})\) is mainly determined by the intrinsic resolution of the first two detector layers and should be approximately constant across the complete \(|\eta|\) range covered by these layers (\(|\eta|\!=\!2.5\) with the B-layer, \(|\eta|\!=\!2\) without the B-layer). In fact the resolution improves slightly at \(|\eta|\!=\!1\), caused by the increased cluster sizes. For \(p_{T}\!=\!0.5\) GeV, the resolution is determined by the multiple scattering term. In this case, the behaviour is similar to that of the transverse impact parameter. The resolution in the longitudinal direction is significantly worse than in the transverse direction caused by the poorer \(z\) resolution of the B-layer and pixel detectors.

### \(\phi\)-Resolution

In figure 4.3.1 and figure 4.3.2, \(\sigma(\phi_{0})\) is given as function of \(p_{T}\) (\(\eta\!=\!0\), ideal field, with and without the B-layer), without and with beam constraint. Without beam constraint, the \(A\oplus B\) model describes the data rather well. With beam constraint, it fails for intermediate \(p_{T}\) values (\(1<p_{T}\!<\!10\) GeV) and low \(p_{T}\) values (\(p_{T}\!<\!1\) GeV)18.

Footnote 18: The \(A\oplus B\) model will match at low \(p_{T}\) if the point at 0.5 GeV instead of 1 GeV is used for determining parameter \(B\). In this case however the discrepancy at intermediate \(p_{T}\) values will be even bigger.

Figure 4.3.1: \(\sigma(\phi_{0})\) versus \(p_{T}\), no beam constraint. Figure 4.3.2: \(\sigma(\phi_{0})\) versus \(p_{T}\), beam constraint.

[MISSING_PAGE_EMPTY:11]

### \(\cot\theta\)-Resolution

\(\sigma(\cot\theta)\) versus \(p_{T}\) is given in figure 4.4.1 (\(\eta|=0\), with and without B-layer). The \(A\oplus B\) model describes the data very well across the complete \(p_{T}\) range. \(\sigma(\cot\theta)\) is less sensitive than \(\sigma(z_{0})\) to the removal of the B-layer.

\(\sigma(\cot\theta)\) versus \(|\eta|\) is given in figure 4.4.2 and figure 4.4.3, for \(p_{T}=1\) TeV and \(p_{T}=0.5\) GeV. The resolution is almost constant in the barrel area, it increases in the forward area. This behaviour can be explained from (3.2.8) and (3.2.10). These equations show that the \(z\)-resolution of the strip detectors is independent of \(\theta\) in the barrel area and scales with \(\cot\theta\) in the endcap area.

[MISSING_PAGE_EMPTY:13]

### Correlations

The covariances \(\mathrm{cov}(a_{0},\,\phi_{0})\), \(\mathrm{cov}(a_{0},Q/p_{T})\), \(\mathrm{cov}(z_{0},\,\mathrm{cot}\theta)\), \(\mathrm{cov}(\phi_{0},Q/p_{T})\) and the corresponding normalised correlations, are given as function of \(p_{T}\) in figure 4.6.1 to figure 4.6.10. For all covariances, the \(A\oplus B\) model matches the data very well, except for \(p_{T}\!<\!1\) GeV. In the case of beam constraint measurements of \(\mathrm{cov}(\phi_{0},Q/p_{T})\), the \(A\oplus B\) model describes the data less well. Using the B-layer always significantly reduces the magnitude of all correlation coefficients.

### 4.7 Conclusions

From the above data can be concluded that the \(A\oplus B\) model does not always matches the data across the complete \(p_{T}\) range. Since all elements of the covariance matrix vary smoothly with \(\eta\) and \(p_{T}\), it is more suitable to represent them by interpolating between matrices calculated at selected \(\eta\) and \(p_{T}\) values. The \(A\oplus B\) model is only used for the interpolation. The amount of data needed to describe all track parameter resolutions and tails for the Inner Detector for all particle types is around 150 kB. Keeping this constantly in memory is not a problem for typical HEP computing platforms. The influence of the non uniformity of the magnetic field is significant for the track parameters in the \(x\)-\(y\) plane at high \(|\eta|\) (above \(|\eta|\sim 1.5\) or \(\sim 2\), depending on which parameter isbeing considered). The use of a solenoid field description will give more realistic results, which will be important for some physics studies.

## 5 Software Description

### Subroutine Overview

All routines have been written in FORTRAN 77 and have been developed on HP-UX-9.x as well as Windows NT 4.0 systems. All floating point calculations have been implemented in double precision. The software can be found on the following afs location:

/afs/cern.ch/user/r/reichold/public/my_atlfast

In this location also a copy of this document is kept in postscript and Word97 format. A list of all FORTRAN files with a short description of their functionality is given in table 1.

\begin{table}
\begin{tabular}{|l|l|l|} \hline \hline File & Subroutine (S) / Function (F) & Description \\ \hline Id\_init\_resol.f & Id\_init\_resol (S) & read resolution data from file \\ \hline Id\_init\_tail.f & Id\_init\_tail (S) & read tail from file (dummy) \\ \hline Id\_interpol\_resol.f & Id\_interpol\_resol (S) & calculate covariance matrix for given \(\eta\) and \(p_{T}\) \\ \hline Id\_smear.f & Id\_smear (S) & smear vector of track parameters with covariance matrix \\ \hline Id\_xxx\_resol.f & Id\_resol (S) & main routine. Called by the user. \\ \hline dcorgen.f & dcorgen (S) & double precision random number generator \\ \hline dcorset.f & dcorset (S) & \\ \hline drnorml.f & drnorml (S) & calculate vector of double precision correlated random numbers \\ \hline make\_eta.f & make\_eta (F) & double precision \(\theta\)\(\rightarrow\)\(\eta\) \\ \hline  & make\_theta (F) & double precision \(\eta\)\(\rightarrow\)\(\theta\) \\ \hline  & cot (F) & double precision cotangens \\ \hline  & acot (F) & double precision acotangens \\ \hline \hline \end{tabular} The main user callable routine is Id\_resol. All other routines are internal to the package and should not be called by the user.The calling sequence and physical units of Id\_resol can be found in section 5.3.

\end{table}
Table 1: Overview of files and routines

### Data file overview

The files containing the resolution data are named id_resol_particle_XYZ.dat or id_tail_particle_XYZ.dat. The fields resol and tail indicate that the data describes either the Gaussian part or the tail of the distributions19. The field particle describes the particle type (el = electron, mu = muon and pi = pion). The field X describes the detector geometry configuration. Currently two options are possible:

Footnote 19: The tails are not yet used.

X = 0: with the B-layer

X = 1: without the B-layer

The field Y describes the model used for the magnetic field. Currently two options are possible:

Y = 0: approximated real solenoid field

Y = 1: ideal homogeneous 2T field

The field Z indicates if a beam constraints is used or not:

Z = 0: data with beam constraint

Z = 1: data without beam constraint

A fraction of the data file id_resol_mu_0ll.dat is shown below. First the \(\eta\) and then the \(p_{T}\) base points are given. Both must be in ascending order. There must not be more than n_pt_max \(p_{T}\) base points and n_eta_max \(\eta\) base points. Both n_pt_max and n_eta_max are currently set to 100. Following this, for each base point combination first a row of 5 sigmas and then a row of 4 correlation coefficients are given. The \(p_{T}\) base point varies first and the \(\eta\) base point second. At the end of the file summarising comments on the detector geometry, the field, the beam constraint and the authorship are appended. The units used in this file are \(a_{0}\) [\(\mu\)m], \(z_{0}\) [\(\mu\)m], \(\phi\) [mrad], \(\cot(\theta)\) [1/1000] and \(\sqrt[\nu]{\!\!/}_{\!\!/}\) [TeV\({}^{\!-\!1}\)] These units differ from the units used for calling Id_resol, in order to be able to compare the results more easily to [1].

number of eta-bins

26

vector of eta_bins

.000D+00.100D+00.200D+00.300D+00.400D+00

.500D+00.600D+00.700D+00.800D+00.900D+00

.100D+01.110D+01.120D+01.130D+01.140D+01

.150D+01.160D+01.170D+01.180D+01.190D+01

.200D+01.210D+01.220D+01.230D+01.240D+01

.250D+01

number of pt-bins

14

vector of pt_bins

.500D+00.100D+01.150D+01.200D+01.300D+01

.400D+01.500D+01.100D+02.200D+02.400D+02

.100D+03.200D+03.500D+03.100D+04

parameter order A0, Z0, phi0, cotan(Theta) char/Pt

parameter order 1/pt-phi 1/pt-A0 phi-A0 cot(theta)-z0

.11394D+03.16562D+03.31086D+01.30735D+01.30987D+02

.44819D+00 -.36065D+00 -.98010D+00 -.86688D+00

.58099D+02.12810D+03.15110D+01.17886D+01.12434D+02

.37295D+00 -.29190D+00 -.96588D+00 -.83041D+00

(for all \(p_{T}\) and \(\eta\) combinations)

.95368D+01.13712D+03.11510D+00.24932D+01.80379D+00

.96883D+00 -.71476D+00 -.82514D+00 -.84563D+00

who made this : Reinier Dankers, with presol.f

when was it made : 06.10.1997

data origin : TDR, direct averages of covariance matrix

fields : ideal 2T solenoid field

vertex constraint : no constraint

B-layer : including B-layer

### Subroutines

#### Id_resol

A list of parameters of this subroutine is given below:

part_type & integer & input & particle type (Pythia convention)

id_config & integer & input & detector geometry, magnetic field and track constraint configuration (see section 5.2)

to_be_smeared & double[5] & input & incoming track & smeared track & sigma & double[5][5] & output & covariance matrix

This subroutine is the main routine of the package. It is the only routine that should be called directly by the user. On the first call it automatically initialises the data structures for all particle types carrying the covariance 

[MISSING_PAGE_FAIL:19]

### Id_init_resol

A list of parameters of the subroutine is given below:

\begin{tabular}{l l l}fname & char* & input & name of data file \\ n\_eta\_max & integer & input & dimension of eta\_array and \\  & & & \(\eta\) dimension of resol\_par \\ eta\_array & double[n\_eta\_eta\_max] & output & \(\eta\) base points \\ n\_pt\_max & integer & input & dimension of pt\_array and \(p_{T}\) \\ pt\_array & double[n\_pt\_max] & output & \(p_{T}\) base points \\ resol\_par & double[9, n\_eta\_eta\_max, n\_pt\_max] & output & relevant covariances for each \(\eta\) \\ n\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\_eta\eta\_eta\_eta\eta\_eta\eta\_eta\eta\)\end{tabular}

This subroutine fills the 9 relevant elements of the covariance matrix into resol_par with data from a file specified by fname. It returns the filled resol_par and information about how many base points were used to fill it. It also returns the base points themselves in the arrays pt_array and eta_array. Several checks are done on the data:

\(\bullet\) The number of \(\eta\) and \(p_{T}\) base points must not exceed the maximum of n_eta_max and n_pt_max.

\(\bullet\) The base points must be in strictly ascending order.

\(\bullet\) The sigmas must be positive.

\(\bullet\) The correlation terms must be in the allowed range: \(|\rho|\leq 1\).

\(\bullet\) For all base point pairs, the covariance matrices are calculated and checked for positive definiteness using the CERN library routine DSFAC.

If any of the above checks fail, the routine prints the reason and stops. The routine also prints its results to standard output.

## 6 Future Plans

The four main steps in the future development of this package are given below.

### 1.1 Tails for muons and pions

This activity awaits input data from other collaborators in the Inner Detector performance group. Necessary is a description of the tails as function of \(\eta\) and \(p_{T}\). The package is well prepared for the use of tails, provided they are independent from the Gaussian centres.

### 2.2 Electrons

It is not yet clear how the resolutions for electrons are best described because electrons continuously loose energy through Bremsstrahlung. Therefore electron resolutions are not simple Gaussian centres with tails as those for muons and pions. The question of how to describe these resolutions will be answered within the Inner Detector performance group in the next few months.

### 3.3 Other performance variables

Besides the track parameter resolutions there are other variables which characterise the performance of the Inner Detector. Some of these are the tracking efficiency, the transition radiation efficiency and the probability for identifying \(V^{\rm 8}_{\rm 8}\), such as \(\rm K_{\rm x}\), in the Inner Detector. The tracking efficiency is the most straight forward of these parameters. The possibility to parameterise the tracking efficiency is currently investigated using full detector simulations.

## 7 Acknowledgements

We wish to explicitly acknowledge that the results for the Inner Detector resolutions were obtained with a modified version of the program Presol. This program has been developed over several years by Alan Poppleton with contributions from many others. We would furthermore like to thank Elzbieta Richter-Was for helping with the interface to ATLFAST and her efforts to include the package as part of the official ATLFAST program. For numerous discussions and good advice we would like to thank Bob van Eijk.

## References

* [1] ATLAS Inner Detector community: Inner Detector technical design report (volume 1), ATLAS TDR4, CERN/LHCC97-16, April 1997.
* [2] S.J. Haywood: Impact parameter resolution in the presence of multiple-scattering, ATLAS INDET-NO-091, January 1995.
* [3] S.J. Haywood : Helix fits with stereo measurements, ATLAS INDET-NO-095, January 1995
* [4] A. Poppleton: private communication.
* [5] E. Richter-Was, D. Froidevaux and L. Poggioli: ATLFAST 1.0, a package for particle level analysis, ATLAS PHYS-NO-079, March 96.
* [6] Particle data group: Particle Physics Booklet, July 1996.
* [7] V.I. Klyukhin, A. Poppleton, J. Schmitz: Field integrals for the ATLAS tracking volume, ATLAS INDET-NO-23, February 1993.

## Appendix A The resolution of the impact parameters in the case of two detector layers

In general for any \(n\otimes n\) matrix \(M\) given by:

\[\begin{split} M=&\begin{pmatrix}M_{11}&M_{12}& \cdots&M_{1n}\\ M_{21}&M_{22}&\cdots&M_{2n}\\ \vdots&\vdots&\vdots&\vdots\\ M_{n1}&M_{n2}&\cdots&M_{nn}\end{pmatrix}\end{split}\] (A.1)

If \(M\) is not singular one can find the inverse matrix \(K=M^{1}\) as:

\[\begin{split} K=&\frac{1}{\det M}\begin{pmatrix}K_{11}&K_{12}& \cdots&K_{1n}\\ K_{21}&K_{22}&\cdots&K_{2n}\\ \vdots&\vdots&\vdots&\vdots\\ K_{n1}&K_{n2}&\cdots&K_{nn}\end{pmatrix}\end{split}\] (A.2)

The term \(K_{jk}\) is the cofactor or adjunct determinant of \(M_{jk}\) in \(\det\!M\).