# Inaccuracy of GEANT at energies greater than a few hundred GeV. Impact on ATLAS simulation

G. Battistoni, L. Cozzi

INFN, Sezione di Milano, Italy

M. Carboni

INFN, Laboratori Nazionali di Frascati, Italy

###### Abstract

The purpose of this note is to inform the ATLAS community involved in simulation of a problem in the present version of the e.m. sector of GEANT. Such a code is currently used, not only in ATLAS, for energies exceeding 100 GeV. The calculation of the cross section for \(e^{+}e^{-}\) production by photons of energy greater than 100 GeV canbe highly inaccurate. Having neglected such a limitation might have spoiled the evaluation of the e.m. calorimeter response for TeV showers. Other consequences are discussed and solution envisaged.

## 1 Introduction

Recently, together with other authors, some of us have published the results of a simulation of e.m. atmospheric showers, where also GEANT has been used[1] up to 10 TeV for primary electrons and photons. In this paper it is shown that for energies around 1 TeV (or even somewhat less) GEANT exhibits some deviations from usual expectations. This can be seen in Fig. 1, where the position of the shower maximum is plotted versus the logarithm of primary energy. The behaviour is compared for GEANT and the e.m. sector of FLUKA[2]. GEANT clearly deviates from the expected linearity at some point. This result is reproduced also with the 3.21 version of GEANT.

The fact seems to be already known by part of the cosmic ray physics community: we have been alerted by Prof. H. Vankov from the Insitute of Nuclear Research of Sofia and from Prof. T. K. Gaisser from the Bartol Research Institute of Philadelphia, that the problem should originate in the calculation of the total cross section for \(e^{+}e^{-}\) production by photons, for a given energy and Z value, in the function GPRSGG (described in section PHYS210 of the GEANT manual[3]). Such a routine interpolates the cross section values, for each different material, from a parameterization, at initialization time, to create another table in logarithmic steps from a few MeV up to 10 TeV, which is later used at runtime. In the GEANT manual itself it declared that the results of this function are good up to 100 GeV. However, nothing is said, quantitatively, about the departure from the actual cross section for energies exceeding 100 GeV. To our knowledge, most of GEANT users (we included) have neglected such a limitation and have used the code up the extreme possible energies.

We have extracted the GPRSGG function, and we have tested it up to 10 TeV. The results are reported in the next section. We have not yet evaluated completely the impact on calculations for LHC experiments, however we can identify the typical aspects in which the reliability of the simulation results may suffer from the quoted problem.

Figure 1: _Atmospheric depth at which the shower maximum is reached, as a function of \(\log_{10}E_{0}\), for gamma-initiated sub-showers; a) secondary e\({}^{+}\)e\({}^{-}\), b) secondary \(\gamma\). In the energy region \(10^{3}-10^{4}\) GeV GEANT and FLUKA results are superimposed: FLUKA is able to maintain the linear behaviour even at these high energies. The result is unchanged for GEANT version 3.21_

[MISSING_PAGE_EMPTY:3]

D0 10 J=1,6  JJ=6*I+J-6  CC(I)=CC(I)+D*C(JJ)  D=D*X  10 CONTINUE  20 CONTINUE C  SIG=Z*(Z+1.)*(CC(1)+CC(2)*Z+CC(3)/Z) C  90 IF(SIG.LT.0.)SIG=0.  GPRSGG=SIG  END It is well known how the asymptotic behaviour of such a cross section should be flat (actually 7/9 \(X_{0}^{-1}\) for the macroscopic cross section). All theoretical discussions about that can be found in reference [4], which reviews the most quoted calculations about this process. In Figs 2 we plot the output from GPRSGG for three different typical materials used in calorimeters: Al (Z=13), Fe (Z=26) and Pb (Z=82), as a function of energy, in the range 10 MeV \(\div\) 10 TeV, in logarithmic intervals. Instead of converging to the expected flat behaviour, a significant deviation from the physical value starts above 100 GeV, and becomes very important in the TeV region. For Pb at 5 TeV, the calculated cross sections is larger by about a factor of 2 with respect to the expectations!

Not only such a cross section must remain flat, but at very high energies it should also decrease because of the LPM effect [5] (however, in the case of pair production and for very dense materials such a phenomenon becomes relevant only at about 30 TeV). There are also other possible criticisms. For instance, using the \(Z(Z+1)\) factor to take into account the process both in the nuclear and atomic electron field, instead of an expression like \(Z(Z+\xi(Z))\), is known to be only a rather rough approximation. However, in comparison, these are really minor things.

## 3 Possible Consequences

The main consequences of the reported problem are that all showers with energy greater than 100 GeV tend to be shorter than in reality. This should affect at first order the longitudinal development of the shower, even for for showers initiated by electrons, while resolution estimates would be modified at second order. In fact, shower fluctuations are dominated (at least up to shower maximum) by the fluctuations on the position of the first interaction.

From the quantitative point of view, in our opinion, such an effect must be very small up to, say, 500 GeV. Instead, a relevant effect surely occurs in the TeV scale. Therefore we expect that all the evaluations of the calorimeter response, energy deposition as a function of longitudinal sampling, etc., for processes like the decay of a possible \(Z^{\prime}\) (and in ATLAS this is considered up to a 5 TeV mass) should be reconsidered. There are other aspects that are surely affected even for a few hundreds of GeV: in particular the calculation of the energy release in the first radiation lengths, the evaluation of the rate of conversion of high energy photons in the preshower, or in the cryostat. The estimate of conversion rate is important not only for calorimetry, but also for the inner tracking.

Furthermore, other aspects of the physics to be explored with the forward calorimeters might be affected.

In order to be more quantitative, we have simulated electron showers with GEANT in a simple geometry close to our e.m. calorimeter at \(\eta=0\). As a bulk effect, we have analyzed the energy deposition as a function of depth, expressed in radiation lengths (longitudinal development), at 500 and at 2000 GeV (with 1 MeV cutoff energy values for all processes). We have compared the results from the original GEANT code and those from a version in which we have inserted a simple correction (as proposed in the next section). In Fig. 3 and 4 we show the percentage difference between the corrected and original GEANT codes, as a function of calorimeter depth for the two considered energies. As anticipated, at 500 GeV the differences are still small (ranging from -5% to +9%, depending on depth), while at higher energy they become relevant. For 2 TeV electrons, the energy released in the first radiation lengths is significantly lower than in the wrong simulation, and the situation is reversed after the shower maximum: at 27 \(X_{0}\) a percentage difference exceeding +25% is observed. The total energy escaping the calorimeter increases from about 44 to 68 GeV.

As far as the design goal for the Technical Proposal are concerned, we notice that bulk calculations, such as the requested dynamic range of readout electronics (dominated by the response in the middle compartmente of the e.m. calorimeter), are probably (and luckily) negligibly affected. As stated above, the differences at very high energies are more evident in other finer aspects.

It is however obvious that this bug has to be corrected for all future applications, since we aim to exploit precision physics.

## 4 Possible Recovery

In our opinion, using present machines, it is no more a CPU time problem to evaluate a table of cross section values at initialization time using the real formula instead of a parameterization. Perhaps this could also be afforded even at run time. Therefore it is not unreasonable to ask for some modification of the standard philosophy of GEANT (which makes a strong use of interpolations like the one described here). However, for the time being and for the sake of simplicity, an easy solution would be to modify the function in such a way to use the value calculated at 100 GeV for any energy above this threshold. This is what we have done to evaluate the numerical effects for this note.

This is quite simple, but now the natural question is if other problems of this kind in other routines, at these high energies (at low energy some benchmarks already exist[6]). We think that the ATLAS and LHC communities, even appreciating all the efforts to make GEANT more and more versatile and user oriented, should ask also for some revision in the physics sector.

We are already aware of other weak physics points (for instance, some routines for high energy muon interaction exhibit some problem[7]), but they could be less relevant for ATLAS. Instead, there could be much more fundamental questions, such as the reliability of the present hadronic packages, since we are aware that the resolution results for jets in ATLAS differ by 30% when GHEISHA and FLUKA are compared.

## References

* [1] V. Patera et al., "Simulation of the electro-magnetic component of Extensive Air Showers", INFN-Frascati preprint LNF 93/015 (P), to be published on Nucl Instr. and Methods A.
* [2] P. A. Aarnio et al, Proc. of the MC93 Int. Conf. on Montecarlo Simulation in High Energy and Nuclear Physics, Tallahassee, USA, World Scientific ed., (1994) 100; A. Fasso et al., Proc. of the IV Int. Conf. on Calorimetry in High Energy Physics, La Biodola, Italy, World Scientific ed. (1994) 493.
* [3] CERN Program Library Long Writeup W5013, see section PHYS210
* [4] J. H. Hubbel et al., J. Phys. Chem. Ref. Data, **9** No. 4 (1980) 1023.
* [5] for a review see T. Stanev et al., Phys. ReV. **D25** No. 5 (1982) 1291.
* [6] see for instance L. Urban, Proc. of the IV Int. Conf. on Calorimetry in High Energy Physics, La Biodola, Italy, World Scientific ed. (1994) 478.
* [7] G. Battistoni and E. Scapparone, MACRO experiment at Laboratori Nazionali del Gran Sasso of INFN, private communication. A. Ferrari, INFN Sezione di Milano, private communication.