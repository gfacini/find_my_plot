# **Arlas Note**

ATL-PHYS-PUB-2009-000

April 26, 2009

**Vertexing For \(b\)-tagging**

The ATLAS Collaboration1

Footnote 1: This note prepared by K. Grybel, V. Kostyukhin, S. Lai, G. Piacquadio, K. Prokofiev, C. Weiser, A. Wildauer.

_This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020._

###### Abstract

Tagging of \(b\)-quark jets, "\(b\)-tagging", is an important ingredient for Standard Model analyses as well as for searches for new physics. A property of \(b\)-quark jets exploited by \(b\)-tagging algorithms is the presence of secondary \(b\)- and \(c\)-hadron decay vertices. In this note, methods for the explicit reconstruction of secondary and/or tertiary decay vertices of \(b\)- and \(c\)-hadron decays are presented. The performance of the secondary vertex based \(b\)-tagging algorithms and the dependences on the event topology and jet kinematics are studied. The efficient reconstruction of the primary interaction vertex is also crucial for \(b\)-tagging, especially in the presence of pile-up interaction vertices at LHC luminosity. The ATLAS primary vertex reconstruction strategies and performances are presented in this note as well.

Introduction

Identification of \(b\)-quark jets relies on the properties of the production and weak decay of \(b\)-hadrons. The most important one is their relatively large lifetime of about 1.5 ps (\(c\tau\approx 450\mu\)m). The resulting \(b\)-hadron flight path \(<l>=\beta\gamma c\tau\) leads to a signature of one or more displaced secondary vertices (e.g. inside a jet originating from a \(b\)-quark with transverse momentum of 50 GeV \(b\)-hadrons travel on average about 3 mm in the transverse plane before their decay).

Numerous methods can be used for the identification of \(b\)-quark jets (usually called \(b\)-_jet tagging_ or just \(b\)-_tagging_), based e.g. on the presence of leptons inside jets due to semileptonic \(b\)-hadron decays, kinematical properties of jets or explicit \(b\)- or \(c\)-hadron reconstruction. The most efficient tagging methods are based on the presence of displaced vertices inside jets. Such vertices can be detected either by the presence of tracks incompatible with the primary event vertex or by explicit reconstruction of those secondary vertices. Many track based and vertex based \(b\)-tagging methods are known together with combined methods using both track impact parameters and vertex reconstruction simultaneously.

The reconstruction of secondary \(b\)-hadron decay vertices inside jets is challenging for several reasons. The multiplicity of charged particle tracks belonging to the vertex is, contrary to the reconstruction of exclusive decay modes, a-priori not known. In cases of less than two reconstructed charged particles, a well defined secondary vertex cannot be reconstructed. This can happen either because of the charged particle multiplicity produced in the decay or limitations in the track reconstruction efficiency, as imposed by the geometrical acceptance of the inner tracking detectors or interactions in the detector material. Secondary vertex reconstruction efficiencies thus show an upper limit. In addition, weak \(b\)-hadron decays almost always lead to one or more charm hadrons which subsequently decay through weak interaction. Since \(c\)-hadrons also have significant lifetimes, the resulting topology is a set of charged particle tracks either stemming from the primary event vertex, the secondary \(b\)-hadron or tertiary \(c\)-hadron decay vertices. The resolution of the ATLAS tracking system does not resolve this decay topology in all cases. Vertex reconstruction inside jets for \(b\)-jet tagging thus has to be done in an inclusive way. It should be targeted towards highest efficiency to detect secondary vertices and identify its topology as well as possible. Kinematical features of reconstructed vertices like e.g. the invariant mass may be used in combination with spatial features (track-vertex and vertex-vertex distances, etc.) to increase the \(b\)-jet identification power of the algorithms.

Another important ingredient for tagging \(b\)-quark jets is the reconstruction of the primary event vertex. The size of the beamspot in the transverse plane (about 15 \(\mu\)m) is sufficiently small to allow the application of \(b\)-tagging algorithms if only information as defined in the transverse plane is used, once the position of the beam is known with high precision. Explicit reconstruction on event by event basis does not improve significantly the resolution of the primary event vertex in the transverse plane. In the longitudinal direction along the beam, however, the a-priori knowledge of the interaction point is only poor (several cm). Explicit reconstruction is thus mandatory if \(b\)-tagging algorithms are not only based on track and vertex information in the transverse plane. Furthermore, at nominal running of the LHC, additional minimum bias events produce additional so-called pile-up vertices which have to be distinguished from the hard primary interaction. The main task of the primary vertex reconstruction for \(b\)-tagging is thus to reconstruct and identify the signal event vertex out of all interaction vertices along the beam.

At the LHC, \(b\)-tagging has to be applied to jets covering a wide kinematic range both in transverse momentum and pseudorapidity. \(b\)-tagging has to be applied over the full acceptance of the tracking detectors of about \(|\eta|<2.5\). The track reconstruction performance, and thus also the vertex reconstruction and \(b\)-tagging performance, varies strongly with transverse momenta and pseudorapidities of charged particle tracks.

This note focuses on aspects of primary and secondary vertex reconstruction relevant for \(b\)-tagging.

Other aspects, also more technical ones, and performance issues are addressed in notes dedicated to primary [1] and secondary vertex reconstruction [2, 3]. The note is structured as follows. In Section 2 some information on definitions, physics input objects and data sets used in this note is given. Section 3 describes the reconstruction of the primary event vertex, its performance and impact on \(b\)-tagging. Algorithms designed for the inclusive reconstruction of secondary decay vertices inside jets based on two different methods are described in Section 4. The performance of these algorithms in terms of secondary vertex related quantities is discussed in Section 5. Their combination with the pure track impact parameter based \(b\)-tagging algorithms is described in Section 6. The \(b\)-tagging performance of the algorithms is presented in Section 7. Section 8 gives a summary of the note together with an outlook towards possible future improvements.

## 2 Definitions, Reconstruction Details and Datasets

This section gives definitions and technical details of data reconstruction and analysis procedures used in this note. More detailed information can be found in [4].

The efficiency to tag a jet of flavour \(q\) as \(b\)-jet, \(\epsilon_{q}\), is defined as:

\[\epsilon_{q}=\frac{\text{Number of jets of real flavour q tagged as b}}{\text{Number of jets of real flavour q}}. \tag{1}\]

Usually \(\epsilon_{b}\) is called _tagging efficiency_ and \(\epsilon_{udsc}\)_mistagging rate_. The inverse of the mistagging rate \(r_{udsc}=1/\epsilon_{udsc}\) is called \(b\)_-tagging rejection power_ or simply _rejection_. The assignment of a certain flavour to a jet in the Monte Carlo simulation is not unambiguously defined. The following definition has been introduced: the jet flavour is the flavour of the heaviest quark after gluon radiation and splitting within a cone of some size around the jet direction. The default cone size used in ATLAS and in the current note is \(\Delta R<0.3\). To test the pure algorithmic performance of the algorithms, a procedure called "purification" may be applied. Here, a light quark jet is only considered if there is no heavy parton (\(b\)- or \(c\)-quark) or \(\tau\) lepton within a cone of 0.8 around the jet direction.

Several jet reconstruction algorithms are available in ATLAS [5]. The \(b\)-tagging performance may depend on the jet algorithm, but the studies of this dependence are outside the scope of this note (see [4] for such studies). For the studies in this note, an iterative cone algorithm with a cone size of \(\Delta R=0.4\) using combined calorimeter towers as input, has been used. Charged particle tracks have been reconstructed with a Kalman filter based algorithm [6].

Offline ATLAS jet reconstruction and track reconstruction are independent. An assignment of tracks to jets is thus necessary. The current ATLAS method used also in this note is also based on a geometrical cone around the jet direction. All charged tracks within a certain cone (the default value is \(\Delta R<0.4\)) around the jet axis are assigned to a jet.

The following fully simulated Monte Carlo samples have been used for the performance studies described in this note:

* Higgs boson production in association with a \(W\) boson. The \(W\) boson was forced to decay into a muon and its anti-neutrino, \(W\rightarrow\mu\overline{\nu}_{\mu}\), the Higgs boson was forced to decay into pairs of \(b\)-, \(c\)- or \(u\)-quarks: \(\mathrm{H}\rightarrow\mathrm{b}\overline{\mathrm{b}}\), \(\mathrm{H}\rightarrow\mathrm{c}\overline{\mathrm{c}}\), \(\mathrm{H}\rightarrow\mathrm{u}\overline{\mathrm{u}}\). This ensures that the jets of different quark flavour have very similar kinematics. To cover a wide range of jet transverse momenta, samples with Higgs boson masses of \(m_{H}=120\) GeV and \(m_{H}=400\) GeV have been produced.
* Events with pairs of top quarks, \(t\overline{t}\), where one or both \(W\) bosons decayed leptonically.
* Events with pairs of top quarks and at least two additional jets: \(t\overline{t}jj\). These events show a large hadronic activity with a high probability of overlapping jets.

During the first few years the LHC will operate at a luminosity of \(2\cdot 10^{33}\) cm\({}^{-2}\)s\({}^{-1}\) (low luminosity mode), reaching \(10^{34}\) cm\({}^{-2}\)s\({}^{-1}\) (high luminosity mode) at later stages. Each signal event triggered and reconstructed in the ATLAS detector will be overlayed by several low-\(p_{T}\) proton-proton interactions, commonly denoted as minimum bias interactions. The average number of minimum bias interactions per bunch crossing is 4.6 and 23 for the low and high luminosity modes, respectively. To study the influence of these additional so-called _Pile-Up_ interactions, fully simulated Monte-Carlo samples for the low luminosity mode have also been generated for the WH (\(m_{H}=120\) GeV) data set.

To parametrize the trajectory of a charged particle in a magnetic field, so-called "perigee" parameters are used [6]. The ATLAS track based \(b\)-tagging algorithms use \(d_{0}\) and \(z_{0}\), the transverse and longitudinal impact parameters at the point of closest approach of the trajectory to the primary vertex in the transverse plane. To reduce the dependence on the track parameter resolutions, the corresponding variables are divided by their errors. Each impact parameter _significance_ also gets a sign based on the track and jet directions. The sign is positive if the track crosses the jet axis in front of the primary vertex and negative if behind. Most of the tracks produced in \(b\)-hadron decays have a positive sign whereas tracks originating from the primary vertex have both signs with equal probabilities [4]. The distance between the primary and secondary vertices may also have a sign based on the jet direction.

## 3 Primary Vertex Reconstruction

In this section different strategies for the reconstruction of primary vertices currently implemented in the ATLAS reconstruction software are described. The evaluation of the algorithms is performed in the _single collision_ and low luminosity pile-up modes.

The reconstruction of primary vertices can generally be subdivided into two problems: vertex finding and vertex fitting. The primary vertex finding deals with the association of reconstructed tracks to a particular vertex candidate. The task of the vertex fitting is to reconstruct the position of the primary vertex and its covariance matrix, recalculate the parameters of the incident tracks using the vertex constraint and provide a measure of goodness of the fit, such as for example the \(\chi^{2}\) of the fit [7]. In addition, the \(\chi^{2}\) of the refit of track parameters with the knowledge of the reconstructed vertex is a criterion of track to vertex compatibility.

A brief description of the mathematical properties of the algorithms for primary vertex reconstruction and evaluation of their performance with respect to \(b\)-tagging are presented below. For a more detailed description of the algorithms the reader is referred to [1].

### Algorithms for Vertex Fitting

Several strategies for vertex fitting are currently implemented in the ATLAS reconstruction software. All implemented vertex fitters are based on the minimization of a \(\chi^{2}\) function with respect to a position of the vertex and parameters of incident tracks at this position. In addition, all fitters are currently using the exact analytical solution for the dependence of the track parameters on the vertex position and track parameters at the vertex. Indeed, the full solution with respect to the ATLAS version of perigee parametrization has a simple form, which is also computationally economical [1]. The approach to the minimization of the \(\chi^{2}\), treatment of components of track momenta in the vicinity of the vertex candidate and reweighting of tracks during the iterative process, however, differs from algorithm to algorithm.

#### 3.1.1 The Billoir Full and Fast Vertex Fitting Algorithms

Two algorithms, the _Billoir Full_ and the _Billoir Fast Vertex Fitter_ were implemented, following the schema presented in [8]. Here, the inversion of the full \((3n+3)\times(3n+3)\) matrix2 of parameters of the fit, where \(n\) is the number of tracks, is replaced with \(n\) inversions of \((3\times 3)\) matrices. Compared to the global \(\chi^{2}\) minimization, this approach leads to a significant gain in CPU time due to the inversion of smaller matrices. In addition to the reconstruction of the vertex position and its covariance matrix, the _Billoir Full Vertex Fitter_ also refits the parameters of the incident tracks with the knowledge of the vertex.

Footnote 2: In the vicinity of the vertex, the polar angle \(\theta\) and the momentum \(p\) of the trajectories are considered to be constant. The number of parameters of the fit therefore reduces to \(3n+3\): 3 remaining parameters for each of \(n\) tracks and 3 vertex coordinates.

The _Billoir Fast Vertex Fitter_ is a simplified version of the vertex fit, where the trajectories of charged particles are approximated with straight lines in the vicinity of the vertex and their momentum components \(p=(\theta,\phi_{v},q/p)\) are considered to be constant. While the precision of this approach is only a little smaller than the one of the _Full Billoir Vertex Fitter_, the fit itself is significantly faster due to the reduction of the size of covariance matrices to be inverted. It should also be noted, that the _Fast Vertex Fit_ does not refit the momenta of the incident tracks. Due to its reasonable resolution and high CPU performance, this is the default vertex fit to be used with _InDetPriVxFinder_, as explained in Section 3.2.1.

#### 3.1.2 The Sequential and Adaptive Vertex Fitting Algorithms

The _Sequential Vertex Fitter_ implements the conventional Kalman Filter for vertex fitting as described in [7]. The vertex estimate is updated iteratively using the information from a single track at a time. The _SequentialVertexSmoother_ allows the refit of parameters of incident trajectories with the knowledge of the reconstructed vertex position. In addition, the smoother allows for a calculation of the smoothed \(\chi^{2}\) of a track, which is a good criterion of compatibility of a track to a vertex.

A robust version of the above algorithm is the _AdaptiveVertexFilter_. It is an iterative reweighted Kalman Vertex Fitter, where each track is down-weighted according to its compatibility to the actual vertex position [9]. The dependence of the weighting factor on the iteration number of the fit is determined by a thermodynamic annealing procedure. The assignment of tracks to a vertex candidate thus becomes stronger with iterations and the outliers are efficiently discarded.

#### 3.1.3 The TrkVKalVrtFitter Algorithm

The _TrkVKalVrtFitter_ is a universal vertex fitter with constraints. It uses the Billoir method [8] to estimate the local vertex position and calculate refit track parameters with the requirement of passing through the vertex position. The possibility of applying a beam spot constraint when reconstructing the primary vertex is also provided. Neutral and charged particles can be used simultaneously in the fit.

In the presence of badly measured tracks the precision and stability of the fit may be improved by the optional use of robust functionals. In each iteration step the error matrix for each track is recalculated based on an eigenvector decomposition and downweighting of badly measured directions in the track parameter space. Several functionals for downweighting known as _M-type estimators_ are implemented [2].

### Vertex Finding Strategies

Three different strategies for primary vertex finding are currently implemented. These are the _InDetPriVxFinder_, the _InDetAdaptiveMultiPriVxFinder_ and the _VKalVrtPrim_. In the _InDetPriVxFinder_ theprocess of primary vertex finding is decoupled from the vertex fitting and the maximal number of reconstructed vertices is therefore defined at the seeding step. The latter two algorithms exhibit a _finding through fitting_ approach, where the number of vertex candidates changes according to the results of the previous iteration of the fit.

#### 3.2.1 The InDetPriVxFinder Algorithm

The reconstruction strategy of the Inner Detector Primary Vertex Finder consists of three steps. It starts with the selection of good quality tracks originating from the beam crossing area (the detailed selection cuts can be found in [1]).

After this initial track preselection, clusters in \(z\) are searched for in the resulting set of tracks. A simple sliding window algorithm is used for this purpose. First, the tracks are ordered in ascending order of their \(z_{0}\) impact parameter. The full range of \(z_{0}\) impact parameters is then scanned and clusters of fixed length are formed. In the low luminosity scenario, the default maximal cluster length was chosen to be 3 mm. The resulting clusters of tracks are considered as independent primary vertex candidates and corresponding vertices are reconstructed with the provided vertex fitting algorithm.

After the reconstruction of the initial vertex candidates, the tracks least compatible with a given vertex candidate are rejected and the vertex candidate is refitted (the _Billoir Fast Vertex Filter_ described in 3.1.1 is used by default) using one of the following procedures:

* All tracks, with a \(\chi^{2}\) contribution greater than a predefined value (by default, the threshold of \(\chi^{2}=5\) per track is chosen) are discarded and the vertex candidate is reconstructed again using remaining tracks.
* The least compatible tracks are removed from the vertex candidate iteratively one by one until no track with a \(\chi^{2}\) contribution greater than a predefined value is left or the number of remaining tracks is too little to continue. The vertex candidate is refitted at each iteration.

At present, the first algorithm is used as the default one. At the last stage of the primary vertex reconstruction, the obtained vertex candidates are sorted in descending order according to the sum of transverse momenta of their tracks. The vertex with the highest \(\sum p_{T}\) of the tracks is tagged as the signal one. It should be noted that the maximum number of reconstructed primary vertices is fully defined by the output of the cluster finding in the beginning of the algorithm. The iterative refit of the vertex candidates followed by the rejection of incompatible tracks serves for the refinement of the knowledge of the vertex positions only. The minimum number of tracks to form a vertex candidate is one in the case when the beam position is used as constraint, and two otherwise.

#### 3.2.2 The InDetAdaptiveMultiPriVxFinder Algorithm

The _InDetAdaptiveMultiPriVxFinder_ is an example of a _finding-through-fitting_ approach to the primary vertex reconstruction. The reconstruction starts with the preselection of tracks originating from the beam crossing region (the detailed selection cuts can be found in [1]). A single vertex seed is created out of the preselected set of tracks. A vertex candidate is then reconstructed using the Adaptive Multi Vertex Filter [10], as described in 3.1.2. The tracks which were considered to be outliers during the first fit are used to create a new vertex seed. At the next iteration a simultaneous fit of two vertices is performed. Each track is down-weighed with respect to the two vertices. The number of vertex candidates is growing with iterations and the vertices are competing with each other in order to attain more tracks. An annealing procedure is applied to this process: the assignment of tracks to vertices is becoming harder with iterations. The result of the fit is a set of reconstructed vertices with an almost solid track assignment. It has to be noted that for the adaptive fitters the starting point of the fit is of great importance.

#### 3.2.3 The VKalVrtPrim Algorithm

In this algorithm, primary vertex reconstruction starts with the selection of a subset of tracks close to the beamspot position. A sliding window type algorithm (with window size \(\approx 4.5\) mm) selects a position along the beam which maximizes the vertex candidate quality value. This position becomes a seed for the vertex fitter. It accepts all tracks close to the found vertex candidate position and tries to fit a single vertex. If the quality of the vertex is not satisfactory, one or several tracks with the biggest \(\chi^{2}\) contribution are rejected and the fit is repeated. The algorithm works until a vertex with good quality is obtained. Best results may be achieved with the combination of a robust fitting functional and the rejection of tracks during the fit. After a successful fit, the participating tracks are removed from the set of selected tracks and the sliding window algorithm starts a search of the next vertex candidate for the remaining tracks. _VKalVrtPrim_ runs until no more vertex candidates can be obtained in the remaining track sample.

The vertex candidate quality value used in the search is a sum of the track transverse momenta, the transverse mass and \(p_{T}\) nonuniformity in the transverse plane. The vertex fitter uses the beam spot position as constraint in the fit.

### Performance of Primary Vertex Reconstruction

In this section, the performance of different primary vertex reconstruction algorithms is evaluated. The studies are performed in single collision and low luminosity pile-up modes.

As mentioned above, the main tasks of primary vertex finding algorithms are:

* To find all primary vertices in a bunch crossing and reconstruct their positions with highest possible accuracy.
* To identify the hard scatter signal primary vertex among the set of reconstructed vertices with highest possible efficiency.

These two aspects will be investigated in the following. In this section the performance of five strategies for primary vertex reconstruction are compared: _VKalVrtPrim_, _InDetAdaptiveMultiPriVxFinder_ and _InDetPriVxFinder_ used with _SequentialVertexFilter_, _Billoir Fast_ and _Billoir Full Vertex Filters_. Monte Carlo samples of \(WH(120)\rightarrow\mu\nu b\overline{b}\) and \(WH(120)\rightarrow\mu\nu u\overline{u}\) events with and without low luminosity pile-up are used for this study.

#### 3.3.1 Efficiency of Hard Scatter Signal Primary Vertex Identification

As mentioned above, an average of 4.6 minimum bias events are expected to overlay the signal event during low luminosity running of the LHC. The number of simulated primary vertices per bunch crossing, corresponding to the low luminosity mode of the LHC is shown in Figure 1 (left), together with the number of primary vertices reconstructed with different algorithms. All primary vertex finders return containers of reconstructed vertices ordered according to the probability of a given vertex to be produced in a signal collision. The identification of a signal vertex (first in the list) is performed in different ways depending on the algorithm. The _InDetPriVxFinder_ orders the vertices according to the sum of transverse momenta of incident tracks, while the output of the _InDetAdaptiveMultiPriVxFinder_ is sorted according to the sum of squares of transverse momenta. In all cases, the first vertex in the list is considered to be the primary signal vertex and is used by the \(b\)-tagging algorithms. In order to estimate the efficiency to find the correct signal vertex from the list of primary vertices two methods are used. In the first method the signal vertex is considered as reconstructed correctly if it is closer than 500 \(\mu\)m in the \(z\) direction from the truth: \(|z_{rec}-z_{truth}|<500\,\mu\)m. The second method is based on the purity of reconstructed vertices.

The definition of the primary vertex purity is based on the association of tracks fitted to a primary vertex to truth particles:

\[P=\frac{\sum w_{signal}}{\sum w_{signal}+\sum w_{pileup}+\sum w_{noCorres}} \tag{2}\]

where \(\sum w_{signal}\) is the sum of weights of all tracks associated with the signal primary vertex, \(\sum w_{pile-up}\) is the sum of weights of all tracks associated with pile-up events and \(\sum w_{noCorres}\) is the sum of weights of all tracks which were not matched to truth particles. It can be noted that for vertex algorithms which do not assign lower weights to tracks with respect to the vertex candidate during the fit, the sum of the weights of all tracks fitted to the vertex is equal to the track multiplicity. If the value of the purity for a reconstructed primary vertex candidate is above 0.5, it is assumed that the main contribution to the reconstructed vertex stems from signal tracks and therefore the signal primary vertex is correctly identified.

In Figure 1 (right) the distribution of the purity of the first vertex in the output list of the _InDetAdaptiveMultiPriVxFinder_ for \(WH(120)\rightarrow\mu\nu b\overline{b}\) events is shown. It can be noted that in the majority of cases the purity of a tagged signal primary vertex is close to unity.

In Table 1 the fraction of events with correctly identified vertices for both distance based and purity based definitions are shown for different reconstruction algorithms. The \(WH(120)\rightarrow\mu\nu b\overline{b}\) and

\begin{table}
\begin{tabular}{|l|c|c|c||c|c|c|} \hline  & \multicolumn{3}{c||}{\(WH\rightarrow\mu\nu b\overline{b}\)} & \multicolumn{3}{c|}{\(WH\rightarrow\mu\nu a\overline{\mu}\)} \\ \hline Algorithm & (1) [\%] & (2) [\%] & in list [\%] & (1) [\%] & (2) [\%] & in list [\%] \\ \hline \hline _InDetAdaptiveMultiPriVxFinder_ & \(93.7\pm 0.1\) & \(93.8\pm 0.1\) & \(99.1\pm 0.1\) & \(96.1\pm 0.1\) & \(96.2\pm 0.1\) & \(99.3\pm 0.1\) \\ \hline _VKalVrtPrim_ & \(94.4\pm 0.1\) & \(94.5\pm 0.1\) & \(99.1\pm 0.1\) & \(95.1\pm 0.1\) & \(95.2\pm 0.1\) & \(99.4\pm 0.1\) \\ \hline _InDetPriVxFinder (Billoir Full)_ & \(89.8\pm 0.2\) & \(89.3\pm 0.2\) & \(97.6\pm 0.1\) & \(94.0\pm 0.2\) & \(93.8\pm 0.2\) & \(98.2\pm 0.1\) \\ \hline _InDetPriVxFinder (Billoir Fast)_ & \(89.8\pm 0.2\) & \(89.3\pm 0.2\) & \(97.6\pm 0.1\) & \(94.0\pm 0.2\) & \(93.8\pm 0.1\) & \(98.2\pm 0.1\) \\ \hline \end{tabular}
\end{table}
Table 1: Fractions of correctly identified primary vertices for different primary vertex reconstruction algorithms. The fractions are calculated according to the purity based (1) and distance based (2) definitions of the efficiency. The fraction of events where the signal vertex is in the list of reconstructed vertices (column denoted _in list_) is calculated according to the distance based definition.

Figure 1: Left: Number of simulated (black line) and reconstructed vertices per event for different reconstruction algorithms (dotted lines); right: distribution for the _InDetAdaptiveMultiPriVxFinder_ of the primary vertex purity as defined in Eq. (2). The \(WH(m_{H}=120\mathrm{GeV})\rightarrow\mu\nu b\overline{b}\) event sample has been used for these studies.

\(WH(120)\rightarrow\mu\nu u\overline{u}\) Monte Carlo samples with low luminosity pile-up were used for this study. It can be noted that the best performance is shown by the _InDetAdaptiveMultiPriVxFinder_ and by _VKalVrtPrim_. Also no significant difference is observed between purity based and distance based definitions of the efficiency. In addition, the observation is made that in the single-collision mode, the rate of wrongly identified vertices is essentially zero for all algorithms.

The misidentification of the signal vertex leads to a wrong estimate of the longitudinal impact parameters of tracks. This wrong estimate may lead to an incorrect identification of \(b\)- and light quark jets and a decrease of the \(b\)-tagging performance. A dependence of the \(b\)-tagging performance on the type of the primary vertex reconstruction algorithm is therefore expected.

#### 3.3.2 Pointing Lepton

In the events containing isolated leptons (electrons or muons), or even a lepton inside a jet coming possibly from semileptonic decays of heavy hadrons, the properties of these leptons can be used to further increase the efficiency to identify correctly the primary vertex. The trajectory of a reconstructed lepton can be extrapolated to the interaction region. Each reconstructed vertex, for which the lepton has a longitudinal impact parameter \(z_{0}<3\,\)mm, gets an additional weight and can then be tagged as the signal vertex after reordering the list of reconstructed vertices. In Table 2 the fractions of events with correctly identified primary vertices after reordering according to the pointing lepton information are shown for different primary vertex finding algorithms. To estimate these fractions, the distance based definition of efficiency is used. Comparing to Table 1, it can be noted that the use of information from a reconstructed lepton increases the efficiency of correctly identifying the signal primary vertex in case of the _Billoir fitters_, which use the sum of squares of transverse momenta of tracks as sorting criteria. In most cases of misidentified vertices, the direction of the isolated lepton from the \(W\) boson decay is not in the kinematical acceptance of the inner detector, e.g. for the _InDetAdaptiveMultiPriVxFinder_\((73\pm 1)\)% of the outliers have the isolated muon with \(|\eta_{\mu}|>2.5\). Events with a well reconstructed isolated lepton, as it is the case in many analyses, thus show a much lower fraction of misidentified primary vertices.

### Primary Vertex Resolution

In presence of the pile-up vertices spatial resolutions of the reconstructed primary vertex may degrade due to the partial acceptance of tracks from the superposed events. Tables 3 and 4 show the resolutions for the \(x\) and \(z\) coordinates of reconstructed primary vertices for different reconstruction algorithms.

The numbers shown are the widths of a fit with a single Gaussian for the \(x\) coordinate and two Gaussians for the \(z\) coordinate, respectively, to the corresponding distribution of the residuals. In addition the ratio of the narrow Gaussian and the sum of the two Gaussians is given for the \(z\) coordinate. It can be noted that the best results are obtained with the _VKalVrtPrim_ and _InDetAdaptiveMultiPriVxFinder_ and that the values of coordinate resolutions for all algorithms are very close to those obtained for the non-pile-up case. It can therefore be concluded, that in the low-luminosity conditions the degradation of spatial

\begin{table}
\begin{tabular}{|l|c|c|} \hline  & \(WH\rightarrow\mu\nu b\overline{b}\) & \(WH\rightarrow\mu\nu u\overline{u}\) \\ \hline _InDetAdaptiveMultiPriVxFinder_ & \(94.7\pm 0.1\) & \(96.0\pm 0.1\) \\ \hline _VKalVrtPrim_ & \(94.6\pm 0.1\) & \(95.2\pm 0.1\) \\ \hline _InDetPriVxFinder (Billoir Full)_ & \(93.7\pm 0.1\) & \(95.0\pm 0.1\) \\ \hline _InDetPriVxFinder (Billoir Fast)_ & \(93.7\pm 0.1\) & \(95.0\pm 0.1\) \\ \hline \end{tabular}
\end{table}
Table 2: Fraction of correctly identified primary vertices for different algorithms using the distance based definition with reordering due to a lepton matched to the primary vertex.

resolution appears to be very small.

### Impact on \(b\)-Tagging Performance

The beam interaction region in ATLAS has an approximately gaussian transverse profile with \(\sigma=15\mu m\). This size is smaller than the typical transverse impact parameter (\(d_{0}\)) [6] resolution of charged particle tracks. \(b\)-tagging algorithms based on transverse impact parameter significances only (IP2D method [4]) are thus only slightly sensitive to the details of the primary vertex reconstruction and the presence of pile-up vertices. This is demonstrated in the first column of Table 5. Since the vertex reconstruction accuracy in the longitudinal direction is also better than the typical longitudinal impact parameter resolution (\(z_{0}\)[6]), the \(b\)-tagging performance is not influenced significantly by the choice of the primary vertex algorithm in the case where only the signal vertex is present. This can be seen by comparing the rows labelled _signal only_ in Table 5 for the different primary vertex reconstruction algorithms.

The presence of pile-up vertices, however, changes the situation for the longitudinal coordinate considerably. The \(z\) position resolution is not affected significantly by the presence of additional vertices as is shown in Table 4, but the longitudinal size of the beam interaction region is much bigger (\(\sigma_{z}\approx 5.6\) cm) than the transverse one. Any misidentification of the primary interaction vertex thus produces artificially large \(z_{0}\) track impact parameters. Consequently, most of the tracks are rejected by the \(b\)-tagging track selection procedure in these cases and the jets to be tagged do not have any tracks associated. Such jets

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline  & & \multicolumn{3}{c||}{\(WH\rightarrow\mu\nu b\overline{b}\)} & \multicolumn{3}{c|}{\(WH\rightarrow\mu\nu b\overline{u}\)} \\ \cline{3-6}  & & \multicolumn{3}{c||}{Core} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} & \multicolumn{1}{c|}{} \\ Algorithm & & \(\sigma_{z,N},\,[\mu\mathrm{m}]\) & \(\sigma_{z,T},\,[\mu\mathrm{m}]\) & Fraction [\%] & \(\sigma_{z,N},\,[\mu\mathrm{m}]\) & \(\sigma_{z,T},\,[\mu\mathrm{m}]\) & Fraction [\%] \\ \hline \hline _InDetAdaptiveMulti-PriVxFinder_ & signal only & \(41.3\pm 0.5\) & \(98\pm 2\) & 76.3 & \(35.3\pm 0.5\) & \(79\pm 2\) & 75.8 \\ _PriVxFinder_ & pile-up & \(40.9\pm 0.5\) & \(95\pm 2\) & 75.1 & \(34.9\pm 0.5\) & \(77\pm 2\) & 75.5 \\ \hline _VKalVrtPrim_ & signal only & \(40.2\pm 0.5\) & \(92\pm 2\) & 71.1 & \(36.0\pm 0.5\) & \(82\pm 2\) & 78.1 \\  & pile-up & \(41.2\pm 0.5\) & \(98\pm 2\) & 74.1 & \(34.3\pm 0.5\) & \(76\pm 2\) & 73.2 \\ \hline \hline _InDetPriVxFinder_ & signal only & \(49.3\pm 0.5\) & \(132\pm 3\) & 76.3 & \(40.4\pm 0.6\) & \(99\pm 3\) & 76.4 \\ _(Billoir Full)_ & pile-up & \(48.6\pm 0.5\) & \(127\pm 3\) & 76.7 & \(41.0\pm 0.5\) & \(103\pm 3\) & 79.1 \\ \hline \hline _InDetPriVxFinder_ & signal only & \(49.3\pm 0.5\) & \(132\pm 3\) & 76.2 & \(40.3\pm 0.6\) & \(98\pm 3\) & 76.0 \\ _(Billoir Fast)_ & pile-up & \(48.6\pm 0.5\) & \(127\pm 3\) & 76.5 & \(40.9\pm 0.5\) & \(103\pm 3\) & 79.0 \\ \hline \end{tabular}
\end{table}
Table 4: Resolutions on the \(z\) coordinate of primary vertices reconstructed with different strategies in \(WH\rightarrow\mu\nu b\overline{b}\) and \(WH\rightarrow\mu\nu u\overline{u}\) signal only and pile-up scenarios. The numbers shown are the widths of a fit with two Gaussians to the corresponding distribution of residuals (\(\sigma_{z,N}\) for the narrow and \(\sigma_{z,T}\) for the broad component, respectively). _Core Fraction_ is the fraction of events contained in the narrow Gaussian.

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline  & \multicolumn{2}{c|}{\(\sigma_{x}\,[\mu\mathrm{m}]\) in \(WH\rightarrow\mu\nu b\overline{b}\)} & \multicolumn{2}{c|}{\(\sigma_{x}\,[\mu\mathrm{m}]\) in \(WH\rightarrow\mu\nu u\overline{u}\)} \\ \hline Algorithm & signal only & pile-up & signal only & pile-up \\ \hline \hline _InDetAdaptiveMultiPriVxFinder_ & \(11.46\pm 0.05\) & \(11.66\pm 0.05\) & \(10.13\pm 0.05\) & \(10.34\pm 0.05\) \\ \hline _VKalVrtPrim_ & \(11.44\pm 0.05\) & \(11.59\pm 0.05\) & \(10.04\pm 0.05\) & \(10.25\pm 0.06\) \\ \hline _InDetPriVxFinder (Billoir Full)_ & \(12.22\pm 0.05\) & \(12.51\pm 0.05\) & \(11.01\pm 0.06\) & \(11.17\pm 0.05\) \\ \hline _InDetPriVxFinder (Billoir Fast)_ & \(12.23\pm 0.05\) & \(12.50\pm 0.05\) & \(11.01\pm 0.06\) & \(11.17\pm 0.06\) \\ \hline \end{tabular}
\end{table}
Table 3: Resolutions on the \(x\) coordinate of primary vertices reconstructed with different strategies in \(WH\rightarrow\mu\nu b\overline{b}\) and \(WH\rightarrow\mu\nu u\overline{u}\) signal only and pile-up scenarios. The numbers shown are the widths of a fit with a single Gaussian to the corresponding distributions of residuals.

can not be tagged as \(b\)-quark jets anymore. Since the vertex misidentification probability is not negligible in some event topologies, as can be seen from Table 1, the performance of \(b\)-tagging algorithms using information from the longitudinal coordinate is appreciably affected. The degradation of the \(b\)-tagging performance in the presence of pile-up vertices for these algorithms is shown in the second and third columns of Table 5 for the _IP3D_ and _IP3D+SV1_ algorithms which use this information.

An additional complication for \(b\)-tagging with pile-up originates from the rather large amount of soft jets produced in pile-up interactions. These jets do not have reconstructed tracks inside at all in many cases and are thus considered as light quark jets by the \(b\)-tagging algorithms. This, however, causes an unphysical change of the \(b\)-tagging performance not related to the performance of the algorithms themselves, because a different set of jets is used to estimate the performance. To minimize this effect, the results in Table 5 are obtained for jets with at least one associated track. This approach is different from the one normally used for \(b\)-tagging performance studies. The numbers in Table 5 thus have to be taken with care when comparing with other \(b\)-tagging results. The observed degradation of the \(b\)-tagging performance confirms the results obtained in a previous study [11], where a more dramatic decrease of the \(b\)-tagging performance was demonstrated for the case of the nominal LHC luminosity (\(10^{34}\mathrm{cm}^{-2}\mathrm{s}^{-1}\)) when each beam crossing produces 24 pile-up events on average.

There are several possibilities to improve the \(b\)-tagging performance in pile-up scenarios. The presence of jets without any tracks associated to them (especially if the requirement of a small longitudinal impact parameter is not fulfilled for most of the tracks) is an indication that the correct primary vertex has not been reconstructed in this particular event. In such cases, one could either try to use the second vertex from the list of primary vertex candidates (according to the ordering of vertices as applied by the primary vertex reconstruction algorithm) or drop the information in the longitudinal direction, thus falling back to a \(b\)-tagging algorithm working in the transverse plane only. The reconstruction of the primary event vertex, as currently implemented, is a universal procedure not depending on the topology of the event. Adding information specific to a particular analysis could help in some cases to increase the fraction of correctly identified primary vertices, e.g. reconstructing the primary vertex only from prompt isolated high \(p_{T}\) leptons for channels where these are present. These options have to be studied in the future.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline  & & \multicolumn{2}{c|}{IP2D} & \multicolumn{2}{c|}{IP3D} & \multicolumn{2}{c|}{IP3D + SV1} \\ algorithm & & 50\% & 60\% & 50\% & 60\% & 50\% & 60\% \\ \hline \hline \multirow{2}{*}{\begin{tabular}{c} _InDetAdaptiveMulti-_ \\ _PriVxFinder_ \\ \end{tabular} } & signal only & \(133\pm 6\) & \(46\pm 1\) & \(226\pm 14\) & \(67\pm 2\) & \(438\pm 36\) & \(119\pm 5\) \\  & pile-up & \(135\pm 6\) & \(45\pm 1\) & \(160\pm 8\) & \(52\pm 1\) & \(230\pm 14\) & \(82\pm 3\) \\  & ratio [\%] & \(102\pm 6\) & \(98\pm 3\) & \(71\pm 8\) & \(78\pm 4\) & \(53\pm 10\) & \(69\pm 6\) \\ \hline \hline \multirow{2}{*}{\begin{tabular}{c} _VKalVrtPrim_ \\ \end{tabular} } & signal only & \(131\pm 6\) & \(46\pm 1\) & \(234\pm 14\) & \(69\pm 2\) & \(486\pm 42\) & \(129\pm 6\) \\  & pile-up & \(141\pm 6\) & \(47\pm 1\) & \(136\pm 6\) & \(50\pm 1\) & \(220\pm 12\) & \(80\pm 3\) \\  & ratio [\%] & \(108\pm 6\) & \(102\pm 2\) & \(58\pm 7\) & \(72\pm 4\) & \(45\pm 10\) & \(68\pm 6\) \\ \hline \hline \multirow{2}{*}{\begin{tabular}{c} _InDetPriVxFinder_ \\ _(Billoir Fast)_ \\ \end{tabular} } & signal only & \(123\pm 5\) & \(46\pm 1\) & \(225\pm 13\) & \(68\pm 2\) & \(449\pm 38\) & \(113\pm 5\) \\  & pile-up & \(124\pm 5\) & \(41\pm 1\) & \(140\pm 6\) & \(48\pm 1\) & \(220\pm 12\) & \(71\pm 2\) \\  & ratio [\%] & \(101\pm 6\) & \(89\pm 3\) & \(62\pm 7\) & \(71\pm 3\) & \(49\pm 10\) & \(62\pm 3\) \\ \hline \hline \multirow{2}{*}{
\begin{tabular}{c} _InDetPriVxFinder_ \\ _(Billoir Full)_ \\ \end{tabular} } & signal only & \(123\pm 5\) & \(46\pm 1\) & \(225\pm 13\) & \(68\pm 2\) & \(450\pm 38\) & \(114\pm 5\) \\  & pile-up & \(124\pm 5\) & \(41\pm 1\) & \(140\pm 6\) & \(48\pm 1\) & \(221\pm 12\) & \(71\pm 2\) \\ \cline{1-1}  & ratio [\%] & \(101\pm 6\) & \(89\pm 3\) & \(62\pm 7\) & \(71\pm 3\) & \(49\pm 10\) & \(62\pm 3\) \\ \hline \hline \end{tabular}
\end{table}
Table 5: Light jet rejection for \(\mathrm{WH}(m_{H}=120\;\mathrm{GeV})\) events (signal only and pile-up scenarios) using different primary vertex reconstruction algorithms. Only jets with at least one track associated are considered in these performance studies. _IP2D_,_IP3D_ and _IP3D_ + _SV1_\(b\)-tagging methods are described in details in [4]Inclusive Secondary Vertex Reconstruction in Jets

A \(b\)-jet originates from a \(b\)-quark, which produces a \(b\)-hadron in the fragmentation. The \(b\)-hadron then decays due to electroweak interactions, which cause the transition of the \(b\)-quark preferably into a \(c\)-quark (\(|V_{cb}|^{2}\gg|V_{ub}|^{2}\)), which then subsequently also undergoes a weak decay. As a result, the typical topology of the particles in a \(b\)-jet seen in the detector is a decay chain with two vertices, one stemming from the \(b\)-hadron decay and at least one from \(c\)-hadron decays. The eventual intermediate presence of excited \(b\)- or \(c\)-hadron states does not change this picture because their strong or electromagnetic decays do not cause measurable lifetimes. A unique feature of jets originating from the fragmentation of \(b\)-quarks is thus the presence of \(b\)- and \(c\)-hadron decay vertices.

An exclusive reconstruction of these decays cannot be done with high efficiency. The large \(b\)-hadron masses lead to a huge number of possible decay modes with very small branching ratios, many of them involving neutral particles (which cannot be used for vertex reconstruction). The reconstruction of secondary \(b\)- and \(c\)-hadron decay vertices in jets thus has to be done in an inclusive way, where the number of charged particle tracks originating from \(b\)- and \(c\)-hadron decays is not known a-priori.

Trying to resolve the \(b\)- and \(c\)-hadron vertices of the decay cascade separately is very difficult for the following reasons:

* The probability to have at least two reconstructed charged particle tracks both from the \(b\)- and \(c\)-hadron decays is much less than 100%. This is both because of the charged particle multiplicities involved in these decays as well as the limited track reconstruction efficiency, mainly because of material interactions in the detector (as discussed in Section 5).
* The resolutions of the relevant track parameters, especially at low transverse momenta, are not sufficient to separate the two vertices efficiently.

Two different approaches for the inclusive reconstruction of secondary vertices are presented in Sections 4.1 and 4.2. The first one is based on a classical approach of fitting a single geometrical vertex. As explained, this is strictly speaking not the correct hypothesis, however, for the reasons given above, this is an approximation that works well for a large fraction of cases. The second algorithm is based on a kinematical approach, assuming that the primary event vertex and the \(b\)- and \(c\)-hadron decay vertices lie approximately on the same line, the flight path of the \(b\)-hadron. These underlying assumptions are discussed in more detail in the corresponding sections.

The most important issues in inclusive vertex reconstruction are to reconstruct the decay vertices with high efficiency and to associate efficiently to the vertices the charged particle tracks coming from the corresponding decays of \(b\)- and \(c\)-hadrons.

Another important issue is the detection and removal of sources of tracks with large impact parameters which do not have any relation to the \(b\)-quark content of a jet. \(K^{0}\) and \(\Lambda^{0}\) decays, \(\gamma\)-conversions and hadronic interactions in the detector material must be removed as efficiently as possible before applying \(b\)-tagging.

Combining the information from secondary vertices and track impact parameters allows the optimization of the \(b\)-tagging performance and is decribed in Section 6.

### The BTagVrtSec Algorithm

The main purpose of the _BTagVrtSec_ algorithm is efficient \(b\)-jet tagging based on the detection of a secondary vertex inside a jet. It reconstructs secondary vertices due to \(b\)- and/or \(c\)-hadron decays inside a jet with high efficiency and calculates a jet weight, a discriminating variable which may be combined with similar variables from other tagging algorithms (see Section 6). This algorithm is based on the VKalVrt [2] vertex reconstruction package.

#### 4.1.1 BTagVrtSec Vertex Reconstruction

As stated above, to separate \(b\)-quark jets from jets produced by light quarks and gluons, it is sufficient to detect unambiguously \(b\)- and \(c\)-hadron decay vertices inside the jet. The idea of the _BTagVrtSec_ algorithm is to maximize the \(b\)/\(c\)-hadron vertex detection efficiency, keeping at the same time the probability to find a fake vertex inside light jets low. The default version of the algorithm constructs a single secondary vertex from the \(b\)- and \(c\)-hadron decay products. As justification of such an approach it should be noted, that the ability to reconstruct \(b\)- and \(c\)-hadron decay vertices separately is quite limited as already explained previously. Moreover, the precise reconstruction of the decay chain is less important for \(b\)-tagging than the detection of the secondary decay itself. The single vertex approximation allows a high secondary vertex detection efficiency, necessary for powerful \(b\)-tagging at the price of an imprecise kinematical reconstruction in cases when the distance between the \(b\)-and \(c\)-hadron vertices is big. Another advantage of the single vertex approximation is a more simple algorithm that might be easier to tune and calibrate on data.

The _BTagVrtSec_ algorithm starts with a selection of tracks inside a jet. Tracks are selected with the same quality cuts as for the primary vertex reconstruction algorithm _VkalVrtPrim_, except for a relaxed cut on the transverse track impact parameter (\(d_{0}\leq 3.5\) mm) and no requirement of the presence of a hit in the first layer (b-layer) of the pixel detector. This is done in order to maximize the efficiency to reconstruct \(\mathrm{V}^{0}\) decays and material interactions with subsequent removal of the corresponding tracks from the \(b\)-tagging procedure.

Tracks are selected in a cone around the jet axis. The size of the cone is a tunable parameter (the default value is \(\Delta R=0.4\)) which currently does not depend on the jet reconstruction algorithm.

The vertex search itself starts with a determination of all track pairs which form good (\(\chi^{2}<4.5\)) two-track vertices inside the jet. In addition, each track of the pair must have a three dimensional distance from the primary vertex3 divided by its error higher than 2.0 and the sum of these two significances must be higher than 6.0. In order to decrease the fake rate an additional requirement \((\vec{V}_{2tr}-\vec{V}_{primary},\vec{P}_{jet})>0\) is used.

Figure 2: Some distributions for reconstructed two track vertices:

a) the \(\pi^{+}\pi^{-}\) invariant mass spectrum with a peak of \(K^{0}\) decays; b) the \(p\pi\) invariant mass spectrum with a peak of \(\Lambda^{0}\) decays; c) the distance in the transverse plane between the primary and secondary vertices with the peaks due to interactions in the beam pipe (two walls at R\(\approx\)30 mm) walls and pixel layers (R=50.5 mm and R=88.5 mm).

Some of the reconstructed two-track vertices stem from \(K^{0}_{s}\) and \(\Lambda^{0}\) decays, \(\gamma\to e^{+}e^{-}\) conversions and hadronic interactions in the detector material. The corresponding distributions are shown in Figure 2. Figures 2 a) and b) show the invariant \(\pi^{+}\pi^{-}\) and \(p\pi^{-}\) mass spectra for accepted two particle vertices with peaks due to \(K^{0}_{s}\) and \(\Lambda^{0}\) decays. Figure 2 c) shows the distance between the primary and secondary vertices in the transverse plane with peaks due to interactions in the material of the beam pipe and pixel detector layers. Charged particle tracks coming from such vertices are marked as _bad_ and do not participate further in the following \(b\)-tagging procedure for the given jet.

In the next step of the algorithm all tracks inside the jet from accepted two-track vertices except for marked V\({}^{0}\) decays and material interactions are combined into one \(secondary\)\(track\) list and the vertex fitting procedure from the \(V\)_KalVrt_ package tries to fit a single secondary vertex out of all these tracks. If the resulting vertex has an unacceptable \(\chi^{2}\), the track with the highest contribution to the vertex \(\chi^{2}\) is deleted from the \(secondary\)\(track\) list and the vertex fit is redone. This procedure iterates until a good \(\chi^{2}\) of the vertex fit is obtained or all tracks from the \(secondary\)\(track\) list have been removed.

Secondary vertices in light quark jets mainly stem from tracks coming from the primary vertex, typically with a bad measurement of their track parameters and errors.

Some \(b\)-tagging efficiency and rejection calibration algorithms require _negative tail_ vertices. For the use in those algorithms the requirement for two-track vertices \((\vec{V}_{2tr}-\vec{V}_{prim},\vec{P}_{jet})>0\) may be dropped. In this condition in some cases _BTagVrtSec_ reconstructs a final single secondary vertex _behind_ the primary vertex: \((\vec{V}_{sec}-\vec{V}_{prim},\vec{P}_{jet})<0\). Such secondary vertices are mostly fake vertices but give the necessary reference for calibration.

#### 4.1.2 \(b\)-Tagging with BTagVrtSec

Each \(b\)-tagging algorithm is based on variables which show significantly different behaviour for \(b\)-jets and light jets. For secondary vertex based algorithms the first variable is the presence of a reconstructed vertex in the jet itself, whose probability is big for \(b\)-quark jets and small for light quark jets. The vertex reconstruction procedure can, however, provide much more information which also may be used in a \(b\)-tagging algorithm to increase the efficiency. In order not to have a too complex procedure which is still easy to calibrate and to control, only the most sensitive variables should be taken into account.

Although _BTagVrtSec_ can be used as a standalone \(b\)-tagging algorithm, it was developed primarily for working in combination with track impact parameter based algorithms [4]. The distance between primary and secondary vertices is thus not used because this kind of lifetime information is already contained in the track impact parameters. Three additional variables have been chosen for the _BTagVrtSec_ tagging algorithm:

1. The mass of the reconstructed secondary vertex: \(M\).
2. The ratio of the energy of charged particle tracks included in the secondary vertex and the total energy of all charged particle tracks in the jet: \(R\);
3. The number of good (excluding identified \(V^{0}\) decays or material interactions) two-track vertices in the jet: \(N\).

The distributions of the first two variables are shown in Figure 9 in Section 5 for light, charm and \(b\)-jets. The distributions of the number of two-track vertices can be found in [4]. In standalone mode (without combination with track impact parameter based tagging algorithms) the three dimensional distance between the primary and secondary vertices may also be used.

To be reliable any \(b\)-tagging algorithm must be calibrated on data. To facilitate the calibration and to reduce the necessary amount of data the chosen variables have been transformed (for details see [12]):* Invariant mass: \(M^{\prime}=\frac{M}{M+1}\);
* Energy ratio: \(R^{\prime}=R^{0.7}\);
* Number of good two-track secondary vertices: \(N^{\prime}=\log N\).

Due to the efficiency to reconstruct a secondary vertex inside a jet not reaching 100%, the probability density functions (PDF) of the vertex based variable have to contain a \(\delta\)-function [12].

\[PDF=(1-\epsilon)\cdot\delta(M^{\prime},F^{\prime},N^{\prime})+\epsilon\cdot ASH (M^{\prime},F^{\prime},N^{\prime})\]

with \(\epsilon\) being the efficiency to reconstruct a secondary vertex inside a jet. The continuous probability density function of the vertex variables is constructed from multidimensional calibration histograms using the ASH smoothing method [13].

Two slightly different taggers based on the _BTagVrtSec_ algorithms are available in ATLAS, denoted \(SV1\) and \(SV2\). They use exactly the same variables but handle them in a different way. \(SV1\) treats \(M^{\prime}\) and \(R^{\prime}\) jointly and adds \(N^{\prime}\) as independent variable (2+1 decomposition), whereas \(SV2\) uses joint three-dimensional probability density functions.

The only criterion for the selection of variables and tuning of the _BTagVrtSec_ algorithm was \(b\)-tagging performance. Other quantities like the purity of the reconstructed secondary vertices were not considered. Although the achieved quality of the \(b\)-hadron decay vertex is quite good (see Section 5), for applications other than \(b\)-tagging _BTagVrtSec_ may require a different tuning.

### The JetFitter Algorithm

A new inclusive secondary vertexing algorithm which exploits the topological structure of weak \(b\)- and \(c\)-hadron decays inside a jet was recently developed.

#### 4.2.1 Reconstruction of the Decay Chain Topology

As already stated, the fragmentation of a \(b\)-quark results in a decay chain with two vertices, one stemming from the \(b\)-hadron decay and at least one from \(c\)-hadron decays.

As described in Section 4.1, the _BTagVrtSec_ algorithm relies on a vertexing algorithm in which displaced tracks are selected and an inclusive single vertex is obtained using a Kalman based \(\chi^{2}\) fit (as sketched in Figure 4).

The algorithm described here, called _JetFitter_, is based on a different hypothesis. It assumes that the \(b\)- and \(c\)-hadron decay vertices lie on the same line defined through the \(b\)-hadron flight path. All chargedparticle tracks stemming from either the \(b\)- or \(c\)-hadron decay thus intersect this \(b\)-hadron flight axis. There are several advantages to this method:

* Incomplete topologies can also be reconstructed (in principle even the topology with a single track from the \(b\)-hadron decay and a single track from the \(c\)-hadron decay is accessible).
* The fit evaluates the compatibility of the given set of tracks with a \(b\)-\(c\)-hadron like cascade topology, increasing the discrimination power against light quark jets.
* Constraining the tracks to lie on the \(b\)-hadron flight axis reduces the degrees of freedom of the fit, increasing the chance to separate the \(b/c\)-hadron vertices.

From the physics point of view this hypothesis is justified through the kinematics of the particles involved as defined through the hard \(b\)-quark fragmentation function and the masses of \(b\)- and \(c\)-hadrons. The lateral displacement of the \(c\)-hadron decay vertex with respect to the \(b\)-hadron flight path is small enough not to violate significantly the basic assumption within the typical resolutions of the tracking detector (see Figure 4).

This hypothesis, extensively used in the _JetFitter_ algorithm, was explored for the first time in the _ghost track algorithm_ developed by the SLD Collaboration [14], where the already defined \(b\)-hadron flight axis is substituted by a _ghost track_ and where a numerical global \(\chi^{2}\) minimisation procedure was used to perform the multi-vertex fit.

#### 4.2.2 The JetFitter Vertex Reconstruction Algorithm

In JetFitter the vertexing task is mathematically implemented as an extension of the Kalman Filter formalism for vertex reconstruction [7] and the decay chain is described through the determination of the following variables:

\[\vec{d}=(x_{PV},y_{PV},z_{PV},\phi,\theta,d_{1},d_{2},...,d_{N}), \tag{3}\]

with:

* \((x_{PV},y_{PV},z_{PV})\): the primary vertex position.
* \((\phi,\theta)\): the azimuthal and polar directions of the \(b\)-hadron flight axis.
* \((d_{1},d_{2},...,d_{N})\): the distances of the fitted vertices, defined as the intersections of one or more tracks and the \(b\)-hadron flight axis, to the primary vertex position along the flight axis (N representing the number of vertices).

Before starting the fit, the variables are initialised with their prior knowledge:

* The primary vertex position (with covariance matrix), as provided by the primary vertex finding algorithm.
* The \(b\)-hadron flight direction, approximated by the direction of the jet axis, the error being provided by the convolution of the jet direction resolution with the average displacement of the jet axis relative to the \(b\)-hadron flight axis, as determined from Monte Carlo simulations.

The fit is then performed, resulting in the minimization of the \(\chi^{2}\) containing the weighted residuals of all tracks with respect to their vertices on the \(b\)-hadron flight axis. The charged particle tracks to be used in the determination of the decay chain are selected according to the \(\Delta R\) matching criterion explained in Section 2 and a further track selection is applied, in order to reduce the amount of fake tracks.

After the primary vertex and the \(b\)-hadron flight axis have been initialised, a first fit is performed under the hypothesis that each track represents a single vertex along the \(b\)-hadron flight axis, until \(\chi^{2}\) convergence is reached, obtaining a first set of fitted variables (\(\phi,\theta,d_{1},d_{2},...,d_{N}\)).

A clustering procedure is then performed, where all combinations of two vertices (picked up among the vertices lying on the \(b\)-hadron flight axis plus the primary vertex) are taken into consideration, filling a _table of probabilities_. After the table of probabilities is filled, the vertices with the highest compatibility are merged, a new complete fit is performed and a new table of probabilities is filled. This procedure is iterated until no pairs of vertices with a probability above a certain threshold remain.

The result of this clustering procedure is a decay topology with a well defined association of tracks to vertices along the \(b\)-hadron flight axis, with at least one track for each vertex.

More details about the JetFitter vertex reconstruction algorithm can be found in [3].

#### 4.2.3 The JetFitter based \(b\)-Tagging Algorithm

The \(b\)-tagging algorithm implemented as a first application of _JetFitter_ is based on separating \(b\)-jets from \(c\)- and light-quark (\(u\),\(d\),\(s\)) jets by means of the definition of a likelihood function.

The decay topology is described by the following discrete variables:

1. Number of vertices with at least two tracks.
2. Total number of tracks at these vertices.
3. Number of additional single track vertices on the \(b\)-hadron flight axis.

while the vertex information is condensed in the following variables:

1. Mass: the invariant mass of all charged particle tracks attached to the decay chain.
2. Energy Fraction: the energy of these charged particles divided by the sum of the energies of all charged particles associated to the jet.
3. Flight length significance \(\frac{d}{\sigma(d)}\): the weighted average vertex position divided by its error.

Figure 5: 13 different topologies are defined, combining the three discrete variables in such way as to reduce their correlations. For the case of one single vertex with at least two tracks (1), the discrete _PDFs_ for both the other two variables, total tracks at vertices (2) and single additional tracks (3), are used, but they are then considered as uncorrelated, so that their corresponding coefficients are just multiplied.

The use of these variables allows the definition of a likelihood function of the form:

\[L^{b,l,c}(x)=\sum_{cat}coeff(cat)\cdot PDF_{cat}(mass)\cdot PDF_{cat}(energyFraction) \cdot PDF_{cat}\left(\frac{d}{\sigma(d)}\right), \tag{4}\]

which has to be parametrised separately for each of the three different flavours.

The information about the decay topology of the jet as reconstructed by _JetFitter_ is represented by the category (the coefficient \(coeff(cat)\) representing how probable it is to find a certain topology for a given flavour), while the vertex information is contained in the probability distribution functions (_PDFs_).

The discrete variables describing the decay topology are combined according to the scheme of Figure 5 into 13 category coefficients.

In order to reduce the correlations between the decay topology and vertex related variables and to

Figure 6: The _PDFs_ for the mass, the energy fraction and the flight length significance are shown, separately for the three different jet-flavours and split according to the decay chain topology found by _JetFitter_.

increase the discrimination power, the \(PDFs\) are made category dependent. This splitting of \(PDFs\) is done only when strictly needed.

The templates for the vertex variables are shown in Table 6 for all three flavours. Each \(PDF\) was split independently into the categories it was found to be most correlated with, in order to maintain the number of split \(PDFs\) to be determined on Monte Carlo simulated events as low as possible. They were determined on the WH(\(m_{H}=120\) GeV) Monte Carlo events with \(H\to b\overline{b}\), \(H\to c\overline{c}\) and \(H\to u\overline{u}\) and on \(t\overline{t}\) Monte Carlo events.

The _JetFitter_ based \(b\)-tagging algorithm can be either used as a stand-alone algorithm or in combination with pure impact parameter based algorithms (see Section 6).

## 5 Secondary Vertex Reconstruction Performance

In this section, the performance of the inclusive secondary vertex reconstruction algorithms as described in Sections 4.1 and 4.2 is discussed.

Table 6 shows the rate of reconstructed secondary vertices in \(b\)-quark and light quark jets in bins of jet transverse momentum and pseudorapidity for both secondary vertex reconstruction algorithms, as obtained on the \(t\overline{t}\) and \(t\overline{t}jj\) samples.

Above a certain transverse momentum, the efficiency to identify the secondary vertex in a \(b\)-jet for both algorithms approaches approximately a constant value around \(75-80\%\), while the number of vertices reconstructed in light-jets consistently increases with higher jet transverse momentum.

Both effects have to do mainly with the ability to separate real or fake secondary tracks from the primary vertex: tracks from secondaries are selected according to the impact parameter significance of a track with respect to the primary vertex or to the three dimensional flight length significance of the secondary vertex. Therefore, these quantities are strictly related and, above a certain threshold, they are nearly invariant regardless of the boost and thus the flight length of the displaced \(b\)- or \(c\)-hadron produced. For low transverse momenta, the charged particle tracks from \(b\)-hadron decays suffer from larger multiple scattering, thus showing less significant displacements from the primary event vertex and reducing the secondary vertex reconstruction efficiency.

The rising amount of fake vertices in light quark jets with increasing jet transverse momenta is partly due to the nature of the fragmentation process in light quark jets, which produces a larger number of

\begin{table}
\begin{tabular}{|c||c|c||c||c|c||c||c||c||c||c|c||c|c||c|c||} \hline  & \multicolumn{3}{c||}{\(0\)\(<|\eta|<\)0.5} & \multicolumn{3}{c||}{\(0.5\)\(<|\eta|<\)1.0} & \multicolumn{3}{c||}{\(1.0\)\(<|\eta|<\)1.5} & \multicolumn{3}{c||}{\(1.5\)\(<|\eta|<\)2.0} & \multicolumn{3}{c||}{\(2.0\)\(<|\eta|<\)2.5} \\ \hline \hline \(p_{T}\)[GeV] & b & c & 1 & b & c & 1 & b & c & 1 & b & c & 1 & b & c & 1 \\ \hline \hline
1530 & 56.9 & 21.2 & 3.0 & 56.3 & 20.5 & 2.6 & 55.3 & 18.5 & 2.5 & 51.7 & 16.7 & 2.9 & 41.7 & 14.1 & 3.2 \\  & 54.4 & 19.6 & 2.3 & 53.4 & 18.8 & 2.1 & 52.2 & 17.6 & 2.0 & 49.5 & 15.3 & 2.4 & 41.4 & 13.8 & 3.0 \\ \hline
3050 & 72.4 & 29.6 & 5.3 & 72.1 & 28.9 & 4.5 & 70.7 & 28.1 & 4.6 & 66.5 & 24.0 & 5.1 & 58.5 & 21.0 & 5.6 \\  & 69.6 & 27.1 & 4.1 & 68.5 & 25.7 & 3.6 & 66.8 & 24.5 & 3.7 & 62.9 & 21.9 & 4.4 & 56.8 & 21.1 & 5.6 \\ \hline
5080 & 78.2 & 35.1 & 7.5 & 78.3 & 33.9 & 6.4 & 76.5 & 32.0 & 6.7 & 72.7 & 29.5 & 7.3 & 65.8 & 27.5 & 7.9 \\  & 74.7 & 31.1 & 5.4 & 73.9 & 29.4 & 4.9 & 71.9 & 28.2 & 5.2 & 67.7 & 25.7 & 6.2 & 63.1 & 25.2 & 7.9 \\ \hline
80120 & 80.3 & 39.3 & 10.4 & 80.2 & 38.5 & 9.2 & 78.7 & 36.8 & 9.2 & 74.6 & 34.3 & 9.6 & 67.4 & 31.7 & 10.9 \\  & 76.3 & 33.9 & 6.9 & 75.4 & 32.6 & 6.2 & 73.4 & 30.9 & 6.3 & 69.1 & 28.5 & 7.9 & 64.2 & 28.6 & 10.1 \\ \hline
120200 & 78.4 & 42.6 & 14.7 & 78.0 & 39.8 & 13.3 & 76.9 & 39.9 & 13.5 & 71.8 & 36.5 & 14.1 & 64.2 & 32.1 & 14.8 \\  & 76.3 & 36.8 & 8.9 & 74.5 & 32.2 & 8.1 & 72.4 & 32.5 & 8.6 & 67.0 & 30.6 & 10.0 & 59.9 & 27.3 & 13.5 \\ \hline \end{tabular}
\end{table}
Table 6: The fraction of jets with at least one reconstructed secondary vertex passing the selection criteria to be used by the \(b\)-tagging algorithms in \(b\)-, \(c\)- and light quark jets for \(BTagVrtSec\) (top) and \(JetFitter\) (bottom). These numbers, given in percent, have been obtained on the \(t\overline{t}\) and \(t\overline{t}jj\) samples, applying the purification procedure.

tracks coming from the primary interaction vertex the larger the transverse jet momentum is. Assuming the probability for a reconstructed track to represent an outlying measurement is approximately constant to first approximation, the probability of having tracks which fake secondaries increases roughly linearly with the number of primary tracks. The real secondary vertices produced in light quark jets, like photon conversions and V\({}^{0}\) decays represent an additional source of vertices not related to heavy hadron decays. Furthermore, the pattern recognition during the track reconstruction phase is more difficult in dense jets as it is the case for higher jet transverse momenta (see [4]).

The dependence of the vertex reconstruction efficiency on the jet pseudorapidity is mainly a consequence of the different resolutions which can be achieved in different regions of the Inner Detector: for increasing rapidities, the track resolutions close to the Interaction Point get worse, the track reconstruction efficiency starts to decrease and the number of fake tracks rises (a detailed quantitative explanation of these effects can be found in [6] and [4]).

It can also be concluded that the _BTagVrtSec_ algorithm is slightly more efficient in reconstructing secondary vertices inside b quark jets, at the cost of a slightly higher rate of fake vertices produced in light quark jets compared to the _JetFitter_ algorithm, at least in the barrel region of the Inner Detector.

Table 7 shows the population of some reconstructed topologies for \(b\)-quark, \(c\)-quark and light quark jets for _JetFitter_, as a function of the jet transverse momentum and pseudorapidity. As stated in Section 4.2, the key feature of _JetFitter_ is the ability to distinguish several decay chain topologies, in addition to recognizing the presence of a single inclusive decay vertex. The efficiencies and mistagging rates given above for the different categories show that most of the achievable gain is due to the \(1\,Vertex+1\,\,Track\) and \(2\,\,Vertices\) categories, where a gain in rejection against light quark jets of a factor \(\sim 4\) and \(\sim 16\) can be obtained on approximately \(\sim 10\%\) and \(\sim 5\%\) of the reconstructed \(b\)-jets, respectively. The dependence on \(p_{T}\) and \(\eta\) follows the same pattern as already described for the inclusive vertex reconstruction.

Figure 7 shows the resolution achieved on the inclusively reconstructed \(b\)-hadron decay vertex with respect to the true \(b\)-hadron position. A core can be seen, corresponding to the cases where most of the reconstructed tracks really stem from the \(b\)-hadron vertex, approaching the intrinsic resolution of the vertex reconstruction, while a very large tail to higher flight lengths can be observed, due to tracks

\begin{table}
\begin{tabular}{|c||c|c|c||c|c||c|c||c|c||c|c|c||c|c|} \hline  & \multicolumn{2}{c||}{15\(<\)\(p_{T}<\)30} & \multicolumn{2}{c||}{30\(<\)\(p_{T}<\)50} & \multicolumn{2}{c||}{50\(<\)\(p_{T}<\)80} & \multicolumn{2}{c||}{80\(<\)\(p_{T}<\)120} & \multicolumn{2}{c|}{120\(<\)\(p_{T}<\)200} \\ \hline \hline  & b & c & 1 & b & c & 1 & b & c & 1 & b & c & 1 & b & c & 1 \\ \hline \hline Nothing & 30.7 & 66.0 & 87.9 & 18.5 & 56.7 & 83.0 & 13.7 & 51.3 & 79.7 & 11.7 & 46.8 & 76.8 & 10.8 & 43.5 & 71.9 \\ \hline
1 Single Track & 15.3 & 15.2 & 9.4 & 11.4 & 16.5 & 12.3 & 9.9 & 17.4 & 13.6 & 9.3 & 18.0 & 14.7 & 9.7 & 19.1 & 16.5 \\ \hline
2 Single Tracks & 2.8 & 1.3 & 0.4 & 3.7 & 2.1 & 0.7 & 4.5 & 2.6 & 1.0 & 5.5 & 3.5 & 1.4 & 6.8 & 4.3 & 2.2 \\ \hline
1 Single Vertex & 42.8 & 16.2 & 2.2 & 50.3 & 22.3 & 3.9 & 49.6 & 25.1 & 5.2 & 46.3 & 26.8 & 6.4 & 42.2 & 26.9 & 8.1 \\ \hline
1 Vertex + 1 Track & 6.7 & 1.2 & 0.09 & 11.9 & 2.2 & 0.2 & 15.9 & 3.1 & 0.4 & 19.2 & 4.2 & 0.7 & 21.7 & 5.3 & 1.1 \\ \hline
2 Vertices & 1.7 & 0.1 & 0.01 & 4.2 & 0.3 & 0.02 & 6.3 & 0.5 & 0.04 & 8.0 & 0.6 & 0.08 & 8.8 & 0.9 & 0.2 \\ \hline \end{tabular} 
\begin{tabular}{|c||c|c|c||c|c||c|c||c|c||c|c|c|} \hline  & \multicolumn{2}{c||}{0.0\(<\)\(|\eta|<\)0.5} & \multicolumn{2}{c||}{0.5\(<\)\(|\eta|<\)1.0} & \multicolumn{2}{c||}{1.0\(<\)\(|\eta|<\)1.5} & \multicolumn{2}{c||}{1.5\(<\)\(|\eta|<\)2.0} & \multicolumn{2}{c||}{2.0\(<\)\(|\eta|<\)2.5} \\ \hline \hline  & b & c & 1 & b & c & 1 & b & c & 1 & b & c & 1 \\ \hline \hline Nothing & 15.2 & 54.8 & 88.8 & 16.2 & 56.4 & 88.5 & 17.6 & 57.6 & 87.5 & 20.5 & 59.5 & 85.7 & 25.5 & 62.5 & 84.6 \\ \hline
1 Single Track & 10.1 & 16.1 & 8.0 & 10.2 & 16.1 & 8.4 & 11.1 & 16.4 & 9.2 & 12.9 & 17.2 & 10.4 & 14.8 & 16.7 & 10.9 \\ \hline
2 Single Tracks & 4.2 & 2.2 & 0.5 & 4.4 & 2.2 & 0.5 & 4.7 & 2.4 & 0.5 & 5.1 & 2.5 & 0.7 & 5.0 & 2.3 & 0.7 \\ \hline
1 Single Vertex & 46.8 & 23.3 & 2.5 & 47.3 & 22.1 & 2.4 & 46.9 & 21.1 & 2.5 & 44.7 & 18.3 & 3.0 & 41.1 & 16.2 & 3.5 \\ \hline
1 Vertex + 1 Track & 16.8 & 3.1 & 0.2 & 15.6 & 2.7 & 0.2 & 14.3 & 2.3 & 0.2 & 12.8 & 2.2 & 0.2 & 10.5 & 2.0 & 0.3 \\ \hline
2 Vertices & 6.9 & 0.5 & 0.03 & 6.3 & 0.4 & 0.02 & 5.5 & 0.3 & 0.03 & 4.1 & 0.3 & 0.02 & 3.1 & 0.3 & 0.02 \\ \hline \end{tabular}
\end{table}
Table 7: Population of the different topologies of the vertices reconstructed by _JetFitter_ in \(b\)-,\(c\)- and light quark jets, shown as a function of the jet transverse momentum \(p_{T}\) (top) and the jet pseudorapidity \(\eta\). These numbers, given in percent, have been obtained on the \(t\overline{t}\) sample, applying the purification procedure.

coming from the decay of the charmed hadron of the \(b\to c\)-hadron cascade.

Another criterion to estimate the algorithmic performance of the secondary vertex finders is the fraction of charged particles arising from the decays of \(b\)- or \(c\)-hadrons and reconstructed as tracks in the Inner Detector that are correctly associated to a displaced vertex (_efficiency_) and -at the same time- which fraction of the tracks assigned by the secondary vertex finders to displaced vertices really stem from real \(b\)- or \(c\)-hadron decays (_purity_).

The average charged particle multiplicities at the secondary and tertiary decay vertices as obtained from the Monte Carlo generator PYTHIA was analyzed, where a minimum transverse momentum of 500 MeV was required for the charged particles. The decay products of a strong or electromagnetic \(b\)-hadron decay (e.g. pions from \(B^{**}\) decays) are not counted as coming from the secondary vertex, because of the lifetime of these states the decay particles emerge from the primary vertex. The decay products of a strongly or electromagnetically decaying \(c\)-hadron (e.g. \(D^{*}\) or \(D^{**}\)) are considered as stemming from the \(b\)-hadron vertex, while only the decay products of weakly decaying \(c\)-hadrons are considered as originating from the \(c\)-hadron vertex.

The average charged particle multiplicity of the inclusive \(b/c\)-hadron vertex is \(\sim\) 4.7, as shown in Figure 8, distributed in \(\sim\) 2.3 charged particles stemming from the \(b\)-hadron vertex and \(\sim\) 2.4 charged particles originating from the \(c\)-hadron vertex. In the same figure the decay multiplicity at generator level (left) is compared with the number of tracks coming from the \(b\)- and \(c\)-hadron vertices which have been reconstructed as tracks in the Inner Detector (right). Around 80% of their charged decay products are correctly reconstructed as tracks and pass the standard track quality selection cuts.

In order to strongly reduce the contamination of reconstructed secondary vertices by other charged particles originating from the primary interaction point, tracks originating from the \(b\)- or \(c\)-hadron vertices, but not distinguishable from primary tracks, are also suppressed to some extent by the track selection cuts. This and other selection criteria further reduce the \(b\)- and \(c\)-hadron decay products reconstruction efficiency, resulting in a compromise between the highest possible _efficiency_ and a reasonable _purity_. In Table 8 the track association efficiencies and purities of the displaced tracks stemming from the \(b\)- or \(c\)- hadrons for the _BTagVrtSec_ and _JetFilter_ algorithms are shown, the efficiencies being normalized to the number of tracks from \(b/c\)-hadron decays which are reconstructed by the tracking detector. The fit of an inclusive \(b/c\)-hadron decay vertex, as performed by _BTagVrtSec_, allows to obtain a very high purity, but at the cost of starting to loose some tracks when the distance between the \(b\)- and \(c\)-hadron vertices starts to be relevant.

Figure 7: Residuals of the reconstructed three dimensional (left) and transverse (right) flight length of the inclusive secondary vertex with respect to the true \(b-\)hadron position for both vertexing algorithms.

_JetFitter_ is able to recover a good part of this inefficiency, thanks to the ability of reconstructing more complex decay chain topologies, at the cost of a slightly lower purity.

Several topological and kinematical variables related to the reconstructed secondary vertices are used by the \(b\)-tagging algorithms, as described in sections 4.1 and 4.2. The invariant mass of charged particles associated to the vertex and the fraction of charged energy at the vertex relative to that of the jet, are used by both algorithms. The distributions of these variables are shown in Figure 9 for different regions of jet transverse momenta and pseudorapidities for the _BTagVertSec_ algorithm. The flight distance significance, defined as the distance between the primary and secondary vertices divided by its error, is also shown there. The observed dependence of the secondary vertex reconstruction performance on the jet kinematics will directly impact the performance of the \(b\)-tagging algorithms. This will be discussed in Section 7.

Essentially all \(b\)-tagging algorithms use the direction of the jet, as reconstructed from calorimeter towers, to assign e.g. the lifetime sign to the impact parameters of charged particle tracks. The jet direction is a reasonably good approximation of the \(b\)-quark direction, however, for \(b\)-tagging it is mainly the direction of the \(b\)-hadron that matters. The direction of the \(b\)-hadron flight path can be estimated using information from reconstructed primary and secondary vertices, e.g. for _BTagVrtSec_ the line join

Figure 8: Average charged particle decay multiplicity of the \(b\)- and/or \(c\)-hadrons at generator level (left), compared with the number of charged particles coming from the \(b\)- and/or \(c\)-hadron vertices reconstructed as tracks in the Inner Detector and passing some standard quality criteria (right). The WH(\(H\to b\bar{b}\)) sample has been used.

\begin{table}
\begin{tabular}{|c||c|c|c|} \hline Algorithm & Topology & Track efficiency & Track purity \\ \hline BTagVrtSec & 1 inclusive \(B/D\) vertex & 69 \% & 92 \% \\ \hline \multirow{3}{*}{JetFitter} & 1 vertex & 74 \% & 91 \% \\  & 1 vertex + 1 track & 80 \% & 85 \% \\ \cline{1-1}  & 2 vertices & 85 \% & 89 \% \\ \hline \end{tabular}
\end{table}
Table 8: Efficiency (fraction of reconstructed tracks from the decays of \(b\)- or \(c\)-hadrons that are associated to the secondary vertices) and purity (fraction of tracks fitted to the secondary vertices that stem from real \(b\)- or \(c\)-hadron decays) for the two secondary vertex finders, separately for different topologies in the case of _JetFitter_. The WH(\(H\to b\bar{b}\)) sample has been used.

ing the primary and secondary vertices can be used as the \(b\)-hadron direction if a secondary vertex is present in the jet. The more sophisticated _JetFitter_ algorithm delivers by construction an estimate for the \(b\)-hadron flight direction using information from both the calorimeters and vertices of charged particle tracks. Figure 10 shows a comparison of the resolutions achieved for the azimuth angle \(\phi\) for the different approaches. Using an improved \(b\)-hadron direction may decrease the contribution of charged particles from the decays of \(b\)-hadrons to the negative tail of the impact parameter distribution. This contribution mainly comes from a wrong assignment of the lifetime sign if the \(b\)-hadron direction has not been reconstructed sufficiently precisely. This will facilitate the calibration and improve the \(b\)-tagging performance.

Figure 9: Variables related to the properties of reconstructed secondary vertices as computed by the _BTagVrtSec_ algorithm for different jet transverse momenta and pseudorapidities for \(b\)-quark jets (solid), \(c\)-quark jets (dotted) and light quark jets (dashed). Left: \(0<|\eta|<0.5\), \(15<p_{T}<30\) GeV; middle: \(0<|\eta|<0.5\), \(80<p_{T}<120\) GeV; right: \(2<|\eta|<2.5\), \(80<p_{T}<120\) GeV. The top row shows the invariant mass of charged particle tracks associated to the reconstructed secondary vertices, the middle row the energy of charged particle tracks associated to the reconstructed secondary vertices divided by the energy of all charged particles in the jet, and the bottom row the flight distance significance as defined in the text.

## 6 Combination with Impact Parameter based \(b\)-tagging Algorithms

The \(b\)-tagging algorithms presented in the previous sections provide all information needed to be used as stand-alone algorithms. Secondary vertex based \(b\)-tagging algorithms are, however, limited by the efficiency to reconstruct a secondary vertex inside a jet. To obtain maximum performance, the secondary vertex based algorithms can be combined with other algorithms. \(b\)-tagging algorithms purely based on the impact parameter significances of charged particle tracks do not have this limitation. They do not offer, however, the amount of topological and kinematical information as the secondary vertex based algorithms.

In ATLAS, the impact parameter information can be used either in two (\(r\phi\) plane only) or three dimensions. The corresponding algorithms and their performance are described in detail in [4]. They calculate a likelihood ratio of the probability density functions for observed track impact parameter significances \(S\) for tracks coming from \(b\)-quark jets and light quark jets: \(w_{track}=b(S)/u(S)\). The jet likelihood ratio (called _jet weight_) is the sum of track ratios: \(w_{jet}^{IP}=\sum_{i=1}^{N_{track}}\ln w_{track,i}\). Assuming that the tracks are independent, the jet likelihood ratio is an optimal variable for making a decision about the jet origin.

Secondary vertex algorithms were designed in a way facilitating combination with track only based algorithms. They provide likelihood ratios of various parameters for \(b\)-jets and light jets, which may be simply summed with track likelihood ratios. To preserve an optimal performance, secondary vertex variables have been chosen to be maximally independent on track impact parameters (i.e. the distance between primary and secondary vertex is strongly correlated with track impact parameters and then

Figure 10: Angular resolution of the \(b\)-hadron flight direction in the azimuth angle \(\phi\) as reconstructed with the _JetFitter_ and _BTagVrtSec_ algorithms (for the latter, the line joining the primary and secondary vertices has been used in the case where a secondary vertex is present), compared with the corresponding resolution as obtained from calorimeter jets. The \(WH\) (\(H\to b\bar{b}\); \(m_{H}\)=120 GeV) sample was used for this study.

should be used with care). The combined _jet weight_ is then computed as sum of the likelihood ratios of the different algorithms: \(W^{combined}_{jet}=W^{SV}_{jet}+W^{IP}_{jet}\).

The likelihood ratio approach used in ATLAS makes _b_-tagging an easily scalable procedure. Any new algorithm or new variable can be added in the same way to already existing tagging information. Choice of independent variables (or at least weakly correlated ones) guarantees an optimality of combined procedure.

## 7 _b_-Tagging Performance

In this section, the performance of the algorithms described in this note is discussed. The data samples described in Section 2 have been used for these studies. Jets had to be within the acceptance of the tracking detectors (\(|\eta|<2.5\)) and their reconstructed transverse momenta had to exceed 15 GeV: \(p_{T}^{jet}>15\) GeV. The performance is shown in terms of _b_-tagging efficiency, \(\varepsilon_{b}\), and light quark rejection, \(r_{u,c}\) as defined in Section 2. A certain working point is chosen by placing a cut on the weight as computed by the algorithm.

The performance was studied both using only the information as delivered by the secondary vertex based algorithms (denoted _BTagVrtSec_ and _JetFilter_ as in the previous sections) and after combination with a tagging algorithm based on a combination of transverse and longitudinal impact parameter significances as described in Section 6. The _b_-tagging algorithm purely based on the information from impact parameter significances of charged particle tracks showing the best performance is called _IP3D_ and is used in the following studies. Details about this algorithm can be found in [4]. The results from the combined algorithms are denoted _BTagVrtSec+IP3D_ and _JetFilter+IP3D_, respectively. Tables 9 and 10 show the rejection rates against light quark and charm quark jets for different tagging algorithms and data samples.

Figure 11 shows the rejection of light quark (u,d,s) and gluon jets, \(r_{u}\), versus the _b_-tagging efficiency \(\varepsilon_{b}\) for the pure secondary vertex based algorithms and a comparison with the most performant tagging algorithm purely based on three dimensional impact parameter information, _IP3D_. It can be seen that the maximum achievable _b_-tagging efficiency of the vertex based algorithms is limited by the efficiency

\begin{table}
\begin{tabular}{|c|c||c|c|c|c|} \hline Sample & \(\varepsilon_{b}\) & BTagVrtSec & JetFilter & BTagVrtSec+IP3D & JetFilter+IP3D \\ \hline WH(120) & 50\% raw & 97 \(\pm\) 1 & 156 \(\pm\) 3 & 454 \(\pm\) 13 & 545 \(\pm\) 17 \\  & 60\% raw & 37 \(\pm\) 0 & 52 \(\pm\) 0 & 116 \(\pm\) 2 & 133 \(\pm\) 2 \\ \hline WH(120) & 50\% purified & 98 \(\pm\) 1 & 156 \(\pm\) 3 & 462 \(\pm\) 13 & 554 \(\pm\) 17 \\  & 60\% purified & 38 \(\pm\) 0 & 52 \(\pm\) 1 & 118 \(\pm\) 2 & 134 \(\pm\) 2 \\ \hline \hline WH(400) & 50\% raw & 55 \(\pm\) 1 & 101 \(\pm\) 1 & 285 \(\pm\) 6 & 379 \(\pm\) 10 \\  & 60\% raw & 25 \(\pm\) 0 & 45 \(\pm\) 0 & 93 \(\pm\) 1 & 121 \(\pm\) 2 \\ \hline WH(400) & 50\% purified & 55 \(\pm\) 1 & 101 \(\pm\) 1 & 296 \(\pm\) 7 & 390 \(\pm\) 11 \\  & 60\% purified & 25 \(\pm\) 0 & 46 \(\pm\) 0 & 95 \(\pm\) 1 & 123 \(\pm\) 2 \\ \hline \hline \(t\overline{t}\) +\(t\overline{t}jj\) & 50\% raw & 110 \(\pm\) 1 & 176 \(\pm\) 1 & 456 \(\pm\) 4 & 633 \(\pm\) 7 \\  & 60\% raw & 48 \(\pm\) 0 & 66 \(\pm\) 0 & 154 \(\pm\) 1 & 190 \(\pm\) 1 \\ \hline \(t\overline{t}\) +\(t\overline{t}jj\) & 50\% purified & 130 \(\pm\) 1 & 189 \(\pm\) 1 & 791 \(\pm\) 11 & 924 \(\pm\) 14 \\  & 60\% purified & 53 \(\pm\) 0 & 68 \(\pm\) 0 & 206 \(\pm\) 1 & 226 \(\pm\) 2 \\ \hline \end{tabular}
\end{table}
Table 9: The rejection against light quark jets for fixed _b_-tagging efficiencies of 50% and 60% for different data samples without and with applying the purification procedure, denoted as _raw_ and _purified_, respectively.

[MISSING_PAGE_FAIL:26]

Figure 11: Left: Light jet rejection versus \(b\)-tagging efficiency for _BTagVrtSec_ (triangles, green) and _JetFitter_ (full circles, red). The pure impact parameter based algorithm _IP3D_ is also shown for comparison (open circles, blue); right: The ratio with respect to _IP3D_ for _BTagVrtSec_ (dashed line, green) and _JetFitter_ (full line, red). These results have been obtained on the \(t\bar{t}\) and \(t\bar{t}jj\) samples. No purification of light quark jets (see Section 2) has been applied.

Figure 12: Left: Charm jet rejection versus \(b\)-tagging efficiency for _BTagVrtSec_ (triangles, green) and _JetFitter_ (full circles, red). The pure impact parameter based algorithm _IP3D_ is also shown for comparison (open circles, blue); right: The ratio with respect to _IP3D_ for _BTagVrtSec_ (dashed line, green) and _JetFitter_ (full line, red). These results have been obtained on the \(t\bar{t}\) and \(t\bar{t}jj\) samples.

Figure 14: Left: Charm jet rejection versus \(b\)-tagging efficiency for _BTagVrtSec_ (triangles, green) and _JetFitter_ (full circles, red) after combination with _IP3D_. The pure impact parameter based algorithm _IP3D_ is also shown for comparison (open circles, blue); right: The ratio with respect to _IP3D_ for _BTagVrtSec_ (dashed line, green) and _JetFitter_ (full line, red) combined. These results have been obtained on the \(t\overline{t}\) and \(t\overline{t}jj\) samples.

Figure 13: Left: Light jet rejection versus \(b\)-tagging efficiency for _BTagVrtSec_ (triangles, green) and _JetFitter_ (full circles, red) after combination with _IP3D_. The pure impact parameter based algorithm _IP3D_ is also shown for comparison (open circles, blue); right: The ratio with respect to _IP3D_ for _BTagVrtSec_ (dashed line, green) and _JetFitter_ (full line, red) combined. These results have been obtained on the \(t\overline{t}\) and \(t\overline{t}jj\) samples. No purification has been applied.

transverse momentum and jet pseudo rapidity, respectively. Table 11 shows the rejection against light quark jets for a fixed \(b\)-tagging efficiency of 50% for several regions of jet transverse momenta and pseudorapidities.

The reasons for the observed behaviour are manifold. For larger pseudorapidities, the particles pass through more material and thus the detector resolution is worse. Another reason for degradation of the longitudinal impact parameter at high pseudorapidity is the dramatic increase of the extrapolation distance from b-layer hit to the vertex. The degradation for high jet transverse momenta is caused by

Figure 15: Left: Light jet rejection for a fixed \(b\)-tagging efficiency of 50% versus the jet transverse momentum for _BTagVrtSec_ (triangles, green) and _JetFilter_ (full circles, red) after combination with _IP3D_. The pure impact parameter based algorithm _IP3D_ is also shown for comparison (open circles, blue); right: The ratio with respect to _IP3D_ for _BTagVrtSec_ (triangles, green) and _JetFilter_ (full circles, red) combined. The plots in the top (bottom) row show the performance without (with) applying the purification procedure. These results have been obtained on the \(t\overline{t}\) and \(t\overline{t}jj\) sample.

an increased fragmentation multiplicity, resulting in an increased combinatorics in the secondary vertex finding stage when trying to find the tracks stemming from the \(b\)-hadron decay. Furthermore, the pattern recognition in the track reconstruction becomes more difficult in the very dense environment of jets with very large transverse momenta. The steep fall for low jet transverse momenta is mainly due to the strongly enhanced multiple scattering of low momentum charged particle tracks, leading to significantly degraded impact parameter resolutions. The observed dependence of the \(b\)-tagging performance on the jet kinematics can be related to the performance of the secondary vertex reconstruction as discussed in Section 5.3.

Figure 16: Left: Light jet rejection for a fixed \(b\)-tagging efficiency of 50% versus the jet pseudorapidity for _BTagVrtSec_ (triangles, green) and _JetFitter_ (full circles, red) after combination with _IP3D_. The pure impact parameter based algorithm _IP3D_ is also shown for comparison (open circles, blue); right: The ratio with respect to _IP3D_ for _BTagVrtSec_ (triangles, green) and _JetFitter_ (full circles, red) combined. The plots in the top (bottom) row show the performance without (with) applying the purification procedure. These results have been obtained on the \(t\bar{t}\) and \(t\bar{t}jj\) sample.

Section 5. It can be seen there, that the secondary vertex reconstruction efficiency in \(b\)-quark jets drops in the same kinematical regions as the resulting \(b\)-tagging performance, with an increased rate of (fake) vertices in light quark jets.

Two of the most discriminating variables, for both algorithms, are the invariant mass of charged particle tracks associated to the secondary vertex and the fraction of the charged energy at the secondary vertex divided by the total charged energy in the jet. Figure 9 in Section 5 shows these variables for \(b\)-quark, \(c\)-quark and light quark jets for various jet transverse momenta and pseusorapidities. The loss of discrimination power in the regions where the degradation of the \(b\)-tagging performance is observed, is clearly visible. Apart from the kinematic dependence, the \(b\)-tagging performance also depends critically on the contamination of the light quark jets by displaced tracks stemming from nearby \(b\)- or \(c\)-quark jets, as can already be concluded comparing the \(b\)-tagging performance before and after application of the purification procedure. It is however worth looking at this dependence in more detail, analyzing the \(b\)-tagging performance as a function of the distance \(\Delta R\) of the light quark jets to the nearest \(b\)- or \(c\)-quark or \(\tau\) lepton.

Table 12 shows, both for the pure secondary vertex based algorithms and after combination with the \(IP3D\) algorithm, that the more the light quark jets are contaminated by \(b\)- or \(c\)-hadron decay products (smaller values of \(\Delta R\)), the stronger the degradation of the \(b\)-tagging performance is. At very small angles of \(\Delta R\) the light quark-jets can be barely distinguished from the nearby heavy flavour jet. A small kinematical bias (slightly different \(p_{T}\) and \(\eta\) distribution of the jets for different \(\Delta R\) intervals) should also be taken into account when interpreting these results.

There is a noticeable difference in the behaviour of _JetFitter_ compared to _BTagVrtSec_, the second being less robust against building up vertices which catch up contributions from nearby heavy flavour jets. As stated in Section 4.2.2, _JetFitter_ uses the jet direction as reconstructed by the calorimeter as a constraint in the fit of the hypothetical \(b\)-hadron flight axis, thus being more efficient in discarding tracks coming from nearby jets.

## 8 Summary and Outlook

In this note, an overview of vertex reconstruction algorithms used in ATLAS, both for the reconstruction of the primary event vertex and the inclusive reconstruction of secondary decay vertices inside jets, has been given. The focus has been put on applications to the tagging of \(b\)-quark jets.

\begin{table}
\begin{tabular}{|c||c|c|c|c|c|c|} \hline \(\epsilon_{b}\) & \(0.3<\Delta R<0.35\) & \(0.35<\Delta R<0.4\) & \(0.4<\Delta R<0.45\) & \(0.45<\Delta R<0.5\) & \(0.5<\Delta R<0.6\) & \(0.6<\Delta R<0.7\) \\ \hline
50\% & 12.4 \(\pm\) 0.3 & 28 \(\pm\) 1 & 80 \(\pm\) 5 & 177 \(\pm\) 14 & 231 \(\pm\) 11 & 244 \(\pm\) 10 \\  & 29 \(\pm\) 1 & 89 \(\pm\) 6 & 244 \(\pm\) 27 & 363 \(\pm\) 43 & 345 \(\pm\) 20 & 327 \(\pm\) 16 \\ \hline
60\% & 7.3 \(\pm\) 0.1 & 14 \(\pm\) 0.3 & 8.7 \(\pm\) 1 & 68 \(\pm\) 3 & 91 \(\pm\) 3 & 91 \(\pm\) 3 \\  & 17.3 \(\pm\) 0.4 & 43 \(\pm\) 2 & 30 \(\pm\) 6 & 113 \(\pm\) 7 & 128 \(\pm\) 5 & 119 \(\pm\) 4 \\ \hline \end{tabular} 
\begin{tabular}{|c||c|c|c|c|c|c|} \hline \(\epsilon_{b}\) & \(0.3<\Delta R<0.35\) & \(0.35<\Delta R<0.4\) & \(0.4<\Delta R<0.45\) & \(0.45<\Delta R<0.5\) & \(0.5<\Delta R<0.6\) & \(0.6<\Delta R<0.7\) \\ \hline
50\% & 18.4 \(\pm\) 0.5 & 51 \(\pm\) 2 & 179 \(\pm\) 17 & 467 \(\pm\) 62 & 939 \(\pm\) 92 & 951 \(\pm\) 79 \\  & 31 \(\pm\) 1 & 141 \(\pm\) 12 & 501 \(\pm\) 80 & 793 \(\pm\) 138 & 1133 \(\pm\) 121 & 1077 \(\pm\) 95 \\ \hline
60\% & 10.1 \(\pm\) 0.2 & 23 \(\pm\) 1 & 66 \(\pm\) 4 & 143 \(\pm\) 11 & 265 \(\pm\) 14 & 266 \(\pm\) 12 \\  & 17.0 \(\pm\) 0.4 & 50 \(\pm\) 2 & 158 \(\pm\) 14 & 222 \(\pm\) 20 & 309 \(\pm\) 17 & 302 \(\pm\) 14 \\ \hline \end{tabular}
\end{table}
Table 12: The rejection against light quark jets for different \(b\)-tagging efficiencies (\(\epsilon_{b}\)) as function of the difference in \(\Delta R\) of the light quark jets to the nearest \(b\)-, \(c\)- or \(\tau\)-jet (top row: _BTagVrtSec_; bottom row: _JetFitter_), for the secondary vertex based \(b\)-tagging algorithms used stand-alone (upper table) and after combination with the impact parameter based tagging algorithm _IP3D_ (lower table).

Several primary vertex reconstruction algorithms are available in ATLAS. The performance of these algorithms has been studied both for the case where only the hard signal interaction is present and for a luminosity of \(2\times 10^{33}\)cm\({}^{-2}\)s\({}^{-1}\), when 4.6 additional pile-up vertices are present on average. It was demonstrated that the presence of additional vertices does not degrade the primary vertex reconstruction precision significantly. A more severe problem is the misidentification of a pile-up vertex as the signal vertex. For the luminosity of \(2\times 10^{33}\)cm\({}^{-2}\)s\({}^{-1}\) and the event topologies studied in this note, this misidentification rate can be as high as 5%. This misidentification leads to a significant degradation of the performance of the \(b\)-tagging algorithms that use information of charged particle tracks in the longitudinal direction. Possible procedures to recover a large part of this performance loss have been discussed and will be studied an implemented in the future.

Many interesting physics events at the LHC have a lepton with large transverse momentum in the final state, so one may try to decrease the misidentification rate by selecting the reconstructed interaction vertex closest to this lepton. This strategy, however, does not provide a significant improvement in comparison with the standard primary vertex selection algorithm since the presence of a well reconstructed high \(p_{T}\) lepton increases the weight of the corresponding vertex and then is taken into account automatically.

Two algorithms are available in ATLAS for the inclusive reconstruction of secondary decay vertices in jets, following different approaches. The first algorithm, _BTagVrtSec_, reconstructs explicitly geometrical secondary vertices inside the jet. The second algorithm, _JetFitter_, is based on the specific kinematics of the \(b\)- and \(c\)-hadrons decay chain. The performance of the algorithms has been investigated thoroughly. The \(b\)-tagging performance of both algorithms has been studied using only the information from the secondary vertex algorithms as well as after combination with \(b\)-tagging algorithms based on charged track impact parameters. A strong dependence of the vertex reconstruction and thus \(b\)-tagging performance on the jet pseudorapidity and transverse momentum was demonstrated. As explained in the text, this is caused by physics or instrumental effects.

Several new developments and further improvements are planned for the future. A dedicated reconstruction of V\({}^{0}\) decays and material interactions will also be available in _JetFitter_ soon. Together with other improvements, like a modified seeding procedure and the application of multivariate techniques, a significant improvement can be expected for the _JetFitter_ based \(b\)-tagging algorithm in the near future. An extension of the _BTagVrtSec_ algorithm is able to reconstruct several vertices in a jet. The definition of variables related to the additional information to be used for \(b\)-tagging will be done in the near future and increase the \(b\)-tagging performance. The implementation of another inclusive vertex reconstruction algorithm, the so-called _Topological Vertex Finder_ is in progress. It is based on an algorithm originally developed by the SLD collaboration [15].

In the inclusive secondary vertex reconstruction algorithms presented in this note, different cuts are applied at different stages during vertex finding and fitting. Currently, these cuts do not depend on the jet parameters. Due to the strong dependence of the \(b\)-tagging performance on them, however, it seems more appropriate to optimize these parameters depending on the kinematics of the jet under consideration. One quantity worth investigating is the size of the cone around the jet axis within which charged particle tracks are associated to the jet and thus used by the vertex reconstruction and \(b\)-tagging algorithms. For large jet transverse momenta, the cone that contains most of the particles from the decays of heavy \(b\)- and \(c\)-hadrons as well as from fragmentation, will be significantly smaller than for lower transverse momenta. It is thus desirable to choose the size of this track association cone depending on the transverse momentum of the jet. Since this is not restricted to secondary vertex based \(b\)-tagging algorithms, this point is addressed in detail in [4]. To give an idea of what can be expected from such a parameter tuning, one parameter of the _BTagVrtSec_ algorithm has been optimized in bins of the jet transverse momentum. This parameter is a cut on the significance of the displacement of vertex candidates built from pairs of tracks from the primary event vertex. Table 13 shows the values chosen after the optimization procedure.

It can be seen, that the optimal value varies strongly with the jet transverse momentum. Figure 17

shows the gain in \(b\)-tagging performance that is achieved by the parameter tuning. It can be seen that the rejection against light quark jets improves by a factor of about two in the region of large jet transverse momenta, whereas the gain in charm jet rejection is more moderate. This parameter tuning will be continued in the future and will be included in the \(b\)-tagging algorithms.

## References

* [1] G. Piacquadio, K. Prokofiev, A. Wildauer, ATLAS Primary Vertex Reconstruction, ATLAS Note in preparation.
* a package for vertex reconstruction in ATLAS, ATL-PHYS-2003-031.
* [3] G. Piacquadio, C. Weiser, A new inclusive secondary vertex algorithm for b-jet tagging in ATLAS, Proceedings of the International Conference on Computing in High Energy and Nuclear Physics, CHEP 2007, Victoria, Canada.
* [4] ATLAS Collaboration, \(b\)-Tagging Performance, this volume.
* [5] ATLAS Collaboration, Jet Reconstruction Performance, this volume.
* [6] ATLAS Collaboration, The ATLAS Experiment at the CERN Large Hadron Collider, JINST 3 (2008) S08003.

\begin{table}
\begin{tabular}{|l||c|c|c|c|c|c|c|} \hline Jet \(p_{T}\) [GeV] & 15-30 & 30-50 & 50-80 & 80-120 & 120-200 & 200-400 & 400-1000 \\ \hline Optimal Cut & 3.5 & 4.5 & 5.0 & 6.0 & 6.5 & 7.0 & 7.0 \\ \hline \end{tabular}
\end{table}
Table 13: Optimal values for the significance cut on the displacement of two track vertex candidates from the primary event vertex for the different jet \(p_{T}\) bins.

Figure 17: Ratios of the tuned rejections to the default rejection as a function of the jet transverse momentum for a \(b\)-tagging efficiency of 60%. The left hand side plot shows this ratio for light quark jet rejection, while the right hand side plot shows the ratio for charm jet rejection.

* [7] R. Fruhwirth, Application of Kalman Filtering to Track and Vertex Fitting, Nucl. Instrum. and Methods **225** (1984) 352.
* [8] P. Billoir, S. Qian, Fast vertex fitting with a local parametrization of tracks, Nucl. Instrum. Meth. **A311** (1992) 139-150.
* [9] R.Fruhwirth _et al._, Nucl. Instrum. Meth. **A502** (2003) 699.
* [10] R.Fruhwirth, W. Waltenberger, Proceedings of the International Conference on Computing in High Energy and Nuclear Physics, CHEP 2004, Interlaken, Switzerland.
* [11] S. Correard _at al._, \(b\)-tagging with DC1 data, ATL-PHYS-2004-006.
* [12] V. Kostyukhin, Secondary vertex based b-tagging, ATL-PHYS-2003-033.
* [13] D.W. Scott, Multivariate density estimation theory, practice, and visualization, New York, NY Wiley 1992.
* [14] K. Abe _et al._, SLD Collaboration, Time dependent B/s0 anti-B/s0 mixing using inclusive and semileptonic B decays at SLD, Proc. of the 19th Intl. Symp. on Photon and Lepton Interactions at High Energy LP99, ed. J.A. Jaros and M.E. Peskin.
* [15] D.J. Jackson, A Topological vertex reconstruction algorithm for hadronic jets, Nucl. Instrum. Meth. **A388** (1997) 247-253.