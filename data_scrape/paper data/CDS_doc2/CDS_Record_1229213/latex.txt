# The ATLAS Transition Radiation Detector (TRT) Fast-OR Trigger

S. Fratina, M. Hance, M. Newcomer, D. Olivito, R. Van Berg, P. Wagner\({}^{1)}\), H. Williams

The University of Pennsylvania, Philadelphia, PA, USA

B. Auerbach

Yale University, New Haven, CT, USA

D. Dobos, P. Lichard

CERN, 1211 Geneva 23, Switzerland

###### Abstract

The ATLAS Transition Radiation Detector (TRT) "Fast-OR" trigger is the highest rate cosmic-ray trigger of the ATLAS Inner Detector. It uses a fast trigger generation circuit on the front-end electronics and a simple trigger logic circuit on the TRT trigger, timing and control board. Data from the June 2009 combined run with the full Inner Detector shows a total TRT barrel trigger rate of 8 Hz on cosmics tracks with a track purity from offline reconstruction of 98%. The endcap trigger rate is \(\sim\)13 Hz. Using tracks triggered by the Calorimeters, the trigger efficiency in the barrel is estimated to be 75%. The trigger jitter in the barrel is less than 1 clock cycle of 25 ns and the total latency to the ATLAS Central Trigger Processor is \(\sim\)42 clock cycles. This note covers the commissioning and first use of this trigger for both TRT and ATLAS cosmic ray data taking.

1
Footnote 1: Corresponding Author

###### Contents

* 1 Overview
* 2 Trigger Generation on the DTMROC
* 3 Trigger Logic on the TTC Board
* 4 Setup of Full System and CTP Connection
* 5 Results
* 6 Simulation of the Fast-OR Trigger
* 7 Conclusion

Overview

The TRT electronics [1] includes the possibility of generating trigger signals from tracks that cross the TRT detector. The TRT front-end chip ("Drift Time Measurement/Read Out Chip," DTMROC) [1] can be configured to send a signal that is generated using a fast digital OR circuit ("Fast-OR"), over the Command_Out line to the TRT trigger timing and control (TTC) board, if a hit is recorded in one or more of its associated straws. A logic circuit on the TTC board receives these signals from groups of DTMROCs. If the number of signals received exceeds a configurable number of DTMROCs, a trigger signal is generated.

There are various advantages for having a TRT cosmics trigger. During the initial discussions outlining the design of the TRT system, it was noted that having a self-triggered mode, as well as the normal ATLAS running mode, would provide considerable additional flexibility for testing both the electronics and the TRT itself during installation and commissioning with a radioactive source or cosmics. The switch from a DTMROC implemented in the DMILL technology [2] to the DTMROC-S implemented in a deep sub-micron CMOS technology opened the way to adding additional features to the system at almost no cost: Because of the extra logic area available it was possible to add an "accumulate" mode for use in radioactive source testing and a "Fast-OR" mode to facilitate standalone commissioning, calibrations and alignment in cosmic running. Since both readout and trigger are both provided by the TRT, data-taking runs can easily be performed standalone without relying on or coordinating with other detector systems. While other cosmics triggers exist (such as RPC [3, 4, 5], TGC [3, 4, 6], TileCal [3, 7], and LAr [3, 7]), they have either a low trigger rate (TileCal, LAr) or a high rate but low track purity (RPC), in the barrel and especially in the endcap region of the Inner Detector. The location of the TRT detector as the outermost part of the Inner Detector is especially useful for providing SCT and Pixel detectors with a high track rate. Due to its small trigger jitter of less than a clock cycle of 25 ns it is used as a reference by other ATLAS subdetectors (e.g. RPC) to improve their jitter of initially several clock cycles [8].

To illustrate the current trigger implementation, Figs. 1 and 2 (taken from [3]) each show a slice of the barrel and the endcap subdetector, respectively, along with an example of the event display [9] of a track. In the event displays, the straw hits are blue or red depending on whether the energy deposit in the straw exceeded the tracking threshold (LO discriminator) or additionally the transition radiation threshold (HI discriminator) [1]. The HI threshold (HT) hits were used to form the trigger decision in the current implementation. This threshold was set slightly above the typical deposit of a minimum ionizing particle (MIP) to maximize the number of HT hits while at the same time minimizing the number of noise hits. (This configuration does not allow discrimination of transition radiation from minimum ionizing deposits.) The granularity of the trigger is one TTC communication line that connects the combined Command_Out signals of 10-15 DTMROCs (each with 16 straws attached) [10] to the TTC board. Thus, the trigger is of limited use in a high particle-flux environment, as expected with colliding beams in the LHC. The TTC lines of 4 (2) adjacent "phi sectors," each being \(\frac{1}{32}\) in azimuth (see Figs. 1 and 2) in the barrel (endcap), are input to a TTC board. The signals from the 16 (32) separate TTC boards in the barrel (endcap) are sent to NIM logic modules to combine the trigger primitives and implement global trigger decisions. The current TRT trigger logic can be configured to be more efficient for barrel tracks that point towards the beamline and for endcap tracks that point along the beamline. Future upgrades include (a) utilizing the low threshold (LT) transition as a trigger signal and (b) the implementation of an external trigger logic board that collects the signals from all TTC lines, passed through the TTC board, for a single trigger decision.

Figure 1: (a) Schematic of the TRT barrel detector, along with SCT and Pixel for comparison, viewed from the A side (taken from [3]). (b) Example of an event display [9] with a track from a cosmic ray traversing the detector. Each straw that exceeded the HT (red straws) contributes to the trigger signal. The trigger granularity is roughly one green-bordered segment (one TTC line with \(\sim\)200 straws). Each red-bordered segment contributes to the trigger decision. A set of 9 such segments makes a “phi sector” (\(\frac{1}{32}\) in azimuth), labeled from 1 to 32 in the Figure. The trigger logic comprises 4 adjacent phi sectors (36 TTC lines) and was configured to generate a trigger if there are at least four red segments.

The next section describes the generation of the trigger pulse on the DTMROCs, followed by Section 3 about the trigger logic on the TTC board. The setup of the trigger hardware on the TRT and the Central Trigger Processor (CTP) is described in Section 4. Section 5 shows the results from a recent combined run, in particular trigger rate, purity and efficiency. Section 6 describes the Fast-OR trigger simulation. For details on the TRT TTC system, the hardware library and the software implementation of the Fast-OR trigger see Ref. [11].

Figure 2: (a) Schematics of the TRT endcap detector (upper left), along with SCT and Pixel for comparison (taken from [3]). (b) Example of an event display [9] with a track from a cosmic ray traversing the detector. Each straw that exceeded the HT (red straws) contributes to the trigger signal. The granularity (one TTC line) is one green bordered square with 192 straws. Each red-bordered square contributes to the trigger decision. The trigger logic acts on two adjacent phi sectors (each with 20 TTC lines and each line with one front end board), labeled from 1 to 32 in the Figure, and was configured to generate a trigger if there are at least four red segments on two adjacent phi sectors.

## 2 Trigger Generation on the DTMROC

A DTMROC can be programmed to generate a trigger output from a configurable group of ASDBLR channels that cross a selected threshold (high or low). This section provides an overview of this functionality - the full specifications of the DTMROC and the Fast-OR mode are described in [12, 13].

Figure 3 (taken from [14]) shows a block diagram of the ASDBLR and DTMROC that process the signals from the straw anodes ("active inputs" on the left). Thresholds for the HI and LO discriminators on the ASDBLR are controlled by DACs (Digital to Analog Converters) in the DTMROC. Normally the LT is set low to ensure high efficiency for minimum ionizing tracks and the HI threshold (HT) is set well above minimum ionizing but low enough to be efficient for transition radiation photons (typical operating thresholds are about \(\sim\)300 eV and 6 keV, corresponding to a collected charge of 2 fC and 60 fC for the nominal active gas gain and Xe gas mixture). The HI and LO discriminator outputs are then encoded into a ternary differential signal for transmission to the DTMROC.

The DTMROC then decodes the ternary signal into: no pulse, pulse over low threshold, or pulse over both low and high thresholds. The DTMROC then records the time over threshold of the LO signal in 3.125 ns bins (for track reconstruction) and records whether the HT is exceeded during a clock cycle (for transition radiation tagging). In addition to the normal data flow described above, a separate trigger path, the Fast-OR, was also implemented in the DTMROC.

As shown in the block diagram and in more detail in Fig. 4, the decoded output of each ternary receiver is also sent to a decoder which selects either the decoded LO or HI signals from the channel (under DTMROC register control) and then ANDs that signal with a chipwide Fast-OR enable and an individual channel mask (set in the command and test/mask registers respectively). The signal at this point is then slightly stretched (an inverter capacitively fed back to an OR gate) so that the signal has a minimum width of 10-13 ns. This signal, the output on the right of Fig. 4, is then sent to the Command_Out driver on the DTMROC.

The Command_Out driver has two separate operating modes. In the normal operating mode, Com

Figure 3: A schematic overview of the front end electronics: ASDBLR and DTMROC (taken from [14]).

Figure 4: The “Fastout” circuit along with the ternary receiver block that processes the signal from one straw (taken from Ref. [13]). This shows the details of the “Fast Out OR” and ternary receiver blocks in Fig. 3.

mand_Out is a tri-state signal driven only when the particular DTMROC is addressed and requested to send data. This signal is LVDS compatible with the added feature of being tri-state (true, false, Hi-Z). The second mode, used for the Fast-OR trigger, changes from an LVDS compatible balanced current out drive to a reduced current differential output drive. In this mode it is possible to directly connect the outputs of many DTMROCs in parallel and then receive, at the receiver-driver boards at PP2 [1] (TTC-PPs), a current sum proportional to the number of DTMROCs that experienced qualifying hits in any given time period. The current pulse from each DTMROC has an amplitude of 0.5 mA with a width of the OR'd time over threshold or 10-13 ns, whichever is less.

In the present implementation of the TTC-PPs there is no provision for observing how much current is driven onto a given Command_Out line. A simple comparator receives the signal and reports whether the signal is above a threshold corresponding to any one active straw out of a total of \(\sim\)200 straws connected to a TTC line to the TTC board in the USA15 side cavern [3]. For tracking purposes, the LT is set at the nominal operating point of 200 eV (2 fC). This results in a single-straw LT hit rate of 300 kHz, which would give an overwhelming trigger rate if the LT signal were selected. Thus, the HT signal is selected, and the HT set at 50 DAC units (\(\sim\)10 fC), for a \(\sim\)1 keV energy deposit with the Xe active gas mixture and nominal gas gain, well below the transition radiation threshold. At this setting, most tracks have many HT hits, but the noise rate, and thus the accidental rate, is very low [15]. The major disadvantage of this strategy is that we are not able to calibrate the transition radiation threshold or use transition radiation for particle identification studies in these events. With this lowered HT, the probability of a straw signal crossing the HT is relatively high. A particle that leaves signals in 20 or 30 straws, which is required to reconstruct it as a track, will contribute a fraction of 28% in-time HT crossing hits for a Xe gas mixture at a HT of 50 DAC, and a fraction of 32% with Ar gas at a HT of 57 DAC,see Fig. 5, that occur on various front end boards.

The summed current signal produced by a group of DTMROCs is transmitted to a TTC-PP and the output of the comparator is sent to a TTC board in USA15 (with an amplitude of 2.5 V). As the signal is not digitized, this pulse is not synchronized with the beam clock and has a leading edge dependent on the arrival time of the cosmic ray and the subsequent drift time of the ionization electrons; the width is determined by (a) the time over threshold in the straw and (b) the time spread in individual pulses determined by the drift time in the straw and the variation in cable delays for various parts of the detector. While the variation of the propagation times from the DTMROCs to the TTC board within a TTC line is \(\sim\)5 ns (measured on an endcap TTC line with 12 DTMROCs) and cannot be compensated for, any TTC line dependent arrival time variations (mostly from variations in cable lengths) are compensated for on the TTC board as described in the next section.

Figure 5: The fraction of HT hits on a track from data recorded with the TRT Fast-OR trigger at a HT of 50 DAC in a Xe gas mixture in (a) and at a HT of 57 DAC in an Ar gas mixture in (b). The trigger logic configuration is described in Section 3 (Example configuration 1). The same settings are used for the evaluation in Section 5.

Trigger Logic on the TTC Board

The TTC boards that contain the trigger logic are physically located in VME crates in USA15, and, in terms of the trigger path, between the trigger crate equipment such as Local Trigger Processor (LTP), TTCvi and TTCex [16], and the FE electronics. The asynchronous LVDS trigger signal from the front end DTMROCs, described in Section 2, is input to the TTC board where it is (a) processed by a on-board trigger logic and output as 50 \(\Omega\) NIM signal, or (b) passed through unmodified to the VME backplane where an external trigger logic board can be connected (not implemented as of the writing of this note). The main difference is that option (b) permits making hit selections across multiple TTC boards which can help with developing global trigger decisions. This section focusses on the on-board trigger logic, case (a).

Figure 6 gives an overview of the TTC board logic (for details on the TTC board functionality see [11, 17]). Each input signal can be delayed by at most eight bunch crossings (8 BC) [18] in steps of \(\frac{1}{4}\) BC, to compensate for variations in signal propagation time from the front end. The signal then has to pass a requirement on its minimum width that can be configured to be between \(\frac{1}{4}\) BC and 2 BC. If the front end were configured to produce triggers from the LT, this would be needed to suppress trigger pulses from noise, that are usually narrower than pulses from tracks. A configurable set of TTC lines, out of the total of 40, can be selected as the input to the TTC logic ("total group"). The logic then generates an output signal (a NIM logic 1) if the number of TTC lines that carry an input signal is greater than or equal to the multiplicity \(M\) at any time within a window of 1-4 BC (the current configuration uses 1 BC). As an example, this functionality permits selecting tracks that leave hits in any straws associated to at least \(M=4\) TTC lines of the same TTC board, i.e. 4 (2) adjacent barrel (endcap) phi sectors (see Figs. 1 and 2). This multiplicity maximizes the purity of the data sample while keeping the trigger rate high. This configuration was used for the first ATLAS cosmics ray combined run and its results are evaluated in Section 5.

The following features of the TTC board logic permits a more sophisticated track selection, such as tracks that point towards the beamline: Before the trigger signal from the total group is sent from the TTC board, it can be selected, within the on-board logic, to be in coincidence or anticoincidence with (a) an external input signal, e.g. the Fast-OR output signal from another TTC board, or (b) each of the signals from at most 4 other "local groups." Each of these groups have a configurable set of TTC lines and multiplicity. As the anticoincidence bit effectively negates the output of a trigger group, a trigger is generated if the number of TTC lines with a signal is _less_ than \(M\). If the logic is passed, a NIM signal is generated that is sent to the LTP or the CTP for triggering. For a coincidence window of 1 BC the output signal is generated on the TTC board after a latency of 17-18 BC, depending on the clock edge on which it is latched.

Figure 6: The Fast-OR logic as implemented on a TTC board (taken from Ref. [19]). The number of TTC lines (“MTPC”) that are enabled (“IN_SEL”) in the trigger configuration and have a trigger pulse within the window “WIN” is compared (“CMP”) against a configurable multiplicity (“TOTAL_MTPC” for the “total group”). A subset of those lines (“GROUPN_SEL” for group N) can be selected to be compared to the multiplicity of group N (“GROUPN_MTPC”). The trigger decision of each group can be selected to be in (anti-)coincidence with the result of the “total group.” The “TRIGGER” output signal is a NIM signal that is sent either (a) to the NIM modules explained in Section 4, or (b) to another TTC board as input signal (“FAST INPUT FROM PREVIOUS TTC”) that can be selected to be in (anti)coincidence for a more sophisticated track selection.

## 4 Setup of Full System and CTP Connection

The NIM output signals from each TTC board are collected using various NIM modules that effectively generate a single NIM trigger pulse that is sent to the CTP. A schematic of the module setup in USA15 is shown in Figure 7. LeCroy\({}^{\textregisteredregistered}\) 429A Logic Fan-In/Fan-Out modules are used to OR the 48 endcap trigger lines in 1x16 mode for each A and C side, and in 2x8 mode for the barrel lines for side C. Another module is used in 2x8 mode (a) for barrel A side and (b) to collect the outputs of the other modules.

Endcap and barrel TTC boards run on clocks that are supplied by different LTPs and are phase-shifted by 8 ns. As the TTC trigger logic generates an output signal synchronous to its clock it is important that the clocks of the TTC boards are not phase-shifted to each other. This is achieved by selecting same-length fiber optic cables between TTCex and TTC boards and by delaying the trigger signal that comes from the barrel TTC boards using 50 \(\Omega\) cables and a delay module (with delays set to 0 ns).

The combined output signal is then routed into an LeCroy\({}^{\textregistered}\) 621CL Quad Discriminator to introduce a dead time of 3 BC to protect it from trigger pulses that are longer than one BC due to tracks that cross a large part of the detector and can generate triggers at different places along its propagation path. This dead time is achieved by sequentially extending the width of an incoming signal to 4 BC and shortening it to 22 ns, a width that is measured not to cause multiple firings in the CTP input. A LeCroy\({}^{\textregistered}\) 428F Linear Fan-In/Fan-Out module distributes the trigger signals to LTPs and to the CTP over a 96 ns cable.

Figure 8a shows the jitter of barrel A side trigger pulses for tracks that crossed both barrel sides (a multiplicity of 4 is required in TTC boards of each barrel part), with the falling edge of a barrel C side trigger pulse as a reference point at 0. The same for barrel C side with the A side as a reference in (b). As this measurement requires coincidence between barrel A and C side, it predominantly selects tracks that traverse both sides. Hence, there is a systematic time difference between the A side trigger signal and the C side trigger signal that comes from either front end due to the track propagation time that causes some fraction of A (C) side triggers to be in the neighboring BC compared to the C (A) side reference. For tracks with a propagation time of 3 ns this occurs in \(6\text{ns}/25\text{ns}=24\) % of cases (corresponding to a distribution with an RMS of 12 ns) which can dominate the distribution that has an RMS of 12.2 ns. This shows that the trigger jitter due to the granularity of the compensation delay in the TTC board of the signal propagation time from the front end (see Section 3) of \(\frac{1}{4}\) BC is negligible.

As the trigger signals have different propagation times through the TTC lines, as explained in Section 3, this effect has to be compensated on the TTC board using trigger signal delays. This alignment has been done iteratively based on a track data where the initial delay settings have been estimated using measurements of the TTC cable lengths. In each iteration the misalignment has been estimated using plots of HT bit and LT trailing edge of track hits in the readout data, such as Fig. 9, and then fed back to the trigger configuration. The figure shows the average position of the HT hit in the 3 BC readout window as a function of board and phi sector for the barrel detector only. While the trigger from the barrel detector is well aligned, the endcap timing-in is not finished as of this writing and is not shown.

The signal arrives at the CTP 42 BC after a track crossed the straw in the detector, well before the latest allowed arrival time at the CTP of 60 BC. This number matches roughly with expectations from propagation times through cables and delays. As the signal phase in the CTPIN is measured to be 10.16ns, the signal is latched on the positive clock edge.

Figure 7: A schematic of the trigger signal processing after the TTC board.

Figure 8: The jitter of trigger pulses from the A side of the TRT in (a) for tracks that crossed both barrel sides (\(M\geq 4\) is required in each barrel part), with the leading edge of a trigger pulse from the C side as a reference point at 0 (centered). (b) The same for barrel C side with the A side as a reference. On the upper half of each subfigure the trigger signals as they are collected by the oscilloscope, and on the bottom half a histogram that shows the distribution of the pulse trailing edges, accumulated over 1000 triggers in units of BC. The \(y\)-axis granularity of the bottom grid is 200 entries per division, and the granularity of the top grid is 25 ns (1 V) per division in \(x\) (\(y\)). Note that this measurement has been done in May 2009. The RMS of either distribution is 12.2 ns. The trigger jitter is estimated to be 12.2 ns\(/\sqrt{(}2)=8.75\) ns. The difference in the mean of the distributions of 2.9 ns is expected from the precision of the board-by-board timing alignment of 0.25 BC, see Fig. 9.

Figure 9: An estimate of the time alignment of the barrel trigger lines using the mean LT signal trailing edge on a track in units of BC in readout data for each TTC line and phi sector as a histogram, for A (a) and C (b) side separately. Red indicates an early and blue a late average trigger arrival time. Figures (c) and (d) show the same information in 1-dim. The RMS deviation of 0.06 ns (0.07 ns) on the A (C) side comes from the finite alignment granularity of \(\frac{1}{4}\) BC.

## 5 Results

This section presents results from the June 2009 combined run, as well as the first combined data taken with the rest of the Inner Detector in Nov 2008 for comparison. While both barrel and endcap were configured as shown in Example (1) in Section 3 to select tracks with both high rate and high purity [20], results in this section are presented only for the well timed-in barrel detector.

Figure 10 shows the number of "TRT-only" barrel tracks from the TRT offline monitoring set of histograms. A TRT-only track contains at least 20 TRT hits and makes no requirement on other Inner Detectors. The number of non-zero entries, i.e. the number of events triggered by the TRT Fast-OR that contain TRT tracks, gives an estimate of the trigger purity, if the reconstruction efficiency is neglected. In (a) a total of 375,969 events [21] were recorded in 47,407 s into the "IDCosmics" stream during the June combined run period (run 120413) which gives an average trigger rate of 7.9 Hz. Out of those, 369,282 contain a TRT-only track (98.2%). For comparison, Fig. (b) shows the same plot from the "TRTCosmics" stream of run 96903 from Nov. 2008, before the system had been timed in. The trigger rate was 8.6 Hz (575,596 events in 66,794 s) and the purity 94.1 % (541,916 events contain a TRT-only track).

The endcap trigger rate is \(\sim\)13 Hz, estimated from a June 2009 run (run 120981) that had the trigger configured for the full detector and resulted in a total trigger rate of 21.2 Hz (duration 35752 s, 759500 events in the "IDCosmics" stream), presumably \(\sim\)8 Hz of this coming from the barrel.

To estimate the efficiency for TRT-only reconstructed barrel tracks and investigate possible inefficiencies of the trigger, Figure 11 shows the highest number of TTC lines associated to a TTC board that are (a) crossed by a TRT-only track and (b) contain at least one straw with a HT hit in the readout. The figure contains tracks from events that are triggered by the Calorimeters ("L1Calo," black) or Fast-OR (dashed blue), where the triggers are not required to be in the same BC. Tracks that cross as many as 8 TTC lines per TTC board but do not generate a Fast-OR trigger could point to an inefficiency and need to be investigated. Entries with less than 4 TTC lines come from HT hits that are not inside the readout window. This can happen if the L1Calo trigger, that has a larger jitter occurred earlier than the Fast-OR and was used to trigger the event. With the ratio of these histograms the efficiency is estimated to 75%.

The fraction of Fast-OR-triggered tracks that traverse the SCT and Pixel detectors estimated from

Figure 10: The number of TRT-only tracks per event from the TRT offline monitoring set of histograms from data that has been triggered by the TRT Fast-OR. The number of non-zero entries is used to estimate the purity, i.e. the fraction of events that contain tracks, neglecting the track reconstruction efficiency: in (a) from the “IDCosmics” stream from run 120413 as part of the June combined run period, and in (b) from the “TRTCosmics” stream of run 96903, before the barrel has been timed in. The purity is 98.2% in (a) and 94.1% in (b), respectively.

Inner Detector offline monitoring histograms on the "TRTCosmics" stream of run 96903 that show the number of hits on "combined" tracks (if the reconstruction efficiency is neglected). A combined track traverses at least two subdetectors of the Inner Detector or only the TRT and is required to have, in the subdetector it traversed, at least 8 SCT, 1 Pixel and 15 TRT hits. Out of all combined tracks (684836) in this run, 25.7% (1.763\(\times\)10\({}^{5}\)) have a track reconstructed in the SCT and 4.4% (3\(\times\)10\({}^{4}\)) in the Pixel detector, as expected from their acceptance due to their size.

Figure 11: (a) The highest number of TTC lines associated with any barrel TTC board that contain at least one HT hit on a TRT-only track in the readout. The data in black is from the “L1_J5” stream of runs 121182 and 121198, taken with the L1Calo trigger as part of the June 2009 combined run. Events in this stream that were triggered by the Fast-OR, configured for the barrel, are shown in dashed blue; the triggers are not required to be in the same BC. (For this run, an Ar gas mixture was used and the HT hit fraction on tracks was \(\sim\)32%, see Fig. 5.) Using the ratio of these two histograms the efficiency is estimated to 75%. Figures (b) and (c) show the efficiency as a function of track variables impact parameter (\(d_{0}\)) and azimuthal angle (\(\phi_{0}\)). The trigger response is uniform as a function of \(\phi_{0}\) and has a slight variation as a function of \(d_{0}\), as it is less sensitive to tracks that traverse the region around the beamline, outside the TRT acceptance.

Simulation of the Fast-OR Trigger

In order to simulate the behavior of the TRT Fast-OR trigger and to estimate its efficiency under different trigger settings, a TrigT1TRT package was implemented in the ATLAS Athena offline software framework [22]. The package reads RDO (Raw Data Object) [23] raw TRT hits and mimics the trigger decisions as they are done in the front-end boards and the TTC boards hardware. Properties to define the source of the LVL1 trigger configuration, the source of the TRT RDO data that can be simulated or recorded, and values for the TTC line multiplicity \(M\) are provided.

From the LVL1 Configuration service the trigger name, value and cable position are obtained, so that the trigger decisions from the TrigT1TRT package can be directly fed into Athena trigger efficiency and trigger monitoring tools. An array, providing the mapping from phi sector ID and straw ID to the DTMROC ID, is obtained using TRT mapping packages.

For each event, the algorithm loops over all hits in the RDO. An array containing an element for each TTC line serves to count the number of hits per line. For hits with a difference between the trailing edge bin and the drift time bin of bigger than 4, the corresponding array element is incremented. This is done in order to replace the lowered HT signal in the hardware by using the LT signal with a more stringent time-over-threshold requirement in the software in order to use Monte Carlo data that is simulated with nominal HT settings. A second array, containing an element for each TTC line, is used to count the number of TTC boards that have more hits than \(M\). A final loop over a TTC array raises the trigger bit if at least one of its elements has more entries than defined by the TTC board multiplicity threshold. Default settings for the TTC line multiplicity is \(M=4\), and for the TTC board multiplicity it is 1, as these are the default settings in the hardware. The trigger decision is recorded in the transient event store, StoreGate [24].

Conclusion

Results have been shown from combined ATLAS runs with the Fast-OR trigger in June 2009 and Nov. 2008. With a total TRT trigger rate on cosmic ray tracks of \(\sim\)8 Hz and a track purity from offline reconstruction of 98%, the TRT Fast-OR trigger is the highest rate cosmic-ray trigger at ATLAS. Its efficiency for TRT-only reconstructed tracks in the barrel is estimated to 75% (using data from June 2009). As the trigger time jitter is only 8.75 ns it is used as a reference trigger for the timing adjustment of other detector systems. The total latency to the CTP is \(\sim\)42 clocks. Future upgrades are in preparation that include (a) utilizing the low threshold transition as a trigger signal such that high threshold calibrations are possible on Fast-OR-triggered data and (b) the implementation of an external trigger logic board for global trigger decisions.

## References

* [1] The ATLAS TRT Collaboration, "The ATLAS TRT Electronics," E. Abat et al., 2008 JINST 3 P06007.
* [2] N. Dressnandt, et al., "Implementation of the ASDBLR and DTMROC ASICS for the ATLAS TRT in DMILL technology," 6th Workshop on Electronics for LHC Experiments, Krakow, Sep. 2000.
* [3] The ATLAS Collaboration, "The ATLAS Experiment at the CERN Large Hadron Collider," 2008 JINST 3 S08003.
* [4] The ATLAS Collaboration, "ATLAS muon spectrometer: Technical Design Report," CERN-LHCC-97-022 (1997).
* [5] A. Di Caccio et al., "The ATLAS RPC trigger chamber system," Nucl. Instr. and Meth. A 572 (2007).
* [6] SX Oda, "Commissioning of the ATLAS level1 endcap muon trigger system," ATL-DAQ-PROC-2009-008.
* [7] R. Achenbach et al., "The ATLAS Level-1 Calorimeter Trigger," 2008 JINST 3 P03001.
* [8] After final tuning and adjustment, the RPC trigger is expected to be accurate to one bunch crossing, see [4].
* [9][https://twiki.cern.ch/twiki/bin/view/Atlas/TRTViewerManual](https://twiki.cern.ch/twiki/bin/view/Atlas/TRTViewerManual), the version as of May 2009 was used.
* [10] M. Hance et al., Readout of the ATLAS Transition Radiation Tracker: Data Structure and Detector Granularity. Technical Report ATL-COM-INDET-2008-005, CERN, Geneva, Mar 2008.
* [11] P. Wagner, "The TTC Hardware Library," [http://isscvs.cern.ch/cgi-bin/viewcvs-all.cgi/DAQ_doc/HW/ttc06/ttc_library_doc.pdf?root=trtdaq&view=co](http://isscvs.cern.ch/cgi-bin/viewcvs-all.cgi/DAQ_doc/HW/ttc06/ttc_library_doc.pdf?root=trtdaq&view=co).
* [12][http://www.hep.upenn.edu/atlas/dtmroc/dsm_dtmroc/DSM_DTMROC_Specs_v1_12.pdf](http://www.hep.upenn.edu/atlas/dtmroc/dsm_dtmroc/DSM_DTMROC_Specs_v1_12.pdf)
* [13][http://www.hep.upenn.edu/atlas/dtmroc/dsm_dtmroc/Fastout.PDF](http://www.hep.upenn.edu/atlas/dtmroc/dsm_dtmroc/Fastout.PDF)
* [14] M. Newcomer, "The ASDBLR and DTMROC Detector Mounted Readout for the ATLAS TRT," July 2 2003.
* [15] The noise turn-on curve as a function of HT is measured to be very steep such that setting the threshold a few DAC counts above the noise level produces a very quiet TTC line.
* [16] "LTP Hardware Manual" (EDMS document 551992), "TTC-VMEbus Interface (TTCvi)", [http://www.cern.ch/TTC/TTCviSpec.pdf](http://www.cern.ch/TTC/TTCviSpec.pdf), "TTC Laser Transmitter (TTCex, TTCtx, TTCmx) User Manual", [http://www.cern.ch/TTC/TTCtxManual.pdf](http://www.cern.ch/TTC/TTCtxManual.pdf)
* [17] "TRT-TTC Module," [https://twiki.cern.ch/twiki/bin/viewfile/Atlas/TrtDAQ?rev=1](https://twiki.cern.ch/twiki/bin/viewfile/Atlas/TrtDAQ?rev=1);filename=TTC05specs.pdf. Technical Report ATL-COM-INDET-2008-005, CERN, Geneva, Mar 2008.
* [18][http://mdobson.home.cern.ch/mdobson/tdaq/glossary.html](http://mdobson.home.cern.ch/mdobson/tdaq/glossary.html). "BC" stands for "bunch crossing" and refers to the time between two ATLAS clock signals (25 ns).