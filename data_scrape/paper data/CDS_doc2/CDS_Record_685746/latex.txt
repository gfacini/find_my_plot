ATLAS Internal Note

DAQ-NO-29

15 January 1995

**JET TRIGger RATES FROM FAST SIMULATIONS**

J. Bystricky

DAPNIA - CEA - Saclay

###### Contents

* 1 Introduction
* 2 Program components
	* 2.1 Generator
	* 2.2 Tracking volume
	* 2.3 Calorimeters
	* 2.4 Level 1 tables
* 3 Pile-up events and normalization
	* 3.1 \(\hat{p}_{\perp}\) interval normalization
	* 3.2 Pile-up events
	* 3.3 Normalization of histograms with pile-up events
* 4 Results
	* 4.1 Jet rates
	* 4.2 Missing \(E_{T}\)

## 1 Introduction

The Monte Carlo program ATLASIM was written on an IBM 9021-820 running a VM/XC operating system at the IN2P3 Computing Center in Lyon to simulate, quickly and yet with a sufficient precision, the response of the ATLAS detector to minimum-bias dijet events of the LHC. The speed of the simulation is achieved mainly by the following factors.

* A constant magnetic field is assumed inside the solenoid so that the trajectories of charged particles are helices.
* Calorimeters are defined as simple volumes of homogeneous materials and the energy deposit is parametrized.
* Dijets are generated in several intervals of the hard process transverse momentum \(\hat{p}_{\perp}\). Histograms generated in different intervals are weighted and added together. Rates may thus be calculated with a good precision over a large range of cross sections.

Program components

### Generator

PYTHIA 5.706 with JETSET 7.404 [1] were used to generate events in the present study. Different choices of parameters and proton structure functions lead to somewhat different spectra of generated dijets. Default values of PYTHIA were changed for some of them following the ATLAS convention:

* \(MST\,P(2)=2\) to calculate the strong coupling constant \(\alpha_{s}\) to second order;
* \(MST\,P(33)=3\) to scale the \(Q^{2}\) argument of \(\alpha_{s}\) by the K-factor = 0.075 (PYTHIA default value);
* \(MST\,P(81)=1\) and \(MST\,P(82)=1\) to include multiple interactions assuming the same probability in all events with a cut-off of the cross section at \(p_{\perp min}=1.40\ GeV/c\). \(MST\,P(82)\) values 2, 3 or 4 assume a varying impact parameter but they caused occasional program interruptions inside the generator, so they were not used.

PYTHIA 5.706 offers a choice of 11 proton structure functions. The program default changed from the functions EHLQ1 [2] in PYTHIA 5.702 to CTEQ2L [3] in the present generator version. Both of them are leading-order fits to parton distributions and they differ mainly in the low-\(x\) region [4]. A comparison of dijet cross sections generated by EHLQ1 and CTEQ2L are shown in Figure 1 and in Table 1. Structure functions CTEQ2MS [3], the results of which are also shown in Figure 1 and Table 1, are singular at small \(x\) and give the largest total cross section.

These structure functions give different results mainly at low \(\hat{p}_{\perp}\). The current PYTHIA structure function default CTEQ2L was used in the present study.

### Tracking volume

The material in the tracking volume is only taken into account by allowing for electron bremsstrahlung and \(e^{+}e^{-}\) pair production by photons. The bremsstrahlung simulation was adapted from subroutines provided by S.Dasu [5] and the pair production program was written by P.Bonamy [6] following GEANT code. Multiple scattering and energy loss were not simulated.

The beam pipe, tracking volumes and solenoid coils were simulated by 9 cylindrical volumes with different material constants (see Table 2). The tracking volume constants were adjusted to

\begin{table}
\begin{tabular}{|r|r|r|r|} \hline \(\hat{p}_{\perp\mathrm{min}}\) & & & \\ \((\,GeV\!/c)\) & EHLQ1 & CTEQ 2MS & CTEQ2L \\ \hline \hline
4.6 & 53.12 \(\mathit{mb}\) & 131.4 \(\mathit{mb}\) & 75.55 \(\mathit{mb}\) \\
25 & 0.39 \(\mathit{mb}\) & 0.39 \(\mathit{mb}\) & 0.34 \(\mathit{mb}\) \\
50 & 32 \(\mathit{\mu}\,b\) & 28 \(\mathit{\mu}\,b\) & 26 \(\mathit{\mu}\,b\) \\
100 & 2.1 \(\mathit{\mu}\,b\) & 1.7 \(\mathit{\mu}\,b\) & 1.6 \(\mathit{\mu}\,b\) \\
200 & 102 \(\mathit{nb}\) & 85 \(\mathit{nb}\) & 81 \(\mathit{nb}\) \\
300 & 17 \(\mathit{nb}\) & 12 \(\mathit{nb}\) & 13 \(\mathit{nb}\) \\
400 & 3.6 \(\mathit{nb}\) & 3.1 \(\mathit{nb}\) & 3.0 \(\mathit{nb}\) \\ \hline \end{tabular}
\end{table}
Table 1: PYTHIA dijet cross section for various structure functionsreproduce roughly the "Panel layout" geometry and the radiation length \(x_{{}_{\circ}}\) dependence on the pseudorapidity \(\eta\)[7]. Figure 2 shows the resulting radiation length at 40 cm and for the whole tracking volume including the beam pipe.

### Calorimeters

The energy of particles reaching the electromagnetic or hadronic calorimeters was smeared using the energy resolution expected in the ATLAS calorimeters. Electron- and photon-induced electromagnetic showers started as soon as the particle entered a dense matter. For hadrons the interaction point was randomly chosen using an exponential probability distribution. The longitudinal and transverse shower profiles were then simulated following the program of G.Sullivan [8] based on the CDF electromagnetic and hadronic shower parametrisation [9]. The average longitudinal shower profile and the fluctuations of the energy deposited in each calorimeter segment were simulated. The centroid of the shower was considered as a particle travelling in the same direction as the original particle. At each step the energy was deposited in a number of points of the transverse plane following parametrized transverse profiles.

The number of interaction lengths in the inner detector and in the electromagnetic and hadronic calorimeters as a function of pseudorapidity is shown in Figure 3. It corresponds well to the similar dependence shown in ref. [10], which was calculated by a full GEANT simulation for muons passing through the calorimeters and the muon shielding. The muon shielding is however not simulated in the present study, so there is a shift between the curves in Figure 3 and in ref. [10].

### Level 1 tables

The energy deposited in the calorimeters were stored in calorimeter tables. The granularity of the level 1 electromagnetic and hadronic calorimeter tables in the space \(\phi-\eta\) was \(.1\times.1\) for the barrel and endcap (\(|\eta|<3\)) and \(.2\times.2\) for the forward calorimeters (\(3<|\eta|<5\)). To each electromagnetic cell and to each forward hadronic calorimeter cell a normally distributed random electronic noise with the variance of 0.28 GeV was added and all cell contents were changed to \(E_{T}\). Then pile-up event tables were chosen (see the following Section) and added to the level 1 tables, the content of each cell was truncated to an integer number of GeV and the

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline Volume & \(r\)-range (cm) & \(z\)-range (cm) & material Z & material A & \(x_{{}_{\circ}}\) (cm) & \(x_{{}_{\circ}}/\lambda_{I}\) \\ \hline \hline
1 & 2.5 - 2.6 & 0 - 14000 & 4 & 9.01 & 35.3 & 0.4073 \\
2 & 8 - 20 & 0 - 35 & 14 & 28.09 & 600 & 0.3091 \\
3 & 8 - 20 & 35 - 37 & 6 & 12.01 & 1200 & 0.4948 \\
4 & 18 - 20 & 38.2 - 65 & 6 & 12.01 & 66.67 & 0.4948 \\
5 & 20 - 100 & 0 - 80 & 14 & 28.09 & 444.44 & 0.3901 \\
6 & 20 - 40 & 80 - 160 & 14 & 28.09 & 333.33 & 0.3901 \\
7 & 40 - 80 & 80 - 82 & 6 & 12.01 & 20 & 0.4948 \\
8 & 40 - 100 & 82 - 330 & 14 & 28.09 & 66.67 & 0.3901 \\
9 & 116.1 - 134.1 & 0 - 265 & 13 & 26.98 & 20 & 0.2257 \\ \hline \end{tabular}
\end{table}
Table 2: Beam pipe, tracking volumes and coil material parameterselectromagnetic and hadronic tables were summed up.

To study the jet rates, tables of several region types were created for \(|\eta|<3\). The regions, caracterized by their \(\phi-\eta\) windows and by the window sliding, were

* \(.2\times.2\) with the window sliding by \(.2\)
* \(.4\times.4\) with the window sliding by \(.2\)
* \(.6\times.6\) with the window sliding by \(.2\)
* \(.8\times.8\) with the window sliding by \(.4\)
* \(.4\times.4\) with the window sliding by \(.1\)

The sliding was the same in both variables. The highest local maxima in each table provided the jet energy recorded in the histograms.

## 3 Pile-up events and normalization

### \(\hat{p}_{\perp}\) interval normalization

For the energy of 14 TeV the dijet cross section is estimated to be 71 mb [11]. The lower limit of \(\hat{p}_{\perp}\) was chosen to be 4.6 \(GeV/c\) for which the total dijet cross section as given by PYTHIA is 7.55 \(mb\). The \(\hat{p}_{\perp}\) domain was divided into 7 intervals as shown in Table 3. The weights are cross section in \(\mu b\) divided by the number of events in each interval, which would yield histograms in \(\mu b\) or in \(kH\,z\) for the luminosity of \(10^{33}\)\(cm^{-2}s^{-1}\).

### Pile-up events

In the present study we simulated only pile-up events from the same bunch crossing as the trigger dijet, i.e. we neglected the contamination from neighbour crossings.

Considering the dijet cross section of 71 mb and the bunch-crossing rate of 40 MHz, the low luminosity of \(10^{33}\)\(cm^{-2}s^{-1}\) implies a mean number of 1.8 dijet events per crossing, and the high luminosity of \(10^{34}\)\(cm^{-2}s^{-1}\) implies 18 dijet events per crossing. The event with the highest \(\hat{p}_{\perp}\) is considered as the trigger dijet, and the other 0.8 or 17 dijets are pile-up events. Note that the present situation is different from a fixed target experiment where the time during which pile-up

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline \(\hat{p}_{\perp}(GeV/c)\) & cross section & number of events & weight \\ \hline \hline
4.6 - 10 & 68.45 \(mb\) & 2814 & 24325 \\
10 - 25 & 6.77 \(mb\) & 2623 & 2576.1 \\
25 - 50 & 0.31 \(mb\) & 2469 & 126.5 \\
50 - 100 & 24 \(\mu b\) & 2000 & 11.99 \\
100 - 200 & 1.55 \(\mu b\) & 2000 & 0.773 \\
200 - 400 & 78 \(nb\) & 2000 & 0.388 \\ \(\geq\) 400 & 3 \(nb\) & 2000 & 0.015 \\ \hline \end{tabular}
\end{table}
Table 3: \(\hat{p}_{\perp}\) intervalsevents are recorded is started by the trigger event and the number of pile-up events would be 1.8 and 18, respectively.

To simulate the pile-up events, four files corresponding to the first three \(\hat{p}_{\perp}\) intervals from Table 3 and to \(\hat{p}_{\perp}>50\,GeV/c\) were created. Each record of the files contained calorimeter tables of one pile-up event. All together 2000, 1500, 1000 and 500 events were recorded on the four files respectively. For each generated trigger event the number of pile-up events was randomly chosen following the Poisson distribution. The cross section was used to choose one of the four files and randomly chosen calorimeter tables were read from the file and added to the tables created for the trigger dijet. For a typical run with 2000 dijet triggers and 17 pile-up events, every pile-up event from each of the four files was used, on average, 15.38, 2.06, 0.14 or 0.02 times, respectively. Several pile-up interval files were used in order to avoid a multiple use of higher \(\hat{p}_{\perp}\) events which, multiplied by large weights, would create artificial bumps in the histograms.

For the same reason, events with \(\hat{p}_{\perp}\)(trigger) \(<\)\(\max\hat{p}_{\perp}\)(pile-up) were rejected in the simulation and accounted for in the overall normalization of the appropriate higher \(\hat{p}_{\perp}\) interval. This renormalization was possible because the pile-up events are of the same kind as the trigger dijets.

### Normalization of histograms with pile-up events

Let us introduce the following notations and specify the meaning of some expressions.

\begin{tabular}{l l} \(N\) & number of dijet interactions per second \\ \(B\) & number of bunch crossings per second \\ \(\lambda\) = \(N/B\) & mean number of events in a crossing \\ \(p_{n}\) = \(p_{n}\)(\(\lambda\)) = \(\lambda^{n}e^{-\lambda}/n!\) & Poisson probability to get \(n\) events in a crossing \\ \(p_{n}\)(\(\lambda\)) & probability to observe an empty crossing \\ \(B(1-p_{0}\)(\(\lambda\))) & number of non-empty crossings per second \\ \(t_{i}\) & probability to get a dijet event in the \(i-\)th \(\hat{p}_{\perp}\) interval provided a dijet was generated \\ \(s_{i}\) = \(\sum_{j=1}^{i}t_{j}\) & probability to get an event in the interval \(i\) or below \\ \(r_{i}\) = \(r_{i}\)(\(\lambda\)) = \(\sum_{n=0}^{\infty}p_{n}s_{i}^{n}\) = \(e^{\lambda(s_{i}-1)}\) & probability to get all events of a crossing in \(i\) or below \\ \(r_{0}\) = \(p_{0}\) & \\ \(N_{i}\) & number of dijet triggers accepted in the \(\hat{p}_{\perp}\) interval \(i\) \\ \end{tabular}

It follows that the weight of events in the \(i\)-th \(\hat{p}_{\perp}\) interval is

\[W_{i} = B\ \frac{r_{i}-r_{i-1}}{N_{i}}.\]

Table 4 shows the weights and rates of accepted events in \(\hat{p}_{\perp}\) intervals defined in Table 3. Note also that 16.5% of the 40 MHz bunch crossings are expected to be empty for the low luminosity while for the high luminosity practically all crossings yield dijet events.

## 4 Results

### Jet rates

Figure 4 shows comparison of jet rates between the different regions for the low luminosity. The region \(.6\times.6\) cannot be distinguished, on the scale of Figure 4, from the region \(.8\times.8\). A

closer comparison is shown in Figure 5, where the rates for the regions \(.2\times.2\), \(.4\times.4\) and \(.6\times.6\), all of them with the window sliding by \(.2\), were divided by the rates for \(.8\times.8\). All ratios are to a good precision independent of the threshold. This is also true for the dijet rates as shown in Figure 6. The dependence of the ratio on the region width, for the most energetic and for the second jet, is shown in Figure 7. The fitted curve should not, strictly speaking, pass through 1 at the width 0.8 because the rates for the \(.8\times.8\) regions were determined with the window sliding by 0.4 and not by 0.2 as for the other regions. A similar curve for the high luminosity is shown in Figure 8 for which the ratios are only slightly lower than in Figure 7.

The ratio of the rates for the regions \(.4\times.4\) with the window sliding by \(.2\) to the rates for the same regions with the window sliding by \(.1\) is shown in Figure 9. The ratio is well fitted by the constant value 0.94 which is the same for both low and high luminosity.

Jet rates for the regions \(.8\times.8\) are shown in Figures 10 and 11 with the low \(\hat{p}_{\perp}\) region detailed in Figures 12 and 13. The number of jets per crossing is shown in Figures 14 and 15 for the low and for the high luminosity, respectively.

### Missing \(E_{t}\)

The rate of inclusive missing \(E_{t}\) for \(|\eta|<3\) and for \(|\eta|<5\) is shown in Figures 16 and 17, respectively.

## Acknowledgements

I would like to thank my collegues who offered me gracefully their computer codes, namely G.Sullivan, S.Dasu and P.Bonamy. Fruitful discussions with Dick Hubbard helped me throughout the present work and were much appreciated.

## References

* [1] T.Sjostrand, Computer Physics Commun. **82** (1994) 74
* [2] E.Eichten, I.Hinchliffe, K. Lane and C.Quigg, Rev.Mod.Phys. **58** (1985) 1065

\begin{table}
\begin{tabular}{|r|r|r|r|r|r|r|} \hline  & \multicolumn{4}{c|}{\(\lambda=1.8\)} & \multicolumn{4}{c|}{\(\lambda=18\)} \\ \cline{2-7} \(\hat{p}_{\perp}(GeV/c)\) & accepted & weight & rate & accepted & weight & rate \\  & events & & (kHz) & events & & (kHz) \\ \hline \hline
4.6 - 10 & 1845 & 14720 & 27159 & 49 & 150200 & 7361 \\
10 - 25 & 2543 & 2323 & 5908 & 1315 & 22470 & 29544 \\
25 - 50 & 2467 & 120 & 296.3 & 2403 & 1186 & 2851 \\
50 - 100 & 1999 & 11.4 & 22.8 & 1996 & 114 & 228 \\
100 - 200 & 2000 & 0.74 & 1.47 & 1999 & 7.37 & 14.7 \\
200 - 4 00 & 2000 & 0.037 & 0.074 & 2000 & 0.37 & 0.74 \\ \(\geq\) 4 00 & 2000 & 0.001 & 0.003 & 2000 & 0.014 & 0.03 \\ \hline total & & & 33388 & & & 40 000 \\ \hline \end{tabular}
\end{table}
Table 4: Jet rates with pile-up