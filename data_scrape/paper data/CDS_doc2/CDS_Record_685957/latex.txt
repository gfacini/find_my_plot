**ATLAS Internal Note**

**INDET-NO-111**

**8 September 1995**

**Second Level Triggering In the Forward Region**

**of the ATLAS Inner Tracker**

**Sergey Sivoklokov**

Institute of Nuclear Physics, Moscow State University, Moscow, Russia.

**Reinier Dankers**

NIKHEF, Amsterdam, The Netherlands.

**John Baines**

Rutherford Appleton Laboratory, Chilton, Didcot, UK.

## 1 Introduction

The specification for the ATLAS inner detector, as stated in the Technical Proposal [3], calls for the following level 2 trigger performance at high luminosity:

To select isolated tracks with \(\mbox{p}_{t}\,>\) 20 GeV/c with \(>\)90% efficiency, in regions of interest defined by the level 1 trigger, and ensure a fake rate of less than 10% per real track for QCD tracks passing the level 1 and level 2 calorimeter triggers.

The input to the Level 2 trigger originates from several different components; TRT, barrel Si layers, forward MSGC and GaAs wheels and barrel and forward Pixel layers. In the simplest scheme for the level 2 architecture, an initial level 2 decision will be made based on the information from each component separately, this information will then be passed on for a global level 2 trigger decision.

The level 2 performance of the TRT [1] and of the barrel Si layers [2] has been described elsewhere. Here the stand-alone performance of the MSGC part of the forward tracker is described. Results are presented on efficiency for high \(\mbox{p}_{t}\) muons and electrons, with and without the addition of pile-up. The rejection power against jets is considered when the MSGC level 2 trigger information is combined with that from the level 2 ECAL trigger.

## 2 The forward geometry

For this study the inner detector layout described in the ATLAS technical proposal [3] has been used. The MSGC detectors are arranged in 12 small wheels and 1 large

[MISSING_PAGE_EMPTY:2]

wheel in each end-cap. The small wheels are positioned inside the TRT between z = 90.0 cm and z = 265.6 cm. The large wheel is located between the TRT and the end-cap calorimeter at z = 334.5 cm. Each wheel consists of three layers of detectors, a \(\phi\) layer, and two 'u', 'v' stereo layers at \(\pm 1^{\circ}\). The layers are overlapped so as to give full coverage with at least 2 of the 3 layers. The large wheel has three concentric rings of detectors 16cm long extending from r = 50 cm to r = 96 cm; the small wheels consists of a single ring covering r = 44 cm to r = 60 cm, see Fig. 1. Further details of the MSGC layout can be found in [5].

The 'TP' specification calls for 6 precision measurements along a track for all \(|\eta|<2.5\). Two of these measurements are provided by the pixel layers, which are not part of this study. The other 4 measurements are made by a combination of the barrel Si layers, the forwards MSGC wheels and the GaAs wheels, see Fig. 2.

As a result of this design, from the point of view of triggering, the \(\eta\) range can be considered in the following regions:

* \(|\eta|<1.0\) : Barrel region (Si)
* \(1.2<|\eta|<1.5\) : Transition from barrel to forward geometry (Si and MSGC)
* \(1.5<|\eta|<2.1\) : Forward region (MSGC)
* \(|\eta|>2.1\) : Forward region (MSGC and GaAs)

Here results are presented for the standalone performance of the MSGC trigger in the \(\eta\) range 1.5 \(<|\eta|<2.05\).

## 3 The Feature Extraction Algorithm

The purpose of the Level 2 Feature Extraction Algorithm is to search for a high p\({}_{t}\) track within a region of detector identified by the level 1 trigger system. If the search is successful, the parameters of the track are passed on to the global level 2 system. The level 2 algorithm should have high efficiency for finding isolated high \(p_{t}\) tracks, but in conjunction with the level 2 ECAL, should provide good rejection against false triggers from jets.

Several different approaches to providing a 2nd level trigger have been explored for other components of the inner detector. For the TRT, which measures many (\(\sim\)30) relatively low precision points, a histogramming method has been studied [1], [7]. For the Barrel Si (4 high precision layers) a pattern recognition algorithm searches for tracks in a window and performs a least squares fit to select the best track candidate [10]. The former method has the advantage that the number of calculations scales linearly with the number of hits, rather than quadratically as in the case of the Si algorithm. An implementation of a histogramming method for the Si barrel has also been studied [11]. This suggests that similar results can be obtained with this approach. It was, therefore, chosen as the starting point for the MSGC trigger.

The implementation of the algorithm for the MSGCs differs in detail from that used for the TRT due to the more complex structure with stereo ('u' and 'v') as well as radial (\(\phi\)) layers. Use is made of the information from all layers.

The calorimeter level 1 trigger gives a'region of interest' of size \(\Delta\eta~{}\times~{}\Delta\phi~{}=~{}0.3~{}\times~{}0.3\). This together with the vertex position defines the area of the MSGC detector to be searched for high \(p_{t}\) tracks. The search is performed in the \(\phi\)/z plane. In this plane tracks are represented by straight lines of gradient \(\alpha\), intercept \(\phi_{0}\). The hits in the \(\phi\)/z plane are transformed to a histogram in the \(\alpha/\phi_{0}\) plane (Hough transform). The number of entries in a given bin, j, of the histogram represents the number of hits along the track candidate characterised by the (\(\alpha^{j}\), \(\phi_{0}^{j}\)) of that bin. The bin with the most entries is chosen as the best track. In case of ambiguity, the highest \(p_{t}\) candidate is chosen. The \(p_{t}\) of the track is inversely proportional to \(\alpha\) for uniform magnetic field B:

\[p_{t}=1.5~{}B\cdot\tan(2~{}tan^{-1}(e^{-\eta}))\cdot\frac{1}{\alpha}\]

If there are at least 8 hits in the chosen bin, and the \(p_{t}\) is greater than or equal to the threshold of 30 GeV/c the track is taken as passing the trigger requirements.

### Implementation of the Algorithm

The first step is to pre-process the hit information into a representation in the \(\phi\)/z plane:

* '\(\phi\)' hits are represented by a single point in this plane.
* a pair of hits from crossing 'u' and 'v' strips are represented by a pair of points at the \(\phi\) of the crossing point. In the case of ambiguities arising from two or more close tracks all ambiguities are used.
* a hit on a 'u'('v') strip that does not have an associated hit on a 'v'('u') strip is represented by several points at intervals of \(\Delta\phi~{}=~{}0.5\) mrad corresponding to positions at intervals along the strip.

The Hough transform to a 2 dimensional \(\alpha\) / \(\phi_{0}\) histogram is then defined. A maximum slope, \(\alpha_{max}\) is determined from the above formula using the minimum \(p_{t}\) for the search (10 GeV/c) and the \(\eta\) of the ROI as given by level 1. The range from \(-\alpha_{max}\) to \(+\alpha_{max}\) is divided into N\({}_{\alpha}\) (= 90) bins. At \(\eta~{}=~{}2\) the bin width is \(\Delta\alpha~{}\approx~{}0.002\), which corresponds to \(\Delta p_{t}~{}\sim\)3 GeV/c for a track with a \(p_{t}\) of 30 GeV/c. The range of \(\phi_{0}\) is defined to be the \(\phi\) range of the ROI as given by level 1. The bin size is \(\Delta\phi_{0}~{}=~{}0.5\) mrad, equivalent to a granularity of 1 strip pitch. This gives \(\sim\)600 bins in \(\phi_{0}\).

[MISSING_PAGE_EMPTY:5]

Figure 3: Trigger performance for single muons (solid line) and single muons with 27 min bias events (dashed line). Top: Triggering probability as a function of \(\rm p_{t}\). Bottom: Trigger efficiency as a function of \(\eta\) (lower plot).

The effect of the pile-up is to degrade the reconstructed \(p_{t}\) resolution, resulting in broader threshold width. As the algorithm chooses the highest \(p_{t}\) track in the case of ambiguity, the effect is to increase the probability of a low \(p_{t}\) track giving a trigger. Thus, pile-up increases the fraction of muons that give a trigger.

The trigger efficiency is defined to be the the fraction of muons with true \(p_{t}>30\) GeV/c that pass the trigger requirements. The average efficiency values for the region \(1.5<\ \eta\ <2.05\), with and without pile-up, are given in table 1. The efficiency is show as a function of \(\eta\) in the lower plot of Fig. 3. The MSGC coverage starts at \(|\eta\ |\sim\)1.3. In the region \(1.45<|\eta|<1.65\) where only 3 MSGC wheels are traversed by a track the efficiency is \(\sim\)90%. It rises to \(\sim\)95% in the region of 4 hit coverage out to \(|\eta|\sim\)2.0, falling off rapidly at higher \(\eta\). In this high \(\eta\) region the information from the GaAs must be combined with that from the MSGC detector.

### Single Electrons

The trigger performance for single electrons was determined from a sample of 337 electrons in the region \(1.5<\ |\eta|\ <2.05\) with \(p_{t}\) between 10 and 100 GeV. The probability of an electron giving a trigger is shown as a function of \(p_{t}\) in the top plot of Fig. 4. Again pile-up broadens the threshold and increase the number of triggers from low \(p_{t}\) tracks. The trigger efficiency is shown as a function of \(\eta\) in the lower plot. The efficiency is lower that that for muons due to the effects of bremsstrahlung. The results are summarised in table 1.

### Jets

A sample of jet events passing the level 1 trigger criteria were used to determine the rejection power of the trigger algorithm against jets. Results are given for jet events plus 27 minimum bias events. The sample contained 53 events in the region \(1.5<\ |\eta|\ <2.05\). Of these events, 77 \(\pm\) 6 % were rejected by the MSGC trigger algorithm.

The performance in conjunction with the level 2 calorimeter trigger was also studied. The calorimeter algorithm was that described in [2] with the following thresholds:

\[E_{core}\ >\ 40\ GeV,\ \ \ \ \ \ \ \ \frac{E_{inner}}{E_{core}}\ <\ 0.25,\ \ \ \ \ \ \frac{E_{outer}}{E_{core}}\ <\ 0.1\]Figure 4: Trigger performance for single electrons (solid line) and single electrons with 27 min bias events (dashed line) Top: Triggering probability as a function of p\({}_{t}\). Bottom: Trigger efficiency as a function of \(\eta\).

\(\text{E}_{inner}\) and \(\text{E}_{outer}\) are the transverse energies in 4 \(\times\) 4 and 6 \(\times\) 6 square isolation rings surrounding the 2 \(\times\) 2 core.

The level 2 calorimeter trigger algorithm alone rejected 64 \(\pm\) 7 % of jets. Together with the MSGC trigger, 87 \(\pm\) 5% of jets were rejected.

## 5 Online implementation and Bench Marking

The motivation for the development of the algorithm described above came from the implementation of similar algorithms for the SCT and TRT on Programmable Active Memory (PAM) boards [7], [11]. These studies concluded that, for a 64 \(\times\) 32 histogram, the required event frequency of 100 kHz could be attained.

As a complimentary study, the implementation of the algorithm on a general purpose processor has been investigated. A stand-alone version of the code written in C has been developed and initial timing measurements made on HP 9000/750 and C40 processors.

The use of a general purpose processor allows a slightly different approach from that described above. After the maximum bin of the histogram is chosen, a least squares fit is performed to select the best track candidate and calculate a final \(\text{p}_{t}\) value. The fit is performed separately in the \(\phi\)-z plane using the '\(\phi\)' layer hits and in the r-z plane using the information from the stereo layers. This allows a coarser binning to be used for the Hough transform, reducing the histogram size at the price of the extra computation required for the fit. The choice of bin size, which determines the relative times spent in histogramming and fitting, depends on the occupancy and details of the implementation such as memory size and speed. This method has some advantages over the original method in that it provides a goodness of fit parameter that can be used to choose between track candidates in the case of ambiguity. It also provides a more accurate \(\text{p}_{t}\) measurement which will improve the discrimination around the \(\text{p}_{t}\) threshold and may increase efficiency and jet rejection, however these studies have yet to be made.

Results of the timing studies are shown in table 2 for low occupancy, and for the occupancy of 1.8% expected at design luminosity. Measurements were made for two granularities corresponding to 1 strip or 10 strips. The bin size in slope was derived

\begin{table}
\begin{tabular}{c|c|c|c|c|c} \hline Granularity & Occupancy & Preprocessing & Hough Transform & LS fit & Total \\ (Strips) & (\%) & Time (\(\mu\)s) & Time (\(\mu\)s) & Time (\(\mu\)s) & Time (\(\mu\)s) \\ \hline \hline
1 & 0.2 & 230 & 1500 & 190 & 1920 \\
1 & 1.8 & 6200 & 106700 & 650 & 113550 \\
10 & 0.2 & 230 & 90 & 190 & 510 \\
10 & 1.8 & 6200 & 1500 & 750 & 8450 \\ \hline \end{tabular}
\end{table}
Table 2: Timing measurements on HP 9000/750from the \(\phi\) bin size:

\[\Delta\alpha\ =\ \alpha_{max}\cdot\frac{\Delta z}{\Delta\phi}\]

where \(\Delta z\) is the distance along z between the first and last point. These measurements should not be taken as a direct prediction of the performance of the algorithm in the online environment, but give an indication of the likely best strategy on a general purpose processor. There is scope for optimization of the code especially for higher occupancy. The results suggests that the best performance would be obtained by using a Hough transform with a coarse binning to identify a small region in which a LSQ fit is performed.

## 6 Discussion and future work

The MSGC detector provides a stand alone track trigger with an efficiency of \(94.2\pm 1.8\%\) for muons and \(80.8\pm 2.3\%\) for electrons in the region \(1.5<\ |\eta|\ <2.05\). The fake rate is 23 \(\pm\) 6 % for the MSGC alone and 13 \(\pm\) 5% in conjunction with a level 2 calorimeter trigger. It is expected that the rejection could by improved by imposing matching requirements between the track parameters measured in the colorimeter and MSGC detectors. This will be studied.

These results represent the stand alone performance of a MSGC trigger. It is planned to extend this study to include the GaAs wheels and to investigate the possibility of including information from the end-cap Pixel detectors. The inclusion of GaAs information will extend the trigger coverage out to \(|\eta|\ =2.5\), whilst the pixel information is expected to improve the performance over the whole \(\eta\) range.

It is planed to study the implementation of the MSGC trigger algorithm in the online environment. Solutions based on the use of Programmable Active Memory boards (eg. DecPeRLe-1) and general purpose processors (eg. C40) will be investigated both independently and as a combined solution.

The implimentaion on a PAM would be similar to that described for the SIT in [11]. This work suggests that the necessary rates can be achieved for the Hough transform. However, the points to be addressed for the MSGC implementation are the feasibility of implementing the pre-processing step and ways of reducing the size of histogram required. The implementation for the SIT used 64 slopes and 32 angles. This is considerably smaller than the histogram size of 90 x 600 used in this study. The effect of a coarser granularity must be investigated. Additionally, it may also be possible to perform the Hough transform in two stages; a pass at course granularity to identify a region for a second pass using finer steps. If these problems can be solved, this method promises the best rate performance.

For the solution based on a general purpose processor, the most efficient implementation in terms of speed and memory use must be found. If the required rates can be achieved, this solution offers greater flexibility. The extra information provided by a least squares fit might be expected to improve matching to the calorimeter and facilitate the correct choice in the case where more than one histogram bin passes the trigger requirements.

A combined solution has many attractions. The pre-processing step and a coarse binded Hough transform would be implemented on a PAM. This would identify a small region in which to perform a least squares fit. This would combine the better rate capability of the Hough transform for processing large numbers of hits with the power of the general purpose processor to extract the information from a small region. The implementation details and cost effectiveness of such a solution must be studied.

## 7 Conclusion

This study represents a first look at a trigger algorithm for the forward region of the ATLAS detector. Using the MSGC information alone, good performance was obtained in terms of efficiency for high p\({}_{t}\) tracks and rejection against jets. When combined with the information from the Pixel and GaAs detectors and including matching with the calorimeter, it is anticipated that the specification targets will be attained. Further refinements are under study and a corresponding improvement in performance is expected. Work has started on an online implementation of the algorithm, this will be an area of increasing importance for future studies.

## References

* [1] "A TRT Algorithm Implementation Suggested for the Beam Test in June 1994", L. Lundheim. EAST internal note EAST94-02
* Second Level Electron Triggering in the ATLAS Inner Detector", R.J. Hawkings and A.R. Weidberg. ATLAS Internal note INDET-NO-052 (1994)
* [3] ATLAS Technical Proposal CERN/LHCC/94-43
* [4] "Inner Detector Layout for Technical Proposal", J.Baines et. al., ATLAS Internal Note INDET-NO-066
* Support Document for the Micro Strip Gas Counter Subsystem", ATLAS MSGC group. ATLAS internal note INDET-NO-076 (1994)
* [6] "Electron Triggering in the Transition Region of the ATLAS Inner Detector", R.J. Hawkings. ATLAS internal note INDET-NO-096 (1995)
* [7] "TRT on DecPeRLe-1 (June '94 version): Algorithm, Implementation, Test and Future", L. Lundheim, L. Moll, P. Boucard, J. Vuillemin. EAST internal note EAST94-20
* [8] PYTHIA 5.6 H.U. Bengtsson and T. Sjostrand, Computer Physics Commun. **46** (1987) 43.