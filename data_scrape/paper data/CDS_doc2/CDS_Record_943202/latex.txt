Comparison between full and fast simulations in top physics

**F. Hubaut, E. Monnier, P. Pralavorio, B. Resende, C.Zhu1**

Footnote 1: On leave from Department of physics, Shandong Univ., Jinan, Shandong, China

Centre de Physique des Particules de Marseille, CNRS/IN2P3 - Univ. Mediterranee,

Marseille - France

**Abstract**

All analyses performed in the top quark sector with a full simulation of the ATLAS detector show a good agreement with fast simulation results. The purpose of this note is to understand why detailed detector effects are not so crucial in these studies. A systematic comparison, based on a "Rome" Data Challenge fully simulated data sample and an ATLFAST simulated one, is done on all top event objects, electrons, muons, neutrinos, light and b-jets. A very good agreement on reconstructed top kinematics variables is shown. This assess the robustness of the results obtained with fast simulations in the top quark sector, and more particularly the detailed estimates of the related systematic uncertainties, which are the key points of most of these analyses.

Introduction

In the top quark sector, the ATLAS sensitivity in precision measurements or direct searches for new physics has been first obtained with the fast simulation package ATLFAST [1]. This includes studies on mass [2], \(W\) and top polarizations [3], flavor changing neutral currents (FCNC) [4] and single top production [5]. A detailed estimate of the related systematic uncertainties or a careful background determination are the key points of these studies. As several millions of signal and (even more) background events will be produced each year at the LHC, it is not possible to simulate them with a full detector simulation. The scope of the studies performed within the latest global ATLAS full simulation Data Challenge [6] is to check the robustness of the fast simulation results on a sub-sample of the total statistics: mass [7], polarization [8], FCNC [9], single top [10]. All show a good agreement with the fast simulation results.

As an example, [8] demonstrates that full and fast simulation samples exhibit similar selection efficiencies, background contamination, reconstructed top mass, polarization variable distributions, and systematics related to the \(b\)-jet energy scale. The following questions can therefore be raised:

* Why detailed detector effects included in the full simulation are not so crucial?
* Are fast simulations reliable for top studies, and more particularly for systematic uncertainties estimate and background determination?

The purpose of this paper is to answer these two questions, by disentangling the different effects that lead from reconstructed objects in the event to initial top partons, as sketched in Figure 1. This full chain drives the precision of the physics studies. It includes detector effects, treated differently in full and fast simulations, physics effects, such as initial (ISR) and final (FSR) state radiation or quark fragmentation and hadronization, and event reconstruction effects. The two last parts are of course common in full and fast simulations.

## 2 Simulation tools

Fully simulated semileptonic \(t\bar{t}\) events used in this study are part of the "Rome" Data Challenge [6]. They are generated using TopReX 4.09 [11] (samples 4520 and 4521) and MCatNLO 2.31 [12] (sample 4100) with version 9.0.4 of ATLAS software [13]. Partons are fragmented and hadronized using PYTHIA 6.2 [14] for TopReX and HERWIG 6.5 [15] for MCatNLO. Initial, final state radiations and multiple interactions are simulated in agreement with CDF data extrapolated to LHC [16]. No pile-up events are added. Events are then passed through a complete detector simulation based on GEANT 4 [17]. A perfect detector is assumed, i.e. no dead channels or detector misalignments are introduced. The signals of each sub-detector are digitized and the whole event is reconstructed with version 10.0.1 of the ATHENA software. No trigger simulation is included. Fast simulation samples [3] were produced with TopReX 4.05 and MCatNLO 2.31 coupled to ATLFAST 2.6.0.

## 3 Kinematic selection in full and fast simulations

Details on the object selection and reconstruction used in this study can be found in [8]. Only the most important issues are recalled here. In full simulation, isolated leptons are identified and reconstructed with a high p\({}_{T}\) algorithm (IsEM flag of egamma for electrons and Moore for muons). Jets are reconstructed with a cone algorithm of size \(\Delta R=0.4\). They are then corrected for the possible presence of non-isolated leptons, and calibrated using the true quark energy in order to compare with fast simulation results. The \(b\)-tagging algorithm2 combines the search for secondary vertexes (SV1) and computation of transverse and longitudinal impact parameters (IP3D). A tagging efficiency of 60% can be obtained with rejection factors of \(R_{u,d,s}=160\) and \(R_{c}=7\)[18]. The missing transverse momentum, p\({}_{T}^{miss}\), is calculated by retrieving the calorimeter energy in topological clusters, and compensating for energy losses upstream (in the cryostat) and carried by muons. A shift of -3% on \(\Delta p_{T}^{miss}/p_{T}^{miss}\) in full simulation, in agreement with \(-1.2\) GeV shift reported in [19], is corrected afterward. A standard selection for top studies is then applied. Selection criteria, whose efficiencies are given for MCatNLO, are the following:

Footnote 2: The \(b\)-tagging is performed randomly in ATLFAST, assuming a 60% \(b\)-tagging effiency as well as a light-jet (\(c\)-jet) rejection of 100 (10).

* only one isolated lepton with p\({}_{T}>\)20 GeV and \(|\eta|<2.5\). This yields an efficiency of 63% for electrons (61% for muons), with a very high purity, \(>99\%\). Injecting a 83.3% (85.6%) electron (muon) reconstruction efficiency [8] in ATLFAST (where no inefficiency is assumed) gives 61.5% (59%), in fair agreement with the full simulation result.
* more than 4 jets with p\({}_{T}>\) 30 GeV and \(|\eta|<2.5\). This yields an efficiency of 50%. A higher efficiency is obtained with fast simulation (56%), mainly because there is no reconstruction inefficiencies. At least 2 \(b\)-tagged jets are then required.
* p\({}_{T}^{miss}>20\) GeV, which yields an efficiency of 90%, in good agreement with fast simulation (91%).

Figure 1: _Chain that leads from initial partons to reconstructed objects, including event generation (parton level), simulation (MC truth level), digitization and reconstruction (detector level)._All kinematic cuts are summarized in Table 1. Their overall efficiency on signal events is 9.5%. This is well reproduced by the fast simulation (9.3%) after including lepton reconstruction efficiencies. The same agreement is achieved for TopReX [8].

## 4 Momentum and angular resolutions in full and fast simulations

The resolutions of selected objects (section 4.1) and reconstructed \(W\) and top (section 4.2) are presented. They are convoluted with the initial spectra of objects in \(t\bar{t}\) events. As the hard process (before any radiation) has no meaning at next-to-leading order (MCatNLO), all results in this section are given for the TopReX sample.

### Comparison of detector resolutions

Differences between fast and full simulations come from the detector performance description, a simple Gaussian smearing extracted from the physics TDR [20] being used in ATLFAST. These differences are evaluated by comparing the kinematics of reconstructed objects (electrons, muons and jets at "detector level" in Figure 1) with those of Monte Carlo final state particles ("MC truth level" in Figure 1). This is shown in Figure 2 for transverse momenta and directions along \(\eta\) and \(\phi\). Full black (dashed red) curves are obtained with full (fast) simulation.

The electron \(\mathrm{p}_{T}\) resolution obtained with full simulation is well reproduced in ATLFAST. Tails at lower reconstructed \(\mathrm{p}_{T}\) are due to bremsstrahlung in the material before the calorimeter, only taken into account in the full simulation. The muon \(\mathrm{p}_{T}\) resolution is worse in full simulation than in fast simulation, and is slightly shifted toward lower reconstructed values (-0.4%). This is due to reconstruction problems of the Moore algorithm in the original "Rome" samples. This has been corrected for in the later software versions, as shown with the blue dotted curve obtained with reconstruction version 11.0.41: the resolution is then closer to the fast simulation one. The jet \(p_{T}\) resolution, very close for light and \(b\)-jets, is too optimistic in ATLFAST (\(50\%/\sqrt{E}+3\%\) for \(|\eta|<3\)), as indicated by recent studies [21]3.

\begin{table}
\begin{tabular}{|c|c||c|c|} \hline Variables & Cuts & \multicolumn{2}{c|}{Efficiency (\%)} \\  & & full sim & fast sim \\ \hline \hline =1 isolated lepton & \(\mathrm{p}_{T}>20\) GeV, \(|\eta|<2.5\) & 62 & 60.0 \\ \(\geq 4\) jets & \(\mathrm{p}_{T}>30\) GeV, \(|\eta|<2.5\) & 50 & 55.7 \\ \(b\)-tagging & \(\geq 2\) b-jets & 32 & 31.4 \\ Missing energy (v) & \(\mathrm{p}_{T}^{miss}>20\) GeV & 90 & 91.1 \\ \hline \multicolumn{2}{|c||}{Global efficiency} & 9.5 & 9.3 \\ \hline \end{tabular}
\end{table}
Table 1: _Selection cuts and corresponding efficiencies on semileptonic \(t\bar{t}\) MCatNLO events processed with full and fast simulations._No angular smearing is applied in the default ATLFAST. We therefore simply smeared all object directions according to the Gaussian resolutions obtained from the core of full simulation distributions (Figure 2). The \(\eta\) resolutions are almost Gaussian, which is not the case for \(\phi\) because of bremsstrahlung. Only the very central part of these distributions are therefore fitted. A fair agreement is achieved for electrons and muons, but not for the jets, for which no direction smearing along \(\phi\) is therefore applied in the following.

### Comparison of \(W\) and top resolutions

Physics effects between the initial hard process and the particles that go through the detector (mainly radiations, quark fragmentation and hadronization) are simulated in the same way in full and fast simulation samples. They will dilute the differences caused by the detector resolutions. This is shown in Figure 3, where the reconstructed object variables are now compared to those for the initial partons ("parton level" in Figure 1).

The agreement between full and fast simulations is very good in all cases even in the non-Gaussian tails. The only exception is the muon \(\mathrm{p}_{T}\) resolution, again due to Moore algorithm problems in reconstruction version 10.0.1. Compared to Figure 2, all differences are washed out. All \(\mathrm{p}_{T}\) resolutions are degraded by 20% and tails are bigger. This is mainly due to final state radiations and the presence of neutrinos in leptonic decays of \(b\)-jets (for the jet resolutions).

The event is then fully reconstructed using the objects studied previously. The \(W\)-boson and top quark reconstructions are standard, except that the known top mass is used. Hadronic \(W\) and related top are first reconstructed. The light jet pair with \(\mathrm{M}_{jj}\) closest to the known \(W\) mass, \(\mathrm{M}_{W}\), is selected to reconstruct the \(W\). The event is kept if the difference between this invariant mass and \(\mathrm{M}_{W}\) is lower than 20 GeV. The top is then retrieved using the \(b\)-tagged jet with \(\mathrm{M}_{jjb}\) closest to \(\mathrm{M}_{t}\). The remaining \(b\)-jet is used for the leptonic top reconstruction. In 7% cases where more than two \(b\)-jets are selected, the one closest to the lepton in \(\Delta R\) is chosen. To reconstruct the leptonic \(W\), the neutrino \(\mathrm{p}_{T}\) is assumed to be the missing transverse momentum. Its longitudinal component, \(\mathrm{p}_{z}\), is determined by constraining \(\mathrm{M}_{l\nu}\) to \(\mathrm{M}_{W}\). When two solutions are found, the one with \(\mathrm{M}_{l\nu b}\) closest to \(\mathrm{M}_{t}\) is kept. Except for the \(b\)-tagging (see section 2), the whole reconstruction method is the same for full and fast simulation samples. The good agreement shown in Figure 3 for \(\mathrm{p}_{T}\), \(\eta\) and \(\phi\) resolutions on each object translates into the reconstructed kinematics of the \(W\)s and tops: a very good agreement is achieved, as shown in Figure 4.

Figure 2: _Detector resolutions on transverse momenta (\(\frac{\Delta p_{T}}{p_{T}}\)) and directions (\(\Delta\eta\) and \(\Delta\phi\)) for electrons, muons, light jets and b-jets. Black full (red dashed) lines correspond to full (fast) simulations. The blue dotted curve in the muon \(p_{T}\) resolution corresponds to full simulation with version 11.0.41 of the reconstruction. Gaussian widths of the core distributions are given._

Figure 3: _Resolutions on transverse momenta (\(\frac{\Delta p_{T}}{p_{T}}\)) and directions (\(\Delta\eta\) and \(\Delta\phi\)) for electrons, muons, jets (light \(+\)\(b\)-jets) and neutrinos. They are obtained by comparing the reconstructed objects with the initial partons. Black full (red dashed) lines correspond to full (fast) simulations. Gaussian widths of the core \(\frac{\Delta p_{T}}{p_{T}}\) distributions are given._

Figure 4: _Resolutions on transverse momenta (\(\frac{\Delta p_{T}}{p_{T}}\)) and directions (\(\Delta\eta\) and \(\Delta\phi\)) for Ws and tops. They are obtained by comparing the reconstructed objects with the initial partons. Black full (red dashed) lines correspond to full (fast) simulations._

[MISSING_PAGE_FAIL:9]

Figure 5: _Reconstructed masses of top from hadronic (left) and leptonic (right) sides for TopReX (up) and MCatNLO (down) in the semileptonic channel. Full (closed symbols) and fast (open symbols) simulation are superimposed on each plot. Gaussian+third order polynomial fits on full simulation samples are superimposed, from which mass and \(\sigma\) are extracted._

Figure 6: _Resolution on the cosine of different angles used in \(W\) and top polarization measurements (see text). They are obtained by comparing the reconstructed angles with those involving the initial partons. Black full (red dashed) lines correspond to full (fast) simulations._

## References

* [1] E. Richter-Was, D. Froidevaux and L. Poggioli, _ATLFAST 2.0 a fast simulation package for ATLAS_, ATL-PHYS-98-131.
* [2] I. Borjanovic _et al._, _Investigation of top mass measurements with the ATLAS detector at LHC_, Eur. Phys. J. **C 39 S2** (2005) 63, hep-ex/0403021.
* [3] F. Hubaut _et al._, _ATLAS sensitivity to top quark and \(W\) boson polarization in \(t\overline{t}\) event_, Eur. Phys. J. **C 44 S2** (2005) 13, hep-ex/0508061.
* [4] J. Carvalho _et al._, _Study of ATLAS sensitivity to FCNC top decays_, ATL-PHYS-PUB-2005-009 and ATL-PHYS-PUB-2005-026.
* [5] A. Lucotte and F. Chevallier, _Single-top \(s\)-channel cross-section measurement and sensitivity to a charged Higgs boson_, ATL-COM-PHYS-2006-003.
* [6]_Rome event production_, overview of ATLAS full simulation Data Challenge, June 2005: [https://twiki.cern.ch/twiki/bin/view/Atlas/RomeOverviewWiki](https://twiki.cern.ch/twiki/bin/view/Atlas/RomeOverviewWiki)
* [7] A.-I. Etienvre, J.-P. Meyer and J. Schwindling, _Top quark mass measurement in the lepton plus jets channel using full simulation_, ATL-PHYS-INT-2005-002.
* [8] F. Hubaut _et al._, _Polarization studies in \(t\bar{t}\) semileptonic events with ATLAS full simulation_, ATL-COM-PHYS-2006-026.
* [9] A. Onofre, Presentation at the ATLAS physics week, CERN, 28 Oct. 2005.
* [10] A. Lucotte, Presentation at the ATLAS physics workshop, Rome, 10 June 2005.
* [11] S.R. Slabospitsky and L. Sonnenschein, _Toprex Generator (version 3.25) short Manual_, Comput. Phys. Commun. **148** (2002) 87, hep-ph/0201292.
* [12] S. Frixione and B. Webber, _The MCatNLO 2.3 Event Generator_, hep-ph/0402116.
* [13] ATLAS Collaboration, _ATLAS Computing Technical Design Report_, CERN-LHCC-2005-022.
* [14]_ATLAS Software, 2005_: [https://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/OO/](https://atlas.web.cern.ch/Atlas/GROUPS/SOFTWARE/OO/)
* [15] T. Sjostrand _et al._, _PYTHIA 6.2: Physics and Manual_, LU-TP-01-21, hep-ph/0108264.
* [16] G. Corcella _et al._, _HERWIG 6.5: an event generator for hadron emission reactions with interfering gluons (including supersymmetric processes)_, JHEP01 (2001) 010, hep-ph/0011363.