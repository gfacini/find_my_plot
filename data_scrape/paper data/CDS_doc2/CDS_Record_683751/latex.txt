[MISSING_PAGE_EMPTY:1]

VERSION SUMMARY_Title of the version of the program:_ATLFAST, version: 2.0

_Authors of the program:_ E. Richter-Was, D. Froidevaux, L. Poggioli.

_Computer:_ HP; _Installation:_ CERN

_Operating system_ (_on which the version has been tested):_ UNIX

_Programming language used:_ FORTRAN 77

_No. of bits in a word_: 32

_External libraries_: CERNLIB.

_Keywords:_ particle-level simulation.

_Nature of the problem:_ Particle-level simulation allows for fast analysis of the fully generated event in the \(pp\) collision including parametrisation of the most crucial detector aspects.

**WWW home page: [http://atlfastinfo.cern.ch/Atlas/GROUPS/PHYSICS/Physics.html](http://atlfastinfo.cern.ch/Atlas/GROUPS/PHYSICS/Physics.html)**

(entry: **Tools for physics simulation**)

_email:_ elzbieta.richter-was@cern.ch

## Acknowledgements

The authors of the program are indebted to many colleagues who have contributed their own code:

* F. Gianotti for the parametrisation of the photon energy resolution
* M Virchaux, L. Chevalier and C. Guyot for the parametrisation of the muon p\({}_{\rm T}\) resolution
* E. Arik, S. Cetin and A. Mailov for preparing the routine for muon trigger efficiencies
* A. Reichold, R. Dankers and E.J. Buis for preparing and maintaining the routines for helix parameter resolutions of the Inner Detector
* G. F. Tartarelli for preparing the routine for helix parameter reconstruction
* G. F. Tartarelli and N. Labanca for preparing the parametrisation of low energy charged pions track resolutions
* S. Haywood for preparing the parametrisation of the electron track resolutions
* D. Cavalli and S. Resconi for the parametrisations of the \(\tau\)-tagging performance
* E. Ros for the parametrisation of the b-tagging performance
* I. C. Park for providing the JetFinder library for reconstruction of QCD jets
* S. Klyukhin and J. Soderqvist for setting up the interfaces to the HERWIG and ISAJET event generators
* J. Soderqvist and M. Pearce for providing the calculation of circularity, thrust and oblateness
* M. Stavrianakou and I. Efthymiopoulos for setting up the ntuple format
* D. Rousseau for the implementation of the ATLFAST results into the standardised combined ntuples

E. Richter-Was acknowledges valuable discussions with D. Cavalli, M. Cobal, I. Efthymiopoulos, F. Gianotti, S. Haywood, E. Nagy, A. Nisati, J. Soderqvist, G. F. Tartarelli and thanks everybody who helped to debug the code particularly: A. Amorim, C. Biscarat, G. Eynard, S. Klyukhin, B. Lund-Jensen, S. Negroni, S. Resconi, H. Ruiz, L. Serin, J. Soderqvist, K. Strahl and T. Trefzer. Last but not least she thanks F. Dittus for assistance with FrameMaker.

[MISSING_PAGE_EMPTY:3]

B.2 Subroutine MAKIOU

B.3 Subroutine MAKFMT

B.4 Subroutine MAKINF.

B.5 Subroutine MAKDMP

B.6 Subroutine MAKINI

B.7 Subroutine MAKCLU

B.8 Subroutine MAKMUO

B.9 Subroutine MAKELE

B.10 Subroutine MAKPHO

B.11 Subroutine MAKJET

B.12 Subroutine MAKJBJE

B.13 Subroutine MAKJE

B.14 Subroutine MAKTAU

B.15 Subroutine MAKTRA

B.16 Subroutine MAKMIS

B.17 Subroutine MAKMSC

B.18 Subroutine MAKTRG

B.19 Subroutine ATLFNTUP.

C Parametrizationofuhenergy/momentresolution-fieldfreddhuon trigger efficiency

C.1 Subroutine RESMUO

C.2 Function RESPHO

C.3 Function RESTHE.

C.4 Function RESELE

C.5 Function RESHAD

C.6 Function FFLDPHI

C.7 Function TRIGMUO

D Subroutines in ATLFAST-B package

D.1 Subroutine ATLFEVE

D.2 Subroutine ATLFCAL

D.3 Subroutine ATLFPHO

D.4 Subroutine ATLFLEP

D.5 Subroutine ATLFJBJE.

D.6 Subroutine ATLFTAU

D.7 Subroutine ATLFVETO

D.8 Subroutine ATLFTRG

D.9 Subroutine ATLFUSE

E Output from ATLFAST demonstration deck 

## 1 Introduction

Particle-level simulation is a kind of intermediate step between simple parton-level analysis of the event topology and very sophisticated and CPU-consuming full detector simulation. It can be done in a more or less complex way but is _never_ meant to replace the full simulation of the detector response. However, this kind of simulation is needed for quick and approximate estimates of signal and background rates for specific channels. In addition, fast simulation is the only practical tool for long-statistics studies of complex background processes at the LHC. In many cases, simpler parton-level simulations have been shown to give too optimistic and therefore misleading results.

The first version of this package [6-1] was used for systematic studies of MSSM Higgs discovery limits [6-2], SUSY particle searches [6-3], for some studies presented in the ATLAS Technical Design Reports [6-5], [6-6] and [6-7] and for monitoring the large ATLAS jet production [6-8]. The difference between parton-level and particle-level (called also sometimes jet-level) analyses was discussed already in some detail in [6-9].

This package attempts to reproduce as well as possible the expected ATLAS detector mass resolution for important physics signals, as obtained from full simulation. It does not attempt at present to reproduce accurately the expected efficiencies for lepton and photon isolation, but does attempt to do so for any jet reconstruction efficiency, especially for b-jets, and for the missing \(\mathrm{E_{T}}\) resolution. However, for any specific channel, the ATLAS predictions in terms of resolution and reconstruction efficiency, should always be confirmed with full-simulation results. Such detailed comparisons have been done for the WH, H\(\rightarrow\) b\(\overline{\mathrm{b}}\) and A\(\rightarrow\)\(\tau\) channels [6-10], in terms of the selection cut acceptances, the jet reconstruction efficiencies and mass resolutions, and they have shown good agreement between fast and full simulations. Such comparison also has been performed for the jet-veto and forward jet-tagging efficiencies for the SM heavy Higgs channels

Not all detector effects can be readily parametrised in fast simulation and only the basic information of the detector geometry is used by the package. This basic information is for example: the \(\eta\)-coverage for precision physics and for the calorimetry, the size of the barrel/endcap transition region for the electromagnetic calorimeter, and the granularity of the calorimeters. No effects related for the detailed shapes of particle showers in the calorimeters, for the charged track multiplicity in jets, etc. are taken into account. In particular, energy isolation of leptons is only simulated in a crude way, and the results should always be replaced by those from more detailed simulations.

The main goal of the ATLFAST package is to simulate and analyse fully generated events and select isolated leptons and photons, reconstruct jets, label b-jets, c-jets and \(\tau\)-jets and estimate the missing transverse energy. A more or less accurate parametrisation of photon, electron and muon momentum resolution is included, as well as a parametrisation of the hadronic calorimeter energy resolution and the effect of the ATLAS magnetic field on jet reconstruction. The reconstruction of helix track parameters in the Inner Detector is also provided with separate parametrisations of the resolutions for muon, electron and pion tracks.

From the point of view of convenience, it turns out that some properties of the detector are better simulated/analysed at the level of the ntuples created by ATLFAST. For this purpose ATLFAST-B was created, with routines randomly simulating b-, c- and \(\tau\)-tagging and providing jet-energy recalibration. Therefore, the proposed procedure is to simulate events with ATLFAST and to analyse the results using the ATLFAST-B utilities whenever needed.

Below are summarised the main changes which have been implemented since version 1.0 [6-1] :

* ATLFAST-B utility package;
* Labelling of \(\tau\)-jets (in ATLFAST);
* Parametrisation of b-tagging and \(\tau\)-tagging performance, for low luminosity operation, consistent with full-simulation results (in ATLFAST-B);
* Parametrisation of the muon trigger efficiency (in ATLFAST and ATLFAST-B);
* Jet energy recalibration giving the correct mass scale for e.g. the reconstructed mjj and mbb distributions (in ATLFAST-B);
* Effect of pile-up on the jet energy resolution (in ATLFAST)
* Updated parametrisation of the muon momentum smearing (in ATLFAST);
* Jet reconstruction in cases of different \(\Delta\)R for the barrel/end-cup and forward regions (jet reconstruction with two different cones in \(\Delta\)R can also be invoked in ATLFAST);
* JetFinder library with several algorithms for jet cluster reconstruction;
* Track helix parameter reconstruction and parametrisation of Inner Detector resolution (in ATLFAST)
* Rearrangement of common blocks: The particle list is given in the /ATLFEVENT/ common block and not in /LUJETS/ All jets are in one common block /JETALL/, (commons /BJET/ and /CJET/ have disappeared); In common blocks /ISOMUO/ and /NOISOMUX/ there is a new flag for the muon trigger

The outline of this note is as follows. Chapter 2 describes the physics issues of the algorithm used for the event analysis, and also compares the results from the package to those from the full simulation. Chapter 3 discusses in more detail the jet reconstruction, calibration and tagging. Chapter 4 discusses track reconstruction and conclusions are given in Chapter 5. Appendix A instructs the reader on how to use the program and Appendices B, C and D describe the structure of the program, the subroutines, commons blocks, and functions. Finally, Appendix E includes the listing of an output as an example.

## 2 Particle-level simulation

Fully or partially generated events, i.e. events generated including or not QED/QCD initial and final state radiation, fragmentation, hadronisation and decays of unstable particles can be analysed by the package. The list of generated particles should be rewritten (including their history) from the common blocks provided by the chosen event generator to the /ATLFEVENT/ common block. From this common block, only the stable, final-state particles are treated by the ATLFAST algorithm, which selects and stores reconstructed isolated leptons and photons, hadronic jets and reconstructed tracks.

### Calorimetric clusters

The transverse energies of all undecayed particles stored in COMMON /ATLFEVENT/, except for neutrinos, muons and the SUSY LSP, are summed up in calorimeter cells of a given granularity in \(\eta\times\phi\) coordinates (default: \(0.1\times 0.1\) for \(\mid\eta\mid<3\) and \(0.2\times 0.2\) for \(\mid\eta\mid>3\)) over the full calorimeter coverage (default: \(\mid\eta\mid<\)5). The effect of the solenoidal 2T magnetic field on the \(\phi\)-position of charged particles with \(\rm p_{T}\) above threshold (default: \(\rm p_{T}>0.5\) GeV) is parametrised in FUNC-TION FLDPHI. It is assumed that the contribution from charged particles with \(\rm p_{T}\) below this threshold can be safely neglected.

All calorimeter cells with transverse energy greater than a given threshold (default: \(\rm E_{T}>1.5\) GeV) are taken as possible initiators of clusters. These are scanned in order of decreasing \(\rm E_{T}\) to verify whether the total \(\rm E_{T}\) summed over all cells in a cone \(\Delta R=\sqrt{\Delta^{2}\eta+\Delta^{2}\phi}\) exceeds the minimum required threshold for a reconstructed cluster (default: \(\rm E_{T}>10\) GeV). The reconstruction cone is defined separately for the barrel/end-cup (\(\mid\eta\mid<\)3) and forward (\(\mid\eta\mid>\)3) part (default for barrel/end-cup and forward: \(\Delta\)R=0.4). It is possible to invoke also the algorithm for a second choice of the \(\Delta\)R value, thus having each event analysed twice (default for barrel/end-cup and forward: \(\Delta\)R=0.7). Cells with a deposited transverse energy below threshold (default: 0 GeV) are not accounted for. As coordinates (\(\eta^{\rm clu}\), \(\phi^{\rm clu}\)) of the reconstructed clusters are taken the coordinates of the bary centres of the cones weighted by the cell \(\rm E_{T}\) for all cells inside the cone around the initiator cell.

The \(\Delta\eta\) and \(\Delta\phi\) between the axis of the reconstructed clusters and the bary centres of all particles inside the reconstruction cone are shown in Figure 2-1 and Figure 2-2. The accuracy of the reconstruction is good (\(\sigma\)=0.022 rad) and the tails are small. The same quantities plotted for the difference between the position of the initial parton and the reconstructed cluster (Figure 2-3 and Figure 2-4) show much larger tails and worse resolutions. As can be seen from Figure 2-3 and Figure 2-4, the effect of the magnetic field is not very large for jets of \(\rm E_{T}\) around \(\rm m_{H}/2\). This effect is to be expected since the direction of the initial parton does not always overlap with the direction of the final particles inside the cluster. The effect of the outcome energy loss is illustrated in Figure 2-5 and Figure 2-6, where \(\rm\Delta p_{T}/p_{T}\) between the reconstructed cluster and the initial parton is shown respectively for \(\Delta\)R\({}_{\rm cone}\)=0.4 and 0.7. This effect can be mostly corrected for on average using the procedure of jet energy  recalibration. As expected, for larger jet-cones, the efficiency for jet reconstruction is higher and the energy losses outside the jet-cone are smaller. The small tail at positive \(\rm\Delta p_{T}/p_{T}\) is caused by the effect of additional energy deposition inside the jet-cone coming from initial state radiation and the underlying event.

[MISSING_PAGE_EMPTY:8]

### Isolated photons

Isolated photon candidates are searched for in the particle COMMON /ATLFEVENT/. The polar angle of the photon is smeared with a Gaussian resolution parametrised in FUNCTION RESTHE. Then the photon 4-momentum is smeared according to a Gaussian energy resolution parametrised in FUNCTION RESPHO. Low and high luminosity options can be invoked.

For all photons which pass the selection criteria in \(\rm p_{T}\) and \(\rm\mid\!\eta\!\mid\) (default: \(\rm p_{T}\)\(>\) 10 GeV and \(\rm\mid\!\eta\!\mid\)\(<\) 2.5), the associated reconstructed calorimeter cluster is identified (default: \(\rm\Delta R_{\rm\gamma,\ cluster}\)\(<\) 0.1). Photon isolation criteria, in terms of the distance from other clusters and of maximum transverse energy deposition in cells in a cone around the photon, are then applied (defaults: separation by \(\rm\Delta R\)\(>\) 0.4 from other clusters and \(\rm E_{T}\)\(<\) 10 GeV in a cone \(\rm\Delta R\)\(=\) 0.2 around the photon). All photons passing the isolation criteria are stored in COMMON /ISOPHO/ and the clusters associated with them are removed from COMMON /CLUSTER/. These default isolation criteria have a 97.5% efficiency for photons passing the kinematical selection cuts for \(\rm H\rightarrow\gamma\gamma\) searches. The same isolation criteria have also been studied in [6-14] for the photon bremsstrahlung background from quarks.

The reconstructed mass of the isolated photon pairs for a generated sample of \(\rm H\rightarrow\gamma\gamma\) events, after the standard kinematical cuts, \(\rm p_{T}^{T}\)\(>\) 40 and 25 GeV, is shown in Figure 2-7 and Figure 2-8 for low and high-luminosity respectively; and the expected mass resolutions are given in Table 2-1. For comparison, results from full simulation of the Accordion calorimeter [6-5] are also given, showing reasonable agreement between the parametrisation used for the fast simulation and the expected performance from full simulation.

ATLFAST does not take into account efficiencies for identifying photons and/or misidentifying jets. Therefore, if needed, the estimated efficiencies, e.g. as given in [6-15], should be included by the user in the event analysis.

### Isolated electrons

Isolated electron candidates are searched for in the particle COMMON /ATLFEVENT/. Each electron momentum is smeared, according to a Gaussian energy resolution parametrised in FUNC-TION RESELE. Low luminosity (KEYLUM=1) and high luminosity (KEYLUM=2) options can be invoked.

For all electrons which pass the selection criteria in \(\rm P_{T}\) and \(\rm\,\,|\eta\,|\) (default: \(\rm P_{T}>5\,GeV\) and \(\rm\,\,|\eta\,|<\)2.5), the associated reconstructed cluster is identified (default: \(\rm\Delta R_{e,\,cluster}<0.1\)). Electron isolation criteria, in terms of the distance from other clusters and of maximum transverse energy deposition in cells in a cone around the electron are then applied (defaults: separation by \(\rm\Delta R>0.4\) from other clusters and \(\rm E_{T}<10\) GeV in a cone \(\rm\Delta R=0.2\) around the electron). These chosen default isolation criteria have a 95.3% efficiency for electrons passing the kinematical selection cuts for \(\rm H\to e^{+}e^{-}e^{+}e^{-}\) searches. All electrons passing the isolation criteria are stored in COMMON /ISOELE/ and the clusters associated with them are removed from COMMON /CLUS-TER/.

The mass resolution for electron pairs from a generated sample of \(\rm Z\to e^{+}e^{-}\) events is shown in Table 2.2 with and without subtraction of the natural \(Z\) width. The mass resolution for four electrons, from a generated sample of \(\rm H\to e^{+}e^{-}e^{+}e^{-}\) events with \(\rm m_{H}=130\) GeV is also shown in Table 2.2, for low and high luminosities, and is in good agreement with results from the fullsimulation of the Accordion calorimeter [6-5], obtained without QED inner bremsstrahlung [6-18]. Figure 2-9 and Figure 2-10 show the mass distributions obtained for low and high luminosity respectively and for \(\rm H\to e^{+}e^{-}e^{+}e^{-}\) decays with \(\rm m_{H}=130\) GeV.

ATLEAST does not take into account efficiencies for identifying electrons and/or misidentifying jets. Therefore if needed, the estimated efficiencies should be included by the user in the event analysis.

### Isolated muons

Isolated muon candidates are searched for in the particle COMMON /ATLEEVENT/. Each muon momentum is smeared according to a resolution which depends on the muon \(\rm p_{T}\), \(\rm|\eta|\) and \(\rm\phi\)Three options depending on which sub-detectors are assumed to be used for the muon measurement can be invoked: muon system stand-alone (approximate [6-20] or exact [6-20] parameterisation, default: exact), Inner Detector stand-alone (parametrisation from [6-21]) and combined (default: combined). The parametrisation of the momentum resolution is coded in SUBROUTINE RESMUO.

For all muons which pass the selection criteria in \(\rm p_{T}\) and \(\rm\,\,|\eta\rm\,|\,\) (default: \(\rm p_{T}>6\) GeV and \(\rm\,\,|\eta\rm\,|<2.5\)), isolation criteria, in terms of the distance from calorimeter clusters and of maximum transverse energy deposition in cells in a cone around the muon, are applied (default: separation by \(\rm\,\Delta R>0.4\) from clusters and \(\rm E_{T}<10\) GeV in a cone \(\rm\,\Delta R\)=0.2 around the muon). These chosen default isolation criteria have a 97.8% efficiency for muons passing the kinematical selection cuts for \(\rm H\rightarrow\rm\mu^{+}\rm\mu^{+}\rm\mu^{+}\rm\mu^{-}\) searches. All muons passing the isolation criteria are stored in COMMON /ISOMUO/ and the others are stored in COMMON /NOISOMUO/. Muons not passing the \(\rm p_{T}\) or \(\rm\,|\eta\rm\,|\,\) selection criteria are lost.

The mass resolution for muon pairs, obtained from a generated sample of \(\rm Z\)\(\rightarrow\rm\mu^{+}\rm\mu^{-}\) events is shown in Table 2-3, with and without subtraction of the natural \(Z\) width, for the three options for the muon momentum measurement. The mass resolution for four muons obtained, after kinematical selection from a generated sample of \(\rm H\rightarrow\rm\mu^{+}\rm\mu^{+}\rm\mu^{-}\) events is shown in Figure 2-11 -Figure 2-14 and in Table 2-3. The results obtained for the muon system and Inner Detector stand-alone resolutions are in good agreement between ATLFAST and the full simulation. The combined resolution still appears to be significantly better as obtained from ATLFAST, but it is expected that the ongoing work in the combined muon performance group will lead to better results from full simulation and reconstruction. The full simulation results quoted for \(\rm H\rightarrow\rm\mu^{+}\rm\mu^{+}\rm\mu^{+}\rm\mu^{-}\) decays were obtained for the ATLAS Technical Design Report muon system configuration [6-12].

ATLFAST does not take into account efficiencies for identifying muons. Therefore if needed, the estimated efficiencies should be included by the user in the event analysis. However, ATLFAST simulates muon triggering efficiencies, if required to, and isolated and non-isolated muons are flagged with an appropriate trigger flag.

Figure 2-11: Reconstructed mass, \(\rm m_{4\mu}\), for \(\rm H\to\mu^{+}\mu^{+}\mu^{+}\mu^{+}\mu^{-}\) events with \(\rm m_{H}=130\) GeV and for the exact parametrization of the muon-system stand-alone momentum resolution from [6-19].

Figure 2-12: Same as Figure 2-11 for the approximate parametrization of the stand-alone muon-system momentum resolution from [6-20].

Figure 2-13: stand-alone momentum resolution. Figure 2-14: Same as Figure 2-3 for the combined muon momentum resolution.

### Jet reconstruction

#### Jet reconstruction at low luminosity.

Clustered cells are used for the jet reconstruction. The energies of clusters, which have not been selected as associated with isolated electrons or photons, are smeared according to a Gaussian energy resolution parametrised in FUNCTIONRESHAD. Two options can be invoked: low luminosity and high luminosity. In the second case, the effect from pile-up is included in the parametrisation of the resolution. The energy of non-isolated muons which fall inside the cluster cone is added to the smeared cluster energy. The resulting jets with \(\mathrm{E_{T}}\) greater than a given threshold (default: \(\mathrm{E_{T}}>15\) GeV) are labelled as reconstructed jets, stored in COMMON /JETALL/ and removed from COMMON /CLUSTER/.

The jet reconstruction efficiency and dijet mass resolution have been studied using events from WH production with \(\mathrm{m_{H}}=100\) GeV and forcing the Higgs boson to decay into specific partons, namely \(\mathrm{H\to u\overline{u}}\), \(\mathrm{H\to b\overline{b}}\) and \(\mathrm{H\to gg}\). Only jets reconstructed within a cone \(\Delta\mathrm{R}<0.4\) from a parton from Higgs decay are considered here. The relative difference in transverse energy between the initial parton and the reconstructed jet, as well as the mass distribution of the pairs of recosntructed jets are shown in Figure 2-16 - Figure 2-18 for \(\mathrm{H\to u\overline{u}}\), \(\mathrm{H\to b\overline{b}}\) and \(\mathrm{H\to gg}\) decays. The peaks of reconstructed mass are shifted to values significantly lower than the Higgs-boson mass, and this shift is larger for heavy quark and gluon jets. The width of the reconstructed peak and the non-gaussian tails at low values of the dijet mass are also larger for b-jets and gluon jets.

\begin{table}
\begin{tabular}{|l|c|} \hline \multicolumn{1}{|c|}{**Muon system**} & \multicolumn{1}{c|}{**Inner Detector**} & \multicolumn{1}{c|}{**Combined**} \\ \multicolumn{1}{|c|}{\(\mathrm{\sigma_{m}}\) **(GeV)**} & \multicolumn{1}{c|}{\(\mathrm{\sigma_{m}}\) **(GeV)**} & \multicolumn{1}{c|}{\(\mathrm{\sigma_{m}}\) **(GeV)**} \\ \multicolumn{1}{|c|}{**Z\(\to\)\(\mu^{+}\mu^{-}\)**} & \multicolumn{1}{c|}{**Z\(\to\)\(\mu^{+}\mu^{-}\)**} & \multicolumn{1}{c|}{**Z\(\to\)\(\mu^{+}\mu^{-}\)**} \\ \multicolumn{1}{|c|}{ATLEAST (Z width included)} & 2.16 & 2.29 & 1.85 \\ \multicolumn{1}{|c|}{ATLEAST (Z width subtracted)} & 1.56 & 1.63 & 1.14 \\ \multicolumn{1}{|c|}{\(\mathrm{H\to\mu^{+}\mu^{+}\mu^{+}\mu^{-}}\)} & \multicolumn{1}{c|}{\(\mathrm{H\to\mu^{+}\mu^{+}\mu^{+}\mu^{-}}\)} & \multicolumn{1}{c|}{\(\mathrm{H\to\mu^{+}\mu^{+}\mu^{+}\mu^{-}}\)} \\ \multicolumn{1}{|c|}{ATLEAST} & 2.04 & 1.68 & 1.26 \\ \multicolumn{1}{|c|}{ATLAS} & \(1.95\pm 0.08\) & \(1.75\pm 0.07\) & 1.6 \(\pm\) 0.01 \\ \hline \end{tabular}
\end{table}
Table 2-3: Mass resolutions obtained for generated \(\mathrm{Z\to\mu^{+}\mu^{+}\mu^{-}}\) and \(\mathrm{H\to\mu^{+}\mu^{+}\mu^{+}\mu^{+}}\) events (\(\mathrm{m_{H}}\)=130 GeV) for three cases of muon-momentum measurements: muon system stand-alone, Inner Detector stand-alone, and both combined. For the \(\mathrm{Z\to\mu^{+}\mu^{+}\mu^{-}}\) events results are given with and without subtraction of the natural Z width. The results from full simulation of from ATLAS Muon System [6-12] and of the ATLAS Inner Detector (“Morges” layout) are also given. The combined result from full simulation is from an old study performed for the ATLAS Technical Proposal.

\begin{table}
\begin{tabular}{|l|c|} \hline \multicolumn{1}{|c|}{**Parton type**} & \multicolumn{1}{c|}{\(\Delta\mathrm{\mathbf{R_{cone}}}\) = 4} \\ \multicolumn{1}{|c|}{**\(\Delta\mathrm{\mathbf{R_{jet, parton}}}\) \(<\) 0.4**} \\ \hline u-quark & 83\% \\ \hline b-quark & 76\% \\ \hline gluon & 74\% \\ \hline \end{tabular}
\end{table}
Table 2-4: Efficiency for jet reconstruction at low luminosity for different types of initial partons with \(\mathrm{p_{T}}^{\mathrm{parton}}\) > 15 GeV and \(\mathrm{p_{T}}^{\mathrm{jet}}\) > 15 GeV.

[MISSING_PAGE_EMPTY:15]

#### Jets labelled as b-jets and c-jets

Of special interest are jets originating from b-quarks (so-called b-jets) which can be identified using b-tagging techniques (vertex or soft-lepton tags). The package labels a jet as a b-jet, if a b-quark of \(\rm p_{T}>5\) GeV (after FSR) is found in a cone of \(\Delta\)_R_=0.2 around the reconstructed jet for jets with \(|\)\(\eta\)\(|\)\(<\) 2.5. These criteria have been discussed in more detail in [6-9]. These jets are labelled with _KJET(I, 2)=5_. The mass resolution of reconstructed \(\rm b\overline{b}\) pairs is of special interest and is shown in Figure 2-21, for events generated through WH production with \(\rm H\to b\rm\overline{b}\) and for \(\rm m_{H}=100\) GeV. The results are shown in three cases: a) no magnetic field and no smearing, b) magnetic field and no smearing and c) magnetic field and smearing. The dominant mass shift arises from final state radiation and hadronisation (-12.5 GeV), but a sizeable shift also originates from the magnetic field (-4.9 GeV). As shown by the Gaussian fits in Figures 2-21, the impacts of the fragmentation, solenoidal magnetic field and energy smearing are similar and contribute each \(\sim\) 5 GeV to the Gaussian part of the experimental resolution. The fraction of events within 82 \(\pm\) 20 GeV decreases from 86.5% (Figure 2-21 a), to 84% (Figure 2-21 b) and to 83% (Figure 2-21 c). After jets energy recalibration (see Chapter 3), the position of the mass peak is shifted to nominal \(\rm m_{H}\) mass, and the acceptance in the mass bin \(\rm m_{H}\pm 20\) GeV is of 85%.

Jets originating from c-quarks are labelled as c-jets (_KJET(I,2)=4_) if similar criteria are satisfied.

ATLFAST is not including efficiencies for b-jets tagging. For b-labelled jets efficiencies for tagging and inefficiencies for mistagging c-jets and other jets have been parametrised as \(\rm p_{T}\) dependent functions [6-22] and are available in package ATLFAST-B.

#### Jets labelled as \(\tau\)-jets

Of special interest are also jets originating from \(\tau\)-decay (so called \(\tau\)-jets), which can be identified in case of hadronic \(\tau\)-decays. The systematic study of the ATLAS potential for \(\tau\)-identification have been documented in ATLAS Technical Proposal [6-13] and was studied afterwards with new detector layout [6-23]. In case of ATLFAST simulation candidates to be identified as \(\tau\)-jets are labelled. Required for hadronic \(\tau\)-decay products is to be relatively hard (default: \({\rm p_{T}^{t\mbox{-}had}>10}\) GeV), inside tracking range (1 n!\(\leq\)2.5), dominate reconstructed jet (default: \({\rm p_{T}^{t\mbox{-}had}/{\rm p_{T}^{jet}}>0.9}\)) and within jet cone (default: \(\Delta{\rm B_{jet}}\), \({\rm\tau_{\mbox{-}had}<0.3}\)). The efficiency for \(\tau\)-labelling is of 92% for \(\tau\)-hadronic decays from A\(\to\tau\) and for \({\rm m_{A}}\) = 300 GeV.

ATLFAST is not correcting for efficiencies for \(\tau\)-jet identification or other jets misidentification. For \(\tau\)-labelled jets efficiencies for \(\tau\)-tagging and mistagging have been parametrised [6-23] and are available in package ATLFAST-B.

Figure 2-21: Reconstructed dijet mass \({\rm m_{b\overline{b}}}\) distributions for b-labelled jets for no smearing and no B-field, b) no smearing and with B-field, c) with smearing and with B-field, d) with jet energy recalibration from generated WH events with \({\rm H}\to{\rm b\overline{b}}\) and for \({\rm m_{H}}\)=100 GeV and for low luminosity performance and default cone algorithm.

#### Jet reconstruction at high luminosity

The effect of pile-up expected for high luminosity performance is included by invoking jets energy smearing with high luminosity option.

Figure 2-22 shows \(\rm{p_{T}}\) resolutions for jets and for low (left-side) and high (right-side) luminosity performance. The simple parametrization of this effect affects clusters multiplicity for low \(\rm{p_{T}}\) clusters and bias \(\rm{p_{T}}^{cluster}\) spectrum. The pile-up strongly degrades the resolution for jets with 40 \(<\rm{p_{T}}<\) 50 GeV, whereas its impact on much higher-energy jets can be seen to be small. The jets energy resolutions obtained and shown in Figure 2-22 are in good agreement with the results from the full simulation[6-5].

Figure 2-23 shows \(\rm{p_{T}}^{cluster}\) distributions for simulated QCD di-jet events without (solid line) and with (dashed line) smearing for low (left-side) and high (right-side) luminosity performance. For jets transverse momenta below 40 to 50 GeV, the spectrum is clearly biased at high luminosity, whereas the low luminosity behaviour is more or less unbiased down to very low values of the jets transverse momenta.

Figure 2-22: The \(\rm{p_{T}}^{jet}\) resolution for reconstructed jets with 40 \(<\)\(\rm{p_{T}}^{jet}\)\(<\) 50 GeV (top) and 200\(<\)\(\rm{p_{T}}^{jet}\)\(<\)250 GeV (bottom) for low (left) and high (right) luminosity performance and default cone algorithm.

### 2.6 Tracks reconstruction

Optionally the tracks reconstruction is provided for charged, stable particles inside Inner Detector coverage (\(\rm\,|\eta\,|\)\(<\)2.5) and for transverse momenta above threshold (\(\rm\,\,default\)\(\rm\,:\,p_{T}\)\({}^{particle}\)\(\rm\,>\) 0.5 GeV). Reconstructed tracks parameters (\(\rm d_{0}\), \(\rm z_{0}\), \(\rm\phi\), \(\rm\,cot(\theta)\), \(\rm q/p_{T}\)) are smeared with parametrization [6-24] as derived from the dedicated studies for Inner Detector TDR [6-6] and for [6-24]. Smeared and unsmeared tracks parameters are kept in _COMMON /TRACKS/_ as well as information about the particle code, the position in event common block and the position and code of up to the 6-the mothers. Available is dedicated parametrization for muons, pions (including tails) and electrons (including bremsstrahlung) as well as reconstruction efficiency. All tracks fulfilling kinematical and geometrical criteria are reconstructed, but the corresponding efficiency is also calculated and this information is stored if needed for further analysis.

### 2.7 Missing transverse energy

The missing transverse energy \(\rm E_{T}\)\({}^{miss}\) is calculated by summing the transverse momenta of identified isolated photons, electrons and muons, of jets, b-jets and c-jets, of clusters not accepted as jets and of non-isolated muons not added to any jet cluster. Finally, the transverse energies deposited in cells not used for cluster reconstruction are also included in the total sum. Transverse energies deposited in unused cells are smeared with the same energy resolution function

Figure 2.23: The \(\rm p_{T}\)\({}^{jet}\) distribution for reconstructed jets without (solid) and with (dashed) energy smearing included for low (left-side) and high (right-side) luminosity performance and the default cone algorithm. Respective ratios are shown on bottom plots. Events were filtered on 3 clusters with \(\rm p_{T}\)\({}^{cluster}\)\(\rm\,>\) 10 GeV (before energy smearing).

[MISSING_PAGE_FAIL:20]

Figure 2-26: The (p\({}_{x}\)\({}^{\rm miss}\)-p\({}_{x}\)\({}^{\rm obs}\)) resolution for di-jet events generated with p\({}_{\rm T}\)\({}^{\rm hard}\)\(>\)17 GeV and low luminosity performance. Figure 2-27: The same as Figure 2-26 but for high luminosity performance.

Figure 2-28: The same as Figure 2-28 but for high luminosity performance.

### Trigger selection

A primitive trigger routine to validate selected physics events can be invoked after each event has been analysed by the algorithm. This routine is not meant to cover all ATLAS trigger aspects and levels, but rather to eliminate events which have essentially no chance of passing the ATLAS level-1 and level-2 trigger as specified in trigger menu of [6-7]. It is more specifically dedicated to SUSY-particle searches, which will include many complex topologies of type n-jets + m-leptons + \(\rm{E_{T}}^{miss}\). The results from the ATLAST analysis, i.e. the lists of isolated electrons, photons, isolated and non-isolated muons, and reconstructed jets are used for this trigger selection.

The proposed trigger selection is aimed at:

* compatibility with present LVL1 + LVL2 understanding; complete coverage of possible signatures;
* slightly lower thresholds than in the TP for some cases where it might turn out to be justified from the physics and where it is not clearly impossible to implement.

Three classes of trigger particles are used for low and high luminosity performance:

* isolated electrons and photons,
* muons
* jets.

For muons, parametrised trigger efficiency (as studied in [6-12]) is included, see Figure 2-30. Isolated and nonisolated muons are labelled with trigger flag (KEYMUOTRG, KEYMUOXTRG) and only the ones which passed high-\(\rm{p_{T}}\) or low-\(\rm{p_{T}}\) thresholds are considered by the trigger menu given in ATLAST. For electrons/photons and jets 100% efficiency is assumed for the time being.

Please note, that for \(\rm{E_{T}}^{miss}\) calculations all muons, which were classified as isolated or nonisolated contribute to visible energy, regardless trigger label.

The details of the default trigger criteria are given in Appendix B.18.

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline  & \multicolumn{2}{|c|}{**Without B-field**} & \multicolumn{2}{|c|}{**With B-field**} \\  & \multicolumn{2}{|c|}{**Without smearing**} & \multicolumn{2}{|c|}{**Without smearing**} & \multicolumn{2}{|c|}{**With smearing**} \\
**WH, H\(\rightarrow\) b\(\overline{\rm{b}}\)** & \(\rm{\sigma_{m}}\) (GeV)** & \(\rm{\sigma_{m}}\) (GeV)** & \(\rm{\sigma_{m}}\) (GeV) \\ \hline
25\(<\)\(\rm{\Sigma}\)\(\rm{E_{T}}^{\rm{calc}}\)\(<\)50 GeV & 2.36 & 2.57 & 2.94 \\ \hline
50\(<\)\(\rm{\Sigma}\)\(\rm{E_{T}}^{\rm{calc}}\)\(<\)100 GeV & 2.46 & 2.68 & 3.72 \\ \hline
100\(<\)\(\rm{\Sigma}\)\(\rm{E_{T}}^{\rm{calc}}\)\(<\)200 GeV & 3.22 & 3.54 & 4.89 \\ \hline
200\(<\)\(\rm{\Sigma}\)\(\rm{E_{T}}^{\rm{calc}}\)\(<\)300 GeV & 5.41 & 5.49 & 6.84 \\ \hline
300\(<\)\(\rm{\Sigma}\)\(\rm{E_{T}}^{\rm{calc}}\)\(<\)400 GeV & 6.89 & 7.52 & 9.26 \\ \hline \end{tabular}
\end{table}
Table 2-5: Reconstructed \(\rm{E_{T}}^{miss}\) -resolution with and without B-field and/or smearing from generated WH events with H \(\rightarrow\) bb and W \(\rightarrow\) lv TFigure 2.30: The parametrised efficiency for muon trigger for low, high and low + high \(\,\mathrm{p_{T}}\)-thresholds as a function of \(\,\mathrm{p_{T}}^{\mu}\,\). The barrel and endcap regions are shown separately. Courtesy S. Cetin.

### Miscellaneous

#### 2.9.1 Electron/jet and photon/jet separation.

It is not parametrised neither in ATLFAST nor ATLFAST-B. The full simulation results were obtained for very particular and in some sense extreme requirements of the detector performance. For jets \(\rm P_{T}\) of 20 GeV the rejection of 10 000 on the jets reconstructed by ATLFAST can be achieved but at the price of electron efficiency of 70% (estimated from [6-6]). The rejection of 5000-7500 could be obtained for jets against photons at the photon identification efficiency of 80% (see [6-15]).

For many physics analysis however that high jet rejection is not necessary. As the full simulation studies were not performed for such cases it is more informative to rather specify what rejection is needed to keep the reducible background at the level of 10-20% of signal+bgd for given sample than to use some crude number in the fast simulation analysis.

#### 2.9.2 Electron, muon, photon isolation

This issue was not studied with the full simulation. ATLFAST uses a rather crude estimation, asking for \(\rm E_{dep}<10\) GeV in \(\rm R_{cone}=0.2\) and a separation from other jets with \(\rm R_{cone}>0.4\).

#### 2.9.3 Electron/photon separation

Not treated by ATLFAST.

For electrons of \(\rm P_{T}\)=40 GeV the electron veto efficiency above 99.8% can be achieved while retaining an efficiency above 96% for photons (not including calorimeter identification criteria) even at high luminosity [6-16].

#### 2.9.4 Charge misidentification

Not treated by ATLFAST.

Electrons are sufficiently delicate that this issue should be studied with full reconstruction. For muons it is relevant only for very high energies and it is reasonably parametrised by the smearing routine for track helix parameters.

[MISSING_PAGE_FAIL:25]

* **The effect of the B-field.**

Table 3-3 shows the average ratio \(<\)p\({}_{\rm T}\)\({}^{\rm b\mbox{-}jet}\)/p\({}_{\rm T}\)\({}^{\rm b\mbox{-}quark}\)\(>\), the efficiency for b-jet reconstruction \(\epsilon_{\rm b\mbox{-}jet}\)\({}^{\rm recon}\) and the fitted position of the mass peak \(<\)m\({}_{\rm b\overline{b}}\)\(>\) for WH production with H \(\rightarrow\) b\(\overline{\rm b}\) and m\({}_{\rm H}\) =100 GeV. Three options with and without B-field and smearing are shown. The magnetic field reduces the efficiency for b-jet reconstruction by 3% and shifts the position of the m\({}_{\rm b\overline{b}}\) peak by -5 GeV. The average value \(<\)p\({}_{\rm T}\)\({}^{\rm b\mbox{-}jet}\)/p\({}_{\rm T}\)\({}^{\rm b\mbox{-}quark}\)\(>\) is also reduced by 3% due to the magnetic field.

Figure 3-1: Reconstruction of the invariant mass distribution of the two b-jets from Higgs boson decay for m\({}_{\rm H}\) = 100 GeV and WH production with H \(\rightarrow\) b\(\overline{\rm b}\) at the LHC, as a function of the ingredients used in the event generation: (a) hard scattering process, (b) initial state radiation, (c) final state radiation and (d) hadronisation/decays.

[MISSING_PAGE_EMPTY:27]

\begin{table}
\begin{tabular}{c|c|c|c} \hline
**WH, H\(\rightarrow\) b\(\overline{\text{b}}\)** & **Without B-field** & **With B-field** & **With B-field** \\  & **Without smearing** & **Without smearing** & **With smearing** \\ \hline \(<\)p\({}_{\text{T}}\)\({}^{\text{b-jet}}\)/p\({}_{\text{T}}\)\({}^{\text{b-quark}}\)\(>\) & 0.83 & 0.80 & 0.80 \\ \hline \(\varepsilon_{\text{b-jet}}\)\({}^{\text{recon}}\) & 83\% & 80\% & 81\% \\ \hline \(<\)m\({}_{\text{b}}\)\(>\) & 87.5 GeV & 82.6 GeV & 82.0 GeV \\ \hline \(\varepsilon_{\text{bin}}\) = 82 \(\pm\) 20 GeV & 86.5\% & 84\% & 83\% \\ \hline \end{tabular}
\end{table}
Table 3: Average ratio \(<\)p\({}_{\text{T}}\)\({}^{\text{b-jet}}\)/p\({}_{\text{T}}\)\({}^{\text{b-quark}}\)\(>\), efficiency for b-jet reconstruction \(\varepsilon_{\text{b-jet}}\)\({}^{\text{recon}}\), and fitted position of the \(\text{m}_{\text{b}}\)\(\overline{\text{b}}\) peak and acceptance \(\varepsilon_{\text{bin}}\) in a mass bin \(<\)m\({}_{\text{b}}\)\(>\)\(\pm\) 20 GeV, for WH production with H \(\rightarrow\) b\(\overline{\text{b}}\) and m\({}_{\text{H}}\)=100 GeV. The expected results with B-field being on and off are shown without smearing as well as the results with B-field and smearing.

Figure 3-4: Uncorrected \({}_{\text{b}}\)\(\overline{\text{b}}\) distributions for WH events with H \(\rightarrow\) b\(\overline{\text{b}}\) and m\({}_{\text{H}}\) =100 GeV. Shown are the distributions for all b-jet pairs (top left), for b-jet pairs not containing any identifiable soft lepton (top right), and for b-jet pairs where both b-jets contain at least one identifiable soft lepton (bottom left). The B-field effects and smearing are included.

In fact, it is well known by now that the properties of b-jets and gluon jets are very similar, whereas they differ noticeably from these of the light-quark jets [6-25]. The case of b-jets was studied further for b-jets containing at least one identifiable lepton (electron or muon with \(\rm p_{T}\)\(>\)1 GeV inside the jet cone), for which the calibration factor \(\rm K_{b\mbox{-jet}}\)\({}^{\mbox{\scriptsize\rm\rm\rm\rm\rm\rm\,lepton}}\) was calculated separately. Figure 3-5 compares the two calibration factors: \(\rm K_{b\mbox{-jet}}\)\({}^{\mbox{\scriptsize\rm\rm\,aver}}\) and \(\rm K_{b\mbox{-jet}}\)\({}^{\mbox{\scriptsize\rm\rm\,lepton}}\). It was observed that \(\rm K_{b\mbox{-jet}}\)\({}^{\mbox{\scriptsize\rm\rm\,lepton}}\) is systematically higher. This can be qualitatively explained by the effect of missing neutrino(s) in b-jets with soft leptons. No strong dependency on the \(\rm p_{T}\) of the soft lepton was found for \(\rm K_{b\mbox{-jet}}\)\({}^{\mbox{\scriptsize\rm\rm\,lepton}}\), however this dependence is visible as a function of the transverse momenta of neutrinos in the final state. This calibration gives (as shown bellow) proper mass energy scale however is not giving the proper jet energy scale. Figures 3-4 shows the reconstructed \(\rm m_{b\mbox{-jet}}\) distribution (without calibration) for all b-jets for pairs with two non-leptonic b-jets (52% of the sample) and for pairs with two leptonic b-jets (8% of the sample). It can be seen that the pairs of non-leptonic b-jets give a distribution for \(\rm m_{b\mbox{-jet}}\) similar to that for pairs of u-jets (compare to Figure 2-15) while the pairs of leptonic b-jets give a much larger shift in the peak position and width than the average b-jets. Figure 3-6 shows the \(\rm m_{\bar{\rm\rm\,jj}}\) distributions for WH events with \(\rm H\to gg\) and \(\rm H\to u\overline{u}\). The difference between correcting \(\rm p_{T}\) of these jets by using the b-jet calibration factor \(\rm K_{b\mbox{-jet}}\) (left side of Figures 3-6) or by using the calibration factors, \(\rm K_{b\mbox{-jet}}\) and \(\rm K_{u\mbox{-jet}}\) determined for each appropriate jet flavour (right side of Figure 3-6), is noticeably only for \(\rm H\to u\overline{u}\) decays. The position of the reconstructed mass peak and the acceptance in the mass window after calibrations using calibration factors \(\rm K_{b\mbox{-jet}}\) and \(\rm K_{u\mbox{-jet}}\) or using calibration factor \(\rm K_{b\mbox{-jet}}\) is shown in Table 3-4.

One should be however aware that the above calibration gives the proper mass energy scale but is not giving proper jet energy scale, as illustrated on Figure 3-7.

The calibration factors can be apply with facilities of the ATLFAST-B package.

Figure 3-5: Calibration factor, \(\rm K_{b\mbox{-jet}}\)\({}^{\mbox{\scriptsize\rm\,lepton}}\), as a function of \(\rm p_{T}\)\({}^{\mbox{\scriptsize\rm\,jet}}\), shown separately for b-jets containing at least one identifiable soft lepton (solid line) and for all b-jets (dashed line).

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline
**calibration** & & **H**\(\rightarrow\)**gg** & **H**\(\rightarrow\)**\(\overline{\mbox{u}\overline{\mbox{u}}}\) \\ \hline \(K_{b\mbox{-}jet}\) & \(<\)m\({}_{\rm bb}\)\({}^{\rm calib}\)\(>\) & 99.2 GeV & 99.3 GeV \\  & \(\epsilon_{\rm bin}\)=100 \(\pm\) 20 GeV & 78\% & 77\% \\ \hline \(K_{u\mbox{-}jet}\), \(K_{g\mbox{-}jet}\) & \(<\)m\({}_{\rm\overline{\mbox{u}}}\)\(>\) & 101.3 & 100.7 GeV \\  & \(\epsilon_{\rm bin}\)=100 \(\pm\) 20 GeV & 79\% & 86\% \\ \hline \end{tabular}
\end{table}
Table 3-5: he fitted \(<\)m\({}_{\rm bb}\)\({}^{\rm calib}\)\(>\) peak position for corrected sample of b-jets and acceptance in the mass window is given for WH process with H \(\rightarrow\)\(\rm b\overline{\mbox{b}}\) and m\({}_{\rm H}\) =100 GeV. The option with B-field on/off is shown without smearing as well as option with B-field and smearing.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline
**WH, H\(\rightarrow\)**b\(\overline{\mbox{b}}\)** & **no B-field** & **with B-field** & **with B-field** \\  & **no smearing** & **no smearing** & **with smearing** \\ \hline \(<\)m\({}_{\rm bb}\)\({}^{\rm calib}\)\(>\) & 102.5 GeV & 102.4 GeV & 102.4 GeV \\ \hline \(\epsilon_{\rm bin}\)\(=100\pm 20\) GeV & 85.6\% & 85.4\% & 84.6\% \\ \hline \end{tabular}
\end{table}
Table 3-4: The fitted peak position \(<\)m\({}_{\rm\overline{\mbox{u}}}\)\(>\) for generated WH events with H \(\rightarrow\) gg and H \(\rightarrow\)\(\rm u\overline{\mbox{u}}\) decays with and without jet calibration by the \(K_{\rm b\mbox{-}jet}\) factor. The acceptance in a given mass window is also shown for the corrected sample.

Figure 3-6: Corrected m\({}_{\rm\overline{\mbox{u}}}\) distributions for WH events with m\({}_{\rm H}\) =100 GeV and H \(\rightarrow\) gg decays (top) and H \(\rightarrow\)\(\rm u\overline{\mbox{u}}\) decays (bottom). The calibration factors applied were those for b-jets (left) and those obtained for gluon jets and u-quark jets respectively (right)

### Jets reconstruction with Jet Finder library

The Jet Finder library [6-4] which contains different algorithms for clusters reconstruction was interfaced to ATLFAST. This provides flexible possibility to combine/cross-check full and fast simulation analyses. Detailed description on available algorithms and comparison of mass resolution and calibration coefficients can be found in [6-4]. The JetFinder Library can be activated with KEYJFF=1 (for KEYJF=0 the default cone algorithm is used). Choice of the required algorithm and its parameters have to be specified. For description see [6-4].

The same version of the jetFinder Library is used also by the full simulation DICE+ATRECON package.

Figure 3-7: The \(\rm p_{T}\) distribution for hard-process b-quarks (top), reconstructed b-labelled jets (middle) and calibrated b-labelled jets (bottom) for WH, H\(\rightarrow\) b��̄ process and low luminosity operation.

### b-tagging algorithm (in ATLFAST-B)

The fraction of \(\rm p_{T}\) of the b-labelled jet carried by the B-hadron is on average \(\sim\) 95% for a cone size of \(\Delta\)\(R\)=0.4. The b-jet itself, however, carries only on average \(\sim\)80% of the \(\rm p_{T}\) of produced b-quark. These numbers illustrate well some of the large differences between parton-level and particle-level simulations of b-quark reconstruction and of the b-tagging in a real experiment. In order to explore the expected Inner Detector environment, when attempting to tag b-jets, the expected numbers of charged particles found within the b-jet cone was studied in [6-9]. It was shown that a cone size of \(\rm\Delta R_{\rm cone}\)=0.4 is sufficient to measure more than 90% of the charged particles from the B-hadron decay. For a realistic threshold of \(\rm p_{T}\)\({}^{\rm particle}>\) 1 GeV and uncalibrated jets, this cone size includes on average \(\sim\) 4.8 charged tracks from B-hadron decay, \(\sim\) 2.4 charged tracks from the b-quark fragmentation and from the underlying event, and a negligible number (<0.2) from minimum bias pile-up at low luminosity. This average (for charged tracks from B-hadron) increases to \(\sim\) 5.2 for b-labelled uncalibrated jets. For calibrated jets it becomes respectively \(\sim\) 4.5  for any and \(\sim\) 5.1 for b-labelled jets.

The much more detailed understanding of the b-tagging performance achieved through the studies of [6-6] has permitted the implementation of a realistic parametrisation of the b-tagging performance into the fast simulation used for the study of the signal from WH, \(\rm H\)\(\rightarrow\)\(\rm b\overline{b}\) associated production. This parametrisation has been implemented in the following way [6-22]. The results from Section 6.7.6 of [6-6] for \(\rm m_{H}=100\) GeV have been adapted to account for the different methods used for labelling jet flavour in the full-simulation studies and in the fast simulation program (the latter has to treat many background sources with varying jet multiplicities and flavours). ATLFAST is labelling jets as b-jets and c-jets on the criteria that in the distance of \(\rm\Delta R_{\rm cone}\)=0.2 from the jet axis the heavy flavour quark after FSR with \(\rm p_{T}>5\) GeV was found. On the other hand algorithm which has been used in full simulation for defining the true b-jet bases on the charged track from B-hadron decay of \(\rm p_{T}>1\)GeV found around hard-b quark which initiated a jet [6-6]. In Table 3-7 matching between both algorithms is illustrated. b-quarks from hard process (hard-b), jets and b-labelled jets, without and with energy calibration (cluster were reconstructed down to \(\rm p_{T}^{\rm cluster}\)>10 GeV and after energy smearing accepted down to \(\rm p_{T}^{\rm jet}>15\) GeV) were accepted for \(\rm p_{T}^{\rm jet}>15\) GeV and B-hadron charged tracks with \(\rm p_{T}^{\rm track}>1.0\) GeV. Only in 0.3 -0.4 % of cases a jet was labelled as a b-jet in absence of a charged track from the B-hadron inside the jet cone. However asking for charged track inside the jet cone would give a better acceptance (89.7 % instead of 82.7 %) for the b-labelling of reconstructed jets (80.4 % instead of 75.7 % for non-calibrated jets). The direction of hard-b quark does not always coincide with the jet direction (as seen already on Figure 2-3 and Figure 2-4) and the efficiency for combination jet+track+hard-b to match inside \(\rm\Delta R_{\rm cone}<0.4\) is of 82.9 % for the cone around jet-axis and of 81.1% for the cone around hard-b. In Table 3-8 these efficiencies are compared for calibrated jets and two sizes of \(\rm\Delta R_{\rm cone}\) and for b-quark and gluon originated jets.

\begin{table}
\begin{tabular}{l|c|c|c} \hline \(\rm\epsilon_{track}\) & \(\rm\Delta R_{\rm cone}\) around hard-b & \(\rm\Delta R_{\rm cone}\) around jet axis & \(\rm\Delta R_{\rm cone}\) around b-jet axis \\ \hline \(\rm\Delta R_{\rm cone}\)=0.4, uncalibrat. & 4.21 & 4.77 & 5.18 \\ \hline \(\rm\Delta R_{\rm cone}\)=0.4, calibrat. & 4.21 & 4.46 & 5.06 \\ \hline \(\rm\Delta R_{\rm cone}\)=0.7 calibrat. & 4.23 & 4.45 & 5.08 \\ \hline \end{tabular}
\end{table}
Table 3-6: The average \(\rm\epsilon_{track}\)\(>\) multiplicity from B-hadrons for different values of \(\rm\Delta R_{\rm cone}\) and for \(\rm p_{T}^{\rm track}>1\)GeV and for WH, \(\rm H\)\(\rightarrow\)\(\rm b\overline{b}\) events.

\begin{table}
\begin{tabular}{|l|c|c|} \hline
**generated:** & **all jets** & **b-labelled jets** \\ \hline
**WH, H\(\rightarrow\)b\(\overline{\mbox{b}}\)** & & \\ \hline
1. jet & 99.9 \% ( 100 \%) & **82.7 \% ( 84.4 \% )** \\ \hline
2. jet + track & **89.7 \% ( 91.4 \% )** & 82.5 \% ( 84.2 \% )** \\ \hline
**WH, H\(\rightarrow\)gg** & & \\ \hline
1. jet & 99.9 \% ( 100 \% ) & 1.4 \% ( 1.5 \%) \\ \hline
2. jet + track & **2.4 \% (2.5 \%)** & 1.4 \% ( 1.5 \% \\ \hline \end{tabular}
\end{table}
Table 3-7: The matching between hard partons, charged tracks from B-hadrons, jets and b-labelled jets in the cone DR<0.4 for calibrated (uncalibrated ) jets. Normalized to the hard-process b-quark with pT>15 GeV, |h|<2.5. ISR switched off.

\begin{table}
\begin{tabular}{|l|c|c|} \hline
**generated:** **WH, H\(\rightarrow\)b\(\overline{\mbox{b}}\)** & **all jets** & **b-labelled jets** \\ \hline \hline \(\Delta\)R\({}_{\rm cone}\) around hard-b & \(\Delta\)R\({}_{\rm cone}\) around hard-b & \(\Delta\)R\({}_{\rm cone}\) around hard-b \\ \hline \hline
1. hard-b & 100 \% & \\ \hline
2. hard-b + track & 91.4 \% & \\ \hline
3. hard-b + jet & 83.7 \% ( 77.6 \% ) & 78 \% ( 73.4 \% ) \\ \hline
4. hard-b + jet + track & 81.1 \% ( 75.7\% ) & 77.7 \% ( 73.0 \% ) \\ \hline
5. hard-b + jet + no-track & 2.4 \% ( 1.9 \% ) & 0.5 \% ( 0.4 \% ) \\ \hline
6. hard-b + no-jet + track & 10.3 \% ( 15.6 \% ) & 13.7 \% ( 18.3 \% ) \\ \hline
7. hard-b + no-jet + no-track & 6.2 \% ( 6.8 \% ) & 8.1 \% ( 8.2 \% ) \\ \hline \hline \(\Delta\)R\({}_{\rm cone}\) around jet & \(\Delta\)R\({}_{\rm cone}\) around jet & \(\Delta\)R\({}_{\rm cone}\) around jet \\ \hline \hline
1. jet & 99.9 \% ( 87.1 \% ) & **82.7 \% ( 76.5 \% )** \\ \hline
2. jet + track & **89.7 \% ( 80.0 \% )** & 82.5 \% ( 76.2 \% ) \\ \hline
3. jet + hard-b & 86.2 \% ( 79.1 \% ) & 77.9\% ( 73.3 \% ) \\ \hline
4. jet + hard-b + track & 82.9 \% ( 76.2 \% ) & 77.7 \% ( 73.0 \% ) \\ \hline
5. jet + hard-b + no-track & 3.8 \% ( 2.9 \% ) & 0.4 \% (0.3 \%) \\ \hline
6. jet + no hard-b + track & 6.0 \% ( 3.8 \% ) & 4.7 \% ( 3.2 \% ) \\ \hline
7. jet + no hard-b + no-track & 7.1 \% ( 4.2 \% ) & 0.04\% (0.02 \%) \\ \hline \end{tabular}
\end{table}
Table 3-8: The same as Table 3-7 but for calibrated jets. The matching between calibrated jets, b-labelled jets and charged tracks from B-hadrons, in cone \(\Delta\)R\({}_{\rm cone}\)<0.4 (in cone \(\Delta\)R\({}_{\rm cone}\)=0.7). Normalized to hard-process partons with pT>15 GeV, |n|<2.5. ISR was switched off.

[MISSING_PAGE_FAIL:34]

Figure 3-8: Parametrisation for non-tau jet rejection for fixed value of tau-tagging efficiency (from top to bottom) 30%, 50%, 70% and central rapidity range \(|\)n\(|\) < 0.7.

Figure 3-9: Parametrisation for non-tau jet rejection for fixed value of tau-tagging efficiency of 50% and for (from top to bottom) \(|\)n\(|\)<0.7, 0.7<\(|\)n\(|\) <1.4 and 1.4 \(|\)n\(|\) < 2.5

## 4 More about tracks helix parameters reconstruction.

Main motivation for including helix parameters reconstruction for charged tracks in the fast simulation is its possible applicability to the B-physics studies.

For a given set of tracks parameters a smeared set is calculated with a good approximation to the current best estimate of the Inner Detector performance. Smearing is done according to the particle type. The three distinguished particle types are: electrons, muons and pions. All other charged particles are treated as pions.

The detailed description of the parametrisation for tracks resolution and reconstruction efficiency can be found in [6-24]. Resolution for muon tracks derived from the full simulation results is considered to have no tails within precision aimed for the fast parametrisation. Tracks of electrons are smeared initially as for muons but then their tracks parameters are altered by adding a parametrised effect of the bremsstrahlung process. Smearing for pions is described by the sum of two Gaussian contributions representing the core and the tail.

The tracks finding efficiency is also parametrised. All tracks which pass kinematical and geometrical selection are reconstructed with 100% efficiency by the ATLFAST but the expected reconstruction efficiency is however calculated and stored in the ntuple together with the tracks parameters.

Figure 4.1: Normalised resolution for helix parameters and reconstruction track efficiency for muons. (WH, H \(\rightarrow\) b\(\bar{\mathrm{b}}\) sample was generated).

Figure 4-2: Normalised resolution for helix parameters and reconstruction track efficiency for electrons. (WH, H \(\rightarrow\) b\(\bar{\text{b}}\) sample was generated)

Figure 4-3: Normalised resolution for helix parameters and reconstruction track efficiency for pions. (WH, H \(\rightarrow\) b\(\overline{\rm b}\) sample was generated)

## 5 Outlook

This second version of a somewhat elaborate particle-level simulation program, which incorporates most of the ATLAS detector global performance parameters, can be used for many studies, where the details of the ATLAS detector performance (non-Gaussian tails, cracks, etc...) are not of crucial importance. Till now it has been used for many physics studies performed inside Physics Working Groups of ATLAS Collaboration. Hopefully in the present version this package inadequate for many studies foreseen with the fast simulation for the Overall Performance Physics TDR.

The ATLFAST can be used as "stand-alone" but is also implemented into the ATGEN package [6-29] with the aim to have a complete tool for physics studies at the particle level abnd into the Combined Ntuple framework (CBNT) [6-32]of ATLAS reconstruction packages.

## 6 Reference

6-1 E. Richter-Was, D. Froidevaux and L. Poggioli, ATLAS Internal Note, PHYS-No-079 (1996)
6-2 E. Richter-Was, D. Froidevaux, F. Gianotti, L. Poggioli, D. Cavalli and S. Resconi, ATLAS Internal Note, PHYS-No-074 (1996).
6-3 ATLAS presentation on LHCC SUSY workshop, CERN, October 1996.
6-4 M. Bosman, I.C. Park, M. Cobal, D. Costanzo, S. Lami, R. Paoletti, G. Azuelos, K. Strahl, ATLAS Internal Note, ATL-SOFT-98-038 (1998) ;
6-5 ATLAS Collaboration, Calorimeter Performance Technical Design Report, CERN/LHCC/97-1, 15 January 1997.
6-6 ATLAS Collaboration, Inner Detector Technical Design Report, CERN/LHCC/97-16, ATLAS TDR 4, 30 April 1997.
6-7 ATLAS Collaboration, ATLAS Trigger Performance Status Report, CERN/LHCC/98-15, 30 June 1998.
6-8 A. DellAcqua et al, ATLAS Internal Note PHYS-No-102 (30 July 1997).
6-9 D. Froidevaux, E. Richter-Was, ATLAS Internal Note, PHYS-No-043 (1994);
6-10 D. Cavalli and S. Resconi, ATLAS Internal Note PHYS-No-100 (1996)
6-11 P. Savard and G. Azuelos, ATLAS Internal Note, ATL-PHYS-98-128 (1998).
6-12 ATLAS Collaboration Muon Spectrometer Technical Design Report, CERN/LHCC/97-22, ATLAS TDR 10, 31 May 1997.
6-13 ATLAS Technical Proposal, CERN/LHCC/94-43, 15 December 1994.
6-14 D. Froidevaux and E. Richter-Was, _The \(H\to\gamma\gamma\) channel in association with high \(E_{T}\)/\(E\) jets_, unpublished;
6-15 E. Richter-Was, D. Froidevaux, F. Gianotti, L. Poggioli, D. Cavalli and S. Resconi, ATLAS Internal Note, PHYS-No-048 (1995).
6-16 D. Rousseau, ATLAS Internal Note, INDET-N0-198, Phys-N0-119 (1998)
6-17 L. Poggioli, ATLAS physics meeting, Trest, 1995.

* [6-18] O. Linossier and L. Poggioli, ATLAS Internal Note, PHYS-No-075 (1995) and PHYS-No-101 (1997).
* [6-19] C. Guyot, private communication, July 1997.
* [6-20] M.Virchaux and L.Chevalier, private communication, July 1997.
* [6-21] L. Poggioli, D. Froidevaux and C. Guyot, ATLAS Internal Note, Phys-No-076 (1995).
* [6-22] E. Ross private commun. and [6-6].
* [6-23] D. Cavalli and S. Resconi, ATLAS Internal Note, ATLAS Phys-No-118 (1998).
* [6-24] E.J.Buis, R. Dankers, S. Haywood, A. Reichold. ATLAS Internal Note, INDET-No-195, December 1997; E.J.Buis, R. Dankers, A. Reichold, S. Haywood, F.G. Tartarelli, and N. labanca, ATLAS Internal Note, ATL-INDET-98-215 (1998).
* [6-25] OPAL Collaboration, CERN preprint CERN-PPE/95-126.
* [6-26] See transparencies from ATLAS Physics Workshop on SUSY Particles, Stockholm 18-19 January 1996 (Sweden).
* [6-27] T. Sjostrand, "High-Energy-Physics Event Generation with PYTHIA 5.7 and JETSET 7.4", CERN preprint CERN-TH.7111/93 and CERN-TH.7112/93.
* [6-28] G. Marchesini et al., Comput. Phys. Commun. **67** (1992) 465.
* [6-29] A. Amorim, "ATGEN-Monte Carlo interface using GENZ", ATLAS Internal Note, SOFT-No-010 (1995).
* [6-30] F. E. Paige and S. D. Protopopescu, Manual ISAJET 7.13.
* [6-31] The demonstration deck was preapared and tested by S. Klyukhin, email: klyukhin@mx.ihep.su
* [6-32] D. Rousseau, Combined Ntuple from ATLAS reconstruction packages, [http://atlasinfo.cern.ch/Atlas/GROUPS/PHYSICS/physics.html](http://atlasinfo.cern.ch/Atlas/GROUPS/PHYSICS/physics.html)

## Appendix A General comments about ATLFAST and ATLFAST-B

The simulation algorithm is run by a call to the routine ATLFAST.

The analysed events should be stored in COMMON /ATLEVENT/.

INTEGER N, K Event content

 REAL P, V

 COMMON/ATLEVENT/N,K(10000,5),P(10000,5),V(10000,5)

The conventions for the particle status, mother-daughter relations, particle codes etc. as in common block /LUJETS/ from PYTHIA generator should be assured by the user. Please, follow the manual [6-27]. Vertex position should be given in mm!.

The input/output logical identifiers should be defined in COMMON /ATLNOUT/

 INTEGER ATLINIP, ATLNOUT Input/output

 COMMON/ATLNOUT/ ATLINIP, ATLNOUT

The package uses one input data file, which contains the parameters for event analysis and triggering.

### Subroutine ATLFAST

This is the main routine called by the user to run the ATLFAST package. The following modes are implemented:

* MODE=-1 -- initialising, which should be called before the first event is analysed;
* MODE= 0 -- simulating, which should be called event by event;
* MODE= 1 -- closing, which should be called after the last event has been analysed.
* also it is possible to invoke additional modes for special purposes:
* MODE= 2 -- simulating event with a second set of values of the jet-cone reconstruction.

In this case the algorithm is repeated and ATLFAST common blocks are overwritten;

This routine calls other routines: MAKIOU, MAKFMT, MAKINF, MAKINI, MAKDMP, MAKCLU, MAKELE, MAKMUO, MAKPHO, MAKJET, MAKBJE, MAKCJE, MAKTAU, MAKTRA, MAKMIS, MAKMSC, MAKTRG, MAKUSE.

### Interface to event generators

The information on the simulated event is based on particle COMMON /ATLEVENT/ with the conventions for particle codes and inheritance as in the PYTHIA [6-27] generator. The examples of using PYTHIA, HERWIG[6-28], and ISAJET [6-30] as generators for simulated events are prepared as well as an example of reading events from GENZ tape [6-26]. ATLFAST is also interfaced to the ATGEN package [6-29] for ATLAS event generation and to the Combined Ntuple (CBNT) [6-32] from ATLAS reconstruction packages.

### Structure of the output from ATLFAST

The output of the algorithm consists of lists arranged in order of decreasing \(\mathrm{p_{T}}\), of selected isolated electrons COMMON /ISOELE/, isolated muons COMMON /ISOMUO/, non-isolated muons COMMON /NOISOMUO/, isolated photons COMMON /ISOPHO/, of reconstructed jets COMMON /JETALL/, and of the reconstructed \(\mathrm{p_{T}^{miss}}\) COMMON /PTMISS/. Each event is passed through a primitive trigger routine and the logical output from this routine is contained in the COMMON /TRIGER/. For specific studies one can also use the COMMON /CLUSTER/, where all hadronic clusters are kept, and the COMMON /CELLS/, which contains all cell-energy depositions.

In addition, some standard histograms are also filled, to give more information about the analysed sample. These histograms monitor multiplicity of isolated leptons, photons and jet multiplicities, the average shifts in \(\mathrm{E}\), \(\mathrm{p_{T}}\), \(\mathrm{\eta}\) and \(\mathrm{\phi}\) due to energy smearing, the mass distributions for lepton and jet pairs, etc. Another set of histograms keeps track of the differences between parton-level and particle-level analyses, by monitoring the kinematical variables of the original partons. These histograms should however be treated with some caution, since some of them are only correctly filled for certain physics processes, or certain option of the event generation.

SUBROUTINE ATLFNUP (in file atlfastntup.f) can be used for ntuples storage.

### User analysis with ATLFAST

The algorithm invokes the dummy routine SUBROUTINE MAKUSE where the user analysis can be implemented. This routine is called by the algorithm in the initialization, running and closing mode. In the running mode, it is called after each event is analysed by the algorithm.

### User analysis with ATLFAST-B

This set of routines is meant to facilitate user analysis of events simulated with ATLFAST and also provides parametrization for jet - recalibration and b-tagging and \(\mathrm{\tau}\)-tagging efficiencies. Event stored in CWNtuple (SUBROUTINE ATLFNUP in atlfastntup.f file) can be processed through the chain of routines ATLFEVE, ATLFPHO, ATLFLEP, ATLFJBJE, ATLFTAU, ATLFTRG (ATFPHO, ATLFLEP still dummy) in atlfast-b.f file to complete the simulation by ATLFAST of randomly applied efficiencies for tagging and identification. The output structure (incorporated in common blocks) is very similar to the ATLFAST one and provides the user with CRUDE (after ATLFAST) and DETECTED (after ATLFAST + ATLFAST-B) events. In SUBROUTINE ATLFASTB, in loops over already existing - ntuple, the user should build sequence of calls to ATLFXXX routines specific to his analysis (e.g. there is no point to identify \(\mathrm{\tau}\)-jets if they are of no interest) and supply the ATLFUSE routine which provides crude and detected events.

### Structure of the distributed version

ATLFAST is written in FORTRAN77, and its source code is splitted into several files and the input data are in one data file (for ATLFAST steering) and dedicated data files for muon resolution calculations, tracks parameter smearing and jetfinder library. The distributed version contains a set of UNIX subdirectories:

* contains main source code of ATLFAST in files: **atlfast.f**, **atlfastmuo.f** **atlfastind.f** **atlfastmsc.f** **atlfastntup.f** **and subdirectories:** **lib/id_atlfast, lib/jet_atlfast and lib/mu_atlfast**
* contains the input parameters set-up by the user in one single file **atlfast.dat** and as well as subdirectories with data files for JetFinder Library and used by smearing procedures: **mu_dat, id_dat, jet_dat.**
* **demo-pythia57**, **demo-pythia61, demo-pythia6103-isasusy**- are a demonstration directories for running with the PYTHIA generator
* is a demonstration directory for running with the ISAJET generator
* is a demonstration directory for running with the HERWIG generator
* is a demonstration directory for running with events stored on GENZ format tapes.
* contains source code of **ATLFAST-B** in one single file **atlfast-b.f** and and example how to use it.

Directory **atlfast** -rw-r- 1 erichter zzmm 553287 Aut 7 14:57 NOTE-ATLFAST-2.0.ps drwxr-x- 2 erichter zzmm 1024 Aut 7 13:40 data 1024 Aut 7 15:39 demo-atlfast-b drwxr-x- 2 erichter zzmm 1024 Aut 7 15:39 demo-genz 1024 Aut 7 14:57 demo-isajet drwxr-x- 3 erichter zzmm 1024 Aut 8 09:11 demo-herwig drwxr-x- 3 erichter zzmm 1024 Aut 8 09:11 demo-pythia57 drwxr-xr-x 6 erichter zp 2048 Jul 29 16:10 demo-pythia6103-isasusy drwxr-x- 2 erichter zzmm 1024 Aut 8 08:58 lib 192 Aut 6 17:33 makefile

Directory **atlfast/lib** -rw-r- 1 erichter zzmm 132569 Aut 8 08:58 atlfast.f -rw-r- 1 erichter zzmm 132569 Aut 8 08:58 atlfastind.f -rw-r- 1 erichter zzmm 132569 Aut 8 08:58 atlfastmsc.f -rw-r- 1 erichter zzmm 132569 Aut 8 08:58 atlfastmno.f drwxr-xr- 1 erichter zzmm 132569 Aut 8 08:58 atlfastmup.f drwxr-xr-x 6 erichter zp 2048 Jul 31 06:18 id_atlfast drwxr-xr-x 2 erichter zp 2048 Jul 29 12:36 jet_atlfast -rw-r-r- 1 erichter zp 573948 Aug 4 15:43 libatlfast.a drwxr-xr-x 2 erichter zp 2048 Jul 29 12:33 mu_atlfast -rw-r- 1 erichter zzmm 383 Aut 8 09:51 makefile

Directory **atlfast/data** -rw-r-r- 1 erichter zp 6395 Mar 1 19:19 atlfast.dat lrwxr-xr-x 1 erichter zp 22 Mar 7 14:55 id_data lrwxr-xr-x 1 erichter zp 22 Mar 7 14:55 jetdata lrwxr-xr-x 1 erichter zp 22 Mar 7 14:55 mu_data

[MISSING_PAGE_FAIL:46]

### demo-herwig

This directory contains a demonstration program for generation with HERWIG. The main program is **herwgen.f**. There is a **makefile** for building an executable. First the pointers to external libraries and datafiles on your favourite computer need to be defined in the makefile. The distribution should include:

-rW-r-r- 1 jesper **zp** 2173 Nov 19 16:49 README.txt

-rWxxr-r- 1 jesper **zp** 45 Nov 19 12:19 go

-rW-r-r-r- 1 jesper **zp** 7894 Nov 17 18:42 herwgen.f

-rW-r-r-r- 1 jesper **zp** 127303 Nov 17 16:06 hwudat.f

-rW-r-r- 1 jesper **zp** 1954 Nov 19 12:20 makefile

-rW-r-r-r- 1 jesper **zp** 338 Nov 19 11:09 test.datacard

To compile type **make** and to install type **make install**. To cleanup and remove all directories do make superclean if you need to reinstall. The directories created and their contents are (after you have executed the makefile).

_J_prod drwxr-xr-x 2 jesper **zp** 2048 Nov 21 16:03 data

-rWxxr-r- 1 jesper **zp** 45 Nov 21 16:03 go

Irwxr-xr-x 1 jesper **zp** 15 Nov 21 16:03 herw.par ->./test.datacard

-rWxxr-xr 1 jesper **zp** 3121632 Nov 21 16:04 herwgen.x

-rW-r-r- 1 jesper **zp** 338 Nov 21 16:03 test.datacard

_J_/prod/data/atlfast.dat - the ATLFAST data files copied from atlfast/data

Parameters are set in the test.datacard file that either needs to be linked or copied to herw.par which is the file that herwgen.x reads. After installation herw.par is linked to test.datacard. The following HERWIG parameters are read from the datacard file herw.par: IPROC, MAXEV, IPRINT, MAXPR, NRN(1), NRN(2), PTMIN, PTMAX, NSTRU. The colliding beams and their momenta are hardwired in herwgen.f. All other HERWIG parameters are set to their default value. Consult the HERWIG manual. All parameters can in principle be set in the datacard file, but then you need to include those parameters in **SUBROUTINE HERWCARD, which is using the FFREAD package**. (If you do so note that HERWIG real variables are defined to be double precision).

HERWIG stores the particles in HEPEVT format. It is converted with calls to the following routines:

**HERW2LU** -- converts HEPEVT to LUJET format (included in herwgen.f)

**ATLPYTHIA57** -- converts LUJET to ATLEVENT format (part of ATLFAST distribution, but is included in herwgen.f)The output files of the sample job are written to the prod directory.

The file fort.88 is the Sudakov table generated by HERWIG (see manual).

**To run:**

Go to directory prod and:

**herwgen.x > test.log&** or use script **go**

-> the normal atfast output is written to this directory

To remove atfast output one can use: **make cleanprod**

### demo-isajet

This directory contains a demonstration program for generation with ISAJET. The main program is isagene.f. There is a **makefile** for building an executable. First the pointers to external libraries and datafiles on your favourite computer need to be defined in the makefile. The distribution include:

-rw-r--- 1 jesper **zp 2127 Nov 19 22:19 README.txt**

-rwxr-r-- 1 jesper **zp 47 Nov 19 12:23 go**

-rw-r-r- 1 jesper **zp 4837 Nov 20 09:20 isagene.f**

-rw-r-r-r-- 1 jesper **zp 2194 Nov 19 14:35 makefile**

-rw-r-r-- 1 jesper **zp 169 Nov 20 08:57 test.datacard**

To compile type **make** and to install type **make install**.

To cleanup and remove all directories do make superclean if you need

to reinstall. The directories created and their contents are

(after you have executed the make install):

/prod/ drwxr-xr-x 2 jesper **zp 2048 Nov 21 16:08 data**

-rwxr-r-- 1 jesper **zp 47 Nov 21 16:08 go**

drwxr-xr-x 2 jesper **zp 2048 Nov 21 16:08 isadata**

-rwxr-xr-x 1 jesper **zp 12007448 Nov 21 16:09 isagene.x**

-rwxr-xr 1 jesper **zp 15 Nov 21 16:08 isajet.par ->./test.datacard**

-rw-r-r-- 1 jesper **zp 169 Nov 21 16:08 test.datacard**

/prod/data/atlfast.dat -- atlfast settings**

You need change the LSP code to be 67

/prod/isadata/isadecay.dat -- the ISAJET decaytableAll parameters for ISAJET generation are read from the datacard file **isajet.par**. All parameters can be set in the datacard file. For the parameter descriptions consult the ISAJET manual. The LSP particle code need to be set in the atlfast.dat - **SPYTHIA uses particle code 66 for the LSP** and **ISAJET particle code 67**. Before generation copy or link your datacard file to **isajet.par**. After installation **isajet.par** is linked to **test.datacard**

The output files for the sample job will be written to the prod directory.

ISAJET stores the particles in its own event format. It is converted with calls to the following routines:

**ISAHEP(1)**: - converts from ISAJET to HEPEVT format (part of ISAJET distribution)
**HEP2LU**: - converts HEPEVT to LUJET format (included in isagene.f)
**ATLPYTHIA57 - converts LUJET to ATLEVENT** format (part of ATLFAST distribution, but is included in isagene.f)

The output files of the sample job are written to the prod directory.

**To run:**

Go to directory prod and:

**herwgen.x > test.log& or use script go**

> the normal atlfast output is written to this directory

To remove atlfast output one can use: **make cleanprod**

#### a.6.4 demo-genz

This directory contains a demonstration program **demo.f**, which simulates events stored onto the tape in GENZ format. The event is read form the file ZEBRA.P (the modified version of routines READJOB and GNZOPEN by R. DeWolf are used), stored in the COMMON /ATLFEVE/ and analysed by ATLFAST algorithm. The input data are read from the file **atlfast.dat** in subdirectory **data** and the outputs of the program are written to the subdirectory **demo-genz/prod** in a file **demo.out** and ntuple in a file **atlfast.ntup**.

Directory **atlfast/demo-genz**

 lrwxr-xr-x 1 erichter zp 39 Aut 4 14:30 ZEBRA.P->...... -rw-r-r- 1 erichter zp 13265 Aut 4 15:49 demo.f -rw-r- 1 erichter zp 268764 Aut 8 12:11 libgenz.a -rw-r- 1 erichter zp 831 Aut 4 15:58 makefile -drwxr-x- 2 erichter zp 2048 Aut 4 15:56 prod

The user should however check if the _COMMON /ATLFEVENT/_ is correctly filled (correct status of particles and particle code) if the event stored on tape were generated by generator other then PYTHIA generator.

### demo-atflast-b

This directory contains the source code of ATLFAST-B in **atflast-b.f** file, the histograms used for jets recalibration in **atfl_calibration.hbook**, and in **atfl_analiza.kumac** with example of analysis done with ATLFAST-B on ntuple **atflast.nup** with simulated WH, H\(\rightarrow\) bb events **.** The **atfl_histos.kumac** defines histograms and **atfl_nice.kumac** gives nice graphics. The **atfl_analiza.hbook** contains stored histograms of the results of analysis.

The main ingredients of **atflast-b.f** are routines: **ATLFCAL**, **ATLFBJE**, **ATLFTAU** for jets energy calibration, b-tagging and \(\tau\)-tagging simulations.

Directory **atflast/demo-atflast-b**

drwxr-xr-x 2 erichter zp 2048 Aug 1 16:47. drwxr-x--- 10 erichter zp 2048 Jul 22 14:41.. -rw-r-r-- 1 erichter zp 16384 Jul 22 11:15 atlf_anal.hbook -rw-r--- 1 erichter zp 14265 Aug 1 16:47 atlf_analiza.f -rw-r--- 1 erichter zp 282 Jul 22 11:01 atlf_analiza.kumac -rw-r--r-- 1 erichter zp 16384 Jul 18 16:41 atlf_calibration.hbook -rw-r--- 1 erichter zp 471 Jul 22 11:14 atlf_histos.kumac -rw-r--- 1 erichter zp 287 Jul 18 18:07 atlf_nice.kumac -rw-r--r-- 1 erichter zp 4411392 Jul 18 16:27 atlfast.ntup

[MISSING_PAGE_FAIL:51]

\begin{table}
\begin{tabular}{r l l} \hline \hline
1 & — & LPAR(4) &...Smearing on=1, off=0 \\
3 & — & LPAR(5) &...Smear for muons: muon=1, track=2, combin=3 \\
2 & — & LPAR(15) &...Smear for muons: exact=1, approxim =2 \\
66 & — & LPAR(6) &...Code for SUSY LSP particle \\
10 & — & LPAR(7) &...Number of events to be printed \\
0 & — & LPAR(11) &...track/finding on=1, off=0 \\
011 & — & LPAR(12) &...ID config.: 011=B-layer, no vertex constr, uniform B-field \\
2 & — & LPAR(112) &...ID reconstrt cuts: 1=btag cuts; 2=btag+TR cuts \\
0 & — & LPAR(13) &...JetFinder switch: 0= cone algorithm; 1=JetFinder algorithms \\
0 & — & LPAR(14) &...muon trigger labelling: off=0, on=1 \\ C—— & Parameters for MAKCLU \\
10.000 & — & YPAR(10) &...Minimum E\_T for calo cluster \\
0.400 & — & YPAR(11) &...Cone Delta R & for barrel & set 1 \\
0.400 & — & YPAR(16) &...Cone Delta R & for forward & set 1 \\
0.700 & — & YPAR(111) &...Cone Delta R & for barrel & set 2 \\
0.700 & — & YPAR(116) &...Cone Delta R & for forward & set 2 \\
5.000 & — & YPAR(12) &...Rapidity coverage for calorimeter \\
1.500 & — & YPAR(13) &...Min E\_T for cluster initiator \\
0.500 & — & YPAR(14) &...Min p\_T for B-field \\
0.000 & — & YPAR(15) &...Min E\_T for cell \\
3.000 & — & YPAR(17) &...Barrel/fwd transition in eta in CALO \\
0.100 & — & YPAR(18) &...Granularity in eta (barrel), 2x in fwd \\
0.100 & — & YPAR(19) &...Granularity in phi (barrel), 2x in fwd \\
0 & — & LPAR(10) &...Cells energy sharing in clusters on/off \\ C— & Parameters for MAKMUO \\
6.000 & — & YPAR(20) &...Minimum muon momentum \\
2.500 & — & YPAR(21) &...Maximum muon eta \\
0.400 & — & YPAR(27) &...Min cone R separation from clusters for muon & isol. \\
0.200 & — & YPAR(28) &...Delta R cone & for energy deposition \\
10.000 & — & YPAR(29) &...Max energy deposition for isolation \\ C— & Parameters for MAKPHO \\
5.000 & — & YPAR(30) &...Minimum photon momentum \\
2.500 & — & YPAR(31) &...Maximum photon eta \\ \hline \hline \end{tabular}
\end{table}
Table 1: List of parameters read by the SUBROUTINE MAKINI from atffast.dat. Parameters for the event analysis. The default values are quoted in front of each parameter’s name and definition.

\begin{table}
\begin{tabular}{r r r} \hline
0.100 & — & YPAR(35) &...Delta R for photon matching to cluster \\
0.400 & — & YPAR(37) &...Min cone R separation from clusters for photon isolation \\
0.200 & — & YPAR(38) &...R\_cone for energy deposition \\
10.000 & — & YPAR(39) &...Max energy deposition for isolation \\ C— Parameters for MAKELE & \\
5.000 & — & YPAR(40) &...Minimum electron momenta \\
2.500 & — & YPAR(41) &...Maximum electron eta \\
0.100 & — & YPAR(45) &...Delta R for electron matching to cluster \\
0.400 & — & YPAR(47) &...Min cone R separation from clusters for electron isolation \\
0.200 & — & YPAR(48) &...R\_cone for energy deposition \\
10.000 & — & YPAR(49) &...Max energy deposition for isolation \\ C— Parameters for MAKJET & \\
15.000 & — & YPAR(51) &...Minimum E\_T for jet \\
5.000 & — & YPAR(52) &...Rapidity coverage for jets \\ C— Parameters for MAKJBE & \\
5.000 & — & YPAR(60) &...Minimum b-quark p\_T(after FSR) for b-jet matching \\
2.500 & — & YPAR(61) &...Maximum b-quark eta for b-jet matching \\
0.200 & — & YPAR(62) &...Delta R for b-jet matching to b-quark \\ C— Parameters for MAKJCJE & \\
5.000 & — & YPAR(70) &...Minimum c-quark p\_T(after FSR) for c-jet matching \\
2.500 & — & YPAR(71) &...Maximum c-quark eta for c-jet matching \\
0.200 & — & YPAR(72) &...Delta R for c-jet matching to c-quark \\ C— Parameters for MAKMIS & \\
0.000 & — & YPAR(80) &...Minimum E\_T for unused cells \\ C—parameters for MAKTAU & \\
10.000 & — & YPAR(90) &...minimum tau-had pt for tau-jet label \\
2.500 & — & YPAR(91) &...maximum tau-eta for tau-jet label \\
0.300 & — & YPAR(92) &...max R\_tauj for tau-jet \\
0.900 & — & YPAR(93) &...min ratio for tau-hadron/jet momentum \\ C—parameters for MAKTRA & \\
0.500 & — & YPAR(100) &...minimum pt for track \\
2.500 & — & YPAR(101) &...maximum eta for track \\ \hline \end{tabular}
\end{table}
Table 1: List of parameters read by the SUBROUTINE MAKINI from atffast.dat. Parameters for the event analysis. The default values are quoted in front of each parameter’s name and definition.

\begin{table}
\begin{tabular}{l l} \hline C\(\cdot\cdot\cdot\cdot\) & parameters for MAKTRG \\ C\(\cdot\cdot\cdot\cdot\) & isolated electron/photon trigger\(\cdot\cdot\cdot\cdot\) & \\
2.5 & \(\cdot\cdot\) & TPAR(9,1) \(\cdot\) \(\cdot\) eta-coverage for electrons/photons \\
20.0 & \(\cdot\cdot\) & TPAR(1,1) \(\cdot\) \(\cdot\) Minimum p\(\cdot\)T for 1 electron low lumi \\
30.0 & \(\cdot\cdot\) & TPAR(1,2) \(\cdot\) \(\cdot\) \(\cdot\) high lumi \\
40.0 & \(\cdot\cdot\) & TPAR(2,1) \(\cdot\) \(\cdot\) Minimum p\(\cdot\)T for 1 photon low lumi \\
60.0 & \(\cdot\cdot\) & TPAR(2,2) \(\cdot\) \(\cdot\) \(\cdot\) high lumi \\
15.0 & \(\cdot\cdot\) & TPAR(3,1) \(\cdot\) \(\cdot\) Minimum p\(\cdot\)T for 2 ele/phot low lumi \\
20.0 & \(\cdot\cdot\) & TPAR(3,2) \(\cdot\) \(\cdot\) high lumi \\ C\(\cdot\cdot\cdot\) & muon trigger\(\cdot\cdot\cdot\cdot\) & \\
2.4 & \(\cdot\cdot\) & TPAR(19,1) \(\cdot\) eta-coverage for muons \\
6.0 & \(\cdot\cdot\) & TPAR(11,1) \(\cdot\) Minimum p\(\cdot\)T for 1 iso. muon low lumi \\
20.0 & \(\cdot\cdot\) & TPAR(11,2) \(\cdot\) \(\cdot\) high lumi \\
15.0 & \(\cdot\cdot\) & TPAR(12,1) \(\cdot\) Minimum p\(\cdot\)T for 1 muon low lumi \\
30.0 & \(\cdot\cdot\) & TPAR(12,2) \(\cdot\) \(\cdot\) high lumi \\
6.0 & \(\cdot\cdot\) & TPAR(13,1) \(\cdot\) Minimum p\(\cdot\)T for 2 muons low lumi \\
10.0 & \(\cdot\cdot\) & TPAR(13,2) \(\cdot\) \(\cdot\) high lumi \\
6.0 & \(\cdot\cdot\) & TPAR(14,1) \(\cdot\) Minimum p\(\cdot\)T for 2 iso. muons high lumi \\ C\(\cdot\cdot\cdot\) & electron/muon trigger\(\cdot\cdot\cdot\cdot\) & \\
2.5 & \(\cdot\cdot\) & TPAR(28,1) \(\cdot\) eta-coverage for electrons \\
2.4 & \(\cdot\cdot\) & TPAR(29,1) \(\cdot\) \(\cdot\) eta-coverage for muons \\
5.0 & \(\cdot\cdot\) & TPAR(21,1) \(\cdot\) \(\cdot\) Minimum p\(\cdot\)T for iso. ele low lumi \\
15.0 & \(\cdot\cdot\) & TPAR(21,2) \(\cdot\) \(\cdot\) high lumi \\
6.0 & \(\cdot\cdot\) & TPAR(22,1) \(\cdot\) \(\cdot\) Minimum p\(\cdot\)T for muon \\
6.0 & \(\cdot\cdot\) & TPAR(22,2) \(\cdot\) \(\cdot\) high lumi \\ C\(\cdot\cdot\cdot\) & jet trigger\(\cdot\cdot\cdot\cdot\) & \\
3.2 & \(\cdot\cdot\) & TPAR(39,1) \(\cdot\) eta-coverage for jets \\
300.0 & \(\cdot\cdot\) & TPAR(31,1) \(\cdot\) \(\cdot\) Minimum p\(\cdot\)T for 1 jet low lumi \\
300.0 & \(\cdot\cdot\) & TPAR(31,2) \(\cdot\) \(\cdot\) high lumi \\
80.0 & \(\cdot\cdot\) & TPAR(32,1) \(\cdot\) \(\cdot\) Minimum p\(\cdot\)T for 3 jets low lumi \\
100.0 & \(\cdot\cdot\) & TPAR(32,2) \(\cdot\) \(\cdot\) high lumi \\
3

### Subroutine MAKCLU

This routine deposits the transverse energies of undecayed particles (i.e. those with 0 < K(I,1) < 10 in COMMON /ATLFEVENT/, (except neutrinos, muons and SUSY LSP) in \(\eta\)\(\times\)\(\phi\) cells with default granularity: 0.1 \(\times\) 0.1 for \(|\eta|\) <3 and 0.2 \(\times\) 0.2 for \(|\eta|\) >3. This granularity can be modified, but with the limitation that the granularity of cells beyond the barrel/forward transition (\(|\eta|\) = 3) is twice as large as inside. The algorithm then groups these cells into clusters of cone \(\Delta\)R stored in COMMON /CLUSTER/ if sum of their transverse energy is above a threshold value. The \(\Delta\)R is set separately for barrel and forward parts. The same event can be also analysed with two different sets for the \(\Delta\)R.

The energies deposited in the cells are stored also in a cell map in COMMON /CELLS/. Cells used for cluster reconstruction are flagged (KCELL(I,5)=0). The effect of the solenoidal magnetic field is only parametrised as a shift in the \(\phi\)-position of charged particles, which is calculated by the FUNCTIONFLDPHI. Charged particles with \(\mathrm{p_{T}}\) below the default threshold of 0.5 GeV are not stored if the magnetic field is on.

For KEYJF=0 default cone algorithm is executed for clusters reconstruction. There is the possibility to activate the energy sharing of cells belonging to overlapping jets (default: no sharing). In that case the corresponding cell energy is shared according to the relative energies of each overlapping jet.

For KEYJF=1 the JetFinder library is called and the algorithm requested in **jetfinder.dat** datac-ard is activated.

The common block filled by this routine is:

INTEGER NCLU, KCLU for reconstructed clusters

REAL PCLU

COMMON/CLUSTER/NCLU,KCLU(100,5),PCLU(100,5)

INTEGER NCMIN, NCMAX, KCELL for energy deposition in cells

REAL PCELL

COMMON /CELLS/ NCMIN, NCMAX, KCELL(4000,5),PCELL(4000,5),

where the vector \(\mathrm{PCLU}(\mathrm{I},5)=(\eta^{\mathrm{init}},\phi^{\mathrm{init}},\eta^{ \mathrm{clu}},\phi^{\mathrm{clu}},\mathrm{E_{T}}^{\mathrm{clu}})\) contains the coordinates of reconstructed cluster I. The variables \(\mathrm{\eta^{init}},\phi^{\mathrm{init}}\) denote the position of the cluster initiator cell (geometrical centre of the cluster) and the variables \(\mathrm{\eta^{clu}},\phi^{\mathrm{clu}}\) denote the position of the \(\mathrm{E_{T}}\)-weighted centre of the cluster (centre-of-gravity of the cluster). The variable \(\mathrm{E_{T}}^{\mathrm{clu}}\) is the transverse energy of the cluster. The variable NCLU is the number of reconstructed clusters. The array KCLU contains KCLU(I,1)=I, KCLU(I,2)=98,KCLU(I,3) the number of cells used for the reconstruction of cluster I,,KCLU(I,4) the number of particles assigned to cluster I, and KCLU(I,5)=1. If the cluster is accepted as a jet by routine MAKJET, then KCLU(I,5)=0. Clusters are arranged in order of decreasing \(\mathrm{E_{T}}\).

The vector \(\mathrm{PCELL}(\mathrm{I},5)=(\eta^{\mathrm{cell}},\phi^{\mathrm{cell}},\eta^{ \mathrm{cell}},\phi^{\mathrm{cell}},\mathrm{E_{T}}^{\mathrm{cell}})\) contains the coordinates of all cells; NCMIN and NCMAX are the minimum and maximum indices of the cells and KCELL(I,5) is set to 0 for cells belonging to reconstructed clusters.

### Subroutine MAKMRO

This routine searches for muons, by scanning through the COMMON /ATLFEVENT/. If a muon is found, its momentum is smeared using FUNCTION RESMUO. Three options for muon-momentum smearing are available: stand-alone Muon System (KEYMUO=1), Inner Detector alone (KEYMUO=2) and combined (KEYMUO=3). The parametrization for the momentum smearing is coded in FUNCTION RESMUO (exact and approximate parametrization are available for resolution from Muon System). Isolated muons are stored in COMMON /ISOMUO/. Non-isolated muons are stored in COMMON /NOISOMUO/. Muons outside the \(\eta\)-coverage or below the \(p\)_T_-threshold are lost.

 INTEGER NMUO, KMUO KMUORG for isolated muons  REAL PMUO  COMMON/ISOMUO/NMUO,KMUO(100,5),PMUO(100,5),KMUOTRG(100)  INTEGER NMUOX, KMUOX,KMUOXTRG for non-isolated muons  REAL PMUOX  COMMON/NOISOMUO/NMUOX,KMUOX(100,5),PMUOX(100,5),KMUOXTRG(100) where the vector PMUO(I,5)=(\(\eta^{\mu}\), \(\phi^{\mu}\), \(\eta^{\mu}\), \(\phi^{\mu}\), \(\rho_{T}^{\mu}\)) contains the coordinates of the isolated muon I. The variable NMUO denotes the number of isolated muons and the array KMUO contains KMUO(I,1)=I, KMUO(I,2) the muon KF-code, KMUO(I,3) the position of the muon in COMMON /ATLFEVENT/, KMUO(I,4) the muon-mother KF-code and KMUO(I,5)=I. COMON/NOISOMUO/ is analogous (respective variables are called NMUOX, KMUOX) for non-isolated muons. If a non-isolated muon is added to a calorimeter cluster in SUBROUTINE MAKJET, it is flagged by setting KMUOX(I,5)=0.

KMUOTRG and KMUOXTRG gives muon trigger flag which is filled in routine MAKTRG.

### Subroutine MAKELE

This routine searches for isolated electrons, by scanning through the COMMON /ATLFEVENT/. If an electron is found, its energy is smeared using FUNCTION RESELE. Different energy-smearing for low luminosity (KEYLUM=1) and high luminosity (KEYLUM=2) can be invoked. Isolated electrons are stored in COMMON /ISOELE/ and the energy clusters associated with them are removed from COMMON /CLUSTER/. Non-isolated electrons remains clasified as cluster-type energy deposition.

 INTEGER NELE, KELE for isolated electrons  REAL PELE  COMMON/ISOELE/NELE,KELE(100,5),PELE(100,5), where the vector PELE(I,5)=(\(\eta^{e}\), \(\phi^{e}\), \(\eta^{e}\), \(\phi^{e}\), \(\rho_{T}^{e}\)) contains the coordinates of isolated electron I. The variable NELE denotes the number of isolated electrons and the array KELE(I,1) contains KELE(I,1)=I,KELE(I,2) the electron KF-code, KELE(I,3) the position of the electron in COMMON /ATLFEVENT/,KELE(I,4) the electron-mother KF-code and KELE(I,5)=1.

### Subroutine MAKPHO

This routine searches for isolated photons, by scanning through the COMMON /ATLFEVENT/. If a photon is found, its energy is smeared using FUNCTION RESPHO and its polar angle using FUNCTION RESTHE. Different energy smearings for low luminosity (KEYLUM=1) and high luminosity (KEYLUM=2) can be invoked. Isolated photons are stored in the COMMON /ISOPHO/ and the energy clusters associated with them are removed from the COMMON /CLUSTER/. Non-isolated photons are not considered further.

 INTEGER NPHO, KPHO  for isolated electrons  REAL PPHO  COMMON/ISOPHO/NPHO,KPHO(100,5),PPHO(100,5), where the vector PPHO(I,5)=(\(\eta^{\gamma}\), \(\phi^{\gamma}\), \(\eta^{\gamma}\), \(\phi^{\gamma}\), \(\rm p_{T}^{\gamma}\)) denotes coordinates of the isolated photon I. The NPHO denotes number of isolated photons and the array KPHO contains KPHO(I,1)=I, KPHO(I,2) the photon KF code, KPHO(I,3) the position of the photon in COMMON /ATLFEVENT/,KPHO(I,4) the photon-mother KF-code and KPHO(I,5)=1.

### Subroutine MAKJET

This routine scans through the clusters remaining in COMMON /CLUSTER/ after the isolated leptons and photons have been identified. The cluster energies are smeared using FUNCTION RESHAD. The non-isolated muons from the COMMON /NOISOMUO/, if falling into a given cluster cone, are included in the cluster energy and such muons are flagged with KMUOX(I,5)=0. The clusters passing the acceptance criteria for jets are copied to COMMON /JETALL/ and such clusters are flagged with KCLU(I,5)=0.

 INTEGER NJET, KJET  for jets  REAL PJET  COMMON/JETALL/NJET,KJET(100,5),PJET(100,5), where the vector PJET(I,5)=(\(\eta^{\rm init}\), \(\phi^{\rm init}\), \(\eta^{\rm jet}\), \(\phi^{\rm jet}\), \(\rm p_{T}^{\rm jet}\)) contains the coordinates of jet I. The variable NJET denotes the number of the reconstructed jets, and the array KJET contains KJET(I,1)=I,KJET(I,2)=98,KJET(I,3) the number of cells used for reconstruction, KJET(I,4) the number of particles assigned to jet I, and KJET(I,5)=1.

### Subroutine MAKJBJE

This routine selects jets which can be associated to b-quarks, by scanning through COMMON /ATLFEVENT/. b-quarks (after FSR), which pass the acceptance cuts in \(\rm p_{T}\) and \(\eta\) are identified. For each of these b-quarks, a reconstructed jet associated with it is searched for. These jets are labelled as b-jets if certain acceptance criteria are fulfilled, and KJET(I,2) is the KF-code of the b-quark which is matched to b-jet I.

### Subroutine MAKcJE

This routine selects jets which can be associated to c-quarks, by scanning through the COMMON /ATLFEVENT/. c-quarks (after FSR), which pass the acceptance cuts in \(pT\) and \(\eta\) are identified. For each of these c-quarks, a reconstructed jet associated with it is searched for. These jets are labelled as c-jets if certain acceptance criteria are fulfilled, and KJET(I,2) is the KF-code of the c-quark which is matched to c-jet I.

### Subroutine MAKTAU

This routine select jets which can be associated with \(\tau\)-leptons decaying hadronically. The COMMON /ATLFEVENT/ is scanned for hadronic decays of \(\tau\)-leptons and if they pass the acceptance criteria and associated jet is found, such jet is labelled with KJET(I,2) equal to the KF code of the \(\tau\)-leptons.

### Subroutine MAKTAU

This routine reconstructs charged tracks and stores in the COMMON /TRACKS/ the information-about particle position in the /ATLFEVENT/ common block, the particle code, the tracks parameters (\(\alpha_{0}\), \(z_{0}\), \(\phi\), \(\cot(\theta)\), \(q/p_{T}\)) before and after smearing and calculates 15 correlation coefficients.

 COMMON /TRACKS/ NTRA,KPTRA(500),KFTRA(500),

+ KPM1TRA(500),KFMITRA(500),KPM2TRA(500),KFM2TRA(500),

+ KPM3TRA(500),KFM3TRA(500),KPM4TRA(500),KFM4TRA(500),

+ KPM5TRA(500),KFM5TRA(500), KPM6TRA(500),KFM6TRA(500),

+ D0TRACRU(500),Z0TRACRU(500), PHITRACRU(500),

+ COTTRACRU(500), PTINVTRACRU(500),

+ D0TRA(500), Z0TRA(500),PHITRA(500), COTTRA(500),PTINVTRA(500),

+ CORR11(500), CORR21(500),CORR31(500), CORR41(500),CORR51(500),CORR22(500),

+ CORR32(500),CORR42(500),CORR52(500), CORR33(500),CORR43(500),CORR53(500),

+ CORR44(500),CORR54(500),CORR55(500), EFFTRA(200), ISTATRA(200)

NTRA denotes number of tracks, KPTRA - particle position in /ATLFEVENT/, KFTRA-particle code, KPM1TRA, KFM1TRA- position and code of the first mother, and respectively up to the 6-th mother, AOTRA, Z0TRA, PHITRA, COTTRA, PTINVTRA- values of tracks parameters (\(a_{0}\), \(z_{0}\), \(\phi\), \(cot(\theta)\), \(q/p_{T}\)) after smearing, and with extension CRU before smearing. In case smearing is not activated (KEYSME=0) smeared and unsmeared values are identical. CORR11...CORR55 denote correlations coefficients. EFFTRA denotes the efficiency for track reconstruction which is calculated but not applied. ISTATRA denotes the status of the track: ISTATRA=0 for correctly reconstructed tracks, ISTATRA=1 if reconstruction fails. In this case the values for CORRxx and xxTRA are put to zero.

### Subroutine MAKMIS

This routine calculates the total missing transverse energy in the event. The transverse energies of cells not used for cluster reconstruction are smeared using FUNCTION RESHAD. The total measured transverse momenta \(p_{x}^{\,\mathrm{obs}}\) and \(p_{y}^{\,\mathrm{obs}}\) are obtained by summing over jets, isolatedleptons and photons, non-isolated muons which were not added to clusters, unused clusters, unused cells. The total missing transverse momenta \(\rm p_{\rm x}^{\rm miss}\), \(\rm p_{\rm y}^{\rm miss}\) are calculated as \(\rm p_{\rm x}^{\rm miss}\) = - \(\rm p_{\rm x}\). \(\rm{{}^{\rm obs}}\) and \(\rm p_{\rm y}^{\rm miss}\)= - \(\rm p_{\rm y}^{\rm obs}\), and finally \(\rm E_{\rm T}^{\rm miss}=\int(\rm p_{\rm x}^{\rm miss})^{2}+(\rm p_{\rm y}^{\rm miss })^{2}\). The sum of the momenta of all particles escaping detection is also calculated in this routine.

 REAL PXMISS,PYMISS,PXNU, PYNU for missing energy

 COMMON /PTMISS/ PXMISS,PYMISS,PXNU, PYNU,

where PXMISS,PYMISS denote the reconstructed missing transverse energy components and PXNU,PYNU denote the sum of momenta components of particles escaping detection (muons outside detector acceptance, neutrinos and SUSY LSP).

### Subroutine MakMSC

This routine provides miscellaneous information about event itself: circularity, trust and oblateness:

 REAL CIRCJET, CIRCEVE, THRUST, OBL
 COMMON /MISCELAUS/CIRCEVE, THRUST, OBL

Where CIRCEVE denotes the circularity calculated respectively from jets and from cells. THRUST and OBL represent respectively the thrust axis and the oblateness of the event.

### Subroutine MakTRG

This routine apply muon trigger efficiency to isolate and nonisolated muons. The flag KTRG-MUO=0 (KEYTRGMUOX=0) in common blocks /ISOMUO/ and /NOISOMUO/ is given for not triggered muons while this flag is put to 1 for triggered with low \(\rm p_{\rm T}\)-threshold and put to 2 for triggered muons with high \(\rm p_{\rm T}\)-threshold (as parametrised in [6-8]). Please note, that first high-\(\rm p_{\rm T}\) threshold is checked and only if it is failed the low-\(\rm p_{\rm T}\) threshold is checked.

Further the primitive trigger routine provides nine types of trigger selection:

\(\bullet\) one isolated electron TRGEM1

\(\bullet\) one isolated photon TRGPH1

\(\bullet\) two isolated electrons/photons TRGEM2

\(\bullet\) one muon TRGMU1

\(\bullet\) two muons TRGMU2

\(\bullet\) electron-muon pairs TRGMUE

\(\bullet\) one jet TRGJT1

\(\bullet\) three jets TRGJT3

\(\bullet\) four jets TRGJT4

[MISSING_PAGE_FAIL:60]

### Subroutine ATLFNUP

ATLFAST package (file **alfalfantup.f**) provides routine for ntuple storage which can facility usage of the ATLFAST-B routines. The provided a CWN format takes e.g. \(\sim\)0.66 MB for 1000 events H \(\rightarrow\) u\({}^{+}\)u\({}^{+}\)u\({}^{+}\)u\({}^{-}\) (with /PTRACKS/ and /BPHYSICS/ empty, means executed with KEYTRA=0), or almost 1.2 MB for 1000 events WH, H\(\rightarrow\) b\(\overline{\text{b}}\) with stored information from /PTRACKS/ and /BPHYSICS/.

Not full information contained in common blocks /ISOPHO/, /ISOMUO/, /JETALL/ etc. is stored into ntuple and it is up to the user to modify format of CWNtuple if more information is needed for his analysis.

C Parametrization for the energy/momenta resolution, B-field effect and muon trigger efficiency

When available, the most detailed parametrization of the detector response has been used. Sometimes a cruder parametrization has been adapted to reproduce full simulation results. The expressions used here are straightforward to update, and will evolve with the better understanding and defining of the various parts of the detector.

### Subroutine Resmuo

The parametrization for the muon momentum resolution derived from [6-19]-[6-24] is used. Three options for these parametrization are possible:

* The stand-alone Muon System momentum resolution \(\sigma_{\mu}\) is parametrised as a function of the \(p_{T}\) the azimuth \(\phi\) and pseudorapidity \(|\eta|\), taking into account the effect of the toroidal magnetic field. Two options are available: approximation [6-19] (KEYFUN=1) (default) and [6-20] fast calculation which make use of the field map and the layout data base ( KEYFUN =2). Both of them correspond to the spectrometer layout as in the [6-8] and give similar mass resolutions e.g.. for \(H\to\mu^{+}\mu^{+}\mu^{+}\mu^{-}\).
* \(p_{\mbox{smeared}}^{\mu}\ =\ \frac{p^{\mu}_{\rm true}}{(1+\sigma)}\)
* The Inner Detector resolution is parametrised as described in [6-21].
* The combined measurement of the muon 4-momenta are evaluated combining with the weighted technique the expected resolution from Inner Detector stand-alone and muon-system stand-alone.

### Function Respho

The parametrization of the photon energy resolution is taken from the LARG group. The parametrization is given for low and high luminosity performance, in the second case the effect from pile-up is included also. These formulae are a good approximation but not fully correct, specially when treating independently the electronic noise and pile-up contributions.

\[\frac{\delta E_{\gamma}}{E_{\gamma}}\ =\ \frac{0.10}{\sqrt{E_{\gamma}}}\oplus \frac{0.245}{E_{\gamma}^{T}}\oplus 0.007\]\[\frac{\delta\mathrm{E}_{\gamma}}{\mathrm{E}_{\gamma}}\,=\,\frac{0.10}{\sqrt{ \mathrm{E}_{\gamma}}}\,\oplus\,\frac{\sigma_{\mathrm{electronic}}}{\mathrm{E}_{ \gamma}^{\mathrm{T}}}\,\oplus\,\frac{\sigma_{\mathrm{pile}-\mathrm{up}}}{ \mathrm{E}_{\gamma}^{\mathrm{T}}}\,\oplus\,0.007\]

The upper formula is for low luminosity and the bottom formula for high luminosity operation of the detector. The pile-up coefficient \(\sigma_{\mathrm{pile-up}}\) and the coefficient for electronic noise \(\sigma_{\mathrm{electronic}}\) are parametrised as in the ATLAS Technical Proposal (TP).

### Function RESTHE

The photon position \(\Theta\) is smeared according to the Gaussian resolution function depending on \(|\eta|\) position:

\[\sigma(\Theta_{\gamma})\,=\,\frac{0.065}{\sqrt{\mathrm{E}_{\gamma}}}\qquad \mathrm{for}\qquad|\eta|<0.8\]

\[\sigma(\Theta_{\gamma})\,=\,\frac{0.050}{\sqrt{\mathrm{E}_{\gamma}}}\qquad \mathrm{for}\qquad 0.8<|\eta|<1.4\]

### Function RESELE

The parametrization of electron energy resolution is taken from LARG group. It is an extrapolation of the full simulation results to reproduce properly the mass spectra resolution. The low and high luminosity cases are treated separately, in the latest case the effect from pile-up is included also. This formula are a good approximation but not fully correct, specially when treat ing independently the electronic noise and pile-up contributions. For the electrons the \(\Theta\) angle is well measured using the Inner Detector information.

\[\frac{\delta\mathrm{E_{e}}}{\mathrm{E_{e}}}\,=\,\frac{0.12}{\sqrt{\mathrm{E_{e}}} }\oplus\frac{0.245}{\mathrm{E_{e}^{T}}}\oplus 0.007\]

\[\frac{\delta\mathrm{E_{e}}}{\mathrm{E_{e}}}\,=\,\frac{0.12}{\sqrt{\mathrm{E_{e} }}}\oplus\frac{\sigma_{\mathrm{electronic}}}{\mathrm{E_{\gamma}^{T}}}\oplus\frac{ \sigma_{\mathrm{pile-up}}}{\mathrm{E_{e}^{T}}}\oplus 0.007\]

The upper formula is for low lumi and the bottom formula for high lumi operation of the detec tor.The pile-up coefficient \(\sigma_{\mathrm{pile-up}}\) and coefficient for electronic noise \(\sigma_{\mathrm{electronic}}\) are parametrised as in the TP.

### Function Reshad

The formula used for the energy smearing for hadronic jets and cells is given below:

\(\bullet\) for \(\mid\eta\mid<\)3 and \(\Delta\,\eta\times\Delta\,\phi\) = \(0.1\times 0.1\) cells

\[\frac{\delta\mathrm{E}}{\mathrm{E}}\,=\,\frac{0.50}{\sqrt{\mathrm{E}}}\oplus 0.03\]

\(\bullet\) for \(\mid\eta\mid>\)3 and \(\Delta\,\eta\times\Delta\,\phi\) = \(0.2\times 0.2\) cells

\[\frac{\delta\mathrm{E}}{\mathrm{E}}\,=\,\frac{1.0}{\sqrt{\mathrm{E}}}\oplus 0.07\]

For high luminosity case additional term of is added in quadrature, interpolated according to used core for reconstruction between values of \(\sigma_{\mathrm{pile-up}}\)= \(7.5\,\mathrm{GeV}\mathrm{E_{T}}\) for \(\Delta\mathrm{R}_{\mathrm{cone}}\) = \(0.4\), \(\sigma_{\mathrm{pile-up}}\) = \(12\,\mathrm{GeV}\) ET for \(\Delta\mathrm{R}_{\mathrm{cone}}\) = \(0.5\) and \(\sigma_{\mathrm{pile-up}}\) = \(18\,\mathrm{GeV}\) E\({}_{\mathrm{T}}\) for \(\Delta\mathrm{R}_{\mathrm{cone}}\) = \(0.7\). For cells which were not used for clusters reconstruction but were hit the expected resolution for hadronic cells of \(0.4\,\mathrm{GeV}\) E\({}_{\mathrm{T}}\) is used only.

### Function FFLDPHI

The effect of the field parametrised as a shift in the \(\phi\) position of the particle is calculated according to the following formula:

\[|\delta\phi|(\mbox{radians})\,=\,(-150)\frac{0.006}{2\mbox{p}_{\mbox{T}}(\mbox{ GeV})}\qquad\mbox{ for}\qquad|\eta|<1.4\]

\[|\delta\phi|(\mbox{radians})\,=\,(-350)\tan\Theta\frac{0.006}{2\mbox{p}_{\mbox{ T}}(\mbox{GeV})}\qquad\mbox{ for}\qquad|\eta|>1.4\]

The sign of the \(\delta\,\phi\) is the same as the sign of the particle charge.

### Function TRIGMUO

This function parametrises efficiency for muon triggering for low and high \(\mbox{p}_{\mbox{T}}\) thresholds in both barrel and endcap regions using the data points from [6-8]. Cubic Spline method is used for parametrization of the efficiencies between each data point pair (Figure 6-1). The function input is the \(|\eta|\) and \(\mbox{p}_{\mbox{T}}\) of the muon and output is the trigger value (trigger=1 for low \(\mbox{p}_{\mbox{T}}\) trigger, 2 for high\(\mbox{p}_{\mbox{T}}\) trigger, 0 for no trigger) which is calculated by comparing the corresponding parametrised efficiency with a uniformly generated random number.

Figure 6-1: Parametrised muon trigger efficiency and data points [6-8]. Courtesy S. Cetin.

## Chapter 4 ATLAS Internal Note PHYS

## Appendix D Subroutines in ATLFAST-B package

The ATLFAST-B package facilitates the analysis of ntuples produced by ATLFAST. It provides parametrization of efficiencies for b- and - tagging of b-, c- and - labelled jets.

### Subroutine ATLFEVE

This subroutine read the current event from ntuple and organizes into few common blocks:

 COMMON/INFO/ISUB

 COMMON/PTMISS/ PXMISS, PYMISS

 COMMON/LEPTON/ NLEP, KLEP(12),PLEP(12,4)

 COMMON/PHOTON/ NPHO, KPHO(12),PPHO(12,4)

 COMMON/JET/ NJET, KJET(20),PJET(20,4)

 COMMON/PARTON/ NPAR, KPAR(40),PPAR(40,4)

 COMMON/LEPTON_CRU/ NLEPCRU,KLEPCRU(12),PLEPCRU(12,4)

 COMMON/PHOTON_CRU/ NPHOCKU,KPHOCRU(12),PPHOCRU(12,4)

 COMMON/JET_CRU/ NJETCRU,KJETCRU(20),PJETCRU(20,A)

Variables with extension CRU will be kept untouched, while this without extension will be overwritten after energy calibration, random b-tagging and -tagging is applied.

### Subroutine ATLFCAL

Energy calibration factor is applied to four-momenta of each jet in COMMON /JETS/. The calibration factor is read from histogram id=IDHISTJU, IDHISTBB (arguments of the subroutine) and jets four-momenta are overwritten. b-tagged jets are recalibrated with Kb-jet factor stored in histo IDHISTBB and non tagged jets are recalibrated with Kjet factor stored in histo IDHISTJJ. Prepared parametrisation assumes that above -100 GeV the calibration factor is constant and on the level of 1.2. It may not be applicable to all studies, so one is advised to produce individual calibration histogram for studied sample.

input: parameter IDHISTJJ, IDHISTBB

### Subroutine ATLFPHO

Still empty, supposed to deal with efficiencies for photon/jet and electron/jet identification and charge identification.

### Subroutine ATLFLEP

Still empty, supposed to deal with efficiencies for electron/jet identification and charge identification.

### Subroutine ATLFBUE

This subroutine applies random b-tagging on jets from COMMON /JET/. One can choose one out of four sets of provided tagging/mistagging parametrisations (NSET=1,..4) consistent with the full simulation results and consistent with algorithm for jet labelling with ATLFAST (see Table 3.9 and Table 3.10). They represent the expected performance for vertexing alone and low luminosity operation. The b-tagging procedure overwrites KJET flag setting KJET=5 for all b-tagged jets and KJET=98 for non-b-tagged. (Note, that there should be no jets with KJET=4 afterwards). The \(\tau\)-labelled and non-b-tagged jets stay labelled with KJET=15. The parametrised efficiencies are \(\PpT\) dependent so it is applied for the would-be recalibrated \(\PpT\) of a given jet.

input: parameter NSET, IDHISTBB

### Subroutine ATLFTAU

This subroutine applies random \(\tau\)-tagging/mistagging efficiencies. For required efficiency for \(\tau\)-tagging (EPSITAU) respective mistagging efficiency is calculated. The \(\tau\)-tagging procedure overwrites KJET flag setting KJET=15 for \(\tau\)-tagged jets (\(\tau\)-labelled but not-tagged jets receive flag KJET=98), and leaves unchanged KJET flag otherwise.

input: parameter EPSITAU

### Subroutine ATLFETO

This subroutine apply random \(\tau\)-veto efficiencies. For IND=1 tau-background fixed to 5%, for IND=2 jet-efficiency fixed at 90%. The \(\tau\)-veto procedure overwrites KJET flag setting KJET=15 for \(\tau\)-tagged jets (\(\tau\)-labelled but not-tagged jets receive flag KJET=98), and leaves unchanged KJET flag otherwise.

input: parameter IND

### Subroutine ATLFTRG

Parametrization for muon trigger is randomly applied on isolated and non-isolated muon (in fact the same procedure was already performed in MAKTRG, so if you use this information don't apply it second time). Triggered muons got the flag MUOTRG=2 (for high \(\PpT\) threshold), MUOTRG=1 (for low \(\PpT\) threshold) and MUOTRG=0 if both triggers have failed.

### Subroutine ATLFUSE

This subroutine provides common blocks with **crude** and **detected** photons, leptons, jets and shows example of the \(\Pmbb\) mass reconstruction for WH, H\(\to\)b\(\overline{\Pb}\) analysis.

[MISSING_PAGE_EMPTY:71]

[MISSING_PAGE_EMPTY:72]

[MISSING_PAGE_EMPTY:73]

[MISSING_PAGE_EMPTY:74]

[MISSING_PAGE_EMPTY:75]

57gamma 1 22 27 -.159 -.157 -1.359 1.377.000
58gamma 1 22 28 -.797 -.970 -6.978 7.090.000
59gamma 1 22 28 -.549 -.843 -5.859 5.945.000
60pi+ 1 211 30 -1.410 -1.193 -7.734 7.953.140
61(pi0) 11 111 30 -0.029 -0.028 -.672 6.687 1.135
62pi+ 1 211 33 -.026 -.782 -1.331 1.550.140
63pi- 1 -211 33 -.132 -.246 -1.893 1.919.140
64pi+ 1 211 34.614 -.233 -1.728 1.854.140
65pi- 1 -211 34 -.055.207 -.180.313.140
66pi- 1 -211 35 2.219 -1.116 -2.672 3.651.140
67(pi0) 11 111 35.226 -.094 -.043.283 1.135
68(D*-0) 11 -423 36 10.249 -1.734 -9.030 13.915 2.007
69(omega) 11 223 36 6.207 -1.326 -4.672 7.920.784
70pi+ 1 211 36 1.330 -.553 -1.208 1.885.140
71(K0) 11 311 36 1.302 -.747 -1.258 2.021.498
72(K-0) 11 -311 36 8.721 -2.673 -7.083 11.559.498
73pi+ 1 211 38.281 -.050 87.841 87.842.140
74(pi0) 11 111 38 -.383 -.217 86.766 86.767.135
75n0 1 2112 39 -.478 -.071 656.664 656.665.940
76pi- 1 -211 39 -.204.186 361.631 361.631.140
77n-0 1 -2112 40.660 -.301 64.676 64.687.940
78(pi0) 11 111 40.062.079 39.356 39.357.135
79pi- 1 -211 41 -.299.083 29.336 29.337.140
80pi+ 1 211 41 -.317.143 5.216 5.229.140
81pi+ 1 211 42.267 -.390 7.225 7.242.140
82(pi0) 11 111 42.147.059.389.441.135
83n0 1 2112 43.208.090 12.619 12.656.940
84pi- 1 -211 43.160 -.014 1.089 1.110.140
85K+ 1 321 44 -.599 -.039 1.829 1.987.494
86(pi0) 11 111 44 0.029.102 348 388 1.135
87n0 1 2112 49.305.009 -2.836 3.003.940
88(pi0) 11 111 49 -.125 -.247 -.536.618.135
89pi- 1 -211 50.130 -.198 -.050.280.140
90(pi0) 11 111 50.141.269 -.943 1.000.135
91n-0 1 -2112 51.155.413 -14.773 14.810.940
92pi+ 1 211 51 -1.167 -.127 -3.857 3.865.140
93pi+ 1 211 53 -.260 -.421-2742.137 2742.137 1.140
94(pi0) 11 111 53 -.045 -.029 -90.262 90.262.135
95gamma 1 22 54 -.120.097 -459.772 459.772.000
96gamma 1 22 54.281 -.015-164.422 164.422.00
97(D*-) 11 -413 56 -6.291 -7.402 -52.951 53.873 2.010
98pi+ 1 211 56 -1.227 -1.150 -8.292 8.462.140
99(omega) 11 223 56 -11.203 -10.016 -74.564 76.067.781
100pi- 1 -211 56 -10.094 -8.923 -66.050 67.410.140
101pi+ 1 211 56 -1.327 -1.193 -8.699 8.881.140
102gamma 1 22 61 -.070 -.021 -.427.433.000
103gamma 1 22 61 -.041.049 -.245.254.000
104gamma 1 22 67.165 -.003.001.165.000
105gamma 1 22 67.062 -.091 -.044.118.000
106(D-0) 11 -421 68 9.426 -1.555 -8.299 12.791 1.865
107(pi0) 11 111 68.824 -.179 -.731 1.124.135
108gamma 1 22 69 3.266 -.558 -1.996 3.868.000
109(pi0) 11 111 69 2.941 -.768 -2.676 4.052.135
110K_LO 1 130 71 1.302 -.747 -1.258 2.021.498
111X_LO 1 1 130 72 8.721 -2.673 -7.083 11.559.498
112gamma 1 22 74 -.109.136 34.703 34.703.000
113gamma 1 22 74 -.273.080 52.063 52.064.000
114gamma 1 22 78.072.045 37.023 37.024.000
115gamma 1 22 78 -.010.034 2.333 2.333.000
116gamma 1 22 82.126 -.013.294.320.00

[MISSING_PAGE_FAIL:77]

3333 (N) ATLFAST 1101 (1) MARCLU: clusters multiplicity 1110 (1) MARCLU: B-field delta_phi vers p_T 1111 (1) MARCLU: B-field counters vers p_T 1112 (1) MARCLU: delta_phi jet-sum_particle 1113 (1) MARCLU: delta_eta jet-sum_particle 1114 (1) MARCLU: delta_r jet-sum_particle 1210 (1) MARMUO: muon multiplicity NOISOLATED 1211 (1) MARMUO: muon multiplicity ISOLATED 1221 (1) MARMUO: muon multiplicity HARD 1231 (1) MARMUO: muon multiplicity HARD+isol 1212 (1) MARMUO: (PT-pTcru) vers pT muon ISOLATED 1213 (1) MARMUO: (eta-etacru) vers pT muon ISOLATED 1214 (1) MARMUO: (phi-phicru) vers pT muon ISOLATED 1219 (1) MARMUO: counter vers pT muon ISOLATED 1215 (1) MARMUO: mumu mass 1216 (1) MARMUO: mumu mass width subtract 1217 (1) MARMUO: 4 mu mass 1311 (1) MAKELE: electron multiplicity ISOLATED 1321 (1) MAKELE: electron multiplicity HARD+isol 1331 (1) MAKELE: electron multiplicity HARD+isol 1312 (1) MARLELE: (PT-pTcru) vers E electron ISOLATED 1313 (1) MAKELE: (eta-etacru) vers E electron ISOLATED 1314 (1) MAKELE: (phi-phicru) vers E electron ISOLATED 1319 (1) MAKELE: counter vers E electron ISOLATED 1315 (1) MAKELE: ee mass 1316 (1) MAKELE: ee mass subtract width 1317 (1) MAKELE: eee mass 1411 (1) MARPHO: photon multiplicity ISOLATED 1421 (1) MARPHO: photon multiplicity HARD 1431 (1) MAKPHO: photon multiplicity HARD+ISO 1412 (1) MAKPHO: (E-Ecru)/Ecru vers E photon ISOLATED 1413 (1) MAKPHO: (theta-thetacru) vers E photon ISOLATED 1416 (1) MARPHO: counter vers E photon ISOLATED 1415 (1) MARPHO: pho-pho mass 1501 (1) MAKJET: jets multiplicity 1505 (1) MAKJET: jetjet mass 1502 (1) MAKJET: energy resolution PT=40-50 GeV 1503 (1) MAKJET: energy resolution PT=200-250 GeV 1611 (1) MAKJUE: b-jets multiplicity 1621 (1) MARKJE: b-quarks HARD multiplicity 1612 (1) MARKJE: p_T b-jet/b-quark FSR 1622 (1) MARKJE: p_T b-jet/b-quark HARD 1613 (1) MAKJE: eta b-jet/b-quark FSR 1623 (1) MARKJE: eta b-jet/b-quark HARD 1614 (1) MARKJE: phi b-jet/b-quark FSR 1624 (1) MARJE: phi b-jet/b-quark HARD 1616 (1) MARKJE: b-jets MJ9Db 1617 (1) MARKJE: b-quark Mbb (after FSR) 1618 (1) MARKJE: M_bb b-jets/b-quark 1620 (1) MARKJE: Rmin b-jet, b-quark HARD 1711 (1) MARCJE: c-jets multiplicity 1721 (1) MARCJE: c-quarks HARD multiplicity 1712 (1) MARCJE: p_T c-jet/c-quark FSR 1722 (1) MARCJE: p_T c-jet/c-quark HARD 1713 (1) MARCJE: eta c-jet/c-quark FSR 1723 (1) MARCJE: eta c-jet/c-quark HARD 1714 (1) MARCJE: phi c-jet/c-quark FSR 1724 (1) MARCJE: phi c-jet/c-quark HARD 1716 (1) MARCJE: c-jets MJcjc1717 (1) MAKCJE: c-quark Mec (after FSR)
1718 (1) MAKCJE: M_cc c-jets/c-quark
1720 (1) MAKCJE: Rmin c-jet, c-quark HARD
1551 (1) MAKTAU: tau-jets multiplicity
1561 (1) MAKTAU: taus multiplicity
1812 (1) MAKMIS: reconstructed p_T
1815 (1) MAKMIS: reconstructed p_T +cells
1822 (1) MAKMIS: p_T nu
1813 (1) MAKMIS: reconstructed pX
1814 (1) MAKMIS: reconstructed pY
1816 (1) MAKMIS: reconstructed pX +cells
1817 (1) MAKMIS: reconstructed pY +cells
1823 (1) MAKMIS: pX nu
1824 (1) MAKMIS: pY nu
1830 (1) MAKMIS: resol missing pX (sumET=0-25)
1831 (1) MAKMIS: resol missing pX (sumET=25-50)
1832 (1) MAKMIS: resol missing pX (sumET=50-100)
1833 (1) MAKMIS: resol missing pX (sumET=100-200)
1834 (1) MAKMIS: resol missing pX (sumET=200-300)
1835 (1) MAKMIS: resol missing pX (sumET=300-400)
1836 (1) MAKMIS: resol missing pX
1842 (1) MAKMIS: pTmiss/PTmu
1843 (1) MAKMIS: PXmiss/PXnu
1844 (1) MAKMIS: PYmiss/PYnu
1901 (1) MAKTRG: trigger content
1902 (1) MAKTRG: muon trig eff. for low and high pT threshold
1903 (1) MAKTRG: muon trig eff. for high pT threshold
2001 (1) MAKTRA: tracks multiplicity
2002 (1) MAKTRA: muon tracks d0 resolution
2003 (1) MAKTRA: muon tracks z0 resolution
2004 (1) MAKTRA: muon tracks phi resolution
2005 (1) MAKTRA: muon tracks cottheta resolution
2006 (1) MAKTRA: muon tracks pTinv resolution
2007 (1) MAKTRA: muon tracks efficiency
2012 (1) MAKTRA: electron tracks d0 resolution
2013 (1) MAKTRA: electron tracks z0 resolution
2014 (1) MAKTRA: electron tracks phi resolution
2015 (1) MAKTRA: electron tracks cottheta resolution
2016 (1) MAKTRA: electron tracks pTinv resolution
2017 (1) MAKTRA: electron tracks efficiency
2022 (1) MAKTRA: pion tracks d0 resolution
2023 (1) MAKTRA: pion tracks z0 resolution
2024 (1) MAKTRA: pion tracks phi resolution
2025 (1) MAKTRA: pion tracks cottheta resolution
2026 (1) MAKTRA: pion tracks pTinv resolution
2027 (1) MAKTRA: electron tracks c0
2202 (1) MAKTRA: electron tracks pTinv resolution
2203 (1) MAKTRA: pion tracks pTinv resolution
2204 (1) MAKTRA: electron tracks efficiency

2202 (1) MAKMSC: circularity of event
2203 (1) MAKMSC: thrust of event
2204 (1) MAKMSC: oblatness of event