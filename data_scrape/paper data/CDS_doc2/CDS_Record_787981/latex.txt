ATLAS Inner Detector Technical Note: August 11, 2004

**Time-over-threshold studies in the 2002 Monte Carlo GEANT 3 simulation of the ATLAS Transition Radiation Tracker.**

**Authors: Pauline Gagnon, Fred Luehring**

Indiana University, Bloomington, Indiana.

\(11^{\rm th}\) August 2004

**Abstract**

We report on the current status of the Time-over-Threshold (ToT) separation power for particle identification in the Atlas simulation using the Transition Radiation Tracker (TRT). The results are compared to similar measurements obtained with the 1999 version of the TRT simulation. The 2002 simulation uses a different model of the TRT electronics shaping circuit which reflects the revised design for electronic chip. The resulting particle identification power obtained using the ToT method is lower than what had been obtained with the previous shaping function.

Introduction

The ATLAS Transition Radiation Tracker will be used both for tracking and particle identification. The detector consists of a barrel section with axial straws and two end-caps where the straws are arranged radially. On average, a track crosses about 35 straws in the detector. Each straw has a 2 mm-radius and is filled with a triple gas mixture (70%Xe-3%O\({}_{2}\)-27%CO\({}_{2}\)). The grounded anode wire is placed at the center of the straw. A negative voltage of about 1500 V is applied to the straw wall which serves as the cathode. Energy deposited by ionization drifts to the anode wire and is detected if it exceeds the lowest level of two discriminator thresholds. The low (high) threshold level is set to 200 eV (5000 eV). A full description of the detector design can be found in [1].

Transition radiation (TR) is emitted when a particle crosses media of different refraction indices. This occurs when a particle goes through the many layers of polypropylene fiber that fills the space between straws for the barrel module or polypropylene sheets for the end-cap wheels. The energy deposited by TR photons is much larger than the average energy deposited due to ionization of the gas. The pulses from such photons will exceed the preset high threshold level. Electrons have a much higher probability (\(\sim 26\%\)) of emitting such TR photons than pions (\(\sim 5\%\)), yielding a means to distinguish them as discussed in [2].

In the TRT, the electron-pion separation will mostly be achieved by counting the number of hits exceeding the high threshold. A complementary and uncorrelated method based on low threshold hits is also possible and has been described in detail in [3]. A summary is given in the next section. Note that the results presented in [3] were performed using test beam data and were then compared to the Monte Carlo simulation. The results presented here are strictly based on Monte Carlo simulation.

## 2 The Time-over-Threshold method

Particle identification can be improved by including information not only from the high-threshold multiplicity on a track but also from using the low-threshold hits. The low threshold hits can be used because the TRT electronics can measure the duration (pulse width) of the low threshold pulse which is related to the energy deposited by charged tracks., and the energy deposited per unit distance, d\(E\)/d\(x\), depends on the particle type as can be seen in the Bethe-Bloch curve given in Figure 1. The more energy a particle deposits in a straw, the longer the signal will remain above the low-threshold level. Hence, even though the TRT DAQ system does not directly record the pulse height, some of the information about the total energy deposition can be extracted by looking at the time-over-threshold (ToT) of a signal. This corresponds to the time elapsed between the moment the signal is recorded (i.e. exceeds the low-threshold level) and when it falls below that threshold. In case the signal generated by the track crosses the threshold more than once, the first leading edge and the last trailing edge are retained.

Before using the ToT information for particle identification, one must correct the ToT measured to remove its dependence on the drift distance. This dependence is clearly illustrated in Figure 2 where the ToT is shown to strongly depend on the distance-of-closest approach \(r\) between the track and the sense wire. A third-degree polynomial fit to the measured ToT as a function of the drift distance is applied, as shown in Figure 3 for pions with transverse momentum \(p_{T}=5\) GeV. These tracks were generated as single tracks with no secondary interactions in the detector and with a rapidity \(\eta=0.6\), which corresponds to tracks crossing only the TRT barrel.

The corrected ToT, \(\mathrm{ToT_{c}}\), is defined as:

\[\mathrm{ToT_{c}}\ =a+b\cdot r+c\cdot r^{2}+d\cdot r^{3} \tag{1}\]

where the parameters \(a,b,c\) and \(d\) are extracted from the fit shown in Figure 3. The distance \(r\) is obtained from the tracking algorithm and corresponds to the best estimate of the track trajectory as calculated by xKalman [4], a tracking algorithm used by the ATLAS reconstruction software. Hence, \(r\) is a better evaluation of the distance-of-closest-approach than what one would obtain using only the leading edge information.

The ToT residual, \(\mathrm{\Delta ToT}\), is obtained from the difference between the corrected and measured ToT values, namely:

\[\mathrm{\Delta ToT}=\mathrm{ToT_{\it meas}}-\mathrm{ToT_{c}} \tag{2}\]

Since the parametrization is based on a fit to the measured ToT for pions, on average the residuals \(\mathrm{\Delta ToT}\) are zero for pions but slightly different from zero for electrons as shown in

Figure 1: Energy deposited per unit length \(\mathrm{d}E/\mathrm{d}x\) as a function of the particle momentum. The energy deposited by electrons is substantially different from all hadrons, allowing for particle identification. Pions and hadrons exhibit a not so markedly different behavior but can nevertheless be separated to some level using the difference in \(\mathrm{d}E/\mathrm{d}x\).

the bottom plot of Figure 3. This small difference can be used for particle identification.

The separation power of the \(\Delta\)ToT variable is shown for pions and electrons in Figure 4. The separation power is greatly enhanced once the \(\Delta\)ToT is combined for all low-threshold hits on a track. On average, about 35 hits are recorded per track. The combined \(\Delta\)ToT per track, namely \(<\Delta\)ToT \(>\), provides information that is nearly independent of the high threshold multiplicity technique. There is a small correlation from the fact that all high-threshold hits also have a low-threshold hit.

## 3 Main changes to the GEANT 3 simulation since 1999

All studies presented in this note are based on a comparison between two different versions of the Monte Carlo simulation. Throughout the text, the results of this study will be referred to as the 2002 results and were obtained with the GEANT3 simulation of the ATLAS detector in ATLAS software release 2.6.0. The 1999 Monte Carlo simulation denotes an ntuple which was produced a few years ago for the studies presented in [3] using the 1999 version of the code. This version of the code was no longer available to us for direct comparison. The main changes introduced in the GEANT 3 simulation since the 1999 particle identification studies that were reported in [3] can be found in Appendix A. Only changes affecting the barrel region are included since this study was limited to this region.

Figure 2: The time-over-threshold of a pulse depends on the signal drift distance to the signal wire. The closer the track to the wire, the longer the time-over-threshold. This is independent of particle type and is corrected for before using the ToT method.

A different shaping function was introduced to correspond to the updated design of the new analog front-end chip. This change reflected design modifications to the shaping circuit that greatly reduced the energy dependent variation in the shaping circuit response. The revised shaping function resulted in a decreased sensitivity of the response to different signal sizes. This new shaping function was compared to data when the updated front-end chip became available for the summer 2003 test beam [5]. The shaping function used in the 1999 simulation varied depending on the amount of energy deposited in a straw while the shaping function in the 2002 simulation is independent of the energy deposition. The two functions are shown in Figure 5.

The 2002 simulation used a corrected parametrization which better reproduced the measured drift time to distance relationship. The maximum drift time was 38 ns for the 1999 simulation and 42 ns for the 2002 simulation. Some scaling of the drift time to drift distance relationship was required to obtain the desired maximum drift time for both simulations.

A few small adjustments were also necessary in order to allow a direct comparison of the two versions of the simulation. The number of hits per track were adjusted in the 1999 MC such as to reproduce what is observed in the current simulation. All tracks were generated without secondary interactions and with a rapidity of \(\eta=0.6\).

## 4 Comparison with the 1999 Monte Carlo results

The efficiency for selecting 5 GeV pions and electrons is determined by integrating the various plots given in Figure 4 from right-to-left. The fractions of events found above a given value of \(\Delta\)ToT or high-threshold multiplicity are given for the 1999 and 2002 MC simulation in the four corresponding plots of Figure 6. The top two plots depend only on the simulation of low-threshold hits. The third plot gives the efficiency of the ToT when all hits (low-threshold and high-threshold hits) are included. The efficiency in this case depends on a convolution of low-threshold and high-threshold efficiency and is less useful in identifying the source of observed differences. The last plot is based exclusively on the high-threshold hit multiplicity per track and is nearly independent from the efficiencies shown in the two top plots. All studies shown in [3] used the value of pion selection efficiency corresponding to an electron efficiency of 0.90. Hence, we use the same point for comparison purpose throughout the rest of the text. The pion efficiency measured at an electron efficiency of 0.90 in the various tests described below are summarized in Table 1.

Most of the difference in low-threshold efficiencies between the 1999 and 2002 simulations

\begin{table}
\begin{tabular}{|c|c|c||c|c|} \hline  & MC 2002 & MC 1999 & shaping & all four changes \\  & (Fig 5) & (Fig 5) & (Fig 6) & (Fig 7) \\ \hline ToT method & 0.55 & 0.38 & 0.46 & 0.42 \\ \hline \end{tabular}
\end{table}
Table 1: Pion efficiencies measured at 0.90 electron efficiency for the 2002 MC simulation, the 1999 MC simulation and for the 2002 MC simulation modified to reverse changes implemented in the code as described in Section 3.

can be attributed to the change in the signal shaping function. This function reproduces the response of the front-end chip to an energy cluster deposited in the straw. Since the final version of the electronics design was never tested in the test beam, a temporary version was introduced based on expected behavior. The exact pulse shape needs to be tested and adjusted correspondingly in the simulation. This will be done as soon as the final front-end chip becomes available and can be tested with test beam. The old shaping function was re-introduced in the current simulation and the results are shown in Figure 7 along with the efficiency for the 1999 MC version. Most of the efficiency is recovered for the low-threshold hits. This is seen by comparing the MC 2002 curve with the MC 1999 curve at 0.90 electron efficiency. The change in the drift velocity impacted very lightly on the low-threshold discrimination power. Finally, fixing a small bug for the straw material only had a very marginal effect.

We then reversed the values/methods of the following four changes to their 1999 nominal values: the shaping function and drift velocity described in Section 3, as well as reverting to carbon for straw material and reintroducing the old TR reconstruction efficiency described in Appendix A, items 9 and 12, respectively. The discrepancy between the 1999 and 2002 MC simulations almost (but not quite) disappears for the ToT method as can best be seen from Table 1 when comparing the MC 1999 column with the "all four changes" column. At different values of electron efficiencies, the situation vary. This is shown in Figure 8 where the current MC is compared to the old simulation after reverting these four changes.

## 5 Conclusions

The discrimination power of the ToT multiplicity methods for 5 GeV electrons and pions have been affected by changes introduced in the simulation since the 1999 studies. It is hard to pinpoint the sources and effects of all changes introduced in the MC simulation given in Appendix A since the last extensive \(e/\pi\) separation study conducted in 1999 [3]. Nevertheless, two main conclusions can be drawn:

1. The significant loss in efficiency in the ToT method is mostly due to the change in the shaping function introduced to reproduce the behavior of the new front-end electronic. This effect is also seen in the Summer 2002 test beam data as reported in [5, 6].
2. The feasibility of the ToT method and exact power of the high-threshold multiplicity method will need to be reassessed once the final TRT electronics is fully characterized using real TRT barrel modules in a test beam in the Summer 2004.

In the mean time, since all the necessary information for time-over-threshold studies has been incorporated into the official reconstruction code, it will be possible to monitor the impact on the ToT method of new changes and adjustments made to the Monte Carlo simulation.

Summary of the main changes to the GEANT 3 simulation since 1999

All studies presented in this note are based on a comparison between two different versions of the Monte Carlo simulation: one from 1999 and one from 2002. Full details of the main changes affecting the TRT barrel region introduced in the GEANT 3 simulation since the 1999 particle identification studies were reported in [3] and are also listed here. The first two items are fully described in the text in Section 3.

1. A different shaping function was introduced to correspond to the updated design of the new analog front-end chip.
2. The 2002 simulation used a corrected parametrization to reproduce the measured drift time to distance relationship.
3. The leading edge and trailing edge of the signal pulse are now recorded in discrete values corresponding to 3.125 ns TDC bins (Time-to-Digital-Converter). For the 1999 simulation, the time of the TDC bin was artificially adjusted to correspond to 3.125 ns to reflect the current design of the electronics although the hits were simulated with a 1 ns time bin.
4. The first leading edge and last trailing edge are now recorded as opposed to the inverse in the previous version. This choice is necessary when the signal splits into multiple pulses due to fluctuations of the signal pulse below the low-threshold level. This was shown to increase the leading and trailing edge reconstruction accuracy and is detailed in [7].
5. The gate defining a valid low-threshold hit was increased from 3 to 4 time bins based on the re-optimization given in [7].
6. The current xKalman version is now used instead of the private version of the track reconstruction algorithm used for the 1999 studies. Hence, the tracks are better reconstructed, having more hits per track and better found track parameters for calculating the drift-distance dependence corrections.
7. Different Geant parameters were used in 1999 and 2002 :

\begin{tabular}{|c|c|c|} \hline  & MC 1999 & MC 2002 \\ \hline electron delta-rays DCUTE &.00001 (10 keV) &.00001 (10 keV) \\ bremsstrahlung BCUTE &.00001 (10 KeV) &.00001 (10 KeV) \\ \(\pi,\ \mu\) delta-rays DCUTM &.001 (1 MeV ) &.001 (1 MeV ) \\ \(\pi,\ \mu\) bremsstrahlung BCUTM &.001 (1 MeV) &.001 (1 MeV) \\ e, \(\gamma\) transport cuts CUTELE, CUTGAM) & 10 keV & 10 keV \\ \(\nu\), hadronic, \(\mu\) CUTNEU, CUTHAD, CUTMUO & 100 keV & 100 keV \\ DCUTE\({}^{2}\) &.0001 (100 keV) &.0001 (100 keV) \\ BCUTE\({}^{2}\) &.00001 ( 10 keV) &.00001 ( 10 keV) \\ DCUTM\({}^{2}\) &.0001 (100 keV) &.0001 (100 keV) \\ CUTGAM\({}^{2}\) &.0001 (100 keV) &.0001 (100 keV) \\ CUTELE\({}^{2}\) &.0001 (100 keV) &.0001 (100 keV) \\ \hline \end{tabular}

Cuts marked "1" apply to the material surrounding the gas mixture (such as the straws and radiators). Cuts marked "2" apply to the gas itself and were hard coded.
8. Several small changes affected the amount of energy generated by the PAI model. The 1999 code had the parameter GamMin (in TRTD) set to -1 instead on -2 and this caused the energy deposition tables for PAI to be calculated for particles with one order of magnitude lower kinetic energy. This affected mostly low energy electrons. In 1999 a tuning of the electrons was done by scaling their ionization by a factor of 1.11 which was removed in 2002. The 2002 simulation included a correction introduced to account for the path length of delta-rays generated in the gas volume.
9. A number of changes affecting Transition Radiation (TR) production were made between 1999 and 2002. The TR recording efficiency for the TRT barrel is set to 0.8 after comparison with test beam data whereas its value was 0.9 for the 1999 Monte Carlo studies. The inter-radiator gap parameter was 222 microns in 1999 and 151 microns in 2002 (both simulations used a radiator thickness of 12 microns). The 1999 simulation had a multiplication factor of 1.1 on the number of TR photons whereas the 2002 simulation did not include this factor.
10. In 1999 the function used to simulate the resolution (smearing) was a truncated Gaussian instead of the more accurate exponential function in the 2002 simulation.
11. The 2002 simulation used a special routine to calculate the effect of space charge. This routine was implemented but not used in 1999. The effect of using the space charge routine was quite small in all cases studied.
12. Several bugs were fixed, such as using Kapton for the straw material instead of carbon, a bug that lead double counting of the energy for the electrons under certain circumstances, and affected the maximum energy of TR photons.

## References

* [1] Inner Detector Technical Design Report, CERN/LHCC/97-17, ATLAS TDR 5 (1997).
* [2] J.T. Shank _et al._, Nucl. Instr. and Meth. A**310** (1991) 133; T. Akesson _et al._, Nucl. Instr. and Meth. A**372** (1996) 70; T. Akesson _et al._, Nucl. Instr. and Meth. A**412** (1998) 200.
* [3] T. Akesson _et al._, Nucl. Instr. and Meth. A**474** (2001) 172.
* [4] xKalman algorithm description, I. Gavrilenko, [http://atlasinfo.cern.ch/Atlas/GROUPS/INNER_DETECTOR/LAYOUT/DOC/kalman.ps](http://atlasinfo.cern.ch/Atlas/GROUPS/INNER_DETECTOR/LAYOUT/DOC/kalman.ps)
* [5]\(e/\pi\) separation using the Time over Threshold method in the ATLAS Transition Radiation Tracker. Chafik Driouichi, ATL-INDET-2003-012, 18 June 2003.
* [6] See Sergei Morozov's talk in TRT meeting, October 2002. [https://edms.cern.ch/file/357495/1/Test](https://edms.cern.ch/file/357495/1/Test) beam_MC_results_Morozov.pdf