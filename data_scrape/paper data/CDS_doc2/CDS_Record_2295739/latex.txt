Trigger-object Level Analysis with the ATLAS detector at the Large Hadron Collider: summary and perspectives

The ATLAS Collaboration

This document summarizes the motivations, challenges and perspectives of the Trigger-object Level Analysis (TLA) in ATLAS, focusing on the case where the physics objects used for analysis are hadronic jets. It is intended as a complement to the HEP Software Foundation Community Whitepaper on trigger and reconstruction.

## 1 Introduction

The data rate delivered by the LHC (more than 30 million proton-proton bunch crossings per second during 2015) would by far exceed the capabilities of the ATLAS detector [1] for recording events for offline analysis. For this reason, the ATLAS trigger system [2] discards data from most of the collision events that occur, selecting only a small fraction of events for later analysis based on the presence of high transverse momentum physics objects (muons, electrons, photons, jets, tau leptons and missing transverse momentum). The trigger system is a crucial component of the experiment, responsible for an irrevocable decision about what data the experiment collects.

The bandwidth available to the trigger system is ultimately limited by the amount of data that can be recorded to offline storage, and subsequently analysed. Other limitations are the hardware trigger rates and the CPU needs for reconstructing the objects at the trigger level. Searches for the small signals produced by rare, weakly-interacting physics processes at hadron colliders therefore require novel triggering strategies to extract them in presence of copious backgrounds.

For some physics objects, the occurrence of interesting collision events, even those with low transverse momentum objects, is low enough that most collision data can be retained. Muons and electrons, for example, are produced at relatively low rates and with relatively small instrumental backgrounds at a hadron collider. For final states containing jets, tau leptons and missing transverse momentum, however, the event rates are large and grow rapidly with the number of simultaneous proton-proton interactions (pile-up). This makes it difficult to retain events involving these physics objects when their energies are at or below the electroweak scale.

The electroweak scale is a crucial energy scale of the Standard Model. It has been extensively probed at the LEP experiments. LHC experiments will continue to explore the electroweak scale with an extensive search and measurement programme covering many final states. Using data from LHC Run-1 (2009-2012), Run-2 (2015-2018) and with the luminosities expected from the future data taking periods LHC Run-3 (2021-2023) and the high luminosity LHC Run-4 (or HL-LHC, 2026-2029) the anticipated results will offer a far better sensitivity to rare processes than what has been available prior to the LHC. While electroweak-scale processes involving leptons have been thoroughly tested, the enormous rate of collision events from quantum chromodynamics (QCD) processes is a challenging obstacle to studying processes that privilege the production of hadronic objects. For this reason, only relatively loose constraints have been placed on these final states [3].

The challenge to the trigger system when recording high-rate processes can be overcome through the implementation of a novel data analysis technique, where physics objects (e.g. jets, photons, electrons...) used for analysis are reconstructed in real-time within the trigger system itself. Only a fraction of the full event is saved in a dedicated data stream, namely only a selection of objects reconstructed within the software trigger system, and used for data analysis. These are called in the following "trigger objects" as opposed to the "offline objects" reconstructed using the full detector information and the final calibration constants. Care must be taken that the CPU requirements for such triggers don't exceed available resources. If this can be accomplished, then the small size of such partial events opens up the possibility of recording much higher event rates than otherwise possible 1. This technique is called Turbostream by the LHCb Collaboration [7], Data Scouting by the CMS Collaboration [8] and Trigger-object Level Analysis (TLA) [9] by the ATLAS Collaboration.

These analysis techniques require that the overall trigger system performs well even in the pile-up conditions foreseen at the HL-LHC. The algorithms used to reconstruct trigger objects must be fast and must not contribute significantly to the overall trigger computing resources, so that only a small fraction of the existing resources is used. The performance of objects at the trigger level must be comparable to that of objects after the full set of calibration and reconstruction steps, so that it is not necessary to record information to perform those steps again and the size of the event stored for further analysis is reduced with respect to full offline event. The use of these techniques also provides further motivation to improve the trigger system and the object reconstruction, benefitting the entire experiment.

In this note, we will describe the Trigger-object Level Analysis in ATLAS as an example of these techniques. The search for low-mass dijet resonances is a use case for the use of the TLA technique. In this case, the challenge is recording all events from the overwhelming QCD background in order to search for a rare events where new resonances decay into quarks and gluons. A dijet search using trigger objects was implemented in CMS [8] and ATLAS [9] starting with the 2012 and 2015 LHC datasets, respectively.

Dijet resonance searches at hadron colliders have a long history, owing to the large number of new physics models that predict this signature. At the LHC during Run-1 and at earlier colliders, these searches focused on the discovery of new particles at the highest partonic center-of-mass energies that the collider could produce. For instance, dijet resonance searches at multi-TeV masses are highly sensitive to the existence of certain types of dark matter mediators [10, 11].

Dijet resonance searches at sub-TeV masses are equally well-motivated. For example, light dark matter mediators may have very weak couplings to partons and still easily reproduce the observed cosmological dark matter density in standard thermal cosmological histories [11]. However, prior experiments were unable to probe sufficiently weak couplings with their relatively small datasets, and even couplings of order unity are not probed in the full mass range around the electroweak scale. The LHC experiments will collect orders of magnitude more data than previous experiments, and provide much greater reach for these relatively unexplored sub-TeV dijet resonances, which are rarely produced. These data can be exploited using a TLA, assuming that adequate jet calibration techniques are in place.

It could also be desirable to extend the TLA technique to final states including other physics objects, e.g. by identifying photons and muons and calibrate them in real-time in order to store only high-level information in partially reconstructed events. This will allow for instance the extension of LHC Dark Matter searches to be sensitive to even lighter resonances, see e.g. Ref. [12], and provide essential cross-checks to e.g. the LHCb new physics program using muon events [13].

This document describes the ATLAS trigger system and the limitations it imposes on the TLA technique, using the dijet low-mass resonance search as an example. Challenges and potential improvements to these searches, pertaining to both hardware and software trigger are presented, with a focus on near and far-future upgrades to the trigger system and to the calibration scheme.

## 2 The ATLAS jet trigger system in Run-2

The ATLAS trigger system during the LHC Run-2 is implemented in two levels: a hardware first level and a software High Level Trigger (HLT) [2].

To identify events containing hadronic jets, the Level-1 (L1) trigger constructs regions of interest (RoI) in the calorimeter from \(\Delta\eta\times\Delta\phi\) = 0.2 \(\times\) 0.2 calorimeter segments using a sliding-window algorithm. No jet-level energy corrections are applied to those RoIs. During the LHC Run-2, the L1 accepts events at a rate of 100 kHz. Events accepted by the L1 hardware trigger are then processed further by the HLT. The only physics objects used for a dijet search using the TLA technique are the jets that are reconstructed at the HLT, using information from a full scan of the calorimeter information.

The reconstruction of trigger jets is kept as close as possible to the offline reconstruction. In the HLT, groups of contiguous calorimeter cells (topological clusters) are formed based on the significance of the energy deposit over calorimeter noise [14]. This is the most CPU-intensive and time-consuming step in the jet reconstruction chain, taking an average time of 98 ms per event for events with 40 simultaneous interactions [2]. Topological clusters are then grouped into jets using the anti-\(k_{t}\) algorithm [15, 16] with distance parameter \(R\) = 0.4. The HLT decision is made on the basis of the transverse energy of these trigger jets.

The main advantage for a search using the TLA technique is the reduction of statistical uncertainties on the background estimation to a negligible level. Since the QCD background for TLA jet searches in the dijet mass distribution is smooth, systematic uncertainties on the background estimation are minimized using a data-driven fit to the dijet mass distribution. The functional form used for the fit does not allow for localized excesses. The use of a smooth function for the background estimation relies strictly on the absence of features arising from either detector malfunctioning or calibration. For this reason, the performance of the calibration of trigger jets is crucial for an analysis searching for low-mass hadronic resonances using the TLA technique. This is especially true in an environment such as the HL-LHC, where the effects of up to 200 proton-proton interactions will significantly affect the energy scale and resolution of jets from the resonance decays.

For offline jets, the full calibration procedure includes a number of steps [17]. The first calibration step removes the additional energy added to the jet from multiple proton-proton interactions, based on the area of the jet and the energy density of the event. A correction based on the number of primary vertices and simultaneous proton-proton interactions that restores the energy scale is needed at high detector pseudorapidity to further correct for effects of bunch crossings in the vicinity the one of interest. A third calibration step, derived from simulated data, restores on average the full hadronic energy of the jet. It is followed by another simulation-based correction using multiple detector inputs (including tracks) to improve the resolution of the jet energy measurement. Data-derived corrections are applied next, and are based on a number of balancing techniques: forward jet balanced against a central jet, a photon or a number of other jets. These final calibration steps correct for any miscalibration that would occur in simulation-based calibration steps if the the detector conditions were not modelled correctly in simulation.

Those steps of the offline jet calibration procedure that use calorimeter information are also applied to trigger jets, alongside dedicated calibrations that make the properties of jets reconstructed at the HLT comparable to those of jets reconstructed from full events. Prior to the application of the in-situ corrections, the energy scale of trigger jets used for a TLA search is corrected to that of offline jets using an averagecorrection based on the response of trigger jets to offline jets. This correction accounts for differences between offline and trigger jets and for missing information from detectors other than the calorimeters.

## 3 Limitations of the current dijet searches with the TLA technique

Current dijet searches using the TLA technique suffer from two main shortcomings. Firstly, the lower mass reach of such searches is limited by the energy thresholds of L1 triggers. HLT algorithms are only executed if the L1 condition is satisfied. This leads to a hard limitation for probing low-mass objects with a TLA, as the L1 will generally only select events above a certain transverse momentum threshold. The algorithms reconstructing L1 objects are very coarse-grained due to time constraints imposed by the LHC bunch crossing. L1 jets are not calibrated and their energy resolution is much worse than that of trigger jets at the HLT, the transverse momentum at which the L1 jet triggers are fully efficient will be much higher than the nominal threshold. Since the cross-section for jet processes falls steeply and only events above this threshold can be used for analysis, many of the events accepted by L1 are not usable for a TLA. An improvement of the reconstruction of L1 objects would benefit searches for low mass mediators decaying into jets, as the allocated event rate for hadronic L1 triggers would be used more efficiently.

Secondly, the trigger jet energy scale and resolution are not optimal due to the use of a calibration originally derived for offline jets. Not all detector information is currently available to the jet trigger system; in particular no tracking information is currently available to dijet searches using the TLA technique. Moreover, any calibration derived using offline jets has to be derived using the dataset of fully reconstructed events, which has a much reduced statistical power with respect to the dataset of a search using the TLA technique. An improvement in the jet calibration procedure would improve the dijet mass resolution, which in turn would lead to a sharper signal peak atop the falling dijet invariant mass background distribution and increase the sensitivity of these searches due to the improved signal-to-background ratio in the region around the peak.

## 4 Ideas for improvements of trigger jets for Run-3 and HL-LHC

### Improvements of the L1 object calibration and TLA event selection

To cope with the much increased rates from the hardware jet trigger that ATLAS will face after the upgrade to HL-LHC [18], a better energy resolution at the low-level trigger would be advantageous. As more finely grained calorimeter information will be available, the application of calibration directly at the hardware level is being considered. Substantial computing capacity will be available to the jet hardware trigger processor for the LHC Run-3 and HL-LHC [18, 19], making it possible to assemble jet trigger data for the entire calorimeter at the L1 trigger rather than just in separate RoIs. Combined with dedicated calibrations, this feature will allow for significant improvement of the resolution of L1 objects, the use of fast calorimeter-based techniques to reject pile-up and the selection of interesting events from decays of boosted objects.

### Improvements of the trigger jet calibration and resolution

The average number of simultaneous proton-proton interactions during the LHC Run-1 and Run-2 ranges from 20 to 40 so far, with peak pile-up of 60 at the end of 2017. At the HL-LHC, this number is expected to grow to 200. Pile-up affects the energy of interesting, hard scatter jets, and adds extra reconstructed jets stemming from the secondary interactions in the event. In such an environment, low-mass dijet resonance searches using the TLA technique can only be performed if the trigger can identify and subtract pile-up sufficiently well.

Improvements on the jet calibration and resolution of trigger jets could be achieved if tracks were available for all jets. Tracking information is necessary for pile-up subtraction, to minimize quark-gluon differences in the jet response through a dedicated calibration, and for applying the data-derived correction that equalizes the relative jet energy response across the detectors derived from the same dataset recorded with the TLA technique.

If tracking information is available at the requested rate, fast algorithms [20, 21, 22] can be employed to correct for the additional energy and reject pile-up jets. At ATLAS, new systems which will help reducing the pile-up contribution in the trigger are either being commissioned or are under discussion: a fast hardware tracker (FTK [23, 24]) and a possible forward timing detector. The installation of a hardware track triggers and a timing detector [25, 26, 27, 18, 28] at the HL-LHC will remove the effects of multiple interactions using track information at the HLT and significantly improve the jet energy resolution. Using tracking information would not increase the data size, as the information necessary for applying such a calibration does not need to be stored.

During the course of Run-2 and Run-3, ATLAS plans to use the newly installed FTK trigger processor. The FTK trigger processor will perform rapid, high-quality charged-particle tracking throughout the entire ATLAS silicon detector within 100 \(\mu s\) of every Level-1 trigger decision. Using massively parallel pattern recognition hardware, the FTK will find all tracks with transverse momentum above 1 GeV that traverse the entire silicon detector, with parameter measurements that are close to that of offline track reconstruction. The FTK augments existing software tracking that can be run only on a small, narrowly-defined set of regions of interest, and will provide tracking information for the entire event at the full HLT input rate. This will free scarce processing time for more sophisticated trigger-decision-making.

Timing information can also be useful for mitigating the effects of interactions from previous or subsequent bunch crossings that are not already handled by the calorimeters [1, 29]. This can be investigated at the HLT already in Run-2, as the calorimeter cell-by-cell timing is already available, alongside pile-up subtraction techniques that do not employ this information [30, 31]. If installed, a high granularity timing detector (HGTD) [18] would be useful to obtain an estimate of jet timing, as well as for providing the average number of interactions per bunch crossing at the trigger level.

A correction exploiting the fragmentation differences between quark- and gluon-initiated jets (the global sequential correction in [32]) could be applied in real-time and bring a significant improvement in the trigger jet resolution, since the fluctuations due to the different calorimeter response for quark initiated and gluon-initiated jets would be greatly reduced.

The availability of tracking information is a crucial advancement needed to gain access to mass resonances with trigger objects at the HL-LHC of the order of 200 GeV, and paves the way for real-time analysis with other physics objects such as photons and missing transverse momentum, which are also used in dark matter searches. Further work on algorithms applied both at the jet constituent and jet level willbe needed, as the time required by current algorithms to consider all tracks in the event is large. In this context, common efforts between the LHC collaborations could be sought for reconstruction and pile-up subtraction software that considers tracks and timing information at the trigger level.

A correction to equalize the energy response across the detectors using the balance of forward jets to central jets, done prior to the in-situ calibration steps balancing jets with other objects, could be derived using a quasi-real-time calibration of the data. Currently, only the initial pile-up correction and the basic jet energy scale correction derived from simulation are applied to trigger jets in real-time. A real-time relative calibration would be useful in case calorimeter or LHC conditions changed on a short timescale. An advantage of deriving the relative jet calibration at the trigger level is that it can use a larger dataset with respect to the calibration derived offline, where the correction factors for jets with a lower transverse momentum suffer from statistical uncertainties due to the random rejection of events at the HLT to remain within the available bandwidth (trigger prescales). If the performance of trigger jets is comparable to that of offline jets at the calibration stage prior to the final in-situ corrections, another use for a calibration loop as the one described above is providing relative \(\eta\) calibration constants for offline jets with a much larger statistical precision with respect to present. This use case may lead to a reduction in the rates of calibration triggers (in 2017, those are roughly 10% of the total jet trigger bandwidth [2]), if those triggers are not in use for other purposes.

## 5 Conclusions and outlook

This note outlined the main possibilities for improvement that can be foreseen and tested in the future for the purpose of TLA-based dijet low-mass resonance searches. These are:

* A more finely grained L1 object calibration, implemented at the hardware level, which will improve the L1 resolution and reduce the rates of these triggers, could also pave the way for TLAs to be performed with L1 objects;
* The inclusion of tracking and timing information for the majority of trigger jets, for pile-up suppression and reduction of quark/gluon response differences;
* An improved HLT calibration equalizing the response of central and forward jets, performed before the HLT events are used or recorded.

The LHC data-taking campaign at a center-of-mass energy of 13 TeV has just begun. The LHC is delivering luminosity in a regime that forces ATLAS to raise the minimum threshold on the transverse momentum of all physics objects that trigger full event recording. For this reason, accessing rare processes with the full LHC dataset will be far more challenging. The TLA technique can be employed as a strategy to enhance the physics programme of searches for generic new low-mass resonances at the LHC in these harsh conditions, and across the full range of physics signatures considered by the experiment. At the HL-LHC, TLAs can also take advantage of major upgrades to the ATLAS trigger system, such as the introduction of hardware-based tracking and real-time calibration techniques.

The performance of objects built using the minimal amount of information from the trigger systems must be continuously improved now and for the ATLAS upgrades, in order to search for lower-rate and lower-momentum processes. Most of these improvements will be available at the price of additional CPU requirements at the HLT. For this reason, the optimization of the algorithms employed will be a crucial point for the advancement of TLA searches, so that CPU does not become the limiting factor for this technique.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003.
* [2] ATLAS Collaboration, _Performance of the ATLAS Trigger System in 2015_, Eur. Phys. J. **C77** (2017) 317, arXiv: 1611.09661 [hep-ex].
* [3] B. A. Dobrescu and F. Yu, _Coupling-mass mapping of dijet peak searches_, Phys. Rev. D **88** (2013) 035021, arXiv: 1306.2629 [hep-ph].
* [4] CMS Collaboration, _Search for low mass vector resonances decaying into quark-antiquark pairs in proton-proton collisions at \(\sqrt{s}\) = 13 TeV_, (2017), arXiv: 1710.00159 [hep-ex].
* [5] ATLAS Collaboration, _Search for new low-mass resonances decaying to jet pairs in association with a photon or a jet in proton-proton collisions at \(\sqrt{s}=13\) TeV with the ATLAS detector_, ATLAS-COM-CONF-2016-070, 2016, url: [http://cds.cern.ch/record/2161135](http://cds.cern.ch/record/2161135).
* [6] ATLAS Collaboration, _Search for resonances below 1.2 TeV from the mass distribution of b-jet pairs in proton-proton collisions at \(\sqrt{s}\)=13 TeV with the ATLAS detector_, ATL-COM-PHYS-2016-539, 2016, url: [http://cdsweb.cern.ch/record/2161136](http://cdsweb.cern.ch/record/2161136).
* [7] LHCb Collaboration, _Tesla : an application for real-time data analysis in High Energy Physics_, Comput. Phys. Commun. **208** (2016) 35, arXiv: 1604.05596 [physics.ins-det].
* [8] C. Collaboration, _Search for narrow resonances in dijet final states at \(\sqrt{s}\)= 8 TeV with the novel CMS technique of data scouting_, Phys. Rev. Lett. **117** (2016) 031802, arXiv: 1604.08907 [hep-ex].
* [9] ATLAS Collaboration, _Search for light dijet resonances with the ATLAS detector using a Trigger-object Level Analysis in LHC pp collisions at \(\sqrt{s}=13\) TeV_, ATLAS-CONF-2016-030, 2016, url: [https://cds.cern.ch/record/2161135](https://cds.cern.ch/record/2161135).
* [10] D. Abercrombie et al., _Dark Matter Benchmarks for Early LHC Run-2 Searches: Report of the ATLAS/CMS Dark Matter Forum_, 2015, arXiv: 1507.00966 [hep-ex].
* [11] M. Chala et al., _Constraining Dark Sectors with Monojets and Dijets_, JHEP **07** (2015) 089, arXiv: 1503.05916 [hep-ph].
* [12] A. Mariotti et al., _New LHC bound on low-mass diphoton resonances_, (2017), arXiv: 1710.01743 [hep-ph].
* [13] P. Ilten et al., _Proposed Inclusive Dark Photon Search at LHCb_, Phys. Rev. Lett. **116** (2016) 251803, arXiv: 1603.08926 [hep-ph].
* [14] ATLAS Collaboration, _Topological cell clustering in the ATLAS calorimeters and its performance in LHC Run 1_, Eur. Phys. J. **C77** (2017) 490, arXiv: 1603.02934 [hep-ex].
* [15] M. Cacciari et al., _The anti-\(k_{t}\) jet clustering algorithm_, JHEP **04** (2008) 063, arXiv: 0802.1189 [hep-ph].