[MISSING_PAGE_FAIL:1]

## 2 Standard analysis

### Pedestal and noise

The pedestal and noise level are shown in figures 1 and 2. Each histogram corresponds to a FEB and each bin to a FEB channel. In \(y\) is plotted the mean (pedestal, Fig. 1) and rms (noise, Fig. 2) values of the raw ADC values over the events, the capacitor address in the SCA and the 5 samples. The mean noises, read on figure 2, are

\begin{tabular}{c|c|c|c|c}  & PS & Strips & Middle & Back \\ \hline sample noise & 8 & 7.7 & 5 & 5 \\ \end{tabular} Figure 3 represents the noise autocorrelation function for each half FEB. It has been obtained as a mean over the events, the capacitor address in the SCA and the elements of the channel noise autocorrelation matrix.

### Analysis per capacitor

The distribution of the capacitor address is shown on figure 4. There is no clear structure in the distribution, but the pattern repeats itself in all the half-FEBs with a shift, i.e. all the controllers are in phase but are shifted by a constant number.

The variation of the sample pedestal and of noise with the capacitor address is shown in figures 5 and 6. In \(x\) is entered the address running from 1 to 144 and in \(y\) is plotted the mean (pedestal, Fig. 5) and rms (noise, Fig. 6) of the difference between the sample value in this capacitor and the sample pedestal (Fig. 1). The mean value and the rms is taken over all the events and all the SCAs of the same FEB. On can see a clear oscillation with periodicity of 4 and

Figure 1: Pedestal value as a function of the FEB channel number.

Figure 3: Noise autocorrelation function for each half FEB. The \(x\)-value is the sample number and the \(y\)-value is in squared ADC counts.

Figure 2: Noise (in ADC counts) as a function of the FEB channel number.

amplitude of the order of 1 ADC count (\(\simeq 10\) MeV). An explanation of this effect will be given farther.

### Coherent noise

It is usual to evaluate the coherent and uncoherent noises between channels by making the distributions of the sum1 and of an alternate sum of the central sample values. The uncoherent noise is then defined as the alternate sum rms divided by \(\sqrt{N}\) and the correlated sample noise is defined as

Footnote 1: We shall call **FEB signal** the sum of the ADC values of the \(N\) channels of a FEB at the same sampling time.

\[\mbox{coherent noise}^{2}=[\mbox{rms}(\mbox{sum})^{2}\mbox{ - rms}(\mbox{alternate sum})^{2}]/N^{2}.\]

Using \((-1)^{i}\) as the sign in the alternate sum for the \(i\)-th channel of the FEB channel, one gets the estimates of the following table.

\begin{tabular}{c|c|c|c|c}  & PS & Strips & Middle & Back \\ \hline rms(sum) & 169.7 & 120.3 & 121.7 & 146.9 \\ rms(alternate sum) & 92.8 & 86.7 & 80.0 & 92.2 \\ "uncoherent" sample noise & 8.4 & 7.7 & 7.1 & 8.1 \\ "coherent" sample noise & 1.1 & 0.65 & 0.71 & 0.89 \\ sample noise (Sect. 2.1) & 8 & 7.7 & 5 & 5 \\ \end{tabular} The coherent noise is a small fraction of the uncoherent one but may become important if several channels are summed for physics purpose.

Figure 4: Capacitor address distribution. The two half FEBs are plotted separately since they correspond to two different controllers.

Figure 5: Pedestal variation (in ADC counts) with the capacitor address. In \(y\) is the difference between the individual capacitor pedestal and the mean pedestal inside the same SCA. All SCAs of the same board enter the same plot. The two half FEBs are plotted separately.

Figure 6: Noise variation (in ADC counts) with the capacitor address. In \(y\) is the mean difference between the individual capacitor noise and the mean noise inside the same SCA. All SCAs of the same FEB enter the same plot. The two half FEBs are plotted separately.

## 3 Special study of the coherent noise

### Presumable origin of the coherent noise

As the "uncoherent" noise is larger than the sample noise calculated in section 2.1 for the middle and back samplings, we conclude that the coherent noise is not simple. Indeed, one finds that the distribution of the FEB signal is not gaussian for these samplings (Fig. 7). More information is gained by looking at the distribution of the FEB signal at one sampling time versus its value at a later time. This is shown for the back sampling in figure 8. The clustering of points can be explained by the superposition of a periodic signal, synchronous with the 40 MHz clock, to the "normal" noise.

This synchronous signal can be visualized in the way a triggered signal appears on a scope: if, for a given event and a given FEB, one of the 5 time samples of the FEB signal is lower than a triggering value of -200 ADC counts, these 5 FEB samples are plotted at a time position counted from the "triggering" time (Fig. 9). For the presampler and strips FEBs, one gets a symmetric curve resembling the noise autocorrelation function (Fig. 3), but for the middle and back sampling FEBs, the curves are no longer symmetric with respect to the central time and the fact that the first and last samples (\(x=-4\) and \(x=+4\)) are equal suggests that they have a periodicity of 8 clock cycles (5 MHz) most probably related to the ADC functioning. The periodicity is also suggested by the symmetry of the \((n,\ n+4)\) distribution (Fig. 8) with respect to the diagonal.

The effect of such a periodic noise on the time autocorrelation distributions is shown, for the back sampling, as black circles on figure 8: the black circles have coordinates \((y_{i},y_{i+\Delta n})\) where \(i\) runs from \(-4\) to \(+3\), \(y_{i}\) is the ordinate of bin \(i\) in the back sampling synchronous noise (Fig. 9) and \(\Delta n\) is a time

Figure 7: Distribution of the FEB signal of each FEB.

Figure 8: Time autocorrelation of the sum of the 128 channels of the back compartment (FEB 2). In \(y\) is entered the value of the sum (in ADC counts) at a certain clock cycle and in \(x\) the sum at a later cycle (+1, +2, +3, +4). The black circles are explained in the text.

Figure 9: Triggered FEB noise as a function of time (see text). The triggering level is -200 ADC counts.

difference in clock cycle (1, 2, 3 or 4). The almost perfect coincidence of the circles and the clusters gives us a good confidence in our interpretation.

The synchronous signal is also responsible for the oscillating patterns observed in the pedestal distribution per capacitor (Fig. 5) due to the way capacitor addresses are generated. We have found that each time the FEB signal is below the -200 ADC count threshold, the samples are written at the same address modulo 4. We can also see on figure 10 that the pedestal oscillation with the capacitor address (Fig. 5) can be exactly reproduced by folding modulo 4 the synchronous noise pattern of figure 9

### Synchronous noise in other runs

The "ADC" effect is barely visible on a medium gain run 201329 (98/Nov/19 at 15:35), a fact proving that the noise is collected before the shaping stage. A quantitatively similar effect is found on another high gain run 200917 (98/Nov/15 at 6:41) with the same FEB configuration (a 5th FEB was located in FEC 2), but it is found completely different in high gain runs with other FEB configuration. This is the case for run (201050 of 98/Nov/16 at 0:45) in which 5 FEBs were in configuration 1-4-5-14-11 (Fig. 11 and 12).

The previous observation implies that there is a correlation between the noise in the various FEBs. This correlation is clearly visible in figure 13 which shows the cross distribution of the middle and back FEB signals.

Figure 10: Comparison of the synchronous noise (left) and of the pedestal variation per capacitor (right). The left part is obtained by folding figure 9 modulo 4 and dividing it by 2 (folding) and 128 (number of channels). The right part is obtained from Fig. 5 by averaging the pedestal values of both half FEBs.

Figure 11: Same figure as Fig. 8 for another high gain run with different FEB configuration.

Figure 12: Same figure as Fig. 9 for another high gain run with different FEB configuration.

## 4 Quantitative study of the coherent noise

In order to understand the coherent noise inside a FEB, one has assumed the following model : suppose the \(N\)-dimensional noise vector \(\mathbf{b}\) has the form

\[\mathbf{b}=\mathbf{u}+c\:\boldsymbol{\alpha}\]

where \(\mathbf{u}\) is an uncoherent noise vector, \(c\) is a number caracterizing the level of coherent noise in an event and \(\boldsymbol{\alpha}\) a normalized vector which components are the level of coherent noise in the various channels.

We call \(\sigma_{c}^{2}\) the variance of \(c\) and assume that all channels have uncoherent noise with common variance, i.e. \(<u_{i}u_{j}>=\sigma^{2}\delta_{ij}\). In this model, the noise covariance matrix \(B\) (\(B_{j}=<b_{i}b_{j}>\)) has the form

\[B=\sigma^{2}+\sigma_{c}^{2}\:\boldsymbol{\alpha}\:\boldsymbol{\alpha}^{\:t}.\]

It is easy to show that \(B\) allows \(\boldsymbol{\alpha}\) as an eigenvector corresponding to eigenvalue \(\sigma^{2}+\sigma_{c}^{2}\) and any vector orthogonal to \(\boldsymbol{\alpha}\) as an eigenvector corresponding to eigenvalue \(\sigma^{2}\). Thus, in this model, the spectrum of matrix \(B\) should be flat, except for one eigenvalue and the components of the eigenvector corresponding to the latter eigenvalue should give the level of coherent noise in each of the \(N\) channels.

One has computed matrix \(B\) for each of the 4 FEBs. The eigenvalues of \(B\), arranged from the smallest to the highest, are shown on figure 14. One can see that the eigenvalues are almost equal except one (or very few) which significantly deviates from the others in support to the above model. Let us note that the plateau in the distribution flattens as the number of events used

Figure 13: Time correlation of the sum of the 128 channels of the back sampling versus the same sum in the middle sampling FEB at a later time (+1, +2, +3, +4).

to compute \(B\) increases, so that strict flatness could be achieved with infinite statistics.

We now assume that our model is correct and try to exploit the data as much as we can. The values of \(\sigma^{2}\) and \(\sigma^{2}_{c}\) can read on the figure: \(\sigma^{2}\) at channel \(N/2\) and \(\sigma^{2}+\sigma^{2}_{c}\) at channel \(N\).

\begin{tabular}{c|c|c|c|c}  & PS & Strips & Middle & Back \\ \hline \(\sigma\) & 7.6 & 7.5 & 4.7 & 4.9 \\ \(\sigma_{c}\) & 13.9 & 8.5 & 14.5 & 16.0 \\ mean coherent noise \(\sigma_{c}<\alpha_{i}>\) & 1.20 & 0.62 & 0.75 & 1.04 \\ \end{tabular}

The components of the eigenvector associated to the highest eigenvalue are shown in figure 15 as a function of the FEB channel number for each of the 4 FEBs. They have been multiplied by \(\sigma_{c}\) and thus represent the channel by channel coherent noise, which mean value is in good agreement with the value estimated by the standard method. The global variation with the FEB channel number corresponds to an increase of noise with the channel position on the FEB. In the middle and back samplings, there is a clear oscillation with periodicity 2, showing that there is more coherent noise on one face of the FEB than on the other. This occurs for even channels on the middle sampling FEB and for odd channels on the back sampling FEB. A closer look to the back sampling FEB indicates also a periodicity of 4. Finally, on the strips FEB a periodicity of 8 can be observed.

To carry on, we have computed the elements of the deflated matrix \(B-\sigma^{2}_{c}\ \boldsymbol{\alpha}\ \boldsymbol{\alpha}^{t}\) and have found that its off-diagonal elements were flat around a null value. The square root of the new diagonal elements, which we can call uncoherent channel noise, are now channel independant (Fig. 16).

Another trick has been used to estimate the coherent FEB noise \(c\) on an event by event basis. Now that we know that the channel noise can be written

Figure 14: Spectrum of the \(N=122/128\) eigenvalues for each FEB.

Figure 16: Uncoherent channel noise (in ADC counts) as a function of the FEB channel number.

Figure 15: Coherent channel noise (in ADC counts) as a function of the FEB channel number. The normalized components of the eigenvector associated with the highest eigenvalue (\(\boldsymbol{\alpha}\cdot\boldsymbol{\alpha}=1\)) have been multiplied by \(\sigma_{c}\).

in the form \(\mathbf{b}{=}\ u+c\,\boldsymbol{\alpha}\), we estimate \(c\) by requiring that, for each FEB, the quantity \(\sum_{i}\left(b_{i}-c\alpha_{i}\right)^{2}\) be minimal. The c estimator has the form

\[c=\sum_{i=1}^{N}\alpha_{i}b_{i}\equiv\boldsymbol{\alpha}\cdot\mathbf{b}\]

The distribution of \(c\) for each FEB is shown on figure 17. We clearly see the multibump structure in the middle and back sampling. The large correlation between the back and middle coherent noise can be appreciated in the cross distribution of figure 18.

To conclude, we argue that this method can be used to compute the coherent noise sample per sample in a physics run by estimating \(c\) in a region outside the beam region. The coherent noise can then be subtracted providing an improved energy resolution.

Figure 17: Distribution of the estimated mean coherent noise (in ADC counts) on a FEB.

Figure 18: Cross distribution of the coherent noise (in ADC counts) in the middle (\(x\)) and back (\(y\)) FEBS.