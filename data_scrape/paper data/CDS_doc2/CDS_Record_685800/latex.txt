**ATLAS Internal Note MUON-NO-040**

**4 May 1994**

Autocalibration method for determination of drift time -- space relation for HPDT

S. Baranov, A. Glazov, V. Dodonov

April 29, 1994

## 1 Introduction

In this paper we describe a new method for determination of drift time - drift distance correspondence, \(R(t)\), for HPDT [1]. The problem has risen due to the nonuniformity of the electric field inside the tube leading to a variable electron drift velocity. Autocalibration, i.e. determination of \(R(t)\) using data from the drift tubes only, without any external high precision reference system, is very important for several reasons, among them we can mention monitoring and correction of \(R(t)\) for different magnetic field strength in ATLAS. As we will describe below, common methods for \(R(t)\) determination use some non-physical assumptions, which can be wrong in general case. This leads to rather big errors in R(t), especially near the wire and the tube inner surface. We suggest a method for drift time - space relation determination which is almost free of this disadvantage.

## 2 Conventional methods

In this section we briefly describe some methods for determination of drift time - space relation. At first we present two methods which usually are used as initial approximation. The last method described is used to correct it.

### Theoretical calculations

There are several programs for theoretical calculation of electron drift velocities in different gas mixtures (garfield, Magboltz, etc). Since the Magboltz calculations are based on available experimental data the expected accuracy is at the level of 10%. There are some principal restrictions on the usage of this method, for example non-complete set of described gas mixtures and difficulties in explanation of the electron drift behavior in the high electric field in the region near the anode wire.

### Integration method

Suppose that for one tube we have registered a big amount of track, so that for each channel of the tube TDC we have several events measured at this channel. Suppose also that the track distribution is uniform over \(r\), so

\[\frac{dn}{dr}=const=\frac{N_{tot}}{R_{tube}} \tag{1}\]

TDC spectrum shown on Fig. 1 corresponds to \(dn/dt\) distribution. Now we will assume that the tube works with 100% efficiency and without the noise, that means that all measured times correspond to correct drift distances. In this case one can evaluate:

\[V(t) = \frac{dr}{dt}=\frac{dn}{dt}\frac{dr}{dn}=\frac{R_{tube}}{N_{tot}} \frac{dn}{dt},\] \[R(t) = \frac{R_{tube}}{N_{tot}}\int_{o}^{t}\frac{dn}{dt}dt, \tag{2}\]

so to find \(R\) corresponding to TDC channel \(i\) one should take sum of the TDC hits in the Fig. 1 up to channel \(i\).

The problems of this method are obvious. In many cases we can not guarantee the uniformity of the track distributions. The second disadvantage of the method arises due to \(\delta\)-rays which spoil the tube measurements. This leads to migration of measurements with bigger \(t\) to smaller ones on the \(1\)-dimensional histogram of TDC hits.

Figure 1: Typical TDC spectrum for gas mixture with variable \(V_{drift}\)

### Track correction methods

The track correction method of drift time - space relation determination is based on the information in several tubes hitted by the track of the same particle. To simplify the description (without the loss of generality) we will talk about two half-shifted tube system with tracks parallel to \(Z\)-axis (see Fig. 2). Suppose that we have initial approximation of drift time - space relation, \(R^{n}(t)\), then the track method is formulated as follows:

\[R^{n+1}(t_{i})=(1-\alpha)R^{n}(t_{i})+\alpha D_{i}^{n}, \tag{3}\]

here we denote as \(\alpha\) the _learning rate_ and as \(D_{i}^{n}\) the distance from the tube wire to the track, reconstructed in all hitted tubes excluding the \(i\)-th one, in our case \(D_{1,2}^{n}=L-R_{2,1}^{n}\), as \(L\) we denote the distance between the tubes wires. If one takes \(\alpha_{learn}=0\), that means that on the next iteration \(R^{n+1}(t_{i})\) will be the same, if \(\alpha=1\), then -- will be determined only from the other tubes; in other words \(\alpha\) means the weight with which we use the \(i\)-th tube in the track fit through all hitted tubes. The most natural choice is the equal weights for all tubes, in our case that leads to \(\alpha=0.5\) To finally obtain the new approximation of the drift time - space relation one have to take average over all tubes in all events inside some \(t\) bins. Here we should note that we can reject events spoiled by \(\delta\)-rays using \(\chi^{2}\) criterion.

In the case of \(\alpha=0.5\), one can obtain from equation 3:

\[R^{n+1}(t_{1})+R^{n+1}(t_{2}) = L \tag{4}\] \[R^{n+1}(t_{1})-R^{n+1}(t_{2}) = R^{n}(t_{1})-R^{n}(t_{2}). \tag{5}\]

The first condition means the physical track definition that the sum of measured distances should be equal to the distance between the tubes wires. The second means that to obtain the new approximation of \(R(t)\) we make a projection along \(R_{1}^{n}-R_{2}^{n}\) direction. The physical reasons could be the smallness of this correction and, again, the uniformity of track distribution, but both these reasons can fail, especially for large \(|R_{1}^{n}-R_{2}^{n}|\) (tracks going near the wall of one tube and near the wire of the another).

## 3 Unfolding method

To overcome the problems of the track correction method described in the previous section we suggest to use only the physical restriction from equation 4. However, it is obvious that using one _constant_\(L\) one can not unfold a _function_\(R(t)\). For example, constant function \(R(t)=L/2\) clearly satisfy eq. 4. So we must have different \(L\), what is obtained by tracks with different inclinations in real experiment, or by turning the tube system in the beam-test (See Fig. 2). To increase statistics, in addition to condition (4), we can also use tubes hitted fromone side by the track with restriction on the difference of their measurements:

\[|R(t_{i})-R(t_{j})|=L_{ij}, \tag{6}\]

as \(L_{ij}\) we denote the projection of the distance between \(i\) and \(j\) wires on the perpendicular to the track direction.

Using the above assumption we can formulate the problem of drift time - space relation determination as the LSQ functional:

\[{\cal L}=\sum\left(|R(t_{i})\pm R(t_{j})|-L_{ij}\right)^{2}\rightarrow\min, \tag{7}\]

here the sum is taken over all pairs of hitted tubes in all events, the sign "+" corresponds to tubes lying on the different sides from the track and "\(-\)" -- on the same side.

We should note here that we neglect the \(L_{ij}(t_{1}\ldots t_{n})\) dependence in equation (7). It is true, in the case of the beam-test experiment, then we obtain different \(L_{ij}\) in parallel tracks by turning the tubes "flower". In the real experiment the errors of \(L_{ij}\) are proportional to the angular resolution. If as \(i,j\) we take only tubes inside one triple-layer, this errors have a factor \(D_{ij}/D_{layer}\sim 1/10\) (\(D_{ij}\) -- distance between tubes inside the triple-layer, \(D_{layer}\) -- distance between layers) to the errors of the initial \(R(t)\) approximation.

If the function \(R(t)\) is given in parametric form, \(R(t)=R(t,\alpha_{1},\ldots,\alpha_{n})\), one obtains the following system of equations:

\[\frac{1}{2}\frac{\partial{\cal L}}{\partial\alpha_{i}}=\sum\left(|R(t_{i})\pm R (t_{j})|-L_{ij}\right)\times\]

\[\times{\rm sign}(R(t_{i})\pm R(t_{j}))\left(\frac{\partial R(t_{j})}{\partial \alpha_{i}}\pm\frac{\partial R(t_{j})}{\partial\alpha_{i}}\right)=0, \tag{8}\]

Figure 2: Two half-shifted tubes (left) and turned flower (right)

which in case of linear dependence of \(R(\alpha_{i})\) (for example -- \(\alpha_{i}\) are coefficients in the polynomial series), is also linear.

## 4 Simulation and results

To test the method of drift time - space relation determination described in the previous section we used highly realistic simulation of the beam-test setup based on GEANT [2] package. We used detector setup consisting of two "flowers" each of seven drift tubes (see Fig. 2) and the "beam" of 100 \(GeV\) muons with experimentally measured angular distribution with track divergency of 0.02 \(rad\). The first of the flowers could rotate and the sample of 1000 events was taken for each of several angles \((0,0.1,0.2,0.3,0.4,0.5\ rad)\). The second flower was fixed and its general purpose was to resolve the left-right ambiguity.

In the simulation of the drift tubes respond we used constant gaussian resolution (\(\sigma=50\mu m\)) and a drift time - space relation, similar to one for "standard" gas mixture. We included also all GEANT processes (\(\delta\)-rays, multiply scattering, etc).

To parametrise the \(R(t)\) function we used cubic splines. We divided the region of the possible drift times onto 20 nonequal subregions.

Initial model R(t) dependence is shown on Fig 3 (solid line). As the first approximation for unfolding method we took statistically and systematically shifted function shown on the same figure as a dotted line.

Such a poor first approximation did not allow us to use strong cut on \(\chi^{2}\)

Figure 3: **Left** : Initial drift characteristics (solid line) and its first approximation (dotted line). **Right** : Difference between initial drift characteristics and first (solid) and second (dotted), iteration of unfolding method

to sufficiently reduce \(\delta\)-ray influence. So to obtain the final result we used two iteration of unfolding method, first with the cut \(\chi^{2}\leq 100\) and second with the cut \(\chi^{2}\leq 10\). To further decrease the \(\delta\)-rays influence we used the method described below.

Generally, calculated drift characteristic has substantial gap at its end in comparison with the real drift characteristic, which arises due to the large amount of \(\delta\)-electrons near the tube wall. Furthermore these bad events with \(\delta\)-electrons induce a peaks at several places on drift characteristic as the functional is filled by a time measurements from two tubes. To diminish this peaks we used two methods: first one - we droped events which had one or both measured radii too close to tube wall and expanded the last subregion so that the cuted part occupies a little part of the subregion - this reduces last gap, second - we introduced an event weights so the events with measured radiuses near the tube wall were dumped by "normal" events - this reduces induced peaks.

The difference between the model drift time - space relation and obtained after 1-st (solid line) and 2-nd (dotted line) iterations of unfolding method are presented on Fig 3. For the final result we got RMS of the approximation less than \(7\mu m\).

We tested our method for different sets of the first flower rotation angles. The RMS of the approximation was almost the same even than we took only 2 different angles.

## 5 Conclusion

The method described above showed stability to the noise, fast convergency and high precision. As its special benefit we can mention here its ability to unfold different drift time - space relations for different superlayers in ATLAS simultaneously, what is very important in the case of changing magnetic field.

Further improvements of the method (if necessary) could be obtained by using \(R(t)\) parametrisation better describing initial problem.

## References

* [1] HPDT for ATLAS, ATLAS note, MUON-NO-029, 1993.
* [2] GEANT User's Guide (DD/EE/84-1)