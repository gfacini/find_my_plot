A study of different colour reconnection settings for Pythia8 generator using underlying event observables

The ATLAS Collaboration

A study of the performance of various colour reconnection models included in the Pythia8 Monte Carlo event generator is performed using leading charged-particle underlying event data in three centre-of-mass energies from Run 1 and Run 2, measured in ATLAS. Each model can be tuned to describe the data reasonably well.

## 1 Introduction

The Pythia8[1; 2] Monte Carlo (MC) event generator is used extensively in ATLAS simulation. The modelling of multiple parton interaction (MPI) and colour reconnection (CR) in the Pythia8 generator is especially important to describe minimum-bias (MB) and underlying event (UE) observables, which is necessary for using Pythia8 as a standalone generator, or in conjunction with mulileg/multiloop matrix element generators.

Recently several new models for CR [3; 4; 5]. has been added to Pythia8. In this note, the effect of changing the colour reconnection model on observables sensitive to the underlying event is probed. ATLAS has performed measurement of underlying event [6; 7] using the leading charged particle as reference at centre-of-mass energies of \(\sqrt{s}=900\) GeV, 7 TeV and 13 TeV, the data from which are used in this study.

The Rivet analysis toolkit [8] and the Professor MC tuning system [9] are used in this study, at versions 2.5.3 and 2.1.4 respectively. The Pythia8 version used was 8.219, with the PDFs taken from LHAPDF version 6.1.3 [10].

## 2 Tuning Strategy

The CR and MPI effects are strongly correlated, so along with CR parameters, MPI parameters were also considered. The tune is based on the A14 tune [11], which used ATLAS \(\sqrt{s}=7\) TeV measurement of dijets, \(t\overline{t}\) and \(Z\)-boson processes to tune MPI, CR, initial state and final state radiation parameters. It must be noted that the A14 tune was obtained for four different PDFs, but in ATLAS the version with NNPDF23LO [12] PDF is used, and in this note, A14 refers to this particular variant only. This note is not intended to propose new Pythia8 tunes for general use. Rather, it presents a study of how the choice of colour reconnection model affects UE observables and the extent to which retuning of CR and MPI parameters can improve agreement with data for alternative CR models.

Tunes are performed using the Professor automated tuning tool, where each bin of each observable is parametrised as a \(N\)-dimensional 3rd order polynomial based on the sampled tune points in the parameter hypercube (\(N\) being the number of tuned parameters). These parametrisations are then used to calculate a \(\chi^{2}\) with respect to the reference data, which is numerically minimised in the parameter space to find the best tune point.

The tuned MPI and CR parameters are listed in Table 1, with a very brief definition. The remaining parameters were left unchanged from the A14 tune. A more detailed description of the parameters is beyond the scope of this note, and the reader is referred to the Pythia8 online documentation.

Three CR models have been considered.

* MPI based CR model (CR0): In this model, the probability for coloured partons with transverse momentum \(p_{\mathrm{T}}\) from MPI to reconnect is calculated according to: \[P_{\mathrm{rec}}(p_{\mathrm{T}})=\frac{(R_{\mathrm{rec}}\cdot p_{\mathrm{T} 0})^{2}}{R_{\mathrm{rec}}\cdot p\mathrm{T}0+p_{\mathrm{T}}^{2}}\] (1)where \(R_{\rm rec}\) is the ColourReconnection:range and \(p_{\rm T0}\) is the MultipartonInteractions:pT@Ref parameter in Table 1. For each MPI system that undergoes a reconnection, partons from lower \(p_{\rm T}\) MPI systems are added to the dipoles defined by the higher \(p_{\rm T}\) MPI system, in a way that minimizes the total string length.
* QCD based model (CR1): This model evolved from the MPI based model. The main difference with respect to CR0 and CR2 (described next) is the more complete treatment of the QCD multiplet structure and in particular that reconnections of dipoles can produce structures of three (anti-)colour indices (junctions), thereby enhancing the production of baryons. As in the CR2 model, in this model only reconnections which lower the string length are performed.
* Gluon-move model (CR2): In the gluon move model (CR2), reconnections are performed in the same way as in the CR0 model. The main differences with the default model are that in the CR2 model only gluons are considered for reconnection. For each gluon all the reconnections to all MPI systems are considered (not only the ones for softer MPIs), therefore in principle the colour flow from the hard interaction can be affected more significantly than in the default model.

For each CR model, one million soft-QCD inelastic \(pp\) events were generated for three hundred and fifty parameter points from a random sampling of the hypercube defined by the considered parameter ranges. This was done for each of the three centre-of-mass energies.

A two-step strategy was adopted in this study.

* Starting from the A14 configuration, only the CR model was changed, along with the recommended settings corresponding to that model.
* A tune was performed for each CR model, by using all available UE distributions at all three centre-of-mass energies. For this study, only a subset of parameters (described below) were varied in the tuning.

The data used in this study includes ATLAS measurements of underlying event using the leading charged particle in three centre-of-mass energies. Charged particle multiplicity and sum \(p_{\rm T}\), correlation of mean \(p_{\rm T}\) with charged particle multiplicity, and angular distribution of charged particles with respect to the leading charged particle were some of the observables measured. At \(\sqrt{s}=13\) TeV, the \(p_{\rm T}\) distribution of leading charged particle was also measured. All published distributions were used in the tuning.

## 3 Results and discussions

Fig. 1 - Fig. 3 show the results of the tuning process for each CR models, CR0, CR1 and CR2 models, respectively. In each case, data for four UE observables are compared with the predictions from A14 (or A14 with CR model changed to CR1 or CR2), and with tuned predictions. For CR2 model, in order to keep tuned parameter values within the physically permissible range, ColourReconnection:dLambdaCut was set to zero.

Figure 1: Predictions using the A14 tuned parameter settings (red), and a new set of tuned parameters with CR0 model (blue) are compared with transverse region charged particles sum \(p_{\rm T}\) density, multiplicity density, mean \(p_{\rm T}\) against multiplicity correlation and angular distribution of charged particles with ATLAS data from Run 1 and Run 2 [6; 7] for CR0 model. The yellow shaded areas at the ratio plot in the bottom represent the uncertainty on the data.

Figure 2: Predictions using the A14 tuned parameter settings (red), A14 tuned parameter settings with only CR model changed to CR1 (blue), and a new set of tuned parameters with CR1 model (green) are compared with transverse region charged particles sum \(p_{\rm T}\) density, multiplicity density, mean \(p_{\rm T}\) against multiplicity correlation and angular distribution of charged particles with ATLAS data from Run 1 and Run 2 [6; 7] for CR1 model. The yellow shaded areas at the ratio plot in the bottom represent the uncertainty on the data.

Figure 3: Predictions using the A14 tuned parameter settings (red), A14 tuned parameter settings with only CR model changed to CR2 (blue), and a new set of tuned parameters with CR2 model (green) are compared with transverse region charged particles sum \(p_{\rm T}\) density, multiplicity density, mean \(p_{\rm T}\) against multiplicity correlation and angular distribution of charged particles with ATLAS data from Run 1 and Run 2 [6, 7] for CR2 model. The yellow shaded areas at the ratio plot in the bottom represent the uncertainty on the data.

The Tab. 2 documents the results for each of the tunes described earlier. For each of the new tunes, the \(\chi^{2}\) values, divided by the number of degrees of freedom for the distributions are shown. This evaluates the compatibility of the measured data with the distributions predicted by each tune.

\begin{table}
\begin{tabular}{l l} \hline \hline Parameter & Definition \\ \hline MPI Parameters & \\ MultipartonInteractions:pT0Ref & \(p_{\mathrm{T}}\) regularisation parameter \\ MultipartonInteractions:expPow & Exponent of matter overlap function \\ \hline MPI based CR model (CR0) & \\ ColourReconnection:range & CR strength \\ \hline QCD-based model (CR1) & \\ ColourReconnection:m0 & Mass parameter of order \(\lambda_{QCD}\) used in the string length measure \\ ColourReconnection:junctionCorrection & Multiplicative correction to string length above \\ \hline Gluon-move scheme (CR2) & \\ ColourReconnection:m2Lambda & Equivalent to m0 for QCD-based model \\ ColourReconnection:fracGluon & Average fraction of gluons that undergo a colour reconnection \\ ColourReconnection:dLambdaCut & Minimal value for decrease in string length \\ \hline \hline \end{tabular}
\end{table}
Table 1: Tuning parameters and their definitions. The MultipartonInteractions:expPow can only be used with an exponential MPI matter overlap function (MultipartonInteractions:bProfile = 3). The parameters specific to a CR model are stated together. CR1 model was used was used with ColourReconnection:allowDoubleJunRem = off setting, as recommended by the authors.

Figure 4: Predictions using the A14 tuned parameter settings (red), A14 tuned parameter settings with only CR model changed (blue), and a new set of tuned parameters with the new CR model (green) for CR0, CR1 and CR2 settings (left to right) are compared with leading charged particle \(p_{\mathrm{T}}\) distribution with ATLAS data from Run 2 [7]. The yellow shaded areas at the ratio plot in the bottom represent the uncertainty on the data.

The following observations can be made from the distributions and the tuning process:

* In Fig 1, the currently used CR0 setting is probed. Overall, across the three centre-of-mass energies, the new tune performs very similarly to A14. This can be explained as A14 does not include the recently published Run 2 result. However, for mean \(p_{\mathrm{T}}\) against charged multiplicity correlation, which is the most sensitive observable to CR, default A14 does slightly better, specially at \(\sqrt{s}\) = 13. For the angular distribution of charged particles, the opposite trend is seen, with the new tune doing better, although there is some difference in shape for all tunes. This difference disappears when this distribution corresponding to a higher leading charged particle \(p_{\mathrm{T}}\) threshold is looked at.
* In Fig 2, it can be seen that by changing the CR model to CR1 but keeping all the other A14 settings, an appreciable drop in the performance happens. However, good agreement with data can be recovered by tuning.
* In Fig 3, the trend is different from previous cases. Only changing the CR model to CR2 but keeping all the other A14 settings, it still maintains a good level of agreement with the data across all three centre-of-mass energies. The new tune does not do so well, and it has a bad goodness of fit as well. In this case, unlike for the other two, tuning tended to push one of the CR parameters to unphysical ranges, and when they were constrained to be within their model-specified ranges, they mostly preferred values close to the maximum or minimum permitted values.
* Although not directly related to the property of the UE, the distribution of leading charged particle \(p_{\mathrm{T}}\) in Fig. 4 actually shows larger difference between the tunes. Only for CR0, this distribution can be modelled well without destroying agreement with other UE observables, which is not the case for CR1 or CR2.
* Another useful output of the tuning process is the observed correlation between different tuned parameters. For CR0 model, a strong anti-correlation (78%) is observed between MultipartonInteractions:pT@Ref and MultipartonInteractions:expPow, while ColourReconnection:range is very loosely correlated

\begin{table}
\begin{tabular}{l l r r r} \hline \hline Parameter & A14/ & \multicolumn{3}{c}{Tune} \\  & Default (range) & CR0 & CR1 & CR2 \\ \hline MultipartonInteractions:pT@Ref & 2.09 & 2.15 & 1.89 & 2.21 \\ MultipartonInteractions:expPow & 1.85 & 1.81 & 2.10 & 1.63 \\ \hline ColourReconnection:range & 1.71 & 2.92 & – & – \\ ColourReconnection:m\# & 0.3 (0.1 - 5) & – & 2.17 & – \\ ColourReconnection:junctionCorrection & 1.20 (0.01 - 10) & – & 9.33 & – \\ \hline ColourReconnection:m2Lambda & 1.0 (0.25-16) & – & – & 6.73 \\ ColourReconnection:fracGluon & 1.0 (0-1) & – & – & 0.93 \\ ColourReconnection:dLambdaCut & 0 (0-10) & – & – & _0.0_ \\ \hline \hline \(\chi^{2}\), \(Ndof\) & & 17706, 2929 & 18597, 2928 & 113814, 2928 \\ \(\chi^{2}/Ndof\) & & 6.1 & 6.4 & 38.9 \\ \hline \hline \end{tabular}
\end{table}
Table 2: Obtained tuned values for different parameters for each setup is shown, along with the goodness of fit measure. The parameters that are not defined for a particular model are left blank. In the first column (for A14), the recommended values suggested by the authors, with the allowed range is shown. The values in _italics_ indicate that they were fixed during the tuning process.

(14%) with MultipartonInteractions:expPow and anti-correlated (38%) with MultipartonInteractions:pT0Ref. For CR1 model, MultipartonInteractions:pT0Ref is loosely anti correlated with the rest of the tuned parameters, with the effectively no correlation (7%) with ColourReconnection:m0. The two CR parameters, ColourReconnection:m0 and ColourReconnection:junctionCorrection are strongly correlated (71%). Finally for the CR2 model, the two tuned CR parameters are loosely correlated (16%), but ColourReconnection:m2Lambda is correlated (32%) with MultipartonInteractions:pT0Ref, while ColourReconnection:fracGluon is anti-correlated (59%).

## 4 Conclusion

A detailed study using leading charged particle underlying event distributions at three centre-of-mass energies is performed for different colour reconnection models in Pythia8. While it is seen that overall all CR models can be tuned to describe most of the observables within 20%, there are differences in how each model performs. None of the models individually can describe all the observables perfectly. Specifically CR0 and CR1 models perform significantly better than CR2, and the leading charged particle \(p_{\mathrm{T}}\) distribution modelling gets worse when trying to describe UE observables with newer models. Further studies are needed to understand the effect of newly introduced model parameters on UE observables, especially on the observables which are sensitive to CR effects.

## References

* [1] T. Sjostrand, S. Mrenna and P. Skands, _A brief introduction to PYTHIA 8.1_, Comput. Phys. Commun. **178** (2008) 852, arXiv: 0710.3820 [hep-ph].
* [2] T. Sjostrand et al., _An Introduction to PYTHIA 8.2_, Comput. Phys. Commun. **191** (2015) 159, arXiv: 1410.3012 [hep-ph].
* [3] J. R. Christiansen and P. Z. Skands, _String Formation Beyond Leading Colour_, JHEP **08** (2015) 003, arXiv: 1505.01681 [hep-ph].
* [4] S. Argyropoulos and T. Sjostrand, _Effects of color reconnection on \(t\bar{t}\) final states at the LHC_, JHEP **11** (2014) 043, arXiv: 1407.6653 [hep-ph].
* [5] J. R. Christiansen and T. Sjostrand, _Color reconnection at future \(e^{+}\)\(e^{-}\) colliders_, Eur. Phys. J. **C75** (2015) 441, arXiv: 1506.09085 [hep-ph].
* [6] ATLAS Collaboration, _Measurement of underlying event characteristics using charged particles in \(pp\) collisions at \(\sqrt{s}=900\) GeV and \(7\) TeV with the ATLAS detector_, Phys. Rev. D **83** (2011) 112001, arXiv: 1012.0791 [hep-ex].
* [7] ATLAS Collaboration, _Measurement of charged-particle distributions sensitive to the underlying event in \(\sqrt{s}=13\) TeV proton-proton collisions with the ATLAS detector at the LHC_, JHEP **03** (2017) 157, arXiv: 1701.05390 [hep-ex].
* [8] A. Buckley et al., _Rivet user manual_, Comput. Phys. Commun. **184** (2013) 2803, arXiv: 1003.0694 [hep-ph].
* [9] A. Buckley et al., _Systematic event generator tuning for the LHC_, Eur. Phys. J. **C65** (2010) 331, arXiv: 0907.2973 [hep-ph].