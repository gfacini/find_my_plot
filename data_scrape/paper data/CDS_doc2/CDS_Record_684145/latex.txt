[MISSING_PAGE_EMPTY:1]

## 1 Introduction

Figure 1: Normalized shape of the testpulse as a function of time. There are two cells with \(\eta=25\) and \(\varphi=9\) (left) and \(\eta=25\) and \(\varphi=10\) (right) read in high (top) and medium (low) gains.

Figure 2: Noise for the same cells as in figure 1.

Calibration pulses study

The study presented below has been performed on the delay run 203766 in which middle sampling is pulsed with DAC value 300; there are 25 delays every nanosecond. The data are read out in high and medium gain.

### Amplitude reconstruction

The calibration profiles are shown in figure 1. Figure 2 shows the rms noise on the points. It is compatible with the rms noise measured on pedestal.

Next, we have computed the OF weights using formula (1) for each value of the delay. The noise autocorrelation matrix \(B\) has been taken from a pedestal run. The 5 weights obtained for each of the 25 delays are displayed in figure 3 according to the position in time of the sample to which they are applied.

Using these coefficients, we have computed the amplitude of the signal for each event by using estimator (1). Figure 4 shows the mean reconstructed value as a function of the phase; the error bars give the resolution. For the sake of comparison, we plot the same distribution when the maximum is computed by the parabola method1. We can see that the amplitude obtained with the OF method is independent of the phase (i.e. unbiased) while this is not the case for the parabola method. From a quantitative point of view, the resolution of the reconstructed ADC value is about 3 ADC counts for the high gain and 0.6 ADC counts for the medium gain. These values, compared to the noise (5 and 1 ADC counts respectively) shows that the OF method gives a factor of 1.7 gain in the noise.

Footnote 1: In this method, the maximum is computed by ”fitting” a parabola on 3 points around the highest point and correcting it using a universal calibration shape.

### Sensitivity of the method to the value of \(a\)

The OF estimator (1) is unbiased, i.e. if one measures repeatedly the same signal, one has

\[<\tilde{E}>\,=\,a^{t}<y>\,=\,Ea^{t}g=E\]

because the OF weights satisfy the condition \(a^{t}g=1\). However, any weighted mean of the samples \(e=\sum_{i}w_{i}y_{i}\) with the normalization

\[w^{t}g=1 \tag{2}\]

is also unbiased:

\[<e>\,=<w^{t}y>\,=\,w^{t}<y>\,=\,(w^{t}g)E=E\quad.\]

But, the OF estimator is the weighted mean of minimum variance, i.e. amongst all sets of coefficients satisfying \(w^{t}g=1\)

\[var\left(e\right)=<e^{2}>\,-<e>^{2}=\,\cdot\cdot\cdot=w^{t}Bw\]

is minimal for the OF weights: \(w=a\). The minimal value is

\[var\left(\tilde{E}\right)=\frac{1}{g^{t}B^{-1}g}\quad.\]

We have thus devised other sets of weights (Fig. 5):

* the "integral" weights \(w_{int}\): the 5 weights are equal, so that the estimator is just a mean of the 5 samples.
* the "maximum sample" weights \(w_{max}\): all the weights are zero except the one corresponding to the maximum sample; this weight is equal to the inverse of the corresponding value of \(g\) (Fig. 1).

The resolution for each of the methods is shown in figure 6.

One can see that the parabola method and the maximum weights give comparable resolution. The other 2 sets of weights give almost the same resolutions although they are quite different in shape.

Figure 4: Normalized amplitude as a function of the sampling phase (see text). Solid lines are for optimal filtering and dashed for the parabola method.

Figure 3: Optimal filtering coefficients.The first coefficient \(a_{0}\) is plotted as a function of the phase between 0 and 25 ns, the second \(a_{1}\) between 25 and 50 ns, etc.

Figure 5: Various weights tested for a given cell: optimal (top left), integral i.e all weights equal (top right) and maximum i.e. using only the central sample (bottom left).

Figure 6: Test pulse resolution.The white boxes correspond to the OF weights, the light grey one to the ”integral” weights and the heavier grey one to the ”maximum” weights. The triangles show the resolution obtained with the parabola method.

## 3 Physics pulses study

### Pulse shape reconstruction

It is quite easy to determine the shape of calibration pulses because they are generated with a fixed amplitude and time. This is not the case for physics events for which we only know their timing but not their amplitude. Nevertheless, it is possible to get the pulse profiles by accumulating, for each cell, all the physics events with their highest sample above a certain minimum (we have chosen the pedestal plus 8 times the noise and verified that no cell verifies this criterion for random events). Although energy deposited in a given cell has a very broad spectrum, the method is unbiased in the limit of infinite statistics. The profiles shown in the upper part of figure 7 have been obtained with 80,000 triggers taken in the 20 GeV runs 205419 to 205422.

If we want to get the pulse shape \(g(t)\), we have to get rid of the fluctuations which appear in the plots as much as possible. An ideal method would be to fit a theoretical shape to these curves but we are not presently ready to do so. We thus have devised a smoothing method based on the following remark. For a given triggering time bin, the corresponding 5 samples ("quintuple") have the mean value

\[<y_{i}>=<E>g_{i}\quad(i=1,2,\ldots\ 5)\]

in which \(<E>\) is the mean energy for these events. From one time bin to another, the value of \(<E>\) fluctuates in such a way that, if \(<E>\) is higher/lower than the expectation value of \(E\), the corresponding quintuple goes simultaneously up or down with respect to the theoretical shape. In order to smooth the curve, we thus have to move up or down the 5 samples of the quintuple by the same factor and not to move them independantly. The smoothing procedure we adopted is as follows: consider a quintuple.

Figure 7: Unnormalized physics pulse profiles (ADC counts) in 2 neighbouring cells of the middle sampling of the calorimeter. The upper plots are raw and the lower are smoothed (see text).

For each of the 5 samples, we determine the best 3rd order polynomial running through the 9 points on each side and compute the vertical distance between the sample and the polynomial. We then attribute a \(\chi^{2}\) to the quintuple as the sum of the 5 squared vertical distances. We next find the worst quintuple (in terms of \(\chi^{2}\)) and move it by a global factor in order to minimize its \(\chi^{2}\). We iterate the above and finally get a smoothed shape as shown in the lower part of figure 7.

### Channel amplitude reconstruction

From there, we have computed the OF weights by using the autocorrelation matrix computed in the nearest pedestal run. The resulting weights are presented in figure 8. These weights look different from those obtained for the calibration (Fig. 3) because, the time intervals in which the 5 samples are taken are different (compare Fig. 1 and Fig. 7). These weights have been used to compute the reconstructed energy (in ADC counts) in each cell. As a test of the method, we have computed the mean energy obtained for random events and compared to the energy computed form the central sample. Figure 9 shows that the latter have rms about 4.7 ADC counts while the values obtained with the OF method is about 2.7 ADC counts, i.e. the gain is about 1.7.

As a last test, we have computed the energy obtained with the parabola and the OF methods and plotted as a function of the phase of the samples (Fig. 10). We see that the curves have very similar behaviour.

### Total energy reconstruction

The aim of this section is NOT to compute the ultimate calorimeter resolution but to compare the raw energy (before any correction) obtained with the OF method to that obtained with the parabola method. To compute the energy, the standard \(3\times 3\) cluster has been used. Finally, at 20 GeV, we have applied the following cuts:

* 300 \(<\)adcs3\(<\) 700 and 50 \(<\)pion\(<\) 80 (\(adcs3\) and \(pion\) are the signal height in counters sitting just before and after the cryostat)
* 26.5 \(<\)\(\eta\)(middle)\(<\) 27.5 and 9.5 \(<\)\(\varphi\)(middle)\(<\) 10.5
* \(-1<xb_{c}\)\(<\) 1.5 (\(xbc1\) is the \(x\) position in the 1st beam chamber).
* 0.25 \(<\)e_layer(PS)\(<\) 1.5 GeV

Figure 8: OF weights for the same cells as above.

Figure 10: Mean (and rms) signal value (in ADC units, pedestal subtracted) in 2 channels (HIGH gain) computed from the parabola (left) or with the OF method (right)as a function of the phase of the event.

Figure 9: Distribution of the energy computed from the central sample (upper plots) and from OF method for random events.

and plotted \(1.5*E_{PS}+E_{strips}+E_{middle}\). Figure 11 shows that the resolution goes from 616 MeV for the parabola method to 572 MeV for the OF method, i.e. a reduction of 230 MeV is achieved.

In the above method, the OF weights have been computed from 20 GeV events and used for the same events. So it can be considered as "normal" to have better results. In order to better check the method, we have applied the OF weights to data at other energies: 100 GeV (run 204617), 180 GeV (run 204243) and 300 GeV (run 205815). The raw distributions and resolutions are presented in figure 12. One can see that the OF method gives resolutions always better than the parabola method although, at these energies, the noise is less important and one does not expect to gain much by applying the optimal filtering method.

One must notice that only high gain OF coefficients have been obtained from the 20 GeV data while medium gain are needed for the higher energies. We have thus crudely used the same weights in medium and high gain. This is not completely safe since the autocorrelation matrix may have a different structure in high and medium gains or the shape may be different in the various gains due to the difference in the shapers.

## 4 Discussion

The conclusions we can draw from the previous analysis about the OF method are:

* the noise level is reduced as foreseen
* the calculation of small amplitudes is reliable while the parabola method cannot handle them
* the RAW resolution is improved with respect to the parabola method.

We now discuss various points.

Figure 11: Energy resolution at 20 GeV computed with the parabola (above)and the OF (below) methods.

Figure 12: Raw energy resolution at 100, 180 and 300 GeV computed with the parabola (left) and the OF (right) methods.

\(\bullet\)**Time modulation** Looking carefully at the 300 GeV data, we have observed a time modulation in the reconstructed energy both with the parabola and the OF methods (Fig. 13). By construction, this should not happen with the OF method. In fact, this may be due to the fact that the shapes which are used in both methods are not completely correct. This shows how important it is to have a method which determines as precisely as possible the pulse shapes. However, we remark that in LHC conditions, there will be a much smaller time jitter and the time modulation will less relevant.

Let us finally note that we have checked in the 2000 data that, if one corrects for the time modulation in the parabola method, the corresponding RAW resolutions decrease, the OF method being always best.

\(\bullet\)**Time jitter** The data we have analyzed are "asynchronous", that is to say that the signals are sampled at times generated through a 40 MHz clock, while the events arrive at random times. The OF method we have used takes into account this randomness by having 25 sets of 5 coefficients corresponding to 25 time bins of 1ns each. It however remains a \(\pm 0.5\) ns uncertainty which could be corrected for by the standard method that we now recall. If \(\tau\) is the time shift, the measured amplitudes are [1]

\[y_{i}=Eg(t_{i}+\tau)+b_{i}\simeq Eg_{i}+E\tau g_{i}^{\prime}+b_{i}\quad.\]

and the \(\chi^{2}\) minimization procedure leads to

\[\tilde{E}=a^{t}y\quad\mbox{and}\quad\tilde{E}\tau=b^{t}y\]

with

\[a=\frac{G_{2}\ B^{-1}g-G_{1}\ B^{-1}g^{\prime}}{\Delta}\quad,\quad b=\frac{G_ {0}\ B^{-1}g^{\prime}-G_{1}\ B^{-1}g}{\Delta} \tag{3}\]

and

\[G_{1}=g^{t}B^{-1}g^{\prime}\quad,\quad G_{2}=g^{t}B^{-1}g^{\prime}\quad,\quad \Delta=G_{0}G_{2}-G_{1}^{2}\quad.\]

The noise contribution is now :

\[\sigma_{E}^{2}=\frac{G_{2}}{\Delta}=\frac{1}{G_{0}-G_{1}^{2}/G_{2}}>\frac{1}{G _{0}}\quad.\]

This value is of course worse than if there were no time jitter since we determine now 2 quantities (\(E\) and \(E\tau\)) instead of 1 out of the 5 \(y_{i}\) data.

One can however wonder if it is necessary to take into account a small time jitter if the noise contibution is increased. If we use coefficient \(a\) as given by (1) instead of (3), one would have got the resolution

\[{\sigma^{\prime}}_{E}^{2}=\frac{G_{0}+E^{2}\sigma_{\tau}^{2}G_{1}^{2}}{G_{0}^ {2}}\quad,\]

where \(\sigma_{\tau}\) is the time jitter rms, which improves the contribution as long as

\[E^{2}\sigma_{\tau}^{2}<\frac{G_{0}}{\Delta}\quad.\]

A numerical estimation of this quantity should be made.

To conclude on this point, we propose to measure the energy by using expression (1) and to compute the time offset with formula (3). Any long term shift of the value of \(\tau\) will signal that the \(a_{i}\) coefficients have to be recomputed.

\(\bullet\)**Another set of coefficients** In order to further study the stability of the OF coefficients, we have used 300 GeV data to compute the signal shapes and deduce another Figure 14: Raw energy resolution at 300 GeV computed with the parabola method (left) and the OF method with coefficients determined at 300 GeV (right).

Figure 13: Time modulation of the raw total energy at 300 GeV: parabola method above and OF method below.

set of \(a_{i}\) coefficients. At that energy, only shapes in medium gain are reliable and we have used these shapes also for high gain. The resolutions obtained with this new set are however worse than those obtained in section 3 (Fig. 14). Inspection of the signal shapes have shown that the high gain shapes (obtained at 20 GeV) are significantly different from the medium gain ones (obtained at 300 GeV). We thus need high and medium shapes to determine a proper set of OF coefficients.

## References

* [1] W.E. Cleland and E.G. Stern, Nucl.Instr. and Meth. in Phys. Res. A 338 (1994) 467-497.
* [2] D. Zerwas, Minutes of the 1999 January 1 2th test beam meeting; see also EMTB manual.