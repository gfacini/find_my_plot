# Xtrt - A Program for TRT System Tests

_Juan Valls, CERN_

###### Abstract

This note describes the XTRT program, a diagnostic tool for electrical characterization of TRT electronics to be used in system tests. Both the program and the GUI have been written in C and C++ and allow to write/read TTC and ROD registers, visualize in real time threshold scans, test pulse (gain) scans, TDM delay scans, D\({}_{\rm out}\) delay scans, and B\({}_{\rm x}\) delay scans. The program also displays occupancy and hit mutiplicity distributions as online histrograms or through a straw event display.

Document v1.1, June 2001

**Outline**

1. Installation and Setup

2. Using XTRT

2.1. Main Menu

2.2. TTC Menu

2.3. RODs Menu

2.4. ROC Menu

2.5. DAQ Menu

2.5.1. Delay Scans

2.5.1.1. TDM Delay (TP Scan)

2.5.1.2. B\({}_{\rm x}\) Delay Scan

2.5.1.3. D\({}_{\rm out}\) Delay Scan

2.5.2. Test Pulse Scans

2.5.3. Threshold Scans

2.5.4. Occupancies

2.5.5. Hit Multiplicities

2.5.6. Test ROC's

2.5.7. Data Logging

2.5.8. Event Filters

3. Download

4. Troubleshooting

5. Acknowledgements

## 1) Installation and Setup

The XTRT program is entirely written in C and C++ and has been developed under a Sun Ultra 60 workstation running SunOS 5.6. The program uses a set of low level libraries developed by O. Rohne and P. Keener to communicate with a VME PCI bridge (PVIC 8025 VME Board + PVIC 7225 PCI Card from CES) as well as the TTC and ROD VME boards. The GUI has been developed with GLADE v0.5.11 (a user interface builder for GTK+ and GNOME), the GTK+ toolkit v1.2, and the GTKExtra toolkit v0.99.2.

To install the program download the latest version (see Section 3) and follow these steps:

* Unzip the tar archive with: _gunzip xrtr_vxx.tar.gz_
* Unpack the tar archive in the directory where you want the program to be installed: _tar xvf xrtr_vxx.tar_
* Edit the _Makefile_ in the src directory to fit your platform needs
* Type: _make clean_ followed by _make_

Start XTRT from the src directory and select from the _File_ menu in the menu bar the _Set Options_ menu. The _Set Options_ window shown in Figure 1 will popup:

Figure 1: Set Options menu.

Set the TTC VME board base address and the ROD VME board base addresses for the corresponding number of ROD's you are using. Set the entries for the default configuration file and output data paths you want to use everytime XTRT is launched.

The configuration file is an ASCII file with the register settings for the TTC and ROD modules. It also contains the selected number of ROC's as well as their configuration registers, test pulse registers, and threshold registers settings. The default configuration file set in the _Set Options_ menu is read everytime XTRT is launched. The first time XTRT is run a default configuration file will be created.

If at any time another configuration file is needed select _Load Configuration File_ from the _Configure_ menu in the menu bar. A new _Load Configuration File_ window will pop up, as shown in Figure 2. Load a new configuration file from the _Load Configuration File_ window. Present settings can always be saved by selecting the _Save Configuration File_ option from the _Configure_ menu.

The directory where XTRT expects the configuration files "*.trt" is set by the environmental variable XTRT_HOME, and is displayed in the first line of the _Set Options_ menu (Figure 1). If XTRT_HOME is not set, the current working directory will be used. The path to the configuration files and data directories is relative to XTRT_HOME.

Figure 2: Load Configuration File window.

## 2) Using XTRT

### 2.1) Main Menu

From the main menu panel (Figure 3) the user has access to several other menus to control the VME PVIC-PCI bridge settings (_VME PVIC Bridge_ menu), the VME registers of the TTC and ROD modules (_TTC_ and _RODs_ menus, respectively), the settings of individual or all DTMROC chips (_ROC_ menu), and different DAQ menus for different data taking options (_DAQ_ menu). On top of the main menu panel the present loaded configuration file is always shown.

From the _Configure_ menu in the menu bar one can access the _Load Configuration File_ and _Save Configuration File_ to load and/or save different configuration files, respectively.

Figure 3: Main menu panel.

### The TTC Menu

From the _TTC_ menu (Figure 4) one can write and read the TTC registers either individually (_Write_ and _Read_ buttons) or all at once (_Read All_ or _Write All_ buttons at the botton of the screen). With the _Set Defaults_ button the default settings for the selected configuration file are loaded. Remember to click on _Write All_ to write the TTC registers after setting the defaults values with _Set Defaults_.

Figure 4: TTC menu.

### The RODs Menu

From the _RODs_ menu (Figure 5) one can write and read the ROD registers for each VME ROD board selected with the ROD notebook in the _RODs_ menu panel. As an example, Figure 5 shows the settings for the selected _ROD 0_. It is possible to write or read individual registers with the _Write_ and _Read_ buttons, respectively, or write or read all registers at once with the _Write All_ and _Read All_ buttons at the bottom of the screen. With the _Set Defaults_ button the default ROD settings for the present configuration file are loaded. Remember to click on _Write All_ to write the TTC registers after setting the defaults values with _Set Defaults_.

Individual ROD group settings are set, for each ROD, in the ROD group notebook at the bottom of the screen.

Figure 5: RODs menu.

### The ROC Menu

The _ROC_ menu (Figure 6) allows the user to change the settings for every DTMROC in the system. The total number of DTMROC's present is set through the _Set Number of ROC's_ entry at the top of the menu. The available parameters subject to change for each DTMROC are the following:

* Configuration Register:
* T/M: test mode bit
* T/ADJ: time adjustment mode bit
* SENDID: Send-ID bit
* F/R: full/reduced readout bit
* Test and Mask Registers:
* Test pattern (144 bits, test input of the pipeline)
* Mask pattern (144 bits, mask of the pipeline)
* Threshold Registers:
* High0 and High1 thresholds (8 bits, 0-255 DAC's)
* Low0 and Low1 thresholds (8 bits, 0-255 DAC's)
* Test Pulse register:
* Odd enable bit
* Odd pulse amplitude (6 bits, 0-63 DACs)
* Even enable bit
* Even pulse amplitude (6 bits, 0-64 DACs)
* Test Pulse Delay:
* 5 bits, 0-31 steps of 1.56 ns

From the _ROC_ menu one must also set the TTC group (each TTC has 18 group lines, with values between 0-17) as well as the DTMROC address (6 bits, with values between 0-63) for each DTMROC in the system. Also needed, for each DTMROC in the system, is the ROD board number (up to 3 ROD boards at the moment, with values between 0-2), the ROD group number (each ROD has 8 groups, with values with between 0-7) and the DTMROC address within the ROD group (with values between 1-12).

The user can set the above parameters for the present selected DTMROC by clicking on the _Set_ button at the bottom of the screen. The settings for the present selected DTMROC can be applied to all DTMROC's in the system by clicking on the _Set All ROCs_ button (note that this option _will not_ overwrite the TTC group, DTMROC address, ROD board, ROD group and DTMROC address within the selected ROD group). The _Set Defaults (All ROCs)_ button sets the defaults for each DTMROC according to the loaded

[MISSING_PAGE_FAIL:8]

### 2.5) The DAQ Menu

From the _D4Q_ menu one has access to the following different submenus: _Delay Scans_, _Test Pulse Scans_, _Threshold Scans_, _Occupancies_, _Hit Multiplicities_, and _Test ROC's_.

#### 2.5.1) Delay Scans

The _Delay Scans_ menu is subdivided into three different notebook submenus: the _TDM Delay (TP Scan)_ menu, the _B\({}_{x}\) Delay Scan_ menu, and the _D\({}_{out}\) Delay Scan_ menu. They are all used to find suitable timings for the TTC B\({}_{\rm x}\), D\({}_{\rm out}\), and TDM delays.

#### 2.5.1.1) TDM Delay (TP Scan)

With a _TDM Delay_ scan one can adjust the timing between the pipeline depth and the L1A trigger appearing at the TTC front panel connector. The _TDM Delay (TP Scan)_ is used in XTRT to find the timing for injected test pulse operation, either with internal calibration test pulses or external pulses.

Figure 7 shows a typical TDM delay scan with internal calibration test pulses. The plot area shows the channel occupancy as a function of the TDM delay (8 bits, steps of 0-255 clock cycles, 25 ns each). Occupancies are defined in Section 2.5.3. The user selects the start and end of the scan in clock cycle units, the number of steps (also in clock cycle units) and the number of events per scan point. Events are generated through test pulse (TP) triggers. When running the system with internal test pulses (as shown in Figure 7), the parameters of the injected test pulse are given by the test pulse configuration register, the test pulse delay register and the threshold registers for each DTMROC in the system. These registers are written at the beginning of the scan according to the _ROC_ menu settings (see Section 2.4). Figure 8 shows an example of a TDM delay scan when running the system with external injected pulses...

The _Select Threshold Calculation_ menu allows to select different hit definitions when calculating the occupancies (see Section 2.5.3). This hit definition should be selected before the scan starts and should not be changed during the run.

The DTMROC's can be addressed individually by selecting the DTMROC address entry in the _ROC_ menu (see Section 2.4) or collectively for all DTMROC's by checking the _Broadcast Address All ROC's_ entry in the _Threshold Scan_ menu.

The user can select the ROD number and ROD group to monitor with the _ROD Nb_ and _ROD Gr_ buttons at the bottom of the screen. With the \(\rightarrow\) and \(\leftarrow\) buttons one can visualize the results of the scan per channel for each DTMROC in the system. The axis ranges can be changed at any time during the scan with the _Redefine Axis Scales_ button.

The _Print_ button sends a hardcopy of the plot area to the selected printer in the _Set Options_ window (see Section 1). The _Hardcopy_ button creates a postscript file of the plot area in the _Output Data Path_ directory selected in the _Set Options_ window (Section 1).

Figure 7: TDM Delay (TP Scan) menu (internal test pulse).

Figure 8: TDM Delay (TP Scan) menu (external test pulse).

#### 2.5.1.2 \(B_{x}\) Delay Scan

The _Bx Delay Scan_ is used to tune the beam cross fine delay clock (Bx) for those TTC lines selected in the _TTC_ menu (Section 2.2). Figure 9 shows an example of a Bx scan. The plot area shows the number of readout errors (in percentage, normalized to the total number of events selected per scan) for each DTMROC in the system as a function of the Bx clock delay value (between 0-24 steps, \(\sim\)1 ns each). The number of errors is shown for each DTMROC in a ROD group. A readout error is defined whenever at least one of the following conditions is satisfied:

* At least one DTMROC chip in a ROD group is not transmitting data
* The last word in a ROD group has not the bit 30 set
* At least one DTMROC chip in a ROD group has not the DLL bit set

The user can select the ROD number and ROD group to monitor with the _ROD Nb_ and _ROD Gr_ buttons at the bottom of the screen. The axis ranges can be changed at any time during the scan with the _Redefine Axis Scales_ button.

Figure 9: Bx Delay Scan menu.

#### 2.5.1.3) \(D_{\rm out}\) Delay Scan

A D\({}_{\rm out}\) delay scan is used to tune the fine delay of the _data in_ relative to the clock. With a \(D_{\rm out}\)_Delay Scan_ the program writes and reads back, for each individual DTMROC, a set of threshold values to the DTMROC threshold registers. If the values sent are different from the values read back an error is generated for that particular DTMROC. The scan is performed by varying the D\({}_{\rm out}\) fine delay settings of those TTC lines selected in the _TTC_ menu (Section 2.2).

An example of a D\({}_{\rm out}\) scan is shown in Figure 10. The plot shows the number of errors (in percentage, normalized to the total events selected per scan) for each DTMROC in a ROD group (13 DTMROC's) as a function of the D\({}_{\rm out}\) value (between 0-24 steps, \(\sim\)1 ns each).

The user can select the ROD number and ROD group to monitor with the _ROD Nb_ and _ROD Gr_ buttons at the bottom of the screen. The axis ranges can be changed at any time during the scan with the _Redefine Axis Scales_ button.

Figure 10: D\({}_{\rm out}\) Delay Scan menu.

#### 2.5.2) Test Pulse Scans

The _Test Pulse Scans_ menu allows to operate the system with internal test pulse trigger scans (gain scans). Figure 11 shows the result of a typical test pulse scan. The plot area shows the output DTMROC test pulse response (16 channels) as a function of the injected test pulse amplitude. The injected test pulse amplitude is given in DAC counts by writing the DTMROC test pulse configuration register (6 bits, 0-63 DAC steps). The output DTMROC test pulse response is calculated, for each scan point, by performing a threshold scan and calculating the 50% S point of the threshold curve.

The _Show S Curves_ button at the bottom of the screen shows the result of the threshold scan updated for each threshold scan point. The _Show TP Scan_ button shows the result of the test pulse scan, updated at the end of the threshold scan for each test pulse point.

The _Select Threshold Calculation_ menu allows to select different hit definitions when calculating the occupancies during the threshold scans (see Section 2.5.3). This hit definition should be selected before the scan starts and should not be changed during the scan.

The DTMROC's can be addressed individually by using the DTMROC address entry in the _ROC_ menu (see Section 2.4) or collectively for all DTMROC's by checking the _Broadcast Address All ROC's_ entry in the _Threshold Scan_ menu.

The user can select the ROD number and ROD group to monitor at any time during the scan with the _ROD Nb_ and _ROD Gr_ buttons at the bottom of the screen. With the \(ROC\to\) and \(\gets ROC\) buttons one can visualize the results of the scan per channel for each DTMROC in the system. The _Show ASDBLR1_ and _Show ASDBLR2_ check buttons show, respectively, the 8 channels for ASDBLR1 and ASDBLR2. The axis ranges can be changed at any time during the scan with the _Redefine Axis Scales_ button.

The _Print_ button sends a hardcopy of the plot area to the selected printer in the _Set Options_ window (see Section 1). The _Hardcopy_ button creates a postscript file of the plot area in the _Output Data Path_ directory selected in the _Set Options_ window (Section 1).

**Figure 11: Test Pulse Scans menu.**

#### 2.5.3 Threshold Scans

The _Threshold Scan_ menu (Figure 12) is used to start threshold (noise) scans. The example shown in Figure 12 shows a typical threshold scan, defined as an occupancy per event plot as a function of threshold DAC. The user selects the start and end of the scan in threshold DAC units (from 0 to 255 DACs), the number of steps (also in DACs) and the number of events per scan. Data can be taken either with internal triggers or with test pulse triggers.

Occupancies per channel are defined as the ratio between the number of events with at least one hit over the total number of events. The _Select Threshold Calculation_ menu allows to select different hit definitions when calculating the occupancies according to the following options:

* _Low Threshold Leading Edge All BC's_ At least one leading edge (transition from low to high) in all three beam crosses.
* _Low Threshold Leading Edge Earliest BC_ At least one leading edge in the earliest (in time) beam cross (BC).
* _Low Threshold Leading Edge Middle BC_ At least one leading edge in the middle beam cross.
* _Low Threshold Leading Edge Latest BC_ At least one leading edge in the latest (in time) beam cross.
* _Low Threshold All BC's_ At least one bit set out of the 24 low threshold time bits for the three beam crosses.
* _Low Threshold Earlier BC_ At least one bit set out of the 8 low threshold time bits for the earliest (in time) BC.
* _Low Threshold Middle BC_ At least one bit set out of the 8 low threshold time bits for the middle BC.
* _Low Threshold Latest BC_ At least one bit set out of the 8 low threshold time bits for the latest (in time) BC.
* _High Threshold All BC's_ At least one bit set out of the 3 high threshold time bits for all the beam crosses.
* _High Threshold Earliest BC_ The high threshold time bit set for the earliest (in time) beam cross.
* _High Threshold Middle BC_ The high threshold time bit set for the middle beam cross.
* _High Threshold Latest BC_ The high threshold time bit set for the latest (in time) beam cross.

This hit definition should be selected before the threshold scan starts and should not be changed during the scan.

The ROC's can be addressed individually by selecting the ROC address entry in the _ROC_ menu (see Section 2.4) or collectively for all DTMROC's by checking the _Broadcast Address All ROC's_ entry in the _Threshold Scan_ menu.

At the bottom of the _Threshold Scans_ menu one can select individual DTMROC's scans to view by choosing ROD number (_ROB Nb_ buttons), ROD group within each ROD (_ROD Gr_ buttons), and ROC number within each ROD group (_ROC_\(\rightarrow\) and _ROC_ buttons). The _Show S Curves_ button shows the S curves for the 16 channels associated to a DTMROC. The _Show ASDBLR1_ and _Show ASDBLR2_ check buttons show, respectively, the 8 channels for ASDBLR1 and ASDBLR2. The _Show 50% S Curves_ button shows the threshold offsets and RMS noise distributions as a function of channel number for the 16 channels of the selected DTMROC.

The axis ranges can be changed at any time during the scan with the _Redefine Axis Scales_ button. The _Print_ button sends a hardcopy of the plot area to the selected printer in the _Set Options_ window (see Section 1). The _Hardcopy_ button creates a postscript file of the plot area in the _Output Data Path_ directory selected in the _Set Options_ window (Section 1).

Figure 12: Threshold Scan menu.

#### 2.5.4) Occupancies

The _Occupancies_ menu (Figure 13) can be used to start occupancy scans with predefined thresholds per DTMROC according to the _ROC_ menu settings (Section 2.4). Data can be taken either with internal triggers or with test pulse triggers. The user can also use to run on a continuous basis or for a selected number of events. To change the data running conditions go to the _Data Logging_ menu in the menu bar and select _Set Logging Options_. A window like the one shown in Figure 14 will pop-up (_Set Logging Options_ window). Check the corresponding radio button in the _Set Logging Options_ window to run on a continuous basis (until the run is stopped) or just for a fixed number of events.

Different distributions might be selected at any time to display the results: cumulative average occupancies along the run as a function of channel number for individual DTMROC's (_ROC by ROC_ button, Figure 13) or for entire ROD groups (_Group by Group_ button, Figure 15). A ROD group is defined to have 13 DTMROC's (or 208 channels). The user can select the ROD number and ROD group to monitor at any time during the scan with the _ROD Nb_ and _ROD Gr_ buttons at the bottom of the screen. With the _ROC_ and _ROC_ buttons one can visualize the results of the scan per channel for each DTMROC in the system. The vertical occupancy axis ranges can be changed at any time during the scan with the _Redefine Axis Scales_ button.

The _Select Threshold Calculation_ menu allows to select different hit definitions when calculating the occupancies according to the options shown in Section 2.5.3. In addition to the hit definitions shown in Section 2.5.3, there are now three new definitions:

* _Time Occupancies_ The occupancy here is defined as the cumulative average ratio between the number of time bits set in an event over the total number of time bits for the three beam crosses (24 bits, 75 ns).
* _Low Threshold 12.5 ns Leading Edge Window_ The occupancy here is defined as the ratio between the number of events with at least one bit set in a 12.5 ns time window over the total number of events.
* _Low Threshold Leading Edge 12.5 ns Window_ The occupancy here is defined as the ratio between the number of events with at least one leading edge (transition from low to high) in a 12.5 ns time window over the total number of events.

The 12.5 ns time window is defined by the user by selecting from the _Configure_ menu in the menu bar the _Set 12.5 ns Time Window_ option. A window like the one shown in Figure 16 will pop-up. The 12.5 ns time range can be set in any place along the total 75 ns window for the three beam crosses.

The hit definitions defined above can be changed at any time during the run.

The DTMROC's can be addressed individually by selecting the DTMROC address entry in the _ROC_ menu (see Section 2.4) or collectively for all DTMROC's by checking the _Broadcast Address All ROC's_ entry in the _Occupancies_ menu.

By clicking on the _Display Group Straws_ button an event display window will pop-up as shown in Figure 17-(a) and 17-(b). The event display shows cumulative average occupancies (in percentage) for 192 channels out of the 208 of a ROD group, corresponding to an endcap flex board (12 DTMROC's x 16 = 192 channels). The geometry is the same as for an endcap sector prototype, arranged as 8 planes of 24 straw channels each. By left mouse clicking on a particular straw, a new window showing the low level hits in time for that particular straw will pop-up (see Figure 17-(a)). This display is updated on an event by event basis. Correlations in low level threshold time hits between two channels can also be shown. First, select one channel with the middle mouse button. Then select the second channel with the right mouse button. A distribution with the time difference (in ns) between the hits for those two channels will be shown (see Figure 17-(b)).

By clicking on the _Global Occupancy_ buttons (_per Group_ or _per ROC_) a distribution with the global occupancies will be shown as shown in Figure 18. These are defined as the ratio between the number of channels hit over the total number of channels, averaged over events.

The _Print_ button sends a hardcopy of the plot area to the selected printer in the _Set Options_ window (see Section 1). The _Hardcopy_ button creates a postscript file of the plot area in the _Output Data Path_ directory selected in the _Set Options_ window (Section 1).

The rate at which the online distributions are updated can be changed at any time with the horizontal scroll bar _Update Rate_ in the _Occupancies_ main panel (in units of number of events). It is strongly recommended not to set this value below 100 events.

Figure 14: Set Logging Options menu.

Figure 13: Occupancies menu with average occupancies as a function of channel number per DTMROC.

Figure 16: Select Time Range window.

Figure 15: Occupancies menu with average occupancies as a function of channel number per ROD group.

**Figure 17-(a): Occupancies event display with Time Evolution of Straw window.**Figure 18: Global occupancies per ROD group.

#### 2.5.5) Hit Multiplicities

With the _Hit Multiplicities_ menu different distributions can be selected at any time:

1. **Mean Number of Hits** Shows average mean hit multiplicities as a function of channel number for individual DTMROC's (_ROC by ROC_ button) or for entire ROD groups (_Group by Group_ button, Figure 19). A ROD group is defined to have 13 DTMROC's (or 208 channels).
2. **Hit Time Distribution** Shows average mean hit multiplicities as a function of time (hit time evolution) for three beam crossings (3x25 = 75 ns). These distributions show hit correlations with clock and are calculated by averaging over channels for individual DTMROC's (_ROC by ROC_ button, Figure 20), for individual ASDBLR chips (_ASDBLR1_ and _ASDBLR2_ check buttons), or for entire ROD groups (_Group by Group_ button).

The user can select the ROD number and ROD group to monitor at any time during the scan with the _ROD Nb_ and _ROD Gr_ buttons at the bottom of the screen. With the \(ROC\to\) and \(\gets ROC\) buttons one can visualize the results of the scan per channel for each DTMROC in the system. The vertical occupancy axis ranges can be changed at any time during the scan with the _Redefine Axis Scales_ button.

The hit definition is defined, in all cases, by the _Select Threshold Calculation_ menu (Section 2.5.3), and can be changed at any time during the run.

Data can be taken either with internal triggers or with test pulse triggers. The user can also select to run on a continuous basis or for a selected number of events (see Section 2.5.4, Figure 14).

The DTMROC's can be addressed individually by selecting the DTMROC address entry in the _ROC_ menu (see Section 2.4) or collectively for all DTMROC's by checking the _Broadcast Address All ROC's_ entry in the _Hit Multiplicities_ menu.

By clicking on the _Display Group Straws_ button an event display window will pop-up. The event display shows mean hit multiplicities (in percentage) for 192 channels out of the 208 of a ROD group, corresponding to an endcap flex board (12 DTMROC's x 16 = 192 channels). The geometry is the same as for an endcap sector prototype, arranged as 8 planes of 24 straw channels each. By clicking on a particular straw, a new window showing the low level hit time evolution for that particular straw will pop-up. This display is updated on an event by event basis.

The _Print_ button sends a hardcopy of the plot area to the selected printer in the _Set Options_ window (see Section 1). The _Hardcopy_ button creates a postscript file of the plot area in the _Output Data Path_ directory selected in the _Set Options_ window (Section 1).

The rate at which the online distributions are updated can be changed at any time with the horizontal scroll bar _Update Rate_ in the _Hit Multiplicities_ main panel (in units of number of events). It is strongly recommended not to set this value below 100 events.

Figure 19: Mean hit multiplicities as a function of channel number for a ROD group.

**Figure 20: Hit time distribution per DTMROC.**

#### 2.5.6) Test ROC's

From the _Test ROC's_ menu (Figure 21) the user can quickly diagnose the electronics by issuing individual or groups of L1A triggers (_Send L1A Trigger_ buttom) or test pulse triggers (_Send TP Trigger_ button). The columns next to these buttons show the number of triggers sent (as readout from the ROD L1A and Event counters) and the number of readout errors. A readout error is defined whenever at least one of the following conditions is satisfied:

* At least one DTMROC chip in a ROD group is not transmitting data
* The last word in a ROD group has not the bit 30 set
* At least one DTMROC chip in a ROD group has not the DLL bit set

By checking the appropiate radio button a data output dump of the event can be sent to the screen or to an output file (written in the _Output Data Path_ directory selected in the _Set Options_ window, Section 1).

The DTMROC's can be addressed individually by selecting the DTMROC address entry in the _ROC_ menu (see Section 2.4) or collectively for all DTMROC's by checking the _Broadcast Address All ROC's_ entry in the _Test ROC's_ menu.

The user can also send a hard, soft and beam cross reset by clicking on the _Generate Hard Reset_, _Generate Soft Reset_, and _Generate BC Reset_ buttons, respectively.

**Figure 21: Test ROC's menu.**

#### 2.5.7 Data Logging

Data can be logged for the _Threshold Scan_, _Test Pulse Scan_, _Occupancies_, and _Hit Multiplicity_ scan menus. Select from the menu bar the _Set Logging Options_ menu and check whether to log data or not, as well as the output data format. At present, only ASCII output data files are implemented.

Following is a brief description of the data format for the different type of scans. All words (shown below between brackets) are 4 byte data words.

1. Occupancy and Hit Multiplicity scans HEADER
2. Occupancy Scan Date: (date + time) RODS: (Nb_of_RODs) (Nb_of_Groups_ROD1) (Nb_of_Groups_ROD2).... TH_Values_Low1: (Nb_of_ROCs) (Low1TH_ROC1) (Low1TH_ROC2).... TH_Values_High1: (Nb_of_ROCs) (High1TH_ROC1) (High1TH_ROC2).... TH_Values_Low2: (Nb_of_ROCs) (Low1TH_ROC2) (Low2TH_ROC2).... TH_Values_High2: (Nb_of_ROCs) (High1TH_ROC2) (High2TH_ROC2).... DATA (for every event) Start-Event: (Event_Nb)

[ ( Status) (LastWord) ]ij(i = 0...Nb_of_RODs) (j = 0...Nb_of_Groups)

[ (L1ID) (SendID) (DLL) (BCID ) ]jjk(i = 0...Nb_of_RODs) (j = 0...Nb_of_Groups) (k = 0...12 ROC's)

[ (High0) (High1) (High2) (Low0) (Low1) (Low2) ]jikl(i = 0...Nb_of_RODs) (j = 0...Nb_of_Groups) (k = 0...12 ROC's)

Notes:

1. Word (L1ID) is a decimal encoded 3 bit word.
2. Words (SendID) and (DLL) are set to 0 or 1.
3. Word (BCID) is a decimal encoded 4 bit word.
4. Words (High0), (High1), and (High2) are set to 0 or 1. They correspond, respectively, to the earliest, middle, and latest beam crosses.
5. Words (Low0), (Low1), and (Low2) are decimal encoded 8 bit words. They correspond, respectively, to the earliest, middle, and latest beam crosses.

**2) Threshold scans**HEADER

**TOTAL SCANS:** (Nb_of_Threshold_Scans)

**Number of Events per Scan:** (Nb_of_Events_per_Scan)

**RODS:** (Nb_of_RODs) (Nb_of_Groups_ROD1) (Nb_of_Groups_ROD2)....

DATA (for every scan point)

**TH-SCAN:** (Threshold_Scan_Point) (Threshold_Scan_Value)

(Occupancies_LE)ijkl

(i = 0...Nb_of_RODs)

(j = 0...Nb_of_Groups)

(k = 0...12 ROC's)

(l = 0...16 channels)

#### 2.5.8) Event Filters

An event filter for the _Occupancies_ and _Hit Multiplicities_ scans can be applied by selecting the _Set Event Filter_ from the _Data Logging_ menu in the menu bar. A window like the one shown in Figure x will pop-up. The user can set an event filter by selecting either one or both of the following conditions:

1. **Low level threshold filter** Only those events with with either a single channel or all channels with a number of low threshold hits above a defined value are processed and shown in the event display. A low level hit is defined by the user according to the following options: * Number of leading edges in all beam crosses * Number of leading edges in the earliest beam cross * Number of leading edges in the middle beam cross * Number of leading edges in the latest beam cross * Number of bits set in all beam crosses * Number of bits set in the earliest beam cross * Number of bits set in the middle beam cross * Number of bits set in the latest beam cross
2. **High level threshold filter** Only those events with at least a high threshold hit in either a single channel or all channels are processed and shown in the event display.

Event filters are available only for the _Occupancy_ and _Hit Multiplicity_ scan menus.

The user can mask out any malfunctioning channel used to calculate the filter conditions from the _Set Mask Channels_ panel in the _Set_ window (shown in Figure x).

## 3) Download

Last version of the XTRT program as well as related libraries can always be found to download at the following URL address: _[http://cern.ch/valls/xtrt.htm_](http://cern.ch/valls/xtrt.htm_).

## 4) Troubleshooting

### 5) Acknowledgements

The author thanks Ole Rohne and Peter Lichard for lots of help in developing the program.