# ATLAS NOTE

ATL-INDET-PUB-2014-006

**ATLAS Pixel IBL: Steve Quality Assurance**

The ATLAS Collaboration

###### Abstract

For Run 2 of the LHC a fourth, innermost Pixel Detector layer on a smaller radius beam pipe has been installed in the ATLAS Detector to add redundancy against radiation damage of the current Pixel Detector and to ensure a high quality tracking and \(b\)-tagging performance of the Inner Detector over the coming years until the High Luminosity Upgrade. State of the art components have been produced and assembled onto support structures known as staves over the last two years. In total, 20 staves have been built and qualified in a designated Quality Assurance setup at CERN of which 14 have been integrated onto the beam pipe. Results from the testing are presented.

(c) Copyright 2014 CERN for the benefit of the ATLAS Collaboration.

Reproduction of this article or parts of it is allowed as specified in the CC-BY-3.0 license.

Introduction

During the Phase 0 upgrade of the ATLAS Detector [1] an additional layer of the Pixel Detector [2], the Insertable B-Layer (IBL) [3], is being installed. The IBL is composed of 14 carbon fibre staves with integrated titanium pipes for CO\({}_{2}\) cooling. Each stave hosts 32 FE-I4B chips [4], adding more than 12M read out channels in total. Two different sensor types are chosen [5]: a planar design based on the current ATLAS Pixel sensor and 3D sensor designs which find their first application in high energy physics experiments. After full assembly and transportation to CERN the staves undergo Quality Assurance (QA) testing which will be described in this document. After an introduction to the setup and the testing procedure, results and peculiarities found will be discussed.

The QA procedure covers important measurements to qualify a stave for integration around the beam pipe. This includes cold operation to simulate run time conditions as well as various calibration and data taking modes. The outcome of the stave QA procedure is used as a basis to select staves for integration and it provides a deeper understanding of the assembled detector.

In total, 20 staves have been produced as IBL candidates, for which the 14 highest ranked staves are to be installed in the IBL. It should be noted that two of the 20 staves, henceforth referred to as staves 07 and 08, were damaged by exposure to condensation. All causes leading to this incident have been fixed before operations continued. As a result, only 18 production staves were considered for integration onto the IBL and included in the results section of this paper. Results from staves 07 and 08 are added in an Appendix for completeness.

Upon further inspection, mild signs of corrosion were found on nine of ten staves built up to the point of the aforementioned incident. Some of these staves had not gone through the QA process yet. Further possible causes for corrosion have been found in the steps proceeding the stave QA and several precautions have been taken to avoid it. In the pit, the detector will be continuosly flushed by Nitrogen and humidity will be controlled by several sensors; furthermore a protection alarm system to avoid condensation will be put in place. All staves affected by corrosion have been reworked at the CERN Department Silicon Facility (DSF). The reworked staves were monitored closely over several months and no new signs of corrosion were observed. The QA results presented in this note are from reworked staves and staves built after the incident.

## 2 Modules and staves

As an extension to the existing ATLAS Pixel detector, the IBL is also a silicon-based detector. Two different types of silicon sensors are used for the IBL: an improved version of the planar pixel sensors used in the current Pixel detector and a new 3D sensor technology. The IBL is built using a hybrid technology where the chip is bump bonded to the sensor for readout, which was also used for the Pixel detector modules. The fully assembled IBL modules are glued onto a bare stave, which is a carbon fibre support structure that also provides cooling for the electronics.

### Readout chip

The IBL readout chip, the **FE-I4B1**, is a successor of the FE-I3 used in the Pixel Detector. The FE-I4B chip is produced in a 130 nm CMOS process and it is bump bonded to the sensor in a flip-chip process. One chip comprises \(26880\)\(50\times 150\mu\)m\({}^{2}\) small pixels, organized in an array of 80 columns by 336 rows. Each pixel on the sensor is connected to a pixel cell with an amplifier and discriminator which measures the collected charge in terms of Time over Threshold (ToT). This time is measured with a 40 MHz reference clock, which is synchronized to the LHC clock. The parameters of the amplifier and discriminator of each pixel are adjustable, allowing for a pixel by pixel threshold and ToT calibration. The buffering of pixel hits on the FE-I3 chip is grouped per column pair in the chip periphery, whereas the buffering happens in a 2\(\times\)2 pixel region for the FE-I4B chip inside the active pixel matrix. This is an advantage as it enables the FE-I4B chip to work at much higher hit rates than the FE-I3 chip, which is important for the IBL as it is located much closer to the interaction point.

### Sensor technologies

The main improvements of the IBL **planar sensor** over the previous sensor include smaller pixels, slim edges of 200 \(\mu\)m and a thinner sensor of only 200 \(\mu\)m. The IBL planar sensor measures 18.8\(\times\)41.3 mm\({}^{2}\) and has 2\(\times\)26880 pixelated n\({}^{+}\) implants in an n-bulk. Throughout the sensor, the size of the pixels can vary between three different categories. Normal pixels measure 50\(\times\)250 \(\mu\)m\({}^{2}\), whereas there are four columns of long pixels, the two outermost columns and the two inter-chip columns, measuring 50\(\times\)450 \(\mu\)m\({}^{2}\) and 50\(\times\)500 \(\mu\)m\({}^{2}\), respectively. The outermost, long pixels and the realisation of the slim edge design are shown in Figure 1. The planar sensors are manufactured at CiS2.

Footnote 2: CiS Forschungsinstitut f√ºr Mikrosensorik und Photovoltaik GmbH, Konrad-Zuse-Strasse 14, 99099 Erfurt, Germany, [http://www.cismst.org](http://www.cismst.org).

The **3D sensor** technology has pillars of n\({}^{+}\) and p\({}^{+}\) material etched into the p-bulk for all 26880 pixels. Therefore the drift of the electron-hole pairs in a 3D sensor is horizontal between the pillars, while in a planar sensor electron-hole pairs drift vertical between the top and bottom. For the IBL, this means that the drift distance is decreased and considerably less than the sensor thickness. This leads to a lower depletion voltage than for planar sensors and makes the technology more resilient to radiation-induced damage. All pixels on the 3D sensors are 250\(\times\)50 \(\mu\)m\({}^{2}\). The 3D sensors measure 18.8\(\times\)20.7 mm\({}^{2}\), have slim edges of 225 \(\mu\)m width and are thinned down to 230 \(\mu\)m thickness. These sensors are produced by two different manufacturers, FBK3 and CNM4, with slightly different characteristics as shown in Figure 2.

Footnote 3: Fondazione Bruno Kessler (FBK), Via Sommarive 18, 38123 Povo di Trento, Italy, [http://www.fbk.eu](http://www.fbk.eu).

Footnote 4: Centro Nacional de Microelectronica (CNM-IMB-CSIC), Campus Universidad Autonoma de Barcelona, 08193 Bellaterra (Barcelona), Spain, [http://www.imbcnm.csic.es](http://www.imbcnm.csic.es).

### Layout of staves

Once the sensors have been bump bonded to the readout chip, a flexible Printed Circuit Board (PCB) is glued on top of the sensor and wirebonds are added to connect the readout chip to the PCB. These modules are extensively tested at their respective production sites, guaranteeing the functionality and quality of the single modules. The fully assembled modules are loaded onto a bare stave and connected to another flexible PCB that is glued to the bare stave to allow for connection to services. A fully loaded stave is conventionally divided into A-side and C-side. A schematic of the layout is shown in Figure 3.

Figure 1: Edge region of an IBL planar sensor showing the normal and long pixels [5]. The guard rings on the other side of the sensor are overlaid for illustration.

Each side is composed of six planar pixel sensors, each of which is connected to two FE-I4B chips, and four 3D sensors on the extremities, each of which is connected to one FE-I4B chip. This gives a total of 16 FE-I4B chips per side. Groups of four FE-I4B chips are powered in parallel and as such represent one powering group for the Detector Control System.

## 3 Setup

In the stave QA test stand, which is located in the SR1 clean room at CERN, IBL staves are connected to the necessary services and readout components to mimic real operation as closely as possible. The setup has the capability to operate two staves concurrently. An overview of the whole setup is shown in Figure 4.

The staves are installed in a box to control the environment. The Detector Control System (DCS) and Data Acquisition (DAQ) components are connected to an End-Of-Stave (EOS) PCB, which is connected

Figure 3: Schematic of the module layout, mapping and powering modularity. The different module groups are numbered as A/CX-Y according to whether they are on the A-side or C-side, X runs from 1 to 8 in increasing order towards the stave extremities and Y is equal to 1 or 2 alternating for each front end and starting from 1 for the two most central chips. NTC indicates negative temperature coefficient thermistors that allow to measure the temperature of each module group.

Figure 2: Crosssection of a 3D pixel sensors manufactured by (a) FBK and (b) CNM [5].

to the stave in this specific setup to allow testing but it is not meant for the final detector. Most of the DCS components are slightly modified Pixel detector DCS hardware, which are located in a rack area close to the clean room setup. The DAQ components are part of a new readout system developed by SLAC based on the Reconfigurable Cluster Elements (RCE) architecture.

### Environmental box

The environmental box is a 2\(\times\)1\(\times\)1 m\({}^{3}\) large box made of aluminum profiles and sheets that are coated on the inside with insulating foam. A linear motor is installed inside the box to allow for radioactive sources to be moved over the staves. Pictures of the inside and the outside of the box are shown in Figure 5, where two fully connected staves can also be seen.

The doors in the back and front of the box can be closed tightly and the box is flushed with dry air to control the humidity in the box volume. The humidity on the inside of the box can thus be kept below 3% relative humidity for an environmental temperature of 20\({}^{\circ}\)C, which corresponds to a dew point of -26\({}^{\circ}\)C. This is the minimal measurable value of the humidity sensors used to control the dew point. As an additional safe-guard, the staves are kept inside a smaller volume which is flushed with nitrogen. The dry air and nitrogen flows are measured by flow meters attached to the outside of the box.

The TRACI (Transportable Refrigeration Apparatus for CO\({}_{2}\) Investigation) cooling plant uses CO\({}_{2}\) as a main refrigerant, which will also be used for the final IBL cooling system. The two staves are connected

Figure 4: Schematic of the Stave QA test stand, showing the environmental box and its connections to the DCS and DAQ, which are described in sections 3.2 and 3.3, respectively.

in parallel to the TRACI. The CO\({}_{2}\) that circulates in the cooling loop is condensed and sub-cooled in a heat exchanger, which is itself cooled by an external cold source. The total cooling power of the TRACI is 100 W, with each IBL Stave dissipating around 30 W during normal operation. The temperature of the staves when connected to the QA setup can be varied from \(25^{\circ}\)C down to \(-25^{\circ}\)C. The absolute minimum of \(-40^{\circ}\)C is not reached due to non negligible cooling power loss in the supply lines to the staves and the minimum dew point of \(-26^{\circ}\)C. To prevent water condensation during low temperature operation, the TRACI is equipped with an interlock system that prevents the operation of the cooling plant if any of the door latches of the environmental box are open or if the dew point inside the box is too high.

### Detector control system

The DCS [6] is responsible for the powering and the safety of the IBL modules. The system consists of four main hardware components:

* The **ISEG5** modules are capable of supplying high bias voltages (HV) up to 1000 V for planar and 500 V for 3D sensors. The ISEGs also provide monitoring of the HV and leakage currents of the IBL modules as well as hardware interlock functions for over-voltage and over-current protection to ensure safety of the modules. Footnote 5: iseg Spezialelektronik GmbH, Bautzner Landstrasse 23, 01454 Radeberg / OT, Rossendorf, Germany, [http://www.iseg-hv.com](http://www.iseg-hv.com).
* The **Wiener6** power supply (PS) is the low voltage (LV) supply unit for the detector modules. Similar to the ISEG units, the Wiener has a hardware interlock for over-voltage and over-current. Footnote 6: Worldwide-Industrial Electronics-Nuclear Electronics-Resources W-IE-NE-R, Plein & Baus GmbH, Mllersbaum 20, 51399 Burscheid Germany, [http://www.wiener-d.com/](http://www.wiener-d.com/).
* The **PP2 regulator station** is supplied by the Wiener PS and is located near the detector to finely regulate the voltage supplied to the detector and compensate for possible voltage drops due to cable resistances.
* The **Interlock Matrix Crate** (IMC) [7] holds components to monitor the temperature of the modules and the dew point in the environmental box, to generate hardware interlock signals from temperatures and dew point, and to deliver the interlock signals to the ISEGs and the Wiener when necessary to power-down the modules.

Figure 5: Stave QA test stand pictures showing the (a) outside and (b) inside of the environmental box.

* The **DCS computer** is connected to all components and provides user control over HV and LV, and over all monitoring of voltages, currents, temperatures of the modules and the dew point in the QA box.

The DCS software is based on PVSS and provides a graphical user interface for all control and monitoring capabilities. In addition to the hardware level protections, software limits for voltages, currents, temperatures and dew point are implemented in the system.

### Data acquisition

A high speed, parallel, and modular system based on Advanced Telecommunications Computing Architecture (ATCA) technology is used for data acquisition in the stave QA test stand. The system comprises four main hardware components:

* The **ATCA crate** holds and powers the boards and contains a high-speed back-plane for communication between boards. The Reconfigurable Cluster Element (RCE) and Cluster Interconnect Module (CIM) boards sit inside the ATCA crate.
* The **RCE** is the primary computational element responsible for sending and receiving data from the FE-I4B's, and can hold and run software for driving the calibration, data-taking, and data processing. Each RCE contains a Power-PC System-on-chip running the RTEMS (Open-Source Real-Time kernel) operating system. A single RCE board contains two RCEs. The RCE board communicates with the HSIO via optical connection using the PGP protocol at 3.125 Gb/s. The RCE board is connected to an external PC via the CIM.
* The **CIM** board is connected to an external computer via ethernet and is a 96 channel 10 Gb/s ethernet switch for routing the signals to and from the outside world to the appropriate RCE.
* The **High-Speed Input-Output** (HSIO) board acts as the intermediary between the optical signals sent-out and received-by the RCE and the electrical signals sent-out and received-by the FE-I4B's. The HSIO performs the buffering and multiplexing of the data sent to or coming from the chips as well as the 8b/10b decoding of the front end (FE) data. It is also responsible for generating and sending the clock signal to the FE and for formatting and sending cyclic and external triggers to the FE-I4B. This board is external to the ATCA crate.

To read out one IBL stave, one ATCA crate containing two CIM boards and two RCE boards is needed. Each RCE board is connected to an HSIO board which is connected to a half stave.

Pixel Detector specific DAQ software which runs on the RCEs has been developed to interface with the pixel FEs and performs the calibration and data-taking. The user interface to this software is a Roor [8] based GUI. Through this interface, users can specify the scan and FE configurations which are then communicated to the RCE. The user can view and study the data outputs after the completion of each scan.

## 4 Stave quality assurance procedure

An overview of the QA tests that are performed is shown in Figure 6 together with a rough total time estimate of four days per stave. For optimal timing of the testing procedure, the first step can be started in parallel to the fourth step of the previous stave. The QA of each stave includes a detailed optical inspection, electrical functionality and reception tests, calibration in different environmental conditions, data taking with radioactive sources as well as a classification of pixel failures. Each of these tests will be described in detail in the following text. Finally, the database used to store all the results will be presented. By convention, the staves are referred to as STXX, where "XX" is a numerical serial number.

### Optical inspection

A detailed optical inspection of each stave, which is performed at the beginning and end of the QA procedure, is composed of two main parts. Pictures of each chip are taken with a high resolution camera to spot any major damage to the chip as well as debris that might have been left on the stave during assembly or wirebonding. These pictures can be compared to pictures taken at different points in the testing chain. This direct comparison between the states of the modules at various points in time makes it possible to track down the source of a problem. If an irregularity is found, more detailed, additional pictures are taken. An example of an overview picture of a module and an observed irregularity, a loose wirebond, are shown in Figure 7. All pictures are archived for future reference.

Once this first step is completed, a detailed microscope inspection of the stave is performed. Each wirebond and each bond pad is carefully inspected with light from different angles to identify possible residues, corrosion, lifted or loose wires and any sort of debris that might lead to problems during operation. If loose wirebonds or other conducting material that might lead to shorts are found, they are carefully removed with a scalpel and Kapton tape. The full two-step optical inspection procedure is repeated after all remaining QA tests have been completed to make sure that nothing has been damaged during the QA process.

Figure 6: Overview of a typical stave QA procedure.

Figure 7: High resolution pictures of (a) a full module and (b) a detail picture of a loose wirebond.

### Electrical functionality

Before running calibration measurements, the basic electrical functionality of a stave needs to be verified, which includes power-up studies, verification of operation voltages and consumed currents in unconfigured and configured states of the chip as well as IV characteristics of a sensor group, which is composed of four FE-I4B chips, at 22\({}^{\circ}\)C.

Once a stave is fully connected to the cooling and all services, it is vital to check the sense lines of the LV power regulators are connected properly. This is done in a specific procedure where the voltage supplied to the regulators is set to a low voltage, where even with a faulty sense connection the regulators cannot apply an over-voltage to the chips. A correct connection of the sense lines is then easily recognisable by a voltage reading via the sense lines.

The powering behavior of the modules is tested by a **LV cycle**, which executes ten power cycles. In case of faulty modules, the current consumption will vary significantly between cycles. An example for a LV cycle is shown in Figure 8(a) for stave ST12. Most modules tend to show a stable current consumption for every cycle. In some cases, the consumption fluctuates as for example for the M1A powering group of ST12. High varying currents in the unconfigured state can be explained by improperly reset registers on the chip, which remain in an unknown state. The module passes the test as long as the current is well below 2 A and above 0.8 A.

An **IV scan** is performed to characterize the sensor quality. The sensor HV is ramped in 20 steps from 0 V to 100 V for 3D sensors and from 0 V to 200 V for planar sensors. The current limit for all IV measurements is 20 \(\mu\)A. While 3D FBK sensors show a rather steep break down behavior well below 50 V, planar sensors usually stand up to 200 V. 3D CNM sensors usually show a rather smooth break down behavior, spread over a wide voltage range but usually below 100 V. An example for ST12 is shown in Figure 8(b). The shape of the IV curve indicates potential issues with the sensors such as unwanted surface currents or cracks. It is important that the required operation voltage, 20 V for 3D and 80 V for planar sensors, can be safely applied and that the sensors show a constant leakage current over time.

### Reception test

The module functionality is tested after the shipment of the staves to CERN. After a first successful power-up of the stave, a number of values are recorded including the temperature, set voltage reading,

Figure 8: (a) LV cycles and (b) sensor IV characteristics for all DCS groups of ST12.

unconfigured current and high voltage leakage current of each powering group. Expected values of these quantities are listed in Table 1.

A digital test is run to ensure that all modules configure and the configured current of each module group is subsequently recorded. Then the following set of scans [9], a series of test injection commands and read out, is executed with the sensor being biased:

* A **digital scan** tests the digital part of the pixel cell. Pulses are repeatedly injected into the digital part of the pixel cell behind the discriminator, by-passing the analog part.
* During an **analog scan**, high charge is repeatedly injected into the analog part of the pixel cell to test its functionality.
* In a **threshold scan**, various known charges are injected into the analog pixel cell. If the injected charge is seen by the electronics then the event is counted as a hit. This procedure is repeated a fixed number of times for different charge steps while recording the number of hits at each step for every pixel. Ideally, a hit should only be recorded if the injected charge is above the threshold for this pixel and so the number of hits as a function of injected charge should be a step function. However in reality, this step function is convolved with a gaussian distribution owing to noise, resulting in a sigmoid function (s-curve) which is fitted to deduce the threshold mean and noise. The latter, also called the equivalent noise value, is measured as the width of the s-curve in number of electrons and represents the sum of all noise sources influencing the pixel behavior.
* A **ToT scan** injects repeatedly a fixed charge of 16000 \(e\), which is the equivalent of a energy deposition of a minimum ionising particle (mip) in 200 \(\mu\)m silicon. The time that a signal is above threshold is proportional to the charge collected. The ToT can be calibrated to read a certain number of clock cycles interpreted as Bunch Crossings (BC) for a given charge. The ToT mean and sigma is calculated for every pixel.
* For a **crosstalk scan**, high charge is injected into the pixels a row above and below and the central pixel is read out. The existence of high crosstalk is implied if a hit is received in the central pixel. This procedure is repeated for every pixel on the chip.

These scans give a first overview of the stave functionality and an indication of potential changes or damages induced during transport. The trend of the leakage current of each module group is closely monitored to ensure stability over time. The HV is then turned off and another threshold scan is run. Comparing the threshold scan with and without HV, areas of disconnected bumps can be identified since a pixel that is no longer connected to the sensor is not affected by the higher noise present when the sensor is not fully depleted. However, this check only gives a rough estimate and a source scan is needed to fully identify all disconnected bumps. A comparison with results from previous testing sites is made and archived together with the exact scan run numbers for future reference.

\begin{table}
\begin{tabular}{l c} \hline \hline Quantity & Expected Value \\ \hline Temperature & 22\({}^{\circ}\)C \\ Set Voltage & 2.1 V \\ Unconfigured current & 1.1 A \\ Configured current & 1.5 A \\ Leakage current & \(<\) 2 \(\mu\)A \\ \hline \hline \end{tabular}
\end{table}
Table 1: Data recorded for each powering group in the reception test and their expected values.

### Calibration

The discriminator threshold and the ToT parameters of the IBL chips need to be calibrated and tuned to distinguish between a charged particle hit and electronic noise as well as to determine the amount of charge deposited uniformly over all IBL pixels. The calibration will have to be done many times over the course of the IBL lifetime to compensate for the effects of radiation and the changes in operating conditions. For instance, the threshold will have to be lowered as the charge collection efficiency decreases with increasing radiation damage. While the majority of the QA tests are performed at 22\({}^{\circ}\)C, the staves are also cooled down to the ATLAS Pixel Detector operating temperature of -12\({}^{\circ}\)C in order to test the calibration capabilities of the IBL chips in operation environment. Two additional thermal cycles from 22\({}^{\circ}\)C to -12\({}^{\circ}\)C are performed to identify potential module infant mortality. The module tuneability is tested for reference thresholds of 3000 \(e\) at 22\({}^{\circ}\)C and 1500 \(e\) at -12\({}^{\circ}\)C. The ToT is tuned to 10 BC for a reference mip charge of 16000 \(e\).

The threshold tuning is performed using the efficiency method, where the threshold is defined to be the charge for which the hit efficiency is 50%. The discriminator threshold for each pixel is controlled via two global 8 bit digital to analog converters (DACs) at the chip level that allow shifting of the threshold for all pixels at the same time and a 5 bit DAC at the pixel level for fine tuning per pixel. Therefore the global DACs are tuned, while maintaining the pixel DACs at the median setting, before determining the optimal setting for the pixel DAC for the desired threshold. Multiple charge injections are performed at the target threshold and the number of hits resulting from these injections are counted for a given set of global and pixel DAC settings. The global or pixel DAC (depending on which one is being tuned) is shifted until the optimal value achieving a hit efficiency closest to 50% is found. Figure 9 shows an example for the threshold distribution of pixels of a chip before and after tuning is performed.

The ToT tuning is done after the threshold tuning as the discriminator threshold is one of the pixel properties that affects the measured ToT along with the feedback current of the amplifier and vice versa. Similar to the discriminator threshold, the preamplifier feedback current which determines the ToT is controlled via an 8 bit global DAC for all pixels in a chip and a 4 bit DAC per pixel. A number of 16000 \(e\) mip charge injections is performed and the mean of the ToT is calculated for a given set of global and pixel ToT DAC settings. The global or pixel DAC is shifted until the optimal value achieving a mean ToT closest to 10 BC is found.

Figure 9: Threshold distribution of pixels before and after tuning for an example IBL chip for 3000 \(e\) threshold tuning at 22\({}^{\circ}\)C powering group temperature. A tuned threshold distribution typically has a standard deviation of less than 100 \(e\).

### Source scans

There are two accessible methods to mimic real detector operation before installation of the detector in the pit, either using cosmic ray particles or a radioactive source. Both methods are available in the stave QA test stand. Scintillators installed above and below the environmental box can be used as a coincidence trigger for cosmic rays and a linear motor inside the box can hold and move radioactive sources along the stave to irradiate each chip. The rate of cosmic hits in this setup is about \(6\times 10^{-7}\) hits per pixel per second, which is too low to achieve reasonable statistics for analysis during the time available for the QA. The second method is therefore preferable: it uses two \({}^{90}\)Sr sources of 28.8 MBq each, emitting 2.28 MeV electrons, and the internal self trigger mechanism of the FE-I4B chip.

Source scans are performed at 22\({}^{\circ}\)C with a 3000 \(e\) threshold and 10 BCs ToT at 16000 \(e\) tuning. As the source is moved over the stave, data is taken for 400 s for each chip to collect reasonable statistics. An example of a source scan hit map can be seen in Figure 10(a). Regions with a lower number of hits are clearly visible and match precisely the areas where passive components are mounted on the module flex PCB. Each normal pixel has around 150 to 200 hits while long pixels in the outer columns have nearly twice as many number of hits, which is expected due to their size. The difference in number of hits between working and not working pixels is large enough to readily identify dead and disconnected pixels.

As a particle can hit and deposit charge in multiple pixels while traversing the sensor, the data stream is analyzed for clusters. A cluster is defined as adjacent hits in the same BC and their ToT value is summed up without adjusting for the threshold. As 14 BC ToT is also the overflow value of the chip, every cluster containing a hit with 14 BC ToT is discarded. The ToT of these clusters is plotted in Figure 10(b), showing the distribution for single hit clusters as well as for clusters with two or more hits. The single hit cluster distribution stops at 13 BC while every cluster with a ToT of 14 BC or higher is composed of more than one hit. The distribution of single hit clusters has a large, non minimum ionizing particle (mip) peak around 2 BC ToT which disappears nearly completely when counting only clusters with more than one hit. This is explained by the fact that noise and low energy radiation from the source manifest in single pixel hits. A fit to a Landau distribution convolved with a Gaussian is shown for the clusters with more than one hit. The fit results is used to compare the relative charge calibration of the chips to each other. An analysis of the absolute charge calibration is not possible with this method.

Figure 10: Source scan data of a module on ST12 showing (a) the hit map and (b) the clustered ToT.

### Pixel defects

Pixel defects can be categorized into three main "bad pixel" classes: defects pertaining to the front-end, sensor or bump bonding. A combined analysis of the calibration and source scan results makes it possible to classify each failing pixel. The failure classification is exclusive, which means that only one category of failure is used per pixel. All failure categories are listed in order of exclusion in Table 2, showing the category name, scan used for identification and the specific criteria for each class.

Most of the failures rely on the module showing a hit excess or deficit. The digital and analog functionality can be directly tested with digital and analog scans, respectively. Digital and analog dead pixels are common electronic failures, while the digital and analog bad categories only appear in high numbers in case of a low ohmic connection between pixels. The latter mainly occurred in the early production bump bonding process and was fixed. An exception to a failing analog functionality is the identification of a merged bump. It is defined as two solder bumps connecting the sensor to the readout chip being merged together and manifests itself in an analog failing pixel which still gives a response in a crosstalk scan. A pixel is classified as untunable if the threshold or ToT cannot be tuned at all, however a high discrepancy from the tuning target is allowed as these kinds of pixels can still be used for operation even if just to a limited extent. The noise occupancy, which shows how many hits per BC are produced due to noise, is a very important quantity for operation. A pixel gets masked for operation and classified as a bad pixel if the noise occupancy exceeds \(10^{-6}\) hits per BC. The expected occupancy rate for IBL, assuming a luminosity of \(10^{34}cm^{-2}s^{-1}\), is about \(10^{-3}\) hits per pixel per BC. All tests mentioned so far are aimed at probing the electrical functionality of the pixel. In addition, it is necessary to ensure that the readout electronics are properly connected to the sensor, in other words to make sure that the bump connection in-between is intact. The easiest way to identify a disconnected bump, is to analyze the response from a source scan. If a so-far good pixel shows no or only very few hits in the source scan data, the bump is assumed to be disconnected. The last bad pixel category, called high crosstalk, is not directly related to the performance of the pixel but if a sensor pixel shows a high amount of charge sharing to its neighbors this can influence the precision of the offline reconstruction.

An example of such a bad pixel analysis of stave 12 is shown in Figure 11. In this plot, all bad pixel types are stacked to give the total amount of failing pixels per chip. The information of which kind of failure is most prominent is not used to judge the overall quality of a stave, but it provides very useful information in case an excess of bad pixels is observed. It should be noted that the number of bad pixels is significantly below the IBL requirement of 270 pixels per chip.

\begin{table}
\begin{tabular}{l c c} \hline \hline Failure Name & Scan Type & Criteria \\ \hline Digital Dead & Digital Scan & Occupancy \(<\) 1\% of injections \\ Digital Bad & Digital Scan & Occupancy \(<\) 98\% or \(>\) 102\% of injections \\ Merged Bump & Analog Scan & Occupancy \(<\) 98\% or \(>\) 102\% of injections \\  & Crosstalk Scan & Occupancy \(>\) 80\% of 25 k\(e\) injections \\ Analog Dead & Analog Scan & Occupancy \(<\) 1\% of injections \\ Analog Bad & Analog Scan & Occupancy \(<\) 98\% or \(>\) 102\% of injections \\ Tuning Failed & Threshold Scan & s-curve fit failed \\  & ToT Test & ToT response is 0 or 14 BCs \\ Noisy & Noise Scan & Occupancy \(>\) 10\({}^{-6}\) hits per BC \\ Disconnected Bump & Source Scan (\({}^{90}\)Sr) & Occupancy \(<\) 1\% of mean Occupancy \\ High Crosstalk & Crosstalk Scan & Occupancy \(>\) 0 with 25 k\(e\) injection \\ \hline \hline \end{tabular}
\end{table}
Table 2: Classification of pixel failures.

### Data storage

Various records of the QA results are compiled in a MySQL [10] database and visualized in a dynamic summary webpage. The data storing is handled in two ways; one is through manual input, the other is systematic filing of the analysis results for the data acquired with RCE. The manual input covers chip mapping registration, optical inspection pictures, IV-curve and LV-cycle plots as well as any annotations for the individual QA results. These manual inputs are assisted with a dedicated GUI application. The systematic filing was implemented in the RCE analysis framework. The entity-relationship (ER) of the database was designed with setting the FE-I4Bchip as the minimum unit of the structure. The IBL composition hierarchy of staves, modules and chips was implemented in the ER for smooth handling of data sorting. The summary webpage was written in PHP. The scripts generate dynamic XHTML codes and images to be embedded in the page by steering MySQL queries and ROOT scripts.

## 5 Results

In this section, the data for all 18 staves taken during stave QA is presented and summarized for each part of the procedure. These results are used to select 14 staves for integration around the beam pipe and serve as a reference for the performance and characteristics of the IBL. Since all 18 staves passed the QA procedure and are therefore suitable for the integration, the analysis focuses on the characterization of each stave rather than on the application of quality cuts to the production. A total of 15.5M (\(18\times 32\times 26880\)) pixels were tested and qualified on these 18 staves.

The QA procedure is designed and optimized to characterize a stave in a minimal time period, which is necessary due to the time being tightly constrained. The number of days needed to perform all scans is shown in Figure 12 for each stave. The mean time per stave is \(2.7\pm 0.6\) days. This time does not include the two optical inspections, stave installation or removal, which altogether take up to one day. On average, the QA of a stave took less than the four allocated days since debugging was not generally needed. Debugging is identifiable in Figure 12 by an increased number of scans and is discussed in sections 6.3 and 6.4.

### Electrical functionality

The current consumption of each group before and after configuration are an important quantity for the detector operation. Once powered, one DCS group, composed of four chips as introduced in Section

Figure 11: Distribution showing the bad pixel categories as a function of chip number for stave 12.

2.3, consumes on average 1.1 A. This value rises by about 400 mA after configuration of the chips. The currents for unconfigured and configured groups as well as their differences are shown in Figure 13.

The distribution of the unconfigured currents is wider and for some groups there is a large deviation from the expected value. However, the behavior of these groups is known from the module production site and the configured currents are close to the expected value. The mean unconfigured and configured currents of a DCS group are \(1.1\pm 0.1\) A and \(1.5\pm 0.1\) A, respectively. The mean difference shows an increase in current of \(0.4\pm 0.1\) A.

The IV characteristics of all powering groups are shown in Figure 14, which separates the data by sensor type. Normally the quality of a sensor is determined by its breakdown voltage, but the modules on a stave often show a partly ohmic behavior caused by surface currents. This can be amplified by mechanical stress as well as glueing during the module assembly and stave loading. For a typical sensor group, the current should not exceed 15 \(\mu\)A before 150 V and 20 V for planar and 3D sensors, respectively. As planar sensors deplete around 50 V and 3D sensors around 10 V, this definition has a high safety margin.

The 3D sensors produced by FBK and the planar sensors show a consistent behavior, while the 3D sensors produced by CNM are distributed over the full bias range, some of them show a high current at operational voltage. This issue was already observed during production and assembly of the modules, but as all sensors fully deplete at the operational voltage as verified by a source scan and the current at

Figure 12: Number of days needed per stave and number of scans which were performed.

Figure 13: (a) Configured and unconfigured LV currents (b) and their differences for all DCS groups

operational voltage is not extremely high, this is not an issue for operation.

The voltage at which the powering group reaches a leakage current of 15 \(\mu\)A, in the QA this point defined the breakdown voltage, is shown in Figure 15(a). Figure 15(b) shows the leakage current at operation voltage. The majority of planar modules have breakdown voltages above 200 V and low leakage currents. For all FBK sensors except one, the breakdown voltage is between 30 and 40 V and they show a leakage current that can barely be measured by the HV power supplies. The mean leakage current at operational voltage for planar and 3D FBK sensors is 1.3\(\pm\)0.9 \(\mu\)A and 0.4\(\pm\)0.3 \(\mu\)A, respectively. At operation voltage, CNM sensors have larger currents and larger spread. This is most probably due to surface currents which overshadow the sensor bulk current.

### Reception test

For the reception test analysis, data from the assembly site is compared to data taken at the stave QA setup. Specific focus is given to big differences in number of digital or analog dead pixels, as well as major shifts in threshold or threshold noise. This makes it possible to spot potential changes or damages due to transportation. No major change in the number of failing pixels in digital or analog scans is observed for any stave. Only a small shift in the per pixel threshold is observed and explained by different operational environments of the stave assembly site and CERN. The threshold noise, however, shows a

Figure 14: IV curves of 17 staves split up according to (a) planar, (b) FBK and (c) CNM sensors. The IV curve of Stave 20 is missing.

significant offset for some powering groups due to increased noise in the HV supply lines. Implications of this noise are presented in section 6.2.

### Calibration

The results of calibration to the reference thresholds of 3000 \(e\) at 22 \({}^{\circ}\)C and 1500 \(e\) at -12\({}^{\circ}\)C, as discussed in section 4.4, are listed in Table 3. Both tunings were performed for a 10 BC Time-over-Threshold (ToT) response at 16000 \(e\). Long pixels of planar sensors are listed separately as they show a higher noise due to their larger pixel size. The measured threshold does not represent the in-time threshold, as no timing constraints were set. The number of pixels per type are 11321900, 290304, 1935360 and 1935360 for normal planar, long planar, 3D FBK and 3D CNM pixels, respectively. It should be noted that the minimal dispersion value is 40 \(e\) as dictated by the precision of the injection circuit.

Figure 16 shows the threshold and noise distributions of pixels for the 3000 \(e\) threshold tuning at 22\({}^{\circ}\)C module temperature representative, as the 1500 \(e\) looks very similar. The higher noise of FBK pixels is primarily due to two modules located on staves 14 and 20 at the highest \(\eta\) position, the worst of which is forming the small peak of pixels near 300 \(e\) noise. These staves are not chosen for the IBL, see Section 5.6, and remained as backups in case of problems during integration. In both cases, the staves happened to be tested on the CR side7 of the QA setup and the HV bias supply line serving the 3D modules on the A-side is known to have 0.2 V noise. In general, sensitivity to such external noise is observed for all 3D modules, more so for the FBK sensors. Details of this observation are discussed in Section 6.2.

Footnote 7: The two installation locations in the stave QA setup are customarily called CR and SR side.

The threshold over noise distributions of pixels for 3000 \(e\) and 1500 \(e\) tunings are presented in Figure 17. The threshold over noise is the key parameter in determining the quality of the IBL modules with respect to their operability at a given discriminator setting. The bigger this factor is the less contamination of noise hits in the sample of physics hits recorded during collisions. The physics occupancy in the ATLAS pixel b-layer was about \(5\times 10^{-4}\) hits per pixel per BC at the end of Run1. Pixels with a noise occupancy rate higher than \(10^{-6}\) hits per pixel per BC are referred to as noisy pixels and are disabled from data taking to ensure noise contamination in physics hits from collisions is less than 0.5%. The expected physics occupancy for the IBL is \(10^{-3}\) hits per pixel per BC in early operation and higher in later years. A threshold over noise value higher than 5 would ensure that the noise contamination in

Figure 15: HV groups as a function of (a) bias voltage for which the current is larger than 15 \(\mu\)A including overflow and (b) leakage current at operational voltage of 20 V for 3D and 80 V for planar sensors.

physics hits from IBL would be less than 0.1%. The fraction of noisy IBL pixels is less than 0.03% for the 1500 \(e\) reference tuning at -12\({}^{\circ}\)C module temperature. As a reference the rate of noisy pixels in the current Pixel Detector is twice as high at 0.06% for the 3500\(e\) operational threshold at same module temperature.

Figures 18(a) and 18(b) show the threshold and threshold noise distributions, respectively, averaged over all 18 production staves as a function of chip number. The uncertainties displayed are twofold. The error bars represent the root mean square value to show the spread between the different staves whereas the solid squares represent the asymmetric data points with the largest deviation from the mean value. Overall, it was possible to tune all production staves down to 1500 \(e\) with a deviation of maximally 40 \(e\). This can be seen by the flat distribution in Figure 18(a). The average threshold noise value is about 130 \(e\) for planar sensors and still well below 180 \(e\) for 3D sensors. Slightly higher noise is observed on the A-side of the setup. As already mentioned, this is due to a combination of increased noise on the HV lines of one side of the setup and the fact that FBK modules were more frequently chosen over CNM modules for loading on this side.

Figure 19(a) shows the ToT distribution of pixels after tuning of 10 BC

Figure 16: (a) Threshold and (b) noise of pixels for 3000 \(e\) threshold tuning at 22 \({}^{\circ}\)C module temperature.

\begin{table}
\begin{tabular}{l l c c} \hline \hline Tuned Threshold & Pixel Type & Std. Dev. \([e]\) & Noise \([e]\) & Threshold over Noise \\ \hline \multirow{4}{*}{3000 \(e\) at 22\({}^{\circ}\)C} & Planar Normal & 37 & 123 \(\pm\) 10 & 25 \(\pm\) 2 \\  & Planar Long & 58 & 146 \(\pm\) 15 & 21 \(\pm\) 2 \\  & 3D FBK & 39 & 171 \(\pm\) 25 & 18 \(\pm\) 2 \\  & 3D CNM & 40 & 149 \(\pm\) 15 & 20 \(\pm\) 2 \\ \hline \multirow{4}{*}{1500 \(e\) at -12\({}^{\circ}\)C} & Planar Normal & 42 & 129 \(\pm\) 13 & 12 \(\pm\) 1 \\  & Planar Long & 47 & 149 \(\pm\) 16 & 10 \(\pm\) 1 \\ \cline{1-1}  & 3D FBK & 46 & 171 \(\pm\) 25 & 9 \(\pm\) 1 \\ \cline{1-1}  & 3D CNM & 41 & 146 \(\pm\) 16 & 10 \(\pm\) 1 \\ \hline \hline \end{tabular}
\end{table}
Table 3: Threshold calibration summary for different pixel types for 18 staves. Listed values are the standard deviation of the threshold, mean noise and its standard deviation, and mean threshold over noise and its standard deviation.

charge of 16000 \(e\). The dispersion is 0.2 BC. Figure 19(b) shows a similar result to Figure 18(a) except that the analysed quantity is ToT rather than threshold. The distributions are again very stable around the target value. Peaks at integer values are expected due to the response given from the chip is integer.

### Source scans

Source scans are mainly used to identify disconnected bumps, but it is also possible to check the charge calibration of each chip as the \({}^{90}\)Sr emits mips. One disadvantage of using the self trigger of the FE-I4B is that lower energetic particles and noise can also trigger the chip, this results in a ToT Landau distribution with an obscured low ToT region. If only clusters with more than one hit are used, the ToT distribution is slightly shifted to higher values, however it is still possible to compare the relative charge calibration of all chips. Figure 20(a) shows the average most probable value of the Landau-Gauss fit and its dispersion as a function of position on a stave. The one dimensional distribution of the Most Probable

Figure 17: Threshold over noise distribution of pixels for 3000 \(e\) (a) and 1500 \(e\) (b) threshold tunings at 22 \({}^{\circ}\)C and -12 \({}^{\circ}\)C module temperatures, respectively.

Figure 18: Average (a) threshold and (b) threshold noise distributions for all 18 staves as a function of chip number.

Value (MPV) of each chip is plotted in Figure 20(b). There is no dependance on the position on the stave and the mean most probable ToT value is \(10.5\pm 0.3\) BC, which is consistent with the given tuning of 10 ToT BC for 16000 \(e\) charge. Figure 20(c) shows all cluster ToT distributions, shifted by their respective fitted MPV, stacked up. No significant difference in the shape of the distribution of planar and 3D sensors is observed. The staves were tuned to a threshold of 3000 \(e\) at 22\({}^{\circ}\)C. The number of hits acquired for each pixel during the source scans is shown in Figure 21. A normal pixel of a planar sensor shows a mean number of hits of 162\(\pm\)41, while the long pixels on the planar sensors show 240\(\pm\)64 hits, the ratio of 1.5\(\pm\)0.3 between these numbers is expected as long pixels are nearly double the size of a normal pixel. This is not expected for 3D sensors as all pixels have the same size and sensors fabricated by CNM show exactly this behaviour with the pixels in the outer column and row not showing a divergence from all the other pixels. For sensors manufactured by FBK though an excess in the number of hits in the outer columns and rows is observed. This is a result of the chosen guard ring and slim edge fence design of CNM and FBK, respectively. Hence the mean occupancy of the pixels in the outermost column and row of FBK is increased by 1.1\(\pm\)0.3 and 1.6\(\pm\)0.3, respectively. This behavior fits to an increased active area around all pixels by around 50 \(\mu\)m, increasing the active area of the outer columns by around 20% and the rows by around 100%.

### Pixel defects

The fraction of disconnected pixels over all chips as a function of the geographical pixel position can be seen in Figures 22(a) and 22(b) for 3D and planar sensors, respectively. Disconnected bumps clearly tend to be located in the outer columns and rows. A zoom into the corner regions for the same quantities are shown in Figures 22(c) and 22(d) for 3D and planar sensors, respectively.

Figures 23(a) and 23(b) show overlays of the total number of disconnected pixels for 3D and planar sensors, respectively, with a picture of an IBL module for 18 staves. As disconnected bumps are determined by the number of hits in a source scan, a very low occupancy underneath passive components could cause a systemic misidentification. No clear correlation between the geographical location, other than edge regions, and high numbers of disconnected bumps is observed. The total fraction of bad but not disconnected pixels as a function of chip row and column numbers for 18 staves is shown in Figure 24.

Figure 19: (a) One dimensional ToT distribution of all pixels and (b) average ToT distribution as a function of chip number. Non integer values of ToT are possible in (a) due to multiple injections and the calculation of the mean ToT value per pixel.

Figure 21: Occupancy distribution for (a) planar, (b) FBK and CNM pixel cells in \({}^{90}\)Sr source scans.

Figure 20: Most probable cluster ToT value obtained from a Landau-Gauss fit, (a) shows the average as a function of chip number and (b) shows the distribution over all chips. (c) shows the distribution of the difference between cluster ToT and fitted chip MPV ToT.

Pixel failures other than disconnected bumps are distributed over the whole chip or can appear in form of columns, as a result of the interconnection scheme of the pixels.

Figure 25(a), which plots the total number of bad pixels as a function of \(\eta^{8}\), demonstrates that there is a clear increase in the number of bad pixels as one moves to higher \(\eta\) values. This behavior is explained by the strategy chosen to load the best modules into the central region of a stave. The exact numbers of bad pixels per defect category are collected in Table 4 for each of the 18 staves.

The number of bad pixels per chip is shown in Figure 25(b). Chips with less than 100 bad pixels were the target for IBL, some outliers are visible as this cut was relaxed at the end of the production, due shortness of modules. 73% of all chips on 18 staves have less than 0.1% bad pixels.

The total number of failing pixels per stave is shown in Figure 26(a). The two dashed lines indicate 0.1% and 0.2% marks, the specification requires a stave to be below 1%. All staves are well below this cut, 80% of staves are below the 0.2% mark and 50% of those staves are even below 0.1%. The main pixel failure categories are shown in Figure 26(b). About 50% of all failures are due to disconnected bumps, the other 50% are distributed between a pixel being analog dead or its tuning being impossible.

Figure 22: Total fraction of disconnected pixels on (a) 3D and (b) planar sensors as a function of chip row and column numbers for 18 staves. (c) and (d) show zoomed corner views.

\begin{table}
\begin{tabular}{l c c c c c c c} \hline \hline Stave & Digital & Analog & Disconnected & Merged & Untuneable & Noisy & Crosstalk & Total \\ \hline ST01 & 6 & 389 & 272 & 3 & 232 & 11 & 98 & 1011 \\ ST02 & 10 & 255 & 54 & 3 & 117 & 15 & 125 & 579 \\ ST03 & 6 & 375 & 473 & 0 & 182 & 21 & 178 & 1235 \\ ST04 & 2 & 201 & 254 & 0 & 275 & 8 & 59 & 799 \\ ST05 & 2 & 207 & 172 & 0 & 183 & 4 & 33 & 601 \\ ST06 & 6 & 206 & 337 & 0 & 147 & 9 & 29 & 734 \\ ST09 & 8 & 360 & 476 & 3 & 167 & 8 & 88 & 1110 \\ ST10 & 16 & 179 & 304 & 0 & 141 & 3 & 3 & 646 \\ ST11 & 10 & 196 & 159 & 0 & 155 & 8 & 37 & 565 \\ ST12 & 15 & 172 & 169 & 0 & 166 & 7 & 13 & 542 \\ ST13 & 9 & 127 & 205 & 0 & 336 & 6 & 35 & 718 \\ ST14 & 4 & 161 & 1364 & 0 & 330 & 7 & 11 & 1877 \\ ST15 & 5 & 222 & 350 & 0 & 259 & 20 & 8 & 864 \\ ST16 & 1 & 237 & 414 & 1 & 187 & 15 & 24 & 879 \\ ST17 & 2 & 214 & 598 & 0 & 229 & 5 & 4 & 1052 \\ ST18 & 13 & 161 & 902 & 1 & 178 & 2 & 9 & 1266 \\ ST19 & 10 & 163 & 543 & 0 & 228 & 11 & 16 & 971 \\ ST20 & 14 & 224 & 1051 & 0 & 535 & 13 & 302 & 2139 \\ \hline \hline \end{tabular}
\end{table}
Table 4: Overview of the number of different bad pixel categories for the 18 staves.

pipe. The pseudorapidity \(\eta\) is defined in terms of the polar angle \(\theta\) as \(\eta=-\ln\tan(\theta/2)\).

Figure 23: Overlay of the total number of disconnected pixels for (a) 3D sensors and (b) planar sensors with a picture of an IBL module for 18 staves.

Figure 24: Total fraction of bad but not disconnected pixels as a function of chip row and column numbers for 18 staves.

Figure 25: (a) Total number of bad pixels as a function of \(\eta\) for all 18 production staves. (b) Bad pixel fraction per chip for 18 staves.

### Stave ranking

Once the quality of a stave is guaranteed in terms of operation and tuning, the main concern to be characterized for selecting the staves to load is the coverage efficiency of the geometrical acceptance. The number of bad pixels which have to be masked during operation is therefore crucial to rank the staves. To measure the geometrical acceptance, an \(\eta-\phi\) coordinate system is used and the weight of the acceptance for each pixel is assigned accordingly. The bad pixel score \(V\) of the stave is defined as

\[V=\frac{\sum_{i\in\text{ bad pixels}}\cosh^{-1}(\eta_{i})}{\sum_{i\in\text{ all pixels}}\cosh^{-1}(\eta_{i})} \tag{1}\]

where \(\cosh(\eta)=dz/d\eta\cdot\text{const.}\) is the weight factor for each pixel. This weighting scheme is preferred to simply summing-up the bad pixel ratios without weighting as it enhances the pixels in the central rapidity region and suppresses them in the forward rapidity region. A low score is preferable as it indicates a small bad pixel ratio. For the actual loading of the staves around the beam pipe, not only this scoring but also a uniform \(\eta-\phi\) distribution of the bad pixels and engineering constraints, such as the difference between the minimum and maximum height of a stave, the planarity, are considered. Table 5 summarizes the position in the IBL loading map, the score and other characteristics of the staves considered in the selection. The production staves that were not chosen for loading and that serve as backup are staves ST01, ST03, ST14 and ST20. In total 168 planar, 60 3D CNM and 52 3D FBK sensor modules are mounted on the 14 staves chosen for IBL.

Figure 27 compares the average bad pixel ratio distribution as a function of pseudorapidity \(\eta\) for the 14 installed staves to the four not installed staves, the former achieving better performance in terms of acceptance. The total bad pixel ratio of the integrated IBL staves is 0.07% for \(|\eta|<2.5\) and 0.09% when considering the full \(\eta\) range. For comparison, the corresponding numbers for the four not installed staves are 0.16% and 0.18%, respectively. Figure 27 shows the two-dimensional distribution of bad pixel ratios as a function of \(\eta\) and \(\phi\). Stave overlap is taken into account in this plot and the ratio is computed as the number of bad pixels per total number of pixels in a unit cell.

## 6 Issues observed and lessons learned

The stave QA proved to be very valuable in order to identify and investigate issues with the IBL staves. A subset of the encountered issues and the lessons which have been learned from them are presented.

Figure 26: Number of bad pixels (a) per stave for all 18 staves and (b) per failure category for 18 staves.

\begin{table}
\begin{tabular}{l l c c c c} \hline \hline Position & Stave & Number of bad pixels & Score & Planarity [\(\mu\)m] & Reworked \\ \hline \#01 & ST17 & 1052 & 1.01 & 114 & no \\ \#02 & ST02 & 579 & 0.44 & 205 & yes \\ \#03 & ST19 & 971 & 1.13 & 266 & no \\ \#04 & ST09 & 1110 & 1.00 & 229 & yes \\ \#05 & ST18 & 1266 & 0.94 & 336 & no \\ \#06 & ST04 & 799 & 0.69 & 235 & yes \\ \#07 & ST13 & 718 & 0.56 & 224 & no \\ \#08 & ST10 & 646 & 0.62 & 243 & yes \\ \#09 & ST11 & 565 & 0.58 & 298 & no \\ \#10 & ST12 & 542 & 0.62 & 314 & yes \\ \#11 & ST16 & 879 & 0.82 & 329 & no \\ \#12 & ST06 & 734 & 0.79 & 290 & yes \\ \#13 & ST15 & 864 & 0.84 & 325 & no \\ \#14 & ST05 & 601 & 0.68 & 189 & yes \\ n/a & ST01 & 1011 & 1.04 & 224 & yes \\ n/a & ST03 & 1235 & 2.48 & 223 & yes \\ n/a & ST14 & 1877 & 1.11 & 218 & no \\ n/a & ST20 & 2139 & 2.01 & 237 & no \\ \hline \hline \end{tabular}
\end{table}
Table 5: Ranking and loading order overview of the 14 IBL staves. The cooling pipe of the stave in position 01 is at \(\phi=-6.1^{\circ}\), subsequent staves are displaced by \(25.7^{\circ}\) in \(\phi\). The score is determined by the number of bad pixels, each of which is weighted according to the position on a stave. A lower score thus translates into a higher quality stave. The planarity shows the difference between the minimum and maximum height of a stave. The last column indicates whether a stave has been reworked at the CERN DSF bond lab. For completeness, the bottom four lines show numbers for the staves that were not chosen for installation. For the stave loading around the beam pipe, not only this score but a uniform \(\eta-\phi\) bad pixel distribution and engineering constraints are also taken into account.

### Double trigger scans

A specific set of scans, double trigger scans, was used to test if the processing of a trigger changes the chip behavior. During these scans, the second trigger probes the effect of the first trigger on the chip. A double trigger threshold scan sends a calibration pulse for each of the two trigger commands in a variable time interval, and measures the threshold in the same manner a normal threshold scan would do for both of them. In order to maximize any possible effect, the measurements are performed with a trigger multiplier of eight, which means that each trigger is reproduced eight times after the reception of the command. An example result of this is shown in Figure 28, where the threshold is measured for both trigger commands for a varying sampling time after the first trigger. The threshold measured on the first trigger is not influenced by the second trigger and gives a baseline for the expected threshold. However, the threshold measured with the second trigger shows a lowered threshold 15 BC after the first trigger, which stably returns to the baseline around 15 BC later. A measurement directly at the trigger time is prevented by an overlap of the injection and trigger command, only allowing it to measure shortly after the first trigger.

If the threshold is indeed decreased after a trigger and this is not just an effect produced by the injection pulse, it should be possible to measure an increase in the number of noise hits shortly after a trigger. This is investigated with a double trigger noise scan, which measures the number of noise hits for each trigger, closely resembling the operation of the detector with a high trigger rate. Figure 28 shows the relative number of noise hits per trigger which is probed around the processing of the a trigger command. An increase in noise hits is clearly visible in the time up to 30 BC after a trigger.

Both of these scans suggest that the threshold is dropping when a trigger command is processed by the chip. This can be related to a design choice in the chip, where only active regions are powered and a trigger command causes a high activity on the chip which quickly changes the current consumption and thereby induces a very short change in some voltages such as the discriminator bias. The trigger multiplication results in a much higher activity and more pronounced impact on the threshold. The measurements were repeated without the trigger multiplication to reflect ATLAS operation and were found to drastically decrease in amplitude and time, not interfering with the operation.

Figure 27: Average bad pixel ratio distribution (a) as a function of \(\eta\) for installed and not installed production staves. (b) shows the bad pixel ratio in the \(\eta-\phi\) plane for the 14 IBL staves and represents the inefficiency map of the IBL as it is installed.

### Noise on 3D sensors

A HV bias line with 0.2 V noise in the QA setup has uncovered that 3D modules can be sensitive to external noise sources. Figures 29 and 29 present noise distributions of FBK and CNM pixels for different HV bias lines in the QA setup. Both 3D designs show sensitivity to the noisy HV bias line on the CR A-side of the QA setup but the effect is significantly more pronounced for FBK sensors. The mean noise of FBK pixels excluding those on the noisy HV bias line on the CR A-side of the QA setup is 160 \(e\). No difference in noise is observed for the planar pixels when biased with this noisy HV line.

Independently of the HV bias lines, FBK sensors have shown hotspots of higher noise in specific areas for certain sensors. Examples, as shown in Figure 30, are regions where Negative Temperature Coefficient (NTC) thermistors are placed or along the trace of the HitBus output. The latter was only seen if the HitBus pads were wire bonded and the noise disappeared if the HitBus output was disabled.

Figure 28: (a) Mean threshold measured for the two triggers and (b) relative number of hits per trigger measured in a double trigger noise scan. The sampling point in is given relative to the first trigger.

Figure 29: Noise distribution of (a) FBK and (b) CNM for different HV bias lines in the QA setup.

### Charge calibration

Each pixel on an IBL module has a charge injection circuitry that is used to tune module properties such as threshold and ToT as well as testing the integrity of digital and analog readout blocks in the pixel. The charge injection circuitry consists of two capacitors which can be chosen independently and a 10-bit DAC for generating voltage steps over the capacitors for the desired injection charge. Values of capacitances are measured at the front-end wafer level before module production. The relationship between a DAC setting and the corresponding calibration voltage is measured with an external voltmeter and parametrized with a line. Proper calibration of the charge injection circuitry is needed to achieve a uniform response over all IBL modules. One of the purposes of making measurements with radioactive sources during the QA is to cross-check charge calibration of modules as discussed in section 4.5. Incorrect charge calibration for a given module leads to a different measured ToT with respect to other modules since all modules are tuned to the same threshold and ToT before the source scans. Unusually high or low threshold noise on an otherwise well behaving module can be an indication that the charge calibration is off before data taking with real particles.

A couple of modules with wrong charge calibration were found during the stave QA. Figure 31 shows ToT distributions of multi-hit clusters measured from source scans before and after charge calibration. The calibration is done by manually adjusting the slope of the calibration voltage, re-tuning the threshold and ToT of the module, and repeating the source scan until the measured ToT value from source particles is similar to the one from neighbouring modules.

### Weak output of differential driver

On rare occasions, no communication between a chip and the DAQ could be established. If default debugging checks are unable to find the source of the problem, the output signal can be probed. The FE-I4B data is transferred using Low-Voltage Differential Signaling (LVDS). The output voltage levels are generated inside the chip and can be regulated with the help of internal DACs. The output signal of each chip can be differentially probed on test points on the HSIO board. Figure 32 shows a typical eye pattern for a chip with LVDS driver working with nominal DAC settings. The output levels are clearly distinguishable, the frequency is stable and there is very little jitter on the signal. The dominant signal in the eye pattern is the 8b10b idle frame, quasi random data was produced by running a threshold scan on the chip while probing. Figure 32 shows an example of a chip with which the communication failed

Figure 30: Noise map of a FBK module with (a) NTC and (b) hitbus hot spots.

due to poorly adjusted output levels. This type of problem can be solved by increasing the LVDS driver DAC settings.

### Low voltage oscillations

During operations of a prototype using FE-I4A chips, it was observed that oscillations of the LV input line could be instigated under certain operating conditions. Specifically, the oscillations could start if the operating threshold was too low (more precisely, if the threshold-to-noise ratio was too low) either during configuration or during operation, if too many consecutive bunch crossings were read out for a given trigger signal, or if too many pixels fire in a given event. An example of the oscillation, as observed on an oscilloscope when using differential probes to measure the input LV to the stave, can be observed in Figure 33. In this figure, the bottom trace is the LV differential signal, and the top trace is the cyclic input trigger. It is easy to see that the \(\sim 100\) mV oscillation observed at the center of the figure starts only once the triggering begins (though not always on the second trigger), and studies showed that the observance of the oscillation was independent of the trigger frequency. It should be noted that the apparent 50 mV oscillation before the triggering begins is due to the relatively long wires of the differential probe and

Figure 31: ToT distribution of multi-hit clusters from \({}^{90}\)Sr scans before and after charge calibration.

Figure 32: Eye patterns of a chip with (a) right and (b) wrong LVDS settings.

disappears with shorter cable lengths. This oscillation was observed under many data-taking settings, including cosmic trigger, cyclic trigger, and self-trigger scans. In each case, once the oscillation began, the read-out the FE modules powered by the oscillating LV line showed a nearly full pixel hit occupancy.

The occurrence of the oscillation is believed to be due to the presence of current transients on the chips. The chips are designed for low power consumption only powering the active part of the electronics. Larger current transients can lead to a positive feed-back loop, whereby the transients causes more pixels to fire and these fired pixels draw current9 which adds to the transient current. These large transients on the digital power can couple to the analog power thus causing new pixels to fire.

Footnote 9: The digital power increases when a pixel has a hit to keep power consumption low under the assumption of low occupancy.

For stave QA, both the analog and digital voltage for the chips are supplied as a single LV line, thus directly linking the analog and digital LV and grounds together. In addition, unlike the IBL FE-I4B production chips which use on-chip digital and analog regulators, no such regulators were used on the FE-I4A. As a result, any large transients produced by large digital activity could easily lead to the oscillations. In contrast, this effect is almost completely mitigated on the IBL production staves using the FE-I4B chips. The on-chip regulators essentially decouple the analog and digital powering, and oscillations are not observed under any of the aforementioned data-taking conditions. In addition, during the configuration step where large transients are known to be possible, the threshold of the pixels are set to their maximum value to stop any spurious firing of the pixels.

### Noise on double-chip sensors with dead front-end

In the case where one of the two front-ends of an IBL planar double-chip sensor is non-functional, the threshold noise on the working front-end was observed to be larger than expected. In addition, it was seen that the noise per pixel showed a gradient across the front end, such that the noise was higher for pixels closer to the non-functional front-end. While all modules on the staves used for the IBL are functional, staves 07 and 08 have some non-functional chips and thus are used here to illustrate this behavior. Figure 34 shows the noise on a front-end of stave 07 which has a neighboring non-functional chip.

## 7 Conclusions

The IBL stave QA has been successfully completed in time for the installation of the new innermost layer for the ATLAS Pixel Detector. A test stand at CERN has been built to qualify and rank the assembled

Figure 33: Oscillations on LV line (yellow) of Stave-0A when triggered by cyclic trigger (blue) and reading out 14 BC‚Äôs per trigger.

staves before integration onto the new beam pipe. The QA procedure allows a detailed characterization of the staves including calibration in cold conditions and data taking with radioactive sources. The collected results will serve as reference data to the imminent commissioning and operation of the IBL. Numerous lessons have been learned and serve as guidelines for future projects. In total, 20 staves have been tested, 18 have been fully qualified and ranked, and 14 staves have been selected for integration, mainly based on the number of bad pixels measured in the setup weighted by their position on the stave, leading to an operational IBL fraction of over 99.9%.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) S08003.
* [2] ATLAS Collaboration, _ATLAS pixel detector electronics and sensors_, JINST **3** (2008) P07007. [http://iopscience.iop.org/1748-0221/3/07/P07007/](http://iopscience.iop.org/1748-0221/3/07/P07007/).
* [3] M. Capeans et al., _ATLAS Insertable B-Layer Technical Design Report_, Tech. Rep. CERN-LHCC-2010-013. ATLAS-TDR-19, CERN, Geneva, Sep, 2010.
* [4] V. Zivkovic et al., _The FE-I4 pixel readout system-on-chip resubmission for the insertable B-Layer project_, Journal of Instrumentation **7** no. 02, (2012) C02050. [http://stacks.iop.org/1748-0221/7/i=02/a=C02050](http://stacks.iop.org/1748-0221/7/i=02/a=C02050).
* [5] ATLAS IBL Collaboration, J. Albert et al., _Prototype ATLAS IBL Modules using the FE-I4A Front-End Readout Chip_, JINST **7** (2012) P11010, arXiv:1209.1906 [physics.ins-det].
* [6] A. B. Poy et al., _The detector control system of the ATLAS experiment_, Journal of Instrumentation **3** no. 05, (2008) P05006. [http://stacks.iop.org/1748-0221/3/i=05/a=P05006](http://stacks.iop.org/1748-0221/3/i=05/a=P05006).
* [7] S. Kersten et al., _Detector Control System of the ATLAS Insertable B-Layer_, Conf. Proc. **C111010** (2011) MOPMS021. 4 p.
* [8] The ROOT team, "The ROOT Users Guide." [http://root.cern.ch/drupal](http://root.cern.ch/drupal).
* [9] M. Backhaus, _High bandwidth pixel detector modules for the ATLAS Insertable B-Layer_. PhD thesis, Bonn U., Bonn, Feb, 2014.

Figure 34: Per pixel noise of a stave 07 front-end whose neighbor on the double-chip module is dead.