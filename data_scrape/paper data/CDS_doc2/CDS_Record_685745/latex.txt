**ATLAS Internal Note DAQ-NO-028**

**15 January 1995**

**ATLAS TRIGger PERFORMANCE: ELECTRON/PHOTON TRIGGERS AT LEVEL 2**

**J. Bystricky, T. Hansl-Kozanecka, R. Hubbard, and B. Thooris**

CEA, DSM/DAPNIA

CE-Saclay, F-91191 Gif-sur-Yvette Cedex, France

**INTRODUCTION**

A study of the ATLAS Level 2 electron/photon triggers has been performed for the ATLAS Technical Proposal. Level-1 filtered events were used as input to the Level 2 study. About 10,000 events were selected with a 15-GeV filter; this sample corresponds to about 500,000 dijet events generated with \(P_{t}>17\) GeV within \(|\eta|<2.7\). Trigger selection criteria and trigger rates have been determined for low-luminosity (\(10^{33}cm^{-2}s^{-1}\)) and high-luminosity (\(10^{34}cm^{-2}s^{-1}\)) interactions.

This study is part of a larger study carried out by the members of the ATLAS Trigger Performance Working Group, with the objective of determining the trigger requirements, trigger conditions, and trigger rates required by the ATLAS physics program described in the ATLAS Technical Proposal\({}^{1}\). The muon trigger is described in Ref. [2] for the Level 1 trigger, and in Ref. [3] for Level 2. The jet trigger was simulated using a fast simulation program, as described in Ref. [4]. The Level 1 electron/photon triggers which form the input to the present study are described in Ref. [5].

###### Abstract

The detector layout used for the electron/photon trigger simulations differs from the detector layout in the Technical Proposal in several ways. The electromagnetic liquid-Argon accordion calorimeter is modeled as a parallel-plate liquid-Argon calorimeter for this study. The calorimeter granularity is.025 \(\times\).025 for \(|\eta|<3\) for the electromagnetic calorimeter and.10 \(\times\).10 for \(|\eta|<3\) for the hadronic calorimeter. The barrel/endcap transition is at \(|\eta|=1.4\). The preshower detector is taken as an independant preshower within the liquid argon volume, after the solenoid coil. The preshower detector consists of two preshower planes: \(\phi\) strips after two radiation lengths, and \(\eta\) strips after three radiation lengths. The granularity of the \(\phi\) (\(\eta\)) strips is \(\delta\eta\times\delta\phi\) =.10 \(\times\).002 (.002 \(\times\).10) in the barrel region, and.10 \(\times\).003 (.003 \(\times\).10) in the endcaps. The tracker is the Cosener's House design[6] with three sets of Transition Radiation detectors in the central region, and with silicon strip layers before and after the TR detectors.

## Chapter 1 Detector layout and data samples

### ATLAS detector layout

The detector layout used for the electron/photon trigger simulations differs from the detector layout in the Technical Proposal in several ways. The electromagnetic liquid-Argon accordion calorimeter is modeled as a parallel-plate liquid-Argon calorimeter for this study. The calorimeter granularity is.025 \(\times\).025 for \(|\eta|<3\) for the electromagnetic calorimeter and.10 \(\times\).10 for \(|\eta|<3\) for the hadronic calorimeter. The barrel/endcap transition is at \(|\eta|=1.4\). The preshower detector is taken as an independant preshower within the liquid argon volume, after the solenoid coil. The preshower detector consists of two preshower planes: \(\phi\) strips after two radiation lengths, and \(\eta\) strips after three radiation lengths. The granularity of the \(\phi\) (\(\eta\)) strips is \(\delta\eta\times\delta\phi\) =.10 \(\times\).002 (.002 \(\times\).10) in the barrel region, and.10 \(\times\).003 (.003 \(\times\).10) in the endcaps. The tracker is the Cosener's House design[6] with three sets of Transition Radiation detectors in the central region, and with silicon strip layers before and after the TR detectors.

### Dijet data sample

A million jets (500,000 dijet events) have been generated using PYTHIA Version 5.7[7]. The jets were generated with \(|\eta|<2.7\) and with \(P_{t}>17\) GeV or \(P_{t}>35\) GeV, for the different simulation runs. Isolated single photons, vector bosons, and top quarks were included in the simulations. The total cross-section simulated was 0.346 mb for \(P_{t}>17\) GeV and 0.035 mb for \(P_{t}>35\) GeV. The full GEANT simulation[8] was carried out for events passing a particle-level filter which required \(E_{t}>17\) GeV or 35 GeV incident in a region \(\delta\eta\times\delta\phi\) = 0.12 \(\times\) 0.12 or 0.20 \(\times\) 0.20. In order to study Level 2 trigger algorithms, separate tapes were produced with events passing more restrictive Level-1 electron/photon trigger filters with \(E_{t}>15\) GeV or \(E_{t}>35\) GeV with electromagnetic and hadronic isolation cuts.

Minimum-bias background events were generated separately, and the tracking hits and calorimeter energy deposits were added to the data for the filtered dijets. The number of events expected in a 25 ns gate is 1.8 at low luminosity (\(10^{33}\)) and 18 at high luminosity (\(10^{34}\)). On the other hand, the signal timing is not perfect for the calorimeter and the TRT. Calorimeter trigger signals must be timed to better than 25 ns, but the baseline recovery requires roughly 50 ns; small signals will contribute to the background levels during two bunch crossings. The maximum TRT drift time is 38 ns, and this increases the signal rate by about30%. Therefore, the TRT data is best simulated by assuming 2.3 events per trigger at low luminosity and 23 events at high luminosity.

The low-luminosity trigger rates reported here were based on the analysis of 10,543 events passing the Level-1 filter with \(E_{t}>15\) GeV, and 800 events with \(E_{t}>35\) GeV. These data samples correspond to 1.0 event/nb for \(E_{t}>15\) GeV (1.0 Hz/event at \(10^{33}\)), and 2.5 event/nb for \(E_{t}>35\) GeV (0.4 Hz/event at \(10^{33}\)). Most of the studies reported here were performed in a restricted volume with \(|\eta|<0.6\); in this restricted volume, our sample corresponds to 4.2 Hz/event at \(10^{33}\) for the Level-1 filtered events with \(E_{t}>15\) GeV, and 1.67 Hz/event for \(E_{t}>35\) GeV. No min-bias events were included for the low-luminosity analyses.

The high-luminosity trigger rates were simulated by including 18 min-bias events with each of the filtered events. The analysis was based on 6,672 events passing the Level-1 filter with \(E_{t}>15\) GeV (15 Hz/event at \(10^{34}\)), and 800 events with \(E_{t}>35\) GeV (4 Hz/event at \(10^{34}\)). For the restricted volume with \(|\eta|<0.6\), this sample corresponds to 62 Hz/event at \(10^{34}\) for the events with \(E_{t}>15\) GeV, and 16.7 Hz/event for \(E_{t}>35\) GeV.

### Electron/photon data samples

Trigger efficiencies were measured using single photons and single electrons generated with the same detector layout. The tracking code for the trigger simulations was available only for \(|\eta|<0.8\). Event samples containing about 240 electrons or photons in a more restrictive volume with \(|\eta|<0.6\) were used to measure trigger efficiencies at low luminosity (\(10^{33}\)) and samples of about 120 events with \(|\eta|<0.6\) were used at high luminosity (\(10^{34}\)). Trigger efficiencies were measured at 20, 40, 60, and 100 GeV for electrons, and at 20 and 40 GeV for photons.

### Trigger simulation program

The trigger simulation program followed the trigger design, with Level 1 and Level 2 trigger processing[9]. The Level 1 processing simulates the actual Level 1 hardware, and sends RoI information banks to the Level 2 supervisor routine. The Level 2 algorithms have not been optimized, and latencies have only been estimated. Further studies will be necessary to determine how much preprocessing will be necessary in the Level 2 buffers.

**TRIGger ALGORITHMS AT LOW LUMINOSITY**

**Level 1 electron/photon trigger**

The Level-1 electron/photon cluster-finding algorithm [10] is illustrated in Fig. 1. The algorithm is based on trigger cells with \(\delta\eta\times\delta\phi=0.1\times 0.1\). The cluster energy is the highest energy in any two neighboring cells within a 2 \(\times\) 2 cell core; the EM isolation energy is the energy in the 12 cells surrounding the 4-cell core. The hadronic isolation energy is the energy in the 16 HAC cells immediately behind the EM region.

The ATLAS physics program requires good efficiency at low luminosity for single electrons above 20 GeV, and for di-photons above 20 GeV. There is no special physics requirement for the threshold for a single-photon trigger. For the Level 1 trigger, the \(E_{t}\) threshold for electron/photon candidates is set at 15 GeV to assure good efficiency at 20 GeV. The EM isolation energy is required to be less than 5 GeV, and the hadronic isolation energy is required to be less than 2 GeV. The electron/photon trigger rate at low luminosity is about 10 kHz, including 350 Hz of di-photon candidates [5].

**Level 2 selection criteria**

The Level 2 trigger must reduce the Level 1 rate from 10 kHz to at most 500 Hz for all.electron/photon triggers, while maintaining 90% efficiency for electrons and photons. The calorimeter and preshower shape parameters [11],[12] give a rejection factor of about 6 for each photon candidate, and the tracking gives an additional rejection factor of 10 for the electron candidates [13],[14]. The algorithms and rejection factors will be described in detail in the following sections. The final trigger rate for single electrons above 20 GeV is 180 Hz. The final trigger rate for di-photons above 20 GeV is about 10 Hz. The single-photon trigger rate is 60 Hz for a threshold at 40 GeV.

**Calorimeter shape parameters**

The Level 1 calorimeter trigger uses 0.1 \(\times\) 0.1 trigger cells, both in the hadronic and electromagnetic calorimeters, with a least-count on the trigger-cell energy-deposit of 1 GeV. The dijet rejection for electron/photon triggers can be improved at Level 2 by using the fine granularity of the electromagnetic calorimeter and the improved energy resolution.

A series of possible shape parameters is shown in Fig. 2 for electrons of 20 GeV. Cluster sizes ranging from 3\(\times\)3 EM cells (\(\delta\eta\times\delta\phi=0.075\times\)0.075) to 9\(\times\)9cells (\(\delta\eta\times\delta\phi=0.225\times 0.225\)) were considered. The tails are much more important when the signal is restricted to three bins in \(\eta\) or \(\phi\). The same quality factors are shown in Fig. 3 for filtered jets with \(E_{t}>15\) GeV. A factor four rejection against dijet events passing the Level 1 trigger is possible with 90% efficiency for the 20 GeV electrons at low luminosity, using the ratio \((5\times 7)/(7\times 9)\).

### Preshower algorithms

The preshower algorithm requires a narrow "profile" for the preshower energy deposit. We have used only the profile in \(\eta\), because the most likely preshower design has only \(\eta\) strips. The comparison has to be updated, because the ATLAS preshower will be integrated into the EM calorimeter, whereas the preshower in the dijet simulations was an independant preshower.

We use a profile defined as the maximum energy deposit in \(\delta\eta=0.006\) divided by the energy deposit in \(\delta\eta=0.048\). This corresponds to 3 strips out of 24 in the barrel region, and 2 strips out of 16 in the endcaps. For 90% electron efficiency at 20 GeV, this cut gives a rejection factor of two at low luminosity.

The algorithm must be modified for photon candidates, because nearly 15% of the photons convert only after the independant preshower detector. The photon algorithm requires that the energy deposit be small (less than about 0.1 GeV) or that the profile be narrow, or both.

The preshower parameters for 20 GeV electrons and for dijet events at low luminosity are shown in Fig. 4 and Fig. 5. The same parameters are shown in Fig. 6 for 20 GeV photons; the sharp peak for very narrow profiles is due to late photon conversions in which very little energy is deposited in the preshower detector.

### Transverse energy cut

The best estimate of the transverse EM energy is obtained by combining the energy measured in the EM calorimeter with the energy measured in the preshower detector. We have used weighting factors for the preshower and for the EM calorimeter that depend on \(|\eta|\), with three \(|\eta|\) regions in each half-barrel, and three \(|\eta|\) regions in each endcap. The preshower energy includes all the energy deposited in the RoI (0.3\(\times\)0.3). The EM energy is measured in 9\(\times\)9 EM cells (0.225\(\times\)0.225). The transverse energy thus obtained has been multiplied by a parabolic correction factor to remove a residual \(\eta\)-dependance. This calibration was performed for 40 GeV electrons; the energy spectrum as a function of \(\eta\) is shown in Fig. 7 before and after the \(\eta\)-dependant correction.

Further calibration studies are still necessary. The transverse energy distributions in Fig. 8 show that the energy is overestimated at lower \(E_{t}\) and underestimated at higher \(E_{t}\). We would expect improved rejection from the calorimeter with a better energy calibration.

### Transition Radiation Tracker

The trigger code[15] for the TRT was available only for the central region with \(|\eta|<0.8\). We have limited our electron/photon studies to the region \(|\eta|<0.6\) to avoid inefficiencies at the edge of the barrel TRT.

The TRT rejection depends on discrete values (the number of hits, the number of high-energy hits, the fraction of hits with TR drift time within a narrow road, and the number of empty straws) and on track parameters (\(P_{t}\), \(\eta\), \(\phi\), and chi-squared). The present study does not consider TRT inefficiencies other than those due to the presence of tracks from the underlying event and from min-bias background.

All tracks found in the TRT (including "ghosts") are considered as candidates for the trigger algorithms. A preselection based on the trigger cuts is used to select the "best" trigger candidate.

The discrete TRT parameters for these trigger candidates are shown in Fig. 9 for 20 GeV electrons at low luminosity. The same distributions are shown in Fig. 10 for jets passing the 15 GeV filter. Trigger algorithms typically require more than 20 hits on the track, at least three or four high-energy hits (compatible with transition radiation), and no more than two empty straws.

The TRT \(P_{t}\) distribution and the ratio \(P_{t}/E_{t}\) is shown for the 20 GeV electrons in Fig. 11. About 90% of the tracks have \(P_{t}\) above 14 GeV/c. The \(P_{t}\) of the background events peaks at much lower energy, as shown in Fig. 12. The difference between the \(\phi\) value of the TRT track at the calorimeter and the \(\phi\) value of the central cell in the EM calorimeter energy cluster is shown in the same figures. The TRT selection criteria alone provide a rejection factor of about 10 for 90% electron efficiency at 20 GeV.

### Silicon Tracker

The Silicon tracker \(P_{t}\) and \(\phi\) are shown in Fig. 13 for 20 GeV electrons at low luminosity, and in Fig. 14 for filtered jets with \(E_{t}>15\) GeV. The silicon tracker alone gives a rejection factor of about 6 for 90% electron efficiency at 20 GeV.

### Level 2 electron trigger rates

The electron trigger rates have been calculated for electron efficiency of 90%at each of our calibration points: 20, 40, 60, and 100 GeV. Fig. 15 shows the energy spectrum for jets from the 15 GeV filter passing 20 GeV photon and electron selection criteria. Fig. 16 shows the same distributions for jets from the 35 GeV filter passing the 40 GeV selection criteria.

The selection criteria used for different electron \(E_{t}\) thresholds are given in Table 1. Selection criteria at 30 GeV and at 80 GeV were obtained by assuming smooth variations for each parameter. The trigger rates corresponding to the selection criteria in Table 1 are given in Table 2, assuming a luminosity of 10\({}^{33}\), but without adding min-bias events. We have studied possible variations in the selection criteria at 30 GeV due to different interpolations from the calibration data at 20 and 40 GeV; they do not result in significant variations in the trigger rate at low luminosity.

The trigger rate in Table 2 for the 20 GeV single-electron trigger threshold at low luminosity is 180 \(\pm\) 30 Hz for 90% electron efficiency. This is compatible with the high-\(P_{t}\) physics goals indicated above.

### Particle identification

The most energetic particle in the electron RoI has been identified using the GEANT KINE banks. For the 20 GeV threshold, 50% of the Level 2 electron triggers come from photon conversions from pi-zero decays, 25% come from electrons, and the remaining 25% come from charged hadrons. When the electron trigger threshold is raised to 30 GeV, 40% of the triggers come from photon conversions (2 events out of the 5 events passing the 30 GeV trigger conditions), and the other 60% are real electrons.

### Level 2 photon trigger rates

The photon trigger rates have been calculated for photon efficiency of 90% at two calibration points: 20 and 40 GeV. The trigger rate for the 40 GeV threshold can be determined by combining the jet data from the 15 GeV and 35 GeV filters; the two data samples give compatible trigger rates for the 40 GeV threshold.

The single-photon trigger rates at low luminosity are given in Table 2, for 90% photon efficiency above the trigger threshold. We choose a single-photon \(E_{t}\) threshold of 40 GeV to keep the photon trigger rate below the single-electron rate. This single-photon trigger rate is 60 \(\pm\) 10 Hz for luminosity 10\({}^{33}\) (with no min-bias).

For the di-photon trigger rates, we have an estimate only for the threshold at 20 GeV. We found four photon pairs in the 15 GeV jet sample, for \(|\eta|<2.5\). These four events give a trigger rate at luminosity 10\({}^{33}\) of 4 \(\pm\) 2 Hz.

## 0.4 Trigger Algorithms at High Luminosity

### Level 1 electron/photon Trigger

At high luminosity, we require good efficiency for single electrons above 30 GeV in order to assure good efficiency for inclusive \(W\) and \(Z\) bosons. The di-photon trigger threshold is maintained at 20 GeV as required for the \(H\rightarrow\gamma\gamma\) search. For the Level 1 trigger, the \(E_{t}\) threshold is set at 25 GeV for single electron/photon candidates, and at 15 GeV for electron/photon pairs. The EM isolation energy is required to be less than 10 GeV, and the hadronic isolation energy is required to be less than 2 GeV. The electron/photon trigger rate at high luminosity is 24 kHz, including about 4 kHz for the di-photon candidates [5].

### Level 2 selection criteria

The Level 2 trigger must reduce the Level 1 rate from 24 kHz to below 1 kHz for all electron/photon triggers, while maintaining acceptable efficiencies for electrons and photons. At high luminosity, the calorimeter and preshower shape parameters give a rejection factor of about 4 for 90% single-photon efficiency at 20 GeV. For a photon \(E_{t}\) threshold at 30 GeV, the shape parameters give a rejection factor of about 12 for 90% photon efficiency, or a factor 35 for 80% efficiency. Including the tracking we obtain a combined rejection factor of about 70 for 80% electron efficiency at 30 GeV. The final trigger rate for single electrons above 30 GeV is 280 Hz. The final trigger rate for di-photons above 20 GeV is about 220 Hz. The single-photon rate is about 100 Hz for a threshold at 60 GeV.

### Calorimeter and preshower shape parameters

The calorimeter shape parameters for 20 GeV electrons and for jets passing the 15 GeV filter at high luminosity are shown in Fig. 17 and Fig. 18. The shape parameter distributions are only slightly degraded compared to those at low luminosity (Fig. 2 and Fig. 3). Similarly, the preshower shape parameters at high luminosity (Fig. 19 and Fig. 20) are not much different from the equivalent distributions at low luminosity (Fig. 4 and Fig. 5).

Overall, the calorimeter and preshower shape parameters give rejection factors for 80% efficiency at high luminosity close to the rejection factors obtained for 90% efficiency at low luminosity. For 30 GeV photons, the rejection factor at high luminosity is about a factor 12 for 90% photon efficiency and about a factor 35 for 80% efficiency.

**Transition Radiation Tracker**

At high luminosity, the number of TRT track candidates increases considerably compared to the situation at low luminosity. Only one of these track candidates is selected for the analysis of the electron candidates, so the initial selection criteria are important. The EM and PS energy and position are used in the selection of the track candidate to be retained, but this track candidate will not always be the best track with respect to the final selection criteria used. Further analysis should lead to lower trigger rates, for the same minimum-bias background, than the values quoted here.

The discrete TRT parameters for 20 GeV electrons at high luminosity are shown in Fig. 21. The same distributions are shown in Fig. 22, for jets passing the 15 GeV filter. The effect of the initial trigger selection criteria is obvious in Fig. 21(a), where we see a sharp step in the distribution of the number of empty straws above the "acceptable" value of two. The other striking change in these distributions is the degradation of the distribution of in-time hits; at low luminosity, we can require the fraction of in-time hits to be above 0.7, but at low luminosity, the distribution extends down to 0.4, where the rejection power is negligeable.

The TRT \(P_{t}\) and \(\phi\) distributions are also degraded, as shown in Fig. 23 and Fig. 24. The TRT track provides a rejection of about a factor 5 for 90% electron efficiency at 30 GeV, and a factor 10 for 80% efficiency.

**Silicon Tracker**

The silicon tracker is less affected at high luminosity than the TRT because the occupancy is lower. The silicon track parameters for 20 GeV electrons at high luminosity are shown in Fig. 25. The same distributions are shown for jets passing the 15 GeV filter in Fig. 26. A rejection factor of 4 is obtained from the Silicon tracker for 90% electron efficiency at 30 GeV, and a factor of 12 for 80% efficiency.

**Level 2 electron trigger rates**

Fig. 27 and Fig. 28 show the energy spectrum for jets from the 15 GeV filter passing 20 GeV photon and electron selection criteria for 90% and 80% efficiency, respectively. Fig. 29 and Fig. 30 show the same distributions for jets from the 35 GeV filter passing the 40 GeV selection criteria. The selection criteria used at different electron energies are given in Table 3. Reasonable variations in the selection criteria at 30 GeV result in variations in the trigger rate at high luminosity by about a factor two.

The trigger rates at high luminosity are shown in Table 4 for 90% and 80% trigger efficiencies. We have chosen a single-electron trigger threshold at 30 GeV with 80% trigger efficiency in order to obtain an acceptable trigger rate and maintain reasonable efficiency for inclusive \(W\) and \(Z\) bosons. The trigger rate is 280 \(\pm\) 140 Hz at luminosity \(10^{34}\) (with 18 min-bias events).

### Particle identification

The identification of the most energetic particle in the electron RoI from the GEANT KINE banks shows that the main effect of the increased background level is to increase the number of jets faking the electron trigger. The number of electrons giving electron triggers is unchanged, but the number of jets faking an electron trigger increases by a factor of 10 to 20 for 90% electron efficiency. The increased trigger rate is mainly due to the looser trigger criteria required to maintain high efficiency in the presence of increased background. Dijet rejection factors comparable to the low-luminosity rejection factors have been obtained by tightening the selection criteria and accepting lower electron efficiencies. For 80% electron efficiency, 66% of the triggers are due to photon conversions, 17% are real electrons, and the remaining 17% are due to hadrons.

### Level 2 photon trigger rates

The single-photon trigger rates at high luminosity are given in Table 4, for 90% and 80% photon efficiency. We choose a single-photon \(E_{t}\) threshold of 60 GeV and obtain a trigger rate of 100 \(\pm\) 40 Hz for luminosity \(10^{34}\) (with 18 min-bias events).

Using the same di-photon trigger conditions we used at low luminosity, with a trigger threshold of 20 GeV for each of the two photons, we find 15 photon pairs at high luminosity, compared to the 4 events we found at low luminosity in a larger data sample. The trigger rate is 225 \(\pm\) 60 Hz, with 90% efficiency for each of the photons (81% di-photon trigger efficiency).

## 1 Future Projects

### Low luminosity with min-bias

As mentioned earlier, no min-bias events were included for the low-luminosity studies reported here. However, a sample of 20 GeV and 40 GeV electrons and a small sample of dijet events (1200 dijet with \(E_{t}>\) 17 GeV passing the 15GeV filter, and 200 dijet events with \(E_{t}>35\) GeV passing the 35 GeV filter) were re-analyzed with 2.3 min-bias events. No significant differences appeared on an event-by-event basis. This analysis will be performed on the full data samples (with 1.3 min-bias events in addition to the trigger event) to refine the low-luminosity selection criteria and trigger rates.

### High luminosity with pulse shapes

The high-luminosity studies were performed with 18 min-bias events, whereas the TRT occupancy for luminosity \(10^{34}\) would correspond to 23 events in a trigger window because the maximum drift time of 38 ns exceeds the 25 ns bunch-crossing time. The calorimeter timing will eliminate large background pulses from min-bias background, but small pulses will contribute to the calorimeter noise during two beam crossings (average of 36 events). We have re-analyzed the electron and dijet samples mentioned above (1200 dijets with \(E_{t}>17\) GeV and 200 dijets with \(E_{t}>35\) GeV) with 23 min-bias events. In this high-luminosity case, the results are significantly different from those obtained with 18 min-bias events. The electron efficiency goes from 80% to 70% with the same selection criteria, whereas nearly as many events pass the trigger conditions with 23 min-bias events as with 18 min-bias events (19 events pass the 20 GeV trigger conditions with 18 min-bias events, and 15 events pass the trigger conditions with 23 min-bias events). We intend to perform this analysis on the full data sample (with 22 min-bias events in addition to the trigger event), and we intend to look at the calorimeter performance with 35 min-bias events.

### Improved tracking algorithms

Recently an error has been corrected in the projection of the silicon tracks onto the calorimeter. The difference between the \(\phi\) of the silicon track at the calorimeter and the \(\phi\) of the TRT track is shown in Fig. 31, before and after the correction, for 20 GeV electrons at low luminosity.

In spite of the striking narrowness of this distribution, the rejection obtained with the corrected program at low luminosity is only slightly higher than the rejection obtained using the differences between the \(\phi\) of the TRT and SIT tracks and the \(\phi\) of the central calorimeter bin. The high efficiency of the individual track matches is due to the fact that most of the electron triggers at low luminosity are associated with real tracks coming from electrons or from photon conversions.

On the other hand, preliminary studies indicate that we can obtain a significant reduction in the trigger rates at high-luminosity (roughly a factor 3 reduction at 20 GeV for 90% electron efficiency) by using the track match between the TRT track and the SIT track, once the SIT track extrapolation is corrected. Weintend to continue work on the tracking algorithms to try to reduce the excess fake trigger rate observed at high luminosity when the min-bias background is included.

### Algorithm execution times

The Level 2 trigger algorithm execution times were not evaluated in this study. The high-luminosity trigger simulation required two seconds per event on a HP735 computer, but the vast majority of this time was used to fetch and store the data in the Level 2 data buffers. We intend to perform detailed studies of the execution times of the Level 2 trigger algorithms, with separate studies for data handling and for processing. One of the objectives of this study will be to try to determine how much preprocessing will be necessary in the Level 2 buffers.

## Conclusions

The Level 2 electron/photon trigger rates obtained in this study satisfy the ATLAS physics requirements for low luminosity and high luminosity running conditions. At low luminosity (\(10^{33}\)), the studies were performed without min-bias background events. At high luminosity (\(10^{34}\)), 18 min-bias events were included. The single-electron \(E_{t}\) threshold was set to 20 GeV at low luminosity and 30 GeV at high luminosity to meet the ATLAS physics requirements. The single-photon \(E_{t}\) threshold was set to 40 GeV at low luminosity and 60 GeV at high luminosity in order to control the trigger rates. The single electron and single photon efficiencies at the nominal threshold were required to be 90% at low luminosity, but they were set to 80% at high luminosity in order to meet the physics requirements on the electron \(E_{t}\) threshold. The di-photon threshold was kept at 20 GeV and the di-photon efficiency was kept at 90% at low and at high luminosity, as required by the \(H\rightarrow\gamma\gamma\) search. The overall Level 2 electron/photon trigger rates were about 250 Hz at low luminosity, and about 600 Hz at high luminosity.

## References

* [1] ATLAS Technical Proposal, Chapt. 11, CERN/LHCC/94-43, 15 December 1994.
* [2] L. Nisati, et al., ATLAS Internal Note DAQ-NO-38 (1994).
* [3] G. Ambrosini, et al., ATLAS Internal Note MUON-NO-61 (1994).
* [4] J. Bystricky, ATLAS Internal Note DAQ-NO-29 (1994).
* [5] I. P. Brawn, et al., ATLAS Internal Note DAQ-NO-30 (1994).
* [6] The ATLAS Collaboration, "The ATLAS Inner Detector", ATLAS Internal Note GEN-No-004, 31 March 1993.
* [7] T. Sjostrand, Computer Physics Commun. 82 (1994) 74; T. Sjostrand, CERN-TH 7112/93, rev. August 1994.
* [8] D. Froidevaux, M. Nessi, and A. Henriques, "Our Proposal for Jet Generation for ATLAS", ATLAS Internal Note DAQ-TR-201, 6 December 1993.
* [9] J. Baines, et al., ATRIG 1.00 ATLAS Trigger Simulation Guide, Rev 0.000, December 1994. The latest version is available using WWW via [http://www.cern.ch/RD11/physics/atrig.html](http://www.cern.ch/RD11/physics/atrig.html)
* [10] RD27 Status Report, First-Level Trigger Systems for LHC Experiments, CERN/DRDC/93-32, 11 August 1993.
* [11] J. Carter, Z. Hajduk, K. Korcyl, and J. Strong, "A Second Level Calorimeter Trigger Algorithm", ATLAS Internal Note DAQ-NO-009, 12 January 1993; J. C. Chollet, D. Froidevaux, M. Nessi, and L. Poggioli, "Electron Isolation with ATLAS", ATLAS Internal Note PHYS-NO-017, 15 February 1993.
* [12] Fabiola Gianotti, "Calorimeter/Preshower Scenario in ATLAS", ATLAS Internal Note DAQ-TR-197, 2 November 1993.

* [13] D. Froidevaux, P. Nevski, and M. Stavrianakou, "Study of Charged Hadron Rejection with the RD3 LAr Calorimeter and the RD6 TRD tracker Prototypes", ATLAS Internal Note INDET-NO-020, 18 January 1993.
* [14] RD2 and RD11 Collaborations, "A Study of a Second Level Track Trigger for ATLAS", Univ. of Oxford Report OUNP-93-07, submitted to Nucl. Instr. Meth.
* [15] The TRT trigger code was prepared by P. Eerola, based on the ATRECON code written by I. Gavrilenko.

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline \(E_{t}\) threshold (GeV) & 20 & 30 & 40 & 60 & 80 & 100 \\ \hline EM+PS \(E_{t}\) (GeV) & \(>\) & 18 & 28 & 38 & 57 & 75 & 93 \\ EM \((5\times 5)/(9\times 9)\) & \(>\) &.80 &.82 &.84 &.86 &.88 &.90 \\ HA \(E_{t}\) (GeV) & \(<\) & 2 & 2 & 2 & 2 & 2 & 2 \\ \hline PS \(E_{t}\) (GeV) & \(>\) &.10 &.10 &.10 &.10 &.10 \\ PS \(E_{t}(.006)/E_{t}(.048)\) & \(>\) &.40 &.45 &.50 &.50 &.50 \\ PS-EM \(\delta\eta\) & \(<\) &.05 &.05 &.05 &.04 &.035 &.03 \\ \hline TR total hits & \(>\) & 20 & 20 & 20 & 20 & 20 & 20 \\ TR high-E hits & \(\geq\) & 3 & 3 & 4 & 4 & 4 & 4 \\ TR empty straws & \(\leq\) & 3 & 3 & 3 & 3 & 3 & 3 \\ TR time-hits/total & \(>\) &.70 &.70 &.70 &.70 &.70 &.70 \\ TR/(EM+PS) \(P_{t}/E_{t}\) & \(>\) &.25 &.30 &.35 &.35 &.30 &.25 \\ TR-EM \(\delta\phi\) & \(<\) &.04 &.035 &.03 &.03 &.03 &.03 \\ \hline SI/(EM+PS) \(P_{t}/E_{t}\) & \(>\) &.35 &.35 &.35 &.35 &.30 &.25 \\ SI-EM \(\delta\phi\) & \(<\) &.06 &.05 &.04 &.04 &.04 &.04 \\ SI-EM \(\delta\eta\) & \(<\) &.20 &.15 &.10 &.10 &.10 &.10 \\ SI chi-squared & \(<\) & 5 & 5 & 5 & 5 & 5 & 5 \\ \hline \end{tabular}
\end{table}
Table 1: Selection criteria for single electrons at low luminosity (no min-bias events), for 90% electron efficiency at the nominal \(E_{t}\) threshold.

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|} \hline \(E_{t}\) threshold (GeV) & 20 & 30 & 40 & 60 & 80 & 100 \\ \hline \(e^{\pm}\) rate (Hz) \(\epsilon=90\%\) & \(180\pm 30\) & \(21\pm 9\) & \(7\pm 4\) & \(3\pm 2\) & \(2\pm 2\) & \\ \(\gamma\) rate (Hz) \(\epsilon=90\%\) & \(1620\pm 80\) & \(285\pm 35\) & \(60\pm 10\) & \(10\pm 4\) & \(3\pm 2\) & \(2\pm 2\) \\ \(\gamma\gamma\) rate (Hz) \(\epsilon=81\%\) & \(4\pm 2\) & & & & & \\ \hline \end{tabular}
\end{table}
Table 2: Electron and photon trigger rates at low luminosity (no min-bias events), for 90% single-electron and single-photon efficiency at the nominal \(E_{t}\) threshold. (Statistical errors only.)

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|c|} \hline \(E_{t}\) threshold (GeV) & 20 & 30 & 40 & 60 & 80 & 100 \\ \hline EM+PS \(E_{t}\) (GeV) & \(>\) & 18 & 28 & 38 & 56 & 74 & 93 \\ EM \((5\times 5)/(9\times 9)\) & \(>\) &.75 &.80 &.85 &.88 &.91 &.90 \\ EM \((3\times 5)/(5\times 7)\) & \(>\) &.85 &.87 &.90 &.92 &.93 &.94 \\ HA \(E_{t}\) (GeV) & \(<\) & 2 & 2 & 2 & 2 & 2 & 2 \\ \hline PS \(E_{t}\) (GeV) & \(>\) &.10 &.10 &.10 &.10 &.10 \\ PS \(E_{t}(.006)/E_{t}(.048)\) & \(>\) &.50 &.50 &.50 &.50 &.50 \\ PS-EM \(\delta\eta\) & \(<\) &.05 &.05 &.05 &.05 &.05 \\ \hline TR total hits & \(>\) & 20 & 20 & 20 & 20 & 20 \\ TR high-E hits & \(\geq\) & 4 & 4 & 4 & 4 & 4 & 4 \\ TR empty straws & \(\leq\) & 3 & 3 & 3 & 3 & 3 & 3 \\ TR time-hits/total & \(>\) &.40 &.40 &.40 &.40 &.40 \\ TR/(EM+PS) \(P_{t}/E_{t}\) & \(>\) &.35 &.35 &.35 &.33 &.25 &.20 \\ TR-EM \(\delta\phi\) & \(<\) &.15 &.10 &.05 &.05 &.05 &.05 \\ \hline SI/(EM+PS) \(P_{t}/E_{t}\) & \(>\) &.35 &.35 &.35 &.33 &.25 &.20 \\ SI-EM \(\delta\phi\) & \(<\) &.15 &.10 &.05 &.05 &.05 &.05 \\ SI-EM \(\delta\eta\) & \(<\) &.30 &.25 &.20 &.15 &.125 &.10 \\ SI chi-squared & \(<\) & 5 & 5 & 5 & 5 & 5 & 5 \\ \hline \end{tabular}
\end{table}
Table 3: Selection criteria for single electrons at high luminosity (18 min-bias events), for 80% electron efficiency at the nominal \(E_{t}\) threshold.

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|} \hline \(E_{t}\) threshold & 20 & 30 & 40 & 60 & 80 & 100 \\ \hline \(e^{\pm}\) rate (Hz) & \(\epsilon=90\%\) & \(20400\pm 1100\) & \(1650\pm 320\) & \(185\pm 55\) & \(50\pm 30\) & \(17\pm 17\) & \\ \(e^{\pm}\) rate (Hz) & \(\epsilon=80\%\) & \(4500\pm 530\) & \(280\pm 140\) & \(33\pm 23\) & & \\ \(\gamma\) rate (Hz) & \(\epsilon=90\%\) & \(34700\pm 1500\) & \(5600\pm 600\) & \(800\pm 100\) & \(185\pm 55\) & \(68\pm 34\) & \(17\pm 17\) \\ \(\gamma\) rate (Hz) & \(\epsilon=80\%\) & \(11000\pm 830\) & \(2100\pm 360\) & \(470\pm 80\) & \(100\pm 40\) & \(17\pm 17\) & \\ \(\gamma\gamma\) rate (Hz) & \(\epsilon=81\%\) & \(225\pm 60\) & & & & \\ \hline \end{tabular}
\end{table}
Table 4: Electron and photon trigger rates at high luminosity (18 min-bias events), for 90% and 80% efficiency at the nominal \(E_{t}\) threshold. (Statistical errors only.)Figure 1: Level 1 calorimeter trigger logic. The Level 1 trigger cells cover \(\delta\eta\times\delta\phi=0.1\times 0.1\) in both electromagnetic and hadronic calorimeters. The energy in two contiguous EM cells must exceed the trigger threshold, and the energy in 12 surrounding EM cells must be below the EM isolation threshold. The energy in the 16 corresponding hadronic cells must be below the hadronic isolation threshold.

**Fig. 2.** Quality factors for 20 GeV electrons at low luminosity (no min-bias). The sample shown contains 311 events with \(|\eta|<0.6\). The energy-deposit ratios are shown for \((3\times 3)/(5\times 5)\), \((5\times 5)/(9\times 9)\), \((3\times 5)/5\times 7)\), \((3\times 7)/(5\times 9)\), \((5\times 7)/(7\times 9)\), and \((5\times 7)/(9\times 9)\) EM cells, where each EM cell covers \(\delta\eta\times\delta\phi\) = 0.025 \(\times\) 0.025.

Figure 3: Quality factors for jets passing the 15 GeV filter, at low luminosity (no minbias). The sample shown contains 2591 events with \(|\eta|<0.6\). Only 2164 of these filtered events actually pass the current Level 1 trigger requirements.

Figure 4: Preshower parameters for 20 GeV electrons at low luminosity (no minbias), with \(|\eta|<0.6\). (a) Preshower energy deposit. (b) Preshower profile, \(E_{t}(.006)/E_{t}(.048)\). (c) Difference between \(\eta\) measured in the preshower and in the calorimeter. (d) Difference between \(\phi\) measured in the preshower and in the calorimeter.

Figure 5: Preshower parameters for jets passing the 15 GeV filter, at low luminosity (no min-bias), with \(|\eta|<0.6\).

**Fig. 6.** Preshower parameters for 20 GeV photons at low luminosity (no min-bias).

The sample shown contains 302 events with \(|\eta|<0.6\).

Figure 7: Transverse energy distributions (a) before and (b) after applying a parabolic \(\eta\)-dependant energy correction, for 40 GeV electrons with \(|\eta|<0.6\).

Figure 8: \(E_{t}\) distributions obtained by combining the \(E_{t}\) measured in the EM calorimeter with the \(E_{t}\) measured in the preshower detector, with \(\eta\)-dependant weights. \(E_{t}\) distributions are shown for single electrons at low luminosity (no min-bias) with \(|\eta|<0.6\). (a) Sample of 311 events with \(E_{t}=20\) GeV. (b) Sample of 304 events with \(E_{t}=40\) GeV. (c) Sample of 259 events with \(E_{t}=60\) GeV. (d) Sample of 240 events with \(E_{t}=100\) GeV.

Figure 9: Discrete TRT parameters for 20 GeV electrons at low luminosity (no min-bias). The sample contains 299 events with a TRT track, out of the 311 events with \(|\eta|<0.6\). (a) Number of hits on track. (b) Number of high-energy hits (possible transition radiation). (c) Number of empty straws in road. (d) Fraction of hits with drift-time within a narrow road.

Figure 10: Discrete TRT parameters for jets passing the 15 GeV filter, at low luminosity (no min-bias). The sample contains 807 events with a TRT track, out of the 2591 Level-1 filtered dijets with \(|\eta|<0.6\).

Figure 11: Continuous TRT parameters for 20 GeV electrons at low luminosity (no min-bias). (a) \(P_{\rm t}\) of the TRT track candidate. (b) \(P_{\rm t}/E_{\rm t}\), where \(E_{\rm t}\) is measured in the EM calorimeter and the preshower detector. (c) Difference between the track \(\phi\) at the calorimeter and the \(\phi\) of the central EM calorimeter cell.

Figure 12: Continuous TRT parameters for jets passing the 15 GeV filter, at low luminosity (no min-bias). The sample contains 807 events with a TRT track, out of the 2591 filtered dijets with \(|\eta|<0.6\) (2164 of these events satisfy the Level 1 trigger conditions). Only 210 of these events would satisfy all TRT trigger criteria corresponding to 90% electron efficiency at \(E_{t}=20\) GeV.

Figure 13: Silicon tracker parameters for 20 GeV electrons at low luminosity (no minbias). The sample contains 295 events with an SIT track, out of the 311 events with \(|\eta|<0.6\). (a) \(P_{t}\) of the SIT track candidate. (b) \(P_{t}/E_{t}\). (c) Difference between the track \(\eta\) and the \(\eta\) of the central calorimeter cell. (d) Difference between the track \(\phi\) at the calorimeter and the \(\phi\) of the central EM calorimeter cell.

Figure 14: Silicon tracker parameters for jets passing the 15 GeV filter, at low luminosity (no min-bias). The sample contains 678 events with an SIT track, out of the 2591 Level-1 filtered dijets with \(|\eta|<0.6\) Only 335 of these events would satisfy all SIT trigger criteria corresponding to 90% electron efficiency at \(E_{t}=20\) GeV.

Figure 15: \(E_{t}\) distributions for jets passing the 15 GeV filter, at low luminosity (no min-bias), with \(|\eta|<\) 0.6. (a) Sample of 2164 events passing the Level 1 trigger criteria with \(E_{t}>\)15 GeV, out of the 2591 events passing the original Level 1 filter. (b) Sample of 552 events with \(E_{t}>\)18 GeV passing calorimeter shape-parameter cuts. (c) Sample of 385 photon candidates passing calorimeter and preshower shape-parameter cuts. (d) Sample of 42 electron candidates passing calorimeter, preshower, and tracking cuts. These photon and electron cuts give 90% efficiency for photons or electrons with \(E_{t}>\)20 GeV.

[MISSING_PAGE_EMPTY:33]

Figure 17: Quality factors for 20 GeV electrons at high luminosity (18 min-bias events). The sample shown contains 116 events with \(|\eta|<\) 0.6. The energy-deposit ratios are shown for \((3\times 3)/(5\times 5)\), \((5\times 5)/(9\times 9)\), \((3\times 5)/5\times 7)\), \((3\times 7)/(5\times 9)\), \((5\times 7)/(7\times 9)\), and \((5\times 7)/(9\times 9)\) EM cells, where each EM cell covers \(\delta\eta\times\delta\phi\) = 0.025 \(\times\) 0.025.

Figure 18: Quality factors for jets passing the 15 GeV filter, at high luminosity (18 minbias events). The sample shown contains 1639 events with \(|\eta|<0.6\). Only 1342 of these events pass our current Level 1 photon trigger requirements (nominal \(E_{t}\) threshold 20 GeV).

Figure 19: Preshower parameters for 20 GeV electrons at high luminosity (18 minbias events), with \(|\eta|<0.6\). (a) Preshower energy deposit. (b) Preshower profile. (c) Difference between \(\eta\) measured in the preshower and in the calorimeter. (d) Difference between \(\phi\) measured in the preshower and in the calorimeter.

**Fig. 20.** Preshower parameters for jets passing the 15 GeV filter, at high luminosity (18 min-bias events), with \(|\eta|<0.6\).

Figure 21: Discrete TRT parameters for 20 GeV electrons at high luminosity (18 min-bias events). The sample contains 111 events with a TRT track, out of the 116 events with \(|\eta|<0.6\). (a) Number of hits on the track. (b) Number of high-energy hits (possible transition radiation). (c) Number of empty straws in road. (d) Fraction of hits with drift-time within a narrow road.

Figure 22: Discrete TRT parameters for jets passing the 15 GeV filter, at high luminosity (18 min-bias events). The sample contains 957 events with a TRT track, out of the 1639 Level-1 filtered dijets with \(|\eta|<0.6\).

Figure 23: Continuous TRT parameters for 20 GeV electrons at high luminosity (18 min-bias events), with \(|\eta|<0.6\). (a) \(P_{t}\) of the TRT track candidate. (b) \(P_{t}/E_{t}\), (c) Difference between the track \(\phi\) at the calorimeter and the \(\phi\) of the central EM calorimeter cell.

Figure 24: Continuous TRT parameters for jets passing the 15 GeV filter, at high luminosity (18 min-bias events). The sample contains 957 events with a TRT track, out of the 1639 Level-1 filtered dijets with \(|\eta|<0.6\), but only 929 events appear in (a) and (b) because 28 events with measured TRT \(P_{t}>100\) GeV overflow the histogram limits.

Figure 25: Silicon tracker parameters for 20 GeV electrons at high luminosity (18 min-bias events), with \(|\eta|<0.6\). (a) \(P_{t}\) of the SIT track candidate. (b) \(P_{t}/E_{t}\). (c) Difference between the track \(\eta\) and the \(\eta\) of the central calorimeter cell. (d) Difference between the track \(\phi\) at the calorimeter and the \(\phi\) of the central EM calorimeter cell. The sample contains 109 events with an SIT track, out of the 116 Level-1 filtered dijets, but only 108 appear in (a) because 1 event with measured SIT \(P_{t}>100\) GeV overflows the histogram limits.

Figure 26: Silicon tracker parameters for jets passing the 15 GeV filter, at high luminosity (18 min-bias events), with \(|\eta|<0.6\). (a) \(P_{t}\) of the SIT track candidate. (b) \(P_{t}/E_{t}\). (c) Difference between the track \(\eta\) and the \(\eta\) of the central calorimeter cell. (d) Difference between the track \(\phi\) at the calorimeter and the \(\phi\) of the central EM calorimeter cell. The sample contains 888 events with an SIT track, out of the 1639 Level-1 filtered dijets, but only 816 appear in (a) and (b) because 72 events with measured SIT \(P_{t}>100\) GeV overflow the histogram limits.

Figure 27: \(E_{t}\) distributions for jets passing the 15 GeV filter, at high luminosity (18 min-bias events), with \(|\eta|<0.6\). (a) Sample of 1342 events passing the Level 1 trigger criteria, with \(E_{t}>\)15 GeV, out of the 1639 events passing the original Level 1 filter. (b) Sample of 796 events with \(E_{t}>\)18 GeV passing calorimeter shape-parameter cuts. (c) Sample of 559 photon candidates passing calorimeter and preshower shape-parameter cuts. (d) Sample of 329 electron candidates passing calorimeter, preshower, and tracking cuts. The photon and electron cuts give 90% efficiency for photons or electrons with \(E_{t}>\)20 GeV.

Figure 28: \(E_{t}\) distributions for jets passing the 15 GeV filter, at high luminosity (18 min-bias events), with \(|\eta|<0.6\). (a) Sample of 1342 events passing the Level 1 trigger criteria with \(E_{t}>\)15 GeV, out of the 1639 events passing the original Level 1 filter. (b) Sample of 311 events with \(E_{t}>\)18 GeV passing calorimeter shape-parameter cuts. (c) Sample of 177 photon candidates passing calorimeter and preshower shape-parameter cuts. (d) Sample of 72 electron candidates passing calorimeter, preshower, and tracking cuts. Here the cuts give 80% efficiency for photons or electrons with \(E_{t}>\)20 GeV.

Figure 29: \(E_{t}\) distributions for jets passing the 35 GeV filter, at high luminosity (18 min-bias events), with \(|\eta|<0.6\). (a) Sample of 148 events passing the Level 1 trigger criteria with \(E_{t}>35\) GeV. (b) Sample of 91 events with \(E_{t}>\)38 GeV passing calorimeter shape-parameter cuts. (c) Sample of 45 photon candidates. (d) Sample of 11 electron candidates. The photon and electron cuts give 90% efficiency for photons or electrons with \(E_{t}>\)40 GeV.

Figure 30: \(E_{t}\) distributions for jets passing the 35 GeV filter, at high luminosity (18 min-bias events), with \(|\eta|<0.6\). (a) Sample of 148 events passing the Level 1 trigger criteria with \(E_{t}>35\) GeV. (b) Sample of 42 events with \(E_{t}>\)38 GeV passing calorimeter shape-parameter cuts. (c) Sample of 25 photon candidates. (d) Sample of 2 electron candidates. Here the cuts give 80% efficiency for photons or electrons with \(E_{t}>\)40 GeV.

Figure 31: Silicon track parameters before and after correction of the extrapolation to the calorimeter. The sample contains 295 events with TRT and SIT tracks, out of the 311 events with \(|\eta|<0.6\). (a) Difference between the SIT track \(\phi\) at the calorimeter before correction and the \(\phi\) of the central EM calorimeter cell. (b) Difference between the SIT track \(\phi\) at the calorimeter before correction and the TRT track \(\phi\) at the calorimeter. (c) Difference between the SIT track \(\phi\) after correction and the \(\phi\) of the central EM calorimeter cell. (d) Difference between the SIT track \(\phi\) after correction and the TRT track \(\phi\) at the calorimeter.