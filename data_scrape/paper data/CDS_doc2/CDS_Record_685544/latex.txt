On-line versus Off-line Identifiers for the MDT Chambers of the Muon Spectrometer

**Authors : P.Bagnaia(\({}^{1}\)), A. Di Mattia(\({}^{2}\)), S.Falciano(\({}^{2}\)), T.A.M.Wijnen(\({}^{3}\))**

(1) University of Rome "La Sapienza" and INFN, Rome, Italy

(2) INFN Rome, Italy

(3) University of Nijmegen, The Netherlands

Keywords:On-line, Off-line, Identifiers, MDT, Muon

_Abstract_

This note describes the numbering schemes used for on-line and off-line identification of the MDT chambers of the Muon Spectrometer. Conversion tables from on-line to off-line identifiers and viceversa are reported.

## 1 Introduction

Detector data format is built along the various steps of the data flow, from the front-end electronics to the final storage. It follows the specifications, common to all sub-detectors or sub-systems, defined in [1]. The raw data format produced on-line is also referred to as ByteStream format.

On-line and off-line software which needs data access, has to deal with information in the ByteStream format or a derived one (Raw Data Objects and Prepared Raw Data Objects). The Detector Description, in terms of geometry and readout organization, allows to associate _data elements_ to _detector elements_ and deal with the raw information of the single detector channels.

This note, based on the readout organization of the MDT Chambers reported in [2], describes the on-line and off-line identifiers of this detector. The identifiers can be used by the High Level Trigger algorithms, the off-line reconstruction code, the calibration procedures and the on-line monitoring programs. A way of mapping on-line identifiers onto the off-line ones is also described.

## 2 Basic conventions and assumptions

It is worthwhile to remind the Muon Spectrometer is divided into four main "partitions" : Barrel and Endcap, positive and negative \(\eta\) sides (respectively, A-side and C-side). The division into partitions applies also to the four chamber technologies (MDT, CSC, RPC and TGC).

In the on-line environment, and therefore in the ByteStream data format [1,2], such partitions are identified by values which range from 0x61 to 0x64 for the MDT detector.

## 3 Summary of MDT Readout organization

As described in [2], the proposed MDT readout organization is based on the concept of "trigger tower". MDT data organized in towers satisfy the need of the High Level Trigger algorithms, mainly at LVL2, to be fast in their data access to memory buffers. Three towers in \(\eta\) have been defined for each detector partition, each tower including, in standard sectors, six chambers : two adjacent chambers in \(\eta\) for each muon station (2 for the Inner, 2 for the Middle and 2 for the Outer). A pictorial view of a trigger tower is shown in Fig.1.

If we count how many towers we have for the 8 sectors (16 sectors if we consider Large and Small sectors), we end up with 192 towers which correspond to an equivalent number of MDT Read Out Driver modules (MRODs). There are 48 towers (MRODs) per partition as reported in Appendix B. The numbering of the towers (and the MROD boards) is a value which goes in the ByteStream data format and it is provided by the readout electronics. The following table associates the numbering of the Tower/MRODs to the detector partition:

## 4 Summary of the MDT Off-line Identifiers

A hierarchical software identifier scheme for the ATLAS Muon Spectrometer is reported in a MUON note [3]. It provides a unique identification of the MDT chambers. A software identifier is a sequence of integers and character strings, ordered from left to right into fields of increasing details. The first four fields of the identifier form the so called "station prefix", which is common to all identifiers. The next field identifies the sub-system technology, MDT in this specific case. The remaining fields provide the detailed technology-specific identifier "suffix".

The station identifier, prefix to all muon sub-systems, is defined as follows:

_StationPrefix = Detector/StationName/StationEta/StationPhi_

In the case of MDT chambers, the following values or range of values are assigned:

\begin{table}
\begin{tabular}{|c|c|c|} \hline
**Sub-detector ID** & **Partition type** & **Tower / MROD \#** \\ \hline \hline _0x61_ & _Barrel A-side_ & _0-47_ \\ \hline _0x62_ & _Barrel C-side_ & _0-47_ \\ \hline _0x63_ & _EndCap A-side_ & _0-47_ \\ \hline _0x64_ & _EndCap C-side_ & _0-47_ \\ \hline \end{tabular}
\end{table}
Table 1: On-line Identifiers for the different detector partitions. The Sub-detector ID and the Tower/ MROD numbers are used in the ByteStream data format [2].

## 5 Proposal for a Compact numerical Identifier

In the on-line environment it is useful to define simple identifiers for the detector elements which allow to derive, in a simple way, the corresponding, and more complex off-line identifiers. To this purpose we propose a convention to build a Compact numerical Identifier for each MDT chamber of the Muon Spectrometer. Such Identifier contains all the information necessary to build the off-line identifier, once the _Detector_ value is set to 7. The Compact Identifier is a 16-bit word, unsigned. The bit allocation is reported in Table 3. The _StationNumber_, which follows the off-line AMDB Database [4] convention, is reported in Appendix A.

## 6 Information necessary to identify an MDT chamber

The procedure used to navigate through different identifier schema is to define a set of conventions and produce a set of mapping tables. First of all, based on the Parameter Book of the MDT Layout, a set of tables are built containing the list of towers and, for each tower, the chambers which are readout by the same MROD (all the TDCs of the Front-End electronics, up to a maximum of eighteen, are connected to a single Chamber Service Module, CSM, which sends chamber data via a dedicated link to one of the 6/8 input links of an MROD). The chamber mnemonics used in the tables are built as follows:

\begin{tabular}{|c|c|c|c|} \hline _ChamberName_ & _ChamberNumber/Type_ & _Side_ & _SectorNumber_ \\ \hline \end{tabular} where ChamberName is a 3 character string as defined in Appendix A, ChamberNumber is the chamber type as defined in the construction Parameter Book and which corresponds, in most cases, to one of the 8 or 6 \(\eta\) intervals of the barrel or endcaps, the side is A or C and the Sector-Number ranges between 1 and 16. As an example, this convention builds up the mnemonic

\begin{table} \end{table}
Table 2: Compact numerical Identifier for MDT chambersBIL1A06 for the chamber called BIL (Barrel Inner Large), numbered as 1 (to which correspond some construction characteristics specified in the Parameter Book), positioned in the A side of the Barrel and in Sector 6.

From the tables containing the readout towers and defined in [2], a new set of tables can be created using a different naming convention for special chambers in the feet sectors (12 and 14). These changes are necessary to agree with the conventions used by the off-line AMDB Database. The modified tables are reported in Appendix B. From those tables one can create four ASCII files with new tables where the chamber mnemonic is replaced by the so called "Compact Identifier" defined in Section 3. The four tables, reported in Appendix C, have the following logical structure:

\begin{tabular}{c|c|c|c|c|}  & **Sub-detector** & **Sub-detector** & **Sub-detector** & **Sub-detector** \\  & **ID=0x61** & **ID=0x62** & **ID=0x63** & **ID=0x64** \\ \cline{2-4} \(\Delta\eta\)=1 & 16 Towers & 16 Towers & 16 Towers & 16 Towers & 16 Towers \\  & 0-15 & 0-15 & 0-15 & 0-15 \\ \cline{2-4} \(\Delta\eta\)=2 & 16 Towers & 16 Towers & 16 Towers & 16 Towers & 16 Towers \\  & 16-31 & 16-31 & 16-31 & 16-31 \\ \cline{2-4} \(\Delta\eta\)=3 & 16 Towers & 16 Towers & 16 Towers & 16 Towers \\  & 32-47 & 32-47 & 32-47 & 32-47 \\ \cline{2-4} \end{tabular}

Each table is addressed by the Sub-detector ID and the 48 entries correspond to the 48 towers of the partition (16 towers for each of the 3 \(\eta\) slices of the partition).

## 7 Appendix A : StationNumber versus StationName

Extracted from file : _[ATLAS] / offline / MuonSpectrometer / MuonIdentifiers / src / MuonStationName.cxx_ (by D.Adams, modified by K.Assamagan).

(1) Presently the BOH chamber mnemonic is not used. The BIM mnemonic, currently used in Layout Q, will be introduced in future versions of the software.

## 8 Appendix B : Modified MDT Readout Towers

Tables 8.1 through 8.4 show the readout towers reported in reference [2]. They are slightly modified to use the naming conventions of AMDB and a different association of a few chambers to the CSM links in a tower. This is due to the necessity of optimizing the chamber belonging to a pre-defined \(\eta\) slice. These tables are available as ASCII files at the CVS location :

_[ATLAS] / offline / MuonSpectrometer / MuonCablings / MDTcabling / Share / RODmap.data_.

Fig.1 shows the arrangements of MDT chambers in a tower and their connection to CSMs and MROD. The figure applies to standard sectors. Possible holes in chamber position or different chamber shapes or different number of chambers per station may affect the tower configuration in special sectors. This will happen accordingly to the tables reported in this Appendix.

Figure 1: MDT Trigger Tower (Barrel, standard sector) and its connection to the readout electronics (CSMs, one per chamber, and MROD, one per tower).

It is worthwhile to note that the towering scheme reported in this paper is subject to future review in order to take into account : a) a stable spectrometer layout, b) a readout organization in the endcap regions more suted to the requirements of data access of the High Level Trigger algorithms, not yet available at the time being, c) a minimal number of MROD Extension cards in the tower organization, d) a coherency among naming and numbering conventions of the MDT Parameter Book, the off-line muon Database and the readout electronics.

[MISSING_PAGE_EMPTY:9]

[MISSING_PAGE_EMPTY:10]

[MISSING_PAGE_EMPTY:11]

[MISSING_PAGE_EMPTY:12]

## 9 Appendix C : MDT Readout Towers using the "Compact Identifiers".

A dedicated software service reads the tables reported in Appendix B and replaces each mnemonic of the detector elements by a "Compact Identifier". A new set of tables is produced and made available as ASCII files to the Converters\({}^{(2)}\) to derive the Off-line Identifiers of the chambers in a tower. The new tables are reported in sections 9.1 through 9.4. They are available at the CVS location :

_[ATLAS] / offline / MuonSpectrometer / MuonCablings / MDTcabling / Share / ROD-mapCI.data_.

At the same location the software service which creates those tables is available under the name : _MRODmap.exe_.

(2) Software package to convert ByteStream data format to Raw Data Objects and viceversa.

[MISSING_PAGE_EMPTY:14]

[MISSING_PAGE_EMPTY:15]

--

ModID|| MDT chambers / CSM links |MROD tower|| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 |crate -----------------------------------------------------

 "eta 4" - Large chambers in sectors 1,3,5,7,9,11,13,15

 00 || 9B41 9D11 9D21 A341 A351 A961 9B51 - | 9

 01 || 9B42 9D12 9D22 A342 A352 A962 - - | 9

 02 || 9B43 9D13 9D23 A343 A353 A963 - - | 10

 03 || 9B44 9D14 9D24 A344 A354 A964 - | 10

 04 || 9B45 9D15 9D25 A345 A355 A965 9B55 - | 11

 05 || 9B46 9D16 9D26 A346 A356 A966 - - | 11

 06 || 9B47 9D17 9D27 A347 A357 A967 - - | 12

 07 || 9B48 9D18 9D28 A348 A358 A968 - - | 12

 "eta 4" - Small chambers in sectors 2,4,6,8,10,12,14,16

 08 || 0371 0381 9F11 9F21 A541 A551 - - | 9

 09 || 0372 0382 9F12 9F22 A542 A552 - - | 9

 01 || 0373 0383 9F13 9F23 A543 A553 - - | 10

 01 || 0374 0384 9F14 9F24 A544 A54 - - | 10

 0C || 0375 0385 9F15 9F25 A545 A555 - - | 11

 0D || 0376 0386 9F16 9F26 A546 A556 - - | 11

 0E || 0377 0387 9F17 9F27 A547 A557 - - | 12

 0F || 0378 0388 9F18 9F28 A548 A558 - - | 12

 "eta 5" - Large chambers in sectors 1,3,5,7,9,11,13,15

 10 || 9B21 9B31 A331 A941 A951 - - - | 9

 11 || 9B22 9B32 A332 A942 A952 - - | 9

 12 || 9B23 9B33 A339 A943 A953 - - - | 10

 13 || 9B24 9B34 A334 A94 A954 - - - | 10

 14 || 9B25 9B35 A355 A945 A955 - - | 11

 15 || 9B26 9B36 A36 A946 A956 - - | 11

 16 || 9B27 9B37 A337 A947 A957 - - - | 12

 17 || 9B28 9B38 A38 A948 A958 - - - | 12

 "eta 5" - Small chambers in sectors 2,4,6,8,10,12,14,16

 18 || E311  E321 0D11 OD21 A531 AB41 AB51 AB61 | 9

 19 || E312  E322 0D12 OD22 A532 AB42 AB52 | 9

 1A || E313  E323 0D13 OD23 A533 AB43 AB53 AB63 | 10

 1B || E314 324 AD14 D024 A534 AB44 A54 AB64 | 10

 1C || E315  E325 0D15 OD25 A535 AB45 AB55 | 11

 1D || 2316  E326 0D16 OD26 A55 AB46 AB56 | 11

 1E ||  E317  E327 0D17 OD27 A537 AB47 AB57 | 12

 1F || E318  E328 0D18 OD28 A538 AB48 AB58 | 12

 "eta 6" - Large chambers in sectors 1,3,5,7,9,11,13,15

 20 || 9B11 A311 A321 A911 A921 A931 - - | 9

 21 || 9B12 A312 A322 A912 A922 A932 - - | 9

 22 || 9B13 A313 A323 A913 A923 A933 - - | 10

 23 || 9B14 A314 A324 A914 A924 A934 - - | 10

 24 || 9B15  A315 A325 A915 A925 A935 - - | 11

 25 || 9B16 A 

[MISSING_PAGE_EMPTY:17]

## 10Appendix D : DAO Readout organization and Region Selector Tables

The numbering schemes presented in this paper are also useful to generate a table needed by the Region Selector package [6]. This software package has been developed in the off-line framework to translate "physical regions" of the ATLAS sub-detectors into "Identifiers" of _detector elements_ belonging to those regions. They may be the Region of Interests (Rols) defined by the Level-1 Trigger or by any High Level Trigger algorithm or off-line reconstruction program.

For this purpose, in the present implementation of the Region Selector, an ASCII file has been created for the MDT sub-detector (as for the other sub-detectors) which contains, for each _detector element_, the off-line Identifier as defined in [3], \(\phi_{\min}\), \(\phi_{\max}\), \(\eta_{\min}\), \(\eta_{\max}\), a Hash Identifier (numbering of detector elements internal to the Detector Description software) and a ROB (Read Out Buffer) address. This last information is necessary to fetch, over the DAQ network, the detector raw data stored in the ROS (Read Out System). The remaining information is a geometrical one and can be built using the Detector Description or directly the AMDB database.

In order to define the ROB address, it is necessary to make assumptions on the TDAQ architecture and, in particular, on the Read Out System. We can use the "TDAQ baseline architecture" presented in the ATLAS DAQ, HLT and DCS TDR [5] which is based on the following choices. In a PC based ROS, 3 ROBins (ROB inputs) will be plugged on the PCI bus, each having 4 ROLs (Read Out Links) in input. There will be, in total, 12 input links in a ROS (Fig.2). This nicely maps the MDT Read Out organization in terms of ROD (Read Out Driver) Crate whose output links fit exactly into a ROS. As reported in Appendix B, there will be 16 ROD Crates for the final MDT Read Out system. The Crate numbering is shown in Fig.3. Because of the simple correspondence between ROD and ROS Crates, we can assume this numbering scheme also for the MDT ROSses.

Figure 2: DAQ Read Out System (ROS) as published in [5].

Using the simplified scheme of two "standard" sectors (Large and Small) of Barrel and Endcap chambers, a pictorial view of Readout Towers and their numbering is shown in Fig.4. The same figure also illustrates the read out of a tower by an MDT ROD module (MROD) and its location within a ROD Crate. In this way we can make assumptions on the detailed organization of a ROD Crate and its connection to ROBins within a ROS : one ROD Crate (and therefore the corresponding PC ROS) will handle data from two chamber sectors (1-8) or 4 sub-sectors (1-16).

The ROB address (16 bits) is defined on the basis of what has previously described in terms of readout numbering scheme and DAQ architecture and is built up as follows :

\begin{tabular}{|c|c|c|} \hline _ROS__ID_ & _ROBin__ID_ & _ROBin__LinkID_ \\ \hline \end{tabular} where ROBin_LinkID (4 bits) ranges between 1 and 4, ROBin_ID (4 bits) is the ROBin board number within the PC ROS and ranges between 1 and 3, ROS_ID (8 bits) is the ROS number within a given partition and ranges between 1 and 16 (same as ROD crate number).

The content of the ASCII file of the MDT chambers for the Region Selector package is reported in the table below. Here only a few detector elements are shown just as example. The file is available at the CVS location :

_[ATLAS] / offline / MuonSpectrometer / MuonCablings / MDTcabling / Share / RegionSelectorMDT.data._

Figure 3: MDT ROD Crate numbering for Barrel and End-cap.

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|} \hline
**MDT extended Id** & **Hash Id** & **ROB Id** & **EtamMin** & **EtamMax** & **PhiMin** & **PhiMax** \\ \hline
7/0/-6/1/0 & 0 & 0065 & -1.131 & -0.927 & -0.276 & 0.276 \\
7/0/-6/2/0 & 12 & 0045 & -1.131 & -0.927 & 0.509 & 1.061 \\
7/0/-6/3/0 & 24 & 0066 & -1.131 & -0.927 & 1.295 & 1.847 \\
7/0/-6/4/0 & 36 & 0046 & -1.109 & -0.927 & 2.080 & 2.632 \\
7/0/-6/5/0 & 48 & 0067 & -1.131 & -0.927 & 2.866 & 3.417 \\
7/0/-6/7/0 & 70 & 0068 & -1.109 & -0.927 & 4.436 & 4.988 \\
7/0/-5/1/0 & 1 & 0065 & -0.987 & -0.799 & -0.276 & 0.276 \\
7/0/-5/2/0 & 13 & 0045 & -0.987 & -0.799 & 0.509 & 1.061 \\
7/0/-5/3/0 & 25 & 0066 & -0.987 & -0.799 & 1.295 & 1.847 \\
7/0/-5/4/0 & 37 & 0046 & -0.987 & -0.799 & 2.080 & 2.632 \\
7/0/-5/5/0 & 49 & 0067 & -0.987 & -0.799 & 2.866 & 3.417 \\
7/0/-5/6/0 & 60 & 00a7 & -1.081 & -0.886 & 3.663 & 3.967 \\
7/0/-5/7/0 & 71 & 0068 & -0.962 & -0.772 & 4.436 & 4.988 \\
7/0/-5/8/0 & 82 & 00a8 & -1.081 & -0.886 & 5.458 & 5.762 \\ \hline \end{tabular}
\end{table}
Table 3: MDT ASCII file for the Region Selector package.

Figure 4: MDT Readout Towers for two standard sectors and connection to MRODs (ROD Crate) and ROBins (DAQ ROS).

## References

* [1]**The raw event format in the ATLAS Trigger & DAQ**, C.Bee et al., CERN ATLAS note ATL-DAQ-98-129, [http://atlasinfo.cern.ch/Atlas/GROUPS/DAQTRIG/DAQ/daq.html](http://atlasinfo.cern.ch/Atlas/GROUPS/DAQTRIG/DAQ/daq.html)
* [2]**The MROD data format and the towering partitioning of the MDT chambers**, T.A.M.Wijnen, University of Nijmegen note HEN-434 and CERN ATLAS note ATL-COM-MUON-2003-011.
* [3]**A Hierarchical Software Identifier Scheme for the ATLAS Muon Spectrometer**, K.Assamagan et al., CERN ATLAS note ATL-COM-MUON-2002-019, Version 2.0, http://muondoc/home/cern.ch/muondoc/software/Database/
* [4][http://www.cern.ch/ATLAS/GROUPS/MUON/AMDB_SIMREC/amdb_simrec.html](http://www.cern.ch/ATLAS/GROUPS/MUON/AMDB_SIMREC/amdb_simrec.html)
* [5]**The ATLAS DAQ, HLT and DCS Technical Design Report**, Trigger/DAQ Collaboration, in preparation.
* [6]**Region-of-Interest Selection for ATLAS High Level Trigger and Offline Software Environments,** A.G.Mello et al., CERN ATLAS note ATL-COM-DAQ-2003-005 and ATLAS note ATL-COM-SOFT-2003-002, 24 March 2003.