**ATLAS NOTE**

ATL-PHYS-PUB-2009-000

March 17, 2009

**Performance study of the level-1 di-muon trigger**

The ATLAS Collaboration1)

Footnote 1: This note prepared by N. Kanaya, A. Krasznahorkay, H. Kurashige, C. Omachi,and P. Reznicek.

_This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020._

**Abstract**

An event with two muons in the final state is a distinctive signal and can be triggered efficiently with the use of the level-1 di-muon trigger. Nevertheless triggering is still an issue if these muon tracks are fairly soft and fake di-muon triggers originating from muons that traverse more than one region of the trigger chambers increase the trigger rate. It is important to provide an acceptable trigger rate, while keeping high trigger efficiency to study low-\(p_{T}\)\(B\)-physics such as rare \(B\) hadron decays or CP violation in the \(B\)-events, especially in a multi-purpose experiment like ATLAS. In this note, the level-1 di-muon trigger and its expected performance are described.

Introduction

ATLAS is a multi-purpose experiment and its main focus is the direct search for and study of physics beyond Standard Model. However the indirect search for new physics will also play an important role in revealing the (flavor) structure of a non-trivial Higgs sector, which cannot be obtained by direct searches.

The \(B^{\ 0}_{s,d}\rightarrow\mu^{+}\mu^{-}\) rare decay is one of the interesting signatures which are sensitive to new physics at the TeV energy scale. The precise measurement of the forward-backward asymmetry [1] or branching ratio in the semi-muonic \(B\) decay \(B\rightarrow\mu^{+}\mu^{-}X\) requires good understanding of the possible biases introduced by event selection. Also important are precise measurements of Standard Model parameters, including CP-violation in \(B\)-events, such as \(B^{\ 0}_{s}\rightarrow\)\(J/\psi\phi\) and \(B^{\ 0}_{d}\rightarrow\)\(J/\psi K^{0}_{s}\). The key to the detection of these \(B\) signals in ATLAS is to achieve a high trigger efficiency for low-\(p_{T}\) di-muon events, keeping an acceptable trigger rate. It is also essential to understand the acceptance and efficiency using \(pp\rightarrow\)\(J/\psi(\mu^{+}\mu^{-})X\) or \(pp\rightarrow\Upsilon(\mu^{+}\mu^{-})X\)[2].

First, the level-1 muon trigger is briefly explained in Section 2, then trigger simulation and MC samples used in this note are described in Section 3. The performance of the level-1 single- and di-muon trigger as well as the effect of an algorithm to resolve muons traversing more than one trigger chambers are described in Section 4. Finally, the performance and the impact of various level-1 muon trigger configurations on some example \(B\) signal events are discussed in Section 5.

## 2 Level-1 muon trigger

The ATLAS trigger system architecture is organised in three levels; level-1, level-2 and event filter. The level-2 and event filter triggers provide a software-based event selection after the level-1 trigger and events accepted by this trigger chain are finally reconstructed and analyzed offline.

The ATLAS level-1 muon trigger is based on dedicated, fast and finely segmented muon chambers (RPC and TGC) [3] and a trigger logic implemented in hardware. The muon trigger system provides acceptance in pseudo-rapidity up to \(|\eta|\sim 2.4\) and in the full azimuthal angle (\(\phi\)) range. A muon track is triggered by the coincidence of two or three detector stations (consists of chamber doublet or triplet) within a certain road (coincidence window). The transverse momentum of a muon candidate is determined by its deviation from the trajectory of an infinite-momentum track (i.e. a straight line). A three station coincidence is required for any \(p_{T}\) threshold in the endcap and forward regions (\(|\eta|>1.05\)) to avoid high trigger rates caused by accidental coincidences due to background.2 As a result, the acceptance at large \(|\eta|\) becomes small for low-\(p_{T}\) muons, as shown in Section 4.

Footnote 2: The number of stations used for coincidence is programmable giving the possibility of lowering a \(p_{T}\) threshold at low luminosity if background conditions allow it.

The granularity of the level-1 muon trigger, the size of a Region of Interest (RoI), is \(\Delta\eta\times\Delta\phi=0.1\times 0.1\) in the barrel region (\(|\eta|<1.05\)) and \(\sim 0.03\times 0.03\) in the endcap regions (\(1.05<|\eta|<2.4\)). In short, if two muons leave tracks in the same RoI, they are counted as a single muon candidate by the trigger system. The level-1 muon trigger decisions from different regions are sent to the Muon Central Trigger Processor Interface (MuCTPI) which combines the information and calculates the multiplicity of muon candidates for each \(p_{T}\) threshold over the whole detector. In forming the multiplicities, care is taken to avoid double counting of single-muon tracks, reconstructed separately in adjacent trigger sectors, while retaining a high efficiency for genuine di-muons. The overlap handling is carried out using Lookup Tables (LUT) to give flexibility and programmability. The LUTs are generated based on Monte Carlo simulations of single-muon events, selecting the regions of the level-1 muon system that can be traversed by a single muon.

The overlap handling is mandatory to avoid unacceptably high trigger rates caused by doubly-counted single muons, so called fake di-muon triggers. Most of the overlaps are resolved by the MuCTPI, which takes the muon candidate with the higher \(p_{T}\) into account when calculating the muon multiplicity and finding overlapping muon candidates. The MuCTPI consists of independent 16 octant modules and overlap resolving is performed in each module. Therefore, overlapped regions connected to two different octant modules cannot be solved in MuCTPI and should be treated in each subdetector (RPC and TGC) by masking channels or flagging a overlap bit. The parameters used in the overlap handling, such as the combination of RoIs and masked channels are programmable. More details are described in Refs. [3, 4].

## 3 Monte Carlo samples and trigger configuration

Single-muon Monte Carlo samples with various, fixed \(p_{T}\) values are used for performance tests of the level-1 single muon trigger logic. Single-muon events are generated uniformly over the full azimuthal angle range and \(|\eta|<2.7\) with a fixed \(p_{T}\) value. The detector response is simulated using Geant4 [4] with the ATLAS geometry in the Athena framework [5]. Trigger simulation is performed using the trigger configuration for luminosity of \(10^{31}\)-\(10^{33}\)cm\({}^{-2}\)s\({}^{-1}\) running, with a set of \(p_{T}\) thresholds of 4, 5, 6, 11, 20 and 40 GeV. The production vertex is smeared with a Gaussian distribution with \(\sigma_{x}=\sigma_{y}=15\)\(\mu\)m and \(\sigma_{z}=56\) mm. The level-1 single- and di-muon trigger menu items are named as MUx (single-muon trigger) and 2MUx (di-muon trigger with the same threshold for both muons) respectively, where x represents the \(p_{T}\) threshold. The exceptions are MU0 and 2MU0, which correspond to completely opened coincidence windows. However, even in this case, the acceptance of the coincidence windows is limited by connectivity as well as by the dimension of the coincidence matrix ASICs [6].

The trigger efficiencies of various level-1 trigger configurations are also studied using \(B\)-physics Monte Carlo events. Event generation is done using PYTHIA [7]. Only interesting events associated with at least two muons with \(p_{T}\)\(>\)6 GeV (the leading muon) and 4 GeV (the second muon) within \(|\eta|<2.5\) are studied. The \(B\)-physics samples used in this note are \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\phi\) (47,650 events), \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\) (47,450 events) and \(B^{+}\ \to J/\psi(\mu^{+}\mu^{-})K^{+}\) (49,250 events). The last sample is chosen partly as a control sample. The opening angle of the two muons is smaller in this sample than in the other two samples.

In this note, only the level-1 muon trigger is simulated and events triggered by level-1 are studied.

## 4 Level-1 muon trigger efficiency in single-muon events

Detailed performance studies of the single muon trigger were performed in the barrel and endcap regions separately and the results are described in Ref. [8]. The single muon trigger efficiencies as a function of the transverse momentum of the simulated muon, over the whole muon trigger system are shown in Figure 1. The single muon trigger efficiency is defined by:

\[\epsilon(\mathrm{MUx})=\frac{\#\mbox{ of events triggered}}{\#\mbox{ of single muon events with }|\eta|<2.5}. \tag{1}\]

The range of pseudo-rapidity applied in the efficiency calculation is \(|\eta|<2.5\) and not 2.4 as used in Ref. [8], since \(|\eta|<2.5\) is applied for muons in the \(B\)-physics samples (Muons with \(|\eta|>2.4\) can be triggered if their momentum is relatively low and the track is bent towards smaller \(|\eta|\)). The efficiency, \(\epsilon(\mathrm{MUx})\), includes all contributions from geometrical acceptance and coincidence window coverage. The trigger efficiency of MU5 and MU6 is lower than MU0 even for high \(p_{T}\) muon tracks. This is because all regions don't have full (100 %) acceptance except MU0 which accepts all muons within station coincidence windows. Figures 2 (a) and (b) show the trigger efficiency as a function of the \(|\eta|\) of the simulated muon with \(p_{T}\) at threshold and with \(p_{T}\)=19 GeV for MU0 and MU6 trigger selections, respectively. The efficiency at the plateau is predominantly determined by geometrical acceptance. Efficiency losses at \(|\eta|\sim 0\), 0.4 and 0.7 are caused by cracks and inactive material, like ribs, detector support structures and the elevator hole. Around the transition region between the barrel and the endcap, \(|\eta|\sim 1.05\), some efficiency is lost because the station coincidence cannot be satisfied. A small efficiency gap at the boundary between the endcap and forward regions (\(|\eta|\sim 2\)) is also due to the station coincidence, since the endcap and forward systems are treated separately. However, this effect is smaller than in the transition region between the barrel and the endcap. Poor MU0 efficiency at \(p_{T}\) =4 GeV is seen in the endcap region due to the requirement of three station coincidence, not two as required in the barrel. The trigger was originally designed for \(p_{T}\)\(>\) 6 GeV as the lowest threshold, but can be applied below this threshold at very low luminosity.

Figures 3 (a) and (b) show the trigger efficiency as a function of \(\phi\) (\(\phi\)=0 and \(\pm\pi\) denote directions perpendicular to the beam axis in the horizontal plane) of the simulated muon with \(p_{T}\) at threshold and with \(p_{T}\)=19 GeV for MU0 and MU6 trigger selections, respectively. The efficiency loss can be clearly seen around \(\phi\sim-1.2\) and \(-2\) at the magnet's feet, especially for high \(p_{T}\) muons. The geometrical structure is in general more visible in efficiency using higher \(p_{T}\) muons, as they produce straighter tracks.

## 5 Level-1 muon trigger performance in \(B\)-physics events

A detailed level-1 trigger simulation is mandatory to find effective trigger menus and thresholds for certain physics processes and to determine the trigger efficiency and rate as well as to study the trigger bias. In this section, di-muon and single-muon trigger efficiencies with different \(p_{T}\) thresholds and the dependency of di-muon trigger efficiencies as a function of the opening angle between simulated muons are discussed using \(B\)-physics Monte Carlo samples.

Figure 1: Trigger efficiency as a function of \(p_{T}\) with each low-\(p_{T}\) threshold; MU0 (filled circles), MU5 (filled triangles) and MU6 (open squares) for muons with \(|\eta|\)\(<\) 2.5 at the interaction point.

Figure 3: The \(\phi\) dependency of the trigger efficiency for MU0 (a) and MU6 (b) trigger selections. Solid lines correspond to the simulated muons with \(p_{T}\)=19 GeV, dotted lines are for muons with \(p_{T}\) at threshold (in the case of MU0 this threshold is set to 4 GeV).

Figure 2: The \(|\eta|\) dependency of the trigger efficiency for MU0 (a) and MU6 (b) trigger selections. Solid lines correspond to the simulated muons with \(p_{T}\)=19 GeV, dotted lines are for muons with \(p_{T}\) at threshold (in the case of MU0 this threshold is set to 4 GeV).

### Efficiency with various trigger configurations

The efficiency of the level-1 muon trigger for three different \(B\)-physics processes, \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\), \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\phi\) and \(B^{+}\ \to J/\psi(\mu^{+}\mu^{-})K^{+}\) is studied with various trigger configurations. The efficiencies of the single muon triggers (MU0 and MU6) and the di-muon triggers (2MU0 and 2MU6) are summarized in Table 1. The efficiency of the single muon trigger is high, about 95 %, since multiple muons have a higher probability to be triggered by a single muon trigger. The 2MU0 trigger gives better efficiency than 2MU6 by \(\sim\) 16 % for di-muon events with \(p_{T}\) above 6 GeV (4 GeV) for the fastest (second fastest) muon. The efficiency loss due to the MuCTPI overlap handling is seen in all physics processes, although the relative efficiency loss is small, \(\sim\) 0.5 %.

### Opening-angle dependency

In case of measuring some quantity as a function of a certain parameter, one must ensure that the trigger efficiency is independent of that parameter, or correct the measurement to avoid a bias from the trigger.

Figure 4 shows the 2MU0 and 2MU6 trigger efficiencies as a function of \(\Delta R\) (=\(\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\)) between the two leading muons in \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\phi\) events. The \(\eta\) and \(\phi\) are true parameters of muon flight direction at the production vertex. No offline selection is applied in order to see see the bias from the level-1 trigger. The trigger efficiency clearly depends on the opening angle of the two leading muons. The efficiency is lower at large opening angles because in this case the \(B_{s}\) system is not boosted i.e. momenta of the muons are lower. Since overlap removal between the muon candidates doesn't play a role at large opening angles, this effect is purely due to kinematics. Figure 5 (a) shows the \(p_{T}\) distribution of the leading muons for three different \(\Delta R\) ranges: \(\Delta R<\) 0.1, 0.2 \(<\Delta R<\) 0.4 and \(\Delta R>\) 0.5. The muons at large opening angles clearly have a softer \(p_{T}\) spectrum. The effect is even more clearly visible for higher threshold di-muon trigger items, as the probability of having muons at large \(\Delta R\) with transverse momenta high enough to trigger a high threshold di-muon trigger item is very small, but non-negligible at small opening angles.

The small efficiency loss at very small opening angles (\(\Delta R<\) 0.1) is however due to the trigger system. In the case that the muons both leave hits in the same RoI, only one muon can be triggered by the system. Figure 5(b) shows the 2MU0 efficiency as a function of the opening angle, but events are divided into two classes: In one case we select the muon pairs whose separation is expected to shrink

\begin{table}
\begin{tabular}{|c|c|c|c|} \cline{2-4} \multicolumn{1}{c|}{} & \multicolumn{3}{|c|}{Efficiency [\%]} \\ \hline Trigger Menu / Process & \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\) & \(B^{+}\ \to J/\psi(\mu^{+}\mu^{-})K^{+}\) & \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\phi\) \\ \hline \hline MU0 & 97.0\(\pm\)0.1 & 96.8\(\pm\)0.1 & 97.0\(\pm\)0.1 \\ MU6 & 93.0\(\pm\)0.1 & 92.9\(\pm\)0.1 & 93.1\(\pm\)0.1 \\
2MU0 & 67.9\(\pm\)0.2 & 68.8\(\pm\)0.2 & 69.0\(\pm\)0.2 \\
2MU6 & 51.6\(\pm\)0.2 & 52.9\(\pm\)0.2 & 53.2\(\pm\)0.2 \\ \hline
2MU0 (w/o MuCTPI overlap handling) & 68.2\(\pm\)0.2 & 69.1\(\pm\)0.2 & 69.4\(\pm\)0.2 \\
2MU6 (w/o MuCTPI overlap handling) & 52.0\(\pm\)0.2 & 53.4\(\pm\)0.2 & 53.7\(\pm\)0.2 \\ \hline \end{tabular}
\end{table}
Table 1: The level-1 trigger efficiency of various configurations. The efficiency is calculated with respect to the number of generated events (not to the number of muons) of three different physics processes. The errors are statistical only.

Figure 4: (a) Trigger efficiency as a function of \(\Delta R\) in the semi-leptonic rare \(B\) decay \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\phi\) using the 2MU0 (filled circles) and 2MU6 (open squares) with MuCTPI. (b) Effect of MuCTPI as a function of the opening angle, \(\epsilon\)(without MuCTPI)/\(\epsilon\)(with MuCTPI) for 2MU0 (filled circles) and 2MU6 (open squares).

Figure 5: (a) The truth \(p_{T}\) distribution of the two leading muons is different opening angles range in \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\phi\) events: \(\Delta R<0.1\) (filled circles), \(0.2<\Delta R<0.4\) (filled triangles) and \(\Delta R>0.5\) (filled squares). (b) The efficiency of 2MU0 as a function of opening angles for two cases: the \(\Delta R\) separation of the two muons is either larger (filled circles) or smaller (open circles) at the muon trigger system compared to that at the primary vertex.

when reaching the muon spectrometer (filled circles), while in the other case (open squares) we select the muon pairs whose separation is expected to grow.

One example \(B\)-physics study is to look at the differential decay rate \(\mathrm{d}\mathrm{B}\mathrm{r}\)(\(B\rightarrow\mu^{+}\mu^{-}\phi\)) / \(\mathrm{d}\mathrm{\hat{s}}\) or forward-backward asymmetry \(A_{FB}\) as a function of di-muon invariant mass to discriminate between Standard Model and new physics contributions. The \(\hat{s}\) is \(m_{\mu\mu}^{2}/m_{B}^{2}\) and the \(A_{FB}(\hat{s})\) is defined as

\[\big{(}\int_{0}^{1}\frac{d\Gamma}{d\hat{s}\hat{z}}d\hat{z}-\int_{-1}^{0}\frac{d \Gamma}{d\hat{s}\hat{z}}d\hat{z}\big{)}/\int_{-1}^{1}\frac{d\Gamma}{d\hat{s} \hat{z}}d\hat{z}, \tag{2}\]

where \(\hat{z}=\cos\theta\) (\(\theta\) is the angle between the \(\mu^{+}\) and \(\phi\) in the \(\mu^{+}\mu^{-}\) rest frame) and \(d\Gamma/d\hat{z}\) is the differential event rate of \(B_{s}^{0}\rightarrow\mu^{+}\mu^{-}\phi\).

Figure 6 (a) shows the \(\mu^{+}\mu^{-}\) invariant mass distribution with and without level-1 triggers in \(B_{s}^{~{}0}\rightarrow\mu^{+}\mu^{-}\phi\) events. Trigger efficiency with 2MU0 and 2MU6 are shown as a function of \(\mu^{+}\mu^{-}\) invariant mass in Figure 6 (b). The relative trigger efficiency, normalized to the efficiency averaged over a whole \(m_{\mu\mu}^{2}/m_{B}^{2}\) range, is also shown to illustrate the trigger bias. The invariant mass dependency of the level-1 di-muon trigger efficiency is weak compared to the opening angle dependency and almost independent of the trigger threshold. A efficiency drop can be seen at small \(\mathrm{m}_{\mu\mu}\), which is also because the two muons are triggered as a single muon by the muon trigger system.

Similarly, the forward-backward asymmetry \(A_{FB}\) is shown as a function of \(\hat{s}\) in Figure7(a). The difference (\(A_{FB}\)[2MUx] - \(A_{FB}\)[no selection]) is also shown in Figure 7(b). It should be noted that significant differences between forward and backward samples in terms of momentum, pseudo-rapidity and \(\mu^{+}\mu^{-}\) opening angle distributions are observed. Nevertheless, as illustrated in Figure 7, the forward-backward asymmetry is more robust to the effects of level-1 di-muon triggering than di-muon mass distributions (see Figure 6).

Figure 6: (a) Scaled di-muon invariant mass-squared distribution in \(B_{s}^{~{}0}\rightarrow\mu^{+}\mu^{-}\phi\) events: no level-1 selection (open histogram), triggered by 2MU0 (hatched histogram) and by 2MU6(cross hatched histogram). (b) Efficiencies of 2MU0 (filled circles) and 2MU6 (open squares) as a function of di-muon invariant mass-squared. The two lines show the relative efficiency with respect to the corresponding average value for 2MU0 (solid line) and 2MU6 (dotted line).

## 6 Summary

The level-1 di-muon trigger is essential for selecting rare \(B\) decays that have low-\(p_{T}\) muons in the final state. The rate for a single-muon trigger at the relevant thresholds would be unacceptably high. A detailed level-1 muon trigger simulation is implemented and used for the study of the trigger efficiency and its bias for \(B\)-physics events. The level-1 di-muon trigger efficiencies of 2MU0 and 2MU6 are high enough (about 70 % and 50 %, respectively) in the interesting \(B\)-physics events. The fake level-1 di-muon trigger rate is 2.3 kHz [8] while the genuine di-muon event rate is \(\sim 600\) Hz (muons with \(p_{T}~{}>\) 4 GeV from \(c\bar{c}\) and \(b\bar{b}\)) at \(\mathcal{L}=10^{33}\)cm\({}^{-2}\)s\({}^{-1}\). The efficiency loss from the MuCTPI overlap handling is found to be negligible.

The trigger bias in regard to the opening angle and invariant mass of two muons was also studied. An opening angle dependence is clearly seen, of the order of \(\pm 10\) % and \(\pm 15\) % for 2MU0 and 2MU6, respectively. It is explained by the single-muon efficiency curves and muon kinematics in signal events. This dependency is stronger for higher \(p_{T}\) thresholds. No clear bias is seen due to the presence of the MuCTPI overlap handling. The trigger efficiency is rather flat over the invariant mass and less dependent on the trigger threshold since the invariant mass is not as strongly correlated to muon momenta as the opening angle is.

## References

* [1] A. Policicchio and G. Grosetti, ATL-COM-PHYS-2007-019 (2007).
* [2] The ATLAS Collaboration, _Triggering on low-pT muons and di-muons for \(B\) Physics_, this volume.
* [3] The ATLAS Collaboration, _The ATLAS experiment at the CERN Large Hadron Collider_, accepted by JINST, 2008.
* [4] S. Agostinelli et al., Nucl. Instr. and Meth. **506**, 250 (2003).

Figure 7: (a) Forward-Backward asymmetry in \(B_{s}^{\ 0}\rightarrow\mu^{+}\mu^{-}\phi\) events: no level-1 selection (filled triangles), triggered by 2MU0 (filled circles) and by 2MU6(open squares). (b) deviation between \(A_{FB}\)â€™s with and without triggers (\(A_{FB}\)[2MUx] - \(A_{FB}\)[no selection]: 2MU0 (filled circles) and 2MU6 (open squares).

* [5] The ATLAS Collaboration, CERN-LHCC-2005-022 (2005).
* [6] The ATLAS Collaboration, CERN-LHCC-98-14 (1998).
* [7] T. Sjostrand, S. Mrenna and P. Skands, JHEP **05**, 026 (2006).
* [8] The ATLAS Collaboration, _Muon Trigger CSC Note_, this volume.