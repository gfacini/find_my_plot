# GEANT4 simulation of the testbeam set-up

for the ALFA detector

V. Vorobel\({}^{a}\) and H. Stenzel\({}^{b}\)

\({}^{a}\)Faculty of Mathematics and Physics, Charles University in Prague, Czech Republic

\({}^{b}\)II. Physikalisches Institut, Justus-Liebig-Univerisitat, Giessen, Germany

13th September 2006

###### Abstract

We present the results of a simulation in GEANT4 of a testbeam set-up for the ALFA luminosity detector for ATLAS. In particular, we compare the expected detector resolution with the experimental measurements obtained with a low-energy electron testbeam. The different electromagnetic processes contributing to the energy evolution of the resolution are studied in detail. Finally, the extrapolation of the detector performance under LHC conditions indicates that an ultimate space-point resolution of about 20 \(\mu\)m is possible, fully satisfying the physics requests for luminosity calibration.

_Keywords:_ Scintillating fibre; GEANT4 simulation; Luminosity;

## 1 Introduction

The ALFA detector (**A** Absolute **L**uminosity measurement **F**or **A**TLAS) is a scintillating fibre tracker, located at 240m distance from the ATLAS interaction point, which will be operated in Roman Pots close to beam in order to measure elastically scattered protons in the Coulomb-Nuclear interference region. Using special beam conditions with a high \(\beta^{\star}\) optics in dedicated runs the \(t\)-spectrum of elastic protons will be reconstructed from the impacts of the tracks in the detector at micro-radian scattering angles. The proton-proton luminosity of the LHC will be calibrated by comparing the measured \(t\)-spectrum to the theoretical prediction including the well-known Coulomb scattering amplitude [1].

A first prototype of the ALFA detector and associated electronics was exposed to a testbeam at DESY in fall 2005 [2]. The experimental set-up and results of the data analysis are summarized in [2].

The purpose of this note is the comparison of the experimental results in terms of detector resolution with a detailed detector simulation. We concentrate on the detector ALFA10\(2\)6, described in detail in ref. [2], consisting of 10 planes of double-sided modules with each 6 U- and 6 V-fibres, used to study the spatial resolution. The main observable in which we are interested is hence the position resolution, in addition the fibres cross-talk and the hit multiplicity are also studied. The main questions motivating this study are: How are the variables of interest influenced by different processes - multiple scattering, generation of \(\delta\)-electrons or bremsstrahlung? Does the MC simulation reproduce truly the data?

The layout of this note is organized as follows: in section 2 the geometry of and materials in the beam line are described, in section 3 the calculation procedure is given, in section 4 the resolutionis studied and in section 5 cross-talk and multiplicities and our conclusions are summarized in section 6.

## 2 Geometry and materials

The geometry and description of the materials is implemented in the GEANT4 [3] package, version 7.0.

The geometry included in the simulations contains the details dominantly influencing the variables of interest (see Fig. 1).

The ALFA detector is in the simulations represented by 10 parts, each of which consists of a central supporting ceramic plate (0.17x16x12 mm, Al\({}_{2}\)O\({}_{3}\), 3.7 g/cm\({}^{3}\)) carrying plastic layers (0.5x16x12 mm, polystyrene) on both sides. Each plastic layer is logically divided into parts simulating the sensitive cores of the fibres (cross-section 0.48x0.48 mm) and to an insensitive rest of the plastic representing the fibre cladding and glue. All the simulated sensitive cores are positioned according to the data provided by metrology.

The silicon strip telescopes (Si-1, Si-2 and Si-3), used to provide the reference coordinate measurement, are approximated by plates 0.3x100x100 mm of silicon with density 2.3 g/cm\({}^{3}\). Only the plastic scintillator trigger located in front of the whole set-up (PS) is included and is simulated as a box 8x16x12 mm of polystyrene (C\({}_{8}\)H\({}_{8}\))\({}_{n}\) with a density 1.05 g/cm\({}^{3}\).

All free space is filled with an air composed of 20% of O\({}_{2}\) and 80% of N\({}_{2}\) (air density 1.29 g/cm\({}^{3}\)).

The beam of electrons at various energies (1-6.5 GeV), simulated with uniform square profile 1.5x1.5 mm and no divergence parallel to the z-axis of the setup, was directed to the intersection of

Figure 1: Geometry of the set-up with the components included into MC-simulations. Silicon telescope Si-1,2,3, polystyrene trigger PS and the detector ALFA. The electron beam enters the set-up from the right side. The red arrow marks position of z=0 in the used coordinate system.

the fibres. For the purpose of an angular scan of the detector orientation with respect to the beam, performed during the testbeam experiment, the beam was simulated with corresponding incident angles.

## 3 Calculation procedure

The position resolution was evaluated in five steps: In the first step, the passage of the beam particle through the set-up was simulated by the Monte Carlo method and the energy deposit in each fibre was determined and recorded event-by-event. In Fig. 2a the spectrum of energy deposited in a single selected fibre is displayed. During this simulation phase, also the coordinates of the intersections of the particle trajectory with the Si planes were recorded.

The signal amplitude (normalized to the number of photoelectrons kicked off the MAPMT photo-cathode) generated by each fibre is calculated in the second step. The amplitude is determined as a sum of three contributions:

\[Amp=N_{phot}+\sigma\cdot RandGauss_{1}+\sigma_{0}\cdot RandGauss_{2};\]

\[N_{phot}=RandPoisson(E_{dep}\cdot\overline{N_{phot}}/\overline{E_{dep}});\]

\(\sigma=\sigma_{1}\cdot\sqrt{N_{phot}};\sigma_{1}=1;\sigma_{0}=0.1;\overline{E _{dep}}=150keV;\overline{N_{phot}}=4.11\).

1. The first term \(N_{phot}\) is a random number chosen from the Poisson distribution with the mean value corresponding to the energy deposited in the fibre, 2. the second term represents the amplitude smearing by the MAMPT proportional to \(\sqrt{N_{phot}}\), 3. the last contribution is an electronic noise which is not amplitude dependent. The comparison of the measured and simulated amplitude spectra is shown in Fig. 2b. The shape of the simulated spectrum is in good agreement with the measured spectrum. The visible disagreement in the range 1-4 photoelectrons is not well understood. It can originate from optical cross-talk between the fibres, a photo-effect on second

Figure 2: a) Simulated energy deposited in a single scintillating fibre b) Simulated signal amplitude in comparison with the measured amplitude spectrum.

the text for all subsequent results a cut of 0.9 photoelectrons is applied to the signal amplitude.

In the third step, the xy-coordinates are determined from the ALFA detector amplitudes calculated in the second step. The same tracking algorithm is used for the simulated data and for the measured data (overlapping algorithm) [2].

The forth step is the evaluation of the xy-coordinates from the information where the beam particle crosses through the Si plates (recorded during the MC simulation). Two approaches were used. In the first approach, the xy-coordinates were determined as an intersection point of the line fitting best the 3 points given by all Si plates (Si-1,2,3) with a reference plane perpendicular to the beam. In the second approach, only two points were used (Si-2,3). Even if the original beam particles are exactly parallel to the z-axis they are deviated during the passage through all the setup. Only those events where the angular deviation of the projectile particle from the z-axis is less then 0.1 mrad are taken into account.

In the fifth step, the distance between the xy-points obtained from the ALFA detector (step 3) and from Si telescope (step 4) was histogramed and the histogram was fitted by Gaussian. The sigma parameter of the fit is reported as the simulated position resolution of the detector.

## 4 Position resolution

The position resolution was evaluated under various conditions in order to find the sensitivity of the calculation procedure on different parameters and check the agreement with the real data.

The dependence of the resolution on the cut of the signal defining amplitude is displayed on the Fig. 3 together with the measured values. All other analyzes are performed with the signal amplitude cut 0.9 photoelectrons. The Fig. 3 shows that around this value the position resolution does not change significantly in accordance with our demands.

The next parameter used in the analysis is the position of the reference plane (see the forth step for the resolution evaluation). We observe two facts: 1. The resolution calculated using 3 points as well as using 2 points depends significantly on the reference plane position (see Fig. 4). 2. The

Figure 3: Dependence of the position resolution on the signal defining amplitude cut.

resolution obtained from 2-points method is obviously better than from 3-points method and the optimal reference plane position is near to the exit of the beam from the ALFA detector. Both facts can be interpreted as a consequence of the multiple scattering. After many scatterings, the particle is significantly deviated from the original direction (explains 1)) and "does not remember" the intersection with the Si-1 detector which explains 2) the worse result from Si-1,2,3.

The idea is also supported by the resolution simulation for 7 TeV protons. The results are the same 20.1 \(\mu\)m for both 3-points as well as 2-points method showing that in absence of the multiple scattering the result of the resolution evaluation is not sensitive to the method used. The significantly better result from the 2-points method applied to the MC data is not reproduced if applied to the real data. The explanation is that while in the case of the MC data the exact xy-coordinates of the projectile particle crossing through the Si plates are used for the resolution evaluation, the finite internal resolution of the real Si telescope prevents improvement of the whole system resolution. Finally, the 3-point method was applied for the resolution evaluation while the 2-point method was used for the deviation angle cut.

The position resolution of the silicon telescope alone was determined in an independent measurement to be 29.8 \(\mu\)m (the dotted curve on the Fig. 5). The black histogram in Fig. 5 is a Gaussian with \(\sigma\)=33 \(\mu\)m equal to quadratic difference of the \(\sigma\) = 44.5 \(\mu\)m of the real data from the ALFA detector and the Si-telescope resolution. The blue histogram is made of the MC data. Both histograms, the MC as well as the real data are built for the electron beam energy 6 GeV, amplitude cut 0.9 p.e. and the reference plane position z=-40 mm. The Gaussian fit through the MC data gives \(\sigma\) = 35 \(\mu\)m in excellent agreement with the data.

The energy dependence of the resolution was simulated with different processes being included. In all cases the ionization is included (otherwise no energy deposition is registered for the xy-position evaluation) without or with other process: \(\delta\)-electrons generation, bremsstrahlung, multiple scattering or all processes are included. The simulations show that the contributions from the \(\delta\)-electrons and bremsstrahlung to the resolution are negligible over the whole energy region. The multiple scattering contributes little for the energy 6 GeV but grows for lower energies and it is the dominant effect influencing the resolution at about 1 GeV. The resolution dependence behaves as

Figure 4: Dependence of the position resolution on the z-coordinate of the reference plane. The shadow band marks a location of the ALFA detector.

Figure 5: Distribution of the difference between x-coordinate reconstructed from the ALFA detector information and x-coordinate obtained from Si-telescope.

Figure 6: a) Contributions of different processes to the position resolution vs. electrons energy. b) The same information displayed in 1/E scale demonstrates validity of A+B/E behavior hypothesis. The resolution tends to about 20 \(\mu\)m for infinite electron energy.

A+B/E (in the 1/E scale the dependence is linear, see the right panel) and tends to about 20 \(\mu\)m for the infinite energy.

The measured resolution dependence is displayed also in Fig. 6 for comparison. For 6 GeV the simulated and measured resolutions are in good agreement while for lower energies the simulated resolutions are higher then measured what indicates that the GEANT4 "exaggerates" the multiple scattering.

In the experiment, the ALFA detector was tilted horizontally or vertically in a range of a few tens of mrad in order to test the detector resolution sensitivity to misalignment. In the MC simulations, the beam was deviated from the direction of the z-axis instead of tilting the detector. The detector remains unmoved in the simulations. Fig. 7 shows that the MC simulated angular scans agree quite well with the measured data. The shift 20 mrad between the measured and simulated vertical scans minima (see the right panel) corresponds with the accuracy of the water level used for the detector position adjustment. The simulated horizontal and vertical scans displayed together on the right panel for comparison are nearly identical.

## 5 Cross-talk, multiplicities

In order to understand origin of the observed cross-talk between the fibres the distance, in units of fibre width, of all fibres hit from the projectile trajectory was evaluated from the simulated data and histogramed (see the Fig. 8). The second bin in the cross-talk histograms contains the hit rate in the fibres adjacent to the fibres hit by the projectile particle. As the shower develops through the detector the rate in the adjacent fibres grows gradually from the first layer to the last one (left panel).

The cross-talk histograms were built for different processes included (see the right panel). The simulations show that the influence of the multiple scattering to the cross-talk is negligible while the bremsstrahlung contributes to the adjacent fibber hits by about 1% of the total rate and \(\delta\)-electrons

Figure 7: Comparison of simulated and measured dependence of the resolution on the detector tilt. a) Horizontal scan. b) Vertical scan. The horizontal scan is shown as well on top of the left wing of the vertical scan in order to to demonstrate that both scans are nearly identical.

contribute by 3%. Total simulated rate in the adjacent fibres (on both sides) is 4%, however, the rate in the real data is about twice higher.

Three different kinds of multiplicities were studied: the distribution of the total number of hit fibres, the number of hit fibres per layer and the number of hit layers. The multiplicity histograms were built from the real data as well as from the MC simulation data (see Fig. 9). In all three multiplicity kinds we observe higher multiplicities in the real data then in the simulations.

## 6 Conclusion

We have presented results of a detailed Monte Carlo simulation for the ALFA detector and compared relevant observables with their experimental determination.

The shape of the single fibre amplitude spectrum is well reproduced in the simulation, except for low signals where optical cross-talk effects are visible in the data. The spatial resolution determined for 6 GeV electrons is determined to be 35 \(\mu\)m and agrees well with the experimental measurement of 33 \(\mu\)m. A study of the different electromagnetic processes reveals a dominant contribution of the multiple scattering to the detector resolution. From a comparison of the measured energy scan with the simulation it appears that at low energies the multiple scattering is simulated by GEANT4 in excess over the data. At LHC energies, where the impact of multiple scattering is much reduced, a spatial resolution of about 20 \(\mu\)m is envisaged. The perpendicular orientation of the detector with respect to the beam axis is crucial in order to achieve this precision, and a deviation at the level of some 10 mrad degrades the resolution, as measured with the testbeam and confirmed within the experimental accuracy by our simulations. The cross-talk between adjacent fibres induced by secondary interactions is studied and found to originate from \(\delta\)-electrons (3%) and bremsstrahlung (1%). However, the overall amount of cross-talk is underestimated in the simulation by a factor of two. Also the different types of multiplicities simulated, though qualitatively in agreement in the

Figure 8: a) Rate of the fibre hits as a function of distance from the primary particle trajectory (cross-talk). The 1\({}^{\rm st}\) bin corresponds to the fibre hit by the primary particle, the 2\({}^{\rm nd}\) bin contains the rate of both adjacent fibres together. The colors distinguish different layers of the ALFA detector. b) Contribution of different processes to the cross-talk in the 20\({}^{\rm th}\) layer of the ALFA detector.

core of their distributions, show significant quantitative discrepancies with the data, in particular in the tails.

In conclusion the GEANT4 simulation is well suited for the study of the resolution of the ALFA detector, bearing in mind that not all details can be reliably simulated. We intend to extend our set-up for the testbeam of the second generation detector prototypes and toward a full implementation of the LHC set-up.

## Acknowledgments

We would like to thank our colleagues P. Grafstrom and C. Joram for fruitful discussions on this subject as well as P. Reznicek for help in development of the code using GEANT4.

## References

* [1]_Forward Detectors for Luminosity Measurement and Monitoring_, ATLAS LoI, CERN/LHCC/2004-010 (22 March 2004)
* Development, Construction and Test of Scintillating Fibre Prototype Detectors_, physics/0605127, accepted for publication by NIM A
* a simulation toolkit_, NIM A 506 (2003) 250-303.

Figure 9: Comparison of simulated and measured multiplicities at different levels, a) number of fibres in the whole ALFA detector hit in an event, b) number of hit fibres per layer, c) number of hit layers in an event.