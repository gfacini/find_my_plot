**ATL-LARG-2004-002**

January 2004

**Time resolution of the ATLAS barrel liquid argon electromagnetic calorimeter**

I. Nikolic-Audit, L.Serin

LPNHE - Paris, Universite Paris VI-VII, LAL-Orsay

IN2P3 -CNRS

Abstract

The time resolution of the ATLAS Liquid Argon barrel EM calorimeter was studied using the 2001 and 2002 test beam data. The electronics time resolution of the EM calorimeter was obtained using calibration runs and found in very good agreement with test bench measurements. The time resolution for physics events was obtained by time difference between two neighbor cells or by comparison with an external scintillator trigger time measurement. Although some limitations are observed with the two methods, the time resolution for electrons is compatible with the expectation giving a local constant term of about 60-70 ps. Typically a 1ns knowledge of the absolute time of the cells would be needed for a good operation of the RODs in ATLAS at the start-up. One way to extract it might be to use cosmic muons in central region only, but in principle such an accuracy should be reached from the knowledge of the readout path and using calibration data. Such an investigation has been done with the beam test data, demonstrating that a 800 ps precision can be obtained.

Note: Color printing is recommended for some pages.

Introduction

The ATLAS liquid argon (LAr) electromagnetic calorimeter (EM) has the capability to measure both the energy and the impact time of the incoming particles. Reconstructing the time in the calorimeter has several purposes. In the case of some Gauge Mediated Supersymmetric Models (GMSB) (point G1b [1]), the NSLP is the neutralino. It is neutral and long-lived, and can occasionally decay in the calorimeter volume, giving rise to a non-pointing photon that will not be in time with the proton-proton collision:

\[\tilde{\chi}_{1}^{0}\rightarrow\tilde{G}\gamma\]

A good timing resolution (\(\simeq 100\) ps) is necessary for a precise tagging of the "delayed" photons in the LAr calorimeter.

Having a precise time measurement can also help to identify and reduce the pile-up effect (the events from previous bunch crossings will not be in time with the collision) and might be used for an event by event energy reconstruction of the pile-up contribution. Finally it can also be used in the determination of the event longitudinal vertex position, especially in the decay channels with neutral particles, such as \(H\rightarrow\gamma\gamma\) where one of the photons is in the end-cap of the LAr EM calorimeter. 1

Footnote 1: For barrel-barrel events the time resolution will not be enough to extract the Z-vertex. For barrel-endcap event 100 ps resolution will translate into 3 cm resolution. Most promising would be events with particles in each endcap.

The amplitude of the signal at its maximum (\(E\)) and the pulse peak time deviation, (\(\tau\)), from the assumed beam crossing time \(t_{bc}\), are determined from the signal samples, taken every 25 ns, using the optimal filtering (OF) method through the following relations (defined in [2]):

\[E=\sum a_{i}s_{i} \tag{1}\]

\[E\cdot\tau=\sum b_{i}s_{i} \tag{2}\]

\(a_{i}\) and \(b_{i}\) are the optimal filtering coefficients for the energy and the time. \(s_{i}\) is i-th signal sample, once the pedestal subtracted. The absolute time of the signal is given by \(t_{bc}+\tau\) so that a positive value of \(\tau\) means that the particle arrives late with respect to the beam crossing (see figure 1).

Figure 1: Definition of the \(\tau\) value with respect to the beam crossing time or the assumed phase of the coefficients used. The vertical solid line shows the assumed phase value and the dashed line the absolute event time.

With this method, the electronics noise and the pile up contributions to the signal are minimized and the time resolution is simultaneously optimized. The coefficients \(a_{i}\) and \(b_{i}\) are determined in each cell from the total noise autocorrelation matrix and the physics signal waveform. The physics waveform is predicted using the known calibration pulse shape corrected for input current differencies between the physics and the calibration signals and for the different injection points [3].

In section 2 the time reconstruction method is described in details. The section 3 deals with the time resolution of the electronics calorimeter readout. After a description of the beam test environment in section 4, the time resolution for physics events in test beam with two different methods is presented in section 5 and 6. A summary of these performances is given in section 7 with a breakdown of the various contributions and limitations. Finally section 8 shows the absolute time intercalibration which can be achieved for physics signals from the calibration and readout knowledge or using muons during the commissioning phase.

## 2 Time reconstruction

### Optimal filtering energy (\(a_{i}\)) and time (\(b_{i}\)) coefficients

The \(a\) and \(b\) coefficients are obtained through the following relations [2]):

\[a=\lambda R^{-1}*g+\kappa R^{-1}*g^{{}^{\prime}}\]

\[b=\mu R^{-1}*g+\rho R^{-1}*g^{{}^{\prime}}\]

where \(g\) is the normalized signal, \(g^{{}^{\prime}}\) its time derivative and \(R\) the autocorrelation matrix. \(\lambda,\kappa,\mu\) and \(\rho\) are normalization constants obtained from \(R^{-1},g\) and \(g^{{}^{\prime}}\).

During beam test period data taking, two types of calibration runs are taken. In a Delay run, a fixed DAC value (input calibration amplitude) is generated by the calibration board and a trigger delay is varied by steps of 1ns so that with interleaved events the entire pulse shape can be reconstructed. In ramp runs, the delay is fixed and various DAC values are generated in order to extract the electronics gain. For the barrel serial module M10, tested in beam test during 2001, there have been several sets of OF coefficients produced. In particular, there was a specific set of OF coefficients produced using the calibration pulse shape. These coefficients are referred to as "Delay" coefficients and have been used in the case of Delay runs (in order to study the effect of the phase on the reconstructed time) and in the case of Ramp runs (in the study of the energy variation of the time resolution). For the physics runs, the coefficients are referred to as "\(LC_{phys}\)" and have been derived from the use of a fixed C (detector capacitance) value for a given cell when predicting the physics pulse shape and a fitted value of L (inductance) [3]. The coefficients have been obtained for the value of \(DAC=10000\) in the medium gain for the strips and for the middle compartment. In order to calculate the OF coefficients in the High gain, the pulse shape has been taken from the medium gain and shifted by 1.4 ns [4]. In most of the runs, seven samples have been recorded, taken around the peak of the signal, but only five samples selected offline are used for the energy and time reconstruction. As physics data were not synchronous in beam test operation, 25 set of 5 coefficients (one per 1ns phase) are computed to describe the entire pulse.

For the analysis of the test beam events, the EMTB package, versions 1-7 and 1-9 [5] are used.

The values of the OF coefficients for physics and calibration runs, for the energy (\(a_{i}\)) and the time (\(b_{i}\)), in the medium and high gain, are shown in figures 2 and 3 for a cell \((\eta,\phi)=(19,10)\) in the middle compartment of M10 barrel EM Calorimeter module 2

Footnote 2: In order to cope with the large dynamics, the shaper has a three gain architecture with a ratio 1:10:100 called respectively low, medium and high gain. For \(\eta<0.8\) the signal saturation in the middle layer appears respectively at about 3000:300:30 GeV. In the medium gain, the electronics noise contribution from the preamplifiers and shapers is small and the OF energy coefficients looks like the readout pulse shape [apart from the discontinuity] with a small weight for the first sample. On contrary in the high gain, the large noise autocorrelation factor between samples give much similar weight for each sample.

### Non continuity of the coefficients

The previous plots of the OF coefficients show discontinuities in the energy \(a_{i}\) coefficients. In order to investigate the origin of this behavior, another set of OF coefficients, easier to compute, can be derived for the energy measurement only. They are referred to as the \(c_{j}\) coefficients and are given by:

\[\vec{c}=\frac{R^{-1}\vec{g}}{swc}\]

where \(swc\) is a normalization constant given by:

\[swc=\vec{g}^{T}R^{-1}\vec{g}\]

so that :

\[\Sigma g_{j}*c_{j}=1\]

With respect to the \(a_{i}\) coefficients, the use of \(c_{i}\) gives a slightly better noise reduction factor as the constraint of simultaneous energy and time optimization has been released.

In order to even more easily understand these discontinuities, the noise autocorrelation matrix has been set to the identity matrix. In this case the corresponding \(c_{j}\) coefficients should be continuous with the time as the waveform g is. This is still not the case, as the normalization

Figure 2: Optimal filtering coefficients for the **energy** in the cell (19,10) of the Module M10 in the Medium and High gain. The coefficients are calculated from the DAC\(\,\)=10000 value, for delay runs (DELAY) and for physics (LC).

constant _swc_ is in general not constant with the phase value, therefore a discontinuity appears when going from phase 25 to phase 1. This variation of the normalization constant will increase as the signal is becoming asymmetric with respect to the peak value. In the figure 4 are shown the signal used to derive the c coefficients (signal from a delay run in the strips in plot (a)) and the variation of the normalization constant in plot (b) when the signal window is taken between:

* case (\(\alpha\)): 1 ns and 125 ns
* case (\(\beta\)) : 25 ns and 150 ns
* case (\(\gamma\)): 5 ns and 130 ns

The corresponding \(c_{j}\) coefficients over the 125 ns time values are displayed in the plot 4(c). In the \(\beta\) case (green dotted), _swc_ is flat as a function of the phase value (dotted line), and the \(c_{j}\) coefficients are continuous as a function of time. The red (for \(\alpha\) and \(\beta\) cases) and green (for the \(\gamma\) case) lines show for each case in the plot 4(c) what are the c coefficients when the signal is sampled at its maximum. In the case \(\alpha\) (red full line) the normalization constant varies by 4% with the 25 phase values, and this results in a 4 % discontinuity of the c coefficient at the time value corresponding to the signal's maximum. This would prevent an easy parametrization of the OF coefficients. As ATLAS data are expected to be synchronous, and the signal sampled near their maximum, it might be useful to move this OF coefficients discontinuity by moving the bounds of the window used as shown in \(\gamma\) case (red dashed-dotted).

In the case of a delay run in the middle compartment of the barrel the signal is more asymmetric with respect to the peak and the discontinuity in the \(c_{j}\) coefficients is present regardless of what time period the signal is taken in. If the signal is taken between 25 and 150 ns, the discontinuity is at the peak of the signal in case of the calibration signal. The same plots are also shown with a physics pulse (in the middle layer) in the figure 5, where the discontinuity is not as the peak.

Figure 3: OF coefficients for the **time** in the cell (19,10) of the Module M10 in the Medium and High gain. The coefficients are calculated for the DAC=10000 value, for delay runs (DELAY) and for physics (LC).

Figure 4: The effect of the normalization constant on the OF \(c_{j}\) coefficients. The strip’s signal used in order to determine the coefficients is in (a). The normalization constant in shown in (b) for 3 different time references of the pulse: 1-125 ns (red full line), 5-130 ns (green dotted) and 25-150 ns (red dashed-dotted). The resulting \(c_{j}\) coefficients are in (c). The red (for \(\alpha\) and \(\beta\)) and green (for \(\gamma\)) lines show what are the c coefficients when the signal is sampled at its maximum.

Figure 5: The effect of the normalization constant on the OF \(c_{j}\) coefficients. The signal is a **physics** signal in the middle layer and in the medium gain. The signal is taken between 25 and 150 ns.

### Phase effects on the reconstructed time

Starting from a calibration signal, OF coefficients have been calculated for the 25 phase values, with 5 samples per phase value. If the optimal set of coefficients is applied to a set of five signal samples (\(g_{i1},...g_{i5}\) corresponding to a phase \(i\)), the reconstructed time will be 0 by construction and the reconstructed energy at its maximum. Instead of applying this "optimal" set of OF coefficients, one can apply to these five signal samples all the 25 sets of OF coefficients, assuming no knowledge of the correct phase3.

Footnote 3: For this example, the set of OF coefficients corresponding to the maximum of the signal is at “phase” = 23.

The reconstructed energy and time are presented in figure 6 for two cases : the ideal set of OF coefficients is the one corresponding to the phase value of 5 ns in the first case and 15 ns in the second case. The variation of the reconstructed time with the phase value is linear in both cases. The case of the signal sampled at its peak is also shown in figure 7. If a linear adjustment is done over the 25 phase values, the slope differs from 1 by up to 15%, as shown in the figure 8. The slope of the reconstructed time as a function of the phase value is compatible with 1 when the adjustment is done locally (\(\pm\) 5 ns) around the correct phase (figure 8), leading therefore to first order to a correct time determination 4.

Footnote 4: With this linear behavior, the correct phase can be easily retrieved with an iterative time computation in two or three trials.

At the start-up of LHC the OF coefficient phases used might not be the exact ones for all cells and an iterative phase retrieving can not be applied in the RODs. As shown in the figure 7 when the signal is sampled near its peak, a 5ns wrong phase would result in a 1.4% bias (ie

Figure 6: Effect of the use of the 25 phases on the reconstructed energy and time. The energy and the time have been derived with the phase value \(i\) = 1...25. The “optimal” set of the OF coefficients gives \(t\) = 0 and the energy is maximum (phase = 5 ns in the left and phase = 15ns on the right). The fit is over 25 ns in (a) and local in (b).

Figure 8: The slope obtained from the fit of the reconstructed time as a function of the 25 ns phase values see figure 6). If the slope is fitted locally (\(\pm 5ns\)), the slope is different from 1 (circles) by at most 2.3%.

Figure 7: The effect of the shift of the Of coefficients on the energy and the time when the signal is sampled at its peak. Note that the scale is smaller (1% in energy) compared to the figure 6 ( 20 % in energy).

70 ps for a 5 ns measurement) and a reconstructed 0.6% lower energy. For a 3ns wrong phase, these numbers become respectively 25 ps and 0.2% and would be acceptable.

## 3 Time resolution with the electronics

The ultimate time resolution of the calorimeter, given by the electronics alone, was determined using the calibration runs. The reconstructed time using the optimal filtering method is called \(t_{OF}\). The figure 9(a) shows the variation of the \(t_{OF}-time\) calibration trigger signal as a function of the 25 phases in the case of DAC = 10000, in the medium gain and in the middle cell with \((\eta,\phi)=(19,10)\), of the module M10. For these delay runs the calibration trigger signal is varied by an expected step of 1 ns using a programmable delay chip on the calibration board common to 16 calibrations channels ([6]). A clear 6.8ps/phase slope is observed compatible with a 0.993 ns step size instead of the assumed 1 ns value, in agreement with the board measurement characterization. After correction of this slope, the time resolution decreases from 144 ps to 135 ps, much higher than the expected performance of the electronics readout chain. A large fraction of this dispersion can be attributed to the jitter of the Trigger Timing Control (TTC) system and of the calibration line, and was observed by various measurements [6].

In order to extract the time resolution given by the electronics readout chain alone, the time difference between two channels pulsed simultaneously has been studied for energy up to 300 GeV (equivalent to DAC=20000). The figure 10 shows the resolution as a function of the calibration signal amplitude and the table 1 summarizes the result of a fit for various cases 5:

Figure 9: Top left: Reconstructed time \(t_{OF}-delay\) in the calibration runs for the middle cell \((\eta,\phi)=(19,10)\). Top : Time difference \(t_{OF}-delay\) in the cell as the function of the phase value. Bottom: same plots after the phase correction on the time difference.

* The two cells (\((\eta,\phi)=(19,10)\) and (27,10)) are pulsed simultaneously by **different calibration lines**. In this case the contribution from the jitter on the TTC calibration trigger signal is expected to be eliminated and the resolution dominated by the calibration line. The resolution saturates now at 80 ps resulting to a 56 ps contribution from the calibration line assuming there is no correlation between them and that the single cell electronics resolution can be neglected. By subtracting quadratically this number to the previous single cell resolution, the TTC contribution is found to be 122 ps. This number is in good agreement with measurements done on a dedicated test bench, and explained in more details latter in this note (see section 7).
* The two cells ((19,10) and (23,10)) are pulsed simultaneously by the **same calibration line**. The contribution from the calibration line is now also suppressed and the electronics readout contribution is now directly measured. The result can be translated in a 13 ps constant term for a single electronics cell. By comparison the result of a simple parabolic fit done on the 3 samples around the pulse's maximum, and used online, is also shown.
* The two cells ((19,10) and (19,8)) are in the **same calibration line and in the same Switch Capacitor Array (SCA) chip**6. This is expected to be the best case and allows to measure the SCA performance. The resolution is slightly improved leading to a single channel constant term of 9 ps in good agreement with testbench measurement [3][7]. Footnote 6: A SCA chip receives the signal of the three gains of four readout channels and applies a reference signal subtraction inside the chip.

In the strips (see Figure 11), only cells in the same calibration lines have been represented as it is not possible to have the two pulsed cells simultaneously in the same SCA chip. Cells (152,2) and (156,2) were used, corresponding to the strip region in front of the Module M10 (19,10) middle cell. The time resolution is also shown for the high gain7 in figures 11 and 12 and all the results for a single channel are summarized in table 2.

Footnote 7: The larger constant term in the High Gain comes from tha fact that the shape of the signal in the High Gain has been taken from the medium gain and shifted by 1.4ns.

### Calibration amplitude resolution

The amplitude resolution of the calibration signal has also been studied in order to look for a possible constant term in the signal reconstruction. As shown in figure 13, there is no evidence

\begin{table}
\begin{tabular}{||c|c||} \hline  & Medium gain \\ \hline different calibration lines & \((4.08\pm 0.77)\) nsGeV \(\oplus(79\pm 2)\) ps \\ \hline same calibration lines & \((3.56\pm 0.20)\) nsGeV \(\oplus(19\pm 2)\) ps \\ \hline same calibration lines and same SCA & \((3.57\pm 0.25)\) nsGeV \(\oplus(13\pm 2)\) ps \\ \hline \end{tabular}
\end{table}
Table 1: Resolution on time differences between two cells in the middle compartment and medium gain

\begin{table}
\begin{tabular}{||c|c|c|c||} \hline  & High gain & Med. gain & Med. gain, same SCA’s \\ \hline \hline Middle & 1.62 ns GeV \(\oplus\) 19ps & 2.55 ns GeV \(\oplus\)13ps & 2.52nsGeV \(\oplus\) 9 ps \\ \hline Strips & \((0.51\pm 0.02)\)nsGeV \(\oplus(30\pm 8)\)ps & \((0.74\pm 0.05)\)nsGeV \(\oplus(18\pm 1)\)ps & - \\ \hline \end{tabular}
\end{table}
Table 2: Summary of the resolutions with electronics for a single cell.

Figure 10: Time resolution in calibration runs obtained from time differences between cells. The cells are in the middle compartment, medium electronics gain, in module M10. The worst resolution is obtained when the two cells are in different calibration lines (80 ps constant term). When OF coefficients are applied on two cells in the same calibration line, the constant term is 19 ps, and reduces to 13 ps if the two cells are in the same analog pipeline SCA. For comparison, the time reconstructed with the parabola method (done online) around the peak sample is shown (open circles).

Figure 11: Time resolution in the strips, for 2 cells in the same calibration line, for the module M10 in the case of the high gain (a) and medium gain (b).

Figure 12: Time resolution in the middle compartment for the High gain. The two cells are in the came calibration line, but in different SCA’s.

of a deviation with respect to the noise expectation up to 100 GeV down to a 0.1 % resolution, resulting in a negligible constant term.

## 4 Test Beam Setup

The data used in this note were taken during the beam test periods in 2001 and 2002 with three final barrel calorimeter modules (modules M10, P13 and P15) in the the H8 beam line with electron beams with energies from 10 to 245 GeV. A module covers the pseudo-rapidity range \(0\to 1.4\) and \(2\pi/16\) in the \(\phi\) direction, corresponding to 56 \(\times\) 16 cells in \(\eta\times\phi\). The beam line is equipped with three scintillators (their size was about \(4\times 4cm^{2}\)) for triggering purposes in front of the calorimeter module. As the beam is not synchronous with the 40 MHz clock, the phase between the trigger and this clock is measured by a TDC. More details on the module and beam setup can be found in [3], and only information relevant to the time measurements will be recalled in this section.

### Trigger/40 MHz phase measurement setup

A simplified diagram of the TTC system [8] used in the beam test is displayed in Figure 14. The distribution of the trigger signals is the following :

* The L1 trigger from scintillator coincidences is connected to the PDC input which is a module which generates the calibration sequences and also implements a large fraction of the common L1 accept delay signal logic.

Figure 13: Amplitude resolution obtained with Calibration runs in the middle layer, as a function of the cell amplitude. The high and the medium gain are presented for one cell in the Module M10. The open circles show the expectation from the electronics noise term only. The line gives the fit of the electronics noise term (in the log -log representation).

* This delayed L1 signal is transmitted to the PDG module which resynchronizes this signal with an internal 40 MHz clock generated from a quartz on the module. The timing of these eight outputs, fed generally to different calorimeter regions or layers (presampler, strips, middle, back) via fanout modules, can be adjusted with a 50 ps accuracy. The common 40 MHz clock is also distributed to the Front End Electronics through the fanout module.
* One specific output of the PDG module is sent back to the control room via a TIR module. This signal, synchronized with the 40 MHz clock, is used as a the START signal of a TDC module while the L1 trigger from scintillator coincidences is used as a STOP so that the relative time between the L1 trigger and the 40 MHz sampling clock of the FEBs is measured. This relative time, called phase often in this note, should be the time reference to be compared to the calorimeter time computed by Optimal Filtering. The TDC least count is 50 ps, therefore should not be a limitation to the phase measurement.

As shown in next section with the calorimeter physics time resolution study, this system generates in fact a non negligible jitter. Some specific measurements have been performed either in CERN environment, either with dedicated test bench to quantify the contribution of each module and are presented in section 7.

### Phase measurement performance

As explained previously, one PDG output (synchronised with the 40 MHz clock ) and the scintillator L1 coincidence signal are used to measure the phase (tdc). Before 2002 the beam line was equipped for triggering purpose of scintillators and PMs not optimized for accurate time measurement, so that the time resolution was saturated around 300 ps (see next section). For the 2002 beam test period, a dedicated system has been installed to achieve better performance. It consists of two smaller scintillators (\(3cm^{2}\)) read out simultaneously at both ends by fast PM to compensate for time propagation within the scintillators. Using the same TDC as for the trigger scintillators, these four signal provide four additional measurements called tdcs1 and tdcs4 (respectively tdcs2 and tdcs3) for the first (resp. second) scintillator. Assuming no correlation between the measurement of each PM/scintillator, the intrinsic resolution can be extracted and is summarized in table 3[8]. In order to perform these measurements, long delay lines (\(\simeq\) 300 ns) have been added on the scintillator read-out using cable of rather poor quality therefore deteriorating the rising edge of these signals. The best cables were used for (tdcs2-tdcs3) and might explain the better resolution with respect to the second scintillator. The

Figure 14: The simplified TTC used in the beam test setup. In ATLAS, a single module, called controller board and located in the Front End Crate, distributes all these signals to the readout and calibration board.

main improvement of the phase measurement is expected to come from the simultaneous read out at both ends of the scintillator. As shown in Figure 15, depending on the impact position in the scintillator, the two measurements can differs by \(\pm\) 8 tdc counts (400 ps), and explain a large fraction of the individual measurement resolution. Averaging the two measurements (called \(time_{23}\) or \(time_{24}\)), this strong correlation is compensated, resulting in a much better estimate of the phase measurement. Again the resolution of these two new estimates of the phase time measurements can be extracted, assuming no correlation between them by looking at time differences as shown in Figure 16. The extracted resolution, demonstrated to be stable along the run period, are summarized in table 3 for the July and August 2002 runs. For a few runs the analog signal of the tdsc2 has been recorded in order to correct for a possible variation of the resolution with the amplitude. No significant improvement has been observed. It should be noted that the errors are only statistical and these numbers should be taken as a correct order of magnitude only, as the assumption of no correlation between these different estimates is not rigorously exact.

The intrinsic resolutions have been obtained by making differences of TDC measurements using the same common START coming from the L1 resynchronized PDG output, so that any jitter on this common signal is not taken into account on the above number and will result in a large constant term of the time resolution when comparing the calorimeter time measurement any of to these estimates. Finally when the electron shower has started too early and more than one mip is going through the scintillator, only the first rising edge is recorded resulting in a too small estimate of the time. To reject such a configuration the analog signal of one of the PM has been digitized and its distribution is presented on Figure 17. In the following a cut at 1350 adc count is applied to clean the data sample.

## 5 Calorimeter time resolution with electrons on the Module M10 (2001)

Because of the expected \(1/E\) time resolution behavior with the energy, the impact cell in the middle layer has intrinsically the best time accuracy. The time resolution is studied by comparing

Figure 16: The TDC resolutions for the cell (29,1) in the module P15 and for a cell (27,11) in the module P13. The difference between the time called \(time_{23}\) and the TDC time is shown in the top plot, the difference between \(time_{14}\) and the TDC time in the middle plot and the difference between \(time_{23}\) and \(time_{14}\) is in the lower plot.

Figure 15: Time difference versus the beam position as measured in the beam chamber.

the calorimeter time \(t_{OF}\) with the time given by the phase measurement system (TDC):

\[\sigma_{t}=\sigma(time_{OF}-time_{trigger})\]

where \(time_{OF}\) is the time given by the optimal filtering in the impact cell.

In the case of the module M10, the figure 18 gives the difference between the time reconstructed with the OF in the impact cell (tofl) and the time given by the TDC (Time). If the energy in the impact cell is above 150 GeV, the average time difference is centered at 0 and the time resolution is 315 ps, while from electronics calibration data 20 ps would be expected. If the energy is between 70 and 80 GeV, the time resolution is 335 ps while 29 ps would be expected

For this sample of data, there was only the standard trigger scintillator/clock measurement available and as shown previously its poor jitter (\(\simeq 300\)ps) is a strong limitation to the single cell time resolution study. For this set of data, to be insensitive to this jitter measurement, the time resolution has been studied by time differences between the middle calorimeter impact cell and the neighbor cell either in the \(\eta\) (the time is called _tofl_3 or in the \(\phi\) direction (the time is called _tofl_5). It should be observed that with such a method only the local time resolution can be studied as the absolute time is not measured.

As presented on Figure 18 the average time difference presents a bias as a function of the energy (371 ps when \(70\)GeV \(<E<80\)GeV ) and is explained by the the distortion of the pulse shape in the impact cell as the fraction of the energy in the neighbor cells due the increasing

Figure 17: Activity in one of the beam test scintillators.

cross-talk contribution. 9

Footnote 9: The same Optimal Filtering, therefore the same physics pulse shape, is used for the energy and time reconstruction whatever is the energy in the cell and its neighbors. If the cross-talk pulse shape would look like an exact derivative of the pulse shape, the reconstructed energy and time would have remained insensitive [2] to the cross-talk.

When making the difference between the time of the impact cell (typically 60% of the energy in the layer as shown on the distribution of figure 19) and the time of neighbor cell, the bias of this latter will become even worse reaching several nano-seconds and will have to be corrected for. In order to study qualitatively the effect of the cross talk on the reconstructed time, a toy Monte Carlo has been done using calibration data.

### Toy Monte-Carlo study for the effect of the Cross talk

Figure 20 shows in percent the cross talk signal in the neighbor cell as a function of the time (obtained from delay runs) for the \(\eta\) and the \(\phi\) neighbors in the middle layer of the calorimeter: the maximal amplitude goes up \(\simeq 2\%\) but with a quite different shape in the \(\eta\) and \(\phi\) direction. 10

Footnote 10: In the \(\phi\) direction the cross-talk is expected to come only from the summing boards which group four electrodes to build a readout cell and, as observed, the contribution is mainly inductive. In the \(\eta\) direction, an additional contribution is expected to come from the detector itself via capacitive coupling [9], but of different sign so that the total cross-talk observed in this direction is smaller in amplitude but less uniform from one cell to another.

To study the impact of the cross-talk on the time reconstruction the following procedure has been done: starting from the pulse shape in a given cell without any crosstalk, the optimal filtering coefficients are calculated. These coefficients are applied to a waveform which is the weighted sum of the pulse shape and the cross-talk shape, the weight being the energy ratio between the two cells.

The figure 21 shows the reconstructed time in the cell (the most energetic, cell1, in the upper plot and the neighbor, cell 3, in the lower plot) as a function of the phase value, and for an

Figure 18: For the impact cell (19,10), the difference between the OF reconstructed time (tofl) and the TDC time (time). Top: Energy(19,10)\(>\)150 GeV. Bottom: 70 GeV \(<\) Energy (19,10)\(<\) 80 GeV. The bias on the average \(tof1\)\(-Time\) distribution is increasing due to the cross-talk effects.

energy ratio R between cells of 10 close to the average cell's energy ratio shown in the figure 19. In the top plot, the reconstructed time in the cell 1 shows a negligible bias of \(\simeq 10\)ps with a time dispersion over the phase of the same order. Indeed \(R=E_{cell3}/E_{cell1}=0.1\) therefore the maximal distortion is less than 0.2%.

As expected, the bias is larger for the reconstructed time in the neighbor cell (cell 3) The gain ratio being 10, distortion up to 20 % appear resulting in a 1.5 ns bias on the average reconstruction time. Moreover the phase dependence time reconstruction amounts also up to 0.5 ns can not be neglected.

The time difference between the 2 cells is shown in figure 22 as a function of the phase and can be corrected for by a 3rd degree polynomial function). This is in qualitative agreement with what is observed in physics runs (see next section).

The bias of the average reconstructed time and dispersion versus the phase has been estimated as a function of the energy ratio between the two considered cells and is presented in Figure 23. The top plot shows the small effect of the cross talk on the time in the impact cell (when R is less than 1, resulting in a time bias below 200 ps) while the bottom plot shows the effects in the neighbor cell. In this simplified approach with only two cells the bias and the dispersion vary linearly with the energy ratio which is in quite good qualitative agreement with what is observed : for instance in figure 25 the time dispersion with the phase varies also linearly with the energy. Nevertheless the corrections, especially phase dependent ones, can not be derived from this model and should be determined on the data directly.

Figure 19: Energy in the most energetic cell (19,10) (top) and the most energetic neighbors in \(\eta\) (eneof3 for (20,10)) and in \(\phi\) (eneof5 for (19,11)).

### Calorimeter time resolution with electron data

Because of the corrections for the cross-talk and especially for the phase effects (depending on the energy value of the neighbor cell) that need to be applied on the electron data, a large statistics is needed in order to determine the 3rd order polynomial corrections. In the case of the module M10, only the physics runs with the impact cell [19, 10] have been used, where more than 200000 electrons have been accumulated. The reconstructed energy and time with the optimal filtering, the electronics gain value, and the SCA capacitor address corresponding to the central sample have been recorded for the following cells: 11

Footnote 11: The optimal filtering coefficients used are the:

_OF4-M10MED-LCphys.average_ for the medium gain and

_OF4-M10HIGH-LCphys.average_ for the high gain.

* the impact cell is in the middle [19,10]. The time is \(tof1\).
* 2 \(\eta\) neighbors: [18,10] and [20,10]. The time in the cell [20,10] is called \(tof3\).
* 2 \(\phi\) neighbors: [19,9] and [19,11]. The time in the cell [19,11] is called \(tof5\).

#### 5.2.1 Time difference between neighbors in the \(\eta\) direction

A few selection cuts have been applied : the cluster energy is required to be above 210 GeV, the impact cell to be [19,10] and the energy in this impact cell larger than 100 GeV. The gain transition occurs at an energy threshold about 25 GeV in the middle compartment, so that the impact cell is always recording in the medium gain while the neighbor cell is most of the time measured in the high gain.

Figure 20: (a) Cross talk signal in percent in the neighbor cell in the \(\eta\) direction. (b) Cross talk in the \(\phi\) direction when the cell [19,10] is pulsed.

Figure 21: Reconstructed time as the function of the phase, with the cross talk taken into account. In the top plot, the energy ratio between cells is R = 0.1, meaning that the reconstructed time is the one in the cell with the highest energy, (19,10) in our case. In the bottom plot, the energy ratio is R = 10. In that case, it is the time in the cell with the lowest energy which is considered, (20,10) in our case. That cell receives a large cross talk for the neighbor cell (19,10) which has a 10 time higher energy. Both cells are in the middle compartment.

Figure 22: Time difference \(tof3-tof1\) between two neighbor cells (with cross talk, R=10) as a function of the phase value

Figure 23: The time bias and the RMS due to the 25 phase values resulting from the cross-talk between cells. Values are given as a function of the energy ratio between cells. The time is reconstructed in the cell which receives the cross talk with a value R from the neighbor cell. \(R<1\) in the top plot, meaning that the time is the one in the impact cell. When \(R>1\), the time is the one in the neighbor cell.

Figure 24 shows the dependence on the time difference between the cell (20,10) and the TDC time as a function of the energy ratio between that cell and the impact one. The variation with the energy ratio is not linear, demonstrating that the previous model was too naive, but it gives the order of magnitude of the cross talk effect. A hyperbolic correction is applied on _tof_3 as a function of the ratio R 12.

Footnote 12: The time of the impact cell _tof_1 has not be corrected for the energy ratio as its effect variation has been demonstrated to be negligible for our analysis.

After that correction, the time difference between tof3 and tof1 has a 3rd order degree polynomial variation as a function of the phase, as shown in the figure 25(a). This correction is applied in bin of energy of the neighbor cell. The dispersion versus the phase is now quite similar for each energy bin with a maximal dispersion of \(\pm 0.2\)ns (see figure 25(b)) apart from a restricted region of about 2 ns (around the 16ns time bin). Before any phase dependence or energy ratio correction, this peak was already observed on the time difference between the two cells as demonstrated by the Figure 26. Moreover this effect is much more pronounced when the energy in the neighbor cell is small. The same effect has been observed with data of a different module P13, but disappears when the time is reconstructed only with a parabolic fit around the maximum of the pulse. Moreover this time bin is close to the phase where one of the samples is at the maximum of the signal. As shown in next section, such a behavior is still present when looking at single cell resolution and should result from the not enough accurate prediction of the physics pulse shape.

The final distribution on the time difference for two \(\eta\) neighbor cells is shown in the figure 27 : the distribution is Gaussian leading to a 90 ps resolution when the neighbor cell

Figure 24: Top: The time difference between the cell (20,10) and the TDC time as a function of the energy ratio between the cell (20,10) and the impact cell (19,10). Bottom: After the correction by a hyperbolic function, the corrected time difference is flat with the energy ratio.

Figure 26: Before any corrections, the time difference between 2 cells in the \(\eta\) direction, for 2 energy bins in the cell (20,10) (\(E<5\) GeV (lower set of points, black) and \(5<E<7\) GeV (upper set of points, red)).

Figure 25: (a) After the correction of \(tof3\), the time difference between the 2 cells as a function of the TDC time, and as function of the energy in the cell (20,10). (b)After the phase correction, the time difference between 2 cells in the \(\eta\) direction, for several energy bins in the cell (20,10) (black \(E<5\) GeV, red \(5<E<7\) GeV and pink \(19<E<21\) GeV.)

has a energy greater than 40 GeV. From the electronics time resolution in table 2 and adding quadratically the contribution of the two cells, one would have expected a dispersion of 72 ps in fair agreement with the result.

#### 5.2.2 Time difference between neighbors in the \(\phi\)

When the neighbor cell is taken in the \(\phi\) direction, the energy deposited in the cell (19,11) is higher then in the cell (20,10), due to the accordion geometry, therefore reconstructed either in high gain, either in medium gain, so that the energy ratio dependence of the time in (19,11) (called _tof_5) needs to be determined separately for the two gains. These distributions and corrections are shown in figure 28. The large time variations are due to the larger cross talk amplitude. The corrected time is flat within \(\pm\)100ps.

Figure 29 shows the time between two cells in the \(\phi\) direction before and after the phase corrections (with a high order polynomial) for various energy bins of the cell (19,11).

The calorimeter time resolution extracted from the cell time differences in both directions is summarized in the figure 30 as a function of the energy in the neighbor cell.

### Time resolution using three samples

As demonstrated the computation of the optimal filtering coefficients needs a good knowledge of the physics pulse shape. The various analysis have shown that it was difficult to reproduce with a good accuracy the beginning of the pulse (especially the calibration pulse) which is very sensitive to the presence of an inductance seen in series on the physics pulse and parallel on the calibration pulse [3][10]. For the cells where this region is not well described it might be interesting to use three samples only. For that purpose, new 3 x 25 sets of OF coefficients have been calculated for the physics and delay runs, and the corresponding energy and time have

Figure 27: Time difference in the medium gain, when the neighbor energy has more than 40 GeV, and the impact cell more than 100 GeV. The resolution is 90 ps, in agreement with the electronics.

Figure 29: Time between two cells in the \(\phi\) direction as a function of the phase value, for different energy bins, before (left) and after (right) the phase correction. Black: \(10<E_{5}<15\) GeV, red: \(25<E_{5}<30\) GeV, green: \(E_{5}>60\) GeV.

Figure 28: Top: time difference between the time in the neighbor cell and the TDC time as a function of the energy ratio between 2 cells in the \(\phi\) direction. Bottom: After the energy ratio correction. Medium gain is on the left, High gain is on the right.

Figure 30: Time resolution in physics run around the Module M10 (19,10) impact cell, for \(\eta\) and \(\phi\) neighbors. The solid line gives the expectations of the electronics. In the “electronics” resolution, the 30 ps coming from the resolution of the impact cell (whose energy is above 100 GeV) have been added quadratically to the resolution in the medium gain only where it is not negligible. The dashed line shows the result of the fit on the data points with a function \(\sigma_{t}=\frac{a}{E}\oplus c\).

been determined. In the case of physics runs, the energy and time coefficients are shown in Figure 31.

Figure 32 shows the resolution obtained in this case as a function of the energy in the neighbor in the \(\eta\) direction (the impact cell is (19,10) in the module M10). The resolution is not significantly deteriorated except at low energy and remains acceptable. As demonstrated in [11], the noise reduction factor will decrease from 1.8 to 1.5 for a typical middle layer cell.

### Time variation with the SCA capacitor number address

From test bench measurements it has been shown that the sampling clock frequency of the pipeline is not constant along the 144 SCA capacitors of the pipeline [7] and would result in a bias on the reconstructed time as a function of the capacitor number if not corrected. In the beam test where the trigger rate is small, the recorded seven samples are always in consecutive capacitors and identical between all cells for a given event. Consequently it has no impact on the previous analysis using the time difference of two cells but should be observable on the single time reconstruction versus the capacitor number, as the sampling time is assumed to be constant to 25 ns. This is shown in Figure 33 : a clear 2.1 ps / capacitor is measured in very good agreement with the 1.9 ps measured on test bench on a few SCA chips [3]. Locally on 5 samples, this dispersion of the sampling frequency can be neglected and only a linear correction on the time reconstructed by optimal filtering is applied. Even though the correction is known not to be the dominant contribution to the time resolution for the M10 module, this correction has been applied and the result is shown in Figure 34. The contribution to the calorimeter resolution of this dependence is about 90ps.

In the final design of the SCA chip, the read and write addresses have been decoded differently to reduce the discontinuity between the first and last capacitor. Instead of the 300

Figure 31: OF filtering coefficients for energy and time reconstruction using three samples only

Figure 32: Time resolution in the module M10 around the impact cell (19,10) with 5 OF coefficients (full symbol) and only the central 3 coefficients (open symbol) in the medium and the high gain.The solid line gives the expected resolution for a single cell from the table 2. In the medium gain, 30 ps coming from the resolution of the impact cell have been quadratically added.

ps difference the sampling frequency will decrease with the 2ps slope between capacitor 1 and 72 and then increase with the same slope up to capacitor 144. It should be noted that in LHC-like conditions with a much higher trigger rate that in the beam test conditions beam, the consecutive samples of a signal are not expected to appear in consecutive capacitors, so that a linear correction as a function of the capacitor number of the central sample will not allow to reach the ultimate time performance.

Figure 33: Time difference between \(tof1\) and the TDC time as a function of the SCA capacitor number of the 4th sample

## 6 Calorimeter time resolution with electrons on the Module P13 (2002)

As already explained in Section 4, to study the single calorimeter resolution and the absolute time measurement a better phase measurement system has been installed for the 2002 beam period.

### Calorimeter time resolution with single cell

The reconstructed time of the middle layer cell impact cell, _tof1_, 13 has been compared to the measured phase of the new system (_time\({}_{23}\)_) or the standard one used in 2001. After some selection cuts requiring that the cell (27,11) be the impact cell and the electron energy is larger than 210 GeV, their raw distribution are shown in Figure 35 without the SCA capacitor correction. The dispersion is clearly improved with the new phase estimate (by about 240 ps) but the r.m.s is still larger than what would be expected from the electronics and phase resolution estimated in section 4. As shown in Figure 36 for various position in \(\eta\), this is quite uniform and can not be attributed to the studied cell.

Footnote 13: The Optimal coefficients used for the P13 module are:

_OF4-P13MED-set.average_

_OF4-P13HG-set.average_

In order to try to improve this dispersion a few effects have been identified and corrected for :

* The calorimeter time dependence with the SCA capacitor has been determined for this electronics channel and is presented in Figure 37. After this correction is applied the resolution decreases from 212 ps to 190 ps. The residual contribution to the resolution of this correction has been estimated to about 20 ps.
* Even if the effect of crosstalk is expected to be smaller than with the cell time difference method, a correction might be needed for. Indeed the figure 38 shows a clear correlation

Figure 34: Time resolution for the cell (19,10) in module M10 after correction of the SCA capacitor effectFigure 36: For the line \(\phi=11\) in the module P13, the time resolution with the impact cell with the standard TDC (\(time\)) and the TDC specific to the 2002 test beam (\(time_{23}\)) as a function of the \(\eta\). In the bottom plot, the resolutions of each TDC have been subtracted quadratically.

Figure 35: Time difference between the calorimeter time and the TDC times. Left: with the July 2002 new system, Right: with the standard TDC

between the reconstructed time and the fraction of energy within the layer of the studied cell. The energy distribution of the impact cell is also shown. As the impact cell receives mainly sum contributions of cross-talk from four cells in the same layer (right/left and up/down neighbor), which are quite asymmetric between the \(\eta\) and \(\phi\) direction, the energy fraction in the impact cell is obviously not the most sensitive variable. The effect of the cross-talk, quite sizable, has been corrected as a function of the barycenter in \(\eta\) and \(\phi\) direction as presented in Figure 39. The residual contribution to the resolution has been estimated to be 20 (resp. 25 ps) in the \(\eta\) (resp. \(\phi\) direction). It is interesting to notice that the accordion structure in the \(\phi\) direction still induces a visible small bias of the calorimeter time, explained by the sampling fraction variation over the cell. With these corrections, the dispersion decreases to 163 ps (see Figure 41).
* A small capacitive cross-talk is also expected between the impact cell in the middle layer and the back layer. To investigate this effect the variation of (Tofl-Time23) versus the ratio between the energy in the back layer and the energy in the impact cell has been studied (see Figure 40). This variation has been corrected for but the improvement is rather marginal as shown in Figure 41 and will not be applied in the following. The residual contribution to the dispersion is estimated to be \(<10\) ps.

The dependence of the reconstructed time as a function of the phase has been investigated on Figure 40. Although by construction of the OF coefficients, it should be flat, a clear structure appears with again a peak around 17 ns. Such a behavior reflects the insufficient knowledge of the physics pulse shape prediction and remains as a strong limitation to the resolution around 50 ps.

Finally the resolution has been studied as a function of the cell energy as shown in Figure 42. After subtraction of the expected scintillator resolution, a constant term of 130 ps is

Figure 37: (a) Correlation between calorimeter time and SCA capacitor number. (b) tofl-time23 dispersion after correction.

Figure 39: (a) tofl-time23 versus \(\eta\) barycenter before (full circle) and after (open circle) correction. (b) tofl-time23 versus \(\phi\) barycenter before (full circle) and after (open circle) correction.

Figure 38: (a) Energy distribution in the impact cell. (b) tofl-time23 variation versus the energy fraction in the impact cell.

Figure 41: (a): tof1-time23 after \(\eta\) and \(\phi\) correction. (b): tof1-time23 after back correction.

Figure 40: (a): tof1-time23 versus back energy/ impact cell energy. (b): tof1-time23 versus phase.

measured while a 20 ps constant term would have been expected from the electronics performance. Summing quadratically all the estimate of the residual corrections will amount to 63 ps 14 so that there is still a contribution larger than 110 ps to be understood. As already said in section 4, only the jitter on the phase dispersion of the TDC STOP is estimated and subtracted while a common jitter to the START pulse can be a contribution to the time difference resolution between the calorimeter and any individual TDC channel. Some measurements have been performed at CERN during the test beam and on a dedicated bench to understand this limitation of the system and presented in the next section.

Footnote 14: \(63ps=20ps\oplus 20ps\oplus 25ps\oplus 50ps\) coming for the residual corrections after SCA, \(\eta\) and \(\phi\) barycenter corrections and the phase effect.

### Results with time differences between cells

Since the jitter limitation due to the beam test setup was still present in the module P13, the time resolution analysis was done also with time difference between cells, in the same way as for the module M10, with corrections for the cross talk and phase effects. The results are shown in figure 43. The resolution for the electronics is that of the module M10, as there were no optimal filtering coefficients produced for the delay runs in the module P13. The agreement with the electronics is not as good as for the module M10.

Figure 42: Time resolution before (right) and after (right) trigger/clock dispersion subtraction. The values subtracted computed on this specific event sample are respectively 89 ps, 147 ps for \(time_{23}\) and \(time_{14}\), while 260 ps have been subtracted for \(time\) for a better agreement. 320 ps were calculated for \(time\) showing that there are some correlations between these variables. In this plot, all the previously mentioned corrections except the one for the time varaition with the back energy deposit have been applied.

Figure 43: (a) Time resolution in physics runs around the Module M13 (27,11) impact cell, for \(\eta\) and \(\phi\) neighbors. The electronics is represented with a solid line, the fit of the data with the dashed line. (b) Time difference between 2 cells when the neighbor energy is between 60 and 70 GeV, and the impact cell has more than 100 GeV.

Understanding time resolution limitations

In order to investigate the origin of the time resolution limitation at \(\simeq 200\) ps observed during the 2001 and 2002 test beam, several measurements have been done both at CERN during July and August 2002 and on a test bench at the LPNHE at the end of 2002.

### Measurements at CERN

The intrinsic jitter of the PDG resynchronized output channels has been investigated. For instance in Figure 44(a), the PDG output corresponding to the presampler layer has been used as a STOP of the TDC while the L1 from TTC used as START remains the same used for the phase measurements. A 50 ps jitter has been observed. As this signal is distributed to the Front End readout via the fanout modules, the same measurement have been done at the output of with these modules, given again a contribution of about 50 ps.

A jitter less than 50 ps (almost the TDC resolution) is observed among all the PDG outputs. A possible jitter on the 40 MHz clock has been also investigated by using a different 10 MHz clock as STOP, the START being still given by the L1 from TTC. The resolution of each of the peak observed is slightly larger than 50 ps as shown in 44(b). The possible contribution of the PDC module has not been investigated in situ.

### Measurements at a test bench

The main goal of these measurements was to study the PDC jitter but for consistency similar measurements as done at CERN were also repeated. The test bench consists of a Phillips pulse generator used to simulate the NIM trigger signal with a negligible jitter and a 50 GHz numerical oscilloscope (leCroy 9362) to acquire data. The oscilloscope triggers on channel 2 for example, and the difference between the channel's 1 rising edge and the channel's 2 rising edge is recorded. This measure gives the jitter directly if the two channels are synchronous. The precision of the method and of the setup is \(\simeq 30\) ps ([12]).

Figure 44: Jitter measurements done at CERN. One TDC count is 50 ps.

The jitter between two clocks of the PDG has been measured between 65 and 90 ps while the jitter between the clock and the trigger outputs of the PDG has been found to be 50 ps (see figure 45) as measured at CERN.

To measure the whole jitter of the system between the input of the PDC and the trigger or clock output of the PDG, the measurement has to deal with non synchronous signals distributed over 25 ns. In order to estimate the jitter in this configuration, the resolution on the rising and falling edge of the flat distribution are obtained by fitting half a Gaussian curve on the edges.

First the jitter between the clock and the PDC input has been looked at, recording two periods on the oscilloscope, allowing therefore four estimates of the jitter by fitting the falling and rising edge of each flat distribution as displayed in figure 46(a). The jitter is about 150-160 ps, ignoring the first plot which suffers from a problem due to the method. The same measurement has been done between the PDC input and any PDG trigger output as shown in 46(b). The two estimates (only one period used) give a value between 80 and 120 ps, smaller than what is expected, if no correlation, when one subtracts the trigger/clock jitter of 50 ps to the previous 150 ps. The various measurements are summarized in Table 4.

To conclude this \(\simeq\) 100 ps jitter, common to all TDC measurements as appearing on the START signal, is expected to contribute directly when comparing to the TDC trigger/clock measurement with the calorimeter time. The constant term of the resolution can therefore be summarized as the quadratic of sum of :

* The contribution of the START signal in the trigger/clock measurement, difficult to estimate with a good accuracy and not done during the data taken period : \(\sigma_{TTC}\simeq 100\)ps.
* 50 ps contribution at the fanout level.
* The various residual dependencies after correction of the SCA capacitor effect, the cross-talk, or the phase : \(\sigma_{cor}\simeq 63\)ps.

Figure 45: The difference between the rising edge of the clock PDG output and the rising edge of the trigger PDG output.

[MISSING_PAGE_EMPTY:40]

Calorimeter time intercalibration

Up to now only the resolution and constant term in a single cell, therefore locally, has been studied. In ATLAS, above 50 GeV transverse momentum, the calorimeter time resolution will be dominated by the overall time constant term which is the quadratic sum of the local constant term and the dispersion of the absolute time of each channel. The first intercalibration set of constants can be in principle derived from the calibration pulses and the knowledge of the detector readout path. As shown in part 2.3, up to a 3 ns wrong phase would lead to an acceptable degradation of the calorimeter performance for the first set of OF coefficients loaded in the RODs at the starting of ATLAS. Typically a 1 ns dispersion would be thus desirable. Using electron beam data, the achievable accuracy estimated over half a barrel module of the calorimeter, i.e. about 300 cells, is presented. Before the first collisions in LHC, cosmics muon data can be recorded. The resolution of the muon time reconstruction and their use to check the intercalibration has also been studied. Finally to conclude, the possible strategy for the final time intercalibration is described.

### Time Intercalibration from calibration pulses

#### 8.1.1 Determination of pulse starting time \(T_{0}\)

The study has been performed using data on the middle layer of the module P13 only in the medium electronics gain. As the best time resolution is not needed for this study and all OF filtering coefficients not available for the calibration signals, the \(T_{0}\) has been determined using a parabolic fit on the pulse shape from delay runs, or from the physics runs where the considered cell is the impact one to minimize the cross-talk biases (see Figure 47). In the case of physics profiles, in order to reduce the sensitivity to the noise, the profile of the pulse is normalized event by event to the reconstructed energy estimated by OF method, once the pedestal is subtracted. The parabolic fit is performed over \(\pm\) 10 ns around the peak maximum providing the time corresponding to the maximum \(T_{max}\). Then the pulse starting time \(T_{0}\) is defined as the time for which the amplitude is equal to 10% of the amplitude of the maximum.

As shown in [3], the detector inductance and capacitance varies as a function of \(\eta\) and might modify the estimate of the \(T_{0}\) especially for the calibration pulses distorted over the first

Figure 47: The pulse shape profile in the Delay run (a) and in a Physics run (for the middle cell (\(\eta=17,\phi=11\)). The time at the maximum and the time at 10 % are shown.

10 ns by the inductance in parallel to the readout path. The detector capacitance might affect the \(T_{\textit{max}}\) but in a quite similar way for the physics and calibration pulse.The figure 48 shows the variations of L and C at warm as a function of \(\eta\) for one production module of the barrel calorimeter. The estimated effect, using a electronics pulse simulation, is :

* For \(\eta<0.8\) the local 5 nH inductance variation observed introduces a \(\simeq+200ps\) effect on the physic's \(T_{0_{phys}}\) and a \(\simeq-300ps\) effect on the calibration \(T_{0_{calib}}\). If the pulse start time had been defined at 20 % or 30 % of the pulse maximum, the effect of L variation would have been more important. A capacitance variation of 0.15 nF induce \(\simeq+400\) ps variation on \(T_{0_{phys}}\) estimate and \(\simeq-300\) ps variation on \(T_{0_{calib}}\). Summing these contributions would translate in a maximum dispersion of 350 ps on the absolute time (\(\Delta T_{0}=T_{0_{phys}}-T_{0_{calib}}\)) intercalibration.
* For \(\eta>0.8\), the inductance and capacitance variations tends to compensate each other and the dispersion is expected to be about 60 ps

Similar variations are expected at cold and has been estimated small enough not to be corrected for in the following study.

#### 8.1.2 Corrections applied on \(T_{0}\)

Several known differences on the calibration and physics pulse paths have to be taken into account before comparing them :

* Different adjustable delay values (PDG) in physics and calibration as the trigger is different.
* Varying time of flight in physics runs as a function of \(\eta\)
* Different calibration cable length as a function of \(\eta\)
* Different read-out cable lengths as a function of \(\eta\) (same variation in physics and calibration runs)

Figure 48: Measured L and C variations as a function of \(\eta\), for different \(\phi\) values.

PDG values_

The trigger time for physics pulse has been adjusted using the PDG by region of \(\Delta\eta\) = 0.2 in order to sample the pulse around its peak as online the OF reconstruction method was not applied. In calibration delay runs two regions only were considered (\(\eta<0.8\) and \(\eta>0.8\)). In the case of the P13 module, the values of the PDGs are summarized in the following table 5 (the \(\eta\) region 0.4-0.6 has been taken as the reference region):

_Time of flight effects_

The distance between the scintillators which define the trigger and the calorimeter front face varies as a function of the \(\eta\). The variations of the time of flight [13] are shown in the figure 49. They are derived from the movement of the cryostat table with respect to the beam line. There is a 4 ns difference between the center and the edge of the module.

\begin{table}
\begin{tabular}{|c|c|} \hline \(0<\eta<0.8\) & 3.03 m \\ \(0.8<\eta<1.0\) & 3.28 m \\ \(1.0<\eta<1.2\) & 3.48 m \\ \(1.2<\eta<1.4\) & 3.78 m \\ \hline \end{tabular}
\end{table}
Table 6: Average calibration cable lengths as a function of \(\eta\).

Figure 49: Time of flight variations in the test beam set up as a function of \(\eta\).

\begin{table}
\begin{tabular}{|c|c|c|} \hline Eta & PDG in Physics & PDG in Calibration \\ \hline
0 - 0.2 & 5.6 ns & 1.45 ns \\
0.2 - 0.4 & 4.5 ns & 1.45 ns \\
0.4 - 0.6 & 0 ns & 1.45 ns \\
0.6 - 0.8 & 0.6 ns & 1.45 ns \\
0.8 - 1.0 & -1.7 ns & 0 ns \\
1.0 - 1.2 & -5.85 ns & 0 ns \\
1.2 - 1.4 & -4.75 ns & 0 ns \\ \hline \end{tabular}
\end{table}
Table 5: Programmable delay values used in physics and delay runs in the module P13.

_Calibration and read out cable length_

The lengths of the cables which bring the calibration from the feedtrough to the detector have been optimized as a function of \(\eta\) and have to be taken into account. Their lengths are summarized in table 6. During the production of the detector cables, the time propagation was measured. The figure 50 shows theses measurements for the cables used in the P13 module, normalized to the smaller cable length. An average propagation velocity of \(\simeq 5.5\) ns/m. is extracted and will be used 15. Although in principle seen in the same way by the calibration and physics pulse, the different read-out cable lengths (see table 7) have also been corrected.

Footnote 15: The variation of the propagation velocity in the cable between warm and argon temperature has been neglected

#### 8.1.3 Results

The various corrections applied on \(T_{0}\) for the physics pulses consecutively are shown in the figure 51 as a function of \(\eta\) and for six different \(\phi\) lines from 9 to 14. The same distribution are shown for the calibration pulses in Figure 52. In both cases a 16-channel structure along \(\eta\) is observed with a positive slope for \(\phi=9,10,11\) and a negative slope for \(\phi=12,13,14\). Such a granularity of 16 channels in \(\eta\) corresponds to the FEB granularity in the middle layer (16 channels in \(\eta\) and 8 channels in \(\phi\)). To understand this effect, the \(T_{0}\) distribution has been displayed as a function of the FEB channel number in Figure 53 : A clear positive slope is observed on the 64 first channels (corresponding to \(\phi=8-11\) and negative on the 64 last (corresponding to \(\phi=12-15\)). This effect has been understood to come from some delays in the command design path coming from the SCA controller chip (one par FEB) up to each individual pipeline SCA chip. The same effect has been confirmed by test bench measurements [14]. Different slopes have been extracted in the physics and calibration pulses and corrected separately.

\begin{table}
\begin{tabular}{|c|c|} \hline \(0<\eta<0.4\) & 3.03 m \\ \(0.4<\eta<0.8\) & 2.31 m \\ \(0.8<\eta<1.2\) & 1.37 m \\ \(1.2<\eta<1.4\) & 0.45 m \\ \hline \end{tabular}
\end{table}
Table 7: Read-out cable lengths as a function of \(\eta\).

Figure 50: Individual propagation times for each Axon calibration cable in P13 for \(\eta<1.2\).

Figure 51: The left set of figures shows the effect of the three previous corrections of the physics starting time in the case of the \(\phi\) lines \(\phi=9,10,11\) of the module P13. The right plots show the same in the case of \(\phi=12,13,14\). In each case, the initial \(T_{0}\) is shown on the top left figure. The effect of the PDG correction is then applied on top right, time of flight is subtracted on bottom left, and read out cable length is subtracted on bottom right, giving the final \(T_{0}\). Color code: black: \(\phi=9\), red \(\phi=10\), green \(\phi=11\), blue \(\phi=11\), orange \(\phi=13\), red \(\phi=14\).

Figure 52: The left set of figures shows the effect of the three previous corrections of the **calibration** starting time in the case of the phi lines \(\phi=9,10,11\) of the module P13. The right plot show the same in the case of \(\phi=12,13,14\). The initial \(T_{0}\) is shown on the top left figure in each case. The effect of the PDG correction is applied on the top right figure, the calibration cable length is subtracted on bottom left, and read out cable length is subtracted on bottom right giving the final \(T_{0}\). The color code is the same as in the figure 51.

Figure 53: The \(T_{0}\) after the PDG and cable lengths corrections as a function of the FEB channel number, for physics and calibration runs and for the cells in the middle compartment.

A possible dependence of the \(T_{0}\) with the calibration line (for instance distribution on the mother board) common to eight different readout channels in a \(\Delta\eta=0.2\) region has been investigated. These distributions are presented in figure 54 for the calibration and the physics. No effect are observed on the physics pulses as expected while a small dependence is maybe present on the calibration especially for the 4 smallest calibration lines. This effect has not be taken into account.

The distribution of the time difference between the calibration and physics \(T_{0}\) after all corrections is shown as a function of \(\eta\) in Figure 55 (a) averaged over \(\phi\) where no more slope effect appears. It seems to remain a small intercalibration problem between the \(\eta>0.8\) and \(\eta<0.8\) region which might come from the fact that the calibration are taken in different runs for these two regions. Moreover for \(\eta>0.8\) the dispersion seems reduced which might be partially explained by the L and C compensation. Finally the dispersion of the physics and calibration pulse time estimates is shown in 55 (b) and amounts to 820 ps for more than 250 cells. Such a result shows that reaching a 1 ns r.m.s on the absolute time intercalibration of the middle layer cells starting from the calibration pulses will be possible for the ATLAS calorimeter.

Figure 54: After the FEB slope, the PDG and cable length corrections, the \(T_{0}\) as a function of the calibration line number in delay runs (a) and physics runs (b) in region of \(\Delta\eta=0.2\).

Figure 55: (a)Difference between physics and calibration start times as a function of \(\eta\) after all the described corrections are taken into account. (b)The final difference between the physics and calibration start times after all corrections.

### Intercalibration with muons

During the commissioning phase of the ATLAS calorimeter, some cosmic muons will be recorded and might allow many checks for physics pulses such as dead channels, first energy scale calibration, relative positioning of the calorimeter in the ATLAS frame...and finally physics timing checking if the accuracy achievable is at the same level of the previous method from the calibration pulses.

The time resolution on muons signals, on average 300 MeV energy deposited, has been investigated with beam test muons. The time resolution obtained at \(\eta=0.48\) is presented in Figure 56. The distribution well gaussian has a resolution of 6 ns in good agreement with what is expected at these energies in the high gain from electronics itself. In the beam test, the muons are always projective while this is not the case for cosmic muons leading probably for a deterioration of the performance: a good compromise between pseudo-projective cosmic muon and enough statistic needs to be refined. This result has been obtained using asynchronous muons events. Accumulating about 100 events per cell should therefore allow to achieve a determination of the calorimeter cell time better than 1 ns and directly comparable to the prediction from the calibration pulse method.

### Time intercalibration in ATLAS

To achieve an overall constant term of 100 ps on the time measurement with the ATLAS calorimeter, as required by the physics, the following steps can be followed :

* Starting from the calibration pulses and the read out path knowledge, the physics \(T_{0}\) can be determined with a 1 ns accuracy. Over the whole calorimeter, some symmetries between

Figure 56: (a) Time resolution with calibration runs in the high gain in the middle compartment for a single cell. (b) Time resolutions of the muon events with physics runs.

the modules and/or the positive and negative \(\eta\) can be used to determine some systematics not found with the restricted region used in the beam test analysis.
* Using cosmic muons on a large fraction of the barrel acceptance, the predicted physics \(T_{\bar{0}}\) can be compared with real physics pulse time measurements. For the endcaps, beam-gas collision during the single beam commissioning phase might be used.
* At the starting of the LHC, the time distribution of the impact cell for inclusive electron trigger with a transverse momentum larger than typically 50 GeV for events coming from the primary vertex should be recorded. Any deviation with the bunch crossing time should be used as a correction to the cell intercalibration. At these energies a local resolution better than 100 ps should be reached so that about hundred events per cell are enough to obtain the cell time with a very good accuracy. Such a procedure can be iterative and the calibration be followed with physics events on a very small time scale over the LHC running for monitoring purposes. A cross-check of this calibration can also be done using \(Z\to e^{+}e^{-}\) events.

## 9 Conclusion

The performance of the ATLAS Liquid Argon Calorimeter time reconstruction has been studied in details using data accumulated during the 2001 and 2002 beam test period :

* The performance of the electronics readout has been measured with calibration data showing that an excellent local constant term can be reached, smaller than 20 ps, similar to the test bench results.
* The resolution for physics pulses with 245 GeV electrons has been studied by two methods, either comparing the time between two neighbor cells and correcting large effects due to cross talk, either by comparing the time of the impact cell in the middle layer with an external measurement. The limitations in both methods have been described and a local constant for the calorimeter alone of about 60-70 ps has been achieved.
* The main contribution to the ATLAS overall time constant term will come from the absolute time intercalibration between the \(\simeq\)50000 cells of the middle layer. The first intercalibration to be used in the RODs at the beginning of the LHC will come from the calibrations pulses extrapolated to physics pulses. From the study of the beam test, a 1 ns seems feasible. The excellent performance of the calorimeter for muons shows that their time can be measured with the calorimeter with a 6 ns r.m.s, therefore can be used to check the intercalibration during the cosmic commissioning phase.

## 10 Acknowledgments

The authors would like to thank Arnaud Camard, Olivier Le Dortz and Dirk Zerwas for their help during test bench measurements and for useful discussions.

## References

* [1]Detector and Physics Performance TDR ATLAS TDR 15
* [2]W.E. Cleland and E.G. Stern, **NIM A338 (1994) 467-497*** [3] Performance of the ATLAS electromagnetic calorimeter barrel module 0 **NIM A500(2003) 202-231**
* [4] J. Collot, C. De la Taille, et al.**ATLAS Note LARG-98-092**
* [5]**EMTB User Guide** R. Lafaye et al.
* [6] J. Colas et al. **ATLAS Note LARG-2000-006**
* [7] P. Borgeaud et al., The 'HAMAC' rad-hard Switched Capacitor Array, **unpublished note**
* [8] R.Bernard, F. Renardy, CEA internal note **ATL-AL-CEA-ES-4.0**
* [9] The ATLAS Liquid Argon calorimeter calibration board, J.Colas et al **ATLAS Note LARG-2000-004** F. Hubaut at al.**ATLAS Note LARG-2000-007** F. Hubaut et al. **ATLAS Note LARG-2000-009**
* [10] L.Neukermans, P.Perrodo and R.Zitoun **ATLAS Note LARG-NO-2001-008**
* [11] Y.Jacquier, C de la Taille, I.Nikolic, L.Serin **ATLAS Note LARG-97-080**
* [12] A. Camard, B.Laforge, P. Schwemling, **ATLAS Note LARG-2003-001**
* [13] P. Puzo, private communication.
* [14] Dirk Zerwas, private communication