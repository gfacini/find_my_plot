[MISSING_PAGE_EMPTY:1]

# Description of a Pattern Recognition Algorithm using Continuous and Discrete Tracking Detectors

James G. Loken, Armin Reichold

University of Oxford

Oxford, May 21, 1996

###### Abstract

This document describes a pattern recognition algorithm for the ATLAS inner detector and it's performance:

The algorithm starts the pattern recognition in the lower occupancy discrete detectors in a combinatorial way, initiating a histogramming type pattern recognition in the TRT inside a road of approximately 1mm transverse width. Results from the TRT are used to veto wrong combinations of discrete hits and to solve the left right ambiguity problem of the TRT drift time measurement. Results from studies using the above algorithms to identify single muons from 2 to 500 GeV with and without minimum bias pile-up are shown. The detector geometry is that described in the ATLAS technical proposal.

###### Contents

* 1 Introduction
* 2 The Framework of _iPatRec_
* 3 The Global Pattern Recognition Algorithm
* 4 The TRT Part of the Pattern Recognition Algorithm
	* 4.1 Assumptions
	* 4.2 Implementation
	* 4.3 Hit Distributions
* 5 Results
	* 5.1 Resolutions
		* 5.1.1 Momentum Resolution
		* 5.1.2 Impact Parameter Resolution
		* 5.1.3 Azimuthal Angle Resolution
		* 5.1.4 Polar Angle Resolution
		* 5.1.5 Z-vertex resolution
	* 5.2 Efficiency
* 6 Conclusions
* 7 Acknowledgements

Introduction

Up to now all pattern recognition approaches using the complete inner detector of ATLAS were initiated by finding a track segment in the TRT. Since the discrete tracking detectors have much lower occupancies than the TRT a pattern recognition based on the discrete detectors could be advantageous, in particular at high luminosities. _iPatRec_, a pattern recognition program using the discrete tracking detectors only, already existed. Since _iPatRec_ was not using the TRT a gross degradation of the momentum resolution and an unnecessarily high fake track rate had to be accepted. This work was intended to complement the large effort which has already gone into _iPatRec_, helping to overcome the momentum resolution limitations whilst maintaining and possibly improving the high track finding efficiency. Adding the use of the TRT to _iPatRec_ was also expected to improve the stability of the combinatorial pattern recognition in high multiplicity events, by adding an independent element to the pattern recognition algorithm.

## 2 The Framework of _iPatRec_

_iPatRec_ is a pattern recognition program for the reconstruction of charged particle tracks in the inner tracker of ATLAS. It is intended to measure track parameters in the transverse momentum range from 1 to 500 GeV. The identification is not restricted to isolated tracks but can be performed inside jets and with minimum bias pile-up as expected at maximum LHC luminosities. _iPatRec_ uses an internal description of the inner detector geometry in the form of a geometry table which is created during initialisation using the information present in the detector geometry banks. The geometry table describes the detector in terms of barrel and disk shaped layers. The layers are grouped into superlayers which are spatially neighbouring layers capable of giving space point information. The only exception from this is the TRT which by design can not deliver space point information.

Those detectors capable of measuring space points are referred to as discrete tracker elements. These are:

* Pixel Detectors
* Silicon Strip Detectors
* GaAs Strip Detectors
* MSGC Detectors

The superlayers enter the geometry table in order, going out from the vertex increasing first in radius and then in \(\eta\). The geometry table allows _iPatRec_ to predict which detector elements should have been hit by a certain track and therefor establish the concept of holes on a track where the detector did not measure a hit, even though it was expected.

Pattern recognition in _iPatRec_ is initiated by an external seed indicating a region of interest in the inner tracker. This region is called a seed road. Every seed road includes the full vertex region up to \(\pm 2\cdot\sigma_{z\_vert}\) and \(\pm 20\cdot\mu\)m in the transverse directions. Its extent at the outer radius is given by the precision of the seeding detectors extrapolation.

The road is symmetric in \(r\phi\) and can include particles down to about 1 GeV depending on the type and minimum momentum of the seed particle.

The four seed types currently supported are:

**Electron Seeds**: The barycenter of each cluster in the electro magnetic calorimeters provides one seed. The road width in the \(r\phi\) coordinate is larger than that for muons to allow for bremsstrahlung processes.
**Muon Seeds**: Currently the roads for muon seeds are not using tracking results from the muon toroid system due to problems with the stability of the muon tracking code. Instead the information is taken from the _KINE_ bank and smeared according to the expected tracking resolution of the muon tracking system.
**B Seeds**: The _GENZ_ bank is scanned for b-quarks and a road suitable to contain a b-jet is constructed around each b-quark. This seed type has been extended to search for arbitrary particle types in the --GENZ bank.

_KINE_: A general purpose seeding routine is supplied to scan the _KINE_ banks for any particle required by the user and assign suitable road parameters for the particle types.

The seeds used in this note were of _KINE_ type. Once the seed is defined _iPatRec_ uses a combinatorial approach to find the best combination of points from discrete tracker elements, joining these to a track segment found in the TRT. A more detailed description of _iPatRec_ can be found in [2].

## 3 The Global Pattern Recognition Algorithm

Track finding starts by initiating a track skeleton, which is a fit to the seed road parameters plus 2 space points from different superlayers. To account for moderate detector inefficiencies, 3 or 4 superlayers are designated to provide these space points, normally 2 at the outer tracker radius (where the road width and occupancy give the fewest pile-up combinations) and 2 in the'sagitta' region (mid-radius) to give sharp Pt thresholds and to provide a reasonable extrapolation precision. These designated superlayers are referred to as skeleton superlayers. All combinatorials amongst these superlayers are considered. A skeleton is valid if:

* its \(p_{t}\) is inside the seed road,
* it points back to the vertex within \(\pm 50\)cm in z and * it could be successfully fitted with a \(\chi^{2}\) below a cut of typically 3 p.d.f1

Footnote 1: p.d.f = per degree of freedom

Valid skeletons are then extrapolated into the TRT where they define a road around the centre of the skeleton extrapolation. The width of the road is given by the errors on the skeleton track parameters. It has typical (\(p_{t}\) dependent) dimension of 5mm in the transverse track direction when it enters the TRT. The number of TRT hits, inside the skeleton road is used to veto wrong skeletons. The minimum number of hits required is a function of eta and is shown in figure 1 of section 4.3. It has been constructed as the lower envelope of the number of straws hit by a single track which is also shown in figure 1

If a skeleton has passed the veto cut pattern recognition in the TRT is performed, the left-right ambiguity arising from the drift time measurement is solved. The number of hits accepted by the pattern recognition during confirmation undergoes a similar cut as the number of hits in the skeleton road. This cut can be seen as a function of \(\eta\) in figure 1 in section 4.3. It has been constructed to be an 80% fraction of the total number of hits found on the track. Its relation to the number of confirmations on single track events is also shown in figure 1

The procedure for solving the left right ambiguities is the core of the TRT pattern recognition and is described in more detail in section 4.

The coordinates and errors of those TRT points that have been confirmed during the left right ambiguity solving are used during the remaining pattern recognition process for this skeleton candidate. From here on there is only one hit per TRT layer in the data structure and the algorithm has effectively found a section of a track in the TRT that is compatible with the skeleton. However the TRT points are only added to the track when the pattern recognition in the discrete layers is completed and it does not add to the number of holes on a track.

The skeleton track is now built into a track'segment' by associating the measurements in the discrete tracker layers between the skeleton superlayers which are closest to the skeleton centre.

The segment has to satisfy a \(\chi^{2}\)cut of typically 3 p.d.f. its \(p_{t}\) must lie within the skeleton road limits and it must not share more than half of it's discrete hits with a previously found track. If the segment fails the \(\chi^{2}\)cut the point contributing most to the \(\chi^{2}\)is dropped and the \(\chi^{2}\)is tested again.

If the segment has passed the above cuts it defines a very narrow road for space point finding in the high occupancy inner superlayers. Their points complete the segment. Provided that the number of holes in the completed segment is smaller than that of the best completed segment so far it is kept.

Finally a track is completed by interpolating into all superlayers that have not contributed to the completed skeleton. Space points closest to the interpolation center in these superlayers are picked up if they are inside the road and the resultant fit does not have a \(p_{t}\) outside the road limits. In those cases where a superlayer could not contribute a space point but still has a single coordinate measurement2 this measurement can be picked up in a second pass of extrapolations.

A quality is calculated for each track which is the sum of the \(\chi^{2}\)p.d.f and the number of holes in the discrete detectors. A final track then has to pass the following cuts:

* At least 2 of the 3 innermost layers must be present
* The sum of holes and hits shared with a previous track from any other skeleton must not exceed half the number of hits (discrete layers only).
* The number of holes on the track must be smaller than that of the best track for this skeleton so far (discrete layers only).
* The number of holes must be less than a cut of typically 7 (discrete layers only)
* The number of hits must be larger than a cut of typically 5 (discrete layers only)

The segmentation procedure during the track finding serves to reduce the combinatorial overhead and allows for deviations from a pure helical trajectory due to material effects - such as bremsstrahlung and multiple scattering.

## 4 The TRT Part of the Pattern Recognition Algorithm

This chapter describes the elementary mathematics of the TRT pattern algorithm in section 4.1 and the implementation of the method in section 4.2. The main task of the algorithm is to find a section of track in the TRT which can be associated to the skeleton track found in the discrete tracker elements. It aims to associate points uniquely, trying to solve the ambiguities arising from the drift time measurements in the TRT and associate appropriate errors to each point. If a unique choice of drift time direction is not possible the straw centre position is associated and the error is adjusted to the measured drift time value.

### Assumptions

The trajectory of a particle of charge q, transverse momentum P and impact parameter b inside a homogeneous magnetic field parallel to Z is described by the following equations

\[\Phi = \Phi_{0}+\frac{R}{2\cdot R_{curv}}+\frac{b}{R} \tag{1}\] \[Z = R\cdot\tan{(\frac{\pi}{2}-\Theta)}+Z_{o} \tag{2}\]where the radius of curvature is given by:

\[R_{curv}\left[m\right]=\frac{P_{t}[\,\mathrm{GeV}]}{0.3\cdot q\,[\mathrm{e}]\cdot B [\mathrm{T}]} \tag{3}\]

using the usual definitions of the coordinates \(R,\Phi,\Theta\).

The pattern recognition in the TRT is based on the following assumption:

1. At the radii of the TRT (63-107 cm) the contribution of the impact parameter term in equation 1 is small compared to the \(P_{T}\) dependent term and equation 4 holds. \[\Phi\approx\Phi_{0}+\frac{R}{2\cdot R_{curv}}\] (4) This is true for all particles with impact parameters smaller than 1 cm, down to transverse moment a of 0.5 GeV at B=2T.
2. The skeleton road provides a valid estimate of the true track momentum. Here valid means that the skeleton road must contain the true track.
3. The drift time ambiguities within the measurement of the \(\phi\) coordinate are treated as two possible values \(\phi_{l}\) and \(\phi_{r}\) at the same radius where: \(\phi_{r}=\phi_{\mathit{straw}}-L_{\mathit{dr}\,i\,ft}/R_{\mathit{straw}}\) and \(\phi_{l}=\phi_{\mathit{straw}}+L_{\mathit{dr}\,i\,ft}/R_{\mathit{straw}}\). Here \(L_{\mathit{dr}\,i\,ft}\) is the drift distance in the TRT straw tube which is calculated from the measured drift time.

The latter is an approximation which is strictly true only for infinite momentum tracks. A correction for low momentum tracks can be easily implemented. Instead of changing the radius of the measurement an effective drift distance can be calculated which represents the intersection of the particle trajectory with the cylinder of radius of the straw center (\(R_{\mathit{straw}}\)). The new drift time \(d^{\prime}\) can be expressed as:

\[d^{\prime}=\frac{d}{\sqrt{1-\left(\frac{R_{\mathit{straw}}}{2\cdot R_{\mathit{ straw}}}\right)^{2}}} \tag{5}\]

For the lowest momentum tracks considered in this study (2 GeV) this correction changes the drift distance value of a straw at 1m radius by only 1.1%. Even for the biggest possible drift distance of 2mm this corresponds to only 22\(\mu\)m being only 14% of the drift distance resolution. In view of the smallness of this corrections an implementation in _iPatRec_ was not considered necessary.

### Implementation

For a given skeleton momentum \(P_{t}^{\mathit{skel}}\) a \(\Phi^{\prime}\) is calculated for each hit and both drift time alternatives:

\[\Phi^{\prime}=\Phi-(\frac{1}{P_{t}^{\mathit{skel}}}\pm n\cdot\delta_{\frac{1} {P_{t}^{\mathit{skel}}}})\cdot R\cdot C\approx\Phi_{0} \tag{6}\]\[C=\frac{0.3\cdot q\cdot B}{2} \tag{7}\]

Where \(\delta_{\frac{1}{H}}\) is typically 0.004 GeV\({}^{-1}\) and n is in the range [0, 8] for \(P_{t}\)=1 GeV falling to [0, 2] for \(P_{t}\geq\)12 GeV.

The values of \(\Phi^{\prime}\) are histogrammed for different values of n until a peak is found in the histogram or the peak search is abandoned. A peak is defined as the biggest sum of two adjacent bins if it has more than 12 hits. The bin width is 0.5 mrad. If a peak is found on the edge of the \(P_{t}\) range the central value of the search is shifted towards this edge and the search is continued until a peak is found away from the edge or no peak is found.

The values of \(R\cdot\Phi\) for all points falling into the histogram peak bins are then fitted to a straight line and points with a distance of more than 200 \(\mu\)m from the central fit value are discarded. The fit is repeated with the remaining points only. Now any hit in the TRT within 400 \(\mu\)m of the new central fit value is added to the track. The re-fit is done using \(R\cdot\Phi\) rather than \(\Phi\) because the measurement error of the TRT in \(R\cdot\Phi\) is constant with radius, whereas the errors on \(\Phi\) increase as the radius decreases. This leads to an inaccuracy of the histogramming method for small radii.

The errors assigned to each hit inside the final selection band depend on the uniqueness of the drift time assignment. The errors for the \(R\cdot\phi\) coordinate are:

* The drift time resolution of 160 \(\mu\)m if the hit is uniquely selected, i.e. the other drift time value was outside the final selection band.
* \(\sigma_{R\phi}=\sqrt{(160\mu\mathrm{m})^{2}+L_{drift}^{2}}\) for hits which are not uniquely selected.

### Hit Distributions

As described earlier in section 3 the cuts on the required number of hits inside the TRT are a strong function of \(\eta\). They reflect the overall tracker layout optimisation and have been improved by the latest designs. These cuts will have to be retuned when the detector layout is finalised. With a more final detector layout it is straight forward to tune these cuts more tightly to the hit distributions. This was considered unnecessary because the layout still differs substantially from a possible final version. Figure 1 shows the distribution of hits and confirmed hits for 500 GeV muons as obtained without any cuts. They also indicate the position of the cuts as a function of \(\eta\). Comparing figure 1 with the eta dependence of the momentum resolution as shown in figure 3 it can be seen that the decrease of resolution power in the region of 1.3\(\leq\eta\leq\)2.0 can not be explained by loss of TRT confirmed hits but probably results from the loss of the last silicon strip barrel measurement.

Figure 1: Number of TRT-hits in the skeleton road and number of confirmed hits in the fit of reconstructed muon tracks of 500 GeV \(p_{t}\). The right half is a profile histogram of the left half showing the mean value of the distributions. The error bars are the RMS of the distribution on the left half. No pile-up was added and no cuts on the number of hits were applied. The cut function used for later analysis is also shown

Results

The analysis described in this chapter has been done for muons only but will be extended to electrons with the same parameter range. Certain performance variables were evaluated over the spectrum of processed data given in table 1.

The performance variables given in this chapter are defined below.

* Signal track efficiency \(\epsilon_{t}\) is defined as: The ratio of the number of events with reconstructed seeds over the number of events with valid seeds. A valid seed is defined in two ways: Either any seed with non zero momentum hereafter referred to as 'loose seeds', or a seed matching the momentum of the signal particle3. to better than 1% referred to as 'tight seeds'. An event is reconstructed if: At least one track is found with \(p_{t}\geq 20\) GeV4 in an event with at least one valid seed Footnote 3: The signal particle is the particle entering the reconstruction via the primary input stream of SLU G. In this study signal tracks were single muons of fixed \(p_{t}\). Footnote 4: For signal tracks of \(p_{t}=\)10 GeV and \(p_{t}=\)2 GeV this threshold was lowered to 1.5 GeV
* Transverse momentum resolution \(\sigma_{P_{t}}\) (for vertex constrained fits) is defined as: \(\sigma_{P_{t}}=\)\(\sigma(P_{t}^{true}/P_{t}^{found}-1)\) for the best track in events with tight seeds. The best track is that with the lowest quality parameter described in section 3.
* Impact parameter resolution \(\sigma_{A_{0}}\) (for non vertex constraint fits) is given in \(\mu\)m
* Initial azimuthal angle resolution \(\sigma_{\theta_{0}}\) (for vertex constraint fits) is given in rad.
* Initial polar angle resolution \(\sigma_{\theta_{0}}\) (for vertex constraint fits) is given in rad.
* Resolution of the Z coordinate of the particle vertex \(\sigma_{Z_{z}}\) (for vertex constraint fits) given in cm.

\begin{table}
\begin{tabular}{|c||c|c|c|c|c|} \hline L[\(cm^{-2}s^{-1}\)] & 500 GeV & 100 GeV & 40 GeV & 10 GeV & 2 GeV \\ \hline \hline
0.0 & 5K,\(\mu\) & 5K,\(\mu\) & 5K,\(\mu\) & 5K,\(\mu\) & 5K,\(\mu\) \\ \(0.29\cdot 10^{3}\) & 1K,\(\mu\) & 0 & 0 & 0 & 0 \\ \(0.57\cdot 10^{3}\) & 1K,\(\mu\) & 0 & 0 & 0 & 0 \\ \(1.00\cdot 10^{3}\) & 3.96K,\(\mu\) & 1K,\(\mu\) & 1K,\(\mu\) & 1K,\(\mu\) & 1K,\(\mu\) \\ \hline \end{tabular}
\end{table}
Table 1: Number of processed events as a function of background luminosity and primary particle momentum. The primary particles were \(\mu\)’s for all events.

### Resolutions

All five track parameter resolutions have been studied in this work with emphasis on momentum- \(\sigma_{P_{t}}\) and impact parameter resolution \(\sigma_{A_{0}}\). These are the most important parameters for many physics studies and are discussed first. All results in this subsection have been obtained using vertex constraint fits, except for \(\sigma_{A_{0}}\). This was done because the impact parameter resolution with vertex constraint can not be used in cases where the particle does not come from the primary vertex. since it is drastically better than the resolution without vertex constraint. This is not the case for any other track parameter, as long as the actual vertex is not more than \(\mathcal{O}(1\mathrm{cm})\) displaced.

#### 5.1.1 Momentum Resolution

Figure 2 shows the transverse momentum resolution as a function of \(\eta\) for single muon tracks. The resolution for 500 GeV tracks crosses the 30% line at \(\eta\)=2.3. A degradation of the resolution in the region of 1.3\(\leq\eta\leq\)2.0 can also be seen. This loss of resolution is present down to a \(p_{t}\) of 40 GeV. At lower \(p_{t}\) multiple scattering dominates this detector effect.

The influence of luminosity on the resolution as a function of \(\eta\) can be seen in figures 3 to 5. The resolutions are significantly better than those quoted in [4] for two reasons:

* All points found by the TRT pattern recognition have been added to the fit, whereas only one master point was used to represent the TRT hits in [4]
* Perfect alignment of the subdetectors in the inner trackers has been assumed.

The biggest degradation of resolution appears in the region of 1.3\(\leq\eta\leq\)2.0 where the two 500 GeV samples differ by up to 6% corresponding to a relative difference of 30% or a 6 \(\sigma\) separation. The degradation becomes less severe as the momentum decreases and is only marginal in the 10 GeV sample.

In trying to determine whether the degradation is due to pattern recognition problems or is fundamentally limited by the detector performance, it is useful to check whether the momentum resolution remains Gaussian. Figure 6 shows the fraction of events with values of \(\sigma(P_{t}^{true}/P_{t}^{found}-1)\geq 3\cdot\sigma\). It is important to restrict the sample to a detector region where the resolution does not vary with \(\eta\). This is why figure 6 has been restricted to \(|\eta|\leq 1\). However no significant increase of the fraction of events outside 3\(\sigma\) is observed.

Keeping in mind that in principle a Gaussian fit to \(\sigma(P_{t}^{true}/P_{t}^{found}-1)\) is only strictly valid for events from the same detector position figures 7 to 8 show the energy dependence of the momentum resolution degradation for samples including events from all eta and \(|\eta|\leq 1.0\). Although the absolute values of the resolution for the all \(\eta\) sample are significantly higher, since they include the poorer performing regions of large \(\eta\), figure 8 shows that the influence of luminosity on the resolution is estimated similarly by both samples.

Figure 2: \(\sigma(P_{t}^{true}/P_{t}^{found}-1)\) as a function of \(\eta\). The values are taken from Gaussian fits in each eta bin. The fit has been restricted to approximately \(\pm 3\sigma_{P_{t}}\) around the centre of the distribution. The bin width in \(\eta\) is 0.19. Each momentum sample represents 5000 tracks.

\begin{table}
\begin{tabular}{|c||c|c|c|c|c|} \hline L[\(cm^{-2}s^{-1}\)] & \(500\,\mathrm{GeV}\) & \(100\,\mathrm{GeV}\) & \(40\,\mathrm{GeV}\) & \(10\,\mathrm{GeV}\) & \(2\,\mathrm{GeV}\) \\ \hline \hline \(0.00\) & \(0.7186\) & \(0.6895\) & \(0.6767\) & \(0.6662\) & \(0.7554\) \\ \(0.29\cdot 10^{34}\) & \(0.7554\) & & & & \\ \(0.57\cdot 10^{34}\) & \(0.7817\) & & & & \\ \(1.00\cdot 10^{34}\) & \(0.8090\) & \(0.7823\) & \(0.7798\) & \(0.7777\) & \(0.7817\) \\ \hline \end{tabular}
\end{table}
Table 2: \(\chi^{2}\) per degree of freedom for muons of various momenta with and without pile-up

Figure 3: \(\sigma(P_{t}^{true}/P_{t}^{found}-1)\) as a function of \(\eta\) for \(500\) and \(100\,\mathrm{GeV}\) muons with and without pile-up corresponding to a luminosity of \(1.0\cdot 10^{34}\,cm^{-2}s^{-1}\). The bin width in \(\eta\) is \(0.19\). At high luminosity the samples represent \(3965\) tracks at \(500\,\mathrm{GeV}\) and \(956\) tracks at \(100\,\mathrm{GeV}\).

Figure 4: \(\sigma(P_{t}^{true}/P_{t}^{found}-1)\) as a function of \(\eta\) for 40 and 10 GeV muons with and without pile-up corresponding to a luminosity of \(1.0\cdot 10^{34}\,cm^{-2}\,s^{-1}\). The bin width in \(\eta\) is 0.19. At high luminosity the samples represent 930 tracks at 40 GeV and 935 tracks at 10 GeV.

Figure 5: \(\sigma(P_{t}^{true}/P_{t}^{found}-1)\) as a function of \(\eta\) for 2 GeV muons with and without pile-up corresponding to a luminosity of \(1.0\cdot 10^{34}\,cm^{-2}s^{-1}\). The bin width in \(\eta\) is 0.19. The high luminosity sample represents 912 tracks.

Figure 7: Momentum dependence of the momentum resolution \(\sigma_{P_{t}}\) for single muon tracks with and without pile-up. The lower pair of curves corresponds to a sample restricted to \(|\eta|\leq 1\). The higher pair includes events from all \(\eta\)

For 500 GeV tracks figure 9 shows an increase in\(\chi^{2}\) per degree of freedom of 0.090 due to pile-up. The values for other momenta can be seen in table 2. The fact that the average \(\chi^{2}\)is less than 1 shows that the errors associated to the detector measurements are partially overestimated. Assuming an average TRT occupancy of 20% at a luminosity of \(1.0\cdot 10^{34}cm^{-2}s^{-1}\)[3] and an average of 36 TRT hits per track, 7.2 pile-up hits per track are expected. In 50% of all cases the pile-up hits will have a smaller drift time than the signal track hits and therefore overshadow them. If the centroid of the TRT hit histogram is still a good estimator for the true track direction then the cutoff of 400 microns around the centroid will limit the \(\chi^{2}\) contribution of each pile-up hit to 2.08.5 This would give a total \(\chi^{2}\) contribution from pile-up of 7.5. On tracks with an average of 79 degrees6 of freedom this leads to an increase in \(\chi^{2}\) per degree of freedom of 0.095. This result is compatible with measured increase of 0.09.

Footnote 5: A box distribution of width 800 microns with \(RMS=800\mu\)m\(/\sqrt{(}12)\approx 230\mu\)m is assumed and normalized to the single straw measurement accuracy of 80 \(\mu\)m.

Footnote 6: Per track 4 space point like measurements with 3 coordinates and 36 TRT measurements with 2 coordinates are assumed

Figure 8: Momentum dependence of the degradation of momentum resolution \(\sigma_{P_{t}}\) through pile-up for muon tracks. The two pairs of curves corresponds to a sample restricted to \(|\eta|\leq 1\)(central eta) and one for all \(\eta\).

Figure 9: Distribution of \(\chi^{2}\) per degree of freedom for vertex constraint fits to 500 GeV muon tracks. The lower distribution is measured at L\(=1.0\cdot cm^{-2}s^{-1}\).

#### 5.1.2 Impact Parameter Resolution

All results shown in this subsection have been obtained from none vertex constraint fits. The impact parameter resolution has been determined as a function of \(\eta\) and luminosity and is shown in figures 10 to 12 for muons of 2 to 500 GeV. The degradation of \(\sigma_{A_{0}}\) due to luminosity is not significant when compared to the errors. In the central rapidity bin the resolution is of the order of 30 \(\mu\)m for 500 GeV muons. The resolution is clearly multiple scattering dominated for the 2 GeV sample where it is around 100 \(\mu\)m at \(\eta\)=0. The results agree with those shown in [1] for low \(p_{t}\) over all \(\eta\) and for high \(p_{t}\) at \(\eta\)=0. The high \(p_{t}\) samples show a stronger deterioration of the resolution with \(\eta\) than shown in [1].

Figure 10: Impact Parameter Resolution as a function of \(\eta\) for muons of 2 and 10 GeV transverse momentum. Each plot compares the resolution for single tracks with that for a luminosity of L= \(1.0\cdot cm^{-2}s^{-1}\).

Figure 11: Impact Parameter Resolution as a function of \(\eta\) for muons of 40 and 100 GeV transverse momentum. Each plot compares the resolution for single tracks with that for a luminosity of L= \(1.0\cdot cm^{-2}s^{-1}\).

Figure 12: Impact Parameter Resolution as a function of \(\eta\) for muons of 500 GeV transverse momentum. Each plot compares the resolution for single tracks with that for a luminosity of L= \(1.0\cdot cm^{-2}s^{-1}\).

[MISSING_PAGE_EMPTY:22]

Figure 14: Resolutions of the azimuthal angle at the vertex for muons of 100 GeV transverse momentum. The solid triangles represent a Luminosity of \(1.0\cdot\mathrm{cm}^{-2}\) s\({}^{-1}\). The open circles are for single tracks.

Figure 15: Resolutions of the azimuthal angle at the vertex for muons of 40 GeV transverse momentum. The solid triangles represent a Luminosity of \(1.0\cdot\mathrm{cm}^{-2}\) s\({}^{-1}\). The open circles are for single tracks.

Figure 16: Resolutions of the azimuthal angle at the vertex for muons of 10 GeV transverse momentum. The solid triangles represent a Luminosity of 1.0\(\cdot\)cm\({}^{-2}\) s\({}^{-1}\). The open circles are for single tracks.

Figure 17: Resolutions of the azimuthal angle at the vertex for muons of 2 GeV transverse momentum. The solid triangles represent a Luminosity of 1.0\(\cdot\)cm\({}^{-2}\) s\({}^{-1}\). The open circles are for single tracks.

#### 5.1.4 Polar Angle Resolution

The polar angle resolution is independent of transverse momentum as long as it is not dominated by multiple scattering. The 2 GeV samples are clearly multiple scattering limited. Figure 18 shows the resolution averaged for transverse momenta of 500, 100, 40 and 10 GeV. When plotted separately for these energies the resolutions do not differ significantly. The improvement of the resolution in the region of \(0.9<|\eta|<1.7\) is due to the long leaverarm between the measurements from the pixel and MSGC detectors. The luminosity does not affect this resolution since it is not dependent on the TRT measurements. It decreases dramatically as the measurement of the innermost pixel layer is lost reducing the available leaver arm between two measurement. It is recovered as the MSGC wheel and GaAs disks at large Z start to contribute measurements to the tracks. These effects are not present in the 2 GeV sample as is shown in figure 19. This is caused by the dominance of multiple scattering.

Figure 18: Average resolutions of the polar angle at the vertex for muons of 500, 100, 40 and 10 GeV transverse momentum. The solid triangles represent a Luminosity of \(1.0\cdot\rm cm^{-2}~{}s^{-1}\). The open circles are for single tracks.

Figure 19: Resolution of the polar angle at the vertex for muons of 2 GeV transverse momentum. The solid triangles represent a Luminosity of \(1.0\cdot\rm cm^{-2}\;s^{-1}\). The open circles are for single tracks.

#### 5.1.5 Z-vertex resolution

The resolution of the vertex Z coordinate has no transverse momentum dependence and is shown in figure 20. It is also not influenced by the luminosity since it does not depend on TRT measurements. In the range of \(|\eta|<1.1\) it is extremely flat at a value of 150 \(\mu\)m and then decreases by more than a factor of 10 to over 160 \(\mu\)m.

Figure 20: Average resolutions of the vertex Z coordinate for muons of 2, 10, 40, 100 and 500 transverse momentum. The plain crosses represent a Luminosity of \(1.0\cdot\mathrm{cm}^{-2}\) s\({}^{-1}\). The open circles are for single tracks.

### Efficiency

The track finding efficiency is shown in figure 21 for a 'loose seed' selection and in figure 22 for a 'tight seed' selection as a function of luminosity and momentum. The results from the two seed selections differ significantly. The 'loose seed' sample has a much lower efficiency (at high luminosity) than the 'tight seed' sample. It also seems to gain in efficiency for 10 and 2 GeV tracks.

To explain the difference part of the analysis sequence has to be described in some more detail. Even though the true seed particle is always passed to the analysis as the first seed, the best reconstructed track does not have to be the track truly belonging to this seed. Before a track and it's corresponding true value is stored, the KINE values of all tracks in the road are compared to the found track7 and the best-fit KINE track is stored as the true track. The second and third best track are stored without a separate true value. This procedure is done for two seeds per event. The stored true-track values are later on assumed to represent the seed track.

Footnote 7: The best-fit KINE track is chosen to be the one with the trajectory intersecting the calorimeter front face closest to the best reconstructed track.

If the first two seed tracks do not closely match the momentum of the signal track, the event is excluded from the 'tight seed' sample. This procedure preferentially excludes events with high multiplicities around the signal track, as these tend to be those in which pile-up tracks can be selected as the first two truth tracks. This is not a problem for the determination of momentum resolution, but it is problematic for the efficiency calculation.

In the 'loose seed' sample reconstructed pile-up tracks have improved the efficiency at low momenta. This only happens if the track is above the background momentum cut. The 2 and 10 GeV samples have a background cuts of 1.5GeV and there are a large number of pile-up tracks above this threshold. The 40, 100 and 500 GeV samples have background a cut of 20 GeV and are unaffected by this. In the tight seed sample the efficiency is artificially high because many 'problematic' events do not have the signal track seed as the first or second seed. In order to determine the tracking efficiency more precisely more information about the true track content of all reconstructed tracks is needed. This should preferably include a list of all hits and the particles producing them for all reconstructed tracks.

## 6 Conclusions

An initial approach to the implementation of a "road driven" pattern recognition in the ATLAS TRT and its integration into the framework of _iPatRec_ has been successfully performed. This work was aimed at the improvement of the reconstruction of high \(p_{t}\) muons over the SCT stand alone performance. The targets were:

1. improvement of the momentum and impact parameter resolution.
2. reduction of the ghost track rate at high luminosities.

Figure 21: Tracking efficiency for muons in the ‘loose seed’ sample.

Figure 22: Tracking efficiency for muons in the ‘tight seed’ sample.

3. conservation of a high track finding efficiency at high luminosities.

Point 1 has been fully achieved. The transverse momentum resolution is close to its analytically possible limit.

It has been shown, that the resolution of those parameters depending on measurements from the TRT (\(p_{t}\) and \(\phi\)) show a degradation with increasing luminosity that is consistent with the expectations from the reduction in measurement accuracy of the TRT due to hit shadowing through pile-up hits. This degradation vanishes when the resolution becomes dominated by multiple scattering which is the case for both parameters in the 2 and 10 GeV samples and the effects starts to be visible for the momentum resolution in the 40 GeV sample. The other track parameters (\(\theta\), \(Z_{vertex}\) and A0) are unaffected by the luminosity. The \(Z_{vertex}\) resolution shows no multiple scattering effects even at 2 GeV, whereas the \(\theta\) resolution is clearly multiple scattering limited for the 2 GeV sample.

At high luminosities ghost track rates in the non TRT case were high and have been reduced significantly. A quantitative analysis of this problem is still pending and fake track rates are not given in this work, because a more consistent definition of a fake track for a high track density environment is needed. However it can be said, that fake track rates are at most of the order of 1%.

The track finding efficiency at highest luminosities varies between 92% and 97% for the more conservative definition explained in section 5.2. The problems in the definition of the track finding efficiency are closely related to those of the fake track rate and more work is needed to establish a more general definition of this variable.

Currently the algorithms used have been targeted at high \(p_{t}\) tracks only. The use of the TRT for low momentum tracks may have to be considerably different from the current implementation. In order to extend the current version to the reconstruction of other charged tracks such as pions and electrons more work is needed and initial trials using the TRT in conjunction with a "bremsstrahlung-fit" for electrons show promising results.

Another pending task is the adaptation of the algorithm to the latest geometry which is connected with a major portion effort to adopt the program to the latest version of DICE.

## 7 Acknowledgements

The work presented here is based on the software package _iPatRec_ written by Allan Poppleton and Roger Clifft, with input from many other ATLAS collaborators. _iPatRec_ has proven to be a pattern recognition package for ATLAS that is written flexible, modular and understandable enough for us to make contributions to. We thank the authors a lot for this and their willingness to explain the interior of _iPatRec_ to us.

This work would not have been nearly what it is now without the help and guiding advice of Tony Weidberg for whose prompt and precise comments we are very thankful. We also thank Daniel Froidevaux for some valuable input about the nitty gritty details of how to interpret the ATLAS technical proposal.

Thanks also to Pete Gronbech (Oxford Particle Physics Computing) and Andrew Samsun (RAL computing support) for making their platforms as pleasant an environment to work in as possible.

## References

* [1] ATLAS Technical Proposal for a General-Purpose pp Experiment at the Large Hadron Collider at CERN, The ATLAS Collaboration, CERN/LHCC/94-43 (December 1994)
* [2] Roger Clift and Alan Poppleton, IPATREC: inner detector pattern recognition and track finding, ATLAS Internal Note, SOFT-NO-009, 14 June 1994
* [3] ATLAS Technical Proposal for a General-Purpose pp Experiment at the Large Hadron Collider at CERN, The ATLAS Collaboration, CERN/LHCC/94-43 (December 1994), p.82
* [4] ATLAS Technical Proposal for a General-Purpose pp Experiment at the Large Hadron Collider at CERN, The ATLAS Collaboration, CERN/LHCC/94-43 (December 1994), p.91