The optimization of the tower structured read out of the MDT barrel

**Version 0.1**

A.C. Konig

University of Nijmegen

The Netherlands

August 27, 1996

## 1 Introduction

This note describes the outcome of a detailed study of the segmentation of the read out for the barrel part (up to \(\eta=0.76\)) of the MDT detector. Main focus of the analysis has been the optimization of the read out scheme in such a way that the numbers of Front-End Links, RODs and Read-Out Links would be minimized.

## 2 The read out model

The MDT read out chain has been modeled as follows:

The front-end electronics (ASDs + TDC) resides on a "hedgehog" type motherboard of 24 channels. These motherboards are 3 tubes high and 8 tubes wide ("thick" and "long" respectively in the official muon chamber lingo). Each motherboard carries three 8-channel ASD chips and one 24(32)-channel TDC chip.

The digitization by the TDC is data-driven. Each hit is encoded as a 32-bit word which is stored internally in an asynchronous circular memory. Upon receipt of a level-1 trigger signal (within 2.5 \(\mu\)s), the TDC moves the relevant data to an on-chip output memory from where it is transmitted as a single block of data on a differential serial link (LVDS), the FE Link, which runs at a speed of 80 Mbit/s (twice the LHC clock). Each block of data is preceeded by a 32-bit header word (even if the block is empty) and a 32-bit word of "pre-hit" flags (only if non-empty).

In areas of the detector where the expected data-rate is low, the serial output links of up to 4 adjacent TDCs on a chamber may be daisy chained in order to economize on the number of FE Links.

The FE Links (max. length \(\approx\) 10 meters) end in ROD units which for the barrel will reside just outside the BO chambers of the muon detector. The ROD unit will drive the RO Link to the ROB. The nominal speed of the RO Link is 1 Gbit/s.

## 3 Model parameters/assumptions

The study has been carried out on the basis of the July 1996 version of the muon chamber layout and on the basis of the following assumptions:

1. The detector is completely 8-fold symmetric: Any special features of the chambers in feet regions and cut-outs are ignored.
2. For lack of more recent results on the background the TP 22 hit-rates have been used. The excercise has to be redone once the TP 32 values are available. For this reason the results presented here have to be qualified as **Preliminary**.
3. Since after installation the FE Links will be relatively difficult to access, up to the ROD level a safety factor of 5 has been applied to all hit-rate estimates. Such a safety factor is not applied to the ROD and RO Links because the RODs can be accessed relatively easy and may be reconfigured if and when data-rates require (at the cost of extra hardware).
4. The read out is configured in such a way that any single RO Link carries the data from a complete tower of the muon barrel.
5. The trigger matching window (\(\approx\) maximum drift time) is set to 600 ns.

## 4 Method

Based on the physical chamber dimensions the number of motherboards is calculated. The TP22 hit-rate estimates are used to determine the amount of data (incl. TDC control words) per motherboard. This is done for each chamber type separately. This information is then used to optimize (i.e. minimize) the number of FE Links for each chamber.

The data-volumes per chamber form the input for a calculation of data-rates per tower. The towers have been constructed as follows:

\begin{tabular}{|l|l|} \hline In the \(\phi\) dimension & 8 Large-chamber Sectors \\  & 8 Small-chamber Sectors \\ \hline In the \(z\) dimension & 6 Sectors based on the BI partitioning. \\ \hline \end{tabular}

Each tower thus consists of five chambers: 1 BI chamber, 2 BM chambers and 2 BO chambers. The total number of towers for the Barrel in this scheme is \(16\times 6=96\). Note that the special BIS at \(z>5760\,\)cm and the BIE chambers are not part of this tower scheme and fall outside the scope of the present analysis.

The model has been implemented as an Excel spread sheet where the various parameters could be varied and adjusted. Future changes to the layout and or the read out structure can relatively easy be implemented.

## 5 Results

The main results for the muon barrel chambers are summarized below:

### FE Links

The FE Link analysis gives the following results:

\begin{tabular}{|l|c|c|} \hline Background safety factor & 5 & 1 \\ Total \# 24-ch. motherboards & 7488 & 7488 \\ Total \# FE Links & 2240 & 2240 \\ Total data rate (GByte/s) & 8.8 & 6.4 \\ Avg. FE Link occupancy & 49.6\% & 32.6\% \\ Max. FE Link occupancy & 67.6\% & 45.5\% \\ \hline \end{tabular}

It turns out that the background safety factor (the canonical value for the above analysis is 5) does not influence the results significantly: a value of 1 for this safety factor yields identical results except for the FE Link occupancies and the total data rate.

### RO Links

From the tower analysis the following results have been obtained:

\begin{tabular}{|l|c|c|} \hline Total \# Towers (= \# RO Links) & 96 \\ Max. \# FE Links per RO Link & 26 \\ \hline \hline Background safety factor & 5 & 1 \\ Min. RO Link occupancy & 66.4\% & 49.1\% \\ Avg. RO Link occupancy & 73.3\% & 53.2\% \\ Max. RO Link occupancy & 85.4\% & 58.0\% \\ \hline \end{tabular}

Conclusions

* A detailed optimization of the read out segmentation yields a significant reduction of both the number of FE Links and the number of RO Links.
* The option of daisy-chaining the TDC read out reduces the number of FE Links to 29.9% of the number of motherboards. This value is to be compared with the minimum of 25% for 4 TDCs in a single daisy chain.
* For the number of RO Links the reduction is even higher: Compared with the original 1 ROB/chamber solution, a reduction by a factor 5 has been achieved (96 links for 480 chambers).
* The value of the background safety factor (1 or 5) does only marginally influence the results. The reason for this is that for low values the TDC control information starts to dominate the data volume.
* The largest number of FE Links per tower is 26. The ROD to be developed should therefore allow for (at least) 26 FE Link inputs.
* 85%. These values imply that not much bandwidth remains unused and at the same time that possible temporal fluctuations in the data stream can be dealt with and will not lead to congestion.