ATLAS Internal Note

INDET-NO-016

21 October 1992

Pattern recognition in TRD/Tracker (TRD/T)

I.Gavrilenko

## 1 Introduction

This note describes the TRD/T pattern recognition algorithm for the concept B geometry of the LOI in a stand-alone mode. The tracking algorithm efficiently reconstructs isolated high-\(p_{T}\) tracks, and in particular those of electrons and muons at the highest LHC luminosities, despite the high straw occupancy. The TRD/T combines two essential qualities needed for a tracking detector at LHC:

* A large number of hits per track, ranging from 40 to 70 as a function of the pseudorapidity \(\eta\), which allows for a low rate of fake tracks,
* A low occupancy for hits with energy above 5 KeV, enhancing the capability to identify electrons and high-energy muons.

This global pattern recognition algorithm should include:

* Reconstruction of high-\(p_{T}\) charged tracks originating from the vertex,
* Reconstruction of low-\(p_{T}\) tracks in the vicinity of a high-\(p_{T}\) electron candidate (originating from the vertex) for rejection of Dalitz decays, photon conversions and non-isolated leptons,
* Correction procedures for bremsstrahlung energy loss in case of electrons.
* The possibility of reconstructing low-\(p_{T}\) tracks not originating from the vertex (photon conversions, \(K^{0}\) decays),
* The possibility to use information from other tracking detectors incorporated in the present ATLAS design (SITV, SIT, MSGC).

In this note we concentrate our effort only on the first two points of the above list. We describe an algorithm which extracts tracks originating from the vertex without additional information from other trackers. The method has been evaluated for track reconstruction of charged particles as a function of luminosity, and the expected total rate for fake tracks has also been estimated. No correction procedure for the case of electron bremsstrahlung has yet been implemented.

## 2 TRD/Tracker layout

The TRD/T is a straw drift-tube detector with 4 mm diameter Kapton straws spaced on average 8 mm apart. The free space between straws is filled with polypropylene foils or foam which produce transition radiation photons. The straws operate with a gas mixture consisting of 70%Xe+20%\(CF_{4}\)+10%\(CO_{2}\). The TRD/T is positioned radially between 0.5 and 1.0 m and \(\pm\)3.3 m along Z and consists of two parts (see fig.1):* A barrel part with axial straws of a total length 190 cm, divided into two halves with independent readout (\(2\cdot 55\cdot 10^{3}\) readout channels),
* Two endcap parts with radial straws of 50 cm length (\(2\cdot 130\cdot 10^{3}\) readout channels).

The TRD/T uses a two-threshold readout scheme: a low threshold of \(\simeq.20\) KeV for tracking and drift time measurements, and a high threshold of \(\simeq 5\) KeV for TR detection. Using drift-time information the position accuracy per straw has been measured to be \(\simeq\)140 \(\mu\) [t].

## 3 Track representations in TRD/T

In a uniform magnetic field, tracks originating from the vertex, with \(p_{T}\)\(>0.5\) GeV, appear as almost straight lines in the \((\phi,r)\) plane for the barrel and the (r.z) plane for the endcaps. All tracks originating from the vertex appear exactly as straight lines in the \((\phi,z)\) plane in the endcap TRD/T, as illustrated by fig.2. The trajectory of a charged particle is given by the following system of equations:

\[\phi=\phi_{0}+qC_{l}(Z-Z_{0}), \tag{2}\] \[C_{t}R=Sin(C_{l}(Z-Z_{0}))\simeq C_{l}(Z-Z_{0}),\] (3) \[R\simeq C_{l,t}(Z-Z_{0}),\qquad C_{l,t}=\frac{C_{l}}{C_{t}}=\tan \theta,\quad\mbox{for the endcap}, \tag{1}\]

and

\[qC_{t}R=Sin(\phi-\phi_{0}),\qquad\phi\simeq\phi_{0}+qC_{t}R(1+\frac{1}{6}(C_{ t}R)^{2}),\;\;\mbox{for the barrel}, \tag{4}\]

where \(\phi_{o}\), \(\theta\) - are the initial azimuthal and polar angles of the particle, \(Z_{0}\) - is the vertex position, q - is the particle charge, Z - is the coordinate along the beam direction. R - is the radius and

\(C_{t}=\frac{\alpha}{p_{T}},C_{l}=\frac{\alpha}{p_{l}}\), with \(\alpha=\frac{H}{600}(Tesla^{-1}\cdot GeV)\).

The slope of any track with respect to the horizontal axis is a direct measurement of its transverse momentum \(p_{T}\) (for the barrel) and its longitudinal momentum \(p_{t}\) (for the endcap). The main difference between the two geometries arises from the uncertainty in \(Z_{start}\) and \(Z_{stop}\) of the tracks in the endcap (see fig.2). On the other hand, in the endcap TRD/T, we can simultaneously extract \(p_{T}\) and \(p_{t}\). The straight-line track representation allows us to use the same approach for pattern recognition in both parts of the TRD/T. Since a straight-line segment is a very practical way of representing the structure of an image, several methods have been used to recover straight lines from an image. The use of the Hough transformation in extraction of lines from an image is well known and widely used [2, 3]. The pattern recognition method proposed here combines the classic global tracking methods based on the Hough transformation with the discrete structure of the TRD/T. The tracking and fitting are performed simultaneously by using the simplex method of linear programming. The procedures of the proposed algorithm may be summarised as follows. We first rotate the event image by a fixed angular step in the \((\phi,z)\) plane (endcap) and \((\phi,r)\) plane (barrel). In each rotated image plane we then search for a peak in the distribution of \(dN_{hit}\) as a function of \(\phi\), where \(dN_{hit}\) is the difference between the number of observed hits and the number of empty straws within a tracking road. Inthis method, we reconstruct possible track trajectories, using the information from hits, which we define as straws with an energy deposition above \(\simeq\) 0.20 KeV, together with the information from empty straws. This latter information not only increases the accuracy of the track-momentum measurement, but in the case of the endcap geometry provides an essential contribution for polar-angle reconstruction. The algorithm thus starts from track candidates in the (\(0.z\)) plane (endcap) and (\(\phi,r\)) plane (barrel). It then tries to carry out a more precisely tuned search around the primary direction to find a local maximum in the \(dN_{hit}\) distribution. After these two steps, the found track candidate is discarded or kept depending on its quality.

The drift-time information is used only at the last stage of the tracking procedure. after finding a good track candidate. A least-squares fit method performed within the track road not only reduces the track measurement errors, but also provides additional rejection against fake tracks from pile-up.

## 4 Initial search for track candidates

The first search for track candidates is carried out by scanning successive track roads, determined by equations (1-4), along the \(\phi-\) direction and through fixed angle steps d\(\phi_{0}\), using different slopes (\(C_{l}\) or \(C_{t}\)) and charge hypotheses (\(q=\pm 1\)). The roads are defined between \(Z_{start}\) and \(Z_{stop}\) for the endcap and between \(R_{start}\) and \(R_{stop}\) for the barrel (fig.3). In the barrel geometry \(R_{start}=R_{inner}\) and \(R_{stop}=R_{outer}\), where \(R_{inner}\) and \(R_{outer}\) are the inner and outer radii of the TRD/T. The roads have a width of \(\pm 2\) mm, which matches the granularity of the straws, and are used to count the number of hits (\(N_{hit}\)) and the number of empty straws (\(N_{empty}\)).

A more complicated algorithm is used for the endcap part of the TRD/T. This is due to the fact that for this geometry \(Z_{start}\) and \(Z_{stop}\) are a function of \(Z_{0}\) and \(C_{t,t}\), as shown in fig.2.

\[Z_{start}=\frac{R_{inner}}{C_{l,t}}+Z_{0},\qquad Z_{stop}=\frac{R_{outer}}{C_ {l,t}}+Z_{0},\qquad. \tag{5}\]

where \(C_{l,t}\) and \(Z_{0}\) are unknown parameters which have to be determined. Because the size of the vertex distribution is fairly small (\(\simeq 10cm\)) compared to the track length within the TRD/T (\(\sim 1m\)), we assume that \(Z_{0}=0\). The slope of the track road in the \((r,z)\) plane, \(C_{l,t}\), is then calculated using a procedure, where the program selects the straws, which lie within a closed interval d\(\phi\):

\[|\ d\phi\ |=|\ \phi_{0}-\phi_{k}+qC_{l}Z_{k}\ |\leq\frac{R_{straw}}{R_{inner}}, \tag{6}\]

where \(\phi_{k}\) and \(Z_{k}\) are the azimuthal angle and Z-coordinate of straw number k, which therefore lies within the track road if \(C_{l,t}\) satisfies the condition:

\[\frac{R_{inner}}{|\ Z_{k}\ |}\ \leq|\ C_{l,t}\ |\leq min(R_{outer},\frac{R_{ straw}}{|\ (\phi_{0}-\phi_{k}+qC_{l}Z_{k}\ |)}\frac{1}{|\ Z_{k}\ |} \tag{7}\]

This means that, for a given set of the parameters (\(C_{l},\phi_{0},Z_{0}=0\)), we can define a range of \(C_{l,t}\) values, for which d\(N_{hit}\) reaches a maximum and the centre of this range defines the track road. This procedure is equivalent to rotating the track direction in the \((r,z)\) plane around the point with R = 0 and Z = 0. The two quantities, \(N_{hit}\) and \(N_{empty}\), define the quality of the road. If the ratio \(N_{att}/(N_{att}+N_{empty})\) is greater than a predefined threshold the given track road is considered as a track candidate with initial parameters \((\phi_{0},C_{t})\) for the barrel or \((\phi_{0},C_{t},C_{t,t},Z_{0}=0)\) for the endcap. The next step of the pattern recognition can then proceed, failing which the whole procedure is repeated with a new value of \(\phi_{0}\).

## 5 Fine-tuning of initial track candidates

For each track candidate found with the above procedure, we perform a fine-tuning of the track parameters. The most probable track direction was defined as a local maximum in the d.V\({}_{int}\) distribution, in the space of parameters \((C_{t},\phi_{0})\) for the barrel and \((C_{t},\phi_{0},Z_{0},C_{t,t})\) for the endcap. The algorithm used exploits the digital nature of the TRD/T measurements in a straight-line track representation. The big size of the straws (\(R_{straw}=2\) mm) does not allow us to define the track position with good accuracy. However, the large number of hits per track greatly improves the performance of the TRD/T. A traditional method of fitting particle trajectories to position measurements uses a least squares fit. This method is certainly justified for detectors with measurements of points on tracks which are approximately Gaussian-distributed and independent. The justification for using a least squares fit is that it is equivalent to a maximum likelihood method when the residuals (measurement errors) are Gaussian-distributed. Then N measurements are expected to improve a single measurement by a factor \(1/\sqrt{N}\). But the TRD/T is essentially digital in character: a signal observed in one straw means that the track trajectory passed within a certain "window", but the probability of having passed through any given point within this window is a priori uniform. The error distribution takes the form of a top-hat function of width 4 mm. This implies that measurements are not completely independent, because the straws have fixed positions relative to each other.

Consider the track shown in fig.4, which traverses with normal incidence, at a position \(X_{0}\), two straws giving measurements \(X_{k}\) (k=1,2), with a standard deviation \(\sigma_{s}=R_{straw}/\sqrt{3}\). We now consider two particular cases. If both straws are positioned one behind the other without any offset, then the overall position accuracy \(\sigma_{t}=\sigma_{s}\). Two measurements give no improvement over a single measurement. This is an extreme example of possible correlations, where each measurement gives the same information. The other extreme situation arises when the correlation is such that the offset between the two straws is equal to \(R_{straw}\), giving \(\sigma_{t}=\sigma_{s}/2\). Now the correlation improves rather than degrades the resolution relative to the Gaussian situation. We conclude from this simple example, that the correlations may either enhance or degrade the resolution depending on the chosen straw configuration. Other examples of such detectors are the multiwire proportional chambers (MWPC), silicon strip detectors and scintillator hodoscopes. In refs.4,5 the effects of correlations between wire planes of MWPC can largely explain the behaviour of least-squares fits, particularly the slower than expected convergence as more wire planes are added. A more general approach to the fitting of tracks in detectors which are "discrete", uses the Chebyshev norm instead of a least squares fit [6]. Simulation results for tracks in ideal MWPCs show that the new method is more efficient, offers a better goodness-of-fit criterion, and produces more reliable estimates of the track-parameter errors.

It is natural to seek a solution to this problem by considering a likelihood function for the case of a uniform error distribution in the ideal TRD/T. The individual weights in the likelihood function take either the value one (if the trajectory passes through the corresponding straw-window and assuming a 100% straw efficiency) or zero (if it does not). The overall value of the likelihood (L) is therefore either one (if the trajectory passes through all the windows) or zero (if it misses at least one). The maximum value of this likelihood function will in general not be found in a particular point, but over some region in the space of the parameters describing the track trajectory. Inside this region, all trajectories are equally "good" since they would all give rise to the same distribution of straw hits as were observed. Although all trajectories corresponding to points in the allowed region are equally good, it is natural to choose the point in the middle of this region as the best solution of, the fit. The above exercise demonstrates the basic principles of a complete solution to the problem of track fitting with a uniform measurement error distribution. Unfortunately it does not allow us to find these solutions numerically since one cannot maximize the likelihood function described here with standard techniques, since all of its derivatives are almost everywhere zero. Therefore we apply an algorithm based on the simplex method of linear programming. We also have to take into account some effects, which will influence the TRD/T performance, such as straw inefficiencies, multiple scattering, secondary interactions and pile-up. Consider a trajectory which crossed \(N_{s}\) straws. In the case of a real track, the number of hits (\(N_{hit}\)) fluctuates according approximately to a binomial law

\[L_{t}=f(N_{hit};N_{s},P)=\binom{N_{s}}{N_{hit}}P^{N_{hit}}(1-P)^{N_{s}-N_{hit}}, \text{ for hits on the track,} \tag{8}\]

and

\[L_{b}=f(N_{hit};N_{s},P_{b})=\binom{N_{s}}{N_{hit}}P_{b}^{N_{hit}}(1-P_{b})^{N_ {s}-N_{hit}},\text{ for hits not on the track.} \tag{9}\]

The probabililty \(P\) is defined as \(P=P_{t}+P_{b}-P_{t}P_{b}\), with \(P_{t}\) - the probability for the track itself to produce a hit (\(\simeq\)0.95), and \(P_{b}\) - the probability for pile-up and/or noise to produce a hit (\(\simeq\) 0.2 in the endcap and between 0.15 and 0.5 in the barrel depending on the straw radius). Then the best estimator for the track direction is extracted from the likelihood ratio

\[ln(L_{t}/L_{b})\sim N_{hit}-wN_{empty}\simeq dN_{hit}, \tag{10}\]

where \(w\sim 1\) and \(N_{empty}\) is the number of empty straws. The best fit is then obtained by maximizing \(dN_{hit}\) in the space of the parameters describing the track trajectory.

This strategy is the core of the program. Although this method is extremely sensitive to alignment accuracy, the analysis shows that it is considerably more efficient than a least squares fit. The algorithm is fairly simple and includes a set of successive rotations and displacements of the track direction in the \((\phi,z)\) and \((r,z)\) planes for the endcap and in the \((\phi,r)\) plane for the barrel geometry, around the initial track-candidate direction defined above (see also fig.5). For each step, a road with a width of \(\pm 2\) mm is used to count the number of hit and empty straws, and the direction where \(dN_{hit}\) reaches its maximum value is chosen. The number of steps is equal to the number of parameters which we have defined (2 for the barrel and 4 for the endcap). The recursive method is programmed in the following way: the track direction is successively displaced along the \(\phi\) axis and rotated in the \((\phi,z\) or \(r)\) plane around the point with coordinates \((\phi_{middle},Z_{middle})\) for the endcap and \((\phi_{middle},R_{middle})\) for the barrel.

For the endcap, we use:

\[Z_{middle}=(Z_{stop}+Z_{start})/2,\]\[\sigma_{middle}=\phi_{0}+qC_{l}(Z_{middle}-Z_{0}),\]

and for the barrel:

\[R_{middle}=(R_{stop}+R_{start})/2.\]

\[\sigma_{middle}=\phi_{0}+qC_{l}R_{middle}(1+\frac{1}{6}(C_{l}R_{middle})^{2}).\]

For the endcap geometry, after the first two steps, the track direction is rotated in the \((r,z)\) plane around additional points with coordinates \((R_{start},Z_{start})\),\((R_{stop},Z_{stop})\). For each of these steps, a histogramming method is used to speed up the calculations. The tracking and fitting are performed simultaneously. After the last iteration, the track is considered as a good one only if the ratio \(N_{hit}/(N_{hit}+N_{empty})\) is greater than a predefined threshold, set to a value of \(\simeq 0.85\), which keeps the track-finding efficiency above 99 %.

## 6 Fine-tuning using drift-time information

The overall track finding performance may be improved by using drift-time information, which provides a track position accuracy per straw of \(\simeq 140\)\(\mu\)[1]. The left-right ambiguities can be solved easily, since the real hits form a track road with a width of \(600\mu(\pm 2\sigma)\), as illustrated in an event display from the TRD prototype test (fig.6). This means that the effective occupancy from pile-up within the track road can be reduced by a factor \(\simeq\)3. For simulation of drift-time measurements, an additional procedure of track finding exists, which only applies for the moment to the endcap part of the TRD/T. The input data for a given step in the procedure consist of the coordinates \((\phi_{k},z_{k})\) and measured drift time \((r_{k})\) for hit straws, within a track road with a width \(\pm\) 3 mm around the track candidate direction found in the normal fine-tuning procedure. The track reconstruction is performed using a recursive least-squares fit through a straight line in the \((\phi,z)\) plane, for the set of points with coordinates \(z_{k},\phi_{k}\pm\frac{r_{k}}{R(z_{k})}\), where \(R(z_{k})=C_{l,l}(z_{k}-Z_{0})\). The basic principle of this algorithm is to select points for a new and final fit within a road of \(\pm 2-3\sigma\) (\(\pm\) 300-400 \(\mu\)) around the initial track trajectory. To solve the left-right ambiguities, we always choose the point nearest to the track. The program then calculates the total \(\chi^{2}\), taking into account all points within the physical track road width of \(\pm\) 2 mm. The track is considered as a good one only if the \(\chi^{2}\)/NDF, where NDF is the number of degrees of freedom, is less than a predefined threshold, chosen to be \(\chi^{2}\)/NDF\(\leq\)5.

## 7 Performance of the global pattern recognition

To test this pattern recognition program, minimum bias events at LHC energy were generated using the Lund Monte Carlo program. The \(z\) coordinates of the collision points were smeared according to a Gaussian distribution with \(\sigma\)= 6 cm around \(z\) = 0 along the beam line. All particles were tracked with a dedicated stand-alone program through the TRD/T. The TRD/T response was simulated including:

* tracking of particles in the 2 Tesla magnetic field;
* dE/dX, transition and synchrotron radiation energy deposition in the straws;
* photon conversions in the TRD material.

Multiple scattering, secondary hadronic interactions and possible backsplash from the calorimeter have not yet been included.

To illustrate how our approach works, we show a set of events with and without the reconstructed tracks. Fig.7a shows an event which consists of 100 tracks of \(P_{T}\)=2 GeV, emitted with a uniformly distributed azimuthal angle \(\phi\) in the endcap TRD/T. The reconstruction of the event is shown in fig.7b, where all tracks are found. Fig.8a again shows an event in the endcap, which consists of 30 superimposed minimum bias events and 10 tracks of 10 GeV transverse momentum. Fig.8b shows that, above a \(P_{T}\) threshold set to 6 GeV in this case all the generated tracks and only those are found. In the case of the barrel TRD/T. the algorithm is illustrated by figs.9 to 11 for different track momenta and pile-up configurations. Figs.9 and 10 show the result of the track reconstruction for tracks of \(P_{t}\) = 10 GeV with 30 and 60 superimposed minimum bias events. Fig.11 shows the same but for tracks with \(P_{t}\) = 2 GeV.

The most crucial parameter for the TRD/T is the high occupancy per straw from pile-up, which could simulate fake track roads. A certain correlation between occupancy and fake track multiplicity is expected. Fig.12 (barrel) and fig.13 (endcap) show the total number of fake tracks expected over the full geometrical acceptance as a function of luminosity, for \(P_{t}\) > 2 GeV and 10 GeV. Also shown are the expected rates for real tracks from pile-up, which for low transverse momenta, are significantly higher than the fake track rates. Fig.13 also shows, for \(P_{t}\) > 10 GeV, the expected improvement due to drift-time measurements, which reduce by a factor \(\sim\) 100 the fake track multiplicity due to pile-up.

## 8 Conclusion

In this note we have described a pattern recognition algorithm for the TRD/T based on a track road algorithm and estimated the fake track multiplicity as a function of luminosity. The fake track rate is small, even at the highest luminosities, and may be significantly reduced using drift-time information.

This algorithm is only the first step in full-pattern recognition program for the TRD/T and further studies are in progress. Our primary goals are to speed up the tracking program and to insert correction procedures for bremsstrahlung energy loss in case of electron track identification.

## References

* [1] RD6 Collaboration, Internal Note 32,
* [2] S.A.Dubani and A.L.Luk, Pattern Recognition 10,145-157 (1978).
* [3] Chee-Woo Kang at al., Pattern Recognition 24,633-641 (1990).
* [4] D.Drijard at al., Nucl. Instr. and Meth. 176 (1980) 389.
* [5] I.Duerdoth, Nucl. Instr. and Meth. 203 (1982) 291-297
* [6] F.James, Nucl. Instr. and Meth. 211 (1983) 145-152Fig.1 Geometry of the TRD/T

**Fig.2 Track representation in the TRD/T**

ClibPDF - www.fastio.comFig.3 Primary track finding in the TRD/TFig.4 Effect of the discrete nature

of the measurementsFig.5 Fine\(-\)tuning of track reconstruction Figure 6: Event display from TRD 1992\(-\)prototype test

[MISSING_PAGE_EMPTY:14]

Fig.8 Example of track finding for 10 tracks with P\({}_{\tau}\) = 10 GeV in the presence of 30 superimposed minimum bias events for the endcap TR0/T\(\rm TRD-tracker\) (barrel)

Fig.9 Example of track finding for 20 tracks

with \(\rm P_{\tau}=10\) GeV in the presence of

30 superimposed minimum bias eventsFig.10 Example of track finding for 20 tracks with P\({}_{\rm T}\) = 10 GeV in the presence of 60 superimposed minimum bias events for the barrel TRD/T\(\rm TRD-tracker\) (barrel)

Fig.11 Example of track finding for 21 tracks

with \(\rm P_{T}=2\) GeV in the presence of

30 superimposed minimum bias events

for the barrel TRD/TFigure 12 Number of fake tracks per event in stand-alone TRD/T barrel detector versus luminosity (the solid curves give expected rates from minimum bias events)

Fig.13 Number of fake tracks per event in stand-

alone TRD/T endcap detector versus luminosity

(the solid curves give expected rates from

minimum bias events)