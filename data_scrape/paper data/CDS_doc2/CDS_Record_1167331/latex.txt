# ATLAS NOTE

ATL-PHYS-PUB-2009-000

**Detector Level Jet Corrections**

The ATLAS Collaboration

This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020.

###### Abstract

The jet energy scale is proven to be an important issue for many different physics analyses. It is the largest systematic uncertainty for the top mass measurement at Tevatron, it is one of the largest uncertainties in the inclusive jet cross section measurement, whose understanding is the first step towards new physics searches. Finally, it is an important ingredient of many standard model analyses. This note discusses different strategies to correct the jet energy for detector level effects.

The ATLAS Collaboration1

Footnote 1: This note prepared by A. Dotti, P. Francavilla, V. Giangiobbe, P. Giovannini, A. Gupta, C. Issever, A. Jantsch, D. Lopez Mateos, P. Loch, K. Lohwasser, Z. Marshall, S. Menke, F. Merritt, F. Paige, G. Pospelov, J. Proudfoot, C. Roda, A. Schwartzman, and I. Vivarelli

_This note is part of CERN-OPEN-2008-020. This version of the note should not be cited: all citations should be to CERN-OPEN-2008-020._Introduction

The jet calibration process can be seen as a two-step procedure. In the first step, the jet reconstructed from the calorimeters is corrected to remove all the effects due to the detector itself (nonlinearities due to the non-compensating ATLAS calorimeters, the presence of dead material, cracks in the calorimeters and tracks bending in/out the jet cone due to the solenoidal magnetic field). This calibrates the jet to the particle level, i.e. to the corresponding jet obtained running the same reconstruction algorithm directly on the final state Monte Carlo particles. The second step, is the correction of the jet energy back to the parton level, which will not be discussed in this section.

There are currently several calibration approaches studied in the ATLAS collaboration based on the calorimeter response on the cell level or layer level and either in the context of jets or of clusters.

The first part of the section describes a possible approach for the calibration to the particle jet. The energy of the jet is corrected using cell weights. The weights are computed by minimizing the resolution of the energy measurement with respect to the particle jet. The performance of the calibration in terms of jet linearity and resolution is assessed in a variety of events (QCD dijets, top-pairs and SUSY events). The different structure of these events (different color structure, different underlying event) will manifest itself as a variation in the quality of the calibration. This method has been the most widely used so far in the ATLAS collaboration.

Other methods have also been studied. Here we discuss one alternative global calibration approach, which makes use of the longitudinal development of the shower to correct for calorimeter non-compensation. The jet energy is corrected weighting its energy deposits in the longitudinal calorimeter samples. Although the resolution improvement is smaller with respect to other methods, this method is simple and less demanding in terms of agreement between the detector simulation predictions and real data.

The second part of this section describes the concept of local hadronic calibration. First clusters are reconstructed in the calorimeters with an algorithm to optimize noise suppression and particle separation. Shower shapes and other cluster characteristics are then used to classify the clusters as hadronic or electromagnetic in nature. The hadronic clusters are subject to a cell weighting procedure to compensate for the different response to hadrons compared to electrons and for energy deposits outside the calorimeter. In contrast to the cell weights mentioned above no minimization is performed and the actual visible and invisible energy deposits in active and inactive calorimeter material as predicted by Monte Carlo simulations are used to derive the weights. One of the advantages of this method is that the jet reconstruction runs over objects which have the proper scale (in contrast to the global approach, where the scale corrections are applied after the jet is reconstructed from uncorrected objects).

The third part of the note describes refinements of the jet calibration that can be done using the tracker information: the residual dependence of the jet scale on the jet charged fraction can be accounted for improving the jet resolution. An algorithm to correct the \(b\)-jet scale in case of semileptonic decays will also be discussed.

## 2 The calibration to the truth jet

According to the perturbative QCD, jets are the manifestations of scattered partons (quarks and gluons). After undergoing fragmentation, a collimated collection of hadrons emerges and its energy is measured in the calorimeter system. In addition to this hard scattering, the final state also contains energy coming from multiple proton-proton (pile-up) interactions and the underlying event.

The typical output of an event generator will provide theoretical predictions about the particle content and spectra at this stage, the so called particle level. Jets resulting from the application of a jet reconstruction algorithm at the particle level are thus relevant as "truth", since they represent the final state jets that ideally must be reconstructed starting from the detector level. In the following we refer to them using the expression "truth jets".

Since jet fragmentation functions are independent of jet energy, the fraction of the total jet energy carried by the different particle types in a jet is basically independent of energy. Figure 1 shows the relative contribution of the different particle types to the jet energy as a function of the jet \(E_{\rm T}\).

About 40% of the total energy is carried by charged pions, 25% is carried by photons (mainly coming from the \(\pi^{0}\) decay), another 20% is accounted for by kaons, nearly 10% by protons and neutrons. Therefore, 25% of the energy deposits in the calorimeters come directly from pure electromagnetic showers. The right plot of Fig. 1 shows the average fractional energy deposit in the different calorimeter samplings with respect to the true jet energy in the central calorimeter regions (\(|\eta|<0.7\)). Most of the energy (about 2/3 of the reconstructed energy) is measured by the electromagnetic calorimeter. The total reconstructed energy differs significantly from the true jet energy. This is because of a number of detector effects:

* if the calorimeters are non-compensating (as in ATLAS), their response to hadrons is lower than that to electrons and photons, and is non-linear with the hadron energy.
* part of the energy is lost because of dead material, cracks and gaps in the calorimeters, and is also non-linear with hadron energy.
* The solenoidal magnetic field will bend low energy charged particles outside the jet cone.

The reconstructed jet energy must be corrected for these effects to obtain the best estimator for true jet energy.

In the following we will discuss two possible strategies. The first one (referred to as global calibration) aims to provide calibration coefficients at jet level; the second one, the local calibration, provides calibration constants at the jet constituent level. The performance of both the approaches will be discussed in detail. Both methods use simulated events to obtain the calibration coefficients.

## 3 An energy density based cell calibration

The shower produced by a jet impinging on the calorimeters is composed of an electromagnetic and a hadronic component. The electromagnetic component is characterized by a compact, highly dense, energy deposit, while the hadronic one is broader and less dense. This fact can be used to correct the energy measurement to recover for the non-linear calorimeter response to the hadrons.

Figure 1: Left: fractional energy carried by different particle types as a function of the jet energy. Right: fraction of true energy deposited in the different calorimeter samplings for a jet in the central (\(|\eta|<0.7\)) calorimeter region as a function of its true energy.

After jet reconstruction using calorimeter cells calibrated at the electromagnetic scale, the total energy of a jet is reconstructed by summing the energies of its constituent cells multiplied by a weight which depends on the energy density of the cell itself. We thus define the EM scale jet energy as:

\[E_{\mathrm{em}}=\sum_{i=\mathrm{cells}}E_{i} \tag{1}\]

where \(E_{i}\) is the energy in the cell \(i\) for the considered jet. We then define a jet weighted 4-vector

\[E=\sum_{i=\mathrm{cells}}w_{i}E_{i}\qquad\vec{P}=\sum_{i=\mathrm{cells}}w_{i} \vec{P}_{i} \tag{2}\]

where \(E_{i}\), \(\vec{P}_{i}\) are the \(i\)-th cell energy and momentum (whose direction is defined by the position in the calorimeter and whose magnitude is equal to \(E_{i}\)), and \(w_{i}\) are correction factors that need to be determined. They depend on the cell energy density \(E_{i}/V_{i}\), where \(V_{i}\) is the volume of the \(i\)-th cell.

In order to reduce the number of weights to be computed, the following steps are done:

* The energy density distributions of the cells are divided into different bins with width increasing logarithmically with the cell energy density.
* The calorimeters are subdivided into several regions \(k\). The longitudinal segmentation is partially exploited. Broad pseudorapidity bins are also defined. Table 1 shows the defined regions.
* The weight in the \(k\)-th calorimeter region, in the \(j\)-th energy density bin is defined to be: \[w_{i}^{(k,j)}=\sum_{m=0}^{N_{p}-1}a_{m}^{(k)}\log^{m}(E/V)_{j}\] (3) where \(N_{p}\) (the number of parameters used in the fit) is a number which depends on the region \(k\) considered. The value of \(\log(E/V)_{j}\) is defined at the lower edge of the \(j\)-th bin.

With this procedure, the number of independent parameters to be determined is significantly reduced (see Table 1). The pre-sampler and the strip-layer of the EM calorimeter have a single weight, constant with respect to the density of the energy deposits. The last three rows of the table refer to three energy terms which are also corrected with a single multiplicative factor: they are the cryostat term, the scintillator term and the gap term. The cryostat term is computed as the geometrical average of the energy deposited in the back of the electromagnetic barrel and the first layer of the TileCal barrel. It was in fact found in the past [1] that this gives a good estimate of the energy loss in the cryostat. The scintillator and gap terms correspond to the energy deposited in the scintillation counters in the region between the Tile barrel and extended barrel [2]. The weights applied to these terms are meant to recover for the presence of a large amount of dead material.

The parameters have been determined considering QCD dijet events, simulated with phythia6.4 [3] with the ATLAS settings [4], and the detector simulated using geant4. The events have been generated in bins of the partonic \(p_{\mathrm{T}}\), as illustrated in Table 2. Approximately 10k events have been used for each bin. The jets have been reconstructed using calorimeter towers as input. The jet reconstruction algorithm used is a seeded cone algorithm with a seed threshold of \(E_{\mathrm{T}}=1\,\mathrm{Ge\kern-1.0ptV}\), and a cone size \(R_{\mathrm{cone}}=0.7\). Jets with a reconstructed axis lying close to the gap region (\(1.3<|\eta|<1.5\)), or to the crack region (\(3.0<|\eta|<3.5\)), or in the very forward region (\(|\eta|>4.4\)), are excluded from the minimization.

Reconstructed jets are associated to the nearest truth jet (in \(\phi-\eta\) space), obtained, as discussed in Section 2, running the same reconstruction algorithm on the final state particles from the event generator.

The following quantity is minimized using MINUIT:

\[\chi^{2}=\sum_{e}\left(\frac{E^{(e)}-E^{(e)}_{\mathrm{truth}}}{E^{(e)}_{ \mathrm{truth}}}\right)^{2}, \tag{4}\]where the sum runs over the considered events \(e\), \(E^{(e)}\) is defined in equation (2) and \(E^{(e)}_{\rm truth}\) is the energy of the matched truth jet.

It should be noted that this approach partially absorbs effects that are not purely calorimetric into the weights. In particular, the energy smearing introduced by the central solenoidal magnetic field, which bends low \(p_{\rm T}\) particles in and out of the jet cone, is not treated separately, but the effect is proven to be small for the cone \(R_{\rm cone}=0.7\) jets used for the minimization.

In order to correct for residual non-linearities in the jet response, a further, reconstruction algorithm dependent, correction function is introduced. The final 4-vector of a jet is thus defined as

\[E_{\delta}=\rho_{\delta}(E_{\rm T},\eta)E\qquad\vec{p}_{\delta}=\rho_{\delta} (E_{\rm T},\eta)\vec{P} \tag{5}\]

\begin{table}
\begin{tabular}{c|c|c} \hline \hline Region name & Longitudinal Sample & Number of parameters \(N_{P}\) \\ \hline \hline wemb0 & Barrel pre-sampler & 1 \\ wemb1 & Barrel EM strips & 1 \\ weme0 & End-Cap pre-sampler & 1 \\ weme1 & End-Cap EM strips & 1 \\ emb0 & Barrel middle and back sample, \(|\eta|<0.8\) & 4 \\ emb1 & Barrel middle and back sample, \(|\eta|>0.8\) & 4 \\ eme0 & Endcap middle and back sample, \(|\eta|<2.5\) & 4 \\ eme1 & Endcap middle and back sample, \(|\eta|>2.5\) & 4 \\ til0 & Barrel & 4 \\ til1 & Extended Barrel & 4 \\ hec0 & Hadronic End-Cap, \(|\eta|<2.5\) & 4 \\ hec1 & Hadronic End-Cap, \(|\eta|>2.5\) & 4 \\ fem & FCal first layer & 3 \\ fhad & FCal second and third layer & 3 \\ cryo & Cryostat term & 1 \\ scint & Scintillator term & 1 \\ gap & Gap term & 1 \\ \hline \hline Total & & 45 \\ \end{tabular}
\end{table}
Table 1: Definition of regions defined for the minimization that determines the cell weights. The third column shows the number of parameters used in the minimization.

\begin{table}
\begin{tabular}{c|c} \hline \hline Sample Tag & \(p_{\rm T}\) cut \\ \hline \hline J1 & \(17\) GeV \(<p_{\rm T}<35\) GeV \\ J2 & \(35\) GeV \(<p_{\rm T}<70\) GeV \\ J3 & \(70\) GeV \(<p_{\rm T}<140\) GeV \\ J4 & \(140\) GeV \(<p_{\rm T}<280\) GeV \\ J5 & \(280\) GeV \(<p_{\rm T}<560\) GeV \\ J6 & \(560\) GeV \(<p_{\rm T}<1120\) GeV \\ J7 & \(1120\) GeV \(<p_{\rm T}<2240\) GeV \\ J8 & \(p_{\rm T}>2240\) GeV \\ \hline \hline \end{tabular}
\end{table}
Table 2: List of the QCD dijet events used to compute the calibration constants listed in the text.

where \(\delta\) indicates the dependence on the jet reconstruction algorithm and \(E_{\rm T}\) and \(\eta\) are the transverse energy and the pseudorapidity of the 4-vector \(p^{\mu}\). The _scale factor_\(\rho_{\delta}(E_{\rm T},\eta)\) is obtained fitting the ratio \(E_{\rm T}/E_{\rm T,\,truth}\) in 44 bins of \(\eta\) as a function of \(E_{\rm T}\) with the following function:

\[f(E_{\rm T})=\sum_{i=0}^{3}c_{i}\log^{i}E_{\rm T} \tag{6}\]

and, for a given \(\delta\) and \(\eta\) bin,

\[\rho=1/f. \tag{7}\]

The scale factor corrects for the residual non-linearity introduced by the cracks and gaps in the calorimeter and for differences introduced by the use of different reconstruction algorithms, finally recovering the truth jet scale. The size of this final correction is at the level of few percent (up to 5%) in the crack and gap calorimeter region, while it is of the order of 1-2% (depending on the jet algorithm) in the rest of the \(p_{\rm T}\)-\(\eta\) phase space.

Therefore, the complete set of calibration parameters for a given reconstruction algorithm includes the cell energy density dependent weights obtained with cone \(R_{\rm cone}=0.7\) jets, plus specific scale factors.

### Results on dijet events

All the jet corrections computed as described in the previous section (scale factor included) have been applied to dijet events. The parameters that are considered in order to assess the quality of the calibration are the jet linearity, defined as the ratio between the reconstructed jet energy and the corresponding truth jet energy (as defined in Section 2) and the energy resolution.

The matching between the reconstructed jets and the truth jets is done considering their separation in a \(\eta-\phi\) plane, defined as

\[R_{\rm cone}=\sqrt{\Delta\phi^{2}+\Delta\eta^{2}} \tag{8}\]

A truth jet is matched with a reconstructed jet if \(R_{\rm cone}<0.2\).

Once the matching is done, the \(E-\eta\) phase space of the truth jets is subdivided into bins. For each bin in energy and pseudorapidity, a histogram is filled with the ratio between the reconstructed energy and the truth energy \(E_{\rm rec}/E_{\rm truth}\). The resulting histogram is first fitted with a gaussian in the whole histogram range. This provides two estimates (\(\mu_{\rm raw}\), \(\sigma_{\rm raw}\)) for the mean value and the width of the distribution. The fit is then repeated in the range \(\mu_{\rm raw}\pm 2\sigma_{\rm raw}\). This provides the final values (\(\mu\), \(\sigma\)) that are used in the summary plots. Two examples of such histograms are shown in Fig. 2 for two different pseudorapidity and energy bins.

Figure 3 shows the dependence of \(\langle E_{\rm rec}/E_{\rm truth}\rangle\) (linearity, in the following) on the truth jet energy \(E_{\rm truth}\) for jets reconstructed from calorimeter towers. The plot on the left refers to jets reconstructed with a cone algorithm with radius of 0.7 while the one on the right is for \(k_{\rm T}\) algorithm with \(R=0.6\)[5].

The results show that the linearity is recovered over a wide energy range, both in the central (\(|\eta|<0.5\)) and in the intermediate (\(1.5<|\eta|<2\)) regions. For the cone algorithm, at low energy (\(E=20-30\) GeV), the linearity differs by up to 5% from 1 in the central region. At low energy, there is a 5% residual non linearity, not fully recovered by the parametrization chosen for the scale factor.

Concerning the intermediate pseudorapidity region, we can see a similar behavior around 100 GeV (note that in this region \(E\sim 100\) GeV corresponds to \(E_{\rm T}=E/\cosh\eta\sim 35\) GeV).

The linearity plot for the \(k_{\rm T}\) algorithm shows a more pronounced deviation from 1 at low energy (\(\langle E_{\rm rec}/E_{\rm truth}\rangle=5\)% at 50 GeV, 8% at 30 GeV). The linearity is fully recovered above \(\sim 100\) GeV in the central region, \(\sim 300\) GeV in the intermediate region.

Figure 3: Dependence of the ratio \(E_{\rm rec}/E_{\rm truth}\) on \(E_{\rm truth}\) for jets reconstructed with a cone algorithm with \(R_{\rm cone}=0.7\) and with a \(k_{\rm T}\) algorithm with \(R=0.6\). The black (white) dots refer to jet with \(|\eta|<0.5\) (\(1.5<|\eta|<2\)). An ideal detector geometry has been used to simulate the events.

The uniformity of the response over pseudorapidity is also satisfactory. Figure 4 shows the dependence of the ratio \(E_{\mathrm{T}}^{\mathrm{rec}}/E_{\mathrm{T}}^{\mathrm{truth}}\) on the pseudorapidity of the matched truth jet for three different transverse energy bins. Again, the left plot refers to cone 0.7 jets, while the right one refers to \(k_{\mathrm{T}}\) jets with \(R=0.6\). We can observe that for the lowest considered transverse energy bin, the ratio increases with the pseudorapidity. This is a consequence of the fact that energy increases with \(\eta\) at fixed \(E_{\mathrm{T}}\) and that the linearity improves with increasing energy.

We can also observe (in particular for the \(k_{\mathrm{T}}\) algorithm) the remnants of the calorimeter structure, which is not completely corrected by the procedure. There is a first, small dip at \(|\eta|\sim 1.5\), in correspondence with the gap between the TileCal barrel and extended barrel [2]. A second dip is observed in correspondence with the calorimeter crack between the End-Cap and the forward calorimeters.

Even if the effect is smaller when higher \(E_{\mathrm{T}}\) bins are considered, it is still present in the crack region. Jets with \(E_{\mathrm{T}}\sim 400\,\mathrm{GeV}\) still show a slight \(\eta\) dependence in their response. As a last indicator of the quality of the correction factors, we consider the energy resolution \(\sigma(E_{\mathrm{rec}})/E_{\mathrm{rec}}\). The dependence of the energy resolution on the jet energy is shown in Fig. 5 for the cone (left) and \(k_{\mathrm{T}}\) (right) algorithms in two pseudorapidity bins. The fit to the data is done considering three terms contributing independently to the resolution:

\[\frac{\sigma}{E}=\frac{a}{\sqrt{E\ (\mathrm{GeV})}}\oplus b\oplus\frac{c}{E}. \tag{9}\]

The sampling term (\(a\)) is due to the statistical, poissonian, fluctuations in the energy deposits in the calorimeters. The constant term (\(b\)) reflects the effect of the calorimeter non-compensation and all the detector non-uniformities involved in the energy measurement. The noise term (\(c\)) is introduced to describe the noise contribution to the energy measurement. Although the physics origin of the different terms is quite clear, it should be kept in mind that many different ways of combining them have been used in literature. In particular, the three parameters are correlated, and their values depend on the particular functional form used to parameterize the resolution.

The fit is performed between 30 GeV and 1 TeV. In the central region, the resolution of the \(k_{\mathrm{T}}\) algorithm is significantly worse than that of the cone algorithm at low energy, while it is similar in the high energy region. The dependence of the resolution on the pseudorapidity is shown in Fig. 6. Again, the effect of the gap and crack regions are visible in particular for the lowest \(E_{\mathrm{T}}\) bin, where a clear worsening of the resolution is present in particular around \(\eta=3.2\).

The analysis has been repeated also for jets obtained using the uncalibrated

Figure 4: Dependence of the ratio \(E_{\mathrm{T}}^{\mathrm{rec}}/E_{\mathrm{T}}^{\mathrm{truth}}\) on the pseudorapidity for the cone algorithm with \(R_{\mathrm{cone}}=0.7\) (on the left) and for the \(k_{\mathrm{T}}\) algorithm with \(R=0.6\) (on the right). An ideal detector geometry has been used to simulate the events.

Figure 5: Energy resolution as a function of the jet energy for the cone algorithm with \(R_{\rm cone}=0.7\) (on the left) and for the \(k_{\rm T}\) algorithm with \(R=0.6\) (on the right). The black (white) dots refer to jets with \(|\eta|<0.5\) (\(1.5<|\eta|<2\)). The smooth curves correspond to a fit done using the parametrization of Eq. 9. An ideal detector geometry has been used to simulate the events.

Figure 6: Energy resolution as a function of the pseudorapidity for the cone algorithm with \(R_{\rm cone}=0.7\) (on the left) and for the \(k_{\rm T}\) algorithm with \(R=0.6\). An ideal detector geometry has been used to simulate the events.

Section 5) as input for the jet reconstruction algorithms, obtaining very similar results for the linearity and the uniformity. The values of the parameters obtained with the fit of the function expressed in equation (9) to the simulation results are given in Table 3.

First, at fixed pseudorapidity, the sampling term is almost constant for the different reconstruction algorithms and for the different inputs. The sampling term in the central calorimeter region is about 65%, in rough agreement with what has been found previously with similar calibration approaches [6]. The constant term is also independent of the reconstruction algorithm and input type. The noise term on the other hand shows a slight variation between jets reconstructed from towers or from topological clusters, and is a significant contribution to the jet energy resolution for energies below 100 GeV. In particular, the noise term is lower if topoclusters are used. A significant difference is also observed between the cone and the \(k_{\mathrm{T}}\) algorithm, the latter showing a larger noise value.

### Results on \(t\bar{t}\) and SUSY events

We now verify the quality of the jet calibration on two radically different physics samples. We consider first a \(t\bar{t}\) sample, generated with mc@nlo[7]. The event generator used to produce the final state particles is herwig interfaced with jimmy[8], whose fragmentation model is different from the phythia one considered so far. Moreover, most of the jets in \(t\bar{t}\) events are produced by the fragmentation of quarks, while the QCD dijet events contain mostly gluon jets for moderate \(E_{\mathrm{T}}\). The simulation layout used for the \(t\bar{t}\) events is the same distorted layout discussed in [9], i.e. a geometry with increased dead material in particular in the gap region.

We consider a cone algorithm with \(R_{\mathrm{cone}}=0.4\) since it is the one most widely used for analyses concerning the top quark in ATLAS. The performance on QCD dijet events has been checked and the results are very similar to those discussed in Section 3.1 and in [9] for the cone with \(R_{\mathrm{cone}}=0.7\)

The linearity as a function of the energy and the pseudorapidity is shown in Fig. 7. Despite the fundamentally different event structure, an overall acceptable linearity is found also in top events.

We finally consider SUSY events. The sample has been generated with herwig/jimmy and simulated with a distorted geometry. Such events are characterized by a high multiplicity of quark jets (the SUSY point chosen is discussed in [10]). They are thus useful to asses the performance of the jet calibration in busy events.

The linearity (Fig. 8) is overall good. In the central region, a deviation from 1 of maximum 4% is observed at low jet energy. Apart from the expected dip at \(\eta=1.5\), we observe, also, a good uniformity of the linearity as a function of the pseudorapidity. At large pseudorapidity (\(|\mathbf{\eta}|>3.5\)), the linearity is off by 5-6%.

\begin{table}
\begin{tabular}{c c c c c c} \hline \hline Reconstruction Algorithm & \multicolumn{3}{c}{\(0<\eta<0.5\)} & \multicolumn{3}{c}{\(1.5<\eta<2.5\)} \\  & a (\%) & b (\%) & c (GeV) & a (\%) & b (\%) & c (GeV) \\ \hline Cone \(R_{\mathrm{cone}}=0.7\) Tower & \(64\pm 4\) & \(2.6\pm 0.1\) & \(4.9\pm 0.5\) & \(103\pm 10\) & \(2.6\pm 0.8\) & \(8\pm 1\) \\ \(k_{\mathrm{T}}R=0.6\) Tower & \(68\pm 5\) & \(2.5\pm 0.2\) & \(6.3\pm 0.5\) & \(110\pm 1\) & \(1\pm 1\) & \(12.2\pm 2.5\) \\ Cone \(R_{\mathrm{cone}}=0.7\) Topo & \(63\pm 4\) & \(2.7\pm 0.1\) & \(4.2\pm 0.5\) & \(107\pm 8\) & \(1\pm 1\) & \(6.5\pm 1.5\) \\ \(k_{\mathrm{T}}R=0.6\) Topo & \(64\pm 5\) & \(2.7\pm 0.2\) & \(5.4\pm 0.5\) & \(112\pm 4\) & \(1\pm 1\) & \(10.0\pm 1.5\) \\ \hline \hline \end{tabular}
\end{table}
Table 3: Parameters of the resolution parametrization described in the text as obtained with the fit of the resolution curves of Fig.9.

Figure 8: Linearity as a function of energy for three pseudorapidity regions (on the left) and of the pseudorapidity for three transverse energy bins (on the right) for cone 0.4 tower jets in SUSY events.

Figure 7: Linearity as a function of energy for three pseudorapidity regions (on the left) and of the pseudorapidity for three transverse energy bins (on the right) for cone 0.4 tower jets in \(t\bar{t}\) events.

### A check of the systematics with real data

We applied the method discussed so far to single pions from the ATLAS combined test beam of the year 2004 [11]. The weights have been computed on events fully simulated with geant4 using the test beam geometry.

Positively charged beams of different energy impinging with an incident angle of 20 degrees on the calorimeters surface have been considered. The beams are composed of pions, protons, positrons and muons. Signals from scintillators present upstream and downstream of the calorimeters are used as vetoes to reject early showering particles and muons, respectively. To reject the electrons we required an energy deposit in the first two layers of the electromagnetic calorimeter of less than a certain threshold (75% - 90% of the beam energy). A fraction of protons equal to that expected for the chosen beam line has been added to the simulated sample.

The energy distributions obtained for each energy point at the electromagnetic scale and after the calibration are fitted with a Gaussian function. The Gaussian mean values (\(\langle E\rangle\)) are used to evaluate the calibration procedure.

In Fig. 9 (left) the ratios \(\langle E\rangle/E_{\rm beam}\) are shown as a function of the beam energy. The black dots refer to the Monte Carlo at the electromagnetic scale. The black squares refer to the Monte Carlo after the weighting. The procedure restores the linearity at the 2% level for the simulation.

In the same figure the results on the real data are also shown (gray markers). In this case the linearity is also restored to within a few percent.

To evaluate these differences, we define the ratio \(R=\langle E_{\rm data}/E_{\rm MC}\rangle\). Fig. 9 (right) shows the double ratio \(R_{\rm HAD}/R_{\rm EM}\) of the points of Fig. 9 (left). This plot is showing the effect of the calibration procedure on the agreement between data and simulation. The agreement is worse after the application of the calibration procedure by maximum 4%.

Figure 9: On the left: \(\langle E\rangle/E_{\rm beam}\) for simulated (black points) and real (gray points) data at the EM (dots) and calibrated (squares) scales. On the right: Double ratio \(R_{\rm HAD}/R_{\rm EM}\).

### Summary

The tests discussed in this Section are meant to demonstrate the robustness of the jet corrections computed as discussed at the beginning of the present Section. Summarizing, we can say that the discussed strategy is able to recover the linearity of the jet energy measurement over a wide energy range, invoking a relatively low number of parameters (of the order of 50) constrained by a fit on QCD dijet events. The fact that the jet corrections can be applied with success to events generated with different showering models, with a very different quark-gluon jet ratio and different topologies, gives confidence in the correction strategy as a method to remove the detector effects.

Alternative global calibration methods

Although the discussed calibration scheme is the most widely used at present in the ATLAS collaboration, it is not the only one that has been investigated.

### Longitudinal shower development

On average, the early part of a hadron shower is dominated by electromagnetic energy deposited by neutral pions and the ratio of visible to invisible energy is large. In the deeper part of the shower this ratio becomes smaller and more of the hadron shower goes undetected. This can be seen in the a quantitative study that was carried out by the ATLAS TileCal collaboration in the 1996 test-beam [12]. It shows that in the first interaction length of the calorimeter approximately 70% of the energy of the hadron shower is deposited as visible electromagnetic energy. The fraction falls off with depth in the calorimeter and at 6\(\lambda\) only 25% the energy of the hadron shower is deposited as electromagnetic energy. Therefore a longitudinal weighting of energy deposition as a function of depth can provide improved resolution and linearity [13]. Figure 1 (right) shows the fraction of energy deposited by a hadronic jet at different depths in the calorimeter. The layers used in this weighting scheme are defined below based on the properties and geometry of different calorimeters.

The above motivation for longitudinal weighting is based on the average shower behavior. Hadron showers fluctuate event-by-event and in a jet, the incoming particle type and energy also varies depending on how the jet fragmentation proceeds. Figure 1 (left) shows the average energy carried by different particle types in a jet. To better account for these differences in shower fluctuation and electromagnetic content of a hadronic jet, the longitudinal weighting is performed in bins of the fraction of energy deposited in the LAr calorimeter. Furthermore, the Atlas calorimeter has a significant variation in geometry as a function of pseudo-rapidity and we therefore fit the parameters in independent bins of jet \(\eta\).

As shown below, a longitudinal weighting based on the above properties of hadron shower development and jets shows a significant improvement in jet energy resolution and linearity with respect to uncorrected jet energy.

#### Longitudinal weighting method

In general the choice of energy layers to be weighted are motivated from the following. In the barrel LAr calorimeter, the first three depths (presampler, EMB1, EMB2) provide a total of \(24X_{0}\). This gives 99% containment for photons with energies up to 140 GeV [14]. For hadronic jets, the energy in these layers is expected to be predominately from neutral pions. The presampler and EMB1 are defined as a single layer for longitudinal weighting purposes. The weight for this layer is expected to be sensitive to energy losses in the inner detector. EMB2, which has \(18X_{0}\) is weighted alone. The EMB3 is thin and has small energy deposit. Therefore the energy in this layer is added to the energy in the first layer of the Tile calorimeter. This allows for simulations to provide an average correction for energy loss in the cryostat. Depending on the jet pseudorapidity, a different number of calorimeter layers are used in the fitting. Up to a pseudorapidity of 1.5 the jet energy is fitted in four layers in the calorimeter defined as follows:

\[E_{0} = E_{\rm presampler}+E_{\rm EMB1}\] \[E_{1} = E_{\rm EMB2}\] \[E_{2} = E_{\rm EMB3}+E_{\rm Tile1}\] \[E_{3} = E_{\rm Tile2}+E_{\rm Tile3}+E_{\rm HCAL}.\]

For a jet \(\eta\) between 1.5 and 3.2 the jet is fitted for two layers in the calorimeter defined as follows.

\[E_{0} = E_{\rm presampler}+E_{\rm LArEM1}+E_{\rm LAer2}\]\[E_{1} = E_{\rm LArEM3}+E_{\rm Tile1}+E_{\rm Tile2}+E_{\rm Tile3}+E_{\rm HCAL }+E_{\rm FCAL}\]

Beyond \(\eta\) of 3.2 up to 4.4 the jet is not divided into calorimeter layer segments and the full jet energy is fitted.

The general strategy of deriving weights for different layers is to minimize the function:

\[S=\sum_{n}\left[\left(E_{n}^{\rm Ref}-E_{n}^{\rm rec}\right)^{2}+\lambda\left( E_{n}^{\rm Ref}-E_{n}^{\rm rec}\right)\right] \tag{10}\]

with

\[E_{n}^{\rm rec}=\sum_{i}w_{i}E_{i} \tag{11}\]

where the \(w_{i}\) are weights assigned to the elements \(E_{i}\) of a calorimeter layer in a jet. \(E_{n}^{\rm Ref}\), the true energy to which we want to calibrate, is defined as the energy of all the MC generated particles contained in the cone of the reconstructed jet. The Lagrange multiplier \(\lambda\) constrains the minimization such that \(\langle E^{\rm Ref}-E^{\rm rec}\rangle=0\). The minimization is performed separately for jets classified in bins of eta (44 eta bins of size 0.1), three fractional energies (\(f_{\rm em}\)) deposited in the EM calorimeter and two energy bins. The fractional energy \(f_{\rm em}\) is defined as

\[f_{\rm em}=(E_{\rm Presampler}+E_{\rm LArEM1}+E_{\rm LArEM2})/E^{\rm rec}. \tag{12}\]

Three bins in \(f_{\rm em}\) are chosen such that each bin has roughly the same statistics. At high energies the three bins are (small: 0.0-0.65), (mid: 0.65-0.75) and (large: 0.75-1.0). At low energies they are

Figure 10: The longitudinal weights as a function of jet energy for four layers in three \(f_{\rm em}\) bins and for central jet \(\eta\).

(0.0-0.75), (0.75-0.85) and (0.85-1.0). The bin size varies with energy since more energetic jets deposit more energy in the deeper part of the calorimeter. Bins in \(f_{\rm em}\) are used only for jets with \(\eta<3.2\).

For each layer, weights are chosen to have the following dependence on the true jet energy:

\[w=a+b\log(E/E_{\rm Cut}), \tag{13}\]

where \(a\) and \(b\) are the parameters to be determined by minimization. When applying these weights to jets, the uncorrected jet energy is used instead of the true jet energy. The result is iterated until a stable value of the corrected jet energy is obtained.

In the above equation, \(E_{\rm Cut}\) is an arbitrary energy chosen according to the following criteria. Since the energy range covered is quite large (25 GeV - 2 TeV) the fit is performed in two independent energy bins. For \(|\eta|<1.2\), \(E_{\rm Cut}=300\) GeV, for \(1.2<|\eta|<3.2\), \(E_{\rm Cut}=450\) and for \(|\eta|>3.2\) it is set to \(35\cdot\cosh(\eta)\) GeV. By choosing \(E_{\rm Cut}\) to be the bin boundary one forces the weight to be equal to the value of \(a\) at the boundary. The energy range below \(E_{\rm Cut}\) is fitted with a fixed value of \(a\). This ensures a smooth behavior of weights across \(E_{\rm Cut}\) and reduces the lower energy fit from a two parameter to a one parameter fit. The same smoothness in the behavior of weights across \(\eta\) and \(f_{\rm em}\) is not strictly imposed in the present fit, although the weights do not have strong variation across the bin boundaries.

The fitting procedure was applied to a fully simulated and reconstructed QCD dijet sample. To suppress noise, topological clusters were used. The jet algorithm (cone \(R_{\rm cone}=0.7\)) is run on calorimeter towers which contain only cells which are included in the reconstructed topological clusters. Half of the events in the sample were used to determine the layer weights. These weights were then applied to the other half of the events to determine the effect of the weights on jet energy linearity and resolution.

Figure 10 shows the behavior of the weights in bins of \(f_{\rm em}\). A common feature in all the weight distributions is a small variation with respect to the jet energy, especially for high energies. This ensures insensitivity to the use of the true jet energy in equation 13. Layer 2, which measures the bulk of the jet energy has a weight close to 1 when \(f_{\rm em}\) is large i.e when the jet is predominantly electromagnetic in nature. When \(f_{\rm em}\) is large i.e when the jet is predominantly hadronic, the layer 2 weights are around 1.4. Layer 1 acquires a generally higher weight due to losses in the inner detector, even though it is within the early part of the jets. Layer 3 and 4 get weights larger than 1 corresponding to jets being predominantly hadronic in these layers. Layer 3 gets larger weights than layer 2 since it also corrects for energy lost in the cryostat.

Figure 11 shows the jet energy scale linearity as a function of jet energy (left). The corrected jet energy scale is linear to about 2% with the largest non-linearity coming from low energies where the uncorrected non-linearity is approximately 30%. Figure 11 (right) shows the corresponding linearity as a function of detector pseudo-rapidity for jets of 1000 GeV in energy. The typical non-uniformity is about 1%, increasing to about 2% in the region of \(\eta\sim 3.0\). Jet energy resolutions as a function of the jet energy scale is shown in Fig. 12 for two different jet eta regions. At high energy the jet resolution approaches about 4%.

In terms of jet energy linearity, the longitudinal weighting and H1-style weighting scheme (Section 3) have comparable performance, although the H1-style weighting scheme shows a slightly better resolution. This is expected since H1-style weighting uses local cell energy density to discriminate between EM and non-EM like energy deposits. In contrast, longitudinal weighting is less sensitive to local energy fluctuations, which may be an advantage in the early data taking period, when the simulation of energy deposition in the calorimeter may not accurately reproduce the data.

## 5 Local hadron calibration

In contrast to the global calibration method just described, where first jets are made from towers or clusters on the electromagnetic scale and the calibration is applied after jet-making on cell or sampling Figure 11: Jet energy linearity as a function of jet energy (left), and as a function of jet pseudorapidity (right). The points are for jets reconstructed at the electromagnetic scale (EM), for the global weighting scheme described here (Samp) and for the H1-style calibration described in the previous Section. The jets have a cone radius of \(R_{\rm cone}=0.7\).

Figure 12: Jet energy resolution for jets with a cone radius of 0.7 for two regions in pseudorapidity. The three sets of point show the resolution at the detector (EM) scale, after H1-style and longitudinal weighting.

level, the local hadron calibrated jets are made from clusters which are already calibrated to the hadronic scale.

### Topological clusters

The cluster algorithm used is described in detail in Ref. [15]. Clusters grow dynamically around seed cells based on noise thresholds and are re-grouped in a second splitter step around local maxima.

The aim of the clustering step before the actual jet making is two-fold:

1. To suppress noise from electronics and pile-up by reducing the number of cells included in the jets via noise-driven clustering thresholds.
2. To improve the correspondence between clusters and particles. Due to the dynamic nature of the cluster growing, individual clusters correspond better to stable particles than towers or cells and the jet constituents can serve to further study the substructure of jets.

To illustrate the effect of noise reduction by using topological clusters as input to jets the amount of noise at the electromagnetic scale and the number of cells per jet for cone jets with \(R_{\rm cone}=0.7\) is compared in Fig. 13 for jets from dijet simulations with towers as input and with topological clusters as input. The noise reduction is a direct consequence of selecting fewer cells with topological clusters. The effect is largest for low energetic jets since the size and number of signal clusters becomes small. The number of cells per jet for tower jets does not depend on the energy since no threshold for the towers is applied. Subsequently the noise changes only if a cell included in a tower jet switches to a lower gain. For the displayed energies this effect is visible in the forward region only. For jets from topological clusters the noise increases with energy and at transverse energies of \(150\,\mathrm{GeV}\) it is typically a factor of 2 lower than for a corresponding tower jet except for the very forward region where the signals are so dense that the topological clusters again include almost all cells and the noise level reaches that of the tower jets.

Figure 14 shows the correspondence of clusters and stable truth particles in a dijet simulation. The sample shown is a PYTHIA QCD dijet sample with the transverse energy of the leading jet between \(140\,\mathrm{GeV}\) and \(280\,\mathrm{GeV}\). Roughly 1.6 truth particles correspond to each of the \(65\pm 30\) clusters for a cut at \(1\,\mathrm{GeV}\) in transverse energy, but the ratio does not depend on the cut. It is close to the expected ratio of \(\sim 4/3\) since about \(1/2\) of the stable particles in jets are photons from \(\pi^{0}\)-decays, which usually merge to one cluster.

Figure 13: Noise contents (left) and number of cells per jet (right) of Cone jets with \(R_{\rm cone}=0.7\) for different energies for towers as input (open symbols) and topological clusters as input (filled symbols).

[MISSING_PAGE_FAIL:19]

signals are found to be highly correlated with the lost energy and the corrections are derived from the sum of calibration hit energies in the upstream regions and the presampler signal.

The correction for energy deposited in the outer cryostat wall between the electromagnetic and hadronic barrel calorimeters is based on the geometrical mean of the energies in the samplings just before and just beyond the cryostat wall. Corrections for other energy deposits without clear correlations to cluster observables are obtained from lookup tables binned in cluster energy, \(|\eta|\), and shower depth.

### Performance for jets

The aim in this section is to evaluate the degree of completeness of the local hadron calibration when applied to jets. The performance of the local hadronic calibration scheme was evaluated using the dijet samples listed in Table 2 and two methods: by comparison to particle jets as described above in section 3.1, and by comparison to the calibration hits in the geant4 record. Since no truth matching occurs in the derivation of the calibration constants genuine jet-level effects are expected to be visible once the reconstructed jet is compared to the matching jet made of stable truth particles. The main sources of remaining energy corrections are:

**Misclassification**: Hadronic energy deposits which are treated as electromagnetic lead to a lower energy response, while electromagnetic energy deposits wrongly treated as hadronic lead to a higher energy response. The effect of energy underestimation dominates and is roughly 3% for \(p_{\perp}\simeq 150\,\mathrm{GeV}\).
**Lost Particles**: Low energetic particles might be bent outside the acceptance cone of the reconstructed jet or reach the calorimeter inside the acceptance cone but leaving a signal below threshold for the clustering. Both effects are estimated to add up to 5% for \(p_{\perp}\simeq 150\,\mathrm{GeV}\), with 3% stemming from low energy deposits not included in the clusters and 2% from particles bent outside the acceptance cone.

Jets formed from topological clusters, calibrated using the local hadronic calibration scheme, were compared to the truth jets as done with the previous calibration methods. Figure 15 shows the linearity for Cone \(R_{\mathrm{cone}}=0.7\) and \(k_{\mathrm{T}}\)\(R=0.6\) dijets for 3 different \(|\eta|\) regions as a function of the jet energy. The performance in the forward region is especially low because of a scale error of 10% introduced in the simulations2). The forward scale error highlights another strength of the calibration hits - they can in fact reveal that there is a problem in the predicted reconstructed energy. All calibration methods discussed in this note would yield an overestimation of the jet energy in the forward region in real data if this simulation problem would not be fixed in the samples needed to derive the calibration constants.

Footnote 2): The assumed sampling fraction did not correspond to the actual sampling fraction in the FCal region and thus the assumption that electromagnetic showers can remain un-scaled leads to an underestimation of the energy.

In the other pseudo-rapidity regions the linearity is rising from 80% at 30 GeV to over 95% at 1 TeV. Figure 16 shows the linearity as a function of the true jet \(|\eta|\) for 4 different jet energies. Dips in the linearity are clearly visible for the transition regions between the calorimeter systems at the gap region (\(1.3<|\eta|<1.5\)) and the crack region (\(3.0<|\eta|<3.5\)). For the forward region, the mentioned scale error is very clearly visible: the linearity cannot be recovered and the scale is off by 10%. The dependency of the linearity on the jet energies can also be observed in these plots: while the linearity for jets with about 100 GeV can be recovered up to about 90% (85% in the gap region), high energy jets (of about 1 TeV) show a linearity of about \(95-97\%\) which is compatible with the 3% loss due to misclassification as discussed above. Although a simple scale function, such as given in Eq. (5) on the jet level, would restore the linearity and give a comparable performance as the global calibration, our goal is to understand and correct for these effects in order to recover the linearity instead by correction functions based on the jet constituents.

Figure 16: Linearity for Cone jets with \(R_{\rm cone}=0.7\) (left) and Kt jets with \(R=0.6\) (right), both calibrated with the local hadron calibration method, using truth particle jets as reference. The linearity is shown as a function of the matched truth jet \(|\eta|\).

Figure 15: Linearity for Cone jets with \(R_{\rm cone}=0.7\) (left) and Kt jets with \(R=0.6\) (right), both calibrated with the local hadron calibration method (LC), using truth particle jets (MC) as reference. The linearity is shown as a function of the matched truth jet energy.

The jet energy resolution is shown in Fig. 17 as a function of the true jet energy. Table 4 shows the parameterised resolution obtained using this method as a function of energy and rapidity. It's performance is typically 20% or more above that obtained using the global calibration method. We discuss some possible improvements to the local hadronic calibration method below.

A detailed analysis of the performance of the local calibration when applied to jets is also presented in Ref. [19], where different local calibration approaches are compared to the performance of the H1 global calibration.

### Further Improvement

As seen in the previous section several jet-level corrections need to be applied in order to bring jets made of local hadron calibrated topological clusters to the truth particle scale. However, the global method is seen to exhibit somewhat superior performance indicating that further improvements should be possible since both methods use shower development as their fundamental basis.

Figure 18 (left) shows the ratio of the corrected energy as obtained from the reconstructed calorimeter cells to the energy obtained from the geant4 calibration hits in the clusters and in dead material. A significant deficit is seen at low energy. Figure 18 (right) shows the ratio of the the energy obtained from the geant4 calibration hits in the clusters and in dead material to the energy of the nearest truth particle jet. In this case we see roughly unity at high energy and only a 10% deficit at low energy. Since this comparison is to the truth particle jet, we attribute this deficit to out of cone energy. We therefore conclude that the dominant effects on the non-linearity at low energies seen in Fig. 18 stem from particles lost in the dead material upstream of the calorimeters. These low energy pions deposit most of their energy in upstream materials and often do not leave a sufficiently large signal in the calorimeters to cause a cluster to be formed. At present, no good observable on the local cluster level aids in recovering

\begin{table}
\begin{tabular}{c c c c c c} \hline \hline Reconstruction Algorithm & \multicolumn{3}{c}{\(0<|\eta|<0.5\)} & \multicolumn{3}{c}{\(1.5<|\eta|<2.0\)} \\  & a (\%) & b (\%) & c (GeV) & a (\%) & b (\%) & c (GeV) \\ \hline Cone \(R_{\text{cone}}=0.7\) LC & \(78\pm 8\) & \(3.5\pm 0.8\) & \(2.3\pm 0.9\) & \(98\pm 14\) & \(7.7\pm 1.7\) & \(3.3\pm 0.7\) \\ \(k_{\text{T}}\)\(R=0.6\) LC & \(79\pm 8\) & \(4.7\pm 0.7\) & \(2.4\pm 0.6\) & \(117\pm 15\) & \(9.7\pm 1.9\) & \(1.2\pm 2.3\) \\ \hline \hline \end{tabular}
\end{table}
Table 4: Resolution as function of \(\text{E}_{\text{true}}\) for jet with the local hadron calibration applied.

Figure 17: Resolution for Cone jets normalized to the reconstructed jet energy with \(R_{\text{cone}}=0.7\) (left) and \(\text{Kt}\) jets with \(R=0.6\) (right), both calibrated with the local hadron calibration method, using truth particle jets as reference. The resolution is shown as a function of the matched truth jet energy.

this lost energy and the local calibration method can not account for it. Corrections for these effects are currently being studied. A scaling function like Eq. (5) which is used in the global method would help to restore the linearity in Fig. 15 but would not improve the resolution. The generalization of cluster shape variables to the jet level (number of low energetic constituent clusters, energy distribution of the constituent clusters, etc.) might help in order to obtain correction procedures that depend only indirectly on the used jet algorithm, restore the linearity and improve the resolution. The missing energy content can for example be estimated by extrapolating the actual distribution of constituent cluster energies to zero GeV to recover the lost contributions from low energetic particles. The in-situ methods as discussed in Ref. [20] can be used to validate the corrections obtained and to possibly compensate residual non-linearities.

## 6 Track-based improvement in the jet energy resolution

We present a track-based method for improving the jet energy resolution in ATLAS. Unlike energy-flow techniques reference, information is added to the reconstructed jet, after the global jet energy scale corrections have been implemented, and the track-based correction is applied based on the fraction of jet momentum carried by charged tracks associated with the jet. Using this correction, a \(\sim 20\%\) improvement in jet energy resolution at low energy is achieved.

In this chapter we describe a technique that uses tracks in jets to extract information from the jet topology and fragmentation in order to improve the jet energy resolution. The approach is conceptually different from more traditional energy flow methods, where precise track momentum measurements replace calorimeter clusters. In the proposed technique, tracks are used to correct the response of jets as a function of the jet particle composition, specifically using the ratio of track to calorimeter transverse momentum (\(f_{\mathrm{trk}}=\frac{p_{\mathrm{trk}}^{\mathrm{tracks}}}{\mathrm{r}_{ \mathrm{T}}^{\mathrm{ calorimeter}}}\)). Using \(f_{\mathrm{trk}}\) provides an improvement in jet energy resolution without changing the jet energy scale applied during reconstruction.

In general, jets are composed primarily of neutral and charged pions. Charged particles leave tracks in the detectors, and so one might naively expect that approximately two-thirds of the jet energy will be carried by tracks associated with that jet. Monte Carlo QCD dijet samples show Gaussian \(f_{\mathrm{trk}}\) distributions centered around 0.66, with small tails extending above 1. The tails are more prominent at low

Figure 18: \(E_{\mathrm{weighted}}+\mathrm{DM\ corrected}/E_{\mathrm{in}}\mathrm{ cluster\ truth}+\mathrm{DM\ truth}\). the reconstructed weighted and dead-material corrected energy over the the predicted true energy inside clusters and associated dead material regions (left) and \(E_{\mathrm{in}}\mathrm{cluster\ truth}+\mathrm{DM\ truth}/E_{\mathrm{truth}}\), the ratio of the predicted true energy inside clusters and associated dead material regions (the denominator in the left plot) over the energy of the matched truth particle jet (right) as function of the matched truth jet energy for cone jets with \(R_{\mathrm{cone}}=0.7\).

energies and include, for example, jets with a true \(f_{\rm trk}\) near one and one or more tracks with incorrectly measured momenta.

The fractional jet energy resolution, \(\frac{\sigma(p_{\rm T}^{\rm geo}-p_{\rm T}^{\rm true})}{p_{\rm T}^{\rm true}}\), is proportional to the width of the jet energy response in bins of transverse energy, normalized to the average jet energy in a bin. If the response of these jets varies significantly with \(f_{\rm trk}\), the transverse jet energy resolution will be artificially broadened, as shown in Fig. 19. One sees that the total measured transverse jet energy resolution is considerably wider than either of the constituents corresponding to jets with different charged particle fractions. By correcting the jet response as a function of jet \(p_{\rm T}\) and \(f_{\rm trk}\) we reduce the overall broadening of the energy distribution and, hence, improve the jet energy resolution.

### Monte Carlo samples and event selection

Track based jet corrections were determined using QCD dijet events. The MC events used are the same J1-J4 samples described in Table 2. The reconstructed jets in the samples ranged in \(p_{\rm T}\) from 7 to 280. Only jets with energies above 45 were used in the fits.

Reconstructed 0.4 cone, tower-seeded jets were selected from the event and separated into bins of pseudorapidity. Fits were formed for the central (\(|\eta|<1.2\)), transition (1.5\(<|\eta|<\)1.8) and end cap (1.9\(<|\eta|<\)2.2) regions of the calorimeters. Because the ATLAS tracker acceptance ends at \(|\eta|\)=2.5, jets beyond \(|\eta|=2.0\) were not considered for fits.

Tracks within a cone of radius 0.4 in \(\eta-\phi\) around a jet axis were included in the calculation of \(f_{\rm trk}\). In order to remove jets with a single poorly measured track, jets were required to be associated with at least two tracks, and each track was required to have \(\chi^{2}/DoF<3.0\). Less than 1% of the tracks and jets were rejected by these cuts. The requirement of two tracks was only applied to derive the correction and not to evaluate the performance. In order to be as inclusive as possible, all calorimeter jets were considered. To find the track-based energy corrections, jets were also required to be isolated in a cone of

Figure 19: Black: difference between reconstructed and truth jet transverse energy for jets with \(0<|\eta|<0.7\) and \(40\,\,\mathrm{GeV}<p_{\rm T}<200\,\,\,\mathrm{GeV}\). The mean (width) of this distribution is proportional to the jet energy response (resolution). Since jets with different \(f_{\rm trk}\) have different responses, the transverse energy resolution is artificially broadened because of the offset of the distributions for each \(f_{\rm trk}\) bin. The normalization is arbitrary.

\(0.8\) in \(\eta-\phi\) space, to avoid jet-jet contamination which skew \(f_{\rm trk}\) considerably for low energy jets. After cuts, each jet contained typically 5 to 8 tracks.

Jets were also required to have a truth jet matched within 0.1 in \(\eta-\phi\) space, and were required not to be matched to a truth \(b\)-quark. Jets with \(b\)-quarks could have different energy responses compared to light quark jets and were excluded from the fits. Incorporating a track-based \(b\)-jet energy correction is a topic for future studies.

### Track-based jet energy response parameterization

Fits to the jet energy response are made as functions of \(f_{\rm trk}\) and \(p_{\rm T}\). The fits were also binned in regions with flat response as a function of pseudorapidity. Three such regions were identified: one in the barrel calorimeter, one in the endcap calorimeter, and one in the transition region between the two. The fits are then extended to nearby regions so that all jets are eventually corrected. Since the transitions between the calorimeters are discontinuous, the transitions between the corrections were discontinuous for this first version of track corrections.

One dimensional fits of the response as a function of jet \(p_{\rm T}\) were performed in bins of \(f_{\rm trk}\) with the function \(R^{f_{\rm trk}}(p_{\rm T})=E_{T}^{\rm jet}/E_{T}^{\rm true}=a\left(1-e^{b-c \cdot p_{\rm T}}\right)\). Sample fits are shown in Fig. 20 (left). The bins in \(f_{\rm trk}\) were adjusted so that each bin contained approximately the same number of jets, and no single bin spanned a large range of \(f_{\rm trk}\). The \(p_{\rm T}\) used for each point of the fit was taken to be the average \(p_{\rm T}\) of jets in that bin, and the \(f_{\rm trk}\) recorded for the bin was the average \(f_{\rm trk}\) of all jets in that bin.

The jet \(p_{\rm T}\) fit parameters were then extracted and fitted with a straight line function of \(f_{\rm trk}\), as shown in Fig. 20 (right) for parameter \(a\). The 2-dimensional track-jet energy corrections, \(R(p_{\rm T},f_{\rm trk})\) can be applied to reconstructed jets to improve their average response.

### Algorithm performance

The track-jet response correction \(R(p_{\rm T},f_{\rm trk})\) described previously was first applied to jets selected for determining the parameterization. The jet energy response was then checked as a function of \(f_{\rm trk}\). Figure 21 (left) shows the dependence of the response on \(f_{\rm trk}\) before and after applying the track-jet correction. Track-jet corrections flatten the response, \(R^{f_{\rm trk}}(p_{\rm T})=E_{T}^{\rm jet}/E_{T}^{\rm true}\), to a mean value of 1 for all \(f_{\rm trk}\). An overcorrection at high \(f_{\rm trk}\) appears. As the overlaid distribution of \(f_{\rm trk}\) demonstrates, very few jets lie in this region and so the total energy resolution is not altered.

Figure 20: On the left, fits as a function of reconstructed jet \(p_{\rm T}\) for central (\(|\eta|<0.7\)) jets in bins of \(f_{\rm trk}\). On the right, straight line fit of one of the parameters determined by \(p_{\rm T}\) fits, as a function of \(f_{\rm trk}\).

As described earlier and shown in Fig. 19, the jet resolution before the \(R(p_{\mathrm{T}},\,f_{\mathrm{trk}})\) correction can be thought of as a convolution of distributions consisting of the sum of several offset Gaussians with different \(f_{\mathrm{trk}}\). By re-centering the underlying distributions we improve the jet transverse energy resolution. Fig. 21 (right) shows the overlapping distributions after re-centering.

The fitted corrections were applied to all jets above 40  in the dijet samples. The following studies show the improvement of jet transverse energy resolution and \(E_{\mathrm{T}}^{\mathrm{miss}}\) distributions after the corrections are applied.

#### Jet transverse energy resolution

The transverse jet energy resolution is considerably improved at low jet \(p_{\mathrm{T}}\), as demonstrated in Fig. 22. Fits are shown both before and after the corrections are applied. A \(\sim\) 15% improvement in energy resolution is achieved at 60.

#### resolution

Track-based jet corrections can also be used to improve the scale of the missing transverse energy. The track-corrected \(E_{\mathrm{T}}^{\mathrm{miss}}\) is computed as

\[\vec{E_{T}}^{\mathrm{\,corr}}=\vec{E_{T}}-\sum(\vec{p_{\mathrm{T}}}^{\mathrm{ trk,\,corr}}-\vec{p_{\mathrm{T}}}) \tag{14}\]

where the sum refers to the two leading jets, and \(\vec{p_{\mathrm{T}}}^{\mathrm{\,trk,\,corr}}=p_{\mathrm{T}}/R(p_{\mathrm{T}}, \,f_{\mathrm{trk}})\) is the jet transverse momentum corrected as described in Section 6.2.

Figure 23 (left) shows the mean value of the \(E_{\mathrm{T}}^{\mathrm{miss}}\) as a function of the \(f_{\mathrm{trk}}\) difference between the two leading jets in a dijet sample. Both leading jets were required to have \(|\eta|<1.2\) for this study. Figure 23 (left) shows a large imbalance of energy when the two jets have large differences in \(f_{frk}\). When \(\Delta f_{\mathrm{trk}}<0\)

Figure 21: On the left: absolute jet energy response as a function of \(f_{\mathrm{trk}}\), before and after applying the track-jet response correction. The distribution of \(f_{\mathrm{trk}}\) has been overlaid to show the jet distribution. All jets used in the fits are included. On the right: jet transverse energy response after the track-jet response correction for jets with \(0<|\eta|<0.7\) and \(40\,\,\mathrm{GeV}<p_{\mathrm{T}}<200\,\,\,\mathrm{GeV}\). The underlying Gaussian distributions are now overlapping, and the measured jet transverse energy resolution has been reduced.

\(f_{\rm trk}^{2}>f_{\rm trk}^{1}\) and \(p_{T}^{2}\) is underestimated resulting in a positive bias on \(E_{\rm T}^{\rm miss}\). Similar argument explains a negative \(E_{\rm T}^{\rm miss}\) bias for \(\Delta f_{\rm trk}>0\).

Figure 23 (right) shows that the \(E_{\rm T}^{\rm miss}\) scale is properly corrected after applying the track-based response correction to the leading two jets, and the \(E_{\rm T}^{\rm miss}\) bias has been removed.

### Conclusions and future studies

Although the corrections in this section were calculated only for cone jets with \(\Delta R=0.4\), they can be trivially extended to any other jet collection, including \(k_{\rm T}\) jets.

We introduced a track-based method for correcting the response of jets in ATLAS that provides a \(\sim 20\%\) improvement in jet energy resolution at 50 GeV. The corrections also improve missing energy distributions. These corrections do not require new jet energy scale corrections and can be applied after the standard reconstruction. By systematically adding information from the tracker to jets already reconstructed based on calorimeter information, considerable improvements can be made.

There are several additions being explored to further improve the jet energy resolution using this technique and other similar track-based variable methods. This technique will be expanded to correct

Figure 23: Average missing transverse energy as a function of the \(f_{\rm trk}\) difference between the two leading jets in a dijet sample before (left) and after (right) track-based jet energy corrections. The width and tails are improved.

Figure 22: Jet transverse momentum resolution as a function of jet \(p_{\rm T}\) before and after correcting for \(f_{\rm trk}\).

\(b\)-jets in the same way that light quark jets have already been corrected. The radius used for track-jet association may be adjusted to improve the performance. Track-based response corrections will be expanded to include additional variables such as the fraction of transverse momentum carried by the leading track (\(f_{\mathrm{trk}}^{1}\)) and track multiplicity (\(n_{\mathrm{trk}}\)).

## 7 Jet energy scale corrections to semileptonic \(b\) jets

In this section, we discuss a possible strategy to correct the b-jet energy in case of semileptonic decays of the \(b\) quark.

The decay of \(b\) quarks usually produces a \(c\) quark, which subsequently decays to a \(d\) quark. The \(b\) quark decays into a muon and a neutrino \(\approx 10\%\) of the time. As a result, a \(b\) jet is accompanied by a neutrino and a muon \(\approx 19\%\) of the time and by two neutrinos and two muons \(\approx 1\%\) of the time. These neutrinos carry away a fraction of the jet energy, introducing a systematic underestimation of the energy of such jets. In this document, we concentrate on \(b\) jets that contain only one neutrino inside. The neutrino from the semileptonic \(b\) jet decay carries over \(10\%\) of the total jet \(p_{\mathrm{T}}\).

However, these jets can be tagged by the presence of a muon, if the muon is energetic enough to reach the Muon Spectrometer. Upon a successful tag, the jet energy scale can be corrected through a parameterization of the energy carried by the neutrino. In the following sections, a correction of the jet energy scale as a function of jet and muon \(p_{\mathrm{T}}\) for semileptonic \(b\) jets is presented and validated.

### Monte Carlo event selection

For the studies in this document, two data samples were used (\(250\) k \(t\bar{t}\) and the dijet samples described in Table 2)

In addition, for the present studies, semileptonic \(b\) jets were required to be tagged by the soft-\(b\) tagger [21] and be contained within \(|\eta|<1.2\). The \(\eta\) cut is required because the jet response changes for higher \(\eta\). Studies in larger \(\eta\) regions were not possible due to a lack of statistics. For the dijet sample, only events that had two \(b\) jets with \(\Delta\phi>1.0\) were used. This provides a sample composed mostly of \(b\bar{b}\) events as well as a few \(gg\) events where one of the gluons decays to \(b\bar{b}\).

Figure 24: Fraction of \(p_{\mathrm{T}}\) carried by the neutrino in \(b\) jets decaying semileptonically (\(b\to\mu X\) or \(b\to c\to\mu X\)). The abscissa corresponds to the total transverse component for the jet (all interacting particles except muons), muon and neutrino momenta. We use \(b\) jets from QCD dijet samples as described in Section 7.1.

### Derivation of the jet energy scale correction

The jet energy scale correction was derived using semileptonic \(b\) jets from the \(t\bar{t}\) sample. The jet response was studied as a function of jet and muon \(p_{\rm T}\). In particular, it was found that a correlation exists between the jet response and the quantity

\[x=p_{\rm T,reco}^{\mu}/p_{\rm T,reco}^{\rm jet}, \tag{15}\]

where \(p_{\rm T,reco}^{\mu}\) is the reconstructed muon \(p_{\rm T}\), and \(p_{\rm T,reco}^{\rm jet}\) is the reconstructed jet \(p_{\rm T}\), which does not include the muon contribution. The jet responses for samples with different values of \(x\) are shown in the left plot of Figure 25. The responses are shown together with the constant fits used to determine the correlation between the jet response and the quantity \(x\). The fits do well in correcting for the missing neutrino energy, and, therefore, no further dependence on jet \(p_{\rm T}\) has been considered so far. A better modeling of the dependence of the response as a function of jet \(p_{\rm T}\) in the different samples could help improve the correction. The values of the constant fits (\(R\), in the figure above) were then used to parameterize the jet response as a function of \(x\). The values of \(R\) for samples with different values of \(x\) are shown on the right plot of Figure 25. These values were fit to the function \(C(x)=a+be^{-cx}\). This fit is shown on the same plot and resulted in the following values for the parameters: \(a=0.846\), \(b=0.11\) and \(c=6\).

This function was used to correct the jet energy scale. In particular, the corrected \(p_{\rm T}\) of the jet was calculated as:

\[p_{\rm T,corr}^{\rm jet+\mu}=[C(x)]^{-1}p_{\rm T,reco}^{\rm jet+\mu}. \tag{16}\]

The momentum of the jet was increased accordingly along the direction of the vector addition of the muon and jet momenta.

### Validation

The jet response before and after applying the correction for the \(t\bar{t}\) sample is shown in the left plot of Figure 26. The jet response is corrected appropriately with an uncertainty of \(\approx 2\%\) on the correction. The right plot shows the jet response in the dijet samples. The performance of the correction on this sample is comparable to that shown in the \(t\bar{t}\) sample. The relative jet \(p_{\rm T}\) resolution, \(\sigma_{r}/r\) where \(r=p_{\rm T,reco}^{\rm jet+\mu}/p_{\rm T,reco}^{\rm jet+\mu+\nu}\), was also studied for these two samples before and after the correction, but it is not

Figure 25: Left: Jet response as a function of jet \(p_{\rm T}\) for semileptonic \(b\) jets containing one muon for different values of \(x\) (equation 15). Here \(p_{\rm T,true}^{\rm jet+\mu+\nu}\) refers to the transverse component of the vector addition of the true jet momentum (all interacting particles except muons included), the true muon momentum and the neutrino momentum. Right: Value of the results from straight line fits to the points in the left plot as a function of \(x\). The fit function \(C(x)=a+be^{-cx}\) is also shown.

shown. The effect of the correction on this quantity is not noticeable within the statistical uncertainties of these studies.

### Conclusion on the corrections to semileptonic \(b\) jets

In this section, a procedure for correcting the jet energy scale of semileptonic \(b\) jets decaying to a muon has been presented. The procedure has been validated on semileptonic \(b\) jets from two data samples showing a noticeable improvement in the jet response, while the relative \(p_{\mathrm{T}}\) resolution remains unchanged. To conclude, it should be emphasized that the correction of semileptonic \(b\) jets is strongly coupled to our ability to tag them. For this reason, studies in specific physics analyses need to be done to set the operating point of the soft-b tagger. For example, in a \(b\bar{b}\) sample, where there are no light jets, we can benefit from this correction the most, while in a \(t\bar{t}\) sample the operating point of the soft \(b\)-tagger might need to be adjusted and could have too low an efficiency for the correction to be noticeable. Further studies on this subject are required in order to determine when the correction is desirable.

## Conclusion

In the first part of the article, we discussed two different ways of using the full ATLAS simulation to calibrate jets. The global method is proven to recover the linearity of the energy measurement while improving the resolution in a wide energy range on Monte Carlo samples. We proved its robustness over different quark content, shower model, and event complexity. The local hadron calibration has been shown to almost fully recover the linearity with respect to the jet calorimeter energy deposits. Even though a correction step to go back to the truth jet scale is missing, the method is promising. In the last part of the article, we discussed the possible use of the tracker information of the jet to improve the jet resolution. After the application of the global calibration, the method is able to further improve the jet energy resolution especially at low \(E_{T}\). Finally we discussed a possible way of recovering the neutrino energy in semileptonic \(b\)-quark decays.

The calibration methods discussed in this note will be used to provide jet corrections for the ATLAS detector. We stress that the validation of the corrections heavily relies on in-situ measurements as discussed in [20].

Figure 26: Response of semileptonic \(b\) jets before and after applying the neutrino correction to jets from a \(t\bar{t}\) sample (left) and a \(b\bar{b}\) sample (right).

## References

* [1] M.P. Casado and M. Cavalli Sforza, ATLAS note (1996), ATL-TILECAL-96-075.
* [2] ATLAS Collaboration, ATLAS Tile Calorimeter Technical Design Report, (CERN/LHCC/1996-42, Dec 1996).
* [3] T. Sjostrand, hep-ph/0108264 (2002).
* [4] A.Moraes and others, Eur. Phys. J. C **50** (2007) 435-466.
* [5] S.D.Ellis and D.E.Soper, Phys. Rev. **D48** (1993).
* [6] C.Roda and I.Vivarelli, ATLAS note (2005), ATL-PHYS-PUB-2005-019.
* [7] S.Frixione and B.R.Webber, JHEP 0206 (2002) 029 (2002).
* [8] Butterworth, J. M. and Forshaw, Jeffrey R. and Seymour, M. H., Z. Phys. **C72** (1996) 637-646.
* [9] The ATLAS Collaboration, Jet Reconstruction Performance, this volume.
* [10] The ATLAS Collaboration, Supersymmetry Searches, this volume.
* [11] V.Giangiobbe, Etude en Faisceau-Test de la Reponse des Calorimetres de l'experience ATLAS du LHC a des Pions Charges, d'Energie comprise entre 3 et 350 GeV, Ph.D. thesis, Clermont Ferrand, 2006.
* [12] P.Amaral, Nucl. Inst. and Meth. **A443** (2000) 51-70.
* [13] Abmowicz and Others, Nucl. Inst and Meth. **180** (1980) 429.
* [14] E.Hughes, SLAC-PUB-5404 (1990).
* [15] W. Lampl, S. Laplace, D. Lelas, P. Loch, H. Ma, S. Menke, S. Rajagopolan, D. Rousseau, S. Snyder, G. Unal, (2008), ATL-LARG-PUB-2008-002.
* [16] E. Bergeaas, T. Carli, K.-J. Grahn, C. Issever, K. Lohwasser, S. Menke, G. Pospelov, P. Schacht, F. Spano, P. Speckmayer, P. Stavina, P. Strizenec, (2008), ATL-COM-LARG-2008-006.
* [17] Agostinelli, S. and others, Nucl. Instrum. Meth. **A506** (2003) 250-303.
* [18] Allison, John and others, IEEE Trans. Nucl. Sci. **53** (2006) 270.
* [19] E.Bergeaas and others, ATLAS note (2007), ATL-CAL-PUB-2007-001.
* [20] The ATLAS Collaboration, Jet Energy Scale: In-situ Calibration Strategies, this volume.
* [21] The ATLAS Collaboration, Soft Muon \(b\)-Tagging, this volume.