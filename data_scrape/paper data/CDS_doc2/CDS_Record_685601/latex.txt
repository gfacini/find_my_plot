# \(\mu\)-Track Reconstruction in DATCHA

H. Dietl, V. Goriatchev, P. Hendriks, F. Linde, G. Massaro, G. Stavropoulos, M. Vreeswijk, M. Woudstra

Contact, e-mail address linde@cern.chDATCHA is the acronym for Demonstration of ATLAS CHamber Alignment.

31 January 1998

## 1 Introduction

The DATCHA setup at CERN became operational in the summer of 1997. The aim of this setup extends far beyond what is implied by the acronym DATCHA1. The real objective of DATCHA is to gain operating experience with a full size barrel section of the ATLAS muon spectrometer. Hence in DATCHA we experiment not only with Monitored Drift Tube (MDT) chambers and alignment monitors, but also with Resistive Plate Chambers (RPCs) and detector control systems.

Footnote 1: DATCHA is the acronym for Demonstration of ATLAS CHamber Alignment.

In this note we summarise the status of the \(\mu\)-track reconstruction for data taken in autumn 1997. Improvements are still expected hence this note should be read as a status report.

Figure 1: The DATCHA setup, located in the former UA1 cavern at CERN.

[MISSING_PAGE_EMPTY:2]

## Data

Figure 3: MDT read-out system.

## 2 DATCHA setup

The DATCHA setup, shown in figure 1 and figure 2, consists of three full size MDT chambers (BIL-BML-BOL), four RPC chamber layers and a scintillation hodoscope. The three MDT chambers together form one of the 96 large barrel towers of the ATLAS muon spectrometer.

The cosmic \(\mu\) trigger is derived from a coincidence between hits in an RPC layer mounted on top of the BOL chamber, an RPC layer located underneath 1.6 m of iron and 0.8 m of concrete situated below the BIL chamber, and the scintillation hodoscope mounted directly below the BIL chamber. The trigger rate for this configuration is about 5 Hz and hence we typically collect 200 k events overnight. The location along the wire at which the \(\mu\) traversed the MDT is obtained from the trigger chambers and an additional RPC near BIL.

The MDT front-end electronics, shown in figure 3, consists of a hedgehog preamplifier board (8\(\times\)4 = 32 channels), a thick copper-clad ground plate to minimise electromagnetic interference and a discriminator/multiplexer board with five outputs:

1. Four 'TDC' outputs; one for each layer, i.e. one for the logical OR of the eight adjacent channels within layers. For each output, the TDC does the time stamping for a maximum of eight leading and eight trailing edges.

Figure 4: The two curves give the variation with time of the RASNIK \(X\) (dashed) and RASNIK \(Y\) (solid) coordinates of one of the four in-plane RASNKs of the BIL chamber. The oscillations are due to day-to-night temperature fluctuations. It is evident from this figure that the intrinsic accuracy of a RASNIK system is about 2 \(\mu\)m. Bottom figure shows the thermal variations.

2. One 'address' output; this line keeps track of the correspondence between TDC hits and MDT channels. The setup can only keep track of a maximum of four addresses per TDC output (i.e. group of 8 channels).

The first type of output goes into a CAMAC Lecroy \(2277\)\(2\times 16\) channel TDC. The second type of output goes via two levels of handshaking (a DETCOM and an FBROC, respectively) into a CAMAC CAEN input-output register. Both CAMAC modules are read out into a VME crate, controlled by a FIC 8234 processor connected to a SUN workstation. The data is stored on disk in EPIO [1] format and copied to tape via CERN's central data recording (CDR) facility.

The MDT high-voltage (HV) is distributed on the far end of each tube. As for the front-end electronics also in this case \(4\times 8=32\) channel hedgehog cards are used. The HV is generated locally by Cockroft-Walton supplies mounted directly onto the chambers. Each MDT chamber has two Cockroft-Walton units, one for each multilayer. The Cockroft-Walton are controlled by CAN nodes which allow to ramp the HV up and down, to monitor the currents and voltages and to set limits outside which the HV is automatically switched off. We observed a long term stability of the HV at the chamber end of about \(\pm 2\) V. The leak currents in the BIL chamber are about 1 \(\mu\)A whereas the leak currents in the BML and BOL chambers range up to 25 \(\mu\)A.

Each MDT chamber has an internal in-plane alignment system to monitor chamber deformations. The corners of the three MDT chambers are inter-connected by projective

Figure 5: The temperature distribution along a tube in the BOL chamber is shown as a function of time. Day-to-night fluctuations are visible as well as the fact that the preamplifier side (sensor # 1) of a tube has a higher temperature than the HV side (sensor # 21).

alignment systems to monitor relative chamber displacements and rotations. The data-acquisition system of these alignment systems consists of a stand-alone Pentium PC with an on-board frame-grabber connected to a multiplexer crate to successively scan through all \(3\times 4=12\) in-plane RASNIKs and the four projective RASNIKs. Typically every ten minutes all 16 RASNIKs are read-out, their images are analysed and the results are stored for use in the offline analysis. An example of the stability of the alignment data is shown in figure 4. A preliminary comparison of RASNIK data and straight cosmic \(\mu\) tracks will be reported in this note (section 8). A detailed analysis will be given in reference [2].

To monitor temperature, magnetic field and other environmental parameters like humidity and pressure, a CAN node is installed onto the BML chamber. At this moment this CAN node is connected to \(3\times 30=90\) temperature sensors. Figure 5 shows the temperature profile of the BOL chamber as a function of time. The temperature sensors are numbered starting with 1 on the preamplifier side. Clearly the preamplifier side is warmer than the HV side. Day-to-night temperature fluctuations of about \(\pm 0.5^{o}\)C are visible. Early 1998 \(3\times 6=18\) magnetic Hall probes will be installed onto the chambers for prototype test reasons only. These sensors will be connected to a CAN node identical to the CAN node used for readout of the temperature sensors.

## 3 MDT operation in DATCHA

The three MDT chambers in the DATCHA setup are among the first MDT prototypes built. In comparison to the specifications listed in the muon spectrometer TDR [3], these chambers have several shortcomings.

Figure 6: MDT signal width distribution for the BIL and the BOL chamber. For normal \(\mu\) pulses the width can go up to the maximal drift time (\(\approx 1300\) ns); for noise hits (discharges) the width is very small. The front-end electronics enforces a minimal signal width of about 40 ns. (Horizontal scale in ns.)

1. The measured leak rates2 of the BIL (9\(\times\)10\({}^{-7}\) bar l/s per tube), BML (2\(\times\)10\({}^{-6}\) bar l/s per tube) and BOL (2\(\times\)10\({}^{-5}\) bar l/s per tube) chambers are (much) larger than the aimed for single tube leak rate of 10\({}^{-8}\) bar l/s. Footnote 2: The reasons are two-fold: for all three chambers the leaks in the gas distribution manifold are larger than foreseen. The BML and BOL chambers suffer in addition from leaks in the gas connectors mounted onto the tube ends and possibly from cracks in the potting used to electrically insulate the passive components mounted in the endplugs.
2. A sizeable fraction of the tubes in the BML and BOL chamber shows small discharges. This is evident from figure 6 which shows a large excess of hits with a duration of \(\leq\) 50 ns in the BOL chamber compared to the BIL chamber.

The original plan was to operate these chambers with a Ar/N\({}_{2}\)/CH\({}_{4}\)-91:4:5 gas mixture at 3 bar absolute. The HV would be 3270 V corresponding to a gas gain of \(\mathcal{G}\) = 2\(\times\)10\({}^{4}\) and

Figure 7: Gas gain and single electron response as a function of HV for various Ar/CO\({}_{2}\) mixtures. The solid triangles and circles are from a dedicated setup to measure the absolute gain and the streamer fraction as function of gas pressure, composition etc. [4]. The DATCH\({}_{4}\) data is obtained from the measured \({}^{55}\)Fe pulse heights scaled to the absolute measurements.

Figure 8: The TDC spectra for the BIL (a), BML (b) and BOL (c) chamber. The solid dots are for DATCHA data and the shaded histograms are for Monte Carlo simulation of DATCHA data.

the discriminator threshold should correspond to the arrival of the 22\({}^{nd}\) primary ionization electron. The defects in the BML and the BOL chamber and financial limitations led us to explore instead of (expensive) pre-mixed Ar/N\({}_{2}\)/CH\({}_{4}\)-91:4:5 cheap in-situ prepared mixtures of pure Ar and pure CO\({}_{2}\). Compared to the Ar/N\({}_{2}\)/CH\({}_{4}\)-91:4:5 mixture the disadvantages of Ar/CO\({}_{2}\) mixtures are: a much longer maximum drift-time and a non-linear \(r-t\) relation. The advantages are an excellent ageing behaviour, low cost and a superior spatial resolution.

Figure 7 shows the estimated dependence of the gas gain on the gas pressure and the HV for Ar/CO\({}_{2}\)-80:20 and Ar/CO\({}_{2}\)-90:10 gas mixtures. Based on these plots we selected the operating point detailed in table 1. The H\({}_{2}\)O admixture helps to reduce almost all discharge effects which were present in about 10% of the connected tubes in the BML and BOL chambers. Figure 8 shows the TDC spectra in the three DATCHA MDT chambers together with the result of a Monte Carlo simulation (see section 4).

The multiplexed electronics in conjunction with the fast shaping of the L3 preamplifiers (and the occurrence of discharges) compromizes DATCHA operation. This is because occasionally the first discriminator threshold transition is lost either because a genuine \(\mu\) signal fired the discriminator more than eight times (notably for trajectories passing near the anode wire) or because a discharge hit obscured the real \(\mu\) hit.

## 4 DATCHA event simulation

The simulation program for the DATCHA setup has been developed inside the ARVE framework [5], the official object oriented reconstruction and visualisation environment for ATLAS. Its features, as described below, enable it to produce Monte Carlo data suitable for verifying muon reconstruction, alignment reconstruction, auto-calibration algorithms, and \(t_{0}\), \(t_{\mbox{max}}\) determination algorithms.

### Detector description

The program implements the complete detector, i.e. MDTs, RPCs and hodoscope, in its nominal geometry. Also included is an outline of the material in the detector, consisting of:

\begin{table}
\begin{tabular}{c||c|c} Parameter & Value & Comments \\ \hline \hline Gas mixture & Ar/CO\({}_{2}\)-80:20 & mass flow meter calibration \\ H\({}_{2}\)O content & (0.1-0.3) \% & Ar temperature fluctuations \\ Pressure & 2 bar absolute & financial reasons \\ Renewal rate & \(\approx 1\) volume/day (0.093 l/s) & CO\({}_{2}\) mass flow meter \\ High Voltage & 3150 V & \({\cal G}\approx 4\times 10^{4}\) \\ Discriminator threshold & 60 mV & \# primary ionizations \(\approx 15\) \\ \end{tabular}
\end{table}
Table 1: MDT operation point at DATCHA.

* The \(400\:\mu\)m thick aluminium walls of the MDTs,
* The gas inside the MDTs (\(100\%\) Argon),
* The long beams of the MDT chambers,
* A crude approximation of the RPC support structure,
* The iron and concrete shielding.

The cross plates of the MDT chambers and the walls of the DATCHA cavern will be added to the list of materials to be taken into account in the simulation.

### Particle generation and interactions

As a particle source, a cosmic ray generator is used. It simulates cosmic ray muons in a \(\mu^{+}:\mu^{-}\) proportion of \(5:4\). As their origin, a uniform distribution in a plane above the detector is taken, while their angular distribution is proportional to \(\cos^{2}\theta\). The \(\mu\) momentum distribution is taken proportional to \(1/p^{2}\) in the \(3-100\) GeV range. The minimum of this range is based on the shielding present in the detector, the maximum on the electromagnetic interaction tables available for the materials.

The particle interactions are mostly handled by GISMO [5], the domain inside ARVE that defines the particle properties and material definitions. It provides the core simulation functionality. It implements multiple scattering and continuous energy loss in materials. In addition, the generation of \(\delta\)-rays is implemented such that the effect is in principle identical to the one provided by GEANT.

### Detector response

The program is capable of simulating a simplified response of the detector in that it can introduce global inefficiencies and noise for both the MDT and RPC chambers. These operations are however turned off by default. In contrast, a third effect, the smearing of the drift time of the MDTs, is applied automatically. It is based on a detector resolution with the following shape: starting from a specific value at the wire, it decreases linearly to a second value at \(5\:\)mm from the wire, after which it remains constant. The two values in question, which can of course be changed by the user, are currently set to \(150\:\mu\)m and \(80\:\mu\)m, respectively (compare figure 42d).

The next step in the digitization process consists of converting the drift distance to a time by inverting an \(r-t\) relation. This drift time is then corrected for the time needed by the signal to propagate along the MDT wire, and for the time of flight of the original particle to the hodoscope. In both cases the velocity is assumed to be the speed of light.

As a final step a check is made to see whether the simulated event satisfies the trigger. For this it is required that the top and bottom RPC as well as the hodoscope have at least one hit each. Note that this means that multiple hits in a chamber are allowed.

### Data output

The events are written to a file in a format, similar to data, which is recognized by MUTDAT [6]. In addition, special simulation banks with the true (generator level) information are created and stored. All banks can be read in by MUTDAT, which presents a transparent interface to the user independent of the data source.

In figure 9 a graphical output of a simulated event is shown. The materials of the setup are indicated as well as the drift distance information in the MDTs.

## 5 Track reconstruction

The \(\mu\) track reconstruction proceeds along three steps:

1. Within a single chamber, patterns are defined by a collection of hits consistent with a trail left by a passing \(\mu\), within a certain user defined distance.
2. Each pattern is subjected to a track fit and the patterns (track segments) which fail the \(\chi^{2}\) cut, defined by the user, are rejected.
3. Track segments in the BIL, BML and BOL chambers are combined into a 'global' track.

Figure 9: ARVE/GISMO simulation of a cosmic \(\mu\) traversing the DATCHA setup. A muon track is shown in four views in the left figure. In the right figure a close-up is shown of the \(\mu\) track and the \(\delta\)-ray generated in the bottom multilayer of the BOL chamber. This particular \(\delta\)-ray obscures two of the real muon hits and adds one spurious hit.

Figure 10: The track segments in the BIL, BML and BOL chambers are shown as well as the global track. The solid circles represent hits assigned to tracks. The open circles correspond to hits which could not be matched to tracks. Notice that in the BIL chamber one hit is missing. This might be due to a \(\delta\)-ray which at the same time could explain the two other hits observed in the BIL chamber. The numerical information shown in the figure includes for each track segment the tube identifiers, the measured drift times, the corresponding drift distances and the hit residuals. The overall event statistics i.e. run and event number, number of hits (22), number of track segments (3) and number of global tracks (1) are given at the bottom.

The details of these procedures are discussed in the following sections; a fully reconstructed DATCHA event is shown in figure 10.

### Pattern recognition

The pattern recognition starts with a pair of hits: one in the top multilayer and one in the bottom multilayer of a chamber. For this pair the four track ambiguities (assuming neither drift distance equals 0 mm) are determined (see figure 11a). These four ambiguities serve as seeds for pattern candidates: for each ambiguity all hits within 15 mm of the extrapolated trajectory are added to the list of hits for this ambiguity (this distance parameter can be modified by the user (appendix C)). Lists with at least four hits and a minimum of two hits in either multilayer are accepted as a pattern (this hit topology requirement can be modified by the user (appendix C)).

The procedure is repeated until the list of possible hit pairs is exhausted. At this stage duplications (real copies and proper subsets) are removed. On average about one pattern per chamber per event is found (excursions to more than ten patterns are observed in 0.1% of the events). Notice that multiple usage of hits is not explicitly excluded!

### Track fit

The track fitting algorithm is easiest to implement in a coordinate frame with the \(Z\) axis aligned with the track direction as illustrated in figure 11b. This is possible since for the first iteration the track parameters used to define the pattern (section 5.1) can be used as starting values of the fit.

Figure 11: (a) The pattern recognition algorithm: a pair of hits, one in either multilayer, is used to define track seeds. Only patterns with at least two hits in either multilayer are considered. (b) The track fit algorithm: the \(\chi^{2}\)-square defined as the sum of the weighted squares of the residuals is minimized iteratively. The fitting parameters are the infinitesimal rotation angle of the track, \(\epsilon\), and the vertical shift of the track, \(\delta\).

Figure 12: Distributions of (a) \(\chi^{2}\), (b) track angle uncertainty, (c) track position uncertainty, (d) correlation of the two fit parameters. All distributions are for the BIL chamber; points correspond to data and the shaded histograms to Monte Carlo simulation.

With the hits identified by the index \(i=1,2,...n\), the wire locations in the rotated coordinate frame \((z_{i}^{\prime},y_{i}^{\prime})\) and the drift distances \(r_{i}\) with corresponding uncertainties \(\sigma_{i}\) the \(\chi^{2}\) to be minimized can be written as the summation is over all hits along the track segment):

\[\chi^{2}\equiv\sum_{i=1}^{n}\frac{\Delta_{i}^{2}}{\sigma_{i}^{2}}=\sum_{i=1}^{ n}\frac{(y_{i}^{\prime}-z_{i}^{\prime}\tan\epsilon-\delta\pm r_{i})^{2}}{ \sigma_{i}^{2}}\times\cos^{2}\epsilon\]

Where the rotation angle \(\epsilon\) and the vertical shift \(\delta\) are the two fit parameters and \(\Delta_{i}\) is the residual of each hit. The \(\pm\) sign depends on whether at this stage of the fit \(|y_{i}^{\prime}-\delta-r_{i}|<|y_{i}^{\prime}-\delta+r_{i}|\) ('\(-\)' sign) or \(|y_{i}^{\prime}-\delta+r_{i}|<|y_{i}^{\prime}-\delta-r_{i}|\) ('\(+\)' sign). After linearization the \(\chi^{2}\) expression becomes:

\[\chi^{2}\approx\sum_{i=1}^{n}\frac{(y_{i}^{\prime}-\epsilon z_{i}^{\prime}- \delta\pm r_{i})^{2}}{\sigma_{i}^{2}}\times(1-\epsilon^{2})\approx\sum_{i=1}^{ n}\frac{(y_{i}^{\prime}-\epsilon z_{i}^{\prime}-\delta\pm r_{i})^{2}}{\sigma_{i}^{2}}- \epsilon^{2}\times\sum_{i=1}^{n}\frac{(y_{i}^{\prime}\pm r_{i})^{2}}{\sigma_{ i}^{2}}\]

This expression is easily minimized by solving the following set of linear equations:

\[\left\{\begin{array}{rcl}0\equiv\delta\chi^{2}/\delta\epsilon&=&-2\sum_{i=1 }^{n}(y_{i}^{\prime}-\epsilon z_{i}^{\prime}-\delta\pm r_{i})\times(z_{i}^{ \prime}/\sigma_{i}^{2})-2\sum_{i=1}^{n}(y_{i}^{\prime}\pm r_{i})^{2}\times( \epsilon/\sigma_{i}^{2})\\ 0\equiv\delta\chi^{2}/\delta\delta&=&-2\sum_{i=1}^{n}(y_{i}^{\prime}-\epsilon z _{i}^{\prime}-\delta\pm r_{i})\times(1/\sigma_{i}^{2})\end{array}\right.\]

The infinitesimal coordinate transformation parameters \(\epsilon\) and \(\delta\) become:

\[\left(\begin{array}{c}\epsilon\\ \delta\end{array}\right)=\left(\begin{array}{cc}\sum_{i=1}^{n}\left((z_{i}^ {\prime})^{2}-(y_{i}^{\prime}\pm r_{i})^{2}\right)/\sigma_{i}^{2}&\sum_{i=1}^ {n}z_{i}^{\prime}/\sigma_{i}^{2}\\ \sum_{i=1}^{n}z_{i}^{\prime}/\sigma_{i}^{2}&\sum_{i=1}^{n}1/\sigma_{i}^{2} \end{array}\right)^{-1}\times\left(\begin{array}{c}\sum_{i=1}^{n}z_{i}^{ \prime}\times(y_{i}^{\prime}\pm r_{i})/\sigma_{i}^{2}\\ \sum_{i=1}^{n}(y_{i}^{\prime}\pm r_{i})/\sigma_{i}^{2}\end{array}\right)\]

The errors on these two parameters and the correlation between them are taken from the covariance matrix.

The fitting procedure typically converges in 2-5 iterations. Figure 12 shows respectively the \(\chi^{2}\) divided by the number of degrees of freedom, the uncertainty on the determination of the track angle (mrad), the uncertainty on the location (\(\mu\)m) and the correlation between the two fit parameters (%). The results shown apply to an arbitrary sample of track segments in the BIL chamber. The larger uncertainties for Monte Carlo simulation are the combined effect of the on average larger number of hits on the tracks (figures 13b, 14b and 15b) and the poorer resolution (figures 41d and 42d).

#### 5.2.1 Single track segment results

The most interesting track segment parameters are shown in figures 13, 14 and 15 for the BIL, BML and BOL chambers, respectively. All distributions are only for the events which have valid trigger information (to be discussed in section 6.2.2).

For each chamber, figure (a) shows the distribution of the number of track segments found. The mean efficiencies are summarised in table 2. The relatively large inefficiencies in the BML and BOL chambers are to a large extend due to the regions with disconnected tubes. In this the Monte Carlo simulation deviates substantially from the data since the present Monte Carlo simulation assumes all tubes to operate in a perfect way. The simulation will be made more realistic once we know precisely which tubes to declare inoperational. Despite the occurrence of discharges in the BML and BOL chambers, the probability to find more than a single track segment in any chamber is small; less than 0.1%.

Figure 13: Track reconstruction in the BIL chamber. (a) Track multiplicity, (b) number of hits along a track, (c) radial coordinate of the hits on the tracks, (d) residuals of the hits on the tracks. The points correspond to data and the shaded histograms (when shown) to Monte Carlo simulation.

Figure 14: Track reconstruction in the BML chamber. (a) Track multiplicity, (b) number of hits along a track, (c) radial coordinate of the hits on the tracks, (d) residuals of the hits on the tracks. The points correspond to data and the shaded histograms (when shown) to Monte Carlo simulation.

Figure 15: Track reconstruction in the BOL chamber. (a) Track multiplicity, (b) number of hits along a track, (c) radial coordinate of the hits on the tracks, (d) residuals of the hits on the tracks. The points correspond to data and the shaded histograms (when shown) to Monte Carlo simulation.

Figures (b) show the distribution of the number of hits along the track segments. The average number of hits are summarised in table 2. Again the Monte Carlo figures are better than the DATCHA results. Nevertheless, both for Monte Carlo simulation and DATCHA data, the typical number of hits along a track segment exceeds the minimum (four) required. The relatively large number of hits on the BOL segments is of course due to the fact that the DATCHA BOL chamber (in contrast to the baseline ATLAS BOL chamber) has \(2\times 4\) layers whereas the BML and BIL chambers have \(2\times 3\) layers (hopefully also different from the final ATLAS BML and BIL chambers!).

The distribution of the drift distances for the hits on the track segments is shown in figures (c). For Monte Carlo simulation these distributions are uniform up to drift distances of 14 mm. This in agreement with the fact that the MDTs are illuminated isotropically and the expected effects of \(\delta\)-ray electrons. For DATCHA data the distribution is less uniform. In particular the onset of the efficiency drop starts already around 12.5 mm (see section 7.1.1).

Figures (d) show the residual distributions. All hits along all track segments found are used. The r.m.s. residuals are listed in table 2. These r.m.s. residuals can not be converted simply into a resolution since the hits are used in the fit. We are working on a proper procedure to extract the resolution. We would like to avoid to resort to the simple algorithm in which each hit in succession is dropped from the fit in order to use its residual as an unbiased resolution estimator. In the absence of a proper procedure we can only state that for Monte Carlo simulation the r.m.s. residuals almost reproduce the input single tube resolution (see section 4.3 and figure 42d). See section 7.2.1 as well!

### Global track selection

For the analysis as described in the present note the results of the various alignment monitors are not used at the track reconstruction level and hence possible chamber deformations and the relative locations of the BIL, BML and BOL chambers remain unknown. Therefore the track direction is the only reasonable parameter according to which track segments in the BIL, BML and BOL chambers can be combined into a global track. For now we only impose a loose cut on the r.m.s. of the three angles of 10 mrad (user settable; see appendix C). This distribution is shown in figure 16a for Monte Carlo simulation and DATCHA data. Figure 16b shows the number of global tracks found in Monte Carlo simulation and data. Figures 17(a-c) show in which regions (\(Z\) direction only) of the BIL, BML and BOL chambers we find the global tracks. The mismatch between data and

\begin{table}
\begin{tabular}{c||c|c|c||c|c|c}  & \multicolumn{2}{c||}{DATCHA data} & \multicolumn{2}{c}{Monte Carlo simulation} \\ \cline{2-7} Chamber & \# tracks & \# hits & r.m.s. residual & \# tracks & \# hits & r.m.s. residual \\ \hline \hline BIL & 0.63 & 5.5 & 63 \(\mu\)m & 0.80 & 6.4 & 82 \(\mu\)m \\ \hline BML & 0.46 & 5.1 & 64 \(\mu\)m & 0.97 & 6.5 & 82 \(\mu\)m \\ \hline BOL & 0.51 & 6.5 & 78 \(\mu\)m & 1.00 & 8.4 & 90 \(\mu\)m \\ \end{tabular}
\end{table}
Table 2: Summary of track segment results found for the BIL, BML and BOL chambers. The column labelled \# tracks gives the mean number of tracks per event and the column labelled \# hits gives the mean number of hits along a track.

Monte Carlo simulation in these figures is to a large extend due to the disconnected tubes in the BML and BOL chambers. Figure 17d shows the polar angle distribution of the global tracks; both data and Monte Carlo simulation yield \(117^{0}\pm 3^{o}\).

On data, in about 16% of the events we reconstruct one unambiguous complete muon track. Events with ambiguous complete muon tracks are rare. The low global efficiency level is due to the almost uncorrelated inefficiencies in the BML and BOL chambers (54% and 49% respectively i.e. almost a reduction factor four). The BIL inefficiency is about 25%; a large part of which is a geometrical effect since the muons which pass the BIL chamber edges can not fullfill the hit topology requirements. The stringent cuts placed on the trigger chamber response (see section 6.2.2) reduces the global efficiency by another 40%. These effects together account for the observed reduction factor six.

## 6 Calibration constants

Track reconstruction within the DATCHA setup requires precise knowledge of:

1. The relative locations of the BIL, BML and BOL chambers,
2. The relative locations of all wires within a single chamber,
3. The relative timing between all channels i.e. \(t_{0}\) and \(t_{\mbox{max}}\) values,

Figure 16: (a) R.m.s. of the track angles (rad) measured in the BIL, BML and BOL chambers. (b) The number of global tracks reconstructed in each event. In both figures the points are for data and the shaded histograms are the result of a Monte Carlo simulation.

Figure 17: In figures (a-c) the distribution of the \(Z\) coordinate (mm) in the BIL, BML and BOL chambers is shown for all global tracks (points for the data and shaded histograms for the Monte Carlo simulation). The significant mismatch between data and Monte Carlo simulation is due to the disconnected tubes in BML and BOL. In figure (d) the polar angular distribution is shown of the global tracks. This angle is defined w.r.t. the horizontal plane. I.e. the mean polar angle of \(117^{0}\pm 3^{o}\) corresponds to \(27^{0}\pm 3^{o}\) w.r.t. the vertical.

4. The relation(s) between the measured drift times and the required drift distances.

The last three requirements will be dealt with in the sections below. The first requirement will be the topic of a separate note in which we will make a comparison between the relative alignment of the three DATCHA chambers derived from straight cosmic \(\mu\) tracks and the measurements of the projective alignment system [2]. In this note we only present a global comparison of straight \(\mu\)-track data and RASNIK data (section 8).

### Chamber geometry

For each chamber the design values for the wire spacings are used. The relevant values (including the wire tension which enters in the calculation of the gravitational sag) are listed in table 3. The staggering indicates how the layers are shifted w.r.t. to the bottom (\(1^{\mathrm{st}}\)) layer, i.e. '\(+n\)' means shifted by \(+\frac{n}{2}Z_{\mbox{pitch}}\) and '\(-n\)' means shifted by \(-\frac{n}{2}Z_{\mbox{pitch}}\). In addition the \(2^{\mbox{nd}}\) layer of the BML chamber (i.e. middle layer of the bottom multilayer) is shifted3 by an additional \(+80\,\mu\)m.

Footnote 3: This shift serves a dual purpose: (1) it allows an alternative auto-calibration method and (2) it resolves track ambiguities already on the multilayer level. Both await verification on data!

Since most results presented in this note only depend on the local geometry within a chamber (i.e. the relative wire locations in the region traversed by the \(\mu\)-track being reconstructed), we performed no corrections for the gravitational sag of the wires and chamber deformations. Both of these corrections rely heavily on the measurements of the in-plane alignment systems and will be dealt with in a separate note [2].

### \(t_{0}\) and \(t_{\mbox{max}}\) values

For each cosmic \(\mu\), the measured drift time depends not only on the distance of the \(\mu\)-track to the tube's wire, but also on:

1. The response of the scintillator hodoscope,

\begin{table}
\begin{tabular}{c||c|c|c} Parameter & BLL & BML & BOL \\ \hline \hline Layout & \(2\times 3\times 32=192\) & \(2\times 3\times 48=288\) & \(2\times 4\times 72=576\) \\ \(Z_{\mbox{pitch}}\) & 30.100 mm & 30.050 mm & 30.075 mm \\ \(Y_{\mbox{pitch}}\) & 26.067 mm & 26.024 mm & 26.046 mm \\ Staggering & 0, \(-1\), 0 / 0, \(-1\), 0 & 0, \(+1\), 0 / 0, \(+1\), 0 & 0, \(+1\), \(+2\), \(+3\) / \(+3\), \(+4\), \(+5\), \(+6\) \\ Spacer height & 150.000 mm & 250.000 mm & 350.000 mm \\ Tube length & 2500 mm & 4 000 mm & 5700 mm \\ Wire tension & 250 g & 300 g & 250 g \\ \end{tabular}
\end{table}
Table 3: Geometrical specifications (including wire tension) of DATCHA chambers.

2. The front-end electronics characteristics (preamplifier rise time, shaping time constant, discriminator threshold, TDC parameters and the length of conductor between tube end and TDC input),
3. The signal propagation time along the wire of the tube,
4. The time-of-flight of the cosmic \(\mu\).

We use the scintillator hodoscope time as a reference. Separate studies have shown that this reference determines the time of a traversing \(\mu\) with 1 ns resolution and systematic variations smaller than \(\pm 0.5\) ns over its entire surface (this corresponds approximately to a 20 \(\mu\)m contribution to the single tube resolution). The drift time corrections due to the other three contributions are discussed in the sections below. The \(t_{\mbox{max}}\) determination is required because we want to use a common \(r-t\) relation for groups of tubes; this requires minimally a common \(t_{\mbox{max}}\) for those tubes; either by nature or else by brute force (see section 6.2.4).

#### 6.2.1 \(\mu\) time-of-flight

The \(\mu\) time-of-flight is shown schematically in figure 18a. The actual time-of-flight depends on the angles of the \(\mu\)'s trajectory and hence can not be accounted for by an overall constant. In principle the time-of-flight correction requires complete reconstruction of the \(\mu\) trajectory. This would preclude a correction at the level of hit validation. To overcome this we neglect the small variation (\(\pm 3^{\circ}\)) of a \(\mu\)'s track angle in the \(YZ\) plane and simply use the average angle of 117\({}^{\circ}\) of the DATCHA setup to calculate the time-of-flight correction on a hit-by-hit basis. Combined with the \(X\) information detailed in section 6.2.2 and the \(Y,Z\) locations of the tube hit we calculate the distance between

Figure 18: (a) schematic explanation of cosmic \(\mu\) time-of-flight delay and (b) schematic explanation of signal propagation delay.

Figure 19: Measured (data points) and simulated (shaded histograms) corrections for the time-of-flight of cosmic \(\mu\) signals in the BIL (a), BML (b) and BOL (c) chambers. The three bottom figures (d) give the reconstructed versus the generated time-of-flight for Monte Carlo simulation for the BIL, BML and BOL chambers.

Figure 20: Measured (data points) and simulated (shaded histograms) signal propagation delay correction for the BIL (a), BML (b) and BOL (c) chambers. The three bottom figures (d) give the reconstructed versus the generated propagation delay for Monte Carlo simulation for the BIL, BML and BOL chambers.

the scintillation hodoscope and the point at which the \(\mu\) trajectory passes the tube. The time-of-flight is simply this distance divided by the \(\mu\) velocity for which we take the speed of light.

In figure 19 this correction is shown for the BIL, BML and BOL chambers. The shaded histograms correspond to a Monte Carlo simulation and the data points are obtained from the DATCHA setup. The double peak structure in the BIL distribution corresponds to the two multilayers; for the BML and BOL chambers the two multilayers can not be resolved due to larger time-of-flight variations. The r.m.s. accuracy of this correction is better than 0.5 ns. This from Monte Carlo simulation (see figure 19d) and from an estimate of uncertainty in the assumptions made.

#### 6.2.2 Signal propagation delays

The signal propagation delay is shown schematically in figure 18b. This delay depends on the distance between the preamplifier end of the tube and the point at which the \(\mu\) passes the tube. The correction is made using both the information from the three RPC layers with \(X\) segmentation (31 mm pitch) and the information from the two layers of scintillators (overlapping 20 cm wide strips) of the hodoscope. Together these detectors yield a \(\leq 4\) cm accurate measurement of the \(X\) coordinate all along the trajectory of a cosmic \(\mu\). To reach this precision we must limit the analysis to those events with unambiguous hits in the scintillator hodoscope (\(\approx 85\%\) efficiency) and a continuous sequence of strips hit in at least two of the three RPC chambers with \(X\) strips (\(\approx 95\%\) efficiency). In addition we require a match between the \(X\) coordinate found in the hodoscope and the \(X\) coordinate extracted from the RPC chambers. This latter requirement reduced the data sample by a not yet fully understood additional 20%. This brings the total efficiency for a clean trigger condition down to 60%.

The measured \(X\) coordinate is converted into a time delay under the assumption that the signal travels at the speed of light. This delay is subtracted from the measured drift time in the routine which validates the hits.

In figure 20 this correction is shown for the BIL, BML and BOL chambers. The shaded histograms correspond to a Monte Carlo simulation and the data points are obtained from the DATCHA setup. The excess of data events in the central region is most likely due to an incomplete modelling of the concrete walls of the DATCHA pit. Apart from the assumption on the signal propagation speed4, the r.m.s. accuracy of the signal propagation delay correction is better than 0.5 ns as obtained from Monte Carlo simulation (see figure 20d). The signal propagation speed will be measured in february 1998, for now we expect the error to be at most 10% which corresponds to a maximum systematic error of 0.9 ns for BIL, 1.3 ns for BML and 1.9 ns for BOL.

Footnote 4: A first measurement on so called ‘twin tubes’ shows 3.5 ns/m i.e. almost 10% below the speed of light.

#### 6.2.3 Leading edge

After the corrections for signal propagation delay and \(\mu\) time-of-flight, the determination of the \(t_{0}\) value is straightforward. We opted for the following parametrisation of the leading edge of a TDC spectrum [7]:

\[\mathcal{L}(t)=\alpha_{1}+\frac{\alpha_{2}}{1+\exp\frac{\alpha_{3}-t}{\alpha_{4}} }\times\frac{\left[\alpha_{5}+\frac{1}{1+\exp\frac{\alpha_{5}}{\alpha_{6}}} \right]}{\left[\alpha_{5}+1\right]}\quad\left\{\begin{array}{rcl}t\ll\alpha_ {3}&\rightarrow&\alpha_{1}\\ t\approx\alpha_{3}&\rightarrow&\alpha_{1}+\frac{1}{2}\alpha_{2}\\ t\gg\alpha_{3}&\rightarrow&\alpha_{1}+\alpha_{2}\times\frac{\alpha_{5}}{ \alpha_{5}+1}\end{array}\right.\]

We use this parametrisation to perform a binned likelihood fit to all the individual TDC spectra in the \(-50\) ns \(<t<+100\) ns interval. We use two iterations. In the first iteration all six parameters are left free. In the second iteration we fix the slope parameters, \(\alpha_{4}\) and \(\alpha_{6}\), and the plateau parameter, \(\alpha_{5}\), to their average value (calculated for each layer separately). For each channel the value of \(t_{0}\) is defined to be that \(t\) value at which \(\mathcal{L}(t)\) reaches \(50\%\) of its maximum value. Two representative fits are shown in figure 21. Typical values of the main parameters are listed in table 4.

Figure 22 shows the \(t_{0}\) values found for all the life channels in the three DATCHA chambers. For the BIL and the BML chambers we expect the \(t_{0}\) values to be fairly identical since the cable lengths between front-end electronics and the TDCs should have been all identical. Apparently this is not completely true, as is evident from the two groups of \(t_{0}\) values which differ by 10 ns i.e. a few meter. This will be checked against the actual length of the cables used. Apart from this mystery, the residual channel-to-channel variations for the three layers within a multilayer are remarkable similar. This indicates that these variations are probably real and somehow related to the routing of the traces on the front-end boards. For the BOL chamber cables of varying length were used on purpose to avoid excess cable length. This explains the observed gradual overall increase

Figure 21: Determination of \(t_{0}\) value for two arbitrary channels. The data is represented by the dots and the fit by the grey area. (a) BIL and (b) BOL tube.

Figure 22: The signal leading edge of all channels in the DATCHA chambers after correction for time-of-flight and signal propagation delay. The horizontal scale gives the sequential tu be number in each chamber (32, 48 and 72 tubes per layer i.e. \(1-96\), \(1-144\) and \(1-288\) are the tubes in the bottom multilayer of the BIL, BML and BOL chambers, respectively). The vertical scale gives the \(t_{0}\) in ns.

of the \(t_{0}\) values within each layer for this chamber. Also for this chamber the fine structure shown in BIL and BOL is the same for the various layers.

#### 6.2.4 Trailing edge

After the corrections for signal propagation delay and \(\mu\) time-of-flight, the determination of the \(t_{\mbox{max}}\) value is straightforward. We opted for the following parametrisation of the trailing edge of a TDC spectrum [7]:

\[{\cal T}(t)=\alpha_{1}+\frac{\alpha_{2}}{1+\exp\frac{t-\alpha_{1}}{\alpha_{i}} }\times\frac{\left[\alpha_{5}+\frac{1}{1+\exp\frac{\alpha_{3}-t}{\alpha_{6}}} \right]}{[\alpha_{5}+1]}\quad\left\{\begin{array}{rcl}t\ll\alpha_{3}&\to& \alpha_{1}+\alpha_{2}\times\frac{\alpha_{3}}{\alpha\,s+1}\\ t\approx\alpha_{3}&\to&\alpha_{1}+\frac{1}{2}\alpha_{2}\\ t\gg\alpha_{3}&\to&\alpha_{1}\end{array}\right.\]

We use this parametrisation to perform a likelihood fit to all the individual TDC spectra in the \(1000\,\mbox{ns}<t<+1500\,\mbox{ns}\) interval. We use two iterations. In the first iteration all six parameters are left free. In the second iteration we fix the slope parameter, \(\alpha_{6}\), and the plateau parameter, \(\alpha_{5}\), to their average value (calculated for each layer separately). For each channel the value of \(t_{\mbox{max}}\) is defined to be that \(t\) value at which \({\cal T}(t)\) reaches 50% of its maximum value. Two representative fits are shown in figure 23. Typical values of the main parameters are listed in table 4.

Figure 24 shows the results for all channels. For dead channels and for channels with insufficient statistics we put \(t_{\mbox{max}}\) equal to the mean \(t_{\mbox{max}}\) of the appropriate tube layer (\(\overline{t_{\mbox{max}}}\)). Interesting effects are apparent in this figure. E.g. the systematic difference in the maximal drift time between the tubes of the two multilayers in the BIL chamber

Figure 23: Determination of \(t_{\mbox{max}}\) value for two arbitrary channels. The data is represented by the dots and the fit by the grey area. (a) BIL and (b) BOL tube.

Figure 24: The signal trailing edge of all channels in the DATCHA chambers after correction for time-of-flight and signal propagation delay. The horizontal scale gives the sequential tu be number in each chamber (32, 48 and 72 tubes per layer i.e. \(1-96\), \(1-144\) and \(1-288\) are the tubes in the bottom multilayer of the BIL, BML and BOL chambers, respectively). The vertical scale gives the \(t_{\max}\) in ns.

of about 5 ns. This could be attributed to the gas composition since this is controlled per multilayer. For the other two chambers the structure is more erratic; this is almost certainly due to the poor behaviour of many tubes in the BML and BOL chambers. This requires further investigation; for this analysis we kept each \(t_{\mbox{max}}\) to within \(\pm 10\) ns of the appropriate \(\overline{t_{\mbox{max}}}\). Moreover, for this analysis we compensated for the \(t_{\mbox{max}}\) variations by rescaling all spectra to the common \(\overline{t_{\mbox{max}}}\). Even though this procedure is questionable (in particular in view of \(t_{\mbox{max}}\) changes due to out of centre positioned anode wires) we assume that after this rescaling we can use a common \(r-t\) relation for groups of tubes (see section 6.3).

#### 6.2.5 Precision

For all MDT channels in the DATCHA setup the background in the TDC spectra is negligible. This is primarily because we only allow entries into the TDC spectra for hits which can be associated to a track segment i.e. we do not allow isolated hits in these spectra. Consequently, the precision of the leading and trailing edge calculation depends in addition to the event statistics only on the value of the slope parameter \(\alpha_{4}\). For a realistic data sample of 200 k events, we find typically 850 (BIL), 650 (BML) and 500 (BOL) events in the range used for the leading edge and 2500 (BIL), 2000 (BML) and 1500 (BOL) events in the range used for the trailing edge. This yields the precisions on \(t_{0}\) and \(t_{\mbox{max}}\) as listed in table 4. For larger or smaller data samples (\(N_{\mbox{events}}\)) the given uncertainties can be scaled according to \(1/\sqrt{N_{\mbox{events}}}\). The analysis of 200 k Monte Carlo events gave a leading edge uncertainty (BIL) of about 0.2 ns (\(\alpha_{4}\approx 0.5\) ns and 2000 events in the fit region) and a trailing edge uncertainty (BIL) of about 0.3 ns (\(\alpha_{4}\approx 0.5\) ns and 6000 events in the fit region). The poor agreement between data and simulation for the trailing edge is due to the simplistic modelling of the trailing edge in the Monte Carlo simulation (all trailing edges are set equal to the maximal drift time of about 1190 ns). For the leading edge Monte Carlo simulation and data are in reasonable agreement after taking into account the factor three difference in statistics.

### \(r-t\) relation

In the past the determination of the \(r-t\) relation was performed on a per multilayer basis i.e. track segments within a single multilayer were used to gradually find the optimal \(r-t\) relation for the tubes concerned. This approach, at least for multilayers with only three

\begin{table}
\begin{tabular}{c||c|c|c|c||c|c|c}  & \multicolumn{4}{c||}{Leading edge} & \multicolumn{4}{c}{Trailing edge} \\ \cline{2-9} Chamber & \(\alpha_{4}\) & \(\alpha_{6}\) & \(\alpha_{5}\) & \(\Delta t_{0}\) & \(\alpha_{4}\) & \(\alpha_{6}\) & \(\alpha_{5}\) & \(\Delta t_{\mbox{max}}\) \\ \hline \hline BIL & 1.5 ns & 35 ns & 0.1 & \(\pm 0.5\) ns & 12.0 ns & 70 ns & 0.1 & \(\pm 2.4\) ns \\ BML & 1.5 ns & 35 ns & 0.1 & \(\pm 0.6\) ns & 14.0 ns & 140 ns & 0.1 & \(\pm 3.1\) ns \\ BOL & 1.6 ns & 35 ns & 0.1 & \(\pm 0.7\) ns & 18.0 ns & 160 ns & 0.1 & \(\pm 4.6\) ns \\ \end{tabular}
\end{table}
Table 4: Fitted values of the main parameters used in the parametrisations of the leading and trailing edges of the TDC spectra.

layers of tubes, requires a minimal angular spread of the track sample of about \(6^{o}\) (see chapter 5 in reference [3]). Moreover with only three layers (BIL and BML) and in the presence of dead tubes (BML and BOL) this method becomes questionable.

For the analysis of the DATCHA data we decided to perform the \(r-t\) calibration based on track segments on a per chamber basis. This because the angular spread of the DATCHA track sample is small, \(117^{o}\pm 3^{o}\) see figure 17d, and because in some regions of the BML and BOL chambers several groups of eight tubes had to be disconnected from the HV to keep the leakage current down to acceptable levels (\(<25\;\mu\)A per multilayer).

#### 6.3.1 Algorithm

The \(r-t\) relation is determined in an iterative approach. With a given zeroth order \(r-t\) relation track segments are reconstructed in each of the three DATCHA chambers along the lines outlined in section 5. Subsequently we determine the average drift time in bins of the predicted (as opposed to the measured) drift distance.

The actual implementation5 employs 100 equidistant bins in \(r\) between \(r=0\;\)mm and \(r=15\;\)mm. The binning in \(r\) has two major advantages:

Footnote 5: With hindsight it would have been adequate to use less bins, e.g. 30. This would speed up the convergence, render smoothing unnecessary and make the \(r-t\) interpolation routine faster.

1. Similar statistics in each bin, provided the tubes are illuminated uniformly; independent of the exact shape of the \(r-t\) relation. I.e. the latter can be (and will be for most Ar/CO\({}_{2}\) gas mixtures) highly non-linear,
2. Independent of the overall \(t_{0}\) and \(t_{\mbox{max}}\) values since both of these are an (irrelevant) output of the \(r-t\) calibration procedure. Of course the tube-to-tube variations (\(t_{0}\) and \(t_{\mbox{max}}\)) have to be taken into account at least for those tubes (or tube regions) for which a common \(r-t\) relation is assumed.

To reduce the effects of spurious hits (notably \(\delta\)-ray induced hits) we apply stringent cuts on the hits along a track before we use them in the determination of the average drift time value for a certain \(r\) bin. The most important condition is that we only use those hits which have a residual of less than five times the local resolution. In addition we require at least five hits (as opposed to the default four hits) on a track segments and we optionally can exclude those segments for which all drift distances are similar and/or those segments for which all hits are located on the left (or the right) side of the track.

The segmentation of the \(r-t\) relations, i.e. across how large a region can we manage with a single \(r-t\) relation, has not been investigated in all detail. Instead we explored several segmentations:

1. One \(r-t\) relation for each chamber type i.e. three independent \(r-t\) relations,
2. One \(r-t\) relation per tube layer (six \(r-t\) relations for BIL and BML and eight \(r-t\) relations for BOL) i.e. twenty independent \(r-t\) relations,
3. One \(r-t\) for the preamplifier section, central section and HV section of each chamber i.e. nine independent \(r-t\) relations,Figure 25: \(r-t\) relations for the BIL (a), BML (b) and BOL (c) chamber. Figure (d) shows all three \(r-t\) relations together. The maximal drift time, about 1300 ns, can be read off from these plots. These plots also show that the absolute values (even though irrelevant) of the \(t_{0}\)’s are accurate since all curves start out near the (\(t=0,r=0\)) point. Finally the non-linearity of the Ar/CO\({}_{2}\)-80:20 gas mixture is evident from these curves.

4. One \(r-t\) relation for each tube i.e. in principle \(192+288+576=1056\) independent \(r-t\) relations in total; in practice a few hundred less due to the disconnected tubes and geometrical reasons.

Even though the last possibility has really been implemented, we will not comment on it in this note since it is neither practical nor precise due to the lack of statistics. It also raises severe worries regarding its numerical stability.

For the other three possibilities, the analysis of typically 10-50 k events yield an \(r-t\) relation which can be used as input for the next iteration. For most data sets (Monte Carlo simulation and data alike) we performed 3-5 iterations in order to have stable \(r-t\) relations. As a last step statistical fluctuations are removed by a smoothing procedure which at the same time forces each \(r-t\) relation to be monotonously increasing. The results will be discussed in the next section. Typical \(r-t\) relations for the BIL, BML and BOL chamber are shown in figure 25. As expected, this figure clearly shows that the Ar/CO\({}_{2}\)-80:20 gas mixture has a non-linearity \(r-t\) relation.

#### 6.3.2 Precision

The ultimate measure is the single tube resolution or, apart from a scale factor which depends on the average number of hits along the track segments, the r.m.s. of the hit residuals. The latter are shown in figures 13, 14 and 15 for the BIL, BML and BOL chambers, respectively. The r.m.s. residuals of 63 \(\mu\)m for BIL, 64 \(\mu\)m for BML and 78 \(\mu\)m for BOL (table 2) range from good to reasonable (see also figures 41 and 42). These results are obtained using a single \(r-t\) relation for each tube layer, i.e. the second possibility in the list above.

The real measures, i.e. figures of merits of the \(r-t\) algorithm and the chamber quality, are of course threefold:

1. How similar are the various (a priori identical) \(r-t\) relations? Figure 26 shows the \(r-t\) relations obtained for the tube layers (solid/dashed lines for those in the top/bottom multilayer) in the BIL, BML and BOL chambers. Each curve is relative to a common average \(r-t\) relation. The average \(r-t\) relation is the mean of the \(r-t\) relations found for the BIL, BML and BOL chambers. I.e. this plot allows not only the comparison of the \(r-t\) relations for a single chamber but also the comparison of the \(r-t\) relations for different chambers. Similarly figure 27 shows the \(r-t\) relations obtained for the three regions (solid, dashed and dotted for preamplifier, central and HV region, respectively) in the BIL, BML and BOL chambers. Again each curve is relative to the same average \(r-t\) relation as used in figure 26. These figures show variations between the various \(r-t\) relations of up to \(\pm 50\)\(\mu\)m. The (large) oscillations in \(t>1150\) ns region should be ignored since these large drift times correspond to drift distances close to the inner tube wall (\(r>14.0\) mm). In this region the average \(t\) value for a particular \(r\) bin is biased since the \(r-t\) assignment routine limits the \(r\) values to 14.6 mm which implies that for a resolution of \(100-200\)\(\mu\)m one starts to cut into the distribution for \(r>14.0\) mm. In such Figure 26: \(r-t\) relations for the various layers in the BIL (a), BML (b) and BOL (c) chamber. These distributions are shown w.r.t. a common average \(r-t\) relation as defined in the text. Solid (dashed) lines for bottom (top) multilayer.

Figure 27: \(r-t\) relations for the various regions: preamplifier (solid), central (dashed) and HV (dotted) in the BIL (a), BML (b) and BOL (c) chamber. These distributions are shown w.r.t. a common average \(r-t\) relation as defined in the text.

Figure 28: \(r-t\) relations for all the (life) tubes in the BIL chamber (a) and for all the (life) tubes in the BOL chamber (b). The BML results resemble the BOL results. From this figure it is evident that almost all BIL tubes behave similarly as far as their \(r-t\) relation are concerned. For the BOL (and the BML) tubes the scatter between the \(r-t\) relations of different tubes is larger and in addition some tubes have a very different \(r-t\) relation.

a situation a simple averaging of all \(t\) values corresponding to a particular \(r\) bin is inadequate (see section 6.4). The real issue is whether or not the observed differences are real i.e. due to tube-to-tube differences or an art-effect of the used algorithm. At this preliminary stage of the analysis we can not be conclusive on this issue. However, we can conclude from figure 26 that the \(r-t\) relation variations within a single multilayer are typically a factor two smaller (\(\leq\pm 25\;\mu\)m) than \(r-t\) relation variations between multilayers. This is probably a real effect; either the result of gas composition or flow differences between the multilayers (each multilayer has its own gas input and exhaust line) or due to the \(\mu\) time of flight correction. From figure 27 we can conclude that variations in the \(r-t\) relations between different regions of the same set of tubes (preamplifier, central locator and HV) are much smaller (\(\leq\pm 10\;\mu\)m). This also makes it plausible that there are real differences in the operation of the tubes. This is not surprising since we know that some tubes have discharges; that not all tubes have the same gas flow; that some tubes are very leaky; that some tubes have wires positioned outside our tolerances; etc. All these effects can easily explain variations between the average \(r-t\) relation for one batch of tubes and that of another batch of tubes. This hypothesis is consistent with the fact that the variations observed in the (good) BIL chamber are significantly smaller (\(\leq\pm 10\;\mu\)m) than those observed in the (worse) BML and BOL chambers (\(\leq\pm 50\;\mu\)m); good/worse refers to gas leaks and the occurrence of discharges. This is also consistent with figure 28 which shows for each individual tube in the BIL and the BOL chamber its \(r-t\) relation. Of course another reason could simply be that the BIL tubes are much shorter than the BML and BOL tubes (but in this the real measure is probably the distance between wire supports and with that metric the BML chamber with only 2.0 m in between wire supports is the smallest; BOL has 2.8 m in between wire supports and BIL 2.5 m i.e. in fact all three chambers are fairly similar in this metric).
2. How stable are the \(r-t\) relations in time i.e. from run-to-run? Figure 29 shows a comparison between the same \(r-t\) relation in the BIL, BML and BOL chamber for various runs. The typically time interval between the runs was one day. The largest variations occur at large drift distances. This is correlated with the changes observed in \(t_{\mbox{max}}\). The origin of both effects is due to the varying H\({}_{2}\)O content due to the temperature fluctuations of the Argon (see also table 5).
3. How well do the \(r-t\) relations agree with the real \(r-t\) relation? For data this question can only be answered with the help of an independent tracking system like a silicon beam telescope. The DATCHA setup does not have such a device. For Monte Carlo simulation: the input \(r-t\) relation is known; all wire locations are equal to those listen in table 3; and any of the real life tube operation imperfections are absent. The only corrections which are common to data and Monte Carlo simulation are the \(\mu\) time of flight correction (section 6.2.1) and the signal propagation delay correction (section 6.2.2) and even those are a priori known on Monte Carlo simulation (see figures 19d and 20d). Hence for Monte Carlo we can compare the Figure 29: Changes in time of a particular \(r-t\) relation in the (a) BIL, (b) BML and (c) BOL chamber. Time intervals between successive calibrations are typically one day. The solid curves are for runs with a stable dewpoint of \(-6\) C\({}^{o}\). The dotted curves are from runs with varying dewpoints and also from a run taken one month before the other runs. This explains the rather large changes in the \(r-t\) relations for the dotted curves.

Figure 30: \(r-t\) relations from Monte Carlo simulation for the various layers in the BIL (a), BML (b) and BOL (c) chamber. These distributions are shown w.r.t. a common average \(r-t\) relation as defined in the text.

Figure 31: \(r\!-\!t\) relations from Monte Carlo simulation for all the tu bes in the BIL chamber (a) and for all the tu bes in the BOL chamber (b). Only tu bes with sufficient statistics are shown.

Figure 32: Comparison between the input \(r\) values and the reconstructed \(r\) values for the BIL (a-b) and the BOL (c-d) chambers. The left figures show the difference as a function of the Monte Carlo generated drift distance. The right figures show just the differences.

various reconstructed \(r-t\) relations amongst themselves and we can compare them with the input \(r-t\) relation. Figure 30 and 31 show the Monte Carlo equivalent of figures 26 and 28. The observed variations are not negligible but still much smaller than those on data. Interestingly, contrary to data, for Monte Carlo simulation the largest chambers exhibit the smallest variations! Even though this is not yet understood the size of the variations observed in the Monte Carlo simulation (\(\leq\pm 20\;\mu\)m for BIL and \(\leq\pm 10\;\mu\)m for BML and BOL) indicate that the observed variations in the data are most likely due to real effects i.e. genuine tube-to-tube variations and not an art-effect of the \(r-t\) determination algorithm. For Monte Carlo simulation the fitted \(r-t\) relation can also be compared with the input \(r-t\) relation. For the BIL and BOL chambers this comparison is shown in figure 32. Only for the BIL chamber a rather large mean deviation of \(-36\;\mu\)m is observed. For the BOL chamber the observed mean deviation is only \(-13\;\mu\)m. The systematic bias in the BIL chamber and the difference between the two multilayers in this chamber are still under study. Possible causes are \(\delta\)-rays or the \(2\times 3\;\)tube layer layout of this chamber in conjunction with its small multilayer separation.

### Conclusions and upcoming improvements

The work on the determination of the calibration constants (relative chamber locations, wire locations, \(t_{0}\), \(t_{\mbox{max}}\) and the \(r-t\) relation) is still in progress. In the near future we intend to slightly improve the \(t_{0}\) fit and we hope to conclude on how to treat the observed differences in \(t_{\mbox{max}}\). Next we need to better understand the observed biases in the \(r-t\) relations determined on Monte Carlo simulation. Certainly we will replace the simple arithmetic average in the determination of the mean \(t\) value for each \(r\) bin by a gaussian fit. Next we will investigate the behaviour at large drift distances. Once this is understood we will revisit the \(r-t\) relations for data in order to decide on the optimal grouping of those tubes (or tube regions) for which we can use a common \(r-t\) relation; also bearing in mind the temperature gradient (figure 5) along the tube length.

In parallel work will continue on the determination of relative chamber locations, including corrections for individual chamber deformations (notably relative displacements of the middle cross-plate) partially based on the readings of the in-plane alignment monitors and partially based on (straight) cosmic muon tracks. We probably also will try to determine individual wire location at least in the direction orthogonal to the average direction of cosmic ray muons even though we are afraid this will turn out to be impossible. With a better knowledge of the wire location along the tube length we expect to achieve more precise track fits. This probably also reduces the scatter (and perhaps even the bias) in the \(r-t\) relations.

In all this a major step forward will be the arrival of a new BML chamber in the summer of 1998. First we expect all tubes of this new BML chamber (the last barrel prototype preceding the module-0 chambers) to meet the design specifications i.e. no unexpected gas leaks, discharges, etc. Secondly for this new BML chamber we will abandon the multiplexed readout scheme; instead each tube will have its own preamplifier-TDC chain. This will eliminate the ambiguities in the present DATCHA readout due to the multiplexing (and the discharge induced noise level). Early 1999 we expect to upgrade all three DATCHA chambers with the real module-0 BIL, BML and BOL chambers. Atthat time we will also upgrade the readout for the BIL and the BOL chambers and we might switch to a gas mixture with a more linear \(r-t\) relation.

## 7 Performance

### Efficiency

Figure 34 shows the hit efficiency for the tubes in DATCHA (points) and the hit efficiency for Monte Carlo simulation (shaded histograms). For Monte Carlo simulation the efficiencies are basically 100% almost up to the inner tube wall. For data only the BIL chamber has a high, 98.5%, efficiency. For BML and BOL the inefficiencies are about 14% and 17%, respectively. These large inefficiencies are almost entirely due to the disconnected tubes. Also on data the efficiency starts to decrease already for drift distances in excess of 12.5 mm. This is earlier than expected from test beam measurements in the past. Many of the tubes in DATCHA are much longer than those used in the test beam experiments. Also contrary to most test beam studies the tubes in DATCHA are illuminated over their full length. Despite these differences, the efficiency as a function of the coordinate along the tube is almost constant (this coordinate ranges from 0 at the preamplifier side to 1 at the HV side). These distributions are shown for both data and Monte Carlo simulation in figure 35. Hence the tube length is not the reason for the efficiency drop near the inner tube wall. The real reason is explained in section 7.1.1 below.

Figure 33: (a) the hit efficiency (%) for the BIL chamber as already shown in figure 34, (b) the same quantity with the additional requirement that the hit must belong to the track.

Figure 34: The points show as a function of the drift distance the hit efficiency (%) for data and the shaded histograms show the same quantity for Monte Carlo simulation. Apart from the earlier onset of the inefficiency near the inner tube wall in the data, and the lower average efficiency in the BML and BOL chambers due to the presence of dead tubes, both distributions are in fair agreement. These plots give the efficiency to find any hit in the tube. If the hit is also required to fit onto the track, the efficiency is found to be a few percent less due to e.g. \(\delta\)-rays (see figure 33b).

Figure 35: The points show as a function of the coordinate along the tube (0 at preamplifier sidde and 1 at HV side) the hit efficiency (%) for data and the shaded histograms show the same quantity for Monte Carlo simulation. The overall inefficiency in the data for the BIL chamber is due to the gradual increase in the inefficiency for hits beyond \(r=12.5\) mm. For the BML and BOL chambers there is for data the additional inefficiency due to the presence of dead tubes.

Figure 36: The points show as a function of the coordinate along the tube (0 at preamplifier side and 1 at HV side) the good hit (i.e. for hits found on reconstructed track segments) frequency for data and the shaded histograms show the same quantity for Monte Carlo simulation. The dips in the data around \(x=\frac{1}{2}\) in the BML and BOL distributions are due to the tube in efficiency in the central wire location or region. This is not (yet) simulated in the Monte Carlo. The r.m.s. width of the dips is about 10-15 mm. This is not incompatible with the hitherto assumed \(2\times 30=60\) mm dead region near a central wire location (corresponds to \(60/\sqrt{12}\approx 17\) mm r.m.s.). However the RPC \(x\) resolution must also be taken into account.

Figure 33 compares for the BIL chamber alone the hit efficiency shown already in figure 34a to the same quantity after we require in addition the hit to be part of the track. This implies that the hit residual is small. In general this efficiency is lower (by 5-7%) than the efficiencies shown in figure 34. The additional inefficiency near the anode wire is in part due to the front-end electronics (\(\leq 8\) discriminator level crossings) restrictions discussed in section 2 and in more detail in section 7.1.3 below.

A by-product of the inefficiency study as a function of the coordinate along the tube, is that we also can partially quantify the effect of the central wire locators present in the tubes of the BML and BOL chambers. This is not well visible in figure 35 since all our efficiency figures shown sofar basically assume uncorrelated inefficiency sources since we used reconstructed track segments to look for missing hits along these same segments. If the region near the central wire locator is very inefficient (as we expect) we simply never find any track segments at all which will be hidden in the figures shown thusfar. Therefore we show in figure 36 the \(x\) location of all the hits used on track segments. For the BIL chamber this distribution is rather smooth between \(x=0\) (preamplifier end of tube) and \(x=1\) (HV end of tube). For the other two chambers a sharp dip is observed near \(x=\frac{1}{2}\). This is of course due to the central wire locators. The other irregularities in these distributions are due to the RPC chambers used to determine the \(x\) coordinate (e.g. three separate RPC chambers to cover the length of the tubes in the BOL chamber). We did not bother yet to quantify the extension of the inefficient region since the \(x\) resolution of the RPC chambers in the DATCHA setup is difficult to unfold. Also this measurement is performed much better in a dedicated single tube setup (with a silicon tracker as reference).

#### 7.1.1 Inefficiency near the inner tube wall

As indicated in section 7.1, the data suffers from an unexpected early onset of the inefficiency for muons passing near the inner tube wall. This both compared to Monte Carlo simulation and compared to earlier testbeam results. This is clearly shown in figure 34. The cause of this feature is the multiplexed readout as indicated in figure 37a. For the DATCHA setup muon tracks with a drift distance in excess of about 12.5 mm will pass through two adjacent tubes in the same layer. Most of the time (87.5%) these two tubes belong to the same multiplexer and hence only the address of one of the two tubes hit will be retained. This implies an inefficiency of almost 50%, in agreement with the observed inefficiency in figure 34 beyond 12.5 mm.

To further confirm this undesired feature of the multiplexed readout we took data with every other tube in the top layer of the BIL chamber disabled. I.e. in this case the hits in the disabled tubes can not anymore obscure the hits in their neighbours. The resulting efficiency for this special run is shown in figure 38a. Figure 38b gives the same distribution but now with all tubes still enabled and with a Monte Carlo simulation which included the multiplexer functionality. As expected the efficiency drop near 12.5 mm disappears when the multiplexing is basically disabled. In this situation only for drift distances larger than about 14 mm the inefficiency begins to show up.

A remark on the error bars in figure 38: they are obviously wrong. This because this figure (and the similar figures 33, 34 and 35) are the result of the division of two histograms with very correlated entries hence binomial statistics must be used for the correct error calculation. We failed to teach _paw_ this. The real error is very small (as is evident from the scatter between the data points).

#### 7.1.2 Overall inefficiency

Figure 38b and most other efficiency figures in this note show an overall hit efficiency of only 98.5%. This is high as an absolute figure, but claimed to be low by many collaborators in the ATLAS muon group. At this moment we do not fully understand this 'low' 98.5% efficiency. However, an additional result of the special run with a partially disabled multiplexing scheme, is that under those conditions the efficiency is basically 100.0%! This is evident from figure 38a. There are two easy explanations:

1. The inefficiency is due to a few dead tubes (requires 3 dead tubes in the BIL chamber with in total 192 tubes),
2. The inefficiency is a feature of the multiplexed readout.

Figure 37: (a) Schematic explanation of the inefficiency induced by the multiplexing scheme. A muon track is shown which leaves ionization trails in two adjacent tubes. In the bottom part of the figure the preamplifier outputs and the discriminator outputs are shown. The TDC input is the logical OR of the discriminator outputs. The upshot is that in this case the hit in tube # 2 is lost! (b) Schematic explanation of the good hit inefficiency due to the fact that the TDC only keeps the 8 latest leading and trailing edges. This particular muon led to 9 discriminator level crossings. The first and most important discriminator level crossing is lost. This does not effect the hit efficiency, but does effect the good hit (and tracking) efficiency.

The second explanation arises since the result shown in figure 38 makes it plausible that the 1.5% hit inefficiency finds its origin in the neighbouring tubes (within a layer). A likely explanation in that case is cross talk. In the DATCHA multiplexed readout scheme cross talk shows up differently as compared to the usual one-channel-one-TDC readout schemes. In the latter case the result of cross talk is duplicate hits in (normally) adjacent tubes. In the DATCHA case only one of the two tubes remains due to the multiplexing. This means that in the DATCHA case cross talk does not show up as duplicate hits but instead manifests itself as an inefficiency! If this is taken seriously, the 1.5% could point at a cross talk level of 3%.

This cross talk hypothesis remains to (and will) be investigated further as well as the explanation due to a few dead tubes. Independent hereof figure 38a shows a near 100.0% efficient tube operation for 16 tubes in the top layer of the BIL chamber (the other 16 tubes in this layer were disabled).

Figure 38: (a) Efficiency (%) as a function of the drift distance for a data set with the multiplexing basically disabled. (b) Same distribution with the multiplexing enabled. The Monte Carlo simulation shown in plot (b) includes, as opposed to all other Monte Carlo simulation results shown in this note, a simulation of the consequences of the multiplexed readout. The comparison of figures (a) and (b) proofs that the unexpected early onset of the inefficiency near 12.5 mm is a multiplexer feature due to the fact that for the DATCHA acceptance muon tracks further than about 12.5 mm away from the wire hit two adjacent tubes.

#### 7.1.3 Inefficiency near the anode wire

As opposed to the hit efficiency, the efficiency to find a hit on a track drops for muon tracks which pass near the wire. This is shown clearly in figure 33a (hit efficiency) and figure 33b (good hit efficiency). To a large extend this is due to a limitation of the TDCs used in DATCHA: they only store a maximum of 8 leading and 8 trailing edges as explained in section 2. Combined with the short shaping time constant of the preamplifiers used in DATCHA, this means that we start to loose the first (essential!) hit whenever the ionization trail left in the tubes becomes long. I.e. when the muon track passes near the wire. This behaviour is shown schematically in figure 37b. In this case the ionization trail led to 9 discriminator level crossings. All were digitized by the TDC, but only the last 8 are kept in the TDC memory. Hence one hit, the first and most important one, is lost in the readout. This means that the tube is still fully efficiency (has a hit when expected), but the good hit efficiency (i.e. has a hit which fits on the track) deteriorates near the anode wire.

To quantify this behaviour we show in figure 39a the number of leading edges registered versus the drift distance. Clearly for large drift distances, i.e. short ionization trails, only a few discriminator level crossings occur. For small drift distances many discriminator

Figure 39: (a) Distribution of number of discriminator level crossings versus the drift distance. For tracks passing near the anode wire many discriminator level crossings are registered. Far away from the anode wire very few discriminator level crossings occur. (b) The mean number of discriminator level crossings versus the length of the ionization trail (30 mm corresponds to a track through the anode wire; 0 mm corresponds to a track near the tube inner wall. The levelling off beyond 25 mm is in part due to the cut-off on the number of discriminator level crossings of 8 in the hardware setup.

level crossings occur which justifies the hypothesis that this is at least one of the reasons why the efficiency drops at small drift distances in figure 33b. Other reasons could be that near the anode wire the left-right assignment of the hits is more difficult than elsewhere (see section 5.2).

### Resolution

The resolution has already been discussed before. In figures 13, 14 and 15 the hit residual distributions are shown for the BIL, BML and BOL chambers, respectively. As stated before the r.m.s. of the hit residuals under estimates the real resolution. This is shown in figure 40 which shows the same hit residual distribution for 5 and 6 hits along a track. For the other two chambers the trend is less clear since tracks with low hit multiplicities often receive contributions (or are entirely due to) discharge hits. Hence contrary to what would be expected the r.m.s. residuals e.g. for BOL tracks with \(\leq 4\) hits are larger than the r.m.s. residuals of BOL tracks with \(\geq 7\) hits! This probably implies that in the future we will use a chamber dependent hit topology cut.

In figure 41 the residual distributions are shown as a function of the drift distance for the BIL, BML and BOL chambers. As expected the r.m.s. of the residual distribution starts out large near the wire (near 150 \(\mu\)m) to decrease to around 40 \(\mu\)m in the central region of the drift value from where it gradually increases again slightly. Figure 42 shows the corresponding distributions for Monte Carlo simulation which are in excellent agreement with the input resolution given in section 4.3.

Figure 40: The residual distribution in the BIL chamber for: (a) 5 hits along a track, (b) 6 hits along a track.

Figure 41: The residual distribution in the BIL (a), BML (b) and BOL (c) chambers as a function of the drift distance for data. Figure (d) gives the r.m.s. residuals as a function of the drift distance for the BIL (solid), the BML (dashed) and the BOL (dotted) chambers. All vertical scales are in \(\mu\)m.

Figure 42: The residual distribution in the BIL (a), BML (b) and BOL (c) chambers as a function of the drift distance for Monte Carlo simulation. Figure (d) gives the r.m.s. residuals as a function of the drift distance for the BIL (solid), the BML (dashed) and the BOL (dotted) chambers. These last three curves are in good agreement with the Monte Carlo input resolution discussed in section 4.3. All vertical scales are in \(\mu\)m.

Figure 43: The r.m.s. residuals in the BIL (solid), BML (dashed) and BOL (dotted) chambers as a function of the drift distance. For each chamber ten curves are shown which correspond to ten different runs taken over a period of about two weeks. For each run the \(r-t\) calibration was performed separately.

In figure 43 the r.m.s. residuals are shown for different runs taken over a two week period. For each run separate \(r-t\) relations were used (see figure 29 for their variations) since the H\({}_{2}\)O content was changing (see dewpoint column in table 5). With this procedure the r.m.s. residuals are stable.

#### 7.2.1 From residuals to resolution

As a preliminary analysis we investigated two methods to convert from residuals to real resolutions:

1. Simply rescale all residuals on a per track basis by \(\sqrt{N/(N-2)}\) with \(N\) the number of hits along the track. This in an attempt to take into account the bias introduced by the track fit. On average this increases the residuals by about 20%.
2. For tracks with at least five hits along the track (i.e. \(N\geq 5\)), the fit is repeated \(N\) times with each time one of the \(N\) hits dropped from the fit. The residual of the omitted hit is used to estimate the real resolution. The resulting distribution must be corrected for the finite precision of the track fit proper. This is achieved by a propagation of the track parameter uncertainties on a per track basis. I.e. the residual of the omitted hit is corrected for the finite precision of the track parameters used to calculate this residual.

Naturally the second method is mathematically superior.

In figure 44 we compare (for an early run with unstable dewpoint) the two methods for the BIL chamber. Figure 44a shows the same residual distribution as shown before with an r.m.s. of 64 \(\mu\)m. Figure 44b shows the resolution using method 1 i.e. rescaling by \(\sqrt{N/(N-2)}\). This yields an r.m.s. of 80 \(\mu\)m i.e. about 20% larger than the original r.m.s. residual. Figure 44c shows the true resolution obtained using method 2, but including still the uncertainty due to the finite fit precision. The latter is shown in figure 44d. After unfolding of the track fit precision method 2 yields an r.m.s. of 87 \(\mu\)m to be compared with the 80 \(\mu\)m of method 1. The discrepancy of 10% between these two results is not yet understood. Clearly we should investigate the dependence of these results on the drift distance and on the number and location of hits along the track segment. This will be done in the near future. For now we conclude that all our r.m.s. residuals can be converted into a real resolution by a simple rescale factor somewhere between 1.2 and 1.3.

A final word on the result of the Monte Carlo simulation shown in figure 42d. Averaged over the drift distance the r.m.s. for the BIL, BML and BOL chambers are: 82 \(\mu\)m, 82 \(\mu\)m and 90 \(\mu\)m, respectively. (As shown already in table 2.) Converted to a resolution we find about: 100 \(\mu\)m, 100 \(\mu\)m and 110 \(\mu\)m for the BIL, BML and BOL chambers, respectively. These should be compared to the Monte Carlo simulation resolution input of about 95 \(\mu\)m. The latter is the quadratic average of the drift distance dependent resolution discussed in section 4.3.

Figure 44: (a) The r.m.s. residuals, (b) the same r.m.s. residuals but rescaled by \(\sqrt{N/(N-2)}\) with \(N\) the number of hits along a track segment, (c) the residuals of hits not taken into account in the track fit i.e. an estimate of the true resolution, (d) the contribution of the finite fit precision to the quantity shown in (c). All four plots are for the BIL chamber.

## 8 Preliminary comparison of Cosmics and RASNIKs

As a follow up on the results already presented to the LHCC in the summer of 1997, we repeated that same analysis with more statistics and better MDT reconstruction software. However, as already indicated during last summer, as long as the dominant error contribution is the multiple scattering in the BML chamber6 one does not expect a significant improvement on the resolution of the sagitta measured for the \(\mu\) tracks. This is evident from the two sagitta distributions shown in figure 45 ( 45a for data and 45b for Monte Carlo simulation, respectively); despite the excellent track segment resolutions of 35 \(\mu\)m (see e.g. figure 12) the sagitta resolution exceeds 1 mm both on data and Monte Carlo7. On Monte Carlo the mean value is, as expected, consistent with 0 \(\mu\) within its error. On data the mean value is of course not consistent with 0 \(\mu\)m since the chamber positions have only been adjusted such that all four projective systems yield decent images i.e. to the \(5-10\) mm accuracy.

Footnote 6: The 1.8 m of iron shielding corresponds to at least 2 m of iron for the inclination angles of the muons we except in DATCHA. This gives rise to a cut-off on the muon momentum of (assuming \(6\times 1.2=7.2\) mm of aluminium traversed on average in the BML chamber i.e. about \(0.1\times X_{L}\) and a \(dE/dx\) in (density of) iron of about 2 MeV\(\rm cm^{2}g^{-1}\) (7.9 g/cm\({}^{3}\))): \(E_{\rm min}=2\times 7.9\times 200\approx 3\) GeV Hence the r.m.s. multiple scattering angle is about \(\sqrt{0.1}\times 13.6/3000\approx 1.5\) mrad.

Footnote 7: Since the multiple scattering is \(\propto 1/p\), one can estimate from figure 45a that only for muon momenta in excess of about 50 \(\times 3=150\) GeV the multiple scattering contribution starts to drop below the intrinsic MDT chamber resolution.

Figure 45: (a) Sagitta distribution for DATCHA data and (b) sagitta distribution for Monte Carlo simulation. The dominating contribution to the width of the sagitta distribution comes from multiple scattering in the BML chamber.

For ten different relative positions of the BML chamber, the mean reconstructed sagitta of a large sample of cosmic muon events (typically 300 k) is compared to the mean of the readings of the four projective RASNIK systems in figure 47. The average RASNIK numbers have an r.m.s. uncertainty of about 2 \(\mu\)m (see also figure 46 which shows for each of the ten settings the stability of the RASNIK information). The sagittae for the cosmic \(\mu\) track samples have a typical r.m.s. uncertainty of about 6 \(\mu\)m (typically 45 k events with good global cosmic muon tracks, i.e. a 15% global track efficiency). The RASNIK systems agree with the data very well as is evident from the reported slope parameter which equals unity within its error. The r.m.s. deviation between the analysis of the RASNIK data and the analysis of the cosmic ray data is a mere 5.7 \(\mu\)m; well below the design target of 30 \(\mu\)m. This 5.7 \(\mu\)m is compatible with the statistical uncertainty in the average sagitta of the cosmic \(\mu\) samples. It should of course be realised that the present analysis does not rely on the absolute calibration of the projective systems which is one of the larger contributions to the 30 \(\mu\)m design target. This will be addressed in reference [2].

Mechanical dial gauges were mounted on the BML chamber to monitor the displacements of the BML chamber from setting to setting. These were used to estimate the steps as predicted from the four projective RASNIK systems. They agreed to within 11 \(\mu\)m i.e. consistent with the 10 \(\mu\)m precision of the dial gauges.

Figure 48 shows a preliminary result of the relative distribution of the sagitta changes across the face of the BML chamber. For figure 48a we used the cosmic \(\mu\) track sample on a run-by-run basis to determine for each run the ten parameters which describe

Figure 46: The mean sagitta prediction as calculated by averaging the results of the four projective RASNIK systems. All ten settings are shown and in the figure is indicated what the actual displacements of one side (HV side) of the BML chamber were.

Figure 47: The top figure shows the agreement between the predicted mean \(s\) agitta values from the four projective RASNIK systems and the reconstructed mean sagitta values from cosmic \(\mu\) tracks. The ten points (two points, the ones with the RASNIK prediction close to \(-0.2\) mm, coincidep in the plot) correspond to ten different positions (both after shifts and after rotations) of the BML chamber. The bottom figure shows the residuals of the straight line fit.

Figure 48: (a) Profile of the changes in the averaged sagitta of muon tracks between run 2015 and run 2016. (b) Profile of the changes in the averaged sagitta as predicted by the projective alignment system between run 2015 and run 2016. (c) The difference of figures (a) and (b). In all three plots the vertical scales are in millimetres and the horizontal scales correspond to the \(Z\) and \(X\) coordinates of the BML chamber.

the measurable relative chamber positions (of the \(3\times 6=18\) parameters that describe the positioning of the three MDT chambers, only ten parameters determine the sagitta to first order8). With these ten parameters we can determine for each cosmic \(\mu\) track its absolute sagitta. In figure 48a we show the differences of the absolute sagittae for two runs (2015 and 2016 in this case) across the face of the BML chamber. Figure 48b shows the same quantity derived from the RASNIK data. To obtain this we used linear interpolation between the four projective RASNIK systems. The unknown absolute calibration of the RASNIK systems cancels in this difference. The good agreement between figures 48a and b, whose difference is shown in figure 48c, justifies the global averaging of the sagittae used to obtain figure 47.

Footnote 8: The six parameters of one chamber are used to define the origin (three parameters) and the directions of the coordinate axes (three parameters). For the remaining two chambers the translations along the tube length (two parameters) can not be determined accurately. This leaves \(18-6-2=10\) parameters to be fitted.

## 9 Conclusions

Despite the operational difficulties due to discharges in the tubes of the BML and the BOL chambers and despite the originally unforeseen complications due to the multiplexed MDT read-out scheme, the DATCHA setup is operational and the quality of the data is comparable to earlier testbeam data. After averaging over complete chambers single tube r.m.s. residuals below \(70\;\mu\)m have already been achieved with only a limited set of independent \(r-t\) relations. First preliminary comparisons between alignment and cosmic \(\mu\) track data demonstrate that the alignment monitors can be used to correct for chamber displacements and rotations to well below the target value of \(30\;\mu\)m on the sagitta.

In 1998 the analysis of the DATCHA data will continue with the emphasis on auto-calibration and a much more detailed comparison of RASNIK results and cosmic \(\mu\) track results. Moreover in 1998 we will significantly improve the DATCHA hardware regarding the MDT chambers with as ultimate aim to test module-0 MDT chambers together with the front-end electronics functionality (preamplifier-shaper-discriminator-TDC chain) and read-out scheme (NIMRODs) as planned for the real ATLAS muon spectrometer.

## 10 Summary

To date the DATCHA setup did yield the following very positive results:

* Excellent single tube efficiency (figure 38a).
* Adequate track residuals (figure 43).
* New \(r-t\) calibration algorithm in an environment with dead or poorly performing tubes, fluctuating temperature and humidity and small, \(\pm 3^{o}\), dispersion of track angles (figures 26, 27 and 29). Under stable conditions variations in the \(r-t\) relations between tubes, between different groups of tubes and between different regions of the same tubes are limited to about \(\pm 10\;\mu\)m.

* Excellent preliminary results on the comparison of RASNIK and cosmic \(\mu\) data (6 \(\mu\)m r.m.s., figure 47).
* Good understanding of 'features' of the (multiplexed) front-end readout.
* Excellent experience with the readout and performance of the 16 DATCHA RASNIK systems and associated data acquisition hardware and software.
* Good experience with on-chamber HV generation, control and monitoring via the CAN fieldbus.
* Good experience with the temperature monitoring via the CAN fieldbus.
* Excellent Monte Carlo simulation package in Arve/Gismo object oriented environment.

And most important: DATCHA has a very bright future with many upgrades forthcoming (new BML chamber by jun/98, new 'near final' MDT readout in jun/98-apr/99 period, silicon telescope in apr/98, \(B\)-field sensors in feb/98 and possibly even Helmholtz coils to mimick the bending of muon trajectories in the summer of 1999,'module 0' BIL, BML and BOL chambers by apr/99).

## Appendix A Data and Monte Carlo simulation files used for this note

Table 5 gives the relevant information regarding these data sets and the other publicly available DATCHA data sets.

Most of the results reported in this note come from the data file:

\[\mbox{/afs/cern.ch/atlas/project/datcha/daq/run02016.raw}\]

and the Monte Carlo simulation file:

\[\mbox{/afs/cern.ch/atlas/maxidisk/d10/data/run00003.sim}\]

All other data and Monte Carlo files reside in the same directories as quoted above for run # 2016 (data) and run # 3 (Monte Carlo). Data runs 2011 until 2020 are the data sets used for the comparison of RASNIK results and cosmic \(\mu\) track sample results.

\begin{table}
\begin{tabular}{l||c|c|c|c} Data Set & \# Events & \# \(\mu\) Tracks & Dewpoint & Comments \\ \hline \multicolumn{5}{c}{Monte Carlo Simulation} \\ \hline run00003 & 500 k & 303 k & - & Error in generated track information \\ run00004 & 500 k & 25 k & - & \\ \hline \multicolumn{5}{c}{Data} \\ \hline run02001 & 200 k & 22 k & \(-7.6^{o}\)C & Early run \\ run02011 & 300 k & 48 k & \(-3.1^{o}\)C & \(\Delta Y=-1.0\) mm (HV/BML) \\ run02012 & 300 k & 52 k & \(-4.4^{o}\)C & \(\Delta Y=-0.5\) mm (HV/BML) \\ run02013 & 300 k & 52 k & \(-5.3^{o}\)C & \(\Delta Y=-1.5\) mm (HV/BML) \\ run02014 & 300 k & 52 k & \(-6.0^{o}\)C & \(\Delta Y=-2.0\) mm (HV/BML) \\ run02015 & 300 k & 52 k & \(-6.0^{o}\)C & Reference run \\ run02016 & 300 k & 52 k & \(-6.0^{o}\)C & \(\Delta Z=+2.0\) mm (BML) \\ run02017 & 150 k & 26 k & \(-6.0^{o}\)C & \(\Delta Z=-1.0\) mm (BML) \\ run02018 & 300 k & 51 k & \(-5.9^{o}\)C & \(\Delta Z=-3.0\) mm (BML) \\ run02019 & 300 k & 47 k & \(-5.0^{o}\)C & \(\Delta Z=+1.0\) mm (BML) \\ run02020 & 300 k & 40 k & \(-3.9^{o}\)C & \(\Delta Z=-1.0\) mm (BML) \\ run02021 & 300 k & 51 k & \(-5.5^{o}\)C & 7.2 kg on middle cross-plate BML \\ run02022 & 300 k & 57 k & \(-5.9^{o}\)C & 14.4 kg on middle cross-plate BML \\ \hline \end{tabular}
\end{table}
Table 5: Available DATCHA data files and DATCHA Monte Carlo simulation files.

## Appendix B Software used for this note

The software used in this note originates from various sources:

1. Cosmic \(\mu\) data & simulation * Data acquisition: M. Woudstra (C); * modified version of N. Hessey's BIRDIE, * General framework: M. Woudstra (C); * modified version of N. Hessey's MUTDAT, * Scintillator hodoscope reconstruction: V. Goriatchev (C); * integrated part of MUTDAT, * RPC reconstruction: M. Vreeswijk (C); * integrated part of MUTDAT, * RPC & Scintillator hodoscope calibration: M. Vreeswijk (C); * integrated part of MUTDAT, * MDT reconstruction: F. Linde (Fortran); * separate package TRA CKFIT.CAR; interfaced to MUTDAT, * MDT calibration: F. Linde (Fortran); * separate package TRA CKFIT.CAR; interfaced to MUTDAT, * MDT chamber alignment: M. Vreeswijk & M. Woudstra (Fortran/C++); * separate code; not yet publicly available, * Monte Carlo simulation: P. Hendriks (C++); * separate code; not yet publicly available (runs only under Windows NT).
2. RASNIK data * Data acquisition: P. Verloop (C++); * ICARAS standalone application running on RASNIK Pentium-PC, * Image reconstruction: F. Linde (Fortran); * RASNIK.CAR separate library called from ICARAS, * Conversion to sagitta: M. Woudstra (C++); * separate code GEOFIX; not yet publicly available, * Calibration (in-plane & projective): M. Vreeswijk & M. Woudstra (Fortran/C++); * separate code; under development.
3. Cosmic \(\mu\) data - RASNIK data comparison * Presentation of results: M. Vreeswijk & M. Woudstra (Fortran/C++); * separate code, under development,

The publicly available code resides in:

/afs/cern.ch/atlas/project/datcha/mutdatThis same directory has some example initialisation kumacs. The required constants (geometry, \(t_{0}\), \(t_{\mbox{max}}\) and \(r-t\) relations etc.) reside in the directory:

\[\mbox{/afs/cern.ch/atlas/project/datcha/mutdat/db}\]

## Appendix C Example _Mutdat_ initialisation kumac

* Example start-up kumac for MUTDAT.
*
* Give run number as argument.
*
* Read in Geometry etc. MACRO/TRACE ON ;
* Echo commands MDT/TUBEGCOM../db/bi_l.geo bil 1 MDT/TUBEGCOM../db/bi_l.geo bil 2 MDT/TUBEGCOM../db/bml_l.geo bml 1 MDT/TUBEGCOM../db/bml_2.geo bml 2 MDT/TUBEGCOM../db/bol_l.geo bol 1 MDT/TUBEGCOM../db/bol_2.geo bol 2 MDT/READT0../db/run//[1]//.t0 MDT/READTMAX../db/run//[1]//.tmax MDT/READRT run//[1]//.rt ;
* Read MDT t0's MDT/READRT run//[1]//.rt ;
* Read MDT maximum drift times
* Set MDT parameters MDT/TDCCUTS BIL 1000 3000 0 MDT/TDCCUTS BML 1000 3000 6 MDT/TDCCUTS BOL 1000 3000 60 MDT/DISPLAY ON ;
* Activate MDT event display MDT/DEBUG ALL=1 ;
* Output selected (=all) debug information MDT/HISTOGRAMS ALL=1 ;
* Book and fill selected (=all) build-in histograms MDT/TOCAL ON ;
* Book and fill histograms for t0-calibration MDT/AUTOCAL/WIRE ON ;
* Book and fill histograms for wire position calibration MDT/TOPOLOGY 4 2 ;
* Minimum # of hits on track in chamber/multilayer MDT/DISTANCE 15.0 MDT/CHISQUARED 5.0 150000.0 MDT/EFFICIENCY ON ;
* Book and fill histograms for tube efficiency MDT/THETA DIFF=0.050 RMS=0.010 ;
* Set cuts on angles for global tracks *
* Open data file INPUT/OPEN../data/run0//[1]//.raw
* Start analysis EVENTS 1-10 SHOWEVENT 10000 ANALYSE MDTS,RPCS,HODO,TRKS GO ;
* Do calibration stuff MDT/AUTOCAL/RT WRITE MDT/TOCAL FIT ;
* Determine and write auto-calibrated r-t relation MDT/TOCAL FIT ;
* Do t0 fits on TDC spectra and write t0's to file
* Quit MUTDAT QUIT

[MISSING_PAGE_EMPTY:68]

## References

* [1] "EPIO",????.
* [2] "Study of the global alignment of MDT chambers using DATCHA data", ATLAS Internal Note MUON-NO-XXX, 1998.
* [3] "ATLAS Muon Spectrometer Technical Design Report", CERN/LHCC/97-22, 1997.
* [4] M. Aleksa, private communication.
* [5] "Arve-The ATLAS Reconstruction Environment", [http://wwwinfo.cern.ch/b/burnett/www/arve](http://wwwinfo.cern.ch/b/burnett/www/arve).
* [6] "Mutdat User Guide for DATCHA Event Analysis", /afs/cern.ch.users/w/woudstra/public/datcha/mutdat/manual.ps.
* [7] "Testbeam Results from the Calypso Chamber", ATLAS Internal Note MUON-NO-196, 1997.