ATLAS Internal Note

INDET-No-115

24th November 1995

Present status of b-tagging studies in ATLAS

**I. Gavrilenko, S. Haywood, A.G. Clark, D. Froidevaux and L. Rossi**

**Abstract**

This note compares recent work of I. Gavrilenko and S. Haywood on b-tagging using the ATLAS inner detector. Their results are in good agreement: for a b-tagging efficiency using vertexing of \(\sim 50\%\), a rejection of gluon jets of \(\sim 60\) can be achieved by simply counting tracks with large transverse impact parameter. With more work on secondary vertex algorithms and on the use of 3D-information, the performances advocated at the time of the ATLAS Technical Proposal should be reached, thus providing ATLAS, hopefully at all luminosities, with an important tool for Higgs boson and SUSY particle searches at LHC.

Introduction

A clear distinction should be made between b-tagging and B-physics. The former addresses the identification of high-\(p_{T}\) jets (typically 50 GeV and above), originating from b-quark fragmentation and decay above the usually much larger background from light quark and gluon jets. The latter, on the other hand, concerns the reconstruction of essentially exclusive final states from B-hadron decays, which at LHC will usually be studied at rather low \(p_{T}\) (typically around 15 GeV).

The importance that ATLAS places on b-tagging for LHC physics has increased over the past year, as a result of recent detailed studies of Higgs and supersymmetry (SUSY) signatures, which were performed for the ATLAS Technical Proposal (TP) and for the discussions with the LHCC referees. In addition, in the framework of the LEP2 workshop, a detailed comparison of LHC with LEP2 in the Standard Model (SM) and Minimal Supersymmetric Standard Model (MSSM) Higgs sectors has also shed new light on this topic. Many final states from Higgs boson decays involve heavy quarks:

* \(\mathrm{H/h}\to b\overline{b}\) from associated \(\mathrm{WH/h}\) and \(t\overline{t}\)\(\mathrm{H/h}\) production in the SM or in the MSSM [1] and
* MSSM \(\mathrm{H}\to\mathrm{hh}\to b\overline{b}\)\(\gamma\gamma\) or \(b\overline{b}\)\(b\overline{b}\), \(\mathrm{A}\to\mathrm{Zh}\to\mathrm{ll}b\overline{b}\) or \(b\overline{b}\)\(b\overline{b}\) and \(\mathrm{A/H}\to t\overline{t}\) in the MSSM [2].

The multiplicity of b-quarks in these final states ranges from two to four, and the backgrounds from processes involving light quark and gluon jets (hereafter referred to as non-b jets) are very large. Charm-quark jets are not produced much more abundantly than b-quark jets in the physics processes of interest, and are therefore not a major source of concern, but they nevertheless deserve a separate treatment outside the scope of this note. The very large non-b jet backgrounds often demand that all b-quarks present in the final state under study be identified. Therefore b-tagging with as high an efficiency as possible, using vertexing algorithms together with soft lepton tags (identified electrons and muons of transverse momenta above 1-2 GeV inside jets), will be one of the keys to a successful search for new physics at LHC. This has been pioneered with great success by the CDF collaboration at the Fermilab Tevatron, for the discovery of the top quark [3].

As shown experimentally by CDF, and also in a different context by the LEP experiments, vertexing algorithms account for most of the b-tagging performance, while soft lepton tags contribute to a lesser extent, due to the limited fraction of B-hadron decays containing leptons and to the difficulty of efficiently identifying low-\(p_{T}\) leptons in jets. Preliminary studies for ATLAS showed that a b-tagging efficiency of \(\sim 50\%\), with a rejection of \(\sim 100\) against non-b jets, may be reached using vertexing alone at low luminosity [4], [5], i.e. with a vertexing B-layer consisting of strips at a radius of 6 cm [6] or pixels at a radius of 4 cm [7]. In addition, b-tagging efficiencies of \(\sim 10\%\) per lepton flavour may be achievedwith similar rejection of non-b jets, using soft electron tags [8] and soft muon tags [9]. Thus a total b-tagging efficiency, \(\epsilon_{b}^{tot}=\epsilon_{b}^{vert}+\epsilon_{b}^{\epsilon/\mu}-\epsilon_{b}^{vert }\epsilon_{b}^{\epsilon/\mu}\), of \(\sim 60\%\) may be expected in ATLAS at low luminosity. It is worth noting that the present CDF performance is not far from this figure.

At high luminosity, the main degradation with respect to this expected performance will arise from the absence of the B-layer, unless it can be replaced at regular intervals. The degradation of the performance due to pile-up itself is expected to be small, since, at a luminosity of \(10^{34}\) cm\({}^{-2}\) s\({}^{-1}\), the multiplicity of charged tracks with \(\mathrm{p}_{T}>1\) GeV is expected to increase only by \(\sim 20\%\) in a cone of \(\Delta\mathrm{R}=0.4\).

The studies described in [4] and [5], from which were derived the first estimates of the ATLAS b-tagging performance using vertexing, used a simplified and fast simulation of the ATLAS precision tracker. These studies have since been pursued. In parallel, much work has gone into the full simulation and reconstruction of b-jets and gluon jets from Higgs decays in the complete inner detector, using the global pattern recognition code developed for the TRT [10] extended to the precision tracker layers applying Kalman filtering methods [11]. First results from this work appeared to show a significantly poorer performance than that predicted for the TP.

This note summarises the recent work by Stephen Haywood (SH), described more extensively in [12], and by Igor Gavrilenko (IG), described more extensively in [13]. The main aim has been to compare the results of the two simulations as consistently as possible and to understand the origin of possible discrepancies. Section 2 describes in some detail the main features of the simulations performed by SH and IG, and the steps taken to resolve the differences and to subsequently achieve a meaningful comparison. Section 3 is devoted to a discussion of the b-tagging methods used, Section 4 to the impact of full simulation and reconstruction on the estimated b-tagging performance, and Section 5 to the stability of the performance with respect to some of the main parameters of the ATLAS inner detector. Section 6 compares in a preliminary way the expected performances for the two proposed B-layers, strips or pixels, with that of a layout without any B-layer, and also discusses in this context individual track reconstruction efficiencies and fake track rates, as obtained in both simulations. Finally, the conclusions list the main points requiring further work, before a clear understanding of the ATLAS inner detector performance in this field can be reached.

## 2 Main features of the two simulations

The b-tagging performances using vertexing, which are discussed throughout this note, are obtained by generating physics events containing either a signal from b-quark jets or a background from non-b jets; these events are then propagated through a model of the ATLAS inner detector and analysed with a pattern recognition procedure, designed to reconstruct all charged tracks with \(\mathrm{p}_{T}>0.5\) GeV.

The reconstructed tracks are then processed through a b-tagging algorithm to distinguish b-jets from non-b jets. The main features of the simulations performed by SH and IG are summarised below:

* **Physics events:** SH studied \(\mathrm{H}\to b\overline{b}\) and \(\mathrm{t}\rightarrow\mathrm{W}\mathrm{b}\) decays as signal events and used the same events, where all charged tracks were forced to have zero impact parameter in the transverse plane (d), for the background studies. The signal b-jets were thus compared to a background from so-called prompt jets, which by definition did not contain any long-lived particles. IG compared b-jets from \(\mathrm{H}\to b\overline{b}\) decay with gluon jets from \(\mathrm{H}\rightarrow\mathrm{g}\mathrm{g}\) decay. The B-hadron lifetimes used by both SH and IG were around 390 microns (the default values of PYTHIA 5.7), whereas the present world average is closer to 460 microns, which means that the performance numbers discussed in this note are likely to be somewhat under-estimated.
* **Detector model:** SH has studied several inner detector layouts over the full pseudorapidity or \(\eta\)-coverage. He has not however included the TRT in his simulations and has most often used a pixel layer at a radius of 4 cm for the B-layer. IG has only studied the so-called "Morges" barrel layout, using a modified version of the old "panel" geometry for the GEANT 3.21

Figure 1: _Gluon-jet rejection versus b-jet efficiency in the barrel ATLAS inner detector, equipped with a strip B-layer, for the results of SH (black circles) and of IG with partial GEANT simulation (open circles)._

description of the inner detector. The physics events have been processed through the full simulation and reconstruction of the TRT, SCT and pixels, using the strip version of the B-layer.

Bending in the magnetic field and multiple scattering due to the detector layer material are included in the simulations by SH, who has also studied the impact of single layer inefficiencies and electronic noise on the b-tagging performance. The simulated events studied by IG include other detector effects, predominantly photon conversions in the detector material but also secondary interactions. These studies do not yet, however, include detector inefficiencies other than geometrical, nor do they incorporate any electronic noise.
* **Pattern recognition procedure:** SH uses a simple Gaussian model for the detector resolutions and the two-track separation is simulated by appropriately merging nearby hits. The pattern recognition procedure starts in the outer SCT layers and moves inwards, looping over all allowed combinations. Hits are not shared between different tracks.

Figure 2: _Gluon-jet rejection versus b-jet efficiency in the barrel ATLAS inner detector, equipped with a strip B-layer, as obtained by SH from charged tracks collected in a cone of \(\Delta R=0.4\) around the jet axis defined from charged tracks alone (open circles) or from the calorimeter (closed circles)._

The pattern recognition procedure developed by IG first reconstructs track candidates in the transverse plane using the TRT and then extrapolates them inwards in radius to the precision tracker layers. The precision layer hits are input into the pattern recognition procedure as clusters of neighbour strips or pixels, formed through a crude clustering procedure. In the case of the full GEANT simulation, more than 50% of the barrel SCT clusters contain more than one hit strip.
* **Algorithm for b-tagging:** SH initially used the ALEPH algorithm, as defined in [14], i.e. a global likelihood method using tracks with transverse impact parameter smaller than 2 mm. The algorithm initially used by IG consisted simply in counting tracks with large transverse impact parameter, \(3\sigma_{d}<d<1\) mm. In both cases, the signed transverse impact parameter with respect to the jet axis was used. More details on the b-tagging algorithms can be found in Section 3.

The largest differences between the two studies originate from the use of prompt jets (SH) as compared with gluon jets (IG), and from the performance of the b-tagging algorithms themselves in the presence of long-lived particles. Both simulations have now been repeated comparing:

* prompt jet rejections to gluon jet rejections,
* different b-tagging algorithms, and
* GEANT simulations, where only multiple scattering and dE/dx processes are switched on and hereafter referred to as partial GEANT simulations, to full GEANT simulations with all physics processes switched on.

The results of SH and IG are then in remarkably good agreement, as shown for example in fig. 1, which compares the results from the two simulations in the particular case of:

* a gluon-jet background,
* the simple track-counting b-tagging algorithm,
* the strip B-layer, and
* partial GEANT simulation for IG.

For a b-jet efficiency \(\epsilon_{b}\sim 50\%\), both simulations give gluon-jet rejections of \(\sim 65\). This value is significantly below the TP value of \(\sim 200\), previously quoted for prompt jets. The simulation results shown in fig. 1 from SH use the same definition of the b-jet axis as IG, i.e. the original b-quark direction, or more exactly the original b-quark direction smeared with a Gaussian resolution of 1\({}^{o}\), to account for the expected accuracy of the calorimeter measurement. As shown in fig. 2, this definition of the jet axis significantly improves the b-tagging performance with respect to that obtained for a jet axis defined from the reconstructed charged tracks alone. In the rest of this note, the results from SH will be shown for this less accurate definition of the jet axis. For values of \(\epsilon_{b}\) close to 90-100%, the small difference between the two simulations, which can be observed in fig. 1, is due to the different normalisation procedures used by SH and IG: IG included jets, which contained less than two reconstructed tracks, in his calculation of \(\epsilon_{b}\).

## 3 Algorithms for b-tagging

At the time of this note, only simple b-tagging algorithms have been studied. In particular, the algorithms described below do not use any z-information for vertexing and do not explicitly reconstruct secondary vertices, even in the transverse plane. In a first step, after the pattern recognition procedure, some simple track selection criteria are applied:

* only tracks with \(p_{T}>1\) GeV within a cone of \(\Delta\)R = 0.4 around the axis of the jet under study are considered;

Figure 3: _Distribution of signed transverse impact parameter d (in metres), for all (left side) and selected (right side) reconstructed tracks with \(p_{T}>1\) GeV within a cone of \(\Delta\)R = 0.4 around the jet axis, for b-jets (top) and gluon jets (bottom), as obtained by SH for the barrel inner detector equipped with a strip B-layer._

* SH imposes a global quality cut (\(\chi^{2}\)-probability larger than 1%); IG requires that the tracks have an associated hit in the B-layer for the coordinate in the transverse plane.

The b-tagging algorithms are then based on only one quantity per track: the signed impact parameter in the transverse plane, \(d\), where the sign is traditionally defined to be positive if the point of closest approach of the track to the primary vertex is within the hemisphere containing the jet axis. The distribution of \(d\) is shown in fig. 3 for the simulations by SH in the case of the strip B-layer, for b-jets (top) and gluon jets (bottom) and for all reconstructed tracks (left) and the ones passing the selection criteria discussed above and with \(|d|<2\) mm (right). This figure clearly shows that the selection cuts significantly reduce the fraction of tracks with very large \(d\). Only the tracks with positive \(d\) are used by SH in the

Figure 4: _Distribution of signed transverse impact parameter \(d\) (in cm), for all (left side) and selected (right side) reconstructed tracks with \(p_{T}>\) 1 GeV within a cone of \(\Delta R\) = 0.4 around the b-jet axis, for partial (top) and full (bottom) GEANT simulations by IG of the barrel inner detector equipped with a strip B-layer._

b-tagging procedure. For the simulations by IG in the case of the strip B-layer, fig. 4 for b-jets and fig. 5 for gluon jets show the distributions of \(d\) before (left) and after (right) selection cuts. Shown separately are the results for the partial (top) and full (bottom) GEANT simulations. When going from partial to full GEANT simulation, an increase of about an order of magnitude in the fraction of tracks with very large \(d\) (\(|d|>0.3\) cm, i.e. underflows and overflows in fig. 5) is observed before track selection. This increase is only about a factor of two after the track selection. The agreement between the distributions of SH and IG is quite good, both in terms of the average value of \(d\) for b-jets and of the r.m.s of the distribution for gluon jets, which are key ingredients for the overall b-tagging performance.

Figure 5: _Distribution of signed transverse impact parameter \(d\) (in cm), for all (left side) and selected (right side) reconstructed tracks with \(p_{T}>1\) GeV within a cone of \(\Delta R=0.4\) around the gluon jet axis, for partial (top) and full (bottom) GEANT simulations by IG of the barrel inner detector equipped with a strip B-layer._

Three different b-tagging algorithms have then been considered:

* **ALEPH algorithm:** this algorithm, described in more detail in [14], first defines a one-sided Gaussian probability for each individual selected track: \[\omega=\frac{2}{\sqrt{2\pi}}\int_{d}^{\infty}\exp{-\frac{x^{2}}{2\sigma^{2}}dx}\] (1) where \(\sigma_{d}\) is the measurement accuracy of \(d\). Then the product of these probabilities is formed for all selected tracks: \[P=\prod_{i}^{n}\omega_{i}\] (2)

Figure 6: _Gluon-jet rejection versus b-jet efficiency, obtained from different b-tagging algorithms, using generated charged tracks with smeared transverse impact parameters. The gluon-jet rejections are computed using only charged tracks originating from a point in the transverse plane with radius smaller than 100 \(\mu\) (top), i.e. eliminating most of the long-lived particles or \(V^{0}\), or using all charged tracks (bottom). The b-tagging algorithms shown correspond to the ALEPH (open circles), track counting (black circles) and b-jet to gluon-jet probability ratio (open squares) methods (see text)._

Finally, this product is normalised so that it has a uniform distribution over the interval [0,1]. This procedure makes it insensitive to the number of tracks considered: \[\Omega=P\sum_{j=0}^{n-1}\frac{(-\ln P)^{j}}{j!}\] (3) A cut on \(\Omega\) then provides discrimination between jets which contain long-lived particles and those which do not.
* **Track counting algorithm:** this algorithm simply count tracks with large, but not too large, signed impact parameter, i.e. tracks with \(3\sigma_{d}<d<1\) mm. A cut on the number of such tracks then provides discrimination between jets which contain long-lived particles and those which do not.
* **b-jet to gluon-jet probability ratio:** this algorithm builds a global likelihood ratio based on the distributions of \(d\) expected for b-jets and gluon jets. The distributions of figs. 3, 4 and 5, once normalised, yield probability distributions for \(d\), both for b-jets, \(P_{b}(d)\), and gluon jets, \(P_{g}(d)\). The sum over all selected tracks of the logarithms of the ratios \(P_{b}(d)/P_{g}(d)\) provides discrimination between jets which contain long-lived particles and those which do not.

These three algorithms have been studied and compared to each other by IG, both for generated particles (GEANT KINE information) with appropriate smearing for the impact parameter resolution, and for reconstructed tracks after full

Figure 7: _Event display for partial GEANT simulation (see text)._

simulation. The results are summarised in fig 6 in the case of smeared generated tracks, for the ALEPH (open circles), track counting (black circles) and b-jet to gluon-jet probability ratio (open squares) algorithms. The bottom part of fig. 6 shows the result using all tracks in the gluon jets, whereas the top part was obtained using only those tracks of the gluon jets, which originated from a vertex with radius in the transverse plane larger than 100 \(\mu\). This treatment of the gluon jets is similar to the prompt-jet treatment used by SH and yields much better results than the more standard treatment.

Some conclusions can be drawn from fig. 6:

* if long-lived particles are excluded, the upper limit on the non-b jet rejection, which can be achieved, is around 500 for \(\epsilon_{b}=50\%\). The ALEPH algorithm appears to work better than the other two in this case. One should note however that, whereas the b-jet to gluon-jet probability ratio was properly derived for gluon jets with long-lived particles (bottom part of fig. 6), the gluon jet probabilities were not recomputed for gluon jets without long-lived particles (top part of fig. 6), and the algorithm does not perform in an optimal way in this case. This limit is really an upper limit, since the probability for a gluon jet to split into a \(b\overline{b}\) or \(c\overline{c}\) pair is not much smaller than 1%;
* in contrast, the bottom part of fig. 6 gives a rejection of \(\sim 70\) against non-bets for \(\epsilon_{b}=50\%\). This is hopefully a lower limit on the final b-tagging performance achievable with ATLAS, since long-lived particles such as \(K^{0}_{s}\) and \(\Lambda\), which are quite abundant even in non-b jets, can be removed to

Figure 8: _Event display for full GEANT simulation (see text)._

a large extent using techniques similar to those of CDF and the LEP experiments. In particular, the ALEPH algorithm, which appears to deviate strongly from the others, should be normally run after removal of K\({}^{0}\), and \(\Lambda\) decays, or more exactly after having replaced their daughters by the corresponding parent particle in the algorithm.

Obviously one of the main thrusts of future work should be on algorithms for secondary vertex reconstruction, in order to improve the non-b jet rejection to values as close as possible to the upper limit given by the heavy-flavour content of non-b jets.

Figure 9: _Gluon-jet rejection versus b-jet efficiency, as obtained by IG using the b-jet to gluon-jet probability ratio method, for various levels of the simulation of the barrel inner detector, equipped with the strip B-layer. The results are shown for generated charged tracks with smeared transverse impact parameters, for gluon jets without (black squares) and with (black circles) secondary decays, and also for reconstructed charged tracks after partial (open squares) and full (open circles) GEANT simulation (see text)._

[MISSING_PAGE_FAIL:14]

performance of the inner detector is not changing dramatically as a function of \(\eta\). The impact of full simulation is however expected to be larger in the more forward regions of the inner detector, particularly for \(1.3<\left|\eta\right|<1.8\), due to the much larger amount of material present in all the elements. Another source of worry concerns the the edge of the rapidity coverage of the inner detector: a significant fraction of charged tracks belonging to jets with \(\left|\eta\right|~{}\sim~{}2.5\) will lie outside the inner detector acceptance, which probably means that the performance will begin to deteriorate for \(\left|\eta\right|~{}>~{}2.1\).

A second example is shown in fig. 11, where the dependence of the b-tagging performance on the efficiency of individual precision tracker layers is shown. Although the silicon strip layers are single-sided, a space-point efficiency was included by SH for each layer. The default values used throughout this note were 94% for the SCT strip layers, 95% for the pixel layers, and 96% for the strip B-layer. These overall efficiencies include geometrical gaps (2% for strips and 3% for pixels), and an individual layer efficiency of 98%. This number was reduced to 91% for the low values of the layer efficiencies used to obtain the results shown in fig. 11. The overall default values quoted above then drop to 80% for

Figure 10: _Gluon-jet rejection versus b-jet efficiency, as obtained by SH using the track counting method, for various \(\eta\)-regions of the inner detector equipped with the strip B-layer._

the SCT strip layers, 88% for the pixel layers and 89% for the strip B-layer. For \(\epsilon_{b}=50\%\), the expected rejection of non-b jets decreases by only \(\sim 15\%\), for this rather large decrease of the individual layer efficiencies. In conclusion, even the stand-alone precision tracker b-tagging performance is quite robust with respect to the individual layer efficiencies.

## 6 Strip versus pixel B-layer

This section is devoted to a first comparison between the strip and pixel proposals for the B-layer. The low-luminosity scenarios used in simulation assume a layer of silicon pixel detectors at \(R=4\) cm or a layer of double-sided crossed micro-strips at \(R=6\) cm. The pixel layer would provide, over the full \(\eta\)-coverage, an accuracy of 5 \(\mu\) or 15 \(\mu\) in \(R\phi\) and of 40 \(\mu\) (resp. 20 \(\mu\)) or 90 \(\mu\) (resp. 130 \(\mu\)) at \(|\eta|=\)0 (resp. \(|\eta|=1\)) in \(z\), for an analog or binary readout respectively. The micro-strip layer would provide, over a more limited \(\eta\)-coverage, an accuracy of 10 \(\mu\) in \(R\phi\) and 20 \(\mu\) in \(z\).

The expected impact parameter resolutions for these layouts are shown in

Figure 11: _Gluon-jet rejection versus b-jet efficiency, as obtained by SH using the track counting method, for the barrel inner detector equipped with the strip B-layer, for the default (open circles) and low (black circles) single layer efficiencies defined in the text._

Table 1, taken from the TP. The parametrisation has the form \(A\,\oplus\,B/\mathrm{p}_{T}\), where \(A\) reflects the detector precision and \(B\) is related to multiple scattering. The second term dominates for low-momentum tracks and is of crucial importance for B-physics studies. The transverse impact-parameter resolutions, \(\sigma_{d}\), are similar for the various low-luminosity layouts considered, since the larger radius of the micro-strip layer is compensated by its lower material thickness (0.55% \(X_{0}\) with respect to 1.0% \(X_{0}\)). The resolution in \(z\) at the point of closest approach to the beam line, \(\sigma_{z}\), is better for the microstrip-detector layer than for the pixel one with binary readout, within the optimistic assumption that a \(z\)-measurement accuracy of 20 \(\mu\) over the full \(\eta\)-coverage can be achieved. The parametrisations shown for \(\sigma_{z}\) are, however, only valid for \(\mathrm{p}_{T}\gtrsim 2\) GeV and underestimate \(\sigma_{z}\) for lower \(\mathrm{p}_{T}\). The studies presented below compare the b-tagging performances of the microstrip B-layer (referred to as the strip B-layer) and of the binary pixel B-layer (referred to as the pixel B-layer) of Table 1.

As shown in figs. 12 and 13, there is very little difference between the strip B-layer and a binary pixel B-layer, at least in terms of the predicted b-tagging performance, whether in the work by IG using partial and full GEANT simulations or in the work by SH. These figures however confirm that the presence of the B-layer is crucial for b-tagging. Figs. 12 (resp. 13) show that, if the B-layer is removed from the layouts studied by IG (resp. SH), the gluon-jet rejection is degraded by a factor \(\sim 5.0\) (resp. \(\sim 2.2\)) for \(\epsilon_{b}=50\%\). In the full GEANT simulations analysed by IG, the B-layer information was not used, but the multiple scattering effects due to its presence probably account for most of the difference with respect to the effect of completely removing the B-layer, as was done by SH and is shown in fig. 13. The much worse performance obtained without the B-layer is hardly surprising, given the much poorer impact parameter resolutions expected in its absence (see Table 1).

Although the presently achieved b-tagging performance does not appear to be sensitive to the exact nature of the B-layer, the individual track reconstruction efficiencies are found to be somewhat different in both simulations, as discussed below:

\begin{table}
\begin{tabular}{|c|c|c|} \hline Vertex detector & \(\sigma_{d}\) (\(\mu\)) & \(\sigma_{z}\) (\(\mu\)) \\ \hline \hline Micro-strips & \(13\,\oplus\,\frac{62}{p_{T}\sqrt{\sin\theta}}\) & \(39\,\oplus\,\frac{90}{p_{T}\sqrt{\sin\theta}}\) \\ \hline Binary pixels & \(18\,\oplus\,\frac{61}{p_{T}\sqrt{\sin\theta}}\) & \(84\,\oplus\,\frac{130}{p_{T}\sqrt{\sin\theta}}\) \\ \hline Analog pixels & \(12\,\oplus\,\frac{52}{p_{T}\sqrt{\sin\theta}}\) & \(52\,\oplus\,\frac{79}{p_{T}\sqrt{\sin\theta}}\) \\ \hline No B-layer & \(27\,\oplus\,\frac{220}{p_{T}\sqrt{\sin\theta}}\) & \(130\,\oplus\,\frac{240}{p_{T}\sqrt{\sin\theta}}\) \\ \hline \end{tabular}
\end{table}
Table 1: _Parametrised impact parameter resolutions for various vertexing configurations of the ATLAS inner detector. The resolutions are given as functions of \(p_{T}\) in GeV and of the polar angle \(\theta\)._* the track reconstruction efficiency as a function of the distance of the nearest neighbour track (fig. 14) and of the jet charged track multiplicity (fig. 15, have been evaluated for both the partial and full GEANT simulations by IG and for both the strip and pixel B-layers. The dotted histograms show the track reconstruction efficiency before selection, which decreases from \(\sim 99.5\%\) to \(\sim 96\%\) when going from partial to full GEANT simulation, but is not sensitive to the vicinity of other tracks nor to the jet charged track multiplicity. The dashed histograms show this efficiency after the selection cuts(described in Section 2), with the same features as above, except for its somewhat lower average values, which decrease from \(\sim 98.5\%\) to \(\sim 93\%\) when going from partial to full GEANT simulation. A small loss of efficiency also appears for large jet charged track multiplicities in the case of full GEANT simulations.

Figure 12: _Gluon-jet rejection versus b-jet efficiency, as obtained by IG using the b-jet to gluon-jet probability ratio method, for the barrel inner detector, equipped with either a strip (black circles) or a pixel (open circles) B-layer. The results are shown after reconstruction for partial (top) and full (bottom) GEANT simulation. Also shown (open squares) in the case of full GEANT simulation (bottom) is the expected performance, in the case where the B-layer information is not used (the material from this layer however was present in the simulation)._

In these studies, the quality of a reconstructed charged track can be probed by counting the number of hits in the precision tracker, which were correctly assigned to it. The full histograms in figs. 14 and 15 represent the efficiency for tracks reconstructed without any incorrect hit assignment, i.e. tracks of the highest possible quality. A significant drop of efficiency is seen for these tracks, both when other charged tracks are in the immediate vicinity (\(\Delta R<0.05\)) and when the jet charged track multiplicity is larger than \(\sim 15\). This loss of efficiency is observed to be larger in the case of the strip B-layer. The tracks, which account for the difference between the dashed and full histograms in figs. 14 and 15, consist mostly of tracks with only one or two misassigned hits. This is demonstrated by fig. 16, which shows, in the case of the full GEANT simulation and of the strip B-layer, that the fraction of reconstructed tracks with more than two misassigned hits in the precision tracker is very small, around 1% for jets with charged track multiplicities of \(\sim 20\). This fraction was found to be below 0.1% in the case of the pixel B-layer.
* similar results, as illustrated by figs. 17, 18, 19, and 20, are observed in the work by SH. These figures show for normalisation purposes the distributions of the distance to the nearest neighbour track and of the jet charged track multiplicity. In the middle and lower parts of these figures are shown

Figure 13: _Gluon-jet rejection versus b-jet efficiency, as obtained by SH using the track counting method, for the barrel inner detector, equipped with either a strip (open circles), a pixel (black circles) B-layer, or without any B-layer (open squares)._

the probabilities for reconstructing so-called good tracks (no misassigned hits), close tracks (one misassigned hit), and lost tracks (more than one misassigned hit) and fake tracks (reconstructed tracks which could not be matched to one of the generated tracks). The same effects are observed by SH, that is larger losses of good tracks in the case of the strip B-layer with respect to the pixel B-layer, especially when the generated track is near the densest part of the jet or in a high multiplicity environment.

Some significant differences are observed between these studies by SH and IG:

* the reconstruction efficiency for good tracks, that is tracks without any misassigned hit in the precision tracker, is somewhat lower for SH than for IG. For example, in the case of a strip B-layer and of jet charged track multiplicities less than \(\sim 10\), SH obtains an average efficiency of \(\sim 87\%\), whereas

Figure 14: _Track reconstruction efficiency versus distance to nearest neighbour track in units of \(\Delta R\), as obtained from the simulations by IG for all reconstructed tracks (dotted histogram), reconstructed tracks with an associated hit in the B-layer (dashed histogram) and for reconstructed tracks with an associated hit in the B-layer and with all associated hits produced by the original generated track (full histogram). The results are shown separately for the strip (left side) and the pixel (right side) B-layer and for partial (top) and full (bottom) GEANT simulations._

IG obtains average efficiencies of 95% (resp. 90%) for partial (resp. full) GEANT simulations. This difference is probably due to the lower single layer efficiencies used by SH, but may also be partly due to the use of the TRT in the pattern recognition.
* the fake track rates observed by SH are much larger than those obtained by IG, even in full simulation. This is probably due in part to the different pattern recognition procedures used by SH and IG, but also in part to the use of the TRT in the case of IG.

It is certainly premature to draw too strong conclusions from all these rather detailed studies. Nevertheless, in the work of both SH and IG, the strip B-layer is observed to be more sensitive to large local track multiplicities, due probably to

Figure 15: _Track reconstruction efficiency versus jet charged track multiplicity in a cone of \(\Delta R=\) 0.4, as obtained from the simulations by IG for all reconstructed tracks (dotted histogram), reconstructed tracks with an associated hit in the B-layer (dashed histogram) and for reconstructed tracks with an associated hit in the B-layer and with all associated hits produced by the original generated track (full histogram). The results are shown separately for the strip (left side) and the pixel (right side) B-layer and for partial (top) and full (bottom) GEANT simulations._

its very long strips. The resulting larger losses of well reconstructed tracks with respect to the pixel B-layer case do not appear to have a serious impact on the b-tagging performances reported here. This is due to the fact that many tracks can contribute to the b-tagging procedure, and also to the somewhat arbitrary definitions of good and fake tracks.

However, the differences described in this Section between the two types of B-layers will surely eventually reflect themselves on the overall b-tagging performance. This should in particular be the case for higher-p\({}_{T}\) jets, for studies at high luminosity, and possibly even as soon as larger rejections against the non-b jets will be achieved using more refined b-tagging algorithms.

## 7 Conclusions

In conclusion, the studies by SH and IG are in remarkable agreement, given the independent and very different approaches taken. For jets of average p\({}_{T}\) of \(\sim\) 50 GeV and with average charged particle multiplicities of \(\sim\) 6, a b-tagging efficiency of 50%, with a rejection of \(\sim\) 50 against gluon jets, has been achieved, using only vertexing, after full simulation and reconstruction in the barrel part of the ATLAS inner detector equipped with a strip B-layer. This value is only 20% worse than that obtained by SH in his stand-alone simulation and by IG in a par

Figure 16: _Probability for reconstructing a track with two or more associated hits not produced by the original generated track versus distance to nearest neighbour track in units of \(\Delta R\) (top) and jet charged track multiplicity in a cone of \(\Delta R\) = 0.4 (bottom), as obtained by IG for full GEANT simulation in the case of the strip B-layer._

tial GEANT simulation, including only multiple scattering and dE/dx processes. The rejection against gluon jets obtained from generated tracks smeared with parametrised transverse impact parameter resolutions is \(\sim 70\) in this case, where long-lived secondary particles are included in the simulation but not accounted for in the reconstruction.

If long-lived secondary particles in the background jets are ignored, a rejection of \(\sim 500\) can be reached for a b-tagging efficiency of 50%. This large potential improvement, which is of course limited at some level by the finite probability of gluon splitting into charm or bottom quark pairs, has to be substantiated by full simulation and reconstruction with appropriate algorithms to reconstruct secondary vertices. These algorithms should give the possibility of:

* identifying K\({}^{0}_{s}\) and \(\Lambda\) decays, in order to, either exclude their daughters from the b-tagging algorithm, or use their reconstructed trajectories instead of their daughters in the b-tagging algorithm;
* reconstructing secondary vertices from B-hadron decay, so as to improve the efficiency of the b-tagging algorithm.

A next step will be to incorporate the \(z\)-information from the tracks, so as to:

* improve the b-tagging algorithm even further, and
* quantify the importance of the impact parameter accuracy in \(z\).

Once optimal b-tagging algorithms will be available, more systematic studies of the ATLAS inner detector performance can proceed:

* operation at high luminosity,
* dependence of performance on pseudorapidity,
* impact of precision tracker single layer efficiency, and
* impact of electronic noise.

These results may be important for the choices of front-end electronics to be done next year for the pixel and strip detectors, but also for the overall balance between the barrel and forward precision tracker layouts.

The robustness of the performance should also be evaluated in a wider context:

* comparison of different pattern recognition procedures, which would in particular bring a quantitative understanding of the importance of the various tracker elements. The most important points of interest are clearly the stand-alone precision tracker performance, possibly with pattern recognition initiated in the pixel layers, and the combined performance of the TRT and the SCT, assuming pixels would be replaced by strips;
* dependence of performance on b-jet p\({}_{T}\). The b-jets of interest may have transverse energies up to \(\sim 200\) GeV in some cases;* dependence of rejection on jet flavour. Reference performance curves for u, d, s and especially charm should be determined from these studies and then used in more detailed and higher-statistics particle-level simulations.

Only once this work has been completed, and supplemented by similar extensive simulations for the soft lepton tags, will a clear and realistic picture emerge of the expected ATLAS b-tagging performance at LHC.

## References

* [1] D. Froidevaux and E. Richter-Was, ATLAS Internal Note PHYS-NO-043, CERN preprint CERN-TH.7459/94.
* [2] E. Richter-Was et al., ATLAS Internal Note PHYS-NO-074.
* [3] F. Abe et al., CDF Collaboration, Phys. Rev. D50 (1994), 2966; F. Abe et al., CDF Collaboration, Phys. Rev. Lett. 73 (1994), 225.
* [4] ATLAS Technical Proposal, see fig. 3.42, p. 98.
* [5] S. Haywood, ATLAS Internal Note INDET-NO-092.
* [6] J. Blocki et al., ATLAS Internal Note INDET-NO-075.
* [7] P. Fischer et al., ATLAS Internal Note INDET-NO-086.
* [8] F. Gianotti, ATLAS Internal Note PHYS-NO-049.
* [9] J. Budagov et al., ATLAS Internal Note TILECAL-NO-062.
* [10] I. Gavrilenko, ATLAS Internal Note INDET-NO-016.
* [11] P. Billoir, Nucl. Inst. and Meth. 225 (1984) 352; P. Billoir, Comput. Phys. Comm. 57 (1989) 380; P. Billoir and S. Qian, Nucl. Inst. and Meth. A291 (1990) 219; R. Fruhwirth, Nucl. Inst. and Meth. A262 (1987) 144; I. Gavrilenko, ATLAS Internal Note INDET-NO-055.
* [12] S. Haywood, ATLAS Internal Note, to be published.
* [13] I. Gavrilenko and D. Froidevaux, ATLAS Internal Note, to be published.
* [14] ALEPH Collaboration, Phys. Lett. B313 (1993) 535.