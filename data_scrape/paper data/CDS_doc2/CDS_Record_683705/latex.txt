# Geometry Reconstruction

using Muon Tracks in

DATCHA CERN

F. Linde, M. Woudstra

F. Linde, M. Woudstra

F. Linde, M. Woudstra

###### Abstract

The geometry of the muon chambers is reconstructed using straight muon tracks. The cross-plates are taken as the basic units to be fitted, with three parameters each (\(\Delta\)z,\(\Delta\)y,\(\Delta\)\(\alpha\)). This gives 7 angular and 12 positional parameters. The fit reproduces known input parameters in a Monte Carlo run within a few sigma. With 50k tracks the cross-plate positions are determined in the sagitta direction with a precision of 10-20 \(\mu\)m. The multiple scattering of 1 mrad is the dominant contribution to the error. Applied to 10 real data runs, the corrected sagitta is consistent with zero all over the BML chamber. The angles between pairs of track segments are also consistent with zero. Using the geometry reconstructed from the muons, the 16 RASNIK systems are calibrated 10 times. The error on this calibration in the sagitta direction is 40-60 \(\mu\)m per run of 50k tracks; the r.m.s. over the 10 runs is 30-160 \(\mu\)m.

* Contact: Martin.Woudstra@cern.chIntroduction

One of the challenges of DATCHA is to test the feasibility of the absolute calibration of the RASNIKs in-situ using straight muon tracks. This can be done in three steps. The first step is to reconstruct the detector geometry from the (straight) muon tracks. The second step is to predict the RASNIK readings from the new positions of the alignment components and to compare these to the RASNIK readings measured. This gives the offsets of the RASNIK coordinates, i.e. the calibration. The calibration is tested in the third step by doing track-by-track sagitta correcction using the RASNIK measurements and then to check whether the average sagitta is zero all over the chamber. This notes deals in detail with the first step: an algorithm to reconstruct the detector geometry from the straight muon tracks. It also gives the RASNIK calibration values from 10 different runs.

Similar work has been published in ATLAS Muon Note 246 [1], where a different algorithm is used to reconstuct the geometry from the muon tracks.

## 2 Choice of Parameters

The tracks that are found depend only on the wire positions, so it suffices to know where the wires are. The wire positions are determined by the wire locators and the gravitional sag in between them. The wire locators are positioned by the cross-plates, and the gravitational sag is known when the wire tension is known. These gravitational sags are already taken into account in the DATCHA muon track reconstruction. Hence the basic units to be fitted are the cross-plates, since they determine the wire positions.

The coordinate system is defined as follows:

\(x\): along the wire,

\(y\): vertical,

\(z\): along the cross-plate,

with rotations \(\alpha\), \(\beta\), \(\gamma\) around the \(x\), \(y\), \(z\) axis respectively.

This gives a priory six degrees of freedom per cross-plate (neglecting cross-plate sag and expansion), or 9x6 =54 degrees of freedom for the total of nine cross-plates. Per cross-plate only three of the six degrees of freedom (y,z,\(\alpha\)) influence (to first order) the wire positions and are thus seen by the tracks, and they are the only ones that can be fitted. This reduces the number of degrees of freedom by a factor of two to 27. The BIL middle cross-plate is irrelevant, since BIL does not have a central wire locator. So we are left with 27-3=24 degrees of freedom. For the angles \(\alpha\) one cross-plate has to be fixed and for the positions y and z two cross-plates have to be fixed. The number of parameters to be fitted is thus 24-1-4=19.

We use upper index '-' for the cross-plate at \(x\) < 0, '0' for the one at \(x\)=0, and '+' for the one at \(x\) > 0; lower index 'i' for BIL,'m' for BML and 'o' for BOL. We denote the displacement and rotation parameters of a cross-plate as \(\Delta z\), \(\Delta y\) and \(\Delta\alpha\). (see figure 1).We take the BML middle cross-plate as a reference for the angles, and the two outer BIL cross-plates as a reference for the positions:

\(\Delta\alpha^{0}_{\rm m}\ =\ \Delta z^{-}_{\rm i}\ =\ \Delta y^{-}_{\rm i}\ =\ \Delta z^{+}_{\rm i}\ =\ \Delta y^{+}_{\rm i}\ =\ 0\,.\)and the 19 parameters are:

BIL: \[\Delta\alpha_{\mathrm{i}}^{-},\,\Delta\alpha_{\mathrm{i}}^{+}\] (2 parameters),

BML: \[\Delta\alpha_{\mathrm{m}}^{-},\,\Delta\alpha_{\mathrm{m}}^{+},\,\Delta z _{\mathrm{m}}^{-},\,\Delta y_{\mathrm{m}}^{-},\,\Delta z_{\mathrm{m}}^{0},\, \Delta y_{\mathrm{m}}^{0},\,\Delta z_{\mathrm{m}}^{+},\,\Delta y_{\mathrm{m}}^ {+}\] (8 parameters),

BOL: \[\Delta\alpha_{\mathrm{o}}^{-},\,\Delta\alpha_{\mathrm{o}}^{0},\,\Delta \alpha_{\mathrm{o}}^{+},\,\Delta z_{\mathrm{o}}^{-},\,\Delta y_{\mathrm{o}}^{-},\,\Delta z_{\mathrm{o}}^{0},\,\Delta y_{\mathrm{o}}^{0},\,\Delta z_{\mathrm{o}}^ {+},\,\Delta y_{\mathrm{o}}^{+}\] (9 parameters).

Figure 1: Choice of parameters and designation of cross-plates.

## 3 Fitting the parameters

The parameters are fitted by minimising the \(\chi^{2}\), which is made up of the information contained in the track segments in each of the three chambers. Denoting the track segments, which are just vectors, by \(\hat{l}\) (see figure 2), the \(\chi^{2}\) is given by

The crucial question is how to define \(\left|\hat{l}-\hat{l}\right|\)?

To make life easier, we separate the fit of the angles from the fit of the positions, and correct the one for the other in between the two fitting stages.

The local displacement (\(\Delta z\),\(\Delta y\)) of a _wire_ is obtained by linear interpolation in \(x\) between the two cross-plates concerned. This is because the angle between the wires and the gravitational field hardly changes. We define \(\hat{x}\) as being the fractional position in \(x\) of the track in a chamber:

\[\hat{x}\ =\ 2\frac{x-x^{0}}{x^{+}-x}\ =\ \frac{2x}{x^{+}-x}\ \text{so that -1}<\hat{x}<+1\.\]

The total \(\chi^{2}\) is the sum of the \(\chi^{2}\)'s of the track segments in all three possible pairs of chambers:

\(\chi^{2}\ =\ \chi^{2}_{\text{i,m}}+\chi^{2}_{\text{o,m}}+\chi^{2}_{\text{i,o}}\)

This \(\chi^{2}\) consists of 8 parts, depending on the chambers concerned and where the track traverses the chambers. \(\chi^{2}_{\text{i,m}}\) and \(\chi^{2}_{\text{i,o}}\) each have 2 parts, and \(\chi^{2}_{\text{m,o}}\) has 4 parts.

Figure 2: The three track segments in the chambers.

## 4 Fitting the angles

The real angle of a track is the measured angle plus a local (i.e. at a certain x) track angle correction. The local rotation of the chamber is a simple linear interpolation between the rotation of the neighbouring cross-plates:

\[\alpha^{\text{real}}\ =\ \alpha^{\text{meas}}+\Delta\alpha(\hat{x})\]

For the three chambers \(\Delta\alpha\) is given by

\[\Delta\alpha_{\text{i}}(\hat{x})\ =\ \frac{1-\hat{x}_{\text{i}}}{2}\cdot\Delta \alpha_{\text{i}}^{-}+\frac{1+\hat{x}_{\text{i}}}{2}\cdot\Delta\alpha_{\text{i }}^{+}, \tag{1a}\] \[\Delta\alpha_{\text{m}}(\hat{x})\ =\ \left\{\begin{array}{ll}\hat{x}_{\text{m}} \cdot\Delta\alpha_{\text{m}}^{+}&\text{for }\hat{x}_{\text{m}}\geq 0\\ -\hat{x}_{\text{m}}\cdot\Delta\alpha_{\text{m}}^{-}&\text{for }\hat{x}_{\text{m}}<0 \end{array}\right.\] (1b) \[\Delta\alpha_{\text{o}}(\hat{x})\ =\ \left\{\begin{array}{ll}(1-\hat{x}_{\text{o}}) \cdot\Delta\alpha_{\text{o}}^{0}+\hat{x}_{\text{o}}\cdot\Delta\alpha_{\text{o }}^{+}&\text{for }\hat{x}_{\text{o}}\geq 0\\ (1+\hat{x}_{\text{o}})\cdot\Delta\alpha_{\text{o}}^{0}-\hat{x}_{\text{o}} \cdot\Delta\alpha_{\text{o}}^{-}&\text{for }\hat{x}_{\text{o}}<0\end{array}\right.. \tag{1c}\]

This gives

\[\alpha_{\text{i}}^{\text{real}}\ =\ \alpha_{\text{i}}^{\text{meas}}+\frac{1- \hat{x}_{\text{i}}}{2}\cdot\Delta\alpha_{\text{i}}^{-}+\frac{1+\hat{x}_{\text {i}}}{2}\cdot\Delta\alpha_{\text{i}}^{+},\]

\[\alpha_{\text{m}}^{\text{real}}\ =\ \alpha_{\text{m}}^{\text{meas}}+\left\{ \begin{array}{ll}\hat{x}_{\text{m}}\cdot\Delta\alpha_{\text{m}}^{+}&\text{ for }\hat{x}_{\text{m}}\geq 0\\ -\hat{x}_{\text{m}}\cdot\Delta\alpha_{\text{m}}^{-}&\text{for }\hat{x}_{\text{m}}<0 \end{array}\right.\text{and}\]

\[\alpha_{\text{o}}^{\text{real}}\ =\ \alpha_{\text{o}}^{\text{meas}}+\left\{ \begin{array}{ll}(1-\hat{x}_{\text{o}})\cdot\Delta\alpha_{\text{o}}^{0}+ \hat{x}_{\text{o}}\cdot\Delta\alpha_{\text{o}}^{+}&\text{for }\hat{x}_{\text{o}}\geq 0\\ (1+\hat{x}_{\text{o}})\cdot\Delta\alpha_{\text{o}}^{0}-\hat{x}_{\text{o}} \cdot\Delta\alpha_{\text{o}}^{-}&\text{for }\hat{x}_{\text{o}}<0\end{array}\right..\]

Although the above equations are exact for a wire, they are only exact for a track segment if the rotation angle is the same all over the track segment. This is true if there is _no torque_ in the chamber _and no rotation_ of the complete chamber around the y and z axes _and no chamber sag_ in y and z (or the track should be vertical in the x-y plane, but that is not an interesting case). Any of these cases will make the rotation angle vary along the track segment, since the track segment extends in x. The exact correction on the angle can only be obtained by re-doing the complete trackfit using displaced wire positions. This is however quite slow. We therefore use two approximations.

1. We correct the track angles before feeding them into the fit. We take two'super-points' on the track, each halfway (in y) either multilayer. These points we move (using the positional parameters) and rotate (with the angular parameters) using the interpolated (exact:!) formulas. From the two new points we calculate the new angle, which is fed into the fit as the'measurement'
2. In the \(\chi^{2}\) itself we use the above simple interpolated formulas.

We now replace the upper index'meas' with the track index number \(k\).

### Fitting BIL - BML

We first deal with the \(\chi^{2}_{\rm i,m}\) part of the \(\chi^{2}\), using track segments in the BIL and BML chamber. The error on the measurement is given by \(\left(\sigma_{\rm i,m}^{k}\right)^{2}=\left(\sigma_{\rm i}^{k}\right)^{2}+ \left(\sigma_{\rm m}^{k}\right)^{2}\), which is dominated by multiple scattering.

\[\chi^{2}_{\rm i,m}\,=\,\sum_{k\,=\,1}^{N}\frac{1}{\left(\sigma_{\rm i,m}^{k} \right)^{2}}\left[\frac{1-\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{ \ast}+\frac{1+\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{+}-\hat{x}_{\rm m }^{k}\cdot\Delta\alpha_{\rm m}^{+}+\left(\alpha_{\rm i}^{k}-\alpha_{\rm m}^{k }\right)\right]^{2}\,\,\,\mbox{for}\,\,\hat{x}_{\rm m}^{k}\geq 0\right.\]

The derivatives of \(\chi^{2}_{\rm i,m}\) are for \(\hat{x}_{\rm m}^{k}\geq 0\) :

\[\frac{\partial\chi^{2}_{\rm i,m}}{\partial\Delta\alpha_{\rm i}^{ \ast}}\,=\,2\sum_{k\,=\,1}^{N}\frac{1}{\left(\sigma_{\rm i,m}^{k}\right)^{2}} \Biggl{[}\frac{1-\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{\ast}+ \frac{1+\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{+}-\hat{x}_{\rm m}^ {k}\cdot\Delta\alpha_{\rm m}^{+}+\left(\alpha_{\rm i}^{k}-\alpha_{\rm m}^{k} \right)\Biggr{]}\cdot\frac{1-\hat{x}_{\rm i}^{k}}{2}\,,\] \[\frac{\partial\chi^{2}_{\rm i,m}}{\partial\Delta\alpha_{\rm i}^{ \ast}}\,=\,2\sum_{k\,=\,1}^{N}\frac{1}{\left(\sigma_{\rm i,m}^{k}\right)^{2}} \Biggl{[}\frac{1-\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{\ast}+ \frac{1+\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{+}-\hat{x}_{\rm m}^ {k}\cdot\Delta\alpha_{\rm m}^{+}+\left(\alpha_{\rm i}^{k}-\alpha_{\rm m}^{k} \right)\Biggr{]}\cdot\frac{1+\hat{x}_{\rm i}^{k}}{2}\,,\] \[\frac{\partial\chi^{2}_{\rm i,m}}{\partial\Delta\alpha_{\rm m}^{ \ast}}\,=\,0\,,\] \[\frac{\partial\chi^{2}_{\rm i,m}}{\partial\Delta\alpha_{\rm m}^{ \ast}}\,=\,2\sum_{k\,=\,1}^{N}\frac{1}{\left(\sigma_{\rm i,m}^{k}\right)^{2}} \Biggl{[}\frac{1-\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{\ast}+ \frac{1+\hat{x}_{\rm i}^{k}}{2}\cdot\Delta\alpha_{\rm i}^{+}-\hat{x}_{\rm m}^ {k}\cdot\Delta\alpha_{\rm m}^{+}+\left(\alpha_{\rm i}^{k}-\alpha_{\rm m}^{k} \right)\Biggr{]}\cdot-\hat{x}_{\rm m}^{k}\,,\] \[\frac{\partial\chi^{2}_{\rm i,m}}{\partial\Delta\alpha_{\rm o}^{ \ast}}\,=\,\frac{\partial\chi^{2}_{\rm i,m}}{\partial\Delta\alpha_{\rm o}^{ \ast}}\,=\,\frac{\partial\chi^{2}_{\rm i,m}}{\partial\Delta\alpha_{\rm o}^{ \ast}}\,=\,0\,.\]

To minimise this \(\chi^{2}\), we set all the derivatives to zero. This can be written in matrix notation as \(A\cdot\overrightarrow{\Delta\alpha}+\hat{b}\,=\,\hat{0}\,\) with \(A\) a symmetric 7x7 matrix, \(\hat{b}\,\) a column vector of size 7, \(\hat{b}\,=\,\hat{b}^{+}+\hat{b}^{-}\,\) and \(A\,=\,A^{+}+A^{-}\,\). The upper index '\(+\)' stands for \(\hat{x}_{\rm m}^{k}\geq 0\), and '\(\cdot\)' stands for \(\hat{x}_{\rm m}^{k}<0\). The matrices and vectors are given in appendix A, and the angles vector is given by

\[\overrightarrow{\Delta\alpha}\,=\,\bigl{[}\Delta\alpha_{\rm i}^{\ast},\,\Delta \alpha_{\rm i}^{+},\,\Delta\alpha_{\rm m}^{\ast},\,\Delta\alpha_{\rm m}^{+},\, \Delta\alpha_{\rm o}^{\ast},\,\Delta\alpha_{\rm o}^{0},\,\Delta\alpha_{\rm o}^ {+}\bigr{]}^{T}\,.\]

### Fitting BIL-BOL

Next we deal with the \(\chi^{2}_{\text{i,o}}\) part, using track segments in the BIL and BOL chamber. The error on the measurement is given by \(\left(\sigma_{\text{i,o}}^{k}\right)^{2}=\left(\sigma_{\text{i}}^{k}\right)^{2 }+\left(\sigma_{\text{o}}^{k}\right)^{2}\), which is dominated by multiple scattering. We follow the same procedure as for BIL-BML.

\[\chi^{2}_{\text{i,o}}=\sum_{k=1}^{N}\frac{1}{\left(\sigma_{\text{i,o}}^{k} \right)^{2}}\left[\frac{\left[1-\hat{x}_{\text{i}}^{k}\right]}{2}\cdot\Delta \alpha_{\text{i}}^{-}+\frac{1+\hat{x}_{\text{i}}^{k}}{2}\cdot\Delta\alpha_{ \text{i}}^{+}-\left(1-\hat{x}_{\text{o}}^{k}\right)\cdot\Delta\alpha_{\text{o} }^{0}-\hat{x}_{\text{o}}^{k}\cdot\Delta\alpha_{\text{o}}^{+}+\left(\alpha_{ \text{i}}^{k}-\alpha_{\text{o}}^{k}\right)\right]^{2}\text{ for }\hat{x}_{\text{o}}^{k}\geq 0\right.\]

The derivatives of \(\chi^{2}_{\text{i,o}}\) are for \(\hat{x}_{\text{o}}^{k}\geq 0\) :

\[\frac{\partial\chi^{2}_{\text{i,o}}}{\partial\Delta\alpha_{\text{i }}^{-}} = 2\sum_{k=1}^{N}\frac{1}{\left(\sigma_{\text{i,o}}^{k}\right)^{2}} \Bigg{[}\frac{1-\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{-}+\frac{1 +\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{+}-\left(1-\hat{x}_{\text{ o}}^{k}\right)\Delta\alpha_{\text{o}}^{0}-\hat{x}_{\text{o}}^{k}\Delta\alpha_{ \text{o}}^{+}+\left(\alpha_{\text{i}}^{k}-\alpha_{\text{o}}^{k}\right)\Bigg{]} \cdot\frac{1-\hat{x}_{\text{i}}^{k}}{2}\] \[\frac{\partial\chi^{2}_{\text{i,o}}}{\partial\Delta\alpha_{ \text{i}}^{+}} = 2\sum_{k=1}^{N}\frac{1}{\left(\sigma_{\text{i,o}}^{k}\right)^{2}} \Bigg{[}\frac{1-\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{-}+\frac{1 +\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{+}-\left(1-\hat{x}_{\text{ o}}^{k}\right)\Delta\alpha_{\text{o}}^{0}-\hat{x}_{\text{o}}^{k}\Delta\alpha_{ \text{o}}^{+}+\left(\alpha_{\text{i}}^{k}-\alpha_{\text{o}}^{k}\right)\Bigg{]} \cdot\frac{1+\hat{x}_{\text{i}}^{k}}{2}\] \[\frac{\partial\chi^{2}_{\text{i,o}}}{\partial\Delta\alpha_{ \text{m}}^{-}} = \frac{\partial\chi^{2}_{\text{i,o}}}{\partial\Delta\alpha_{\text{ m}}^{-}}=\frac{\partial\chi^{2}_{\text{i,o}}}{\partial\Delta\alpha_{\text{o}}^{-}}=0\] \[\frac{\partial\chi^{2}_{\text{i,o}}}{\partial\Delta\alpha_{ \text{o}}^{0}} = 2\sum_{k=1}^{N}\frac{1}{\left(\sigma_{\text{i,o}}^{k}\right)^{2}} \Bigg{[}\frac{1-\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{-}+\frac{1 +\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{+}-\left(1-\hat{x}_{\text{ o}}^{k}\right)\Delta\alpha_{\text{o}}^{0}-\hat{x}_{\text{o}}^{k}\Delta\alpha_{ \text{o}}^{+}+\left(\alpha_{\text{i}}^{k}-\alpha_{\text{o}}^{k}\right)\Bigg{]} \cdot-\left(1-\hat{x}_{\text{o}}^{k}\right)\] \[\frac{\partial\chi^{2}_{\text{i,o}}}{\partial\Delta\alpha_{\text{ o}}^{+}} = 2\sum_{k=1}^{N}\frac{1}{\left(\sigma_{\text{i,o}}^{k}\right)^{2}} \Bigg{[}\frac{1-\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{-}+\frac{1 +\hat{x}_{\text{i}}^{k}}{2}\Delta\alpha_{\text{i}}^{+}-\left(1-\hat{x}_{\text{ o}}^{k}\right)\Delta\alpha_{\text{o}}^{0}-\hat{x}_{\text{o}}^{k}\Delta\alpha_{ \text{o}}^{+}+\left(\alpha_{\text{i}}^{k}-\alpha_{\text{o}}^{k}\right)\Bigg{]} \cdot-\hat{x}_{\text{o}}^{k}.\]

Setting these derivatives to zero can again be expressed in a matrix equation. See appendix A.

[MISSING_PAGE_EMPTY:9]

## 5 Fitting the positions

For the positions we follow a similar procedure as for the angles. The local (in x) correction of a _wire_ position in y _and_ z is again a simple linear interpolation in between the two neighbouring cross-plates, so the real wire positions are given by the following equations, after y\({}^{\text{meas}}\) and z\({}^{\text{meas}}\) have been rotated around the chamber centre by \(\Delta\alpha\) (equations 1a-1c):

\[z_{\text{i}}^{\text{real}} = z_{\text{i}}^{\text{meas}}+\frac{1-\hat{x}_{\text{i}}}{2}\cdot \Delta z_{\text{i}}^{-}+\frac{1+\hat{x}_{\text{i}}}{2}\cdot\Delta z_{\text{i}}^ {+}\,,\] \[y_{\text{i}}^{\text{real}} = y_{\text{i}}^{\text{meas}}+\frac{1-\hat{x}_{\text{i}}}{2}\cdot \Delta y_{\text{i}}^{-}+\frac{1+\hat{x}_{\text{i}}}{2}\cdot\Delta y_{\text{i}}^ {+}\,,\] \[z_{\text{m}}^{\text{real}} = z_{\text{m}}^{\text{meas}}+\left[\begin{array}{c}\hat{x}_{ \text{m}}\cdot\Delta z_{\text{m}}^{+}\text{ \ for }\hat{x}_{\text{m}}\geq 0\\ -\hat{x}_{\text{m}}\cdot\Delta z_{\text{m}}^{-}\text{ \ for }\hat{x}_{\text{m}}<0\end{array}\right.\,,\] \[y_{\text{m}}^{\text{real}} = y_{\text{m}}^{\text{meas}}+\left[\begin{array}{c}\hat{x}_{ \text{m}}\cdot\Delta y_{\text{m}}^{+}\text{ \ for }\hat{x}_{\text{m}}\geq 0\\ -\hat{x}_{\text{m}}\cdot\Delta y_{\text{m}}^{-}\text{ \ for }\hat{x}_{\text{m}}<0\end{array}\right.\,,\] \[z_{\text{o}}^{\text{real}} = z_{\text{o}}^{\text{meas}}+\left[\begin{array}{c}(1-\hat{x}_{ \text{o}})\cdot\Delta z_{\text{o}}^{0}+\hat{x}_{\text{o}}\cdot\Delta z_{\text {o}}^{+}\text{ \ for }\hat{x}_{\text{o}}\geq 0\\ (1+\hat{x}_{\text{o}})\cdot\Delta z_{\text{o}}^{0}-\hat{x}_{\text{o}}\cdot \Delta z_{\text{o}}^{-}\text{ \ for }\hat{x}_{\text{o}}<0\end{array}\right.\,,\] \[y_{\text{o}}^{\text{real}} = y_{\text{o}}^{\text{meas}}+\left[\begin{array}{c}(1-\hat{x}_{ \text{o}})\cdot\Delta y_{\text{o}}^{0}+\hat{x}_{\text{o}}\cdot\Delta y_{\text {o}}^{+}\text{ \ for }\hat{x}_{\text{o}}\geq 0\\ (1+\hat{x}_{\text{o}})\cdot\Delta y_{\text{o}}^{0}-\hat{x}_{\text{o}}\cdot \Delta y_{\text{o}}^{-}\text{ \ for }\hat{x}_{\text{o}}<0\end{array}\right.\,.\]

The displacement of the track segment is equal to the wire displacement given by the equations above if and only if the total displacement is the same all over the track. Total meaning here the displacement because of \(\Delta\)y, \(\Delta\)z, _and rotation_\(\Delta\alpha\). The approach is therefore the same as for the angles. We make two approximations:

1. We correct the track angles before feeding them into the fit. We take two'super-points' on the track, each halfway (in y) either multilayer. These points we move (using the positional parameters) and rotate (with the angular parameters) using the interpolated (exact!) formulas. From the two new points we calculate the new track positions in y and z, which is fed into the fit as the'measurement'
2. In the \(\chi^{2}\) itself we use the above simple interpolated formulas.

In the \(\chi^{2}\) we have to put somehow the distance between the track segments in the chambers.

In principle the angles of the track segments should be the same for one track. This is however not true because of multiple scattering. But we know that they should be the same, so we force the angles of the two track segments to be the average of all three (corrected) angles: \(\overline{\alpha}\). Then the \(\chi^{2}\) is simply the square of the distance between two parallel lines!

The distance between two parallel lines can be calculated directly using vector algebra and is given by (see figure 3):

\[d\;=\;\left|(\hat{v}_{i}-\hat{v}_{m})\bullet\hat{\alpha}^{\perp}\right|\,,\]

where \(\hat{v}_{i}\) and \(\hat{v}_{m}\) are the supports vector w.r.t. an arbitrary zero ('O') and \(\hat{\alpha}^{\perp}\) the unit vector perpendicular to the direction vector \(\hat{\alpha}\).

### Fitting BIL-BML

We first take the track segments in BIL and BML with direction vector

\[\hat{\sigma}_{\text{i,m}}\,=\,\begin{bmatrix}\cos(\overline{\alpha})\\ \sin(\overline{\alpha})\end{bmatrix}\]

and support vectors

\[\hat{v}_{\text{i}}\,=\,\begin{bmatrix}z_{\text{i}}\\ y_{\text{i}}\end{bmatrix},\]

\[\hat{v}_{\text{m}}^{+}\,=\,\begin{bmatrix}z_{\text{m}}+(1-\hat{x}_{\text{m}}) \Delta z_{\text{m}}^{0}+\hat{x}_{\text{m}}\Delta z_{\text{m}}^{+}\\ y_{\text{m}}+(1-\hat{x}_{\text{m}})\Delta y_{\text{m}}^{0}+\hat{x}_{\text{m}} \Delta y_{\text{m}}^{+}\end{bmatrix}\quad(\hat{x}_{\text{m}}\geq 0)\,,\]

\[\hat{v}_{\text{m}}^{-}\,=\,\begin{bmatrix}z_{\text{m}}+(1+\hat{x}_{\text{m}}) \Delta z_{\text{m}}^{0}-\hat{x}_{\text{m}}\Delta z_{\text{m}}\\ y_{\text{m}}+(1+\hat{x}_{\text{m}})\Delta y_{\text{m}}^{0}-\hat{x}_{\text{m}} \Delta y_{\text{m}}^{-}\end{bmatrix}\quad(\hat{x}_{\text{m}}<0)\,.\]

where (\(z_{\text{i}}\),\(y_{\text{i}}\)) and (\(z_{\text{m}}\),\(y_{\text{m}}\)) are arbitrary points on the extrapolated track segment. The distance between the two lines is now simply \(\left|(\hat{v}_{\text{i}}-\hat{v}_{\text{m}})\bullet\hat{\alpha}^{\perp}\right|\).

The \(\chi^{2}\) is given by the square of this, with the upper indices'meas' are replaced by the upper index \(k\) (so \(k\) is _not_ a power!):

with the error

\[\left(\sigma_{\text{i,m}}^{k}\right)^{2}\,=\,\left((z_{\text{i}}^{k}-z_{\text {m}}^{k})^{2}+(y_{\text{i}}^{k}-y_{\text{m}}^{k})^{2}\right)\left(\sigma_{ \overline{\alpha}}^{k}\right)^{2}+\left(\sigma_{\text{pos,i}}^{k}\right)^{2}+ \left(\sigma_{\text{pos,m}}^{k}\right)^{2}\,, \tag{2}\]

where \(\sigma_{\alpha}\) is dominated by multiple scattering and gives the major contribution to the error; \(\sigma_{\text{pos}}\) is the positional error perpendicular to the track.

[MISSING_PAGE_EMPTY:13]

[MISSING_PAGE_EMPTY:14]

[MISSING_PAGE_EMPTY:15]

[MISSING_PAGE_EMPTY:16]

## 6 Results

### Monte Carlo Results

The algorithm as describes is implemented in C++, and is tested on a Monte Carlo of the DATCHA set-up which is produced using ARVE/GISMO [3]. The tracks were reconstructed using the DATCHA muon track reconstruction [2] in the mutdat framework [4]. In the track reconstruction we start from the ideal geometry and displace the positions of the hits using the cross-plate parameters before doing the reconstruction. This way we generate a 'distorted' DST file with track segments. The auto-calibrated r-t relation of the Monte Carlo is used. The first 60.000 tracks of MC run 3 are used to find back the input cross-plate parameters using the muon geometry fit. All cross-plates (that are not fixed in the fit) are moved in y and z and rotated around x (order mm and mrad). The y and z parameters per cross-plate are 99% correlated, as can be seen in table 1. This is because the tracks all have an angle of about -117 degrees with respect to the cross-plates. It is therefore not useful to compare the input/output parameters in y and z. Instead, we compare displacements in the sagitta direction ("sag") and in the direction 'parallel' to the tracks ("par").

These values are obtained by rotating the coordinate system around x with the ideal average angle of the tracks, which is determined by the centres of the BIL and BOL chambers (in the ideal geometry), i.e. -117 degrees. Table 2 shows the input and output values in this rotated coordinate system. The angles are of course not influenced by this transformation. The correlations between those rotated parameters are shown in table 3 and table 4. Indeed the correlations are small in this coordinate system.

The fit reproduces the input parameters within a few sigma (see table 2), which is good considering the fact that the auto-calibrated r-t relation was used, which is known to have some (small) systematics [2]. This gives confidence in the fit, and now we can start fitting real data, which is the subject of the next section.

[MISSING_PAGE_EMPTY:18]

\begin{table}
\begin{tabular}{|l||r|r|r|r|r|} \hline Parameter & Input Value & Fit Value & Error & Difference & Diff/Error \\ \hline \(\Delta\alpha_{i}^{-}\) **(mrad)** & 1.000 & 1.003 & 0.011 & 0.003 & 0.30 \\ \hline \(\Delta\alpha_{i}^{+}\) **(mrad)** & -1.000 & -1.008 & 0.011 & -0.008 & -0.72 \\ \hline \(\Delta\alpha_{\text{m}}^{-}\) **(mrad)** & -2.000 & -1.999 & 0.019 & 0.001 & 0.04 \\ \hline \(\Delta\alpha_{\text{m}}^{+}\) **(mrad)** & 2.000 & 2.017 & 0.019 & 0.017 & 0.90 \\ \hline \(\Delta\alpha_{\text{o}}^{-}\) **(mrad)** & 3.000 & 2.983 & 0.016 & -0.017 & -1.10 \\ \hline \(\Delta\alpha_{\text{o}}^{0}\) **(mrad)** & 1.000 & 1.009 & 0.008 & 0.009 & 1.09 \\ \hline \(\Delta\alpha_{\text{o}}^{+}\) **(mrad)** & -1.000 & -0.998 & 0.016 & 0.002 & 0.12 \\ \hline \(\Delta sag_{\text{m}}^{-}\) **(mm)** & -2.236 & -2.224 & 0.019 & 0.012 & 0.64 \\ \hline \(\Delta par_{\text{m}}^{-}\) **(mm)** & -0.016 & 0.003 & 0.264 & 0.020 & 0.08 \\ \hline \(\Delta sag_{\text{m}}^{0}\) **(mm)** & -0.891 & -0.899 & 0.010 & -0.008 & -0.84 \\ \hline \(\Delta par_{\text{m}}^{0}\) **(mm)** & -0.454 & -0.679 & 0.141 & -0.225 & -1.60 \\ \hline \(\Delta sag_{\text{m}}^{+}\) **(mm)** & -2.220 & -2.238 & 0.019 & -0.019 & -1.01 \\ \hline \(\Delta par_{\text{m}}^{+}\) **(mm)** & -2.253 & -2.288 & 0.267 & -0.036 & -0.13 \\ \hline \(\Delta sag_{\text{o}}^{-}\) **(mm)** & 1.345 & 1.407 & 0.022 & 0.062 & 2.81 \\ \hline \(\Delta par_{\text{o}}^{-}\) **(mm)** & -0.437 & -0.708 & 0.315 & -0.270 & -0.86 \\ \hline \(\Delta sag_{\text{o}}^{0}\) **(mm)** & 1.766 & 1.719 & 0.014 & -0.046 & -3.31 \\ \hline \(\Delta par_{\text{o}}^{0}\) **(mm)** & 3.144 & 2.856 & 0.198 & -0.288 & -1.45 \\ \hline \(\Delta sag_{\text{o}}^{+}\) **(mm)** & 1.328 & 1.263 & 0.022 & -0.065 & -2.96 \\ \hline \(\Delta par_{\text{o}}^{+}\) **(mm)** & 1.799 & 1.125 & 0.318 & -0.674 & -2.12 \\ \hline \end{tabular} \(\text{sag}=\text{sagitta}\) direction, \(\text{par}=\text{parallel}\) to track direction

\end{table}
Table 2: Monte Carlo comparison rotated input and fitted parameters
\begin{table}
\begin{tabular}{|c||c|c|c|c|c|c|c|c|c|} \hline \hline \(\Delta sag_{\mathrm{m}}^{-}\) & 1.000 & & & & & & & & & \\ \hline \(\Delta par_{\mathrm{m}}^{-}\) & -0.168 & 1.000 & & & & & & & & \\ \hline \(\Delta sag_{\mathrm{m}}^{0}\) & -0.427 & 0.071 & 1.000 & & & & & & \\ \hline \(\Delta par_{\mathrm{m}}^{0}\) & 0.070 & -0.427 & -0.154 & 1.000 & & & & & \\ \hline \(\Delta sag_{\mathrm{m}}^{+}\) & 0.189 & -0.031 & -0.428 & 0.067 & 1.000 & & & & \\ \hline \(\Delta par_{\mathrm{m}}^{+}\) & -0.031 & 0.189 & 0.066 & -0.428 & -0.155 & 1.000 & & & & \\ \hline \(\Delta sag_{\mathrm{o}}^{-}\) & 0.472 & -0.076 & -0.126 & 0.020 & 0.045 & -0.007 & 1.000 & & & \\ \hline \(\Delta par_{\mathrm{o}}^{-}\) & -0.076 & 0.470 & 0.020 & -0.126 & -0.007 & 0.044 & -0.154 & 1.000 & & & \\ \hline \(\Delta sag_{\mathrm{o}}^{0}\) & -0.158 & 0.028 & 0.462 & -0.074 & -0.159 & 0.027 & -0.353 & 0.058 & 1.000 & & \\ \hline \(\Delta par_{\mathrm{o}}^{0}\) & 0.028 & -0.155 & -0.074 & 0.460 & 0.027 & -0.156 & 0.059 & -0.351 & -0.166 & 1.000 & & \\ \hline \(\Delta sag_{\mathrm{o}}^{+}\) & 0.043 & -0.006 & -0.125 & 0.017 & 0.469 & -0.069 & 0.132 & -0.020 & -0.355 & 0.055 & 1.000 & \\ \hline \(\Delta par_{\mathrm{o}}^{+}\) & -0.006 & 0.042 & 0.017 & -0.123 & -0.068 & 0.467 & -0.020 & 0.130 & 0.054 & -0.354 & -0.136 & 1.000 \\ \hline \hline \end{tabular}
\end{table}
Table 4: Correlation matrix of rotated position parameters (Monte Carlo)

### Geometry fit results of real data

Data run numbers 2011 - 2020 (see appendix A of [2]) have been fit. Each run has about 50k tracks (except 2017: 26k). The parameter values (again in the rotated coordinate system) are given in table 5. The correlation matrices are given in table 6 and table 7. The errors on the angles are of the order of 10 \(\upmu\)rad, and on the positions a few tens of \(\upmu\)m in the sagitta direction and a few hundred \(\upmu\)m 'parallel' to the tracks. The \(\chi^{2}\)/d.o.f. is 0.93 for the angle fits and 1.3 for the position fits.

The main check on the consistency of the fit comes from the sagitta values. These should be zero all over the chamber. The cross-plate parameters found in the fit are fed back into the trackfit, where the parameters are used to correct each hit position before the trackfit is done. This is a sure and robust test of the fitesults. As an example this is done for run 2015. Figure 4 shows the sagitta distribution before and after the fit. The average sagitta is about -8 mm before any corrections are made. After the geometry fit the mean of a gauss fit on the sagitta distribution is \(1.5\pm 5\)\(\upmu\)m, which is a reduction of four orders of magnitude. Remember that we do not fit the sagitta directly. The r.m.s. of 1.7 mm is mainly caused by multiple scattering. The average sagitta vs the normalised x (along the wire) and z (perpendicular to the wire) of the impact point in the BML chamber is shown in figure 5. The sagitta is consistent with zero all over the chamber surface. Figure 6

shows the distributions of the angle differences between pairs of chambers. These are the quantities that go into the \(\chi^{2}\), and should be consistent with zero, which they are.

To get higher statistics the corrected sagittas and angles of all 10 runs are combined into one histogram. To gain time, these histograms are not filled inside the full-blown trackfit, but in the geometry fit using the approximated corrections as used in the fit ('superpoints', see sections 4 and 5). The histograms made in this way agree well with the ones obtained from the complete trackfit. Figures 7 through 9 show, for the combined 10 runs, the sagitta distribution, the average sagitta vs x and z of BML, and the angle differences distributions. The exponential function

\(y=const\cdot e^{-\frac{|x-mean|}{width}}\) fitted to the correction sagitta distribution has a mean of - 0.9 \(\pm\) 1.4 \(\upmu\)m, which is consistent with zero. The average sagitta is zero within the statistical error of 5-10 \(\upmu\)m all over BML. For completeness, figures 10 through 12 show the average of the angle differences as a function of the normalised x and z of the respective chambers. The distributions are flat as a function of x. There seem to be some systemetics left as a function of z.

\begin{table}
\begin{tabular}{|c||c||c|c|c|c|c|c|c|c|c|c|} \hline Run & Error & **2011** & **2012** & **2013** & **2014** & **2015** & **2016** & **2017** & **2018** & **2019** & **2020** \\ \hline
**Param.** & **mrad** & **mrad** & **mrad** & **mrad** & **mrad** & **mrad** & **mrad** & **mrad** & **mrad** & **mrad** \\ \hline \hline \(\Delta\alpha_{\text{i}}^{-}\) & 0.012 & 1.217 & 1.168 & 1.176 & 1.211 & 1.233 & 1.254 & 1.239 & 1.219 & 1.213 & 1.205 \\ \hline \(\Delta\alpha_{\text{i}}^{+}\) & 0.012 & 2.519 & 2.515 & 2.520 & 2.560 & 2.553 & 2.542 & 2.546 & 2.577 & 2.565 & 2.578 \\ \hline \(\Delta\alpha_{\text{m}}^{-}\) & 0.02 & 0.048 & 0.045 & 0.053 & 0.043 & 0.046 & 0.054 & 0.037 & 0.007 & 0.052 & 0.122 \\ \hline \(\Delta\alpha_{\text{m}}^{+}\) & 0.02 & 0.097 & 0.059 & 0.073 & 0.050 & 0.091 & 0.105 & 0.049 & 0.092 & 0.094 & 0.099 \\ \hline \(\Delta\alpha_{\text{o}}^{-}\) & 0.019 & 1.151 & 1.113 & 1.162 & 1.194 & 1.185 & 1.186 & 1.203 & 1.189 & 1.186 & 1.176 \\ \hline \(\Delta\alpha_{\text{o}}^{0}\) & 0.008 & 1.397 & 1.391 & 1.377 & 1.428 & 1.451 & 1.437 & 1.447 & 1.436 & 1.419 & 1.425 \\ \hline \(\Delta\alpha_{\text{o}}^{+}\) & 0.019 & 1.370 & 1.328 & 1.333 & 1.364 & 1.361 & 1.381 & 1.353 & 1.384 & 1.363 & 1.376 \\ \hline \hline
**Param.** & **mm** & **mm** & **mm** & **mm** & **mm** & **mm** & **mm** & **mm** & **mm** & **mm** \\ \hline \hline \(\Delta sag_{\text{m}}^{-}\) & 0.02 & -9.36 & -9.30 & -9.38 & -9.40 & -9.44 & -7.79 & -8.66 & -11.15 & -10.22 & -8.54 \\ \hline \(\Delta par_{\text{m}}^{-}\) & 0.4 & -4.8 & -3.4 & -4.2 & -2.7 & -3.2 & -3.1 & -4.9 & -6.0 & -5.1 & -3.9 \\ \hline \(\Delta sag_{\text{m}}^{0}\) & 0.011 & -10.898 & -10.749 & -11.033 & -11.278 & -10.808 & -8.996 & -9.936 & -12.515 & -11.571 & -9.984 \\ \hline \(\Delta par_{\text{m}}^{0}\) & 0.19 & -6.23 & -6.28 & -5.35 & -5.72 & -6.47 & -5.54 & -5.86 & -6.71 & -7.03 & -6.55 \\ \hline \(\Delta sag_{\text{m}}^{+}\) & 0.02 & -13.84 & -13.47 & -14.08 & -14.42 & -13.50 & -11.71 & -12.53 & -15.22 & -14.26 & -12.63 \\ \hline \(\Delta par_{\text{m}}^{+}\) & 0.4 & -6.1 & -6.1 & -5.4 & -3.9 & -6.1 & -5.4 & -4.9 & -7.3 & -6.7 & -7.1 \\ \hline \(\Delta sag_{\text{o}}^{-}\) & 0.03 & -2.33 & -2.12 & -2.29 & -2.55 & -2.68 & -2.64 & -2.60 & -2.48 & -2.60 & -2.48 \\ \hline \(\Delta par_{\text{o}}^{-}\) & 0.5 & 0.3 & 1.1 & 0.0 & 3.7 & 3.0 & 0.7 & 0.7 & 0.3 & -0.1 & 1.6 \\ \hline \(\Delta sag_{\text{o}}^{0}\) & 0.015 & -6.673 & -6.561 & -6.573 & -6.854 & -6.933 & -6.933 & -6.918 & -6.933 & -6.856 & -6.971 \\ \hline \(\Delta par_{\text{o}}^{0}\) & 0.3 & 0.1 & -0.1 & 0.4 & -0.1 & -0.1 & 0.1 & -0.3 & 0.8 & 0.0 & -1.0 \\ \hline \(\Delta sag_{\text{o}}^{+}\) & 0.03 & -12.42 & -12.13 & -12.19 & -12.43 & -12.72 & -12.66 & -12.37 & -12.6

\begin{table}
\begin{tabular}{|c||c|c|c|c|c|c|c|c|c|} \hline \hline \(\Delta\alpha_{\mathrm{i}}^{-}\) & 1.000 & & & & & & & & & \\ \hline \(\Delta\alpha_{\mathrm{i}}^{+}\) & -0.326 & 1.000 & & & & & & & \\ \hline \(\Delta\alpha_{\mathrm{i}}^{-}\) & 0.687 & 0.071 & 1.000 & & & & & \\ \hline \(\Delta\alpha_{\mathrm{m}}^{+}\) & 0.078 & 0.688 & 0.295 & 1.000 & & & & \\ \hline \(\Delta\alpha_{\mathrm{o}}^{-}\) & 0.547 & 0.023 & 0.713 & 0.193 & 1.000 & & & \\ \hline \(\Delta\alpha_{\mathrm{o}}^{0}\) & 0.194 & 0.237 & 0.266 & 0.305 & -0.086 & 1.000 & & \\ \hline \(\Delta\alpha_{\mathrm{o}}^{+}\) & 0.041 & 0.537 & 0.205 & 0.707 & 0.229 & -0.063 & 1.000 \\ \hline \hline \end{tabular}
\end{table}
Table 6: Correlation matrix of angle parameters (Real Data)Figure 4: Sagitta distribution of one run before (left) and after (right) fit.

Figure 5: Average sagitta of one run vs normalised x and z of BML.

Figure 6: Angle differences of one run between track segments in pairs of chambers.

Figure 8: Average sagitta of 10 runs as a function of normalised X and Z of BML.

Figure 7: Sagitta distribution of 10 runs after geometry fits.

Figure 9: Angle differences distributions of 10 runs after geometry fit.

Figure 12: Average angle differences of 10 runs between tracks in BOL and the other two chambers vs the normalised x and z of BOL.

### Calibration of the 16 RASNIK systems

Now the geometry has been found using the muon tracks, the RASNIK systems can be calibrated. This is done by calculating the rasnik component positions and rotations based on the ideal geometry using the parameters found in the muon geometry fits. The RASNIK readings can now be predicted and the difference between these predicted readings and the measured readings give directly the RASNIK calibration values. Tables 9 through 11 show the values of x,y and the rotation around z (RASNIK coordinate system) for the 16 RASNIK systems (3x4 in-plane and 4 projective). It also lists the calibration value in the sagitta direction, since this is the one we really determine in the fit (the x and y calibration values are 99% correlated!).

As a reminder of the RASNIK coordinate system:

\begin{tabular}{l l} in-plane:RASNIK & \(<\!\!-\!>\) & Global \\ x & -z \\ y & y \\ rotZ & rotX \\ \end{tabular}

projective: RASNIK & \(<\!\!-\!>\) & Global \\ x & \(\sim\)sagitta \\ y & \(\sim\)wire \\ \end{tabular}

The errors on the calibration values are calculated from the errrors on the crossplate parameters, taking into account the correlations between those parameters. The calibration is done on all 10 runs. The r.m.s. of the calibration values are almost all twice as large as the errors. It is not clear why. The calibration in the relevant (=sagitta) direction has an error of 40-60 \(\upmu\)m per system per run of 50k reconstructed tracks, which is not sufficient for ATLAS (dominant error is due to multiple scattering of 1.7 mm r.m.s. which will be much smaller in ATLAS). We would like to obtain an error at least a factor of 3 smaller, so 10x more statistics are needed. The uncertainty on the average calibration values of the 10 runs is 25-45 \(\upmu\)m. In the present case we can combine runs to increase statistics, but it is more elegant to calibrate with high statistics per chamber position.

\begin{table}
\begin{tabular}{|l||l||l|l||l|l|l|l|l|l|l|l|l|l|l|} \hline  & error & average & r.m.s. & **2011** & **2012** & **2013** & **2014** & **2015** & **2016** & **2017** & **2018** & **2019** & **2020** \\ \hline \hline
**bil0\_x** & 5.6 & 0.0 & -7 & -2 & -3 & -1 & 4 & 2 & 1 & 1 & 6 & 0 \\ \hline
**bil0\_y** & & 11.5 & 0.0 & 0 & -1 & 1 & 1 & -1 & 0 & 1 & 0 & -1 & 1 \\ \hline
**bil0\_rot2** & 0.019 & 4.171 & 0.030 & -62 & 9 & 0 & 15 & 1 & -32 & -27 & 30 & 24 & 41 \\ \hline
**bil1\_x** & & 6.7 & 0.0 & -7 & -2 & -3 & -1 & 4 & 2 & 1 & 1 & 5 & 0 \\ \hline
**bil1\_y** & & 13.8 & 0.0 & 2 & -2 & 0 & 0 & 0 & 2 & 3 & -2 & -2 & -1 \\ \hline
**bil1\_rot2** & 0.019 & -12.121 & 0.032 & -55 & -4 & -10 & 2 & 13 & -36 & -24 & 25 & 51 & 39 \\ \hline
**bil2\_x** & & 6.7 & 0.0 & -7 & -3 & -3 & -1 & 4 & 2 & 1 & 1 & 5 & 0 \\ \hline
**bil2\_y** & & 13.8 & 0.0 & -3 & 0 & 1 & 2 & -2 & -4 & -1 & 1 & 0 & 4 \\ \hline
**bil2\_rot2** & 0.019 & -0.143 & 0.029 & -53 & 12 & 11 & 16 & -7 & -41 & -27 & 29 & 19 & 37 \\ \hline
**bil3\_x** & & 5.8 & 0.0 & -8 & -3 & -3 & -1 & 4 & 2 & 1 & 1 & 5 & 1 \\ \hline
**bil3\_y** & & 13.3 & 0.0 & 0 & 0 & 1 & 1 & -1 & -1 & 1 & 0 & -1 & 1 \\ \hline
**bil3\_rot2** & 0.019 & -12.483 & 0.037 & -78 & 27 & 24 & 26 & -14 & -43 & -24 & 23 & 13 & 47 \\ \hline \end{tabular} Columns: error from muon fit (mm,mrad), average of the 10 runs (mm,mrad), r.m.s. of the 10 runs (mm,mrad), difference between each run and the average (\(\upmu\)m,mrad). \(\_\)sag=-sagitta direction

\end{table}
Table VIII: RASNIK calibration values of BIL in-plane systems.

\begin{table}
\begin{tabular}{|l||l|l|l|l|l|l|l|l|l|l|l|l|l|} \hline  & error & average & rms & **2011** & **2012** & **2013** & **2014** & **2015** & **2016** & **2017** & **2018** & **2019** & **2020** \\ \hline \hline
**bml0\_x** & 0.4 & 6.7 & 0.6 & -382 & 388 & -651 & 1204 & 622 & -26 & -173 & -1013 & -8 & 37 \\ \hline
**bml0\_y** & 0.8 & 14.0 & 1.1 & -581 & 605 & -1145 & 2184 & 1180 & 354 & -396 & -2000 & -18 & -183 \\ \hline
**bml0\_rot2** & 0.03 & 9.35 & 0.02 & -2 & -19 & -15 & -29 & 12 & 14 & -12 & 47 & 0 & 2 \\ \hline
**bml1\_x** & 0.4 & 10.2 & 0.6 & -386 & 389 & -650 & 1204 & 623 & -25 & -172 & -1011 & -6 & 36 \\ \hline
**bml1\_y** & 0.8 & 14.1 & 1.1 & -600 & 628 & -1136 & 2221 & 1170 & 328 & -357 & -1999 & -32 & -223 \\ \hline
**bml1\_rot2** & 0.03 & 0.25 & 0.03 & 7 & -11 & -8 & -27 & 17 & 22 & -19 & 61 & 11 & -55 \\ \hline
**bml2\_x** & 0.4 & 9.0 & 0.6 & -388 & 387 & -651 & 1204 & 622 & -26 & -172 & -1012 & -7 & 42 \\ \hline
**bml2\_y** & 0.8 & 12.0 & 1.1 & -579 & 610 & -1146 & 2189 & 1185 & 351 & -385 & -1965 & -20 & -240 \\ \hline
**bml2\_rot2** & 0.03 & 8.28 & 0.02 & 14 & -10 & -10 & -23 & 14 & 14 & -14 & 55 & 2 & -40 \\ \hline
**bml3\_x** & 0.4 & 7.7 & 0.6 & -388 & 388 & -650 & 1204 & 622 & -27 & -172 & -1012 & -6 & 42 \\ \hline
**bml3\_y** & 0.8 & 13.7 & 1.1 & -598 & 634 & -1139 & 2226 & 1175 & 325 & -346 & -1964 & -31 & -281 \\ \hline
**bml3\_rot2** & 0.03 & -4.99 & 0.03 & 25 & -9 & -13 & -33 & 11 & 23 & -20 & 61 & 7 & -53 \\ \hline
**bml0\_sag** & _0.05_ & _0.41_ & _0.08_ & _-76_ & _72_ & _-60_ & _82_ & _19_ & _-184_ & _26_ & \(5\) & \(1\) & _116_ \\ \hline
**bml1\_sag** & _0.05_

\begin{table}
\begin{tabular}{l||l|l|l|l|l|l|l|l|l|l|l|l|l|l|l} \hline \hline \multicolumn{1}{|l||}{**system/run**} & \multicolumn{1}{l|}{**error**} & \multicolumn{1}{l|}{**average**} & \multicolumn{1}{l|}{**rms**} & \multicolumn{1}{l|}{**2011**} & \multicolumn{1}{l|}{**2012**} & \multicolumn{1}{l|}{**2013**} & \multicolumn{1}{l|}{**2014**} & \multicolumn{1}{l|}{**2015**} & \multicolumn{1}{l|}{**2016**} & \multicolumn{1}{l|}{**2017**} & \multicolumn{1}{l|}{**2018**} & \multicolumn{1}{l|}{**2019**} & \multicolumn{1}{l|}{**2020**} \\ \hline
**bol0\_x** & 0.5 & 5.3 & 1.1 & -1753 & 609 & -1309 & 1767 & 980 & -207 & 1310 & -1262 & -428 & 294 \\ \hline
**bol0\_y** & 1.0 & 10.0 & 2.1 & -3176 & 777 & -2449 & 3411 & 2366 & -112 & 2188 & -2598 & -436 & 29 \\ \hline
**bol0\_rotZ** & 0.02 & -12.86 & 0.03 & 48 & 33 & -29 & -16 & -5 & 11 & -39 & 15 & -13 & -2 \\ \hline
**bol1\_x** & 0.5 & 7.9 & 1.1 & -1752 & 608 & -1309 & 1767 & 982 & -206 & 1309 & -1263 & -425 & 290 \\ \hline
**bol1\_y** & 1.0 & 12.9 & 2.2 & -3236 & 800 & -2494 & 3415 & 2436 & -117 & 2253 & -2613 & -450 & 6 \\ \hline
**bol1\_rotZ** & 0.02 & -9.33 & 0.03 & 40 & 45 & -20 & -13 & -8 & 5 & -43 & 20 & 4 & -30 \\ \hline
**bol2\_x** & 0.5 & 5.4 & 1.1 & -1750 & 610 & -1308 & 1767 & 981 & -208 & 1307 & -1263 & -425 & 289 \\ \hline
**bol2\_y** & 1.0 & 11.9 & 2.1 & -3173 & 824 & -2494 & 3394 & 2395 & -107 & 2183 & -2598 & -456 & 33 \\ \hline
**bol2\_rotZ** & 0.02 & -13.29 & 0.08 & -89 & 48 & 133 & 127 & -10 & -40 & 8 & -48 & -4 & -122 \\ \hline
**bol3\_x** & 0.5 & 8.8 & 1.1 & -1752 & 609 & -1309 & 1766 & 980 & -208 & 1310 & -1263 & -424 & 293 \\ \hline
**bol3\_y** & 1.0 & 13.8 & 2.2 & -3234 & 848 & -2539 & 3397 & 2466 & -112 & 2248 & -2613 & -469 & 9 \\ \hline
**bol3\_rotZ** & 0.02 & -12.96 & 0.03 & 54 & 17 & -26 & -32 & -31 & 12 & -36 & 3 & -25 & 65 \\ \hline
**bol0\_sag** & _0.06_ & _0.22_ & _0.16_ & _-121_ & _190_ & _-55_ & _27_ & _-200_ & _-133_ & _174_ & _54_ & _-183_ & _249_ \\ \hline
**bol1\_sag** & _0.06_ & _1.18_ & _0.15_ & _-93_ & _179_ & _-35_ & _25_ & _-231_ & _-131_ & _144_ & _61_ & _-175_ & _255_ \\ \hline
**bol2\_sag** & _0.06_ & _-0.58_ & _0.15_ & _-120_ & _169_ & _-34_ & _35_ & _-212_ & _-137_ & _174_ & _53_ & _-172_ & _243_ \\ \hline
**bol3\_sag** & _0.06_ & _1.56_ & _0.15_ & _-94_ & _158_ & _-14_ & _32_ & _-246_ & _-135_ & _147_ & _60_ & _-165_ & _257_ \\ \hline \hline \end{tabular} Columns: error from muon fit (mm,mrad), average of the 10 runs (mm,mrad), r.m.s. of the 10 runs (mm,mrad), difference between each run and the average (μm,μrad). _sag_=sagitta direct

\end{table}
Table 10: RASNIK calibration values of BOL in-plane systems.

\begin{table}
\begin{tabular}{|l||c|c|c||c|c|c|c|c|c|c|c|c|c|c|} \hline \hline \multicolumn{1}{|c||}{system/run} & \multicolumn{1}{c||}{error} & \multicolumn{1}{c||}{average} & \multicolumn{1}{c||}{rms} & \multicolumn{1}{c|}{2011} & \multicolumn{1}{c|}{2012} & \multicolumn{1}{c|}{2013} & \multicolumn{1}{c|}{2014} & \multicolumn{1}{c|}{2015} & \multicolumn{1}{c|}{2016} & \multicolumn{1}{c|}{2017} & \multicolumn{1}{c|}{2018} & \multicolumn{1}{c|}{2019} & \multicolumn{1}{c|}{2020} \\ \hline Q0\_x & 0.05 & 6.31 & 0.07 & 5 & -120 & -61 & 73 & 45 & -119 & 32 & 12 & 66 & 67 \\ \hline Q0\_y & 0.14 & 11.03 & 0.25 & 249 & -399 & -166 & -123 & -124 & -217 & 468 & 273 & -92 & 130 \\ \hline Q0\_rotZ & & -4.239 & 0.117 & -75 & 127 & -101 & -92 & -49 & 232 & 54 & 117 & -132 & -81 \\ \hline P0\_x & 0.06 & 14.37 & 0.09 & -50 & 26 & -15 & 121 & 80 & -62 & -171 & -103 & 96 & 76 \\ \hline P0\_y & 0.14 & 4.91 & 0.12 & -30 & -144 & -103 & -105 & -22 & -32 & 250 & 20 & -28 & 194 \\ \hline P0\_rotZ & & 15.319 & 0.329 & 170 & 194 & 211 & 227 & -294 & 172 & 320 & -575 & -589 & 163 \\ \hline Q1\_x & 0.05 & 15.70 & 0.04 & 75 & -63 & 10 & 18 & -58 & 41 & -19 & 0 & -35 & 30 \\ \hline Q1\_y & 0.14 & 12.29 & 0.18 & -419 & 272 & 95 & -9 & 112 & 90 & -117 & -133 & 117 & -7 \\ \hline Q1\_rotZ & & -12.526 & 0.260 & -91 & 133 & 76 & -606 & -177 & 231 & -39 & 251 & -114 & 336 \\ \hline P1\_x & 0.06 & 14.98 & 0.04 & -56 & 11 & 26 & -16 & -56 & 31 & 17 & -8 & -13 & 64 \\ \hline P1\_y & 0.14 & 9.91 & 0.07 & -170 & 21 & -1 & -76 & 29 & 11 & 126 & 24 & 27 & 9 \\ \hline P1\_rotZ & & -14.809 & 0.155 & -19 & 57 & -29 & 5 & 258 & -27 & 188 & -240 & -267 & 74 \\ \hline _QQ\_sag_ & _0.04_ & _-7.62_ & _0.09_ & _-36_ & _169_ & _81_ & _-58_ & _-29_ & _145_ & _-90_ & _-45_ & _-54_ & _-82_ \\ \hline _PQ\_sag_ & _0.04_ & _-14.78_ & _0.09_ & _52_ & _-12_ & _24_ & _-111_ & _-78_ & _65_ & _146_ & _100_ & _-92_ & _-95_ \\ \hline _Q1\_sag_ & _0.04_ & _14.07_ & _0.06_ & _126_ & _-96_ & _-2_ & _19_ & _-71_ & _30_ & _-5_ & _16_ & _-49_ & _31_ \\ \hline _P1\_sag_ & _0.04_ & _13.97_ & _0.03_ & _-40_ & \(9\) & _26_ & _-9_ & _-58_ & _30_ & \(5\) & _-11_ & _-16_ & _63_ \\ \hline \hline \end{tabular} Columns: error from muon fit (mm,mrad), average of the 10 runs (mm,mrad), r.m.s. of the 10 runs (mm,mrad), difference between each run and the average (μm,μrad). \(\_\)sag\(\text{=}\)sagita direction

\end{table}
Table 11: RASNIK calibration values of projective systems.

## 7 Conclusion

The DATCHA geometry has been reconstructed using straight muon tracks in an iterative fit. We have taken the cross-plates as the basic units to be fitted with three first order parameters per cross-plate: two position parameters (\(\Delta\)z, \(\Delta\)y) and one angle parameter (\(\Delta\alpha\)=rotation around the \(x\)-axis). Taking the BML middle cross-plate as a reference for the angles, and the two outer cross-plates of BIL as a reference for the positions, we are left with 19 parameters (2 BIL, 5 BML, 9 BOL), i.e. 7 angles and 12 positions.

We split the fit in two by first fitting the 7 angles, then correcting the tracks for the angles and positions, fitting the 12 positions, and then correcting the tracks for the positions and the angles. The fits themselves are linearised around zero, whereas the corrections in between the fits are not linearised, but are an approximation based on'superpoints'. In an iterative procedure the fit converges to within 2% of the errors in typically 9 iterations, which takes less than 5 minutes for 50k tracks (on a HP 712/80).

The fit is tested on Monte Carlo with a known deformation. The fit finds the input values back within a few sigma.

Applied to real data, the consistency of the fitted parameters is tested by feeding them back into the trackfit, which applies a hit-by-hit correction before doing the trackfit. This is done for one run as an example. The average corrected sagitta is consistent with zero all over the surface of BML. The 10 runs are combined into one histogram using the approximated corrections as used in the fit ('superpoints'). The average corrected sagitta of the 10 runs is consistent with zero within the statistical error of 5-10 \(\upmu\)m all over BML. For the angles there seem to be still some systematics left as a function of z of the chambers.

Using 50k reconstructed straight tracks, the cross-plate positions (y and z) are determined with a precision of 10-25 \(\upmu\)m in the sagitta direction and 0.2-0.5 mm 'parallel' to the tracks. The rotation of the cross-plates around x is determined with 10-20 \(\upmu\)rad precision.

From the geometry reconstructed with the muons, the 16 RASNIK systems are calibrated. Using 50k tracks the calibration in the sagitta direction has and error of 40-60 \(\upmu\)m. The r.m.s. of the calibration values over the 10 runs is a factor 2 larger than the errors. This is probably due to the correlations between the calibration values. A factor of 10 more statistics is needed to get the errors down to an acceptable level.

We conclude by saying that a simple and elegant method has been presented to fit the DATCHA geometry using straight muon tracks. The parameters are directly related to chamber construction. The performance is satisfactory.

## References

* [1] M.Vreeswijk _et al._, _Global alignment of MDT chambers in DATCHA-CERN_, ATLAS Internal Note ATL-MUON-98-246
* [2] F.Linde _et al._, \(\upmu\)_-Track Reconstruction in DATCHA_, ATLAS Internal Note ATL-MUON-98-220
* [3] see several documents on WWW page [http://wwwinfo.cern.ch/](http://wwwinfo.cern.ch/)\(\sim\)patrick/Presentations/Presentations.html
* [4] N.Hessey, M.Woudstra, _Mutad User Guide for DATCHA Event Analysis_, /afs/cern.ch/atlas/project/datcha/mutdat/manual.ps