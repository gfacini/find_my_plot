# **Atlas NOTE ATL-PHYS-PUB-2011-015**

**Studies of vector boson transverse momentum simulation**

**in Monte Carlo event generators**

The ATLAS Collaboration

###### Abstract

We present studies of event generator behaviours regarding vector boson production characteristics, in particular the transverse momentum, \(p_{\perp}\), of the \(Z\) boson as measured by ATLAS, for discussion at the LPCC working group meeting on precision electroweak physics at the LHC.

The results discussed focus on the poor descriptions of ATLAS \(W\) and \(Z\)\(p_{\perp}\) spectra by the ATLAS AUET2B LO** **tune of Pythia 6**, and by the shower-matched NLO generator combination Powheg +Pythia 6. We show that both standalone Pythia 6 and Powheg can be made to describe the Sudakov peak of the ATLAS \(Z\)\(p_{\perp}\) distribution by tuning of the Pythia parton shower - different approaches are required in each case. Comparisons of other NLO generators to the \(Z\)\(p_{\perp}\) data are also shown.

Introduction

In this brief note, we present results from event generator studies of \(Z\) and \(W\) boson tranverse momentum (\(p_{\perp}\)) spectra, compared to the ATLAS experiment's measurements of these distributions in LHC data at 7 TeV [1, 2].

The motivations for these studies are two-fold: at the time of creation of ATLAS' current Pythia 6[3] AUET2B [4, 5] bulk production tune, no \(Z\)\(p_{\perp}\) data from LHC were available and the optimised shower configuration obtained from the other observables does not describe ATLAS \(Z\)\(p_{\perp}\) data to the desired level. Therefore a tune including these new data was necessary.

The second motivation is that the Powheg NLO event generator [6], with showering, MPI and hadronisation provided by Pythia6 with the AMBT1 tune, also fails to describe the ATLAS \(Z\)\(p_{\perp}\) while the AMBT1 tune employed in standalone Pythia6 describes the data reasonably well. It is of course undesirable that a higher-order calculation results in a worse description of data than a leading-order one, and hence this note summarises the status of several ongoing studies to understand the origins of the discrepancy and whether it can be reduced or eliminated.

## 2 Pythia 6 AUET2B tunes

For the MC11 ATLAS production the "AUET2B" set of Pythia 6 tunes has been created, involving optimisation of both shower and MPI modelling for several leading order (LO), modified LO, NLO PDFs, including CTEQ6L1 and CT10. These tunes are discussed in references [4, 5]. The focus of the tunes was to optimised the description of the ATLAS data at that time, namely ATLAS jet shapes, trackjet fragmentation and dijet decorrelation measurements in the shower tune and the underlying event and minimum bias observables in the MPI tune while still keeping consistency with similar Tevatron measurements if possible. The tunes were constructed using the Rivet [7] and Professor [8] tools. MC inputs of the same Tevatron and LHC observables were generated, and identical weights of the observables were used for all tunes. AUET2B hence provides a family of tunes well-suited to studying PDF effects in MC generators.

### AUET2B tune extension with \(Z\)\(p_{\perp}\)

At the time of performing the AUET2B tunes the \(Z\)\(p_{\perp}\) measurement was not available and the tuning set up put large weights on ATLAS jet measurements sensitive to shower i.e. jet shapes, trackjet fragmentation and dijet decorrelation measurements. When the measurement became available, comparisons with the AUET2B family of tunes showed that the \(Z\)\(p_{\perp}\) spectrum is mis-described by a level of \(\sim 20\%\) both at low and high \(p_{\perp}\) values - independent of the particular PDF. In order to improve the situation, the \(Z\)\(p_{\perp}\) measurement with the "dressed" kinematics [9] was added to the observable list, and the complete AUET2B (CTEQ6L1) fit was re-run.

To avoid regions with multiple hard emissions, we tuned only to the region with \(Z\)\(p_{\perp}<25\) GeV, using identical weights to AUET2B for the previously used observables and with weights of 0, 1, 5, and 100 for the ATLAS \(Z\)\(p_{\perp}\) observables.

The parameter value for FSR radiation from ISR partons (Pythia parameter PARP\((72)\)) was unaffected by the weight on the \(Z\)\(p_{\perp}\) observable - as expected from the model since it is the recoil against the initial ISR parton rather than the internal structure of its resulting jet evolution which is responsible for generation of vector boson \(p_{\perp}\). The \(p_{\perp}\) cut-off for ISR emissions (PARP\((62)\)) decreases when the \(Z\)\(p_{\perp}\) is included in the fit, and this trend continues with higher weights on the observable. At the same time the scale multiplier for the evaluation of \(\alpha_{S}\) (PARP(64)) increases significantly. As a cross-check we also tuned to the full \(Z\ p_{\perp}\) spectrum with weight 1 and obtained similar parameters as with the tune restricted to the low-\(p_{\perp}\) region with the same weight.

Figure 1 shows the comparison of the tunes to the ATLAS \(Z\ p_{\perp}\) data. It is clearly visible, that including the distribution raises the low \(p_{\perp}\) MC predictions and a very high weight on the \(Z\ p_{\perp}\) would improve the description of this particular observable even further. The ATLAS \(W\ p_{\perp}\) measurement was not available at the time of the \(Z\ p_{\perp}\) tune. However, comparisons of the new tunes to these data show that for \(Z\ p_{\perp}\) with a weight of 5, a similar improvement in the data MC comparison can be reached as for \(Z\ p_{\perp}\) data. The tune with a very high weight of 100 on the low-\(p_{\perp}\) region of the ATLAS \(Z\ p_{\perp}\) data results in too soft high \(p_{\perp}\) spectrum which is particular visible in \(W\ p_{\perp}\) above \(\sim 100\) GeV.

Figure 2 shows comparisons to the novel technique by DO to measure the \(Z/\gamma*\ p_{\perp}\)[10] compared to AUET2B (CTEQ6L1) and the new \(Z\ p_{\perp}\) tune with fit weight = 5. The \(\phi^{*}\) variable is an optimised variant of \(Z\ p_{\perp}\) with minimal sensitivity to detector resolution effects - it is closely correlated to \(a_{T}/m_{\ell\ell}\), where \(m_{\ell\ell}\) is the dilepton mass and \(a_{T}\) is the component of the dilepton \(p_{\perp}\) perpendicular to the dilepton thrust axis. A slight improvement at low \(\phi^{*}\) is visible with the new ATLAS tune, demonstrating that Pythia6 is capable of simultaneously describing \(Z\ p_{\perp}\) distributions at different centre-of-mass energies.

Figure 1: Upper row: Comparisons of the AUET2B (CTEQ6L1) Pythia 6 tune (green) and the new tunes including this measurement with a weight of 5 (red) or 100 (blue) to ATLAS \(Z\)\(p_{\perp}\) data. Both the electron (left) and muon (right) channels are shown. Lower row: the same set of tunes compared to \(W\)\(p_{\perp}\) data at 7 TeV. In all cases the yellow bands in the ratio plots illustrate the data uncertainty.

Figure 2: Comparison of the AUET2B (CTEQ6L1) 6 tune (green) and the new \(Z\)\(p_{\perp}\) tune with weight 5 (red) to DØ data. Two different rapidity ranges are shown for each of the electron channel (upper plots), and the muon channel (lower plots). The tune to ATLAS \(Z\)\(p_{\perp}\) data slightly improves the description of the DØ data. The yellow bands in the ratio plots illustrate the data uncertainty.

## 3 Powheg + Pythia6

The Powheg event generator simulates single vector boson production at the LHC to next-to-leading order in QCD. It is written in such a way that it can be interfaced to shower Monte Carlo programs while maintaining the accuracy of both the NLO matrix element and the parton shower.

It is possible to use different PDFs for the NLO matrix element calculation and for the shower generator, and such configurations have not been discouraged. The ATLAS default configuration of Powheg +Pythia in the MC10 production round uses the CT10 PDF for the NLO matrix element and the AMBT1 Pythia 6 tune with the LO* PDF for the parton shower. Figure 3 shows that with this setup the MC prediction undershoots the data by \(\sim 20\%\) at both low and high \(p_{\perp}\), while the AMBT1 tune for standalone Pythia 6 describes the data reasonable well. A similar behaviour is visible for the Perugia 2011 (P2011) [11] tune which uses the CTEQ5L PDF.

To investigate the origin of the deviation in Powheg +Pythia6 matched samples, different Pythia6 tunes were used to shower the same Powheg events. In addition to the ATLAS tunes, P2011 was included in the study since P2011 uses a primordial \(k_{T}\) smearing width of 1 GeV (as opposed to 2 GeV in the AUET2B tunes) and uses a consistent \(\alpha_{S}\) coupling in all parton shower stages. In order to study the PDF sensitivity, a variant of P2011 was used where only the PDF was changed to CT10 while all other parameters are kept the same. This approach of course requires extra tuning of the remaining shower and MPI parameters to optimally describe other observables, which have not been included in this study. However, the shower couplings in P2011 are chosen to match the Professor tuning of Pythia6 to LEP event shape and jet data with \(\Lambda_{\text{QCD}}=260\) MeV rather than any particular PDF.

Figure 4 shows that this set-up does describe the \(Z\)\(p_{\perp}\) data very well. Therefore we conclude that the use of different PDFs in the ME and the shower part may lead to sub-optimal results. A fall-off below the data is still observed for Powheg in the high-\(p_{\perp}\) region, but this is to be expected with an NLO calculation, as multiple ISR emissions become important in that region and NNLO kinematics are required to match the

Figure 3: Comparison of different Pythia6 tunes to ATLAS \(Z\)\(p_{\perp}\) data for Pythia6 standalone and when Pythia6 is used as the shower generator for the Powheg matrix element generator.

data [2].

The distinctive feature of P2011 is that all \(\alpha_{\mathrm{S}}\) couplings in the Pythia6 parton showers are set to the same value, to allow for consistent matching with higher-order ME generators, specifically AlpGen [12, 13]. The influence of changing the degree of \(\alpha_{\mathrm{S}}\) matching between the shower and the ME generator was investigated by varying \(\Lambda_{\mathrm{QCD}}\) between 0.1 and 0.326, which (with Pythia 6's leading order running of the coupling) covers the \(\alpha_{\mathrm{S}}(M_{Z})\) value of the CT10 PDF, and using an effective CMW scheme for the \(\Lambda_{\mathrm{QCD}}\) in the shower to match the treatment used in Powheg. No significant effect was observed, as shown in Figure 5.

Figure 6 shows the quality of description of ATLAS \(Z\)\(p_{\perp}\) data with several different Powheg implementations.

Sherpa [14] version 1.3.1 was run using its automated Powheg implementation [15]. For the present study of NLO+PS matching, only the inclusive \(Z\) production process was generated at NLO and matched to the parton shower. No matrix elements for higher-order jet multiplicities, as possible e.g. in the MENLOPS [16, 17] approach, were included. This explains a slight difference to the SHERPA ME+PS [18] results shown in the original ATLAS paper, which describe the data slightly better in the high-\(p_{\perp}\) region. Higher-order parton emissions play a significant role here, and in the present study those are only generated in the parton shower approximation. A further difference between the POWHEG and ME+PS methods within Sherpa is about the terms which are exponentiated in the Sudakov form factors. They have a significant influence on the shape of observables like the \(Z\)\(p_{\perp}\). While the parton shower and ME+PS methods only exponentiate all-order singular terms, the Powheg method wrongly also includes regular pieces from the first term in the exponentiation [19]. Otherwise, the default parameters were used, including the CTEQ6.6 PDF both for PS and ME, and only a customary 61 GeV \(<m_{\ell\ell}<\) 121 GeV cut was imposed at the matrix element level. Events were generated at the full hadron level, including multiple parton interactions.

The built-in Powheg scheme was also used for Herwig++ [20, 21]. The successful Powheg +Pythia 6 setups discussed earlier in this note, and Powheg +Pythia 8 [22] with the 4C and A2 CT10 tunes are also shown.

Figure 4: ATLAS \(Z\)\(p_{\perp}\) data compared to P2011 with its PDF (blue) and a variant of P2011 where the PDF is set to CT10 (red).

Of these successful Powheg setups, Herwig++ gives the least good description of data. Given the conclusion of the Powheg + Pythia6 study that PDF matching is particularly crucial for well-behaved Powheg matching, it is particularly surprising that the Powheg +Pythia 8 4C setup describes the data so well - the 4C tune uses the leading order CTEQ6L1 PDF. Very little difference at all is observed between the two tunes of Pythia 8 for different PDFs.

## 4 Summary

In this note we have demonstrated that poor descriptions of the \(Z\) and \(W\) boson \(p_{\perp}\) spectra by the Pythia 6 generator, both standalone and in connection with the Powheg NLO matrix element generator and ME/PS matching scheme, can be addressed through tuning of parameters in the Pythia parton showers.

In the standalone case, a repeat of the shower tuning used to construct the ATLAS AUET2B Pythia 6 tune was made, this time including the ATLAS \(Z\)\(p_{\perp}\) data, resulting in a much-improved description of both that data and the ATLAS \(W\)\(p_{\perp}\) data.

In the Powheg +Pythia 6 case, it was observed that the shape of the \(Z\)\(p_{\perp}\) distribution is systematically shifted from the standalone configuration, to have a Sudakov peak a few GeV higher than the data. Due to the steep shape of the \(Z\)\(p_{\perp}\) distribution, this shift results in discrepancies of up to 40% from the data in regions which would be expected to be described by a shower Monte Carlo generator. It was found that using different established Pythia 6 shower tunes had little effect on the position of the \(Z\)\(p_{\perp}\) peak as long as a PDF different from the one in Powheg was used. A new empirical configuration based on the Perugia 2011 shower configuration using the same PDF as in Powheg does manage to describe the data extremely well.

Alternative Powheg implementations in Herwig++ and Sherpa, where the matching of couplings and evo

Figure 5: ATLAS \(Z\)\(p_{\perp}\) data compared to a variant of the Perugia 2011 tune with the PDF set to CT10 and variants of \(\Lambda_{\mathrm{QCD}}\) from the default of 0.26 (red) and variations of \(\Lambda_{\mathrm{QCD}}=0.1\) (blue) and \(\Lambda_{\mathrm{QCD}}=0.326\) (green).

lution variables should be exact, are shown to provide a good description of the ATLAS data, although notably better for Sherpa. Powheg +Pythia 8 was also seen to provide a very good description of the ATLAS \(Z\)\(p_{\perp}\) data, although in this case the PDF did not appear to play a significant role.

Given these results, there is hope that new shower tunes of Pythia 6 and Pythia 8, which will include the ATLAS \(Z\)\(p_{\perp}\) data in addition to the jet observables used in the AUET2B tuning, will be able to describe all relevant ATLAS observables both standalone and in conjunction with Powheg and AlpGen, with an appropriately matched choice of PDF.

An extension to Pythia 8 and MC@NLO (with Herwig++) is also underway: Pythia 8 also permits use of a more closely matched \(\alpha_{s}\) evolution than possible in Pythia 6. The Pythia 8 UserHooks class also allows for modifications to the shower, and the implementation and validation of a truncated (or vetoed) shower suitable for \(Z\) production is in progress. It is anticipated that such a truncated shower could ultimately lead to an improved ME/PS matching. As seen in Figure 6, Powheg +Pythia 8 already gives a very good description of the \(Z\)\(p_{\perp}\) data, even with the PDF mismatch resulting from use of the 4C tune.

## References

* [1] The ATLAS Collaboration, _Measurement of the transverse momentum distribution of \(W\) bosons in \(pp\) collisions at \(\sqrt{s}=\) 7 TeV with the ATLAS detector_, arXiv:1108.6308 [hep-ex].
* [2] The ATLAS Collaboration, _Measurement of the transverse momentum distribution of \(Z/\gamma^{*}\) bosons in proton-proton collisions at \(\sqrt{s}=\) 7 TeV with the ATLAS detector_, arXiv:1107.2381 [hep-ex].

Figure 6: Description of \(Z\) boson \(p_{\perp}\) data, by the Powheg method, demonstrating the effect of a PDF mismatch (Powheg + P2011), the improvement due to using the same PDF (Powheg + the P2011 variant for the CT10 PDF), and the Powheg implementations in Sherpa and Herwig++ and as interfaced to Pythia 8 (with the 4C and A2 CT10 tunes). The “no veto” label on the latter two curves indicates the use of a standard rather than a truncated shower.