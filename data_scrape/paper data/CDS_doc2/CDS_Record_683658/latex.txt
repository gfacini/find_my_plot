ATLAS Internal Note

DAQ-NO-108

Version 1.0

July 1, 1998

Trigger Rates

From Fast Simulations

A. Amadon, J. Bystricky, J.Ernwein, J.R. Hubbard, P.Le Du, B.Thooris

_DAPNIA, CEA/Saclay_

_91191 Gif-sur-Yvette, France_

A fast program simulating Atlas LV L1 and LVL2 triggers is described and some trigger rates for luminosities \(10^{33}\) and \(10^{34}cm^{-2}s^{-1}\) are presented. The program is being used to estimate trigger menu rates [1]. An earlier version of the program was described in [2].

###### Contents

* 1 Introduction
* 2 Fast simulation
	* 2.1 Pythia parameters and pile-up events
	* 2.2 Inner detector and calorimeter volumes
	* 2.3 Parametrized shower development
	* 2.4 Pulse shaping and BCID
	* 2.5 Caloimeter calibration
* 3 Algorithms
	* 3.1 Muon
	* 3.2 Electron/gamma
	* 3.3 Tau/hadron
	* 3.4 Jet
	* 3.5 Tracking tables
	* 3.6 Missing \(E_{T}\) and scalar \(E_{T}\)
* 4 Trigger rates
	* 4.1 Normalization
	* 4.2 Jet rates
* 5 Efficiencies and trigger menus
	* 5.1 Muon, electron and tau efficiencies
	* 5.2 Jet efficiency
	* 5.3 Missing \(E_{T}\) efficiency
	* 5.4 A simple menu at low luminosity

Introduction

The present PARametrized TRIGger Simulation program PATRIGS is designed to simulate LV L1 and LVL2 ATLAS trigger in order to estimate trigger rates for trigger menus [1]. A previous version of the program was described in [2]. PATRIGS uses the event generator PYTHIA [3]; after simulating the response of the ATLAS apparatus to the generated particles, it creates for each event a column-wise n-tuple with corresponding data. The n-tuples are analysed in subsequent programs to yield rates for desired menuitems.

This note describes PATRIGS in its present form. Improvements are possible to include other types of algorithms or to add other data into the output n-tuples.

## 2 Fast simulation

Particles generated by PYTHIA are tracked through a constant solenoidal magnetic field in the central tracker, simulated by a system of cylindrical volumes. The material constants of the volumes were adjusted to reproduce with good precision the radiation and interaction length distributions in the inner detector. Bremsstrahlung and gamma conversions are simulated in the volumes. For particles reaching the calorimeters, the longitudinal and transverse shower development is simulated by parametrized distributions, and energy deposits are cumulated in calorimeter tables. Calorimeter table values are transformed to transverse energy and completed by adding electronic noise and an appropriate number of minimum bias events chosen randomly on files prepared in advance. The pile-up events of several bunch crossings are folded using pulses shaping functions and a BCID algorithm is applied to determine the final trigger tower deposits. Tower deposits are calibrated before being used by LVL1 and LVL2 trigger algorithms which detect regions of interest (RoI). Other Rols are defined for muons generated in the event using their smeared \(p_{T}\) values. Loose cuts are applied to the values calculated in each RoI and a column-wise n-tuple is written to a file for each accepted event. The n-tuple also contains tracking and particle level information for each RoI. A typical execution time on an HP879 with two chips PA 8000 is 0.5 to 1 second per event depending on the event \(\hat{p}_{T}\) and on the number of pile-up events.

Several n-tuple files are subsequently analysed together to obtain final results.

### Pythia parameters and pile-up events

PYTHIA 5.72 with JETSET 7.408 [3] were used to generate events in the present study for physics channels as well as for background dijets.

For dijet events, the default values of PYTHIA were changed in the following manner:

* \(MSTP(2)=2\) to calculate the strong coupling constant \(\alpha_{s}\) to second order;
* \(MSTP(33)=3\) to scale the \(Q^{2}\) argument of \(\alpha_{s}\) by the K-factor = 0.075 (PYTHIA default value);
* \(MSTP(81)=1\) and \(MSTP(82)=1\) to include multiple interactions assuming the same probability in all events with a cut-off of the cross section at \(p_{\perp min}=1.40\ GeV/c\).

This set-up together with the PYTHIA parameter \(MSEL=1\) selecting the QCD processes including the initial and final state QCD radiation, were used to generate both multijet events for the menu rate evaluation and pile-up events added to each beam crossing.

The proton structure functions were chosen according to the present PYTHIA default to be CTEQL2 functions with the best leading order fit.

The pile-up event option of PYTHIA was not used. Instead, four direct access files containing calorimeter deposits from QCD jet events generated in four partonic \(\hat{p}_{T}\) intervals (see Table 1) were generated in advance.

For each beam crossing, the number of pile-up events was randomly chosen following the Poisson distribution with the mean of 2.26 for the low and 22.6 for the high luminosity. For each pile-up event, the probability proportional to the cross-section (Table 1) was used to choose one of the four files, from which one event was read at random. The calorimeter tables corresponding to the event were randomly rotated in \(\phi\) and added to the pile-up calorimeter tables. Four pile-up files were used to avoid a repeated use of high-\(\hat{p}_{T}\) pile-up events which may create artificial structures in histograms.

### Inner detector and calorimeter volumes

The central tracker and all calorimeters were approximated by sixty concentric cylinders and cones. The beamdirection is the symmetry axis common to all these volumes. The atomic weight and number, the density, radiation and interaction lengths are constant in each volume except for the end-cap calorimeter where they are simple functions of radius. At each space point, the material constants are those of the smallest volume containing the point. The method allows fast particle tracking with a realistic simulation of bremsstrahlung and electron pair production. The bremsstrahlung simulation was adapted from subroutines provided by S.Dasu [4] and the pair production program was written by P.Bonamy [5] following GEANT code. Multiple scattering and energy loss were not simulated.

All material constants were adjusted to approximate well the inner detector and calorimeter properties. A schematic view of the volume system is shown in Figure 1.

### Parametrized shower development

The energy of particle reaching the electromagnetic or hadronic calorimeters was smeared using the energy resolution expected in the ATLAS calorimeters. Electron- and photon-induced electromagnetic showers started as soon as the particle entered dense material. For hadrons the interaction point was randomly chosen using an exponential probability distribution. The longitudinal and transverse shower profiles were then simulated following the program of G.Sullivan [6] based on the CDF electromagnetic and hadronic shower parametrisation [7]. The average longitudinal shower profile and the fluctuations of the energy deposited in each calorimeter segment were simulated. The centroid of the shower was considered as a particle travelling in the

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline \(\hat{p}_{T}\) interval & cross section (mb) & number of events & probability \\ \hline \hline
4.7 - 10 & 68.45 & 2000 & 0.9016 \\
10 - 25 & 7.136 & 1500 & 0.0940 \\
25 - 50 & 0.3111 & 1000 & 0.0041 \\ \(\geq\) 50 & 0.0251 & 500 & 0.0003 \\ \hline \end{tabular}
\end{table}
Table 1: Pile-up event intervalssame direction as the original particle. At each step the energy was deposited in a number of points of the transverse plane following parametrized transverse profiles.

The comparison of the electron shower profiles with showers generated in the full GEANT simulationATLSIM shows a good agreement.

### Pulse shaping and BCID

Calorimeter tables containing deposits from all particles in the trigger event were supplemented by electronic noise represented for each.1x.1 EMC or HAC tower by a normally distributed random value. The variance was taken as 0.2 and 0.4 Gev for the low and high luminosity, respectively.

On the other hand, a number of pile-up calorimeter tables were maintained in the program memory, each corresponding to one bunch crossing. They were created as described in section 2.1 and replaced one at a time when a new trigger event was generated. A pulse shaping function was used to combine the pile-up calorimeter tables of 21 consequent beam crossings [8, 9] to form the beam crossing pile-up deposit table.

A bunch crossing identification (BCID) procedure [10] was applied to the calorimeter tables completed by the beam crossing pile-up deposit table. The LVL1 values were then taken into account only if they were greater than 1 GeV and they were truncated with a least count of 1 GeV. The LVL2 values were calculated using the full computer precision.

Figure 1: Calorimeter and ID volumes

### Calorimeter calibration

The energy loss in the tracking volume is not simulated in the program. Instead, the energy of particles reaching one of the calorimeters is smeared toget the global energy deposit. However, not all this energy is deposited in the calorimeters. Part of it is lost in dead material, especially in the crack region.

An \(\eta\)-dependent calibration was introduced to correct for this effect.

Electrons, photons and pions of 20 GeV were used to calibrate the electromagnetic and hadronic calorimeters. Single particles were generated over the entire ATLAS acceptance (\(|\eta|<5\)) with the appropriate number of pile-up events (2.26 for low luminosity). The sum of all deposits in (5x.5) regions around the particle direction was taken as the total particle deposit. Calibration constants were found in intervals of \(\Delta\eta=0.1\) (\(\Delta\eta=0.2\) for the forward calorimeter). which took the mean values of the total deposits back to the generated value. The calibration constants were the ratio of the generated \(p_{T}\) value to the average total \(E_{T}\) deposits. Different calibration constants were found for EMC and HAC. For the forward calorimeter only one constant was determined per \(\eta\) interval.

## 3 Algorithms

### Muon

Muon Rols were created for each muon found in \(|\eta|<2.4\). A smearing due to the energy loss and multiple scattering was applied to the muon particle level \(P_{T}\). The LV L1 and LV L2 \(p_{T}\) values were found by superposing measurement resolutions which were taken as 100 times and 10 times the off-line reconstruction errors for LV L1 and LV L2, respectively.

At LV L2, the EMC and HAC isolations were calculated as values in (4x.4)-(2x.2) regions centered on the muon direction.

### Electron/gamma

Electron/gamma Rols are found as local EMC maxima in (1x.1) regions with \(|\eta|<2.5\). The LV L1 value is the maximum of the four (1x.2) or (2x.1) regions containing the local maximum. The EMC isolation is the (4x.4)-(2x.2) value, the HAC isolation is the sum of HAC values over the (4x.4) region.

The LV L2 value was calculated as the sum of the (2x.2) region, the sum over (1x.2) or (2x.1) corresponding to the LV L1 local maximum is also available in the n-tuples. EMC and HAC isolations are recalculated using LV L2 calorimeter values.

### Tau/hadron

Tau/hadron RoIs are required to be local maxima in the matrix of (1x.1) (EMC+HAC) values with \(|\eta|<2.5\). The LV L1 value is once more the maximum of the four (1x.2) or (2x.1) regions around the local maximum with the sum of both EMC and HAC. Both EMC and HAC isolations are calculated from the regions (4x.4)-(2x.2).

The LV L2 values are (EMC+HAC) sums over (2x.2) regions and LV L2 isolations are also available.

### Jet

To get the jet RoIs, a table of (EMC+HAC) values in (.4x.4) regions sliding by.2 in both direction is created. The jet RoIs are then (.8x.8) regions centered on local maxima in the table. The LV L1 jet value is the sum over the (.8x.8) region.

The LV L2 value is the sum of LV L2 calorimeter values over the same region. The maximum of LV L2 sums over all (.4x.4) regions contained in the (.8x.8) RoIs also available.

### Tracking tables

For each RoI of the muon, e/gamma, tau/hadron or jet type, a table of tracks is created. Every charged particle tracked over a minimum distance (currently 50 cm) and pointing to the RoI is included in the table. For every RoI, the n-tuples contain the maximum-\(P_{T}\) track from this table as well as the number of tracks in eight \(P_{T}\)-intervals.

### Missing \(E_{t}\) and scalar \(E_{t}\)

The missing \(E_{T}\) and the scalar \(E_{T}\) are calculated for each event at the particle level, at LV L1 and at LVL2 for \(|\eta|<5\).

## 4 Trigger rates

The QCD dijet events were generated in several \(\hat{p}_{T}\) intervals for both low and high luminosity. Loose threshold cuts were used to reject uninteresting events. For each accepted event, a column-wise n-tuple was written to an output file containing information about all RoIs found in the event. The files were then read by other programs to find trigger rates, to determine jet and missing \(E_{T}\) efficiencies and finally to estimate the rates for some trigger menus.

### Normalization

This section deals with the normalization of the QCD dijet events generated in several \(\hat{p}_{T}\) intervals. The QCD dijets generated as trigger events are of the same kind as the pile-up events. They are just one of them, the one with the greatest \(\hat{p}_{T}\). To minimize the execution time, the pile-up events are pre-generated on special files and some information on them is lost. For that reason we reject the generated dijet events if their \(\hat{p}_{T}\) is lower than the maximum \(\hat{p}_{T}\) of the pile-up events; in this case, the complete information of the "trigger" dijet is not available.

With \(N\) dijet interactions and \(B\) bunch crossings per second, the mean number of events in a crossing is \(\lambda=N/B\). The Poisson probability to get \(n\) events in a crossing is

\[p_{n} = \lambda^{n}\frac{e^{-\lambda}}{n!}.\]

Let us generate a "trigger" dijet, the random number \(m\) (with the probability \(p_{m}\)), and \(m\) pile-up dijets. We reject the event if \(\hat{p}_{T}(\mbox{trigger})<\max\hat{p}_{T}(\mbox{\small pile-up})\). Because all dijets are generated with the same distribution, the probability to accept the event is \(p_{m}/(m+1)\) which is proportional to \(p_{m+1}\). It follows that the accepted events are distributed in each \(\hat{p}_{T}\) interval as required.

Denote \(s_{i}\) the probability, given by the dijet cross section, to generate a dijet in the \(i\)-th \(\hat{p}_{T}\) interval or below. The probability that all dijets on a bunch crossing are in the interval \(i\) or

[MISSING_PAGE_EMPTY:8]

Figure 3: Jet rates at \({\cal L}=10^{34}\,cm^{-2}\,s^{-1}\)

the nominal threshold, the effective LVL1 and LVL2 thresholds, and isolation cuts or tracking conditions if applicable. A menuitem is composed of one or several menuobjects, and of the number of each object required for the menuitem. A special program was written which reads a menu file and establishes the menu rates using one or several event n-tuple files.

The nominal thresholds and other cuts for the object definitions are determined by the requirements on the detection efficiency of the corresponding physics object (particle, jet, missing \(E_{T}\)). A typical efficiency required for the LVL1 or LVL2 objects is 95% or 90%, respectively.

### Muon, electron and tau efficiencies

The efficiencies of muons, electrons and taus were calculated for each fixed \(P_{T}\) using single particle files generated with appropriate numbers of pile-up events. The efficiency was determined with respect to the generated particle \(P_{T}\). For the LVL1 threshold, 95% efficiency was required, for the LVL2 90%.

### Jet efficiency

In the present menu calculations only the relative efficiency of LVL1 jets with respect to LVL2 jets were required to be 95%. It means that the nominal jet value was considered to be its LVL2 value. The dependence of the LVL1 thresholds on the LVL2 values is shown in Figure 4 for the low luminosity and in Figure 5 for the high luminosity.

### Missing \(E_{t}\) efficiency

The reference value for the missing \(E_{T}\) efficiency was the missing \(E_{T}\) at the particle level calculated over the region \(|\eta|<5\). The LVL1 threshold is defined by 95% of efficiency and the LVL2 one by 90% efficiency with respect to the reference value.

### A simple menu at low luminosity

Table 4 shows a list of possible menu objects. Table 5 summarizes rates of a simple low energy menu using these objects. Some of the menu items are prescaled at LVL1.

## References

* [1] A.Amadon et al.: ATLAS Trigger Menus at Luminosity \(10^{33}cm^{-2}s^{-1}\), ATLAS Internal Note DAQ-NO-110

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline name & type & \multicolumn{2}{c|}{thresh hold} & \multicolumn{2}{c|}{EMC isolation} & \multicolumn{2}{c|}{HAC isolation} \\ \cline{3-8}  & & LVL1 & LVL2 & LVL1 & LVL2 & LVL1 & LVL2 \\ \hline \hline MU6 & muon & 5.1 & 5.6 & & & & \\ EM80 & electron/gamma & 60. & 74. & & & & \\ EM201 & electron/gamma & 14. & 16.4 & 3. & 3. & 2. & 2. \\ EM151 & electron/gamma & 10. & 12.4 & 3. & 3. & 2. & 3. \\ EM101 & electron/gamma & 6. & 7.4 & 2. & 2. & 2. & 3. \\ EM51 & electron/gamma & 2. & 3.2 & 1. & 3. & 2. & 3. \\ TAU150 & tau/hadron & 60. & 76. & & & & \\ TAU801 & tau/hadron & 40. & 49.5 & 3. & 3. & 3. & 3. \\ TAU201 & tau/hadron & 9. & 11.7 & 2. & 3. & 2. & 2. \\ J100 & jet & 79. & 100. & & & & \\ J80 & jet & 60. & 80. & & & & \\ J50 & jet & 33. & 50. & & & & \\ J40 & jet & 24. & 40. & & & & \\ J20 & jet & 7. & 20. & & & & \\ ME100 & missing \(E_{T}\) & 44. & 54.5 & & & & \\ SE1000 & scalar \(E_{T}\) & 689. & 1 061. & & & & \\ BX & bunch crossing & & & & & & \\ \hline \end{tabular}
\end{table}
Table 4: A list of menu objects