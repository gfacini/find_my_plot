[MISSING_PAGE_EMPTY:1]

## 1 Motivation for using superclusters

Using dynamic, variable-size clusters to reconstruct electrons and photons offers numerous advantages over a method using fixed-size clusters. In the past, the main reason for using a fixed-size clustering approach was the inability to apply the contemporaneous calibration methodology to dynamically-sized clusters. However, the development of multivariate calibration techniques [1] has freed the reconstruction from this constraint. It is now possible to use topological clusters (topo-clusters) [2], as described in Section 4, as a foundation to reconstruct electromagnetic (EM) showers from electrons and photons.

A primary motivation for using dynamic clusters is the ability to recover low energy photons radiated due to bremsstrahlung interactions in the Inner Detector, and connect them to their associated electron or converted photon, forming what may be termed _superclusters_. This ability is unique to topo-clusters, owing to their ability to reconstruct showers down to the \(\mathcal{O}\left(100\,\mathrm{M\!\text{e}\text{V}}\right)\) range in energy. An example diagram of a supercluster is given in Figure 1. In this construction, an electron radiates a bremsstrahlung photon due to interactions with the material of the Inner Detector. The supercluster algorithm attempts to find and connect the primary cluster formed from the electron shower (the _seed cluster_) with the nearby secondary cluster formed from the photon shower (the _satellite cluster_).

Another important motivation for using topo-clusters is that they grow in a fashion comparable to the natural development of an EM shower in a calorimeter. In particular, \(\sim 95\%\) of an electromagnetic shower is contained laterally within two units of the Moliere radius [3], with the shower size in the azimuthal direction varying significantly with particle energy and momentum. The clustering algorithm will expand outward from a point of high energy deposition, capturing the surrounding shower within a dynamically-sized cluster. Topo-clusters follow the development of the shower across several calorimeter layers, collecting cells only in regions where a significant amount of energy deposition is found. Furthermore, reconstructing showers using topo-clusters allows a linear energy response across a wide range of energies, and very good energy resolution for both low and high energy particles. Topo-clusters also collect more energy on average than sliding window clusters, requiring smaller corrections for energy losses before and inside the calorimeter.

By collecting and combining clusters originating from the primary electron with those from radiative interactions within the detector, one can recover some or all of the energy lost due to bremsstrahlung. As a result, a significant improvement in energy resolution is possible, due to bringing the reconstructed energy

Figure 1: Diagram of an example supercluster showing a seed electron cluster and a satellite photon cluster.

of the combined clusters closer to the total energy deposited by the EM shower. Similarly, for photons that convert to electron-positron pairs, superclusters can include more of the energy of the primary photon. In particular, photons can produce multiple topo-clusters, which can then be merged into one supercluster. The use of fixed-size clusters is suboptimal in this scenario, as the fixed cluster size cannot properly accomodate the growth of two independent EM showers, particularly when the two clusters share cells.

## 2 The ATLAS detector

The ATLAS detector is a general-purpose particle physics detector with a forward-backward symmetric cylindrical geometry and near \(4\pi\) coverage in solid angle. The inner tracking detector (ID) covers a pseudorapidity range \(|\eta|<2.5\) and consists of a silicon pixel detector, a silicon microstrip detector (SCT), and a transition radiation tracker (TRT) in the range \(|\eta|<2.0\). The ID is surrounded by a superconducting solenoid which generates a 2 T magnetic field. The ID provides accurate reconstruction of tracks from the primary proton-proton collision region, while also identifying tracks from secondary vertices, allowing for the efficient reconstruction of converted photons in the ID up to a radius of about 800 mm.

The electromagnetic (EM) calorimeter is a LAr sampling calorimeter with an accordion geometry. It is divided into a barrel section (EMB), covering the pseudorapidity region \(|\eta|<1.475\) and two end-cap sections (EMEC), covering \(1.375<|\eta|<3.2\). The barrel and end-cap sections are divided into 16 and 8 modules in the \(\phi\)-direction, respectively. The transition region between the EMB and the EMEC, \(1.37<|\eta|<1.52\), has a large amount of material in front of the first active calorimeter layer ranging from \(5-10\) radiation lengths (\(X_{0}\)). Both the barrel and end-cap calorimeters are longitudinally segmented into three shower-depth layers for \(|\eta|<2.5\). The first layer (L1), in the ranges \(|\eta|<1.4\) and \(1.5<|\eta|<2.4\), has a thickness of approximately \(4.4X_{0}\) and is segmented into high-granularity strips in the \(\eta\)-direction, typically \(0.003\times 0.1\) in \(\Delta\eta\times\Delta\phi\) in EMB. The second layer (L2), which collects most of the energy deposited in the calorimeter by photon and electron showers, has a thickness of about \(17X_{0}\) and a granularity of \(0.025\times 0.025\) in \(\Delta\eta\times\Delta\phi\). A third layer (L3) is used to correct leakage beyond the EM calorimeter for high-energy showers, and has a granularity of \(0.05\times 0.025\) in \(\Delta\eta\times\Delta\phi\) and a depth of about \(2X_{0}\).

In front of the EM calorimeter, a thin presampler (PS) layer covers the pseudorapidity region \(|\eta|<1.8\), which is used to correct for energy loss upstream of the calorimeter. The PS consists of an active, segmented LAr layer with a thickness of 1.1 cm (0.5 cm) in the barrel (end-cap), and a granularity of \(\Delta\eta\times\Delta\phi=0.025\times 0.1\). In the region \(1.4<|\eta|<1.6\), electrons and photons may also deposit energy in the "E4" scintillators, located in the gap between the barrel and end-cap cryostats. The E4 scintillators were introduced as an active component to mitigate energy resolution degradation caused by the large amount of material crossed by the particles in this region.

The hadronic calorimeter, surrounding the EM calorimeter, consists of an iron/scintillator tile calorimeter in the range \(|\eta|<1.7\), and two copper/LAr calorimeters spanning \(1.5<|\eta|<3.2\). The acceptance is further extended to \(|\eta|=4.9\) by two copper/LAr and tungsten/LAr forward calorimeters. The forward calorimeters also provide electron reconstruction capability, which is not considered in the following study. Lastly, the muon spectrometer, located beyond the calorimeters, consists of three large air-core superconducting toroid systems with precision tracking chambers, which provide accurate muon tracking for \(|\eta|<2.7\), as well as fast detectors for triggering within the region \(|\eta|<2.4\).

## 3 Overview of electron and photon reconstruction

The reconstruction algorithm first selects topo-clusters to consider in building electrons and photons. It then performs a bremsstrahlung-aware refit of tracks and matches them to the selected topo-clusters. The algorithm also builds conversion vertices out of the refitted tracks and matches them to the selected topo-clusters. After the initial track-cluster matching and conversion building, the electron and photon supercluster algorithms run separately in parallel, as described in more detail in Section 6. After applying initial position corrections to the resultant superclusters, the reconstruction algorithm matches tracks to the electron superclusters and conversion vertices to the photon superclusters. In general, an electron is defined as an object consisting of a cluster built in the calorimeter (supercluster) and a matched track (or tracks), a converted photon is a calorimeter cluster matched to a conversion vertex (or vertices), and an unconverted photon is a cluster matched to neither an electron track nor a conversion vertex.

Since one object may be reconstructed as both an electron and a photon, an ambiguity resolution is performed to remove part of the overlap. However, some overlap is allowed in order to maintain a high reconstruction efficiency for electrons and photons, to which physics analyses may apply their own criteria. The final electrons and photons are then built and calibrated, facilitating the calculation of additional variables used for quality cuts and ambiguity resolution. More details about these steps are given in the following sections, while the previous electron and photon reconstruction methods are described in Refs. [4] and [5]. A diagram of the algorithm flow for the new electron and photon reconstruction is given in Figure 2.

## 4 Topo-cluster reconstruction

The foundation of the new electron and photon reconstruction is the topological cell clustering algorithm [2]. The changes to the reconstruction algorithm only affect electrons and photons within Inner Detector acceptance, and do not address electrons in the region \(|\eta|>2.5\), which are already reconstructed using a topo-cluster-based approach [6, 7]. The following section briefly describes topo-cluster formation in the ATLAS calorimeter system, and describes how clusters from the existing topo-clustering algorithm are adapted for use in the new electron and photon reconstruction.

### Defining topo-clusters

In contrast to the sliding window algorithm previously used for electron and photon reconstruction [8], the topological cluster (topo-cluster) is formed in a way that more closely follows spatial signal-significance patterns generated by particle showers. In particular, the observable which governs the seeding and growth of a topo-cluster is the cell significance, \(\varsigma^{\rm EM}_{\rm cell}\), computed as,

\[\varsigma^{\rm EM}_{\rm cell}=\left|\frac{E^{\rm EM}_{\rm cell}}{\sigma^{\rm EM }_{\rm noise,cell}}\right|, \tag{1}\]

where \(|E^{\rm EM}_{\rm cell}|\) is the absolute cell energy at the EM scale and \(\sigma^{\rm EM}_{\rm noise,cell}\) is the expected cell noise. The standard topo-cluster reconstruction algorithm in ATLAS begins by forming _proto-clusters_ using a set of noise thresholds in which the initial cell is required to have \(\varsigma^{\rm EM}_{\rm cell}\geq 4\). In this initial stage, cells fromFigure 2: Algorithm flow diagram for the new electron and photon reconstruction.

the presampler and L1 are excluded from initiating proto-clusters, as doing so suppresses the formation of noise clusters. The proto-clusters then collect neighbouring cells with significance \(\varsigma_{\text{cell}}^{\text{EM}}\geq 2\). Each neighbour cell passing the noise threshold of \(2\sigma\) becomes a seed cell in the next iteration, collecting each of its neighbors in the proto-cluster. If two proto-clusters contain the same cell with absolute energy \(2\sigma\) above the noise threshold, these proto-clusters are merged. After all nearby cells with absolute energies above \(2\sigma\) have been collected, a final set of neighbouring cells with \(\varsigma_{\text{cell}}^{\text{EM}}\geq 0\) are added to the cluster. This set of thresholds is commonly known as "4-2-0" topo-cluster reconstruction.

After the initial collection of proto-clusters is formed, any proto-clusters with two or more local maxima can be split into separate clusters. In this case, a local maximum is signified by \(E_{\text{cell}}^{\text{EM}}>500\,\text{MeV}\), in addition to the requirements that the maximum cell has at least four neighbours, and that none of the neighbours have a larger signal. In principle, cells can be shared between two proto-clusters which have split into separate top-clusters, with the cell assigned a fractional weight for each cluster based on the energies of the clusters, and the distances of the cell to the center of gravity of the two clusters \((d_{1},d_{2})\). The fractional weight assigned to the first cluster is given by [2],

\[w_{\text{cell,1}}=\frac{E_{\text{clus,1}}^{\text{EM}}}{E_{\text{clus,1}}^{ \text{EM}}+r\;E_{\text{clus,2}}^{\text{EM}}} \tag{2}\]

where \(r=\exp(d_{1}-d_{2})\), such that the weight for the cell in the second split cluster is given by [2],

\[w_{\text{cell,2}}=1-w_{\text{cell,1}}=\frac{r\;E_{\text{clus,2}}^{\text{EM}}}{ E_{\text{clus,1}}^{\text{EM}}+r\;E_{\text{clus,2}}^{\text{EM}}}. \tag{3}\]

### Building EM topo-clusters

In practice, the topo-cluster algorithm is not limited to one region of the detector; cells from both the LAr and Tile calorimeters may be included in a single topo-cluster. The choice was made to build electron and photon clusters using the set of 4-2-0 topo-clusters reconstructed by default in the ATLAS software, meaning that the initial clusters must be modified to consider cells from the EM calorimeter only. The primary reason for using the same initial topo-clusters as other ATLAS object reconstruction algorithms (jets, \(\tau\) leptons, etc.) is that doing so allows for future improvements to topo-cluster-based isolation calculations [9, 10], as well as the potential for adoption of a detector-wide particle flow reconstruction algorithm [11, 12]. The efficiency and purity of selecting clusters originating from true EM showers can also be enhanced by placing initial cuts on the cluster energy within the EM calorimeter, and summing cells appropriately.

To begin the electron and photon reconstruction, rather than building a new set of clusters, the algorithm duplicates the set of 4-2-0 topoclusters reconstructed in the entire calorimeter system. To isolate clusters which are primarily the result of showers in the EM calorimeter, a initial selection cut is made for each cluster on the EM fraction, \(f_{\text{EM}}\), calculated as,

\[f_{\text{EM}}=\frac{E_{\text{L1}}+E_{\text{L2}}+E_{\text{L3}}+w\cdot(E_{\text{ E4}}+E_{\text{PS}})}{E_{\text{clus}}},\;\;\;w=\begin{cases}1,&1.37<|\eta|<1.63\\ 0,&\text{otherwise}\end{cases} \tag{4}\]where \(E_{\rm Lx}\) is the cluster energy in layer \(x\) of the calorimeter. The term (\(E_{\rm E4}+E_{\rm PS}\)) is only considered for clusters within the transition region of \(1.37<|\eta|<1.63\), since electrons and photons in that \(\eta\) region tend to deposit non-negligible amounts of energy in the pre-sampler and E4 scintillators. The latter term is excluded in other detector regions to decrease noise. Hadronic contributions to the cluster are suppressed by removing the hadronic calorimeter cells from each cluster, leaving only cells belonging to the LAr calorimeter, the presampler, and the E4 scintillators. After this step, the cluster position and kinematics are recalculated using the remaining cells.

An important consideration is robustness against the reconstruction and selection of spurious EM clusters which come from pile-up interactions, as well as \(\pi^{0}\to\gamma\gamma\) decays. To this end, a lower threshold of \(E_{\rm T}>400\) MeV was set to accept topo-clusters. This threshold was chosen to be similar to that which was previously set for topo-cluster-based studies of \(J/\psi\to e^{+}e^{-}\) decays [13], as well as studies of \(\pi^{0}\to\gamma\gamma\) decays at \(\sqrt{s}=900\) GeV [14]. This threshold also roughly corresponds to the \(p_{\rm T}\) acceptance threshold for Inner Detector tracks.

Studies were performed to determine an optimal value of \(f_{\rm EM}\) which limits the acceptance of clusters originating from pile-up interactions and hadronic particles, while maximizing the efficiency of selecting primary electron clusters. To this end, samples of simulated single electrons were produced using a Geant-based Monte Carlo generator and passed through a full simulation of the ATLAS detector [15; 16]. The simulated electrons were reconstructed under two scenarios: without simulated pile-up effects; and with a pile-up level of \(\langle\mu\rangle\sim 25-30\). In the latter scenario, any clusters within \(\Delta\eta<0.2\) and \(\Delta\phi<0.2\) of the generated electron in each event were removed to obtain a sample consisting purely of pile-up clusters. Distributions of \(f_{\rm EM}\) and the electron reconstruction efficiency for various cuts on \(f_{\rm EM}\) are shown in Figure 3 for true electron clusters which have been reconstructed with \(\langle\mu\rangle=0\), and pile-up clusters. Ultimately, \(f_{\rm EM}>0.5\) was chosen as a pre-selection requirement on the initial topo-clusters, as it rejected \(\sim 60\%\) of pile-up clusters without limiting the efficiency for selecting true electron topo-clusters.

Figure 3: Distributions of \(f_{\rm EM}\) and reconstruction efficiency for simulated true electron clusters (black) and pile-up (red) with \(\langle\mu\rangle\leq 30\).

## 5 Track reconstruction, track-cluster matching, and photon conversion reconstruction

Track reconstruction for electrons and photons remains largely unchanged from what is described in Ref. [4]. Therefore, the following sections briefly summarize the track reconstruction and track-cluster matching methods used for electron and photon reconstruction in ATLAS. This section also contains a description of changes to the track reconstruction component of the converted photon reconstruction which allow for improved efficiency in higher noise and luminosity conditions.

### Track reconstruction for electrons and photons

Electron and photon track reconstruction in ATLAS begins with EM clusters that pass loose shower shape requirements in hadronic leakage and energy distribution in \(\eta\). These initial clusters are used to create Regions of Interest (ROIs). Within these ROIs, standard track pattern reconstruction [17] is first performed everywhere. If the pattern recognition fails for a silicon track seed that is within an ROI, a modified pattern reconstruction algorithm is performed based on a Kalman filter formalism [18], allowing for up to 30% energy loss at each material intersection. Track candidates are then fitted with the global \(\chi^{2}\) fitter [19], allowing for additional energy loss in cases that the standard track fit fails. Tracks with silicon hits loosely matched to EM clusters are refitted using a Gaussian Sum Filter (GSF) fitter [20], a non-linear generalization of the Kalman filter, for improved track parameter estimation.

### Track matching for electrons

The loosely-matched, refitted tracks are then matched to EM clusters with tighter requirements in \(\eta\) and \(\phi\). If multiple tracks are matched to a cluster, they are sorted in the following order, with the first being used to define the electron properties. Tracks with hits in the pixel detector are preferred, then tracks with hits in the SCT, but not in the Pixel detector. Within each category, tracks with a better \(\Delta R\) match in \(\eta\) - \(\phi\) - where the extrapolation is done with the track momentum rescaled to the cluster energy first and unrescaled second - are preferred, unless the differences are small. In the latter case, the track with more pixel hits is preferred, giving an extra weight to a hit in the innermost layer. The momentum rescaling is performed to improve track-cluster matching in instances where the track momentum changes significantly due to bremsstrahlung radiation. Tracks are matched to potential seed clusters using variables related to the distance between the track and cluster. Further details are given in Ref. [4].

### Photon conversion reconstruction

The photon reconstruction is largely unchanged from the method described in Ref. [5]. The loosely-matched tracks described in Section 5.1 serve as input to the conversion vertex reconstruction. Both tracks with silicon hits (denoted _Si tracks_) and tracks reconstructed only in the TRT (denoted _TRT tracks_) are used for the conversion reconstruction. Two-track conversion vertices are reconstructed from two tracks forming a vertex consistent with that of a massless particle, while single-track vertices are essentially tracks without hits in the innermost sensitive layers. To increase the converted photon purity, the tracks used to build conversion vertices must generally have a high probability to be electron tracks as determined by the TRT [21], especially for single-track vertices and conversion vertices constructedfrom standalone-TRT tracks. If there are multiple conversion vertices matched to a cluster, double-track conversions with two silicon tracks are preferred over other double-track conversions, followed by single-track conversions. Within each category, the vertex with the smallest conversion radius is preferred. Conversion vertex matching is performed twice, first to the potential seed clusters, and then to the complete photon superclusters. An arbitration relying on the properties of the tracks and conversion vertices matched to a given EM cluster is performed to determine whether an object is reconstructed as an electron, a photon, or both.

Since the publication of Ref. [5], the converted photon reconstruction has undergone several changes to improve both converted reconstruction efficiency, and rejection of fake converted photons. These changes were made over two iterations of the reconstruction software, denoted the _previous_ and _current_ iterations, with the latter being the most recent iteration of the software detailed in this note. For the previous version of the reconstruction software, improvements were made in track reconstruction and conversion vertex building for TRT tracks. The reconstruction of TRT tracks was restricted to ROIs defined by EM clusters as in Section 5.1. The efficiency for the reconstruction of double-track TRT conversions was improved by allowing the reconstruction of TRT tracks which share up to 70% of hits. To reduce the fraction of unconverted photons reconstructed as double- or single-track TRT conversions, requirements on the TRT

Figure 4: The top plot shows the converted photon reconstruction efficiency and contributions of the different conversion types as a function of \(E_{\mathrm{T}}^{\mathrm{true}}\), inclusive in \(\langle\mu\rangle\) for a uniform \(\langle\mu\rangle\) distribution between 0 and 60. On the bottom, efficiency of the reconstruction of converted photons and contributions of the different conversion types (left), and the probability of an unconverted photon to be mistakenly reconstructed as a converted photon and contributions of the different conversions types (right), both as a function of \(\langle\mu\rangle\).

tracks were tightened. The tracks were required to have at least 25% precision hits, defined as hits with a track-to-wire distance within 2.5 times of its uncertainty [22]. In addition, the determination of the probability of a track to be an electron using high-threshold hit information from the TRT was improved, taking into account the TRT occupancy as a measure of the pile-up level of an event [23].

For the current version of the reconstruction software, additional changes were made to both improve the reconstruction efficiency of double-track Si conversions, and reduce the fraction of unconverted photons mistakenly reconstructed as double- or single-track TRT conversions. The efficiency for double-track Si conversions was improved by modifying the tracking ambiguity processor, which determines which track seeds are retained to reconstruct tracks. For double-track conversion topologies, the two tracks are expected to be close-by, parallel, and to potentially have shared hits, therefore oftentimes only one track is reconstructed. The optimization in the ambiguity processor results in the recovery of the second track that was previously discarded. Overall, these modifications result in a \(2-4\%\) improvement in efficiency for double-track Si conversions, with larger improvements of up to \(9\%\) for photons with conversion radii larger than 200 mm. In addition to reconstructing the second track of what would otherwise have been single-track Si conversions, the overall conversion reconstruction efficiency is improved by about \(1\%\) by reducing the fraction of low-radius converted photons that is only reconstructed as electrons.

To reduce the fraction of unconverted photons reconstructed as double- or single-track TRT conversions, requirements on the TRT tracks were tightened. The tracks are required to have at least 30% precision hits. In addition, the requirement on the probability of a track to correspond to an electron, as determined by the TRT, was tightened to 0.75 for tracks used in double-track TRT conversions and 0.85 for tracks used in single-track TRT conversions, compared to the previous requirement of 0.7 for tracks used in both conversion types. The fraction of unconverted photons erroneously reconstructed as converted photons is below \(5\%\) for events with \(\langle\mu\rangle<60\).

The top plot in Figure 4 shows the reconstruction efficiency for converted photons as a function of the \(E_{\mathrm{T}}\) of the simulated photon for the previous and current reconstruction software versions described above, along with the contributions of the different conversion types. For a photon to be classified as a true converted photon, the true conversion radius needs be to smaller than 800 mm. Only simulated photons with a transverse energy greater than 20 GeV are considered. The simulated photons are distributed uniformly in \(|\eta|\), with most of the photons having a transverse momentum smaller than 200 GeV. The bottom left plot of Figure 4 shows the reconstruction efficiency for converted photons along with the contributions of the different conversion types as a function of \(\langle\mu\rangle\). The improvement in the reconstruction efficiency for double-track Si conversions and the corresponding reduction of single-track Si conversions is clearly visible. The slight reduction in double- and single-track TRT conversions needed to significantly reduce the rate of true unconverted photons reconstructed as TRT conversion is also visible in the bottom right plot of Figure 4.

## 6 Defining and building superclusters

The reconstruction of electron and photon superclusters proceeds in two stages: In the first stage, top-clusters are evaluated for use as seed cluster candidates, which form the basis of superclusters; in the second stage, clusters near the seed candidates are identified as satellite cluster candidates, which may emerge from bremsstrahlung radiation or top-cluster splitting. Satellite clusters are added to the seed candidates to form the final superclusters, if they pass the necessary selection criteria. The following sections detail the criteria for determining whether a given cluster qualifies as a seed or satellite candidate, and how satellite candidates are associated to seed candidates.

### Selecting topo-clusters to build superclusters

The initial list of potential seed topo-clusters is sorted according to descending \(p_{\mathrm{T}}\), such that higher \(p_{\mathrm{T}}\) seed clusters collect only lower \(p_{\mathrm{T}}\) satellites.1 For a cluster to become an electron supercluster seed, it is required to have a minimum energy of \(1\,\mathrm{Ge\kern-1.0ptV}\) and must be matched to a track with \(\geq 4\) hits in the silicon tracking detector. For photon reconstruction, a cluster must have an energy greater than \(1.5\,\mathrm{Ge\kern-1.0ptV}\) to qualify as a supercluster seed, due to the absence of a matching track.

Footnote 1: As described in Section 4.2, topo-clusters used for building superclusters use only cells in the LAr calorimeter to define the cluster momenta and positions, except in the transition region, where the pre-sampler and E4 scintillators are also used. For the sorting order, and for the seed \(p_{\mathrm{T}}\) selection, the pre-sampler and E4 energy is ignored.

Once a cluster is denoted a supercluster seed, the satellite finding stage begins, in which all remaining unused clusters are examined for association to the seed cluster. In practice, there is no upper \(p_{\mathrm{T}}\) threshold on satellites, other than the requirement that satellites have lower \(p_{\mathrm{T}}\) than the seed cluster. The satellite finding process is summarized diagrammatically in Figure 5. For both electrons and photons, a cluster is considered a satellite if it falls within a window of \(\Delta\eta\times\Delta\phi=0.075\times 0.125\) around the seed cluster barycenter, as these cases tend to represent secondary EM showers originating from the same initial electron or photon.

For electrons, an additional satellite cluster search is performed using a window of \(\Delta\eta\times\Delta\phi=0.125\times 0.3\) around the seed cluster barycenter. Within this larger window, a cluster is considered a satellite if it has \(\geq 1\) matched tracks, such that its "best-matched" track is also the best-matched track for the seed cluster. This step relies more on tracking information to discriminate distant radiative photons from pile-up noise, or other unrelated clusters.

For converted photons, a cluster is added as a satellite if it is either matched to a track that is one track of the conversion vertex associated to the seed cluster, or it has the same matched conversion vertex as the seed cluster. By default, only the best-matched tracks and conversion vertices are used for the matching. Furthermore, only tracks that contain silicon hits, and conversion vertices made up only of tracks containing silicon hits, are used for satellite cluster matching.

Once all satellite clusters have been found for a given seed cluster, the algorithm iterates to the next highest \(p_{\mathrm{T}}\) cluster in the list, and checks whether it has been previously used as a satellite cluster. If the cluster has previously been used as a satellite, it is skipped, and the iteration continues until an unused cluster has been found. When an unused cluster is found which meets the seed cluster requirements, the superclustering algorithm begins again, with this iterative process continuing until all available clusters have been examined.

### Selecting the cells of a supercluster

Once a candidate seed cluster has been associated to a number of satellite candidates, the final step in the superclustering algorithm is to combine the list of cells associated to each individual cluster to make a final list for the supercluster, a process denoted _cell summation_. When combining topo-clusters to form superclusters, only cells from the first three LAr calorimeter layers are considered, as well as the Figure 5: Diagram of the superclustering algorithm for electrons and photons.

Figure 6: Effect of restricting cluster size in \(|\eta|\) on a sample electron supercluster in the second EM calorimeter layer, simulated using a Geant-based Monte Carlo generator. The left plot shows the cluster cells before the \(\eta\)-restriction, and the right plot shows the cells after the restriction. The \(z\)-axis scale is the base-10 logarithm of the cell energy in MeV.

pre-sampler, and the E4 scintillators in the transition region. Due to topo-cluster splitting, it is possible for two separate clusters to contain the same cell, with each cluster receiving a fraction of the cell energy. If two clusters which share cells are summed together, the energy of the summed cluster should equal the summed energies of the individual clusters, as each cell can only contribute a maximum of \(E_{\rm cell}\) to the overall construction.

The lateral size of an EM shower is typically a few Moliere radius units, e.g. 90% of the energy is contained in one unit, and 95% in two units, with material interactions spreading mainly in the \(\phi\)-direction. Within the current calibration procedure, as described in Section 8, better systematic uncertainty estimates on the linearity of the energy response are expected if the _lateral leakage_ - or the fraction of true shower energy not contained in a cluster - is roughly constant with increasing energy. Therefore, as a final step prior to calibration, the size of each constituent topo-cluster is restricted to three (five) cells across in the \(\eta\) direction in the barrel (end-cap) region, with respect to the cluster barycenter 2. This restriction is accomplished by removing cells from the cluster which fall outside of the threshold in \(\eta\). Accordingly, restricting the cluster size in the \(\eta\)-direction limits the inclusion of cells which do not contain a significant amount of true energy. No restrictions are applied in the \(\phi\)-direction, which allows the cluster to include cells containing energy from interactions between the primary electron or photon, and the detector material.

Footnote 2: The full cluster information is also retained to allow for later use by physics analyses.

An illustration of the effect of the \(\eta\)-restriction with an electron supercluster is shown in Figure 6, where the distribution of cells is shown in the second EM calorimeter layer. In this distribution, the \(z\)-axis is the logarithm of the cell energy in MeV. The lateral leakage is correlated to the _shower containment_\(E_{\rm true}^{\rm cluster}/E_{\rm true}^{\rm shower}\), or the ratio of the EM scale energy contained in the cluster, to the total EM scale energy deposited by the particle shower in the calorimeter. The effects of the \(\eta\)-restriction on the shower containment and number of cluster cells acquired were evaluated using simulated electrons generated using a Geant-based Monte Carlo generator with \(\langle\mu\rangle=0\), and passed through a full simulation of the ATLAS detector [15; 16]. As shown in Figure 7, the change in the average shower containment for \(\eta\)-restricted superclusters is on-par with clusters built using the sliding window algorithm, although the value of the containment tends to be higher, particularly for end-cap clusters. The \(\eta\)-restriction does not significantly impact the electron and converted photon reconstruction, as the magnetic field in the Inner Detector ensures that the separation of the electron and bremsstrahlung photons (or the converted photon tracks) occurs mainly in the \(\phi\) direction. Likewise, Figure 8 shows that the average number of cells acquired per topo-cluster changes less rapidly with increasing shower energy for electrons built using \(|\eta|\)-restricted topo-clusters, suggesting a better robustness against the acquisiton of extra cells from e.g. pile-up interactions at higher electron energies.

## 7 Uncalibrated supercluster performance

The reconstruction of supercluster electrons and photons was assessed using samples of simulated single particles, generated using a Geant-based Monte Carlo generator and passed through a full simulation of the ATLAS detector [15; 16]. The samples were generated with \(\langle\mu\rangle=0\), while using noise thresholds tuned for \(\langle\mu\rangle\sim 40\), both to allow a consistent description of the performance improvements before and after calibration, and also serve as input for the multivariate energy calibration described in Section 8. The samples are generated such that the inclusive distribution of \(E_{\rm T}^{\rm true}\) is uniform between 0 and 3 TeV, and the distribution of \(|\eta_{\rm true}|\) is uniform between 0 and 2.47. The quantities of interest for assessing performance with respect to previous software iterations are the peak and width (resolution) of the energy response,Figure 7: Average shower containment as a function of true shower energy for simulated electrons reconstructed via sliding window and supercluster-based approaches with \(\langle\mu\rangle=0\). Included also are superclusters built using topo-clusters which are allowed unrestricted growth in the \(\eta\)-direction.

Figure 8: Average number of cluster cells as a function of true shower energy for simulated electrons reconstructed via sliding window and supercluster-based approaches with \(\langle\mu\rangle=0\). Included also are superclusters built using topo-clusters which are allowed unrestricted growth in the \(\eta\)-direction.

\(E_{\text{raw}}/E_{\text{true}}\), where \(E_{\text{true}}\) is the truth energy of the particle generated via Monte Carlo, prior to any detector simulation, and \(E_{\text{raw}}\) is the raw (uncalibrated) _accordion energy_, where \(E_{\text{raw}}=E_{L1}+E_{L2}+E_{L3}\). To quantify the width of the energy response, the _effective interquartile range_ is used, defined as,

\[\text{IQE}=\frac{Q_{3}-Q_{1}}{2\Phi^{-1}(0.75)}. \tag{5}\]

In this equation, \(Q_{3}-Q_{1}\) is the _interquartile range_ (IQR) of the energy response. Here, \(Q_{1}\) and \(Q_{3}\) are the first and third quartiles of the distribution, and the function \(\Phi\) is the cumulant of the standard Normal distribution. The area between two consecutive quartiles encompasses 25% of the full distribution, such that the area enclosed by \(Q_{1}\) and \(Q_{3}\) contains the middle 50% of the distribution.

The IQE is used to characterize energy resolution in single particles because it more properly factors in asymmetric behaviour in the tails of the energy response, in comparison to a Gaussian fit around the peak of the response, for example. These tails can be prevalent for low \(p_{\text{T}}\) charged particles, where bremsstrahlung losses can limit the amount of energy recovered from a given EM shower. Conversely, the width of a Gaussian fit around the peak of the energy response may underestimate this important effect. The peak position of the energy response distribution is used as another metric of performance; a peak closer to \(E_{\text{raw}}/E_{\text{true}}=1\) indicates a better estimate of the true energy deposited by the shower, meaning that the relative correction done by the calibration will be smaller. The peak of the response distribution is obtained using a Gaussian fit in a region \([-3\sigma,2\sigma]\) around the mean of the distribution, where \(\sigma\) is taken to be the RMS of the response distribution.

### Electrons and converted photons

Comparisons of the uncalibrated response of simulated single electrons built using sliding window and supercluster-based approaches are given in Figures 9 and 10. The uncalibrated cluster energy serves as an input to the energy calibration applied afterward, as described in Section 9. In particular, Figure 9 shows a comparison of the IQE of the two methods in different regions of \(|\eta_{\text{true}}|\) and \(E_{\text{T}}^{\text{true}}\), while Figure 10 shows the fitted Gaussian peak for the same regions. The reconstructed electrons in these distributions are required to correspond to true primary electrons, and are required to pass loose electron quality requirements [24]. The cluster-related variables in the electron quality requirements for superclusters are the same as those used for sliding window clusters. Therefore, for a supercluster with the same barycenter as a sliding window cluster, reconstructed using the same underlying shower, the quality requirements should produce the same result.

In most regions of phase space, the supercluster algorithm either matches the performance of the sliding window in terms of resolution or peak position, or improves upon the previous algorithm. A notable improvement in resolution can be found in the end-cap region of the detector, as well as in the central region for low \(p_{\text{T}}\) electrons. At higher \(p_{\text{T}}\), the two algorithms tend to converge to the same results in terms of resolution, although the fitted Gaussian peak is consistently closer to \(E_{\text{raw}}/E_{\text{true}}=1\), suggesting the topocluster-based reconstruction captures more true energy than the sliding window-based approach.

Comparisons of the uncalibrated response of converted photons built using sliding window and supercluster-based approaches are given in Figure 11, showing the IQE of the two methods in different regions of \(|\eta_{\text{true}}|\) and \(E_{\text{T}}^{\text{true}}\), and Figure 12, showing the fitted Gaussian peak for the same regions. The reconstructed converted photons in these distributions are required to correspond to true primary photons, and pass Figure 10: Uncalibrated peak position of the energy response, calculated using a Gaussian fit to the core of the response distribution, for simulated electrons with \(\langle\mu\rangle=0\), with noise thresholds tuned for \(\langle\mu\rangle\sim 40\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

Figure 9: Uncalibrated energy response resolution, expressed in terms of IQE, for simulated electrons with \(\langle\mu\rangle=0\), with noise thresholds tuned for \(\langle\mu\rangle\sim 40\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

loose photon quality requirements [25]. The cluster-related variables in the photon quality requirements for superclusters are the same as those used for sliding window clusters. Therefore, for a supercluster with the same barycenter as a sliding window cluster, reconstructed using the same underlying shower, the quality requirements should produce the same result. The supercluster algorithm for converted photons performs similarly to the electron case, either matches the performance of the sliding window algorithm, or improving upon the previous algorithm. A notable improvement in resolution can be found in the end-cap region of the detector, as well as in the central region for low \(p_{\mathrm{T}}\) converted photons.

### Unconverted photons

Comparisons of the uncalibrated response of unconverted photons built using sliding window and supercluster-based approaches are given in Figures 13 and 14. In particular, Figure 13 shows a comparison of the IQE of the two methods in different regions of \(|\eta_{\mathrm{true}}|\) and \(E_{\mathrm{T}}^{\mathrm{true}}\), while Figure 14 shows the fitted Gaussian peak for the same regions. The reconstructed unconverted photons in these distributions are required to correspond to true primary photons, and pass loose photon quality requirements [25].

Unlike converted photons and electrons, unconverted photons do not leave tracks in the Inner Detector, hence they are not subject to energy loss due to bremsstrahlung radiation. Therefore, it is not expected that the use of superclustering will consistently improve the resolution of reconstructed unconverted photons. As shown in Figures 13 and 14, for barrel photons, there is little to no change in resolution observed between unconverted photons reconstructed using sliding window and supercluster approaches, although supercluster performance can degrade at very high \(p_{\mathrm{T}}\). It is observed that some \(E_{\mathrm{T}}\) bins in \(1.52<|\eta|<1.81\) show resolution improvement, however, but the overall performance is equivalent to the previous algorithm.

## 8 MVA calibration

For both electrons and photons, a multivariate (MVA) approach is used for energy calibration, where regression boosted decision trees (BDT) are trained to correct the uncalibrated energies of electron and photon candidates. A detailed description of the calibration method and performance is given in Ref. [26], but a brief explanation follows for contextual purposes. The multivariate training is performed separately for electrons, converted photons, and unconverted photons. For each type of particle, single particle samples are used for training and testing, where the particles have passed through a full detector simulation, but no simulated pile-up noise is added. The multivariate algorithm uses information on the correlations between a set of input training variables and a _target_\(E_{\mathrm{true}}/E_{\mathrm{raw}}\) to derive a correction factor for the target variable, such that its distribution is centred around one. This correction factor is then applied to \(E_{\mathrm{raw}}\) to retrieve the calibrated energy.

The training variables used in the MVA calibration for electrons and photons are the uncalibrated energy, \(E_{\mathrm{raw}}\); the ratio \(f_{0}\) of the pre-sampler energy to the calorimeter energy \(E_{L0}/E_{\mathrm{raw}}\); the ratio of the energies measured in the first two layers of the calorimeter, \(E_{L1}/E_{L2}\); the cluster barycenter pseudorapidity in the ATLAS coordinate system, \(\eta_{\mathrm{clus}}\); the cell index, or the distance of the cluster from \(\eta=0\) in the calorimeter frame, in terms of the number of cells in the \(\eta\)-direction; and cluster barycenter variables related to \(\eta\) and \(\phi\) within the calorimeter frame. For the latter two variables, \(\eta_{\mathrm{Calo}}\) is given as the \(\eta\) position with respect to the cell center in \(\eta\), while \(\phi_{\mathrm{Calo}}\) is the \(\phi\) position with respect to the absorber axis.

Figure 11: Uncalibrated energy response resolution, expressed in terms of IQE, for simulated converted photons with \(\langle\mu\rangle=0\), with noise thresholds tuned for \(\langle\mu\rangle\sim 40\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

Figure 12: Uncalibrated peak position of the energy response, calculated using a Gaussian fit to the core of the response distribution, for simulated converted photons with \(\langle\mu\rangle=0\), with noise thresholds tuned for \(\langle\mu\rangle\sim 40\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

Figure 14: Uncalibrated peak position of the energy response, calculated using a Gaussian fit to the core of the response distribution, for simulated unconverted photons with \(\langle\mu\rangle=0\), with noise thresholds tuned for \(\langle\mu\rangle\sim 40\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

Figure 13: Uncalibrated energy response resolution, expressed in terms of IQE, for simulated unconverted photons with \(\langle\mu\rangle=0\), with noise thresholds tuned for \(\langle\mu\rangle\sim 40\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

Photons are considered converted if the conversion radius \(R_{\mathrm{conv}}\) is smaller than 800 mm. For these converted photons, \(R_{\mathrm{conv}}\) is used as an additional input to the MVA only if the vectorial sum of the conversion track momenta is above 3 GeV. For conversions with both tracks containing at least one hit in either the pixel or SCT detector, further quantities are considered: \(E_{\mathrm{T}}^{\mathrm{raw}}/p_{\mathrm{T}}^{\mathrm{conv}}\), where \(p_{\mathrm{T}}^{\mathrm{conv}}\) is the vectorial sum of the conversion track momenta; and the fraction of the conversion momentum carried by the highest-\(p_{\mathrm{T}}\) track, \(p_{\mathrm{T}}^{\mathrm{max}}/p_{\mathrm{T}}^{\mathrm{conv}}\).

A comparison between the shapes of the common MVA training variables for electrons and photons is given in Figure 15, wherein good agreement is observed between the two clustering algorithms for each training variable. Distributions of variables used specifically for the calibration of converted photon clusters are shown in Figure 16, which also demonstrate good agreement between the supercluster and sliding window-based reconstruction algorithms. Although the shapes of the training variables do not change significantly between clustering algorithms, the improved knowledge of the uncalibrated energy, and the change in correlations to the truth energy and other training variables, is expected to provide new information to be extracted by the BDT, translating into an improvement in calibrated energy.

## 9 Calibrated supercluster performance

The following sections demonstrate the results of the MVA calibration, as performed using samples of simulated single particles reconstructed both via sliding window and supercluster-based approaches. As previously mentioned in Section 7, the single particle samples are produced without simulated pile-up. The metric of comparison between the sliding window and supercluster-based reconstruction algorithms is the ratio of the calibrated cluster energy to the true particle energy, \(E_{\mathrm{cal}}/E_{\mathrm{true}}\). The MVA calibration is performed using training and testing samples which contain no simulated pile-up, so the following results are presented without simulated pile-up. After calibration, the peaks of the \(E_{\mathrm{cal}}/E_{\mathrm{true}}\) distributions do not deviate from 1 by more than 0.5%.

### Electrons and converted photons

Comparisons of the calibrated energy response of simulated single electrons built using sliding window and supercluster-based approaches are given in Figure 17, comparing the IQE of the two methods in different regions of \(|\eta_{\mathrm{true}}|\) and \(E_{\mathrm{T}}^{\mathrm{true}}\). The reconstructed electrons in these distributions are required to correspond to true primary electrons, and pass loose electron quality requirements. After calibration, the supercluster algorithm retains a good improvement in resolution compared to the sliding window algorithm. In particular, an improvement in resolution of up to 20-30% is found in some bins in the end-cap region of the detector, as well as in the central region for low \(E_{\mathrm{T}}\) electrons.

Comparisons of the calibrated response of converted photons built using sliding window and supercluster-based approaches are given in Figure 18. The reconstructed converted photons in these distributions are required to correspond to true primary photons, and pass loose photon quality requirements. Similarly to the electron case, good improvements in the resolution can also be seen for converted photons, in a few bins at over 30%.

Figure 16: Distributions of track-based MVA calibration training variables for sliding window and supercluster-based converted photons using the current reconstruction software.

Figure 15: Distributions of cluster-based MVA calibration training variables for sliding window and supercluster-based electrons and photons. Here, \(\eta_{\text{Calo}}\) is given as the \(\eta\) position with respect to the cell center in \(\eta\), while \(\phi_{\text{Calo}}\) is the \(\phi\) position with respect to the absorber axis. The cell index is the distance of the cluster from \(\eta=0\) in the calorimeter frame, in terms of the number of cells in the \(\eta\)-direction.

Figure 17: Calibrated energy response resolution, expressed in terms of IQE, for simulated electrons with \(\langle\mu\rangle=0\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

Figure 18: Calibrated energy response resolution, expressed in terms of IQE, for simulated converted photons with \(\langle\mu\rangle=0\). Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

### Unconverted photons

Comparisons of the calibrated response of unconverted photons built using sliding window and supercluster-based approaches are given in Figure 19. In particular, Figure 19 shows a comparison of the IQE of the two methods in different regions of \(|\eta_{\mathrm{true}}|\) and \(E_{\mathrm{T}}^{\mathrm{true}}\). The reconstructed unconverted photons in these distributions are required to correspond to true primary photons, and pass loose photon quality requirements. As with the uncalibrated energy response, the overall change in performance is small, due to the generally narrower shower width, and the absence of bremsstrahlung for unconverted photons. However, some improvement in calibrated resolution is observed for high \(p_{\mathrm{T}}\) bins in the end-cap region.

## 10 Supercluster performance in the presence of simulated pile-up

An important consideration when using a top-cluster-based reconstruction is the sensitivity of the energy resolution to the presence of additional clusters from pile-up interactions. The noise thresholds for topo-cluster reconstruction tend to be set empirically, according to the expected luminosity and detector conditions of a particular data taking period. The topo-cluster noise thresholds for the 2016 and 2017 data taking period, for instance, are tuned for \(\langle\mu\rangle\sim 40\). To study the effects of different pile-up levels on the electron and photon energy resolution given these thresholds, Monte Carlo samples of single particles were generated under different luminosity conditions, with each event having a possible average

Figure 19: Calibrated energy response resolution, expressed in terms of IQE, for simulated unconverted photons with \(\langle\mu\rangle=0\). Sliding window-based response is shown in red, with the supercluster-based response in blue.

number of interactions per bunch crossing in the range \(0<\langle\mu\rangle<60\), with the distribution of \(\langle\mu\rangle\) being uniform between 0 and 60. In this scenario, the average pile-up noise is \(\mathcal{O}\) (650 MeV) for \(E_{\mathrm{T}}=25\) GeV at \(\langle\mu\rangle=60\).

For consistency with the performance plots show without pile-up, electrons and photons are required to pass loose identification requirements [24, 25]. To ensure a sufficiently high purity for the resolution distributions, particles are required to have \(E_{\mathrm{T}}>7\)GeV. Distributions of energy response in terms of MVA-calibrated \(E_{\mathrm{cal}}/E_{\mathrm{true}}\) were produced for the barrel and end-cap detector regions, with events split up into various \(E_{\mathrm{T}}\) bins. For these distributions, the resolution is expressed through the IQE, which is computed as described in Section 7. Figure 20 shows the resolution of the energy response distribution for MVA-calibrated electron clusters in different truth \(|\eta|\) and \(E_{\mathrm{T}}\) regions, in slices of \(\langle\mu\rangle\). Likewise, Figures 21 and 22 show the same distributions for MVA-calibrated converted and unconverted photon clusters, respectively. For both supercluster- and sliding window-based methods, the position of the Gaussian fit for electrons and photon clusters does not deviate more than 1% from \(E/E_{\mathrm{true}}\sim 1\). Furthermore, for \(p_{\mathrm{T}}\) above 25 GeV, the peak position does not change more than 0.5% with increasing \(\langle\mu\rangle\) in any \(\eta\) or \(E_{\mathrm{T}}\) region. These minor deviations are consistent across both reconstruction methods, therefore these plots are not shown.

With increasing \(\langle\mu\rangle\), the performance of both clustering algorithms degrades due to clusters containing more noise on average, in addition to the true shower energy. However, a secondary effect is visible for superclusters, in that the relative improvements in resolution become smaller with respect to the sliding window method, particularly in the end-cap region and high \(E_{\mathrm{T}}\), where tracking performance is more limited. Such a result is partly unexpected; because the topo-cluster noise thresholds are tuned to cover mainly \(\langle\mu\rangle\leq 40\), additional cells containing mostly pile-up noise may be accumulated alongside cells containing true EM signal for events with \(\langle\mu\rangle>40\). Unconverted photons, in particular, produce narrow showers which do not spread in the \(\phi\)-direction from material interactions, so allowing the cluster to spread beyond \(2-3\times\) the Moliere radius results in a reduced signal-to-noise ratio within a given cluster. Since the noise thresholds for a given data taking period are adjusted according to the expected \(\langle\mu\rangle\), future studies will need to be performed to validate that the improvements that are visible at lower \(\langle\mu\rangle\) maintain for high pile-up, using more appropriate noise thresholds.

In future iterations of the reconstruction software, the use of pile-up sensitive variables may be possible in training the MVA calibration, allowing for a calibration that can adapt as necessary to higher luminosity conditions. A modification of the calibration methodology may also be necessary for unconverted photons to counter the effects of higher pile-up in the calibrated energy response. Likewise, a pile-up subtraction method akin to that used in ATLAS jet reconstruction [27] may also provide electron and photon clusters with additional pile-up robustness. Lastly, tuning the cell summation for clusters with no associated tracks may allow for a reduced sensitivity to higher pile-up, since such particles are unambiguously defined as unconverted photons in the reconstruction algorithm.

## 11 Supercluster performance in realistic topologies

To this point, the performance of the supercluster-based reconstruction algorithm has been evaluated using single particles in isolation, and in the presence of simulated pile-up. However, the electron and photon reconstruction ultimately serves as input to several analyses which target precision measurements, searches, as well as tests for new physics. Therefore, the supercluster-based reconstruction algorithm was applied to simulations of several relevant physics topologies, including those used for precision physics Figure 21: Calibrated energy response resolution, expressed in terms of IQE, for simulated single converted photons at different \(\langle\mu\rangle\) levels. Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

Figure 20: Calibrated energy response resolution, expressed in terms of IQE, for simulated single electrons at different \(\langle\mu\rangle\) levels. Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

analyses, as well as Higgs boson physics analyses. Comparisons were also made to the same simulated samples reconstructed using the sliding window-based reconstruction algorithm, in order to gauge the improvement brought by the new topo-cluster-based reconstruction.

### \(J/\psi\to e^{+}e^{-}\) and \(Z\to e^{+}e^{-}\)

The performance of the supercluster algorithm in \(J/\psi\to e^{+}e^{-}\) decays yields critical information on how the current reconstruction software performs for low-mass resonances, as well as low \(p_{\mathrm{T}}\) electrons in general. Samples of Monte Carlo events were generated using the Powheg generator [28], and showered using Pythia 8[29]. The simulated data were reconstructed using two approaches: the reconstruction algorithm and MVA calibration based on sliding window electrons; and the latest reconstruction software and calibration using superclusters. Dielectron \(J/\psi\) pair candidates were formed using the two highest \(p_{\mathrm{T}}\) electrons that pass loose quality requirements [24]. An important point is that the simulated \(J/\psi\) events reconstructed using the sliding window-based method have a distribution of \(\langle\mu\rangle\) which ends roughly at \(\langle\mu\rangle=30\), due to being produced using the previous reconstruction software for an earlier data taking period. Therefore, all \(J/\psi\) boson candidate events were required to have \(15<\langle\mu\rangle<30\), in order to compare the performance of the two algorithms under luminosity conditions that are roughly equivalent.

Distributions of the reconstructed dielectron invariant mass \(m_{e^{+}e^{-}}\) for simulated \(J/\psi\to e^{+}e^{-}\) events are shown for supercluster and sliding window-based reconstruction algorithms in the left plot of Figure 23. It is evident from the distribution of \(m_{e^{+}e^{-}}\) that the supercluster algorithm improves the mass response for the \(J/\psi\) resonance, providing a narrower resonance with a smaller radiative tail, indicating a compensation

Figure 22: Calibrated energy response resolution, expressed in terms of IQE, for simulated single unconverted photons at different \(\langle\mu\rangle\) levels. Sliding window-based response is shown in red, while the supercluster-based response is shown in blue.

for bremsstrahlung-related energy losses. An improvement of \(\sim 8\%\) is observed in the width of the resonance, as determined using a Gaussian fit to the core of the \(m_{e^{+}e^{-}}\) distribution. A small shift towards the best-known \(J/\psi\) mass is also observed for the supercluster \(m_{e^{+}e^{-}}\) distribution, with the peak of the fitted Gaussian found at \(3.08\,\mathrm{GeV}\) for the supercluster-based distribution, and \(3.05\,\mathrm{GeV}\) for the sliding window-based distribution.

Another important performance consideration is how the reconstruction algorithm responds for \(Z\to e^{+}e^{-}\) decays, which has direct implications for precision Standard Model physics measurements in ATLAS, as well as for critical Higgs boson decay channels such as \(H\to ZZ^{*}\to 4\ell\). To this end, samples of Monte Carlo events were generated at parton-level using the Powheg generator, showered using Pythia 8, and reconstructed using the same configurations as for the \(J/\psi\to e^{+}e^{-}\) studies above. Dielectron \(Z\) pair candidates are formed using the two highest \(p_{\mathrm{T}}\) electrons that pass loose quality requirements [24]. Furthermore, the \(Z\) boson candidate events were required to have \(15<\langle\mu\rangle<30\), for the same reasons as defined above for the \(J/\psi\) candidates.

Distributions of the reconstructed dielectron invariant mass \(m_{e^{+}e^{-}}\) for simulated \(Z\to e^{+}e^{-}\) events are shown for supercluster and sliding window-based reconstruction algorithms in the right plot of Figure 23. The supercluster algorithm improves the mass response of the \(Z\) boson peak, providing a narrower resonance with a smaller radiative tail, indicating a compensation for bremsstrahlung-related energy losses. As shown in Appendix A, the improvement in the ratio of resolution to mean is \(\sim 6\%\), as calculated using a Gaussian fit about the core of the \(m_{e^{+}e^{-}}\) distribution.

### \(H\to ZZ^{*}\to 4\ell\)

In the move to a new electron reconstruction algorithm, a critical consideration for Higgs boson physics is the effect on the \(H\to ZZ^{*}\to 4\ell\) channel, due to the excellent energy and momentum resolution of its final state particles (muons, electrons), and the ability to reconstruct the full final-state system. The \(4\ell\) candidate selection in the \(H\to ZZ^{*}\to 4\ell\) analysis tends to feature a rather inclusive selection of electrons, with loose [24] electrons above \(p_{\mathrm{T}}>7\,\mathrm{GeV}\) capable of being included in Higgs boson

Figure 23: Invariant mass distributions from Monte Carlo simulations of \(J/\psi\to e^{+}e^{-}\) decays (left) and \(Z\to e^{+}e^{-}\) decays (right) for \(15<\langle\mu\rangle<30\), reconstructed using both sliding window and supercluster-based methods. The resolution and mean for each scenario are computed using a Gaussian fit to the core of each distribution.

candidates. Accordingly, the resolution improvements brought for low \(p_{\mathrm{T}}\) and end-cap electrons should lead to an improvement in the mass resolution of reconstructed \(4\ell\) candidates.

To examine the effects of the supercluster-based reconstruction algorithm on the invariant mass resolution of \(4\ell\) candidates, samples of simulated vector boson fusion-mediated (VBF) Higgs boson signal were produced using the Powheg generator, with \(m_{H}=125\,\mathrm{Ge\kern-1.0ptV}\). The parton-level events were showered using Pythia 8, which also simulated the \(H\to ZZ^{*}\to 4\ell\) decays. The events were passed through a full detector simulation in Geant 4, along with simulated pile-up interactions which emulate the luminosity conditions of the 2015 + 2016 data taking period. The simulated events were then reconstructed with ATLAS software, using both sliding window and supercluster-based algorithms. The candidate reconstruction and selection proceeds identically to previous analyses, most recently described in Ref. [30], with minor changes to offset differences in trigger and isolation calculations, which have not been re-optimized for superclusters. In these studies, the topo-cluster noise thresholds have been tuned for luminosity conditions around \(\langle\mu\rangle\leq 40\).

The resultant distributions of \(m_{4\ell}\), as reconstructed using sliding window and supercluster-based ap

Figure 24: Invariant mass distributions of simulated reconstructed four lepton candidates with \(\langle\mu\rangle\leq 40\) using both supercluster and sliding window algorithms, built using \(H\to ZZ^{*}\to 4\ell\) analysis selection. The resolution and mean of each distribution are computed using a double Crystal Ball fit.

proaches, are given in Figure 24 for each electron-related decay channel - namely, \(2\mu 2e\), \(2e2\mu\), and \(4e\), where the first \(2\ell\) in the channel name denotes the leading lepton pair. Each channel shows a visible improvement in both the resolution and peak position, which is directly attributable to the changes in the electron reconstruction. In particular, the supercluster-based \(m_{4\ell}\) distributions are found to be narrower than the sliding window equivalent, and peak closer to the true Higgs boson mass of \(m_{H}=125\,\text{GeV}\).

To quantify the change in peak position and resolution, the invariant mass distributions for each channel were fit with a double Crystal Ball function, which allows the fit to capture both the peak and the tails of the distributions. The \(4e\) and \(2\mu 2e\) channels each show a 5% improvement in resolution using these fits, with the \(2e2\mu\) channel showing a 3% resolution improvement. Additionally, in each channel, the peak of the mass distribution shifts by 500 MeV to 1 GeV toward the true Higgs boson mass. Here, the shift in the peak value of \(m_{4\ell}\) can also be explained by the improvements in electron energy resolution. In particular, since the lepton quadruplet is a composite object made of two or four electrons, an improved representation of the four momentum of each electron will translate to an improved representation of the four momentum of the Higgs boson candidate, meaning that the reconstructed \(m_{4\ell}\) shifts closer to the true mass of the Higgs boson.

### \(H\to\gamma\gamma\)

Another important consideration in the move to a new photon reconstruction algorithm is the effect on the \(H\to\gamma\gamma\) channel, which also has excellent resolution for its final state photons, as well as a fully-reconstructible final state. It is expected that the use of superclustering for converted photons should yield an improvement to the mass resolution of the diphoton final state (\(m_{\gamma\gamma}\)) when converted photons make up one or two elements of the diphoton candidate.

To examine the effects of the supercluster-based reconstruction algorithm on the invariant mass resolution of \(\gamma\gamma\) candidates, samples of simulated gluon fusion-mediated Higgs boson signal were produced using the Powheg generator, with \(m_{H}=125\,\text{GeV}\). The parton-level events were showered using Pythia 8, which also simulates the \(H\to\gamma\gamma\) decays. The events were passed through a full detector simulation in Geant 4, along with simulated pile-up interactions which emulate the luminosity conditions of the 2015 + 2016 data taking period. The simulated events were then reconstructed with ATLAS software, using both sliding window and supercluster-based algorithms. The candidate reconstruction and selection proceeds identically to those of the most recent ATLAS diphoton analyses at \(\sqrt{s}=13\,\text{TeV}\)[31], with minor changes to offset differences in trigger and isolation calculations, which have not been re-optimized for superclusters. In these studies, the topo-cluster noise thresholds have been tuned for luminosity conditions around \(\langle\mu\rangle\leq 40\).

The resultant distributions of \(m_{\gamma\gamma}\), as reconstructed using sliding window and supercluster-based approaches, are given in Figure 25 for three scenarios: The inclusive \(m_{\gamma\gamma}\) distribution; the distribution of \(m_{\gamma\gamma}\) for events with one Si conversion (single-track Si or double-track Si) in the diphoton pair, and one unconverted photon; and the distribution of \(m_{\gamma\gamma}\) for events with two Si conversions (single-track Si or double-track Si). For the inclusive distribution, which includes unconverted photons and conversions with TRT-only tracks, the overall change in shape is small. This behaviour is anticipated by the single particle results for unconverted photons, which show that a fully topo-cluster-based approach shows no resolution improvement relative to a fixed-size window-based method. Likewise, conversions with TRT-only tracks do not benefit from the additional satellite searches done for conversions with tracks containing Si hits,so diphoton events containing conversions with one or more TRT-only tracks will show limited (or no) improvement in the new algorithm.

However, in the remaining plots, which contain diphoton events with one or more converted photons with silicon tracks, there is a visible improvement in the width of \(m_{\gamma\gamma}\). To quantify the change in resolution for each scenario, the invariant mass distributions were fit with Double Crystal Ball functions, using the same approach as the \(H\to ZZ^{*}\to 4\ell\) studies shown in Section 11.2. The change in resolution for these cases is \(5-9\%\), with the largest improvement seen for diphoton events with two double track Si conversions. These results are directly attributable to the changes to converted photon reconstruction, as the improvements in energy resolution for individual converted photons translate to an improvement in mass resolution for these susbsets of diphoton events.

Figure 25: Invariant mass distributions of simulated reconstructed diphoton candidates with \(\langle\mu\rangle\leq 40\) using both supercluster and sliding window algorithms, built using \(H\to\gamma\gamma\) analysis selection. The resolution and mean of each distribution are computed using a double Crystal Ball fit.

## 12 Conclusions

The new ATLAS electron and photon reconstruction algorithm has been presented, which uses top-clusters with 4-2-0 noise thresholds as a base to form dynamically-sized clusters. The algorithm is capable of retrieving nearby top-clusters which have emerged from bremsstrahlung interactions and photon conversions in the Inner Detector, and merging them with seed clusters to form superclusters. The performance of this algorithm has been evaluated for single particles with and without pile-up interactions, as well as in a number of important physics topologies.

The algorithm generally shows good improvement in terms of energy resolution with respect to the sliding window cluster-based reconstruction algorithm. For electrons and converted photons, in particular, improvements in energy resolution of \(30-40\%\) are possible using superclusters, with the largest improvements found for low \(E_{\mathrm{T}}\) particles, and for clusters reconstructed in the end-cap calorimeter. These resolution improvements translate directly to mass resolution improvements of \(5-10\%\) in \(Z\) and \(J/\psi\) decays to \(e^{+}e^{-}\) pairs, as well as \(H\to ZZ^{*}\to 4\ell\) decays featuring electrons, and \(H\to\gamma\gamma\) decays with converted photons.

The performance improvements seen for electrons and converted photons are maintained for scenarios with higher pile-up, as a result of the top-cluster noise thresholds being adjusted to suit the luminosity conditions of a given data taking period. Future improvements to ensure robustness to high-luminosity conditions may include a re-tuning of the cell summation approach for unconverted photons, the derivation of a pile-up-sensitive MVA calibration, and the development of an average pile-up subtraction approach.

## References

* [1] ATLAS Collaboration, _Electron and photon energy calibration with the ATLAS detector using LHC Run 1 data_, Eur. Phys. J. C **74** (2014) 3071, arXiv: 1407.5063 [hep-ex].
* [2] ATLAS Collaboration, _Topological cell clustering in the ATLAS calorimeters and its performance in LHC Run 1_, Eur. Phys. J. **C77** (2017) 490, arXiv: 1603.02934 [hep-ex].
* [3] D. Green, _The Physics of Particle Detectors_, Cambridge monographs on particle physics, nuclear physics, and cosmology, Cambridge Univ. Press, 2000, url: [https://cds.cern.ch/record/381705](https://cds.cern.ch/record/381705).
* [4] ATLAS Collaboration, _Electron efficiency measurements with the ATLAS detector using 2012 LHC proton-proton collision data_, Eur. Phys. J. **C77** (2017) 195, arXiv: 1612.01456 [hep-ex].
* [5] ATLAS Collaboration, _Measurement of the photon identification efficiencies with the ATLAS detector using LHC Run-1 data_, Eur. Phys. J. **C76** (2016) 666, arXiv: 1606.01813 [hep-ex].
* [6] ATLAS Collaboration, _Electron performance measurements with the ATLAS detector using the 2010 LHC proton-proton collision data_, Eur. Phys. J. C **72** (2012) 1909, arXiv: 1110.3174 [hep-ex].
* [7] ATLAS Collaboration, _Electron reconstruction and identification efficiency measurements with the ATLAS detector using the 2011 LHC proton-proton collision data_, Eur. Phys. J. C **74** (2014) 2941, arXiv: 1404.2240 [hep-ex].
* [8] W. Lampl et al., _Calorimeter Clustering Algorithms: Description and Performance_, ATL-LARG-PUB-2008-002, 2008, url: [https://cds.cern.ch/record/1099735](https://cds.cern.ch/record/1099735).
* [9] ATLAS Collaboration, _Electron isolation efficiency, full 2015 data with 25ns bunch spacing_, ATL-COM-PHYS-2015-1486, 2015, url: [https://cds.cern.ch/record/2112167](https://cds.cern.ch/record/2112167).
* [10] ATLAS Collaboration, _Photon isolation efficiencies using radiative \(Z\) decays in 2017 data_, ATL-COM-PHYS-2017-1374, 2017, url: [https://cds.cern.ch/record/2282730](https://cds.cern.ch/record/2282730).
* [11] CMS Collaboration, _Particle-flow reconstruction and global event description with the CMS detector_, CERN-EP-2017-110, 2017, arXiv: 1706.04965 [physics.ins-det].
* [12] ATLAS Collaboration, _Jet reconstruction and performance using particle flow with the ATLAS Detector_, Eur. Phys. J. **C77** (2017) 466, arXiv: 1703.10485 [hep-ex].
* [13] ATLAS Collaboration, _Electron performance of the ATLAS detector using the \(J/\psi\to e^{+}e^{-}\) decays_, ATL-COM-PHYS-2010-518.
* [14] ATLAS Collaboration, _Performance of the ATLAS electromagnetic calorimeter for \(\pi^{0}\to\gamma\gamma\) and \(\eta\to\gamma\gamma\) events_, ATLAS-CONF-2010-006, 2010, url: [https://cds.cern.ch/record/1273999](https://cds.cern.ch/record/1273999).
* [15] J. Allison, K. Amako, J. Apostolakis, H. Araujo, P. Dubois et al., _GEANT4 developments and applications_, IEEE Trans. Nucl. Sci. **53** (2006) 270.