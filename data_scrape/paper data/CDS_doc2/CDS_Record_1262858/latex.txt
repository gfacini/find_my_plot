# ATLAS Level-1 Calorimeter Trigger: Timing Calibration with 2009 LHC Beam Splashes

The ATLAS collaboration

###### Abstract

The ATLAS Level-1 Calorimeter Trigger (L1Calo) identifies high-\(p_{\rm T}\) objects and measures the total and missing \(E_{\rm T}\) in the Tile and Liquid Argon Calorimeters. L1Calo is a hardware based, pipelined system built with custom electronics. Starting with 7200 pre-summed analogue signals received from the calorimeters, the Preprocessor Module conditions and digitizes these signals at the LHC bunch-crossing frequency of 40 MHz. Sampling the peak of the signal is important for assigning the bunch-crossing identification and calculating the deposited energy. A time offset with nanosecond precision is applied independently to each channel to optimize this sampling. This offset was calibrated using beam splash events provided by the LHC in November 2009. The obtained timing results and the procedure to obtain them are presented here.

Introduction

CERN's new Large Hadron Collider (LHC) is designed to collide protons at a centre-of-mass energy of 14 TeV with an instantaneous luminosity of \(10^{34}\,\mathrm{cm}^{-2}\,\mathrm{s}^{-1}\). The Level-1 Trigger (L1) is mainly composed of the Level-1 Calorimeter Trigger (L1Calo), the Level-1 Muon Trigger (L1Muon) and the Central Trigger Processor (CTP), but also includes the Minimum Bias, LUCID, Zero Degree Calorimeter, and Beam Pickup Triggers [1]. L1 is the first of three trigger levels that together reduce the 40 MHz input rate to approximately 200 Hz which on average is the rate limit for recording events. L1 itself reduces the 40 MHz input rate to a nominal rate of less than 100 kHz with a fixed latency of 2.0 \(\upmu\)s. The rate is then further reduced by the Level-2 Trigger to 3.5 kHz. The Event Filter makes the final decision before the event (of approximately 1.3 MB in size) is recorded [1].

The L1Calo system receives \(\sim 7200\) analogue signals from the Liquid Argon and Tile Calorimeters [2, 3]. These signals are pre-summed into Trigger Towers (TT) most of which are \(0.1\times 0.1\) in \(\Delta\eta\times\Delta\phi\). These TT signals first arrive in the Receivers where an analogue gain can be applied for \(E\) to \(E_{\mathrm{T}}\) conversion. They are then conditioned and digitized in the PreProcessor Module (PPM) where the bunch-crossing is identified and the transverse energy (\(E_{\mathrm{T}}\)) measured. This information is sent in parallel to the Cluster Processor (CP) and Jet-Energy Processor (JEP) where high-\(p_{\mathrm{T}}\) electrons/photons, hadrons/taus, and jets are identified. The multiplicities of these objects are counted for selected thresholds. The JEP also provides a total and missing \(E_{\mathrm{T}}\) measurement. The multiplicities per threshold are then transmitted to the CTP where they are used in conjunction with information from other L1 systems to form the Level-1 Accept (L1A) which begins the complete readout of the detector including the L1 trigger system. For more details about the L1Calo system see [4].

In L1Calo, the timing of the input signal digitization directly affects the identification of the correct bunch-crossing and measured energy. The incoming analogue signal peak must be sampled to within \(\pm 5\) ns in order to achieve an energy measurement of better than 2% [5]. This requires a timing calibration at the nanosecond level to be performed for all L1Calo channels. LHC splash events from the November 2009 commissioning runs were used to cross-check and re-calibrate the initial timing of the L1Calo system. Splash events were chosen for the initial timing calibrations due to the high occupancy of L1Calo channels. To reach this occupancy level with the expected collision luminosity that followed at the end of 2009 and early 2010 would have required much more time.

## 2 Analogue Input Signal Timing Calibration

The analogue signals received by L1Calo are digitized in the PPMs at the LHC frequency of 40.08 MHz, which corresponds to one sample about every 25 ns. These digitized samples are used to assign the triggered event to the correct LHC bunch-crossing and to determine the energy deposited in the corresponding TT. It is important that the analogue signals be sampled at the peak in order to properly carry out these functions. Therefore, a nanosecond-step, or fine-timing, offset can be applied to the incoming signals in order to adjust the sampling point [4]. It should be noted that the analogue signals are composed of multiple signals from the calorimeters which are summed to form a TT signal. If these calorimeter signals are not properly timed a TT signal may contain multiple peaks or other unwanted features. Extensive work has been done to ensure these timings are calibrated properly [6, 7].

The fine-timing offset can be calibrated using test pulses from the charge injection and pulser of the Tile and Liquid Argon Calorimeters [1, 2, 3]. The timing of these test systems has been set to reproduce beam-like timing for the barrel regions (\(|\eta|<\sim 1.5\)) of both electromagnetic and hadronic calorimeters. However, variations in the timing across calorimeter partitions are difficult to determine a priori, so these and the initial per-partition tower timings need to be cross-checked and re-optimized using real data. Only signals from real energy deposits provide the ideal input for the timing calibration.

During autumn 2009, the LHC provided splash events prior to collisions. A splash event is produced by LHC beam packets interacting with the collimators located in the beam pipes at \(\pm 145\,\mathrm{m}\) from the interaction point at the center of the ATLAS detector. These interactions create energetic secondary particle showers that traverse the ATLAS detector. Using the time of flight from the collimator to the detector and then from detector to collision vertex, estimates for the timing offsets can be cross-checked and corrections can be determined.

The analysis is based on a dataset from Run 140370 (20 November 2009) where 55 of the splash events provided by the LHC were used.

### Signal Fit Equation

In Figure 1(a), one can see an example of a digitized Liquid Argon calibration pulse from the L1Calo PPM with 15 digitized samples, referred to as time slices. A reconstructed Liquid Argon calibration pulse is shown in Figure 1(b), which is made by sampling these 15 time slices while incrementally shifting the pulse by 1-ns steps across a 25 ns range. The calorimeter calibration pulse systems provide the input signals. This results in the reconstructed pulse having \(15\times 25=375\) samples of 1 ns step size.

After investigating various fitting functions [8, 9], a Landau and Gaussian hybrid function was found to give the best fitting results as shown in Figure 1. This hybrid function is composed of a Gaussian applied on the rising edge and a Landau on the falling edge. It is described by the following expression,

\[f(t\leq t_{0}) =A\cdot exp\left[-\frac{(t-t_{0})^{2}}{2\sigma_{\text{gaussian}}^{ 2}}-\frac{1}{2}\right]+C\] \[f(t>t_{0}) =\left(A+D\cdot exp\left(\frac{1}{2}\right)\right)\cdot exp \left[-\frac{1}{2}\left(\frac{t-t_{0}}{\sigma_{\text{landau}}}+exp\left(- \frac{t-t_{0}}{\sigma_{\text{landau}}}\right)\right)\right]+C-D. \tag{1}\]

This function and its derivative are continuous at \(t_{0}\). Using the reconstructed pulses, the values of some fit parameters are constrained in order to avoid the large parameter space in these fitting functions and

Figure 1: Figure 1(a) is a standard pulse as it is read out of the L1Calo system and Figure 1(b) is a reconstructed pulse with nanosecond time resolution which is derived from special pulser runs as described in the text. Both signals are fit with the hybrid Landau/Gaussian fit function described by Equation 1. The signals were taken from a Liquid Argon calibration run.

the small number of sample points. The amplitude, \(A\), and peak position, \(t_{0}\), were allowed to freely vary and the pedestal, \(C\), was fixed at a calibrated value. The other variables were constrained according to Table 1. The variable \(D\) characterizes the undershoot seen on the falling edge of the pulse, which is a trait of Liquid Argon pulses due to the charge integration circuit.

The Landau/Gaussian fit function is used to reconstruct the original pulse in order to extract the fine-timing information beyond the 25 ns time-slice resolution. The following quality criteria are applied to ensure the fit produces reasonable results. A fit is not performed if there is no time slice with a signal above 60 ADC units or if there is more than one saturated time slice (\(\geq\) 1023 ADC units). The resulting fit must also fulfil the following requirements that help remove erroneous fits: the fitted peak must fall within the two largest time slices, the fitted amplitude cannot deviate by more than 35% from that of the largest time slice, and the fit must accurately reproduce, to within 40%, the time slices neighbouring the largest time slice up to \(\pm\)2 slices away.

Figure 2 shows the results of performing this fit on all channels from two splash events. Figure 2(a) shows the results of a splash arriving from beam-1 (\(-\eta\) trajectory) in the electromagnetic layer and Figure 2(b) with beam-2 (\(+\eta\) trajectory) in the hadronic layer. A time offset of 175 ns, as seen in Figure 1(a), was used as a reference for these plots. Allowing for some partition dependent offsets, the time of flight of the splash across the \(\{\eta,\phi\}\) plane can easily be seen. Figure 3 makes this more obvious by showing a projection of the bins along the \(\eta\)-axis. In Section 2.2, the time of flight is corrected such that the fine-timing offsets represent those expected for colliding beam.

The empty bins in Figure 2 are caused by known difficult regions that are still being commissioned or a lack of suitable signals. The Tile Calorimeter in the hadronic layer (\(|\eta|<1.5\)) is especially prone to pulse saturation in the splash events and event 2666 was chosen specifically due to the number of non-saturated TT signals. Fit failures are seen in the electromagnetic and hadronic Forward Calorimeters (FCAL) (\(|\eta|>3.2\)) due to small signals failing the \(>60\) ADC units requirement. Near the outer edge of the Tile Calorimeter, signal saturation excludes extracting the peak location using the fit function.

Some TTs are not yet fully commissioned and are therefore excluded from the trigger. For example, the stripes in \(\eta\) in the hadronic barrel region are disabled sections of the Tile Calorimeter where L1Calo was not receiving signals. The stripes in \(\phi\) at \(|\eta|=3.15\) are regions where the signal is suppressed by \(E_{\rm T}\) corrections. The stripes at \(|\eta|=1.45\) in the electromagnetic layer are the overlap region between the Liquid Argon barrel (\(|\eta|<1.5\)) and end caps (\(1.5<|\eta|<3.2\)) where TT signals will be summed from both layers. At the time, this region was not in a standard configuration and is therefore ignored in this analysis.

In the analysis presented here, the signal shapes produced by calibration pulses, as shown in Figure 1(b), are assumed to be similar to those of beam collision and splash event signal shapes. However, this has not yet been verified and may be an unforeseen source of systematic error. Also the pulse shapes vary as a function of detector partition such that Tile calibration pulses are not identical to those in the Liquid Argon hadronic end cap. Nevertheless, the Landau/Gaussian fit is adequate for pulses from both;

\begin{table}
\begin{tabular}{|c|c|c|} \hline Variable & Minimum & Maximum \\ \hline \(\sigma_{\rm gaussian}\) & 12 ns & 25 ns \\ \(\sigma_{\rm landau}\) & 1 ns & 40 ns \\ Undershoot, \(D\) & 1 a.u. & 100 a.u. \\ \hline Amplitude, \(A\) & \multicolumn{2}{c|}{free} \\ Peak Position, \(t_{0}\) & \multicolumn{2}{c|}{free} \\ Pedestal, \(C\) & \multicolumn{2}{c|}{\(=32\) a.u.} \\ \hline \end{tabular}
\end{table}
Table 1: These constraints are imposed on the variables from the fitting function in Equation 1. a.u. = ADC units of the PPM ADC.

Figure 3: An \(\eta\)-projection of the peak time location distribution in Figure 2 is shown. The electromagnetic layer is shown in 3(a) with beam-1 approaching in the \(-\eta\) direction using event number 2166. The hadronic layer is shown in 3(b) with beam-2 approaching in the \(+\eta\) direction using event number 2666. Both events are taken from Run 140370.

Figure 2: This is an \(\eta\)-\(\phi\) plot of the peak time location with ns precision plotted on the \(z\)-axis. The peak times (\(t_{0}\)) are measured by fitting each trigger tower signal with a Landau/Gaussian hybrid function. The timing reference was taken as 175 ns from Figure 1(a). The electromagnetic layer is shown in 2(a) with beam-1 approaching in the \(-\eta\) direction using event number 2166. The hadronic layer is shown in 2(b) with beam-2 approaching in the \(+\eta\) direction using event number 2666. Both events are taken from Run 140370.

fit parameters do, however, vary.

### Time of Flight Correction

Beam-splash event timing does not correspond to that of beam collision timing. However, the collimator distance to the TT, and the distance from each TT to the nominal interaction point are known. This allows one to correct for time of flight and to estimate the collision timing. The positions used for the electromagnetic and hadronic layers are approximate because TTs are summed from calorimeter cells that vary in distance from the vertex. In order to minimize the effect of this approximation the halfway point between the outer and inner layers of the calorimeters was used as shown in Figure 4, where the red (blue) line was used to approximate the location of electromagnetic (hadronic) TTs.

Using the geometry shown in Figure 4, the time of flight from the collision vertex to the TT can be calculated; the result is shown in Figure 5 for both calorimeter layers. The time of flight is a function of \(\eta\) and is uniform in \(\phi\) due to the symmetry of the detector. The time of flight from the collimators to the detector layers, shown in Figure 6, is then subtracted from the previous correction to form the total time of flight correction seen in Figure 7. The total time-of-flight correction can be applied to the timing offset in each TT as a function of \(\eta\) and provides the approximate timing for colliding beams.

### Collision Timing Offsets

Applying the timing corrections from Section 2.2 gives the approximate signal-peak time location for colliding beams. The results of this calculation can be seen in Figure 8 for all L1Calo TTs. The electromagnetic layer, shown in Figure 8(a), is very uniform in \(\{\eta,\phi\}\) with the FCAL region exhibiting an overall lower offset. This is easily seen in Figure 9(a) where a projection along the \(\eta\)-axis is shown. A perfectly timed system would have a flat response in \(\eta\). In the electromagnetic layer the timing is within \(\pm 5\,\mathrm{ns}\) for the barrel and end cap regions.

Figures 8(b) and 9(b) show the hadronic layer. It is less uniform than the electromagnetic layer, which can be understood as an effect of the different detector implementations involved. The border between the barrel (\(|\eta|<1.5\)) and end caps (\(|\eta|>1.5\)) can be recognized. These two regions were calibrated with independent signal pulser systems whose relative phase is not known, which explains their differences. The end caps and FCAL regions appear with different overall offsets for similar reasons.

Figure 4: The trigger tower geometry is shown on this Event Display image of a splash event taken during Run 140370. The lines represent the electromagnetic and hadronic layer geometries. The points correspond to \(\{z\)-axis,\(x\)-axis\(\}\) with the origin at the collision vertex.

Figure 5: The approximate time of flight from collision vertex to detector layer as a function of \(\eta\). The electromagnetic layer is shown in 5(a) and the hadronic layer in 5(b).

Figure 6: The time of flight from collimator to detector layer as a function of \(\eta\) is shown using \(\eta=0\) as a reference. The time of flight from the interaction point to the detector, shown in Figure 5, is subtracted to get the total time of flight correction seen in Figure 7. The electromagnetic layer is shown in 6(a). The hadronic layer is shown in 6(b). The beam-1 (\(-\eta\)) trajectory is used here with reflection across the \(\eta=0\) axis representing the beam-2 trajectory.

Figure 8: The corrected peak time location in nanoseconds for both calorimeter layers. The electromagnetic layer is shown in 8(a) with beam-1 (\(-\eta\) trajectory) using event number 2166. The hadronic layer is shown in 8(b) with beam-2 (\(+\eta\) trajectory) using event number 2666. Both events taken from Run 140370.

Figure 7: This is the total time of flight correction as a function of \(\eta\). The electromagnetic layer is shown in 7(a). The hadronic layer is shown in 7(b). The beam-1 (\(-\eta\)) trajectory is used here with reflection across the \(\eta=0\) axis representing the beam-2 trajectory.

As stated in Section 2, there were a total of 55 splash events used in this analysis, with 25 from beam-1 and 30 from beam-2. The final timing corrections applied to the L1Calo input signals were determined by averaging the results from all 55 splash events. Not all TTs were able to use data from all 55 events due to the goodness of fit requirements as discussed in Section 2.1. Only one splash event contributed to most Tile Calorimeter TTs because the signals were otherwise saturated whereas the rest of the TTs use 55 splash events. The fit for some channels did not produce uniform timings for both beam-1 and beam-2 splashes, which is likely a result of the simplified geometry. This can be seen in Figure 10(a) where the peak timing calculated from splash events with beam-2 (left side) and beam-1 (right side) are shown on the same plot. The variation is of the order \(\sim\pm 3\,\mathrm{ns}\) which is sufficient for initial timing calibration. Figure 10(b) shows a channel with uniform response to beam-1 and beam-2 for comparison. The effect appears mainly in the high \(\eta\) regions (FCAL and some End Cap) where TTs are composed of larger calorimeter cells.

Using the average of the \(\eta\)-dependent corrections, the nanosecond-step timing offsets in the L1Calo PPMs were adjusted to ensure all TTs were optimized for the colliding beam that followed. The final offsets that were used for corrections are shown in Figure 11. The channels that could not be corrected using this method were corrected by hand when required. This included mainly Tile channels that saturated for all splash events and a few FCAL channels that did not pass the ADC \(>60\) cut. After this correction the overall timing accuracy of L1Calo should be \(\sim\pm 5\,\mathrm{ns}\) base on the the systematic uncertanties previously mentioned, however, this must be verified with collision data.

The final corrected nanosecond delays are shown in Figure 12. The structure is due mainly to cable lengths with small effects from electronics timing. TT with longer cables are expected to have shorter delays and vice versa. This behaviour can be seen in Figure 12 with TTs at \(\phi\sim 0\) having a shorter delay because these are more distant from the trigger electronics than TTs at \(\phi\sim\pi\). The \(\phi\)-dependence decreases in the forward region because of the smaller detector radius which allows for similar cable lengths. Some smaller features can be explained by cable routing within the counting room where the trigger electronics are located. These final delays were used starting with Run 142286 prior to the last days of 2009 data taking, which included some collisions at \(2.36\,\mathrm{Te\kern-1.0ptV}\).

Figure 9: The mean of the \(\eta\) bins in Figure 8. The distributions would be flat for perfect timing, however, partition dependent offsets must be corrected. The electromagnetic layer is shown in 9(a) with beam 1 approaching in the \(-\eta\) direction using event number 2166. The hadronic layer is shown in 9(b) with beam 2 approaching in the \(+\eta\) direction using event number 2666. Both events taken from Run 140370.

Figure 11: The mean correction to peak time location in nanoseconds for both calorimeter layers. The electromagnetic layer is shown in 11(a). The hadronic layer is shown in 11(b). Data taken from splash events in Run 140370.

Figure 10: The peak position (\(t_{0}\)), determined using Equation 1, as a function of the ATLAS event number. Figure 10(a) shows a non-uniform response to beam-1 and beam-2 events (PPM channel located in hadronic end cap), which was seen in a small number of channels. Figure 10(b) shows a typical TT with the expected uniform response to beam-1 and beam-2 splash events (PPM channel located in electromagnetic barrel).

## 3 Conclusion

The L1Calo input signal timing offsets were calibrated using splash events taken during the autumn 2009 LHC commissioning runs. Correcting the signal peak locations measured in these events in a way that approximates the times expected during collision events provides the first measurement of the input signal timing offsets in most L1Calo channels using real signals. The offsets derived with the calorimeter test signal system prior to first beam were shown to be already within \(\pm 1\) bunch-crossing (\(\pm 25\,\mathrm{ns}\)). Using the time-of-flight corrected timing measurements from splash events presented here, the timing offsets were corrected to an expected timing accuracy of \(\pm 5\,\mathrm{ns}\).

In February 2010, additional splash events were provided and the same method (with a refined fit function) was applied to determine new timings. It was necessary to perform a new timing analysis due to timing changes to the tower builder board that changed in Liquid Argon between the December 2009 and February 2010 runs. These new timings are currently being used for L1Calo collision data taking. A validation will, however, require collision data.

## References

* [1] ATLAS Collaboration, _The ATLAS Experiment at the CERN Large Hadron Collider_, JINST **3** (2008) 8003-8440.
* [2] ATLAS Tile collaboration, _ATLAS Tile Calorimeter Technical Design Report_, CERN-LHCC 96-042.
* [3] ATLAS Collaboration, _Liquid Argon Calorimeter Technical Design Report_, CERN-LHCC 96-041.
* [4] R. Achenbach et al., _The ATLAS Level-1 Calorimeter Trigger_, J Inst. **3** (2008) 3001-3041.
* [5] R. Stamen, _Testing and calibrating analogue inputs to the ATLAS Level-1 Calorimeter Trigger_, TWEPP. Naxos, Greece, September, 2008.
* [6] P. Borgeaud et al., _The LArg Tower Builder Board: calculation, simulation, measurements_, ATL-LARG-2002-001.

Figure 12: The final corrected timing delays for each TT in nanoseconds for both calorimeter layers. The electromagnetic layer is shown in 12(a). The hadronic layer is shown in 12(b).