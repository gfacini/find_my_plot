**New method of fast simulation**

**for a hadron calorimeter response**

**J. Sutiak, S. Tokar, T. Zenis**

_Commenius University, Bratislava_, _Slovak Republic_

**Y.A. Kulchitsky1**

Footnote 1: On leave from B.I.Stepanov Institute of Physics, National Academy of Sciences, Minsk, Belarus

_JINR, Dubna, Russia_

Abstract

In this work we present the new method of a fast Monte Carlo simulation of a hadron calorimeter response. It is based on the three-dimensional parameterization of the hadronic shower obtained from the ATLAS TILECAL testbeam data and GEANT simulations. A new approach of including the longitudinal fluctuations of hadronic shower is described. The obtained results of the fast simulation are in good agreement with the TILECAL experimental data.

Introduction

Hadron calorimetry is an important part of the high energy physics experiments. Simulation of calorimeter response is an integral part of a calorimeter design and development. It is also inevitable to simulate calorimeter response as a part of full detector response for treating different physics processes to be studied by an experimental setup.

The well known way of the simulation of hadron calorimeter response is to use the GEANT detector simulation package [1]. The GEANT simulations are quite time consuming and in many cases, it is more convenient to use the fast simulation methods. In this work we present the fast simulation method, which does not take the into account concrete physical interactions, except of a few the most energetic collisions at the begining of the shower development. The fast Monte Carlo (MC) is based on a three-dimensional parameterization of hadron shower development obtained from the ATLAS TILECAL testbeam data [2, 3, 4] and GEANT simulations.

## 2 The Tile Calorimeter

The presented work is tightly connected to the hadronic Tile Calorimeter prototype [2, 5, 6] of the ATLAS collaboration. However, the method can be applied to any other sampling calorimeter.

The Tile Calorimeter [5, 7, 8] is a sampling device made out of steel and scintillating tiles, as absorber and active material respectively (Fig. 1). The absorber structure is a laminate of steel plates of various dimensions stacked along \(Z\). The basic geometrical element of the stack is what we call a period. It consists of a set of two master plates (large trapezoidal steel plates, 5 mm thick, spanning along the entire \(X\) dimension) and one set of spacer plates (small trapezoidal steel plates, 4 mm thick, 10 cm wide along \(X\)).

Each stack, called module, spans \(2\pi/64\) in the azimuthal angle (\(Y\) dimension), 100 cm in the \(Z\) direction and 180 cm in the \(X\) direction (about 9 interaction lengths, \(\lambda_{I}\), or about 80 effective radiation lengths, \(X_{0}\)). Each module has 57 repeated periods. The module front face, exposed to the beam particles, covers \(100\times 20\) cm\({}^{2}\). The scintillating tiles are made out of polystyrene material of thickness 3 mm, doped with scintillator. The iron to scintillator ratio is \(4.67:1\) by volume. The alorimeter thickness along the beam direction at the incidence angle of \(\Theta=10^{\circ}\) (the angle between the incident particle direction and the normal to the calorimeter front face) corresponds to 1.49 m of iron equivalent length. The prototype Tile Calorimeter used for this study is composed of five modules stacked in the \(Y\) direction, as shown in Fig. 2.

The modules are divided into five segments along \(Z\) and they are also longitudinally segmented (along \(X\)) into four depth segments.

The readout cells have a lateral dimension of 200 mm along \(Z\), and longitudinal dimensions of 300, 400, 500, 600 mm for depth segments 1 - 4, corresponding to 1.5, 2, 2.5 and 3 \(\lambda_{I}\) at \(\Theta=0^{\circ}\) respectively. Along

Figure 1: Conceptual design of a Tile calorimeter module.

\(Y\), the cell sizes vary between about 200 and 370 mm depending on the \(X\) coordinate.

The calorimeter was placed on a scanning table that allowed movement in any direction. Upstream of the calorimeter, a trigger counter telescope (S1, S2, S3) was installed, defining a beam spot approximately 20 mm in diameter. Two delay-line wire chambers (BC1 and BC2), each with \((Z,Y)\) readout, allowed the impact point of beam particles on the calorimeter face to be reconstructed to better than \(\pm\)1 mm. Additional scintillators for the muon detection were placed behind and on the side of the calorimeter prototype to measure the longitudinal and lateral hadronic shower leakage. The "Back muon wall" (800\(\times\)800 mm\({}^{2}\)) is shown in Fig. 2. The other scintillators were placed on the positive \(Z\) side (400\(\times\)1150 mm\({}^{2}\)), and are not seen in Fig. 2.

## 3 The principle of the fast simulations

The method of fast MC presented here, follows the ideas published in the work of Grindhammer et al. [9] and is suggested for sampling calorimeters. In our approach, a different method of including the longitudinal profile fluctuations has been employed.

Figure 2: Schematic layout of the experimental setup (side view). S1, S2 and S3 are beam trigger scintillators. BC1 and BC2 are (Z,Y) proportional chambers.

The shower that develops beginning at a certain depth of the detector is represented by a set of _energy spots_. These spots are distributed according to a known spatial distribution function. The number of spots deposited in the active medium \(N_{A}\) is a random variable with Poisson distribution function, so its relative standard deviation is \(1/\sqrt{N_{A}}\). As the amount of detected energy is proportional to the number of spots in the active medium, the relative fluctuations of detected energy are also \(1/\sqrt{N_{A}}\). We will show later, how to determine the appropriate number of spots for given energy resolution.

### Components of hadronic shower

Due to production of \(\pi^{0}\) mesons which decay always into electromagnetic particles, the shower consists of two subshowers -- electromagnetic (EM) subshower and pure hadronic (HD) one. Accordingly, the energy distribution function has two parts. The shape of the distribution function varies from event to event so it is fixed for each event separately. In non-compensated sampling calorimeters, the ratio between signal response for the electromagnetic and pure hadronic part of shower is given by the well known \(e/h\) ratio, e.g. [11, 10]. To obtain a signal value comparable with the experiment, energy of the spots representing electromagnetic (hadronic) subshower is calibrated by the value \(e\) (\(h\)). The algorithm of the fast simulation program may be written as follows:

1. To fix the spatial energy distribution function.
2. To find the origin of shower (vertex) and to deposit the ionization energy losses of incident particle up to the interaction vertex.
3. To decide whether the current spot will be distributed according to the electromagnetic or hadronic part of distribution function.
4. To find the position of the energy spot and decide whether it is absorbed in the active or passive medium.
5. If absorbed by the active medium, the value of signal (either electromagnetic or hadronic) is appropriately modified. The steps \(2-5\) are repeated for all the spots of the current shower. Calculation of the spatial energy distribution function is done for each event individually.

### The size of energy spots

In the previous chapter we mentioned that the number of energy spots is related to the calorimeter energy resolution. The usual parameterization of the resolution is:

\[\frac{\sigma_{E}}{E}=\frac{a}{\sqrt{E}}\oplus b, \tag{1}\]

where \(a\) is the stochastic coefficient representing the combined effect of sampling and photostatistic fluctuations. The coefficient \(b\) (constant term) characterizes non-uniformities of a calorimeter. For this calorimeter their values are \(a=0.55\) and \(b=0.03\). In the sampling calorimeters, only a part of energy is deposited in the active medium and detected. The sampling fraction \(s_{f}\) for the sampling calorimeters is defined as a ratio of the energy deposited by minimum ionizing particle (mip) in the active medium \(E_{A}\) and the total energy deposited \(E\)[12] (see p. 109):

\[s_{f}=\frac{E_{A}}{E}. \tag{2}\]

In this explanation, we will assume that the shower consists of mips -- this assumption is not principal for the energy resolution.

Our scenario for treating the shower is as follows. The energy of an incident particle is divided into \(N\) energy spots each with the energy \(q_{eff}\) and distributed over the volume of the calorimeter. The probability that a spot is absorbed in the active medium is \(s_{f}\). On average, \(N_{A}\) of them are absorbed in the active medium:

\[N_{A}=s_{f}\cdot N. \tag{3}\]

\(N_{A}\) is a random variable obeying Poisson law, therefore its standard deviation is \(\sqrt{N_{A}}\). If we do not take into account the constant term then the energy resolution is determined by the relative standard deviation of \(N_{A}\), because \(E_{A}\) is proportional to \(N_{A}\):

\[\frac{\sigma_{E}}{E}=\frac{\sqrt{N_{A}}}{N_{A}}. \tag{4}\]

?From \((1)-(4)\) one can find the appropriate number of energy spots:

\[N=\frac{E}{a^{2}\cdot s_{f}}, \tag{5}\]and the size of the energy spot:

\[q_{eff}=a^{2}\cdot s_{f}. \tag{6}\]

The constant term can be included by multiplying the amount of energy deposited in each cell in one event by the factor \((1+b^{\prime})\) where \(b^{\prime}\) is normally distributed random number with \(\sigma=b\) and \(\mu=0\).

## 4 The shower profile

We have studied the profile of a hadronic shower using the full GEANT simulations [1] as well as using the data obtained at the test beam experiments with the prototype of the hadronic calorimeter of the ATLAS collaboration [2, 5]. We carried out simulations of response on \(\pi^{-}\) with the incident energies 20, 50, 100, 200, 300 and 500 GeV. The experimental setup was the same as in the test beam measurements. The test beam data were then used for tuning up and testing the fast MC.

In this work, the following coordinate system has been chosen. The origin of the coordinate system is put to the shower origin (the first hadronic interaction) an the \(x\)-axis is parallel to the beam line. We assume that the shower is symmetrical around this axis, and thus the average energy density function is only a function of the distance from the shower axis \(r=\sqrt{y^{2}+z^{2}}\) and the longitudinal coordinate \(x\):

\[\Psi\left(x,r\right)=\frac{1}{E_{0}}\cdot\frac{\mathrm{d}E(x)}{\mathrm{d}x} \cdot\phi\left(x,r\right), \tag{7}\]

where \(\Psi(x,r)\) is a joint probability density function (p.d.f.), \(\mathrm{d}E(x)/\mathrm{d}x\) is a marginal p.d.f. and \(\phi(x,r)\) is a conditional p.d.f. \(E_{0}\) is the total energy deposited. Because the shapes of the electromagnetic and hadronic sub-showers differ substantially, we need to study them separately. The joint p.d.f. function \(\Psi(x,r)\) is thus a superposition of functions \(\Psi_{e}(x,r)\) and \(\Psi_{h}\left(x,r\right)\) corresponding to the electromagnetic and hadronic component respectively [13]:

\[\Psi\left(x,r\right)=w\cdot\Psi_{e}\left(x,r\right)+\left(1-w\right)\cdot\Psi _{h}\left(x,r\right). \tag{8}\]

The parameter \(w\) represents the contribution of the electromagnetic sub-shower to the full calorimeter signal. It is determined by the total energy fraction of the \(\pi^{0}\) mesons produced. The relation between the mean values \(\langle w\rangle\) and \(\langle f_{\pi^{0}}\rangle\) is following:

\[\langle w\rangle=\frac{e/h\cdot\langle f_{\pi^{0}}\rangle}{(e/h-1)\cdot\langle f _{\pi^{0}}\rangle+1}. \tag{9}\]

The method of calculation of the \(e/h\) value is described in [11, 10]. The dependence of \(\langle f_{\pi}^{0}\rangle\) on the total energy \(E\) can be parameterized by the following formula [14]:

\[\langle f_{\pi^{0}}\rangle=0.11\cdot\ln{(E)}, \tag{10}\]

where \(E\) is the energy of an incident hadron in GeV. For a given total energy, the parameter \(w\) fluctuates significantly. We have found the shape of its p.d.f. using the GEANT simulation. It can be approximated by the function (Fig. 3):

\[p(w)=\frac{(w-w_{0})^{\alpha_{w}-1}\cdot e^{-(w-w_{0})/\beta_{w}}}{\beta_{w}^ {\alpha_{w}}\cdot\Gamma(\alpha_{w})}, \tag{11}\]

Figure 3: Distribution of the events as a function of the parameter \(w\) (9) — the ratio of the pure electromagnetic signal to the total one at 100 GeV.

The parameters \(\alpha_{w}\) and \(\beta_{w}\) were found by fitting the simulated electromagnetic energy distribution. The mean value of this p.d.f. is \(\langle w\rangle=w_{0}+\alpha_{w}\beta_{w}\). Since the GEANT simulations do not reproduce the correct \(e/h\) ratio [15], we calculated the parameter \(w_{0}\) from the equations (9) and (10) using value \(e/h=1.36\) from experiment [10]. The fast MC then reproduces correctly the ratio between electromagnetic and hadronic energy.

### The shower origin

The probability that a hadron crosses a distance \(h\) in a given medium without interaction is given by:

\[p(h)=\frac{e^{-h/\lambda_{I}}}{\lambda_{I}}, \tag{12}\]

where \(\lambda_{I}\) is the interaction length. This function is used to find the distance between the front face of the calorimeter and the primary shower vertex.

### The mean longitudinal profile

There is a well known parameterisation of longitudinal shower profile suggested by Bock et al. [13]:

\[\frac{\mathrm{d}E(x)}{\mathrm{d}x}=E_{0}\Big{\{}w\cdot G\left(\frac{x}{X_{0}},\alpha_{e},\beta_{e}\right)+(1-w)\cdot G\left(\frac{x}{\lambda_{I}},\alpha_{ h},\beta_{h}\right)\Big{\}}, \tag{13}\]

where \(G(x,\alpha,\beta)\) is the gamma distribution function:

\[G(x,\alpha,\beta)=\frac{x^{\alpha-1}\cdot e^{-x/\beta}}{\beta^{\alpha}\cdot \Gamma(\alpha)}. \tag{14}\]

The first term in (13) corresponds to the electromagnetic component and the second term to the hadronic component, \(X_{0}\) and \(\lambda_{I}\) are radiation and interaction length, \(\alpha_{e},\beta_{e},\alpha_{h},\beta_{h}\) are the profile parameters.

In the present work, we used modified function for describing the electromagnetic profile. The shape of the electromagnetic profile is determined by the places of birth of \(\pi^{0}\) mesons and by their energies. According to the full MC simulations, the (mean) shape of the function \(\mathrm{d}E_{\pi^{0}}/\mathrm{d}x(x)\) describing the total \(\pi^{0}\) energy produced in strong interactions on a unit distance is as follows (Fig. 4):

\[\frac{\mathrm{d}E_{\pi^{0}}}{\mathrm{d}x}\left(x\right)=\left\{\begin{array}{ ll}E_{1}\delta(x)&x=0\\ E_{2}\frac{\exp\left(-x/\lambda_{\pi^{0}}\right)}{\lambda_{\pi^{0}}}&x>0\end{array},\right. \tag{15}\]

i.e. a large fraction of the \(\pi^{0}\) energy is produced in the first interaction and then the amount of energy per unit distance decreases exponentially. This exponential decrease scales with interaction length, while the shower produced by \(\pi^{0}\) from the first interaction scales with radiation length. This is the reason, why the use of the first term in (13) is not appropriate for describing the electromagnetic component. On the other hand this term should be adequate for the description of local electromagnetic shower initiated by \(\pi^{0}\) produced at a given depth. The parameters \(\alpha_{e}\) and \(\beta_{e}\) are energy dependent and also vary from case to case for a given energy. However, the energy dependence is weak (\(\alpha_{e},\beta_{e}\sim f(\ln E)\). We assume them to be constant for a given incident energy. The longitudinal profile of electromagnetic component is then a convolution of the functions (14) and (15):

\[\frac{\mathrm{d}E_{e}}{\mathrm{d}x}\left(x\right)=\int\limits_{0}^{x}\frac{ \mathrm{d}E_{\pi^{0}}}{\mathrm{d}x}\left(t\right)\cdot G\left(x-t,\alpha_{e}, \beta_{e}\right)\mathrm{d}t. \tag{16}\]

Fitting the simulated electromagnetic component profile by this function, we found appropriate \(\alpha_{e}\) and \(\beta_{e}\) for each incident energy (Fig. 5 top). The values for different energies are in table 1.

The average profile of the hadronic component \(\mathrm{d}E_{h}/\mathrm{d}x(x)\) is well described by the second term in (13). The values of parameters \(\alpha_{h}\) and \(\beta_{h}\) were found by fitting the simulated hadronic profile (Fig. 5 bottom). Their values are in table 1.

### Fluctuations of the longitudinal profile

#### 4.3.1 Hadronic component

In our approach, we rely on the assumption that the shape of each particular shower, in case of the hadronic component, is determined by several the most energetic particles that are produced in the first spallation interaction. These particles are mostly pions, protons and neutrons. They move approximately in parallel to the beam axes and carry the major part of the incident energy [12] (see p. 68-77). They interact in different spatial points giving rise to partial subshowers. The fact that a hadronic shower consists of several partial subshowers starting at different points is the main source of the event by event fluctuations.

The probability, that a primary vertex particle crosses the distance \(x\) before it undergoes an interaction with a nucleus is given by (we do not

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|} \hline \(E_{in\,c}\) & 20 & 50 & 100 & 200 & 500 \\ \(\left[GeV\right]\) & & & & & \\ \hline \(\alpha_{e}\) & \(2.83\pm 0.03\) & \(3.14\pm 0.04\) & \(3.39\pm 0.03\) & \(3.54\pm 0.04\) & \(3.93\pm 0.04\) \\ \hline \(\beta_{e}\)\([\mathrm{cm}]\) & \(4.91\pm 0.11\) & \(5.00\pm 0.09\) & \(5.04\pm 0.15\) & \(5.18\pm 0.09\) & \(5.28\pm 0.12\) \\ \hline \(\lambda_{\pi^{0}}\)\([\mathrm{cm}]\) & \(30.01\pm 0.15\) & \(34.6\pm 0.21\) & \(38.61\pm 0.19\) & \(42.65\pm 0.31\) & \(4\,5.91\pm 0.35\) \\ \hline \(\alpha_{h}\) & \(1.33\pm 0.11\) & \(1.52\pm 0.08\) & \(1.65\pm 0.13\) & \(1.77\pm 0.18\) & \(1.91\pm 0.10\) \\ \hline \(\beta_{h}\)\([\mathrm{cm}]\) & \(34.2\pm 3.1\) & \(36.4\pm 4.2\) & \(37.55\pm 3.6\) & \(38.67\pm 4.1\) & \(40.25\pm 3.5\) \\ \hline \end{tabular}
\end{table}
Table 1: The longitudinal hadronic shower profile parameters.

Figure 5: Top: Distribution of the longitudinal profile of electromagnetic component \({\rm d}\,E_{e}(x)/{\rm d}x\) (16) of hadronic showers at 100 GeV from the longitudinal coordinate. Bottom: Distribution of the longitudinal profile of hadronic component \({\rm d}\,E_{h}(x)/{\rm d}x\) (19) of hadronic showers at 100 GeV as a function of the longitudinal coordinate.

consider the \(\pi^{0}\) mesons now):

\[p(x)=\frac{e^{-x/\lambda_{i}}}{\lambda_{i}}, \tag{17}\]

where \(\lambda_{i}\) is the corresponding interaction length for protons, neutrons, pions etc. Each of these particles may start a subshower with a profile which can be described by the function:

\[\frac{\mathrm{d}\,E_{sub}(x)}{\mathrm{d}x}=G(x-x^{\prime},\,\alpha_{h}^{ \prime},\beta_{h}^{\prime}), \tag{18}\]

where \(x^{\prime}\) is the position of the subshower origin and \(\alpha_{h}^{\prime}\), \(\beta_{h}^{\prime}\) are parameters. The overall hadronic component profile for one particular event is thus a superposition of several subshowers each starting at different depth from the primary hadronic shower vertex.

The average profile (accumulated through many events) should be a convolution of the functions (17) and (18). If we take \(\lambda_{i}=\beta_{h}\) instead of considering the real interaction length value for each kind of particle, \(\alpha_{h}^{\prime}=\alpha_{h}-1\) and \(\beta_{h}^{\prime}=\beta_{h}\), the result of the convolution is:

\[\frac{\mathrm{d}\,E_{h}}{\mathrm{d}x}(x)=\int\limits_{0}^{x}G(x-x^{\prime}, \,\alpha_{h}-1,\beta_{h})\cdot\frac{e^{-x^{\prime}/\beta_{h}}}{\beta_{h}} \mathrm{d}t=G(x,\,\alpha_{h},\beta_{h}), \tag{19}\]

It means that we are able to reproduce correctly the average longitudinal hadronic component profile by superposing several partial subshowers in individual events.

We studied also the amount of energy carried by the fastest particles created in the first interaction and thus the energy of the subshowers initiated by them. In case of stable particles and neutrons their kinetic energy was considered while in case of mesons the total energy was treated. The simulated spectrum of energies of primary vertex particles relative to the incident energy \(f_{i}=E_{i}/E_{inc}\) is in the Fig. 6. For parameterization of this spectrum we use the following function:

\[p(f_{i})=N.f_{i}^{c_{h}-1}.\exp{(-f_{i}/d_{h})}\quad f_{i}\in[0,1], \tag{20}\]

with the parameters \(c_{h}\) and \(d_{h}\) (see table 2).

In the fast MC program, the shape of the function \(\mathrm{d}\,E_{h}(x)/\mathrm{d}x\) describing the longitudinal profile of the hadronic component for a single event is constructed as follows:

\[\frac{\mathrm{d}\,E_{\!h}\,(x)}{\mathrm{d}x}=\sum_{i}f_{i}\cdot G(x-x_{i},\alpha_ {h}-1,\beta_{h}), \tag{21}\]

where \(f_{i}\) is the energy fraction carried by i-th primary vertex particle and \(x_{i}\) is its interaction point, \(G\) is the gamma distribution function.

The number of interactions is given by the condition

\[\sum_{i}f_{i}=1. \tag{22}\]

#### 4.3.2 Electromagnetic component

The fluctuations of electromagnetic component can be included in a similar way. The situation is slightly different because the \(\pi^{0}\)s decay immediately after being created. We have to consider \(\pi^{0}\)s produced in the first interaction giving rise to a partial subshower starting at the vertex, as well as those produced in the higher generation interactions which produce subshowers that are distributed along the \(x\)-axis.

Figure 6: The energy fraction spectrum of particles created in the first interaction in a 100 GeV shower (except of \(\pi^{0}\)).

According to GEANT simulation, the fraction \(f_{1}\) of \(\pi^{0}\) energy produced in the first interaction (\(x=0\)) has the following p.d.f. (Fig. 7):

\[p(f_{1})=N\cdot\exp\left(\frac{(f_{1}-\mu_{f_{1}})^{2}}{\sigma_{f_{1}}^{2}} \right)\ \ f_{1}\in[0,1], \tag{23}\]

where \(\mu_{f1}\) and \(\sigma_{f1}\) are parameters (see table 2). The p.d.f. of the fraction of \(\pi^{0}\) energy \(f_{i}\) produced in one of the subsequent interactions is described by function (20) but with different parameters \(c_{e}\) and \(d_{e}\) (Fig. 8).

Similarly as in the case of the hadronic component, in the fast MC we can construct the electromagnetic profile by superposing the partial subshowers caused by \(\pi^{0}\) created in individual interactions, each described by the function:

\[\frac{\mathrm{d}\,E_{sub}(x)}{\mathrm{d}x}=G(x-x^{\prime},\alpha_{e},\beta_{e }), \tag{24}\]

where \(x^{\prime}\) is the position of the subshower origin and \(\alpha_{e}\), \(\beta_{e}\) are parameters, the same as in (16). The first subshower starts at the primary vertex, the starting points of subshowers from the higher generation of \(\pi^{0}\)s match

Figure 7: The distribution of the fractional energy of \(\pi^{0}\) produced in the first interaction in a 100 GeV shower.

the positions of interactions of hadronic subshower particles:

\[\frac{{\rm d}\,E_{e}(x)}{{\rm d}x}=f_{1}\cdot G(x,\alpha_{e},\beta_{e})+\sum_{i \,\geq 2}f_{i}\cdot G(x-x_{i},\alpha_{e},\beta_{e}), \tag{25}\]

where \(f_{i}\) is the fractional energy and \(x_{i}\) is the position of i-th interaction producing \(\pi^{0}\)s, \(G\) is the gamma distribution function. The number of interactions is given again by the condition (22).

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline \(E_{in\,c}\) & 20 & 50 & 100 & 200 & 500 \\ (GeV) & & & & & \\ \hline \(c_{h}\) & \(-0.08\,2\pm 0.01\) & \(-0.23\pm 0.01\) & \(-0.4\,2\pm 0.01\) & \(-0.52\pm 0.01\) & \(-0.64\pm 0.01\) \\ \hline \(d_{h}\) & 0.2 & 0.2 & 0.2 & 0.2 & 0.2 \\ \hline \(\sigma_{f1}\) & 0.63 \(\pm\) 0.2 & \(0.41\pm 0.02\) & \(0.38\pm 0.02\) & \(0.34\pm 0.02\) & \(0.32\pm 0.01\) \\ \hline \(\mu_{f1}\) & 0.58 \(\pm\) 0.02 & \(0.4\pm 0.02\) & \(0.36\pm 0.02\) & \(0.36\pm 0.02\) & \(0.31\pm 0.01\) \\ \hline \(c_{e}\) & \(-0.26\pm 0.01\) & \(-0.40\pm 0.02\) & \(-0.40\pm 0.02\) & \(-0.48\pm 0.01\) & \(-0.59\pm 0.02\) \\ \hline \(d_{\,e}\) & 0.25 \(\pm\) 0.02 & \(0.24\pm 0.01\) & \(0.18\pm 0.01\) & \(0.16\pm 0.01\) & \(0.16\pm 0.01\) \\ \hline \end{tabular}
\end{table}
Table 2: The energy spectrum parameters for \(\pi^{0}\)s and fast hadrons.

Figure 8: The distribution of the fractional energy of \(\pi^{0}\)s produced in one hadronic interaction different from the first one in a 100 GeV shower.

### The radial shower profile

We studied the radial shower profile of both the electromagnetic and hadronic shower components using the GEANT simulations. The energy \(\delta E_{r}(x,r)\) deposited in the "ring" with the centre on the \(x\) axis, the internal radius \(r\) and the volume \(\Delta V=2\pi r\,\Delta r\Delta x\) is:

\[\delta E_{r}\left(x,r\right)=2\pi\int\limits_{r}^{r+\Delta r}\int\limits_{x- \Delta x\,/2}^{x+\Delta\,/2}E_{0}\cdot\Psi\left(x,r\right)\cdot r\,drdx\, \approx E_{0}\cdot\Psi\left(x,r\right)\cdot 2\pi r\,\Delta r\Delta x. \tag{26}\]

The function \(\delta E_{r}(x,r)/\delta r\,\delta x\) is related to the marginal p.d.f. \(\phi(x,r)\) by the expression:

\[\phi\left(x,r\right)=\frac{\delta E_{r}\left(x,r\right)}{2\pi r\cdot\Delta r \cdot\Delta x\cdot\frac{\,\mathrm{d}E_{h}\left(x\right)}{\,\mathrm{d}x}}. \tag{27}\]

The function \(\Delta E_{r}(x,r)/\Delta r\Delta x\) was obtained for various depths \(x\) from 10 to 160 cm with step 10 cm separately for the electromagnetic and hadronic component. For each depth, it was parameterized by function:

\[\frac{\Delta E_{r}(x,r)}{\Delta r\Delta x}=\mathit{c.r}^{\alpha_{r}(x)-1}e^{-r \,/\beta_{r}\left(x\right)}. \tag{28}\]

The examples of fits are on fig. 9. In case of the electromagnetic component, we found the following approximations of the coefficients \(\alpha_{re}\) and \(\beta_{re}\) as a functions of shower depth (x-coordinate) (fig. 10 top):

\[\alpha_{re}=\alpha_{e0}(1-2e^{-x/\alpha_{e1}}). \tag{29}\]

\[\beta_{re}=\left\{\begin{array}{ll}\beta_{e1}+\beta_{e2}x&x\in[0,30]\quad \mathrm{cm}\\ \beta_{e3}+\beta_{e4}x&x\in[30,180]\quad\mathrm{cm}\end{array}\right.. \tag{30}\]

In case of the hadronic component, the coefficients x-dependencies are as follows (fig. 10 bottom):

\[\alpha_{rh}=\alpha_{h0}+\alpha_{h1}\ln x \tag{31}\]

\[\beta_{rh}=\left\{\begin{array}{ll}\beta_{h\,1}+\beta_{h\,2}x&x\in[0,30] \quad\mathrm{cm}\\ \beta_{h\,3}+\beta_{h\,4}x&x\in[30,180]\quad\mathrm{cm}\end{array}\right.. \tag{32}\]

No fluctuations of \(\phi(x,r)\) are included. The lateral shower fluctuations are therefore determined only by the fluctuations of \(w\) and by the random process of the energy spots distribution.

Figure 9: The average simulated electromagnetic (top) and hadronic (bottom) radial shower profile in the 3 depths of the 100 GeV hadronic shower.

Figure 10: Top left: \(\alpha_{re}(x)\); top right: \(\beta_{re}(x)\); bottom left: \(\alpha_{rh}(x)\); bottom right: \(\beta_{rh}(x)\).

[MISSING_PAGE_EMPTY:20]

parameters energy dependencies revealed that those dependencies are logarithmic, linear or constant:

\[\begin{array}{l}P_{i}(E)\,=p_{i}+q_{i}\ln\,E\quad\mbox{or}\\ P_{i}(E)\,=p_{i}+q_{i}E\qquad\mbox{or}\\ P_{i}(E)\,=\,const\,ant,\end{array} \tag{33}\]

where \(E\) is the incident energy in GeV; \(p_{i}\) and \(q_{i}\) have dimension of \(P_{i}\). See the tables (3) and (4).

## 5 Comparison with the experimental data

We tested the fast MC program based on the method described by simulating the response of the ATLAS hadronic tile calorimeter prototype [5] on 50, 100, 200, and 300 GeV \(\pi^{-}\) at \(\theta=10^{o}\).

We compared the fast simulation data with the experimental ones from the test beam in 1995 [5].

In the Fig. 11, the total signal in calorimeter calculated by the fast MC and those obtained by the experiment is compared. One can see that both the shape and the position of the peaks are in a good agreement. The left tail caused by energy leakage is well reproduced. The right tail for which the non-compensation is responsible reproduced less successfully,

\begin{table}
\begin{tabular}{|c|r r|} \hline Parameter & \multicolumn{2}{c|}{Energy dependence} \\ \hline \(\alpha_{e0}\) & \(0.741-\) & \(0.0811\cdot\ln\,E\) \\ \hline \(\alpha_{e1}\) & \(-10.9+\) & \(8.51\cdot\ln\,E\) \\ \hline \(\beta_{e1}\) & \(4.50+\) & \(1.06\cdot\ln\,E\) \\ \hline \(\beta_{e2}\) & \(0.00130-\) & \(0.0207\cdot\ln\,E\) \\ \hline \(\beta_{e3}\) & \(5.43+\) & \(0.00177\cdot E\) \\ \hline \(\beta_{e4}\) & \(0.0274\) & \\ \hline \(\alpha_{h0}\) & \(-0.806-\) & \(0.000581\cdot E\) \\ \hline \(\alpha_{h1}\) & \(0.571-\) & \(0.0186\cdot\ln\,E\) \\ \hline \(\beta_{h1}\) & \(1.88+\) & \(2.58\cdot\ln\,E\) \\ \hline \(\beta_{h2}\) & \(0.138-\) & \(0.0601\cdot\ln\,E\) \\ \hline \(\beta_{h3}\) & \(2.80+\) & \(1.16\cdot\ln\,E\) \\ \hline \(\beta_{h4}\) & \(0.0527\) & \\ \hline \end{tabular}
\end{table}
Table 4: Energy dependence of the radial profile parameters.

Figure 11: The total signal for \(\pi^{-}\), \(E=50,\ 100,\ 200,\ 300\ GeV\) respectively, \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

especially in case of 50 GeV. The reason for this may be the limited validity of the formula (10).

In Figs. \(12-15\) the signals calculated by the fast MC and those obtained by the experiment in the individual calorimeter splings are compared. The signals from the different samplings represent the depth distribution of shower energy and thus enables us to test the shower longitudinal profile. A good agreement confirms correctness of our longitudinal profile analysis and the procedure of implementation of the longitudinal profile fluctuations.

The signal deposited in modules represents the radial distribution of energy. The modules 1 and 5 are the outermost ones. In these two only a small fraction of energy deposits. In our fast MC method, only a few energy spots (e.g. 0 to 4 spots in 100 GeV shower) fall here so the spectrum reproduces the data less successfully, especially in case of low incident energies. This is a limit of the method. In case of the modules 2, 3 and 4 the fast MC spectra are narrower than the experimental ones (Figs. \(16-19\)). The reason for this is that we did not include fluctuations of radial profiles as in case of longitudinal ones. The mean values of energy distributions agree sufficiently.

The signals from the calorimeter towers are compared in the Figs. \(20\) - \(23\). The signal spectrum in the tower 1 is not quite correct for the same reason as in modules 1 and 5. The signal spectra in other towers agree well for all energies, except of tower 2, where the distribution is narrower in fast MC.

## 6 Conclusion

The method of fast MC presented provides reliable and fast tool for simulating hadronic showers in sampling calorimeters. Although it has limits for low energies, it is able to reconstruct correctly the experimental data. The comparison of distributions of energy deposited in different depths along the shower axis proves correctness of the method of longitudinal shower fluctuations.

Figure 12: The signal per sampling for \(\pi^{-}\), \(E=50~{}GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 13: The signal per sampling for \(\pi^{-},\ E=100\ GeV,\ \theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 14: The signal per sampling for \(\pi^{-},\ E=200\ GeV,\ \theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 15: The signal per sampling for \(\pi^{-},\ E=300\ GeV,\ \theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 16: The signal per module for \(\pi^{-}\), \(E=50~{}GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 17: The signal per module for \(\pi^{-}\), \(E=100~{}GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 18: The signal per module for \(\pi^{-}\), \(E=200~{}GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 19: The signal per module for \(\pi^{-}\), \(E=300~{}GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 20: The signal per tower for \(\pi^{-}\), \(E=50~{}GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 21: The signal per tower for \(\pi^{-}\), \(E=100\ GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 22: The signal per tower for \(\pi^{-}\), \(E=200\ GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Figure 23: The signal per tower for \(\pi^{-}\), \(E=300\ GeV\), \(\theta=10^{o}\). The histogram corresponds to the data, the black dots correspond to the fast MC simulation.

Acknowledgement

Authors would like to take the opportunity to thank J. Budagov and V. Vinogradov for valuable discussions and important comments. We acknowledged to the ATLAS experiment community for interest to this work and important discussions.

## References

* [1] R. Brun, F. Carminati, "GEANT Detector Description and Simulation Tool, W5013", CERN Program Library, CERN, Geneva, Switzerland.
* [2] S. Akhmadaliev et al., "Hadronic Shower Development in Iron-Scintillator Tile Calorimetry", NIM A 443 (2000) 51. J. Budagov, Y. Kulchitsky et al., "Study of the Hadron Shower Profiles with the ATLAS Tile Hadron Calorimeter", ATL-TILECAL-1997-127 (1997) CERN, Geneva, Switzerland; JINR-E1-97-318 (1997) JINR, Dubna, Russia.
* [3] Y.A. Kulchitsky, V.B. Vinogradov, "Analytical representation of the longitudinal hadronic shower development", NIM A413 (1998) 484.
* [4] Y.A. Kulchitsky, V.B. Vinogradov, "On the Parameterization of Longitudinal Hadronic Shower Profiles in Combined Calorimetry", NIM A455 (2000) 499.
* [5] ATLAS Collaboration, "ATLAS Tile Calorimeter Technical Design Report", CERN/LHCC/96-42 (1996) CERN, Geneva, Switzerland.
* [6] S. Akhmadaliev et al., "Results from an Expanded Combined Test of the Electromagnetic Liquid Argon Calorimeter with a Hadronic Scintillating-Tile Calorimeter", NIM A449 (2000) 461. Z. Ajaltouni et al., "Results from a combined test of an electromagnetic liquid argon calorimeter with a hadronic scintillating tile calorimeter", NIM A387 (1997) 333. S. Akhmadaliev et al., "Hadron Energy Reconstruction for the Atlas Calorimetry in the Framework of the Non-parametrical Method", NIM A480 (2002) 506.

* [7] ATLAS Collaboration, "ATLAS Calorimeter Performance", CERN-LHCC-96-040 (1996) CERN, Geneva, Switzerland.
* [8] ATLAS Collaboration, "ATLAS Detector and Physics Performance Technical Design Report", v.1, CERN-LHCC-99-014 (1999) CERN, Geneva, Switzerland.
* [9] G. Grindhammer, M. Rudowicz and S. Peters, "The Fast Simulation Of Electromagnetic And Hadronic Showers", NIM A290 (1990) 469.
* [10] Y. Kulchitsky et al., "The e/h ratio of the ATLAS Barrel Tile Calorimeter", ATL-TILECAL-2001-001 (2001) CERN, Geneva, Switzerland; JINR-E1-2002-13 (2002) JINR, Dubna, Russia.
* [11] J. Budagov, Y. Kulchitsky et al., "Electron response and e/h ratio of ATLAS barrel hadron prototype calorimeter", ATL-TILECAL-1996-072 (1996) CERN, Geneva, Switzerland; JINR-E1-95-513 (1995) JINR, Dubna, Russia.
* [12] R. Wigmans, "Calorimetry-Energy Measurement In Particle Physics", Oxford University Press, New York, U.S.A., 2000.
* [13] R.K. Bock, T. Hansl-Kozanecka and T.P. Shah, "Parametrization Of The Longitudinal Development Of Hadronic Showers In Sampling Calorimeters", NIM 186 (1981) 533.
* [14] R. Wigmans, "High Resolution Hadronic Calorimetry", NIM A265 (1988) 273.
* [15] A. Juste, "Analysis of the hadronic performance of the TILECAL prototype calorimeter and comparison with Monte Carlo", ATL-TILECAL-1995-069 (1995) CERN, Geneva, Switzerland.