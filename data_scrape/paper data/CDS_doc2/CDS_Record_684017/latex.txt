ATL-DAQ-2000-026

May 24, 2000

**Isolation of Electrons and Photons on the Second Level Trigger**

**M. Wielers**

TRIUMF, Vancouver, Canada

In this note the possible gain in jet rejection in the second level e/\(\gamma\) trigger is studied by applying isolation cuts. So far, isolation of electromagnetic showers is only required in the first level trigger and no verification is required at LVL2 in order to minimise data transfer. If isolation in a ring with outer radius \(R=0.2\) in the \(\eta-\phi\) plane around the cluster is required, an additional rate reduction of 32% (38%) is achieved for the LVL2 photons trigger at low (high) luminosity for an additional loss of 1% photon efficiency. For electrons the improvement is 33% (15%) for a 99% electron efficiency and 55% (32%) for a 98% electron efficiency at low (high) luminosity after the LVL2 selection using calorimeter information. For a smaller isolation cone (\(R=0.15\)) and 99% photon/electron efficiency the additional rate reduction is 20% (20%) for photons and 16% (13%) for electrons at low (high) luminosity. It is shown that the chosen isolation cuts do not degrade the selection of \(H\rightarrow\gamma\gamma\) and \(Z\to ee\) events by LVL2.

Introduction

In this note a possible gain in rate reduction due to isolation requirements at the level-2 trigger (LVL2) is studied for the photon trigger and for the selection of electrons based on calorimeter information. In the current LVL2 e/\(\gamma\) trigger the selection of electrons and photons using the calorimeter is based on an analysis of the shower core. At this level the full cell information of the calorimeters is available. Shower-shape quantities and cluster transverse energy information are used to discriminate electromagnetic clusters from jets. A detailed description of the LVL2 e/\(\gamma\) algorithms is presented in [1]. So far, no verification of the isolation required at LVL1 for electromagnetic clusters is performed. At LVL2 the calorimeter information in a window of size \(\Delta\eta\times\Delta\phi=0.4\times 0.4\) is available centered at the position of the LVL1 RoI. This position does not coincide exactly with the reconstructed shower position at LVL2. Therefore, within the current window, isolation could be studied in an isolation ring with outer radius \(R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}=0.15\) around the shower position. The shower itself has a size of around \(R=0.1\) which gives the inner radius of the isolation ring. Isolation can thus only be studied in a very limited region. Preferably this isolation region should be larger.

In the next section technical issues such as the reconstruction software and datasets used in this study are explained. Section 3 describes the isolation requirements. The performance in terms of additional jet rejection is discussed in section 4 for photons and electrons. At the end of this note the main results are summarised and an outlook is given.

## 2 Technical Issues

### Reconstruction Software

In the study presented in this note the Fortran based ATRIG program [2] is used to simulate the LVL1 and LVL2 jet trigger response. So far no algorithm is implemented to study isolation on the LVL2 trigger. Therefore, isolation is studied using the offline reconstruction code ATRECON [3]. ATRIG and ATRECON are executed in the same reconstruction chain.

At low luminosity electronic noise and digital filtering has been simulated in the calorimeters. Effect due to pileup are neglected. At high luminosity pileup is added in the calorimeter and the inner detector. In the calorimeters electronic noise as well as pileup noise are added to the cell energies and pileup is superimposed using the correct shaping functions [4] in the calorimeter. More information about the pileup method can be found in [5].

### Datasets

The detector layout used for this study corresponds to the detector design as described in [6] and [7]. To evaluate the trigger rates, around one million fully simulated QCD dijet events are used. On parton level each jet was required to have a \(p_{T}\) of at least 17 GeV and a rapidity within \(\pm 2.7\). The events were generated with Pythia 5.7 [8]. For the detector simulation the DICE 96_12 [9] geometry has been used (see [10] for differences in the detector geometry compared to the current design of the calorimeter). Initial as well as final state radiation was simulated. In addition to QCD dijet events, other physics processes such as prompt photon events, quark bremsstrahlung, intermediate W and Z production, and top production were generated according to their cross sections. Events which would not pass trigger LVL1 are immediately rejected before being processed by GEANT [11]. To obtain manageable datasets the QCD-dijets are required to pass the pseudo LVL1 trigger conditions for the electron stream using ATRIG [2]. The selection criteria are looser than those for trigger LVL1 and are described in [12]. After this trigger level only 2 (2)% of the total number of all QCD events generated for the low (high)-\(E_{T}\) sample survive at low luminosity.

To measure signal efficiencies and to parametrise the isolation cuts as a function of \(E_{T}\), single photons \(E_{T}=20,40,60\) GeV are used at low and high luminosity. Single electrons with \(E_{T}=20,40,60\) GeV at low luminosity and \(E_{T}=30\) GeV at high luminosity are considered.

The effect of isolation on 'physics' events is studied using fully simulated \(H\to\gamma\gamma\) events with \(m(H)=100\) GeV at low and high luminosity. At low luminosity 10000 Higgs events are available and at high luminosity around 2400 events. In addition, 8000 \(Z\to ee\) events are used at low luminosity.

## 3 Isolation Criteria

In this note isolation is tested using the traditional approach of an isolation cone (more precisely isolation ring). A cone with an inner and outer radius \(R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}\) is drawn around the electromagnetic cluster. The inner radius is given by the size of the shower. Here, \(R_{min}=0.1\) is chosen. The transverse energies of the all cells in the electromagnetic and hadronic calorimeters in this isolation ring are summed. If a cell is partly outside the ring it is considered if more than 50% of the cell lies inside the isolation ring. A shower is classified as isolated if the total transverse energy in the isolation ring is inferior to a certain value.

Figure 1 shows the difference in the \(\eta-\phi\) plane between the LVL1 RoI position and the reconstructed cluster position at LVL2 for single electrons and for jet clusters. The \(\Delta\eta\) as well as the \(\Delta\phi\) distribution have offsets of around 0.03 due to the 'corner-biasing' of the LVL1 electromagnetic algorithm [1]. This effect could be corrected for before accessing the LVL1 RoI. To study isolation with the current design, an isolation ring with \(R_{max}=0.15\) and \(R_{min}=0.1\) can be considered. This isolation region is quite small and larger values for \(R_{max}\) would be

Figure 1: Difference in the \(\eta-\phi\) plane between the LVL1 RoI and the reconstructed cluster position at LVL2 for (a) single electrons with \(E_{T}=20\) GeV and for (b) jets at low luminosity.

prefered. This would imply a larger \(\eta-\phi\) region must be available at LVL2 or before accessing the full calorimeter information the cluster position in the second sampling of the electromagnetic calorimeter must be measured. Preliminary studies have shown that an isolation ring of \(R_{max}=0.2\) and \(R_{min}=0.1\) gives the best performance w.r.t. jet rejection in the photon channel. Large cones are anyhow not prefered at LVL2 due to the dataflow requirements. Therefore, in this study isolation rings with \(R_{max}=0.2\) and \(R_{max}=0.15\) are considered.

Figure 2 shows the transverse energy in the isolation ring with \(R_{max}=0.2\) and \(R_{min}=0.1\) for single photons as a function of rapidity and cluster \(E_{T}\). It can be seen that isolation is not a

Figure 2: \(E_{T}\) measured in the isolation ring with \(R_{max}=0.2\) and \(R_{min}=0.1\) as a function of (a) rapidity and (b) transverse cluster energy. The 95% upper CL of the \(E_{T}\) deposited in the isolation ring is shown as a function of (c) rapidity and (d) cluster \(E_{T}\). (a) and (c) are obtained using single photons with \(E_{T}=20\) GeV, and (b) and (c) are obtained using single photons with \(\eta=0.3\) at low luminosity.

well defined quantity in the barrel/endcap transition region of the calorimeter. In the following, no isolation cuts will be applied in the region \(1.37<\mid\eta\mid<1.52\). Besides this region the rapidity dependence on the isolation requirements is not unfolded and all rapidities are treated in the same way. The dependence on the cluster \(E_{T}\) is demonstrated in figure 2b. To account for this effect, the summed \(E_{T}\) in the isolation ring must be inferior to a certain fraction of the cluster \(E_{T}\). The parametrisation is given by

\[E_{T}(\mbox{isol})<\epsilon\cdot E_{T}(\mbox{cluster})+c\]

In the following, this parametrisation will be evaluated using single photons and electrons.

## 4 Performance

In this section the possible gain in rates on LVL2 is dicussed for the LVL2 photon trigger and the LVL2 electron trigger part which is analysing the calorimeter information. Isolation cuts depend on the event signatures. Therefore, the impact of the isolation cuts on LVL2 is examined for \(H\rightarrow\gamma\gamma\) events and for \(Z\to ee\) events.

### Performance of the Photon Trigger

In this study the isolation cuts were optimised using single photons of 20, 40, and 60 GeV. For each energy the isolation cut is optimised for a 99% and 98% efficiency w.r.t. the LVL2 photon identificaton cuts. A straight line fit through these data points gives the values of \(\epsilon\) and \(c\) in the formula \(E_{T}(\mbox{isol})<\epsilon\cdot E_{T}(\mbox{cluster})+c\). The so obtained values of the parametrisation are given in table 1 Using this definitions for isolation the rates shown in table 2 are obtained.

Besides the rate from QCD jet and prompt photon events, the efficiencies of the photon selection and selection of \(H\rightarrow\gamma\gamma\) events are shown. Applying isolation in a ring with \(R_{max}=0.2\) which is optimised for a 99% single photon efficiency, a total rate reduction of 30-40% compared to the LVL2 photon rate without isolation. If tighter isolation cuts are applied which are 98% efficient w.r.t. single photons, no big improvement of the trigger rate is found. Using an isolation cone of \(R_{max}=0.15\) results in a further rate reduction of 20% (32%) at low luminosity and 20% (29%) at high luminosity while loosing 1% (2%) more isolated photons. If these isolation cuts are applied on the EF level, the additional rate reduction is around 16-23% (see table 3). Due to correlations between the isolation cuts and the photon identification cuts the additional jet

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline isolation & \(\gamma\) efficiency & Low Luminosity & High Luminosity \\ cone & w.r.t. LVL2 (\%) & c & \(\epsilon\) & c & \(\epsilon\) \\ \hline
0.2 & 99 & 1.33 & 0.0275 & 4.07 & 0.025 \\
0.2 & 98 & 1.05 & 0.0225 & 3.5 & 0.025 \\
0.15 & 99 & 1.1 & 0.0188 & 1.9 & 0.0313 \\
0.15 & 98 & 0.817 & 0.0163 & 1.883 & 0.0225 \\ \hline \end{tabular}
\end{table}
Table 1: Fitted values obtained for the parametrisation of the isolation for a 99% (98%) photon efficiency after the LVL2 photon selection. Isolation is measured in isolation cone with radius \(R_{max}=0.2\) and 0.15. The isolation cuts are parametrised as \(E_{T}(\mbox{isol})<\epsilon\cdot E_{T}(\mbox{cluster})+c\).

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline Isolation cone & Luminosity & Higgs & prompt \(\gamma\) & QCD jet \\  & & efficiency (\%) & Rate (Hz) & Rate (Hz) \\ \hline no isolation & low & \(97.4\pm 0.2\) & \(22\pm 4\) & \(61\pm 7\) \\ \(R=0.2(99\%)\) & low & \(97.1\pm 0.2\) & \(20\pm 4\) & \(43\pm 6\) \\ \(R=0.2(98\%)\) & low & \(96.6\pm 0.2\) & \(20\pm 4\) & \(40\pm 6\) \\ \(R=0.15(99\%)\) & low & \(97.1\pm 0.2\) & \(21\pm 4\) & \(48\pm 6\) \\ \(R=0.15(98\%)\) & low & \(96.8\pm 0.2\) & \(21\pm 4\) & \(42\pm 6\) \\ \hline no isolation & high & \(98.3\pm 0.4\) & \(38\pm 17\) & \(236\pm 42\) \\ \(R=0.2(99\%)\) & high & \(95.8\pm 0.4\) & \(38\pm 17\) & \(160\pm 35\) \\ \(R=0.2(98\%)\) & high & \(94.2\pm 0.2\) & \(38\pm 17\) & \(160\pm 35\) \\ \(R=0.15(99\%)\) & high & \(96.8\pm 0.4\) & \(38\pm 17\) & \(190\pm 38\) \\ \(R=0.15(98\%)\) & high & \(95.3\pm 0.2\) & \(38\pm 17\) & \(175\pm 36\) \\ \hline \end{tabular}
\end{table}
Table 2: Expected rates at threshold and background rates for the LVL2 photon trigger at low and high luminosity for different isolation cones and photon efficiencies. In addition, the trigger efficiencies for \(H\to\gamma\gamma\) events are shown for \(m(H)=100\) GeV. 99% (98%) means an additional loss of 1% (2%) after the LVL2 photon trigger due to the isolation requirement.

\begin{table}
\begin{tabular}{|l|c|c|c|c|} \hline Isolation cone & Luminosity & Higgs & prompt \(\gamma\) & QCD jet \\  & & efficiency (\%) & Rate (Hz) & Rate (Hz) \\ \hline no isolation & low & \(92.2\pm 0.2\) & \(20\pm 4\) & \(31\pm 5\) \\ \(R=0.2(99\%)\) & low & \(91.8\pm 0.2\) & \(18\pm 4\) & \(25\pm 5\) \\ \(R=0.2(98\%)\) & low & \(91.5\pm 0.2\) & \(17\pm 4\) & \(25\pm 5\) \\ \(R=0.15(99\%)\) & low & \(91.8\pm 0.2\) & \(19\pm 4\) & \(26\pm 5\) \\ \(R=0.15(98\%)\) & low & \(91.4\pm 0.2\) & \(18\pm 4\) & \(25\pm 5\) \\ \hline no isolation & high & \(75.8\pm 0.9\) & \(38\pm 17\) & \(84\pm 25\) \\ \(R=0.2(99\%)\) & high & \(75.4\pm 0.4\) & \(38\pm 17\) & \(61\pm 21\) \\ \(R=0.2(98\%)\) & high & \(74.4\pm 0.2\) & \(38\pm 17\) & \(61\pm 21\) \\ \(R=0.15(99\%)\) & high & \(75.8\pm 0.4\) & \(38\pm 17\) & \(84\pm 25\) \\ \(R=0.15(98\%)\) & high & \(75.2\pm 0.2\) & \(38\pm 17\) & \(76\pm 24\) \\ \hline \end{tabular}
\end{table}
Table 3: Expected rates at threshold and background rates for the EF photon trigger at low and high luminosity for different isolation cones and photon efficiencies. In addition, the trigger efficiencies for \(H\to\gamma\gamma\) events are shown for \(m(H)=100\) GeV. 99% (98%) means an additional loss of 1% (2%) after the EF photon trigger due to the isolation requirement.

[MISSING_PAGE_EMPTY:7]

values are close to the expected drop in efficiency of around 2% which indicates that photons from Higgs events are well isolated. In case harder isolation cuts than those chosen on LVL1 are applied no significant drop in the Higgs efficiency is expected. The effect of the isolation cut at LVL1 and LVL2 on Higgs events is demonstrated in figure 3 for the low luminosity scenario.

### Performance of the LVL2 Electron Trigger

Isolation can also be applied on the LVL2 electron trigger. Figure 4 shows the isolation of single photons and electrons with \(E_{T}=20\) GeV. Electrons tend to shower earlier and they loose energy due to bremsstrahlung. Therefore, on average more transverse energy is deposited in the isolation ring.

The isolation cuts are tuned for a 99% and a 98% efficiency w.r.t. the LVL2 electron candidates after the calorimeter selection. The parameters of the parametrisation \(E_{T}(\mathrm{isol})<\epsilon\cdot E_{T}(\mathrm{cluster})+c\) are summarised in table 5 for cone sizes \(R_{max}=0.2\) and \(R_{max}=0.15\). The effect of isolation applied on the LVL2 electron trigger is shown in table 6. An additional jet rejection of 33% (55%) at low luminosity and 15% (32%) at high luminosity is found in case isolation in a cone with \(R_{max}=0.2\) is required which is optimised for a 99% (98%) single electron efficiency w.r.t. the LVL2 calorimeter trigger. For an isolation cone with \(R_{max}=0.15\) the additional rate reduction is 16% (29%) at low luminosity and 13% (17%) at high luminosity for a 99% (98%) single electron efficiency. Using a cone of size \(R_{max}=0.2\) a much more powerful jet rejection is obtained. Instead of applying isolation the electron selection cuts might be tightened. In this case a 10% better jet rejection is found for an additional efficiency loss of 1% [13]. Hence, applying an isolation cut is prefered.

The effect of an isolation cut on \(Z\to ee\) events at low luminosity is shown in table 7. \(Z\to ee\) events are selected with a very high efficiency. Applying isolation cuts affects mainly the double object trigger. This can be explained by the fact that some of the electrons are not well isolated. The effect of the isolation cut at LVL1 and LVL2 on Z events is demonstrated in figure 5 for the low luminosity scenario.

Figure 4: Summed transverse energy in the isolation ring with \(R_{max}=0.2\) and \(R_{min}=0.1\) for single photons and electrons having \(E_{T}=20\) GeV.

## 5 Conclusions and Outlook

In this note the possible gain in rate reduction at LVL2 is studied if at LVL2 isolation is required for electron and photon candidates. So far only at LVL1 isolation is required in the electromagnetic and the hadronic calorimeters. At LVL2 isolation is verified by testing the lateral shower shape of the cluster. The test of the isolation in a ring around the shower core as done on LVL1 is not repeated.

In this study, isolation is studied in an isolation ring or radius \(R_{max}=0.2\) (0.15) and \(R_{min}=0.1\) around the shower core. This is done after the simulation of the trigger response using the offline reconstruction code. For a moderate loss of 1% photon efficiency an additional rate reduction of 32% (38%) is achieved for the LVL2 photons trigger at low (high) luminosity using an isolation cone of size \(R_{max}=0.2\). For electrons the improvement is 33% (15%) for a 99% electron efficiency and 55% (32%) for a 98% electron efficiency at low (high) luminosity after the LVL2 selection using calorimeter information. In this case the gain is less at high luminosity but would still yield an improvement in execution time on LVL2 because the more time demanding track reconstruction step in the silicon and TRT detectors does not need to be performed if the cluster is already rejected by the calorimeter selection. In case an isolation cone with radius \(R_{max}=0.15\) is chosen the additional gain in rate reduction is reduced by 50%.

The effect of the isolation cut on physics events has been estimated using \(H\rightarrow\gamma\gamma\) and \(Z\to ee\) events. In both cases no drastic looses in selecting these events by LVL2 are found. It is shown that using isolation (which is not too strict) an additional background rate reduction is achieved while maintaining a high efficiency to select physics events.

In the current scheme the information within \(\Delta\eta\times\Delta\phi=0.4\times 0.4\) is transferred to LVL2. This allows to study isolation in the isolation ring given by \(R_{max}=0.15\) and \(R_{min}=0.1\). In this case the additonal gain in jet rejection is moderate. Enlarging the isolation region to \(R_{max}=0.2\) would be much prefered but would require the information within \(\Delta\eta\times\Delta\phi=0.5\times 0.5\) around

\begin{table}
\begin{tabular}{|c|c|r|r|r|r|} \hline isolation & e efficiency & Low Luminosity & \multicolumn{2}{|c|}{High Luminosity} \\ cone & w.r.t. LVL2 (\%) & c & \(\epsilon\) & c & \(\epsilon\) \\ \hline
0.2 & 99 & 1.6 & 0.03 & 4.3 & 0.03 \\
0.2 & 98 & 1.1 & 0.03 & 3.75 & 0.03 \\
0.15 & 99 & 1.1 & 0.0312 & 2.6 & 0.0312 \\
0.15 & 98 & 0.75 & 0.0263 & 2.05 & 0.0263 \\ \hline \end{tabular}
\end{table}
Table 5: Fitted values obtained for the parametrisation of the isolation in \(R_{max}=0.2\) and \(R_{max}=0.15\) for a 99% (98%) electron efficiency after the LVL2 electron selection using only calorimeter information. Isolation is measured in a ring with outer radius \(R_{max}=0.2\) and 0.15 around the cluster. The isolation cuts are parametrised as \(E_{T}(\mathrm{isol})<\epsilon\cdot E_{T}(\mathrm{cluster})+c\). At high luminosity only electrons with \(E_{T}=30\) GeV are considered and for the parametrisation the same slope is chosen as at low luminosity.

the LVL1 RoI. This would increase the data transfer by around 60%. Another possibility is to request in the beginning the information of the second sampling of the electromagnetic calorimeter, calculate the correct shower position and only afterwards the full calorimeter are accessed in the region of size \(0.4\times 0.4\). This gain in rate reduction still needs to be evaluated with respect to the amount of data to be transferred.

This analysis has been performed using the offline reconstruction code. Due to the limited \(\eta-\phi\) region available around each LVL1 RoI at LVL2, this study should be repeated using the trigger simulation package. This is especially true in case isolation is studied in the ring with outer radius \(R_{max}=0.15\). No attempt is made to combine the isolation cuts with the photon and electron identification cuts which are based on analysing the shower core. Only after such an analysis the final gain in background reduction can be given for LVL2 as well as for the EF and offline.

## References

* [1] S. Gonzalez, T. Hansl-Kozanecka, M. Wielers, ATL-DAQ-2000-002, (2000)

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|c|} \hline  & & no isol & \multicolumn{2}{c|}{\(R=0.2\)} & \multicolumn{2}{c|}{\(R=0.15\)} \\ Trigger & Luminosity & Rate (Hz) & \multicolumn{2}{c|}{(99\% eff.)} & \multicolumn{2}{c|}{(98\% eff.)} & \multicolumn{2}{c|}{(99\% eff.)} & \multicolumn{2}{c|}{(98\% eff.)} \\  & & & Rate (Hz) & Rate (Hz) & Rate (Hz) & Rate (Hz) \\ \hline e20i & low & \(1050\pm 30\) & \(790\pm 26\) & \(697\pm 24\) & \(906\pm 28\) & \(815\pm 26\) \\ \hline e30i & high & \(3070\pm 153\) & \(2660\pm 142\) & \(2500\pm 138\) & \(2713\pm 144\) & \(2611\pm 141\) \\ e20i\(\times\)2 & high & \(23\pm 13\) & \(15\pm 11\) & \(8\pm 8\) & \(8\pm 8\) & \(8\pm 8\) \\ e30i or e20i\(\times\)2 & high & \(3078\pm 153\) & \(2667\pm 142\) & \(2508\pm 138\) & \(2720\pm 144\) & \(2622\pm 141\) \\ \hline \end{tabular}
\end{table}
Table 6: Expected background rates for the LVL2 electron calorimeter trigger at low and high luminosity. The rates are given without isolation requirement or for isolation in a cone with radius \(R_{max}=0.2\) and \(R_{max}=0.15\) around the cluster in the \(\eta-\phi\) plane. The rates are given for isolation cuts optimised for a 99% and 98% efficiency on single electrons w.r.t. the LVL2 electron selection using the calorimeter information. No rates for the e20i\(\times\)2 trigger is given at low luminosity due a bias in the jet production.

\begin{table}
\begin{tabular}{|l|c|c|c|c|c|} \hline Trigger & no isol & \(R=0.2(99\%)\) & \(R=0.2(98\%)\) & \(R=0.15(99\%)\) & \(R=0.15(98\%)\) \\  & eff. (\%) & eff. (\%) & eff. (\%) & eff. (\%) & eff. (\%) \\ \hline e20i & \(98.5\pm 0.1\) & \(98.4\pm 0.1\) & \(98.1\pm 0.1\) & \(98.4\pm 0.1\) & \(98.2\pm 0.1\) \\ e15i\(\times\)2 & \(85.0\pm 0.4\) & \(82.3\pm 0.4\) & \(79.5\pm 0.5\) & \(83.1\pm 0.4\) & \(79.7\pm 0.5\) \\ e20i or 15i\(\times\)2 & \(98.6\pm 0.1\) & \(98.5\pm 0.1\) & \(98.2\pm 0.1\) & \(98.5\pm 0.1\) & \(98.3\pm 0.1\) \\ \hline \end{tabular}
\end{table}
Table 7: Efficiency to select \(Z\to ee\) events by the LVL2 calorimeter selection for electron candidates at low luminosity. The Z efficiencies are given before and after isolation is required. The isolation cuts are optimised for cone sizes \(R_{max}=0.2\) and \(0.15\) for single electron efficiencies of 99% and 98% w.r.t the LVL2 calorimeter electron trigger.