**ATLAS Internal Note**

**DAQ-NO-009**

**12 January 1993**

**A Second Level Calorimeter Trigger Algorithm.**

J.Carter, Z.Hajduk, K.Korcyl, J.Strong.

Royal Holloway, University of London.

January 12, 1993

Abstract

A preliminary study of the jet rejection power of an algorithm using the full granularity of the electromagnetic calorimeter is described. We find that a rejection factor of 10 can be achieved for jets passing the first level electromagnetic trigger, whilst maintaining an electron efficiency of over 95%. The time for the major part of the algorithm to run on a digital signal processing chip has been investigated.

## 1. Introduction

The event rate input to the second level trigger is expected to be around 100kHz. A possible architecture for the second level trigger is a variety of low level feature extraction modules associated with different subdetectors passing their output (eg clusters, tracks etc) into a global trigger module, which then performs event classification. This note is a preliminary study of the event rate reduction that might be expected using information from one such subdetector alone, i.e. the electromagnetic calorimeter, in a simple cluster analysis algorithm. A hardware implementation of this algorithm in a candidate architecture for a feature extraction module is discussed. At this stage pileup has not been incorporated into the data sample.

## 2. Event Simulation

Events were simulated using a modified version of the EAGLE_B detector configuration. This modification was the replacement of the detailed electromagnetic calorimeter model with a homogenous material of mean density, read out with a granularity in \(\eta\) and in \(\phi\) of 0.02, and segmented longitudinally into two samples where the first sample is 14.6 rad lengths.We have also assumed per \(0.02\times 0.02\) cell an electronic noise of 75 MeV r.m.s., a resolution of 10 MeV from the digitisation process, and an electronics gain fluctuation of 2% r.m.s. Two classes of events were generated: two-jet events, and single electron events. The jet events were generated with primary parton \(\rm p_{t}>35GeV\) and \(\rm\eta|<0.5\) at the kinematic level and fully simulated in the detector configuration. The single electron events were generated in the energy range 20-80GeV and with \(\rm\eta|<0.5\). The first level electromagnetic calorimeter trigger simulation was then applied to these events. Briefly, this first level trigger algorithm looks for adjacent pairs of \(0.1\times 0.1\) (\(\rm\eta x\phi\)) electromagnetic cells with energy above 35GeV, and tests if the energy sum of an isolation region around these cells plus the hadronic calorimeter energy behind has an energy less than 5GeV. Events passing the first level trigger were the input to the second level trigger study: 469 jet events, and 1033 single electron events. For full details ofthe event simulation refer to references [1] and [2], and we would like to acknowledge the contributions of the authors of these notes in this study.

## 3 Second Level Calorimeter Trigger Algorithm

The events passing the first level trigger together with the address of the lower or left hand cell of the pair of first level trigger cells where the trigger occurred and the energy found in those cells are the assumed baseline for this algorithm. The algorithm searches the area (called a region of interest, or RoI) indicated by the first level trigger cell address for the maximum energy \(2\times 2\) cell group (i.e. \(0.04\times 0.04\) in \(\eta\chi\phi\)), which we will refer to as the core energy. Fig.1 shows the distribution of the core energy against that of the first level trigger cluster energy, for electrons and jets. Based on this data, a first selection is made which requires the ratio of the core energy to the first level trigger cluster energy to be greater than two thirds. RoIs which pass the above criterion are then examined in greater detail. Two concentric frames, see Fig.2, each one cell wide and referred to as the inner and outer frames, are formed around the core and their ratios to the core energy computed. In addition, for the \(2\times 2\) cell core area, the ratios of the front electromagnetic calorimeter sample energy to the core energy, and of the hadronic calorimeter energy to the core energy are computed. The jet rejection factors and electron acceptance efficiencies for a range values of these estimators are given in Table 1.

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|} \hline \multicolumn{2}{|c|}{Transverse} & \multicolumn{2}{|c|}{Longitudinal} & & \\ \hline Inner/Core & Outer/Core & Front/Core & \multirow{2}{*}{\begin{tabular}{c} Hcal/Core \\ greater than \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} Jet Rejection \\ less than \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} Electron \\ Factor \\ \end{tabular} } & \multirow{2}{*}{
\begin{tabular}{c} Electron \\ Acceptance \\ \end{tabular} } \\ \hline no cut & no cut & 0.80 & 0.02 & 2.5 & 0.99 \\
0.20 & 0.10 & no cut & no cut & 6 & 0.99 \\
0.20 & 0.08 & no cut & no cut & 7 & 0.99 \\
0.20 & 0.10 & 0.80 & 0.02 & 7 & 0.98 \\
0.18 & 0.10 & no cut & no cut & 7 & 0.98 \\
0.18 & 0.08 & no cut & no cut & 8 & 0.98 \\
0.16 & 0.10 & no cut & no cut & 8 & 0.96 \\
0.20 & 0.06 & no cut & no cut & 11 & 0.96 \\
0.20 & 0.06 & 0.80 & 0.02 & 13 & 0.95 \\
0.16 & 0.06 & no cut & no cut & 13 & 0.94 \\
0.16 & 0.06 & 0.08 & 0.02 & 15 & 0.93 \\ \hline \end{tabular}
\end{table}
Table 1: Jet rejection and electron acceptance factors as a function of estimator values.

Figs. 3 and 4 show the performance of transverse and longitudinal estimators for the data sample and demonstrate that the selectivity comes from the transverse estimators with little to be gained from longitudinal estimators for data that passes a first level trigger which includes an hadronic energy cut.

## 4 Discussion

Other calorimeter clustering algorithms using independent event generation and selection samples give similar results and complement the results presented here [3]. So far we have been unable to pursue the effect of pile-up on the algorithm presented but Hawkings [4] has found that using fairly loose thresholds on these cluster estimators a jet rejection of about 8 can be achieved in a high, i.e. <40>, pile-up environment with very little loss of electron efficiency (0.2%). We note that an improvement to the longitudinal cluster estimator discrimination may be possible if the electromagnetic calorimeter used a thinner front sampling, and anticipate that this improvement would be relatively insensitive to pileup. Longitudinal discrimination would be of value for the high energy (\(\mathrm{p_{T}}\) > 65 GeV) single em cluster triggers where the isolation requirement is removed and the jet trigger rate increases by a factor of 30 [1] above its isolated rate.

## 5 Implementation

We have made initial tests of the practicability of the algorithm considered above. The time consuming part of the algorithm, the core finding routine, has been coded onto a digital signal processing chip, a Texas TMS320C40. Table 2 shows the time taken to perform the algorithm for a range of size of the region of interest. For a first level trigger cell size of \(0.1\times 0.1\) in \(\eta\) and \(\phi\) (\(5\times 5\) basic calorimeter cells) the size of the region of interest would be \(16\times 16\) giving a core finding time of 102 \(\upmu\)s which is in line with a second level trigger latency of the order of 1 ms. More details of this evaluation may be found in ref [5].

## 6 References

* [1] A.Watson et al., ATLAS note DAQ-NO-005
* [2] R.Hawking et al., ATLAS note INDET-NO-013
* [3] G.Klyuchnikov et al., EAST note 92-23
* [4] R.Hawkings et al., ATLAS note INDET-NO-013 addendum
* [5] T.Bharucha et al., EAST note 92-26

\begin{table}
\begin{tabular}{|c|c|c|c|c|c|c|} \hline RoI size & \(12\times 12\) & \(14\times 14\) & \(16\times 16\) & \(18\times 18\) & \(20\times 20\) & \(22\times 22\) & \(24\times 24\) \\ \hline Time in \(\upmu\)s & 45.7 & 71.0 & 102.0 & 139.2 & 182.0 & 233.3 & 288.0 \\ \hline \end{tabular}
\end{table}
Table 2: Time to find the most energetic \(2\times 2\) core as a function of the search area (RoI size).

[MISSING_PAGE_EMPTY:4]

Figure 4: Longitudinal estimator of core energy in in back em and hadronic sample divided by core sample energy

Figure 3: Transverse estimator of core energy divided by sum of core, inner and outer energies for electrons and jets.