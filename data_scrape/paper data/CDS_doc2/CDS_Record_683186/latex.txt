**ATGEN - Monte-Carlo interface using GENZ**

User's Guide

Version 1.00

June 6, 1995

A. Amorim 1

ATLAS Software Group

## About this guide

I apologize to the reader who is an expert in the standard packages of high energy physics for the sometimes trivial matters that are here included. The ATLAS software has by now become an impressive accomplishment and to deal with most of the packages one has to understand the basic mechanisms at a level that makes this guide look naive. My only justification to include the well known material is to ease the life of the non-expert to get into the main concepts used in our packages. One has to start somewhere and I tried to make the way in simple even the less familiar user.

**Acknowledgments**

The author would like to thank all his colleagues who, by their encouragement, have made this a pleasant task. I am particularly graceful to A. Pereira for his suggestions for a "non-expert" manual and to P. Ferreira for having tested the code. The constant help of G. Poulard and the guidance and encouragement of M. Nessi, P. Nevski D. Froidevaux are deeply acknowledged.

**Related Manuals**

The PYTHIA/JETSET manual[20]

The ISAJET manual[22]

The HERWIG manual[24]

The GENCL reference paper[25]

The NJETS reference notes (Stephane BASA)[26]

The ZEBRA manual[2]

The SLUG manual[16]

The GENZ manual[1]

The FFREAD manual[8]

The HBOOK manual[10]

## Table of Contents

* 1 Introduction
* 2 Installing ATGEN
	* 2.1 Running using the ATLAS software release
	* 2.2 Running the program on the ATLAS farm
	* 2.3 Installing the program as stand-alone
	* 2.4 Getting the new correction files for ATGEN
* 3 Running ATGEN

[MISSING_PAGE_EMPTY:3]

## Chapter 1: Introduction

ATGEN - DIVERSITY1 is a system for integrating particle physics generators into a common framework. The main purpose is to provide a simple particle-level simulation tool for ATLAS that generates output compatible with the input format of the full detector simulator package of SLUG/DICE[17, 16]. In the interest of user friendliness it is kept as a stand-alone program with a simple installing procedure described in Chap. 2.

Footnote 1: Diversity is a system radio system in which different antennas are scanned in order to peek the most clear signal. This program is meant to integrate different physics Monte-Carlos to achieve the most clear signatures from ATLAS

A similar interface is also maintained inside the SLUG package [19]. In that case an different approach is used which is suitable for advanced users. It consists mainly of favoring the use of routines to deal directly with the ZEBRA banks instead of event COMMON blocks and keeping the use of only one generator at the time by defining the appropriate SELECTS in CMZ[9]. This mechanism of conditional compilation also exists in ATGEN but the program is designed such that all generators can be available at the same time.

Presently the ATGEN program is an interface to the PYTHIA[20], JETSET[21], ISAJET[22], ISASUSY[23], HERWIG[24], GENCL[25] and NJETS[26] generators and is planned to include several other generators, namely, of the matrix element type. The program can write and read zebra sequential files and is suitable to perform particle level analysis which are preliminary to the more complex and time consuming full event simulation by DICE and its reconstruction by ATRECON[18].

In the distribution of ATGEN the generator codes are included after being converted to a set of CMZ files. The corresponding correction files include the very few changes applied to the respective generators.

Following the SLUG conventions, the zebra files have the names of ZEBRA.O for output, ZEBRA.P to read the primary stream and ZEBRA.B for the secondary stream to add minimum bias events to the main event. The program is driven via data-cards using the FFREAD[8] package. In the case of ISAJET the specific input commands must be appended to the data-card file after the END statement.

## Chapter 2: Installing ATGEN

The program should be put on the ATLAS area (see Sec. 2.1) as soon as there are not to many obvious bugs. Meanwhile one can either use the executable and libraries as mentioned in Sec. 2.2 or one can do a complete installation following the steps described in Sec. 2.3

To construct ATGEN as user friendly as possible I have included in the stand-alone installation all source files of both the program and used libraries. The only external libraries that are required to be present on your computer are the CERN libraries PACKLIB MATHLIB and KERNLIB[14]. Extensive use of the CERNLIB executables PAW[11] and the CMZ[9] code manager must also be envisaged. These libraries and executables may be obtained from the CERN software repository asis01.cern.ch by anonymous FTP1.

Footnote 1: A previous registration may be required. To register one can send a mail to **cernlib@cern.ch**

The program has been tested in the HP-Unix, IBM-6000, DEC-osf1(alpha), PC-linux and SUN workstations and the included scripts to build the executable for these machines are named atgen.XXX.ins where XXX is the machine type.

### Running using the ATLAS software release

The ATLAS software is maintained by G. Poulard and includes a series of CMZ macros which perform the installation of the different parts of the software. The software is located at CERN on a directory pointed by the SLHC'ROOT variable. The macros are located in the subdirectory macros and include the **atl'lib** macro to compile a library, the **atl'bin** macro to build the executables and the **atl'build** macro to build an executable including the user corrections. A mechanism for selecting different versions was developed to use with GEANT and will be extended to the different generators. Different versions of the software may be located in the pro, new and dev subdirectories.

### Running the program on the ATLAS farm

All the libraries and executables are on the directory

/afs/cern.ch/user/aamorrim/public/atgentest

available via AFS and accessible in the ALTAS1 and ATLAS2 machines. If one wants to use the libraries located here but include corrections in the executable, he must copy the **atgen.cmz, atgen.corr, my.cmz and atgen.hpux.ins** files to his directory and modify the script atgen.hpux.ins by including in the compilation statement the above library directory (**-L /afs/cern.ch/user/a/aamorrim/public/atgentest**. The atgen.hpux.ins script will then be able to create a new executable file in his directory.

### Installing the program as stand-alone

The ATGEN program is stand-alone which allows is to be installed independently of other packages except CERNLIB which is assumed to be present. The sequence of procedures necessary to build the libraries and the executables in your machine is described in the steps bellow:

1. Copying the file:

[MISSING_PAGE_FAIL:6]

An executable file (**atgen.exe**) must be created by using the appropriate Unix script file. On HP workstations this file is named **atgen.npux.ins** and for the other tested environments a similar file is included. The generalization to other UNIX machines where the CERN library is available is very simple and correspond only to change the compilation statement in these files.2

Footnote 2: An utility to dump the ZEBRA files is included in atgen.tar. The zebdump.f file is a modified copy of the ATLAS utility with the same name available on CERNVM. The executable can be obtained using the enclosed zebdump.XXX.ins where XXX is the machine type.

### 2.4 Getting the new correction files for ATGEN

Some not very deep corrections to both ATGEN and the generator libraries will become available very often. This makes is rather cumbersome to always repeat the installation procedure. The alternative choice is to copy the correction files atgen.corr or XXX.corr where XXX is the generator and version.

Following the choices for the ATLAS software maintenance the separate correction files are kept for each library. To upgrade a specific page one has to copy the correction file, edit the specific kumac that builds that library adding the USE directive for that file and execute this kumac. A new library will be built that will be used when linking atgen. If required a copy of the old library can be kept to check the compatibility of results.

In the case of ATGEN corrections one just needs to include the USE file in the atgen.XXX.ins script that builds the executable and run it.

The new correction files will be available in the ATLAS software directories but for the time being they can be picked form the mentioned directory in the ATLAS farm.

## Chapter 3: Running ATGEN

In this Chapter the simple procedures to run ATGEN are described. The Unix syntax is used which has to be changed in the case to VM/CMS of VMS syntax in non-Unix machines.

### 3.1 Generating Events with ATGEN

The ATGEN program reads the data-cards from the standard input and writes all messages to the standard output. To run the program one has just to give the input data-card and, if wanted, to redirect the output to a listing file. Some examples of data-card files are created during the installation procedure. These data-cards are described in detail in Chap. 5, in particular the TASK card controls the program task as event generation using a specific generator or reading back the events to do a new analysis (TASK=0).

The command

\[\text{atgen.exe}<\text{wjjpyt.datacard}>\text{listfile}\enspace,\]

for example, runs ATGEN using the **wjjpyt.datacard** file that generates events using PYTHIA and writes them on the ZEBRA.O output file.

The ATGEN program creates the following output files:

* at.hbook This hbook file may contains an ntuple (1) automatically generated by ATGEN using the PART card (Chap. 7) and all histogram and ntuple allocation performed in the user routines (see Chap. 6).
* ZEBRA.O The ZEBRA file is a binary file written in the machine independent format that contains the ZEBRA banks RUNT and EVNT that contain the full event information1. Footnote 1: Since the ZEBRA.O file is opened by GENZ with status=new, if it already exist an error is reported and the file is not overwritten. In the HP-machines a file with name ffn23 will contain the ZEBRA output.

### 3.2 Reading Events From the ZEBRA File

The FZ file written by ATGEN contains information on all particles in each event. The output file ZEBRA.O can be used for input by renaming it to file ZEBRA.P and running ATGEN with a data-card including a TASK 0 card. This is a fast procedure to perform a new analysis on the already generated events.

This can be done, for example, by issuing the command:

\[\text{atgen.exe}<\text{wjjread.datacard}>\text{newlisting}\]

The **wjjread.datacard** is a demo file created by the INSTALL procedure that differs form the event generation data-card by the TASK 0 line. All CARDS to steer the generator options are irrelevant.

The zebdump utility included in the ATGEN release provides a simple way to exam the BANK headers in this file.

## Chapter 4: Interfacing with the Physics Generators

A log file of the generator sourcefiles that were picked for ATLAS is kept updated in file GENERATOR.HISTORY. In the present version it contains:

GENERATOR Int.ver cmz-file corr SOURCE Last Change My DATE ----------------------------------------------------- PYTHIA 5.7 pythia57 pythia5704 Sjostrand(torsjo.1920 CERNVM) 7.4.94 25.5.94 JETSET 7.4 jetset74 jetset7402 Sjostrand(torsjo.1920 CERNVM) 7.4.94 25.5.94 ISAJET 7.09 isajet7 isajet709 bnlux1.bnl.gov/pub/isajet/... 23.4.94 14.6.94 GENCL 1 gencl gencl R. Hawkings(pubzp.1970 CERNVM) 18.6.94 ISAJET 7.10 isajet710 isajet710 bnlux1.bnl.gov/pub/isajet/... 29.7.94 22.8.94 JETSET 7.4 jetset74 jetset7403 Sjostrand(torsjo.1920 CERNVM) 15.7.94 24.8.94 PYTHIA 5.7 pythia57 pythia5705 Sjostrand(torsjo.1920 CERNVM) 15.7.94 24.8.94 PYTHIA 5.7 pythia57 pythia5705a Sjostrand(mail bug on W+W-BRAtio) 05.9.94 JETSET 7.4 jetset74 jetset7404 Sjostrand(torsjo.1920 CERNVM) 26.8.94 24.11.94 PYTHIA 5.7 pythia57 pythia5709 Sjostrand(torsjo.1920 CERNVM) 26.10.94 24.11.94 ISAJET 7.13 isajet713 isajet713 bnlux1.bnl.gov/pub/isajet/...30.9.94 24.11.94 NJETS 2.1 njets... sbasa@atlas.cern.ch/public/njets 4.4.95 05-20-94

The generator source files were converted using the CMZ code manager and the following changes are introduced in the corresponding correction files:

* The HEPEVT common block that had 2000 lines in GENZ and HERWIG and 4000 line in ISAJET, PYTHIA and JETSET was set to 10000 in all codes consistently. This is a choice which has some advantages ( it allows the inclusion of a reasonable number of min-bias events ( the non-decayed particles only) and allows this common block to be used to do particle level analysis including pile-up. Since most generators have special input to include minimum bias events, a large enough common block is required to use this option. This option had not to done in SLUG because the minimum bias events are added at the level of the KINE bank.
* In PYTHIA and JETSET I also set the length of the LUJETS common to 10000 in order to be able to copy events to this format at any time.
* In ISAJET I had to remove a \(+\)EOD line of all routines in the CMZ file.
* In HERWIG I had to change the name of the internal routine iucomp due to a conflict with the standard cernlib routine with the same name.
* In GENCL I added user control on beam(target) type and momentum.

The change on the common block size force a similar change in SLUG before linking these libraries with SLUG. The output ZBRA.O file is, however, perfectly compatible with SLUG since all information is contained in data banks.

All changes from the original programs are kept separately in one correction file for each generator. Generator upgrades that do not involve a change in the version will also be included in separate correction files. This makes it easy to choose among different patches at compilation time and also avoids keeping many versions of the same code.

## Chapter 5 ATGEN data-cards

Some example of very simple data-cards are on the ATGEN.CMZ file under the directory DATA-CARD (also copied to.datacard files on the installation procedure). They are examples of DRELL-YAN production of W's decaying into jets using the different physics generators. Example cards for the top hadronic events are also included. I would greatly appreciate if people could send me the data-cards that they have built to be included as examples.

The datacard choice follows as close as possible the SLUG conventions and, namely, the PYTHIA data-cards are directly compatible with SLUG. The changes that are being made in SLUG/GENSLUG will make the data-cards compatible in all cases.

The FFREAD[8] package reads input from a file in a very intuitive way. All values until the END statement is reached are red at once and the assigned variables to each defined card are loaded. The syntax follows the example CARD 1 2 10=5

in which the vector assigned to CARD inputs its first value as 1 second as 2 and its tenth value as 5. This can be followed by lines with the same CARD but with different assignments (like CARD 11=6). An *CARD statement means that the variables are loaded and an appropriate routine in run.

In the following description of the ATGEN cards tables with the same format are used. In these tables the column CARD gives the card name, NUM the number of parameters, TYPE the parameter type (I=integer, A=Character*4, R=Real). In the first line the generic card is described and the following lines refer to each of the parameters and options. The NUM column for the lines bellow the first one refers to the number of the parameter being described.

### General Purpose Cards in ATGEN

In this section the general purpose Cards, that are independent of the specific generator used, are introduced.

CARD NUM type Description Defaults ------------------------------------------------------------ TASK 1 I Controls the ATGEN TASK to be performed D=0  1 I =0 Reads Events from ZEBRA.P  =1 Generates events using PYTHIA and stores in ZEBRA.0  =-1 Generates using PYTHIA but does not store  =2 Consider fragmented partons (like SLUG KINE 0) stores  =-2 " " " does not store  =3 Generates events using ISAJET and stores  =-3 " " " does not store  =4 CALLS ISASUSY followed by ISAJET and stores  =-4 " " " " does not store  =5 Uses Herwig and stores the events  =-5 " " does not store  =6 Generates events using GENCL and stores  =-6 " " " " and does not store  =7 Generates events using NJETS and stores  =-7 " " " and does not store  =+++ I am working on it and user requests are welcome.

CARD NUM type Description Defaults ------------------------------------------------------------ T RIG 1 I The total number of events to be precessed. D=100.  (In using ISAJET the number of events generated is

[MISSING_PAGE_EMPTY:11]

### The cards relative to the PYTHIA and JETSET generators

3 ==> Special Helicity Approximation (SPHEL)

4 ==> MAXWELL

5 ==> ESFAG

6 ==> ESFAQ

7 ==> MCHEL

8 ==> |M|^2 = 1

CARD NUM type Description Defaults

------------------------------------------------------------

PTMI 1 R PTMIN in Herwig and in NJETS D='100.' for njets

 NJETS Minimal value of the transverse momenta of each partons (GeV).

 Allowed values are PTMI > 0.

CARD NUM type Description Defaults

------------------------------------------------------------

PTMA 1 R PTMAX in Herwig

CARD NUM type Description Defaults

------------------------------------------------------------

BACK 2 R Add min bias (READ OPERATION ONLY to avoid double-counting

in SLUG )

1 R Poisson mean of the number of min bias events to add D=0.

2 R =0 Only non-decayed particles in min-bias are

added to HEPEVT D=0.

=1 Events added directly from the GENCL generator

=2 events red with all particles kept.

------------------------------------------------------------

Example: BACK 20 0

a random number of events generated using a Poisson distribution

with average 20 is added to HEPEVT and LUJETS. Only the stable

particles in these events red from the secondary stream are kept.

BACK 4 1

a random number of events generated using a Poisson distribution

with average 4 is added to HEPEVT and LUJETS. These events are

generated using GENCL.

CARD NUM type Description Defaults

------------------------------------------------------------

STRE 1 I =0 all particles are kept in the primary event D=0.

diff 0 only non-decayed particles are kept in main event

### The cards relative to the PYTHIA and JETSET generators

CARD NUM type Description Defaults

------------------------------------------------------------

LUEN 8 R the parameters after KINE=3 in slug for test beam kinematics.

See Appendix A

CARD NUM type Description Defaults

[MISSING_PAGE_EMPTY:13]

### Cards relative to ISAJET and to the ISASUSY call.

The ISAJET generator has a very sophisticated user interface that is used by appending it to the input datacard file to the end of the input datacard for ATGEN after the END command.

The ISASUSY package is now fully contained inside ISAJET and is called if one of the MSSM1, MSSM2, MSSM3 cards is included in the ISAJET input. The coupling and mass parameters that can be given to this routine are however quite limited and the following cards describe a complementary implementation that is included and that has more freedom in changing the parameters. After the ISAJET initialization is performed, a modified version of SSMSSM is call to compute the supersymmetric parameters.

CARDNUMtypeDescriptionDefaults ------------------------------------------------------ SSSM18RThe SSSMcommoninSSMSSMroutine.

See Appendix B

CARDNUMtypeDescriptionDefaults ------------------------------------------------------ SSPA33RThe SSPAcommoninSSMSSM (including the input parameters).

See Appendix B

### Cards to drive the Herwig generator

This is realy very preliminary and incomplete. It needs further improvement.

CARDNUMtypeDescriptionDefaults ------------------------------------------------------ (see atgen general cards).

### Cards to drive the NJETS generator

The library PDFLIB [27] which is a compilation by H. Plothow-Besch Is used by NJETS to incorporate further Parton Density Functions.

(see also atgen general cards).

CARDNUMtypeDescriptionDefaults ------------------------------------------------------ |NJET1INumberofJetsintheFinalState.D=2

CARDNUMtypeDescriptionDefaults ------------------------------------------------------ STRU1IStructurefunctionsavalable:5ofthemaredirectlyD=1 incorporatedinNJETSandtheothercallthelibrary PDFLIB:Function incorporated

 1 ==> Duke Owens set 1 (1984)  2 ==> Duke Owens set 2 (1984)  3 ==> Eichten, Hinchliffe, Lane and Quigg set 1 (1984)  4 ==> Martin, Roberts and Sterling E (1988)  5 ==> Martin, Roberts and Sterling B (1988)

----------------------------------------------------------------------------

Function defined with PDFLIB

 6 ==> Martin, Roberts and Sterling S0' (1993)  7 ==> Kwiecinski, Martin, Roberts and Setrling B- (1990)  8 ==> Martin, Roberts and Sterling B0-135 (1991)  9 ==> CTEQ Collaboration 2'L (1994)

Any of the distributions in the PDFLIB compilation can be

 selected using STRU= 1000 * NGROUP +ISET.

 The structure function selected with STRU is used to compute

 the cross section SIGMA(n jets) and the contribution of each

 subprocesses to the final result given in the column CONT.

CARD NUM type Description Defaults ----------------------------------------------------------------------------

QCDS 1 I QCD scale Q used to compute the strong constant coupling. a D=5

 This parameter is particularly important in the case of the

 production of multijet events because more powers of

 alpha_strong are involved in the calculation.

 1 ==> PT average

 2 ==> Total invariant mass

 3 ==> Average invariant mass of 2 outgoing particles

 4 ==> Mass of quarks

 5 ==> PTmax in the event

CARD NUM type Description Defaults ----------------------------------------------------------------------------

 WMAX 1 R To produce unweighted events: D=0.

 0 ==> Weighted events  >0 ==> Weight used to produce an unweighted

 sample (must be the maximum weight WTMAX).

 To find WTMAX, it is necessary to run a first time NJETS.

 At the end of the job, WTMAX can be found in the output

 file (see appendix). By running a second time NJETS with

 WMAX=WTMAX, unweighted events are this time produced.

CARD NUM type Description Defaults ----------------------------------------------------------------------------

 ETAM 1 R Maximum parton pseudorapidity to accept. D=8.

 Allowed values are ETAM > 0.

### Card to give parameters to the user routines

CARD NUM type Description Defaults ------------------------------------------------------------------------------------------------------ ETMA 1 R Cut on the sum of partons transverse momenta. D=NJET*PTMI

CARD NUM type Description Defaults ------------------------------------------------------ COST 1 R Cosine of minimum opening angle allowed between D=0.99 partons. This parameter requires that the outgoing partons are well separated in the phase space and assure the validity of perturbative QCD avoiding collinear divergencies. Allowed values are 0.995 < COST < 1.0

CARD NUM type Description Defaults ------------------------------------------------------ COMP 1 I Compare different structure functions sets: D=0 0 ==> No 1 ==> Yes If a comparison between several functions is made, the functions incorporated in NJETS are automatically selected and only one defined with PDFLIB (by default CTEQ 2'L) is selected.

### Card to give parameters to the user routines

This is a card to allow the user to pass parameters to its analysis routines.

CARD NUM type Description Defaults ------------------------------------------------------ UCAR 100 R User parameters for UINIT, UNAL UVAL UDETE routines D=0.

[MISSING_PAGE_FAIL:17]

## Chapter 7: The ATGEN Analysis and Associated data-cards

The analysis routines are called both for the generation task and for the read back task is a completely similar way. All the HBOOK activity in ATGEN, including the user histograms and ntuples, goes onto the file at.hbook which is already open and closed by ATGEN.

For very specific problems the user analysis can be performed in the user routines according to Chap.6. In the UANAL routine that is called for each event all kinds of jet finding algorithms should be included and user ntuples should be filled.

For analysis of a more general nature the user does not have to write these routines but instead he can use the ATGEN intrinsic analysis routines. This analysis creates an ntuple number (1) that contains variables relative to the chosen particles in the event record and variables relative to pairs of particles.

These variables are named **E0** to **E9**, **PHI0** to **PHI9**, **PHI0** to **ETA9**,... for each selected particle and **FM0T1** to **FM8T9** for the invariant mass and distance in \(\eta,\phi\) of particles (0+1) to (8+9), etc. The particles number 0 up to 9 are chosen in the event record by a series of conditions defined using the cards PART, IDPA, IDMO, IDST defined bellow as 10x50 matrices in which line 1 correspond to variables **E1**, **PHI1**,... and line 50 to variables **E50**, **PHI50**, etc. This variable names for particle I can be customized by assigning a label to each particle trough the PARL(I) variable.

The included jet analysis routines are driven by the card JETA:

CARD  HUM type Description Defaults ------------------------------------------------------------ JETA 5 I to apply a particle level jet algorithm. D=0  1 I =0 do not apply a jet algorithm  =1 LUCELL ( in pythia )  =2 UA2CELL ( sorry for the name!) takes for jet coordinates  the ones of theseed cell.  =3 ATCELL similar to LUCELL but the energies of cells  belonging to more than 1 jet are distributed in  proportion with the jet energies.  It computes the missing momenta 'prmiss' and 'pymiss'  available in uanal. The 'ptmis' and 'phimis' entries  are included in the ntuple.  2 I =1 Keep cell data appended to LUJETS before jet data  (in ATCELL case )  3 I not used  4 I =NCELL used mainly for output to UANAL.  5 I =NJET used mainly for output to UANAL.

Comment: in future several ALGORN will be added to this list. If the user wants to call a different jet reconstruction routine he may do it in the beginning of UANAL. The cell data consists of P(NC,1) eta, P(NC,2) phi and P(NC,5)=Pt in the cell. The cell index is stored in K(NC,3) as  IETA=MAX(1,MIN(MSTU(51),1+INT(MSTU(51)*0.5*(ETA/PARU(51)+1.))))  IPHI=MAX(1,MIN(MSTU(52),1+INT(MSTU(52)*0.5*(PHI/PARU(1)+1.))))  K(NC,3)=MSTU(52)*IETA+IPHI When oneslects the options to append the jets to the event record this is only performed after the event has been saved on ZEBRA.0 and therefore does not go on tape.

For pratical reasons a short description of the PYTHIA parameters to tune the jet analysis routines is here included ( see Chapter 5).

CARDNUMtypeDescription Defaults ------------------------------------------------------ PARU 200 R From PYTHIA  51 R Calorimeterpseudorapiditylimit (-PARU(51) to PARU(51))  52 R minimum Et forseed cells  53 R minimum Et for jets  54 R R of cone ...  58 R cells with Et bellow are disregarded

CARDNUMtypeDescription Defaults ------------------------------------------------------ MSTU 200 I From PYTHIA  41 I whose particles are included/=2 drop newtrinos and unknown ...  43 I store jets in lujets/=2 store at end of listing ...  51 I Number of pseudo-rapidity bins  52 I Number of azimuthal bins ...  54 I Reconstructed jet/=2 four-vector of the Et weighted center

The following cards input a 10x50 matrix trough FFREAD. As this package considers them as one-dimensional vectors the input is done with "vector 1= to 10=" corresponding to the fist line, "vector 11= to 20=" corresponding to the second line and so on.

The PART, IDPA, IDMO, IDST cards implement an algorithm to find the particles to be analyzed in the event record.

CARDNUMtypeDescription Defaults ------------------------------------------------------ PART 10x50 R Analysis card to find and write on ntuple the particle data.  ( the second index refers to dealing with successive particles  that one wants to analyze. The PART datacard is relative  to the first particle from 1 to 50, second particle from  11 to 20 etc.)  1 R =0 No more particles to analyze  >0 Analyze, treat the particle codes differing +,-(see IDPA)  (For jet analysis with IDST=2 this is the central mass value)  <0 Analyze, treat particle codes for +- as the same(see IDPA)  2 R diff 0 Call UDETE(I,IRET) after finding this particle  3 R detector smearing type to apply to particle  4 R >0 and (3 >0) E-> E(resolution with a sampling (on PART 3) and  a constant term in PART 4.  5 R include in the ntuple quantities that correlate this particle  with one to which a previous card refers to. = number of that particle in PART.
6 R "
7 R "
8 R "
9 R "
10 R particle line in LUJETS.

<0 the particle is always taken as the one appearing in the line

whose absolute value is given here.

else the particle finding mechanism is activated.

CARD NUM type Description Defaults ------------------------------------------------------------

PARL 50 M The first two letters are the Particle label for ntuple entries

( if " " the particle order in PART will be used.

CARD NUM type Description Defaults ------------------------------------------------------------

IDPA 10x50 I Particle code in LUJETS to be searched

IDM0 10x50 I Particle order in PART of the already found particle that is

its mother. ( In the case of 'Finding the Mother of jets''

the jets are related to the partons in IDMO troughs somei

conditions that depend on IDST. See bellow. )

IDST 10x50 I Particle Status of the particle to be found.

(In the case of JETS:

If IDST=0 the jets are the non-picked JETS closest

to the mother IDMO particle in R(phi, eta).

If IDST=1 the JETS in the opposite hemicirclet to the mother

in the x-y plane are set to have this mother particle.

If IDST=2 the jets are the non-picked pair of JETS with

invariant mass closest to the value of PICK(1,I).

The following is forced to store the other JET in the pair.

If IDST=-1 the JETS in the same hemicircle of the mother

in the x-y plane are all set to have this mother particle.)

The search mechanism consists in finding a particle such that its particle code is

IDPA with the mother found previously in line IDMO of PART and with IDST status.

All values that are zero do not enter the condition. An OR is done along the

10 columns of these cards.

I realize that an example is HIGHLY recommended. Lets consider that one want

to find a W+- in an event. This card would do it:

PART -1 0 10=0

PARL 'Wp'

IDPA 24

IDM0 0

IDST 0

then lets try to find the quarks in which the W decayed. The following

would do it:

PART 11=-1 0 20=0PART 2='q1'

IDPA 11=1 12=2 13=3 14=4 15=5

IDM0 11=1 12=1 13=1 14=1 15=1

IDST 11=0

PART 21=-1 26=2 30=0

PARL 3='q2'

IDPA 21=1 22=2 23=3 24=4 25=5

IDM0 21=1 22=1 23=1 24=1 25=1

IDST 21=0

where 1,2,3,4,5 are the ID codes of the quarks in LUJETS. The mother of the quarks is always the W that was found in line 1 of PART. Setting PART 26=2

includes in the ntuple the quantities relative to the pair of quarks (3+2)

like the invariant mass and so on.

It is also possible to find JETS since with the option MSTU(43)=2 the jets are appended to the LUJETS common. Their particle code is 98 so one can fetch them. The way to identify a jet is normally a hard procedure that involves jet tagging and the definition of angular regions relative to other partons ( see the IDST cards).

## Chapter 8: Interfacing with SLUG

The output file generated by ATGEN can be red back by the DICE program by renaming it to ZEBRA.P and including in the DICE data-card the following lines:

C organizeetheoutput (output 1 = zebra output on) OUTP 1 C
*BKIO '0' 'KINE'
*BKIO '0' 'HITS'
*BKIO 'P' 'EWT'
*BKIO 'P' 'RUNT'
*BKIO '0' 'EWT'
*BKIO '0' 'RUNT' C C KINE -1

(note: the documentation on SLUG both on WWW and on the CERNVM is not updated since it mentions the GENP bank that has been replaced, in GENZ, by the RUNT and EVNT banks.)

I have included a pick.kumac utility that builds a series of *PICK cards for SLUG to simulate only the events which survive the cut $1 applied to the at.hbook ntuples1.

Footnote 1: It is assumed that the ntuple number 1 exits with first entry giving the event number. This is automatic if the PART analysis is used and must otherwise be included in the user routines.

Using Dice to simulate the detector response for the complete events may be a time and memory consuming task if the events contain a large number of particles. If one uses carefully the track filter option of SLUG (*TFLT 'ETAP' ETA'MIN ETA'MAX) one may save a lot of time and memory in this process.

The event generation can also be done inside SLUG in the GENSLUG package. ( see the SLUG manual Appendix on GENSLUG).

## Chapter 9: The ATGEN program structure

The flow diagram of ATGEN and the used data blocks (COMMON blocks) are presented. They were obtained using the FLOPPY[12] and FLOW[13] programs of CERN library.

### Flow Diagram

``` MeaningofSymbols: ------------------------------------------------------. ==>terminalnodeinthetree *==>externalprocedure >=>subtreenodeexpandedbelow +=>multiplycalledterminalnode ]=>procedureallingonlyexternals ------------------------------------------------------?==>moduleisinIFclause (==>moduleisinDOloop ********************************************************************* EXTERNALprocedurenameswillnotappear ================================= Nodename=>ATGMAIN ================================= ATGMAIN :MainProgram |------LOADEM+ :Forcelinkerloading |------FFUSER :FFREADroutines |------ATGFFU :Generatorpart |------PYTFFU :PYTHIApart |?---PYFORC :*FORC | |(?---CHLAV]: |?---PYSTAB]:*STAB |?----PYDMOD |:*DMOD |?---ATPYIII| :*PYIN |------ATGINIT]:ATGENINIT?---ATGFKEY :Loadatgenkeys |------ATPYKEY]:Loadpythiakeys |------ATISKEY]:LoadIsajetKeys |------ATHEKEY+ :LoadHerwigkeys?---ATGGINI :Generatorinit |?---ATPYIII| :PYTHIAinit |?---ATISAI]:ISAJETinit |?---SUSYLOA :ISASUSYinit |-------ISASUSY]: |?---SUSYDEB :ISASUSYdebug | |(---SSPRT | |(---SSID | :??---ATHERI ]

### Flow Diagram

 |------AT@NZI :GENZ init | (???-ATHPCP : | (??--ATHPFIX ] | (-----ATHPSTA + :Keep non-dekeyed | ((?--PYTVER ] :PYTHIA version | ((??-PYTVER ] : | ((??-ISAVER + :ISAJET version | ((??-HERVER + :HERWIG version (?---ATINII :ATGEN ntuple init | (---ATNTAG ] :Ntuple entry name | ((?--ATNTAG2 ] :Ntuple entry xxxtyyy | ((----OINIT + :User init (---ATGGEVT :Event generation |?---ATJESEV ] :Jetset event |?---ATISAEV ] :Isajet event |?---ATHEREV :Herwig event | |----ATHERCP + :copy HEPEVT real*8->4 (??--UVAL + :User event validation |(---ATGWRIT ] :GEINZ write event | (---ATJETAN :Jet analysis routines | |?----UA2CELL ] : (?---ATOUT :ATGEN NTUPLE event | (?---ATGFIND :PART finding | | |(((+ATJETOR ] :Jet finding | | (---ATDETE :Detectors smearing | |?---UDETE ] :User detectors smear | ((?--UANAL + :User Analysis (?---ATEVDEB ] :Atgen evennt debug | ---ATGREAD :GENZ event read | |((??-ATHPCP > :HEPEVT convert |?---ATHEND ] :ATGEN ntuple end | ---ATGGEND ] :ATGEN generator end

 ================================

Nodename ==> ```

```

[MISSING_PAGE_FAIL:25]

### 9.2 Data Structures (COMMON Blocks)

Figure 9.1: The Flow diagram of ATGEN

## Appendix A: Description of the LUEN card for test-beam kinematics

The cards and routines to generate particles in a test-beam like kinematics were pick with slight modifications from the implementation of R. DeWolf in SLUG. The LUEN card, in particular, follows exactly the KINE 3 arguments in SLUG with the 0 for the first parameter removed.

C KINE-> LUEN C "Test-beam" 1-jet or 2-jet events can also be generated in here. C C The second parameter of the KINE card encodes for the PDG codes C of the jet initiators. Single jets are produced if parameter 2 C has an absolute value less than 10 000. Otherwise, the 5th and 6th C decimal digits are used to encode the second jet's initiator. (The C routine is not guaranteed to work if the floating-point precision is C less than 6 digits.) The first particle carries the sign. In the 2-jet C case, the jets are produced back-to-back, with jet 1 taking direction C and momentum given by the rest of the cards. Note that defaults are C the same as above s o that giving no parameters except parameter 1 will C just give an electron, which does not fragment! C C C LUEN 1 R Encodes particle codes for jet initiators: D=11. (electrons) C if we call this parameter N then: C ID1 = SIGN(N)*MOD(ABS(N),10000) C ID2 = (ABS(INT(N) ) / 10000 C (If ID2 is zero, then a 1-jet event is generated) C 2 R minimum momentum (GeV/c) of jet 40. C 3 R maximum momentum (GeV/c) of jet 40. C 4 R minimum pseudorapidity of jet -1. C 5 R maximum pseudorapidity of jet 1. C 6 R minimum phi (in radians) of jet 0. C 7 R maximum phi (in radians) of jet 2*pi

## Appendix B The common block contents associated with the cards SSSM and SSPA

The SSSM common block fed by the card SSSM has the following contents: (a real vector(18) is mapped to the SSSM common block)

C Standard model parameters C AMUP,...,AMTP = quark masses C AME,AMMU,AMTAU = lepton masses C AMW,AMZ = W,Z masses C GAMW,GAMZ = W,Z widths C ALFAEM,SN2THW,ALFA3 = SM couplings C ALQCD4 = 4 flavor lambda C COMMON/SSSM/AMUP,AMDN,AMST,AMCH,AMBT,AMTP,AME,AMMU,AMTAU C $,AMW,AMZ,GAMW,GAMZ,ALFAEM,SN2THW,ALFA2,ALFA3,ALQCD4 Default Values AMUP=0.0099 AMDN=0.0056 AAT=0.199 AACH=1.35 AMBT=5.0 AME=0.511E-3 AMMU=0.105 AMTAU=1.784 AMW=80.0 AMTRSS=XMTR AMBLSS=XMTL AMBRSS=XMBR AMHA=XNHA AAT=XAT AAB=XAB AMGLSS=XMG TWOM1=-XMU RV2V1=XR21 AMTLSS=XMTL AMZ=91.17 GAMW=2.12 GAMZ=2.487 ALFAEM=1./128. SN2THW=0.23 ALQCD4=0.177 ALFA3=0.12 IF (ALF2.EQ.0) ALF2=ALFAEM/SN2THW

and for SSPA:

C SUSY parameters C AMGLSS = gluinomass C AMQKSS = squark mass C AMLLSS = left-slepton mass C AMLRSS = right-slepton mass C AMLLSS = sneutrino mass C TWOM1 = Higgsino mass = - mu C RV2V1 = ratio v2/v1 of vev's C AMTLSS,AMTRSS = left,right stop masses C AMT1SS,AMTZSS = light,heavy stop masses C AMBLSS,AMBRSS = left,right sbottom masses C AMB1SS,AMB2SS = light,heavy sbottom masses C AMZiSS = signed mass of Zi C ZMIXSS = Zi mixing matrix C AMWiSS = signed Wi mass C GAMMAL,GAMMAR = Wi left,right mixing angles C AHL,AMHH,AMHA = neutral Higgs h0, H0, A0 masses C AHC = charged Higgs H+ mass C ALFAH = Higgs mixing angle C AAT = stop trilinear term C THETAT = stop mixing angle C AAB = sbottom trilinear term C THETAB = sbottom mixing angle  COMMON/SSPAR/AMGLSS,AMQKSS,AMLLSS,AMLRSS,AMILSS $,TWOM1,RV2V1,AMTLSS,AMTRSS,AMT1SS,AMT2SS,AMBLS,AMBRSS

[MISSING_PAGE_EMPTY:29]

## Bibliography

* [1] R. DeWolf, GENZ User Manual (available from WWW of from the Atlas Software Group.)
* [2]_ZEBRA User's Guide (3.53)_, R. Brun, M. Goossens, J. Zoll, CERN PROGRAM LIBRARY Q100, 1987
* [3] T. Sjostrand et al.,in _Z Physics at LEP 1_, ed. G. Altarelli, R. Kleiss and C. Verzegnassi, CERN Yellow Report 89-08, v.3, p.327.
* [4] F. Bruyant, _Skeleton Logic for Analysis Chains_
* [5] T.G. Trippe and G.R. Lynch,_Particle I.D. Numbers, Decay Tables, and Other Possible Contributions of the Particle Data Group to Monte Carlo Standards_, LBL-24287, in Proceedings of the Workshop on Detector Simulation for the SSC (August 1987).
* for details **telnet info.cern.ch**
* [7] GEANT CERN Program Library
* [8] FFREAD CERN Program Library
* [9] CMZ User's Guide & Reference Manual, available from the CERN Program Library office, CN division
* [10] HBOOK User's Guide & Reference Manual, CERN Program Library Long Writeup,
* [11] PAW User's Guide & Reference Manual, CERN Program Library Long Writeup Q121,
* [12] Julian J. Bunn, FLOPPY User's Guide & Reference Manual, CERN Program Library
* [13] H. Grote, FLOW User's Guide & Reference Manual, CERN Program Library, Long Write-Up Q902(1988)
* [14] CERN library short writeups, CERN Program Library
* ATLAS software group
* ATLAS software group
* ATLAS software group
* ATLAS software group
* ATLAS software group
* [20] Torbjorn Sjostrand, CERN-TH.7112/93. Related work is on: T. Sjostrand, Computer Physics Commun. **39** (1986) 347; T. Sjostrand and M. Bengtsson, Computer Physics Commun. **43** (1987) 367; See the files upgrade.notes in the ATGEN distribution.
* [21] All the ones in the previous plus H.-U Bengtsson and T. Sjostrand, Computer Physics Commun. **46** (1987) 43;
* [22] Frank E. Paige and Serban D. Protopopescu, ISAJET Manual, Brookaven National Laboratory, USA (a copy is in the isajet CMZ file)
* [23] Howard Baer, Frank E. Paige, Serban D. Protopopescu and Xerxes Tata, ISASUSY Manual, (a copy is in the isajet CMZ file)* [24] G. Marchesini, B. R. Webber, G. Abbiendi, I. G. Knowles, M. H. Seymour and L. Stanco, HERWIG Manual, (a copy is in the herwig CMZ file) The main reference is G. Marchesini, B. R. Webber, G. Abbiendi, I. G. Knowles, M. H. Seymour and L. Stanco, Computer Physics Communications 67 (1992) 465.
* [25] The UA5 High Energy \(\bar{p}p\) Simulation Program, UA5 Collaboration, Nuc. Phys. B291 (1987) 445-502
* [26] Jets at LHC, F. A. Brends and H. Kuijf, Nucl. Phys. B353 (1991) 59. Muliti-Jets Event Generator for LHC, H. Kuijf et. al., Proceedings of the Large Hadron Collider Workshop, CERN 90-10 and ECFA 90-133.
* [27] H. Plothow-Besch, CERN-PPE/92-123 (1992) 'PDFLIB: a library of all available parton density functions of the nucleon, the pion and the photon and the corresponding alpha(s) calculations', H. Plothow-Besch, Comp. Phys. Comm. 75 (1993) 396-416.