ATLAS DAQ note 53

15 June 1996

Rudolf Bock and Patrick LeDu

Detector and readout specifications

for the level-2 trigger demonstrator program

(supplement to the ATLAS level 2 User Requirement Document)

## Introduction

We describe in this note the major ATLAS detectors, including readout specifications up to the interface between readout buffers and feature extraction ('local') processors. They are described to the best knowledge in detector and frontend electronics groups at time of writing. This description is to be used in the ATLAS level-2 demonstrator program

- for deriving simulated data at the readout buffer level, in order to have generally agreed training samples, both for the relevant physics channels and background;

- as a basis for developing level-2 trigger algorithms including preprocessing and RoI collection, and hence requirements for their implementations;

- for detailed modeling of full-scale level-2 trigger architectures.

Presently, we have to restrict the detector model to the detector parts defined best: Silicon, transition radiation tracker, electromagnetic and hadronic calorimeters (barrel and endcap) including preshower counters, and muon chambers (barrel only). Forward calorimeters, endcap muon chambers, and pixel detectors are left out. Some of the descriptions are still incomplete. Detectors follow the description as given in the Technical Proposal (CERN/LHCC/94-43, 15 Dec 94), modified by later discussions at ATLAS level and in the detector groups; for the inner detector this is referred to as the modified Morges layout.

The readout parameters have been arrived at in multiple discussions between detector groups and the Trigger/DAQ community, and contain multiple assumptions. Future updates of detectors and readout are unavoidable; it is our belief, though, that the present description is sufficiently complete and representative to provide a long-term stable basis for optimizing level-2 trigger algorithms and for deciding between basic implementation options. In case of doubt, we strictly adhere to official contact persons for our readout definitions. Geometry and frontend information is given only as background for easier understanding; in case of contradiction, 'official' ATLAS data are to be believed, although little written documentation is available today. We hope that official documents and a readable geometry data base will become available, and obviate some of this document. Cross-checks with data entering the simulation program DICE95 have also been made.

The description refers to standard optimized high-luminosity readout. It must be understood that for some detectors, there may be more complete descriptions and expanded formats, to be used in situations of calibration or error hunting, at low luminosity, or for describing exceptional events. Those formats are likely to cause dead times beyond what is specified in various user requirement documents for the standard case.

We specify the readout segmentation in a form as schematic as possible, and define regions of interest, for each of the detectors, in agreement with the level-2 User Requirements Document (presently in draft form). The specifications cover data formats and their transformations; the most important information is the data modularity and formats into and out from the readout buffer (ROB). Algorithm definitions for data preprocessing, region-of-interest collection, local feature extraction and global decision as a basis for studying physics selectivity and for benchmarking different implementations, will have to be supplied in a separate note. Timing of data availability (latencies in the transmission chain) in buffers is not covered.

Detector data are presented in a schematic form corresponding to the readout diagram below:

Our description of data includes the data content and the grouping of information between frontend boards, readout drivers (ROD-s), readout buffers (ROB-s) and the data going to the level-2 local processors (feature extractors). Numbering conventions as introduced by the ATRIG and modelling working groups are also given.

Our snapshot descriptions correspond to the ATLAS detector at the time of writing, and we acknowledge the contributions by E.Auge, J.Baines, J.Colas, S.Falciano, Ph.Farthouat, D.Froidevaux, T.Hansl-Kozanecka, R.Hawkings, L.Nisati, J.Pater, A.Poppleton, and T.Weidberg; A.Dell'Acqua has given help to get input from DICE95; obviously, they all are not directly responsible for this note.

_I. Detector geometry and transmission parameters_

**Note on channel numbering**

We use the hierarchical addressing conventions of the ATRIG group (T.Hansl-Kozanecka, draft note on 'Data files for modelling and benchmarking studies of trigger level 2', Saclay 28 Dec 95): each detector is assumed symmetric about z=0 (where this is broken, a local patch-up will be needed); addresses start from zero; numbering of detector partitions is detector-dependent; numbering along z (eta) starts at z=0 outwards; numbering along phi starts at the (horizontal) x-axis, and follows phi (counter-clockwise when looking along +z). More details are given for the individual detectors below.

_1. Silicon Tracker (SCT)_

**1.1 Geometry** (base-line design, from INDET-TR-206, J.Pater, 6 March 96)

**a) barrel**: the barrel SCT ('tuned Morges layout') is arranged on 4 cylindrical surfaces at radii from 30.0 to 52.0 cm, and covering \(\pm\)74.5cm in z. Each surface carries two layers of wafers with strips along z in one and slightly tilted strips in the other ('stereo') layer. Pairs of wafers are bonded together, to give a double wafer of physical dimension 6.4 x 12.8 cm in ar\(\phi\) x az. The sensitive area is 6.16 x 12.52 cm (1.0 mm border all around); the 768 strips of pitch 0.080 mm are also interrupted in the middle by an insensitive zone (bonding) of 0.22 cm. Coverage in z is the same for all surfaces. Each wafer is doubled up by a its stereo wafer (\(\pm\)40 mrad). The total number of double wafers (including stereo) is 4224, with the highest number in the outermost layer.

In more detail, the information is given in the following table:

\begin{tabular}{l c c c c} Layer\# & Radius (avge) & \# in r\(\phi\) & \# in z & \# of wafers \\  & (cm) & & & \\
1a & 30.0 & 32 & 12 & 384 \\
2a & 37.3 & 40 & 12 & 480 \\
3a & 44.3 & 48 & 12 & 567 \\
4a & 52.0 & 56 & 12 & 672 \\  & & & & \\  & & & & \\  & & & & \\ (*2 for stereo wafers:) & & & 4224 \\ \end{tabular}

In order to cover the cylindrical surface without gaps, wafers overlap both in \(\phi\) and z. In \(\phi\), wafers are slightly tilted around the z-axis, so they are at larger r at \(\phi_{\rm max}\) than at \(\phi_{\rm min}\); the tilt angle is up to 10\({}^{\rm o}\), and the overlap (of the sensitive region) is between 1.4 and 1.8 mm, for infinite-momentum tracks, following from the circumference at constant r and the sum of active wafer dimensions along \(\phi\). The overlap in z direction is obtained by staggering alternate layers in r (no tilt, but layers are at nominal r \(\pm\) 0.5mm); the overlap (sensitive region) for tracks from z=0 is \(\sim\) 0.1cm, and follows from the difference between total wafer length (12 x 12.52 = 150.24 cm) and total detector length minus borders (149.0 - 0.25 cm).

NOTE: The above information leaves out some details, some available from detailed tables in the simulation program, some undefined as yet. Clearly, normal and stereo layers are not at the same radius (in fact, plane wafers are not at a constant radius to start with), and do not cover exactly the same \(\Delta\phi\) and \(\Delta\)z. Stereo layers will be realized on separate, slightly tilted layers, and will then be \(\phi\)- and z-overlapped differently, resulting in a larger \(\Delta\)r between the two layers; there is also an option to have stereo wafers realized as second sensitive layer on double-sided wafers, in which case partial length strips will have to be defined, and strip counting (or pitch) need adjusting. We ignore the problem in this note, and assume constant r and \(\Delta\phi\)/\(\Delta\)z, but with overlaps; the details will be defined by the detector group in due course, and are unlikely to influence critically the readout or level-2 algorithms.

**b) endcap:** the endcap SCT on each side is arranged in 9 planar disks, covering the z-region from 83 to 277 cm, with inner radii varying from 26.0 to 43.8 cm, and all outer radii at 56.0 cm. Each plane is made of wafers with strips of constant \(\phi\) in one and slightly tilted strips (\(\pm\)40 mrad) in the other ('stereo') layer. Pairs of wafers are bonded together along r (except in plane 8), to give trapezoidal double wafers of maximal physical dimension 5.6 x 7.3 cm (GaAs) to 7.6 x 12.4 cm (Si), in r\(\Delta\phi\) x \(\Delta\)r; sensitive area, number of strips (768), and bonding zone are as for the barrel wafers. Leaving aside the stereo wafers, the description is as follows:

\begin{tabular}{l c c c c c c} Plane\# & z-coord. & Inner r & Outer r & \# in r\(\phi\) & Technology & Pitch \\  & & & (middle of detector) & & & & (middle) \\  & [cm] & [cm] & [cm] & (for 2\(\pi\)) & & & [microns] \\
1a & 82.5 & 26.0 & 33.2 & 40 & GaAs & 62.4 \\

[MISSING_PAGE_POST]

 & 253.8 & 40.1 & 45.3 & 40 & (Si, small wafers) & 89.7 \\
8c & 251.8 & 43.9 & 56.0 & 52 & Si & 81.0 \\
9c & 276.8 & 43.9 & 56.0 & 52 & Si & 81.0 \\  & & & & & & \\  & & & & & & \\  & & & & & & \\  & & & & & & \\  & & & & & & \\ \end{tabular}

Multiplied by 2 for both detector halves, this gives a grand total of 3952 endcap wafers.

**1.2 Transmission to ROD (barrel and endcap):** each double wafer (768 channels) is read via six 128-channel chips; and is linked by two low-bandwidth links to the ROD. Only a single bunch crossing is read out. At high luminosity, 1% of the channels are estimated active for a given bunch crossing (including information from adjacent bunch crossings, 0.1%, and noisy channels, 0.01%). The occupancy in jets will be higher, assumed is 2%.

The large scattering factor of the information onto 4224 links for the barrel, 1976 for each endcap, is eased by grouping them inside the readout driver, see below.

**1.3 Format into ROD (barrel and endcap):** all strips above threshold are transmitted by address; the SCT information format is the following ('binary readout option'):

 header (synchronization, event ID) 32 bits

 ROD ID and status 16 bits

 strip address (6 bits wafer, 10 bits strip)

...... (repeated)

 trailer (synchronization) 16 bits

**1.4 Transmission to ROB (barrel and endcap):** The ROD concentrates 32 input links (16 pairs of normal/stereo wafers), hence some 25 kchannels, onto a high-bandwidth link transmitting to the readout buffers; on average, there are 4kbit/event or 50Mbytes/s to transmit, but local maxima are higher (jets!). The concentration is controlled by a table, and is optimized to result in a minimal (average) number of buffers to contribute to an RoI (an example for the barrel has been documented by V.Charlton, in ATLAS DAQ note 52, the same method has been used for the endcap). A single ROB will receive information from double wafers (and their stereo equivalent) from each of layers 1 to 4. As the wafers do not tile perfectly into such a readout, some ROB-s will have only very partial information to contribute to an RoI.

**1.5 Format into ROB:** The FE-to-ROD format is suited also for the output of the readout driver, in that the address space is for the entire ROD. Header and trailer are, of course, transmitted only once by the ROB.

**1.6 Preprocessing in ROB, format into level-2:** Clustering: hits on adjacent strips are merged into a single hit. Stereo points: hits in stereo layers are used to obtain two coordinates specific to the wafer (this point has not been studied for the possible effect of loosing efficiency). Global coordinates: the ROD-specific coordinates are amended by a ROD address, or converted into overall eta-phi-coordinates.

**1.7 Numbering the channels:** in hierarchical order: detector partitions are barrel (0), +ve-z endcap (1), -ve-z endcap (2). A superlayer is a cylinder of wafers at constant r in the barrel, a plane in the endcap: they are numbered 0...3 (barrel) and 0...8 (endcap, increasing \(|z|\)). Inside the superlayer, single-wafer rings in z (r) are numbered in order of increasing \(|z|\) (r) in the barrel (endcap), going from 0 to 11 (0 to 2). Inside each ring, layer numbers are 0 (normal) or 1 (u or v). In each layer, wafers are numbered along \(\phi\), from zero to a maximum that varies from 31 to 55 (barrel), and is 39 or 51 in the endcap. Inside each wafer, strips are counted from 0 to 767, starting at low \(\phi\).

_2. Silicon Pixels, barrel only_

**TBD**

_3. Transition Radiation Tracker (TRI)_

**3.1 Geometry**

**a) barrel**: the barrel TRT (half) is arranged in two layered cylinders covering respectively the z region from -0.8 m to 0, and from 0 to +0.8 m (\(|\Delta\eta|\leq 0.69\)). Each cylinder contains straws arranged in planar layers of roughly constant r, with a total of 73 layers, at a radial distance of roughly 6.8 mm.

Layer radii vary from 0.590 to 1.070 m. Layers are grouped into three types of modules (see figure). In each layer, straws are at approximately constant distance(about 6.5 to 6.8mm), the \(\Delta\phi\) covered by each module is the same (2\(\pi\)/32 = 0.19635), the number of straws in each module varies from layer to layer (from 15 to 28 straws). The total number of straws is 1642 per 3 modules, or 52544 x 2 for the two halves of the detector.

In more detail, the three layers of zig-zag modules are described in the following table; note that modules are skew, so that r(min) and r(max) can overlap, and some straws are missing, due to the cooling tubes.

\begin{tabular}{l c c c c c c c}  & r min & r max & \(\phi\) min & \(\phi\) min & layers & straws & straws \\  & (mm) & (mm) & (rad) & (rad) & & & & (total) \\
1 & 560 & & -0.0985 & 0.0985 & 19 & 15 & & 329 \\  & & 697 & 0.0000 & 0.1989 & & 18 & & \\
2 & 683 & & 0.0000 & 0.1989 & 24 & 19 & & 520 \\  & & 859 & -0.0985 & 0.0985 & & & 23 & \\
3 & 859 & & -0.0985 & 0.0985 & 30 & 23 & & 793 \\  & & 1070 & 0.0000 & 0.1989 & & & & 28 \\  & & & & & & & & \\  & & & & & & 73 & & 1642 (*32 = 52544) \\ \end{tabular}

**b) endcap**: the endcap TRT (half) is arranged in 18 wheels, each containing 8 or 16 planes equidistant along z. Wheels are mounted non-equidistant along z, from z=89 to z=331cm. The 160 planes in the first 14 wheels contain 768 (= 32 x 6 x 4) straws each, at equal distance in \(\phi\), but with small \(\phi\) offsets from plane to plane. The inner radius is 0.64, the outer 1.03 m. The 64 planes in the last 4 wheels contain 576 (= 32 x 6 x 3) straws each, again equidistant and staggered in \(\phi\), with an inner radius of 0.50 m (outer radius as before). The total number of planes is 224 x 2, the total number of straws is 159 744 x 2 (two halves).

**3.2 Transmission to RODs** (see 'Readout Segmentation', Ph.Farthouat et al, March 1996)**:**

**a) barrel:** The 32 zig-zag groups (mechanical grouping) of three TRT modules each cover the same \(\Delta\phi\), and each of them contains 1642 straws; up to 16 straws are multiplexed by one 'ROC' chip. ROCs are combined into readout groups that give slices of roughly the same \(\Delta\phi\), and do not follow the mechanical segmentation. 104 ROC-s correspond to one group, and alternate groups combine ROCs from two adjacent zig-zag groups. Each ROC is transmitted via a low-bandwidth (40 Mbit/s) link, the total number of links is 64 x 52 (x 2 for both barrel halves). Readout tables describe the positions and the grouping of links, and are needed as part of the algorithm.

**b) endcap:** the readout is arranged so that 32 x 6 = 192 identical slices of 832 straws each (\(\Delta\phi\) = 2\(\pi\)/192) are formed, over the full length of the endcap. In each 768-(576-) straw wheel, the readout groups 4 (3) straws; 52 ROC-s read one \(\phi\) slice, the total number of low-bandwidth links thus is 192 x 52 x 2 links that go to RODs (for two endcaps).

**3.3 Format into ROD (barrel and endcap):** No zero-suppression, 18 bits per straw: 1 bit each for high/low threshold, 1 bit for valid measurement, 3 bits for drift time, all multiplied by three for 3 bunch crossings.

**3.4 Processing in ROD:** Zero-suppression of data (see format below), and adding bunch crossing information to the identifier. Re-grouping of data in barrel so that 64 slices are formed, each on one link and approximately of \(\Delta\phi\) = 0.1.

**3.5 Format into ROB** (see 'Event Size in the TRT End Cap', P.Farthouat et al., Feb 1996): The event header (32) and trailer (16) are together 48 bits; in addition, each straw produces at least two and at most 23 bits of information: for each bunch crossing with a threshold passed, there are 2 bits to identify the crossing, a low and a high threshold bit, and 3 bits for drift time. A maximum of 3 bunch crossings can be present in a hit; every straw also has a 2-bit terminator (00, the only information for a no-hit straw). Average rate per link @ 100KHz = 0.6 Gbit/s (assuming high luminosity conditions: 30% of straws hit, on average two bunch crossings for each hit). The minimal rate per link (832 empty straws) is 0.171 Gbits with this format.

**3.6 Preprocessing:** Bunch crossings: a single bunch crossing and a single high/low threshold bit has to be produced from 1,2, or 3 input crossings; drift time: a best drift time over 3 bunch crossings has to be extracted, i.e. more bits or smaller least count (or drift time to be suppressed, this is algorithm-dependent); zero suppression: a detector-wide general address for hits has to be produced, no-hit straws are to be suppressed.

**3.7 Numbering the channels:** physical straw addresses obey the following hierarchy: detector partitions are 0 (barrel -ve z), 1 (endcap -ve z), 2 (barrel +ve z), 3 (endcap +ve z).

a) barrel: module superlayers are numbered with increasing r (0..2); modules inside superlayers are numbered along \(\phi\) (0..31), individual straw layers inside a single module are numbered with increasing r (0...18 to 0...29), individual straws again with increasing \(\phi\) (0...14 to 0...27).

b) endcap: planes are numbered with increasing \(|\)z\(|\) (0..223); individual straws in each plane are numbered along \(\phi\)4 Calorimeters

### Level 1 Trigger Tower segmentation

We describe here the trigger tower concept ahead of the geometry, because the transverse granularity in all calorimeters, thus the channel count, is driven by the size of the trigger tower (TT):

\begin{tabular}{l l l} for \(|\eta|<2.4\) & \(\Delta\eta=0.1\) & \(\Delta\phi=2\pi/64\) (\(=0.1\)) \\ for \(2.4<|\eta|<3.2\) & 2 * \(\Delta\eta\) & 2 * \(\Delta\phi\) \\ for \(|\eta|>3.2\) & 4 * \(\Delta\eta\) & 4 * \(\Delta\phi\) \\ \end{tabular}

\begin{tabular}{l l l l}  & Size of TT & Number of TT-s \\ EM barrel & & \(\Delta\eta\) x \(\Delta\phi\) & 1792 \\ EM end cap & \(1.4<|\eta|<2.4\) & \(\Delta\eta\) x \(\Delta\phi\) & 1280 \\ EM end cap & \(2.4<|\eta|<3.2\) & 2 \(\Delta\eta\) x \(\Delta\phi\) & 256 \\  & & & (Subtotal 3328) \\ HAC tile barrel + extended \(<\)1.6 & \(\Delta\eta\) x \(\Delta\phi\) & 2048 \\ HAC end cap & \(1.5<|\eta|<2.4\) & \(\Delta\eta\) x \(\Delta\phi\) & 960 \\ HAC end cap & \(2.4<|\eta|<3.2\) & 2 \(\Delta\eta\) x \(\Delta\phi\) & 320 \\  & & & (Subtotal 3328) \\ Forward & & 4 \(\Delta\eta\) x \(\Delta\phi\) & 128 \\ Grand total & & & 6912 \\ \end{tabular}

#### General numbering for calorimeters

We describe here the high-level part of channel numbering, applicable to all calorimeters. Left and right half (-ve and +ve z) are identified by 0 and 1. Detector partitions are numbered 0, 1, 2 for barrel (including extended), outer endcap, inner endcap. Inside a partition, supermodules are numbered along \(\phi\) (0...15). At the next lower level, the readout buffer (ROB) appears as a unit, as for all calorimeters, a fixed number of ROB-s will make up a supermodule. Below that, the levels of trigger towers, layers, and channels will be described detector by detector. For more details, see the reference given at the beginning of part I above.

4.2. Electromagnetic liquid Argon barrel

#### Geometry and segmentation

The barrel EM is built from two halves, each covering roughly the rapidity range \(|\eta|\)\(<\) 1.4. In azimuth, each half barrel is physically made of 16 independent supermodules. The calorimeter has effectively 4 layers in depth: presampler, front layer or preshower (with high granularity), middle layer, back layer.

\begin{tabular}{l l l l l}  & Rapidity & cell & \# channels per & \# of channels \\  & coverage & granularity & supermodule & per TT \\ Presampler & 0 - 1.4 & \(\Delta\eta\) /4, \(\Delta\phi\) & 224 & 4 \\ Preshower & 0 - 1.4 & \(\Delta\eta\) /32, \(\Delta\phi\) & 1792 & 32 \\ Middle layer & 0 - 1.4 & \(\Delta\eta\) /4, \(\Delta\phi\)/4 & 896 & 16 \\ Back layer & 0 - 1.4 & \(\Delta\eta\) /4, \(\Delta\phi\)/2 & 448 & 8 \\ Total & & & 3360 & 60 \\ \end{tabular}

There are 56 TT's per supermodule, the total number of channels in the full EM barrel is 107520.

\begin{tabular}{l l l l}  & Rapidity & cell & \# channels per & \# of channels \\  & coverage & granularity & supermodule & per TT \\ Presampler & 0 - 1.4 & \(\Delta\eta\) /4, \(\Delta\phi\) & 224 & 4 \\ Preshower & 0 - 1.4 & \(\Delta\eta\) /32, \(\Delta\phi\) & 1792 & 32 \\ Middle layer & 0 - 1.4 & \(\Delta\eta\) /4, \(\Delta\phi\)/4 & 896 & 16 \\ Back layer & 0 - 1.4 & \(\Delta\eta\) /4, \(\Delta\phi\)/2 & 448 & 8 \\ Total & & & 3360 & 60 \\ \end{tabular}

#### Transmission to ROD

The elementary partition corresponds to one supermodule, i.e. 3360 channels or 60 trigger towers. It is assumed that for each level-1 'accept', the digitizer produces 12 bits x 3 time samples = 36 bits of frontend unformatted data. There are 120 960 bits to be transferred in average every 10 usecs, corresponding to a bandwidth of 12 Gbit/sec. The read-out depends on the front end electronics packaging and arrangement (layers or towers). The links will be organized in such a way that they match a multiple of 8 trigger towers.

#### Transmission to ROB

The ROD has two main functions:

a) The "raw data" are generated in the ROD by an algorithm, that extracts the transverse energy along with some quality bits, for the level-1-triggered bunch crossing. There is no sparsification (zero skipping, thresholding), the calorimeter sends a fixed block of data. The unit per cell is now a 24 bit word: 16 for the transverse energy and 8 for a filter quality and time code. This refers to high-Et information; in towers with low-energy cells only, a compaction will take place: the energy will be expressed in 8 bits, and no further information (quality, time) will be appended.

b) the ROD has to organize the mapping in each tower to prepare the extraction to the standard transmission to the ROB. A mapping by logical block of 8 trigger towers per ROD (4 along phi x 2 along eta) is the most attractive possibility. The data production at the output of the ROD is 8 towers x 60 channels x 16 bits (assumed average) =7680 bits.

One Gbit/sec link should be sufficient to transmit the data produced by an ROD of 8 towers. A total of 224 links will be necessary to read he entire barrel.

#### 4.2.4 Format into ROB

Standard Header and Trigger ID (32 bits)

ROD ID (8 bits)

Status code (8 bits)

data block (24 or 8 bits per cell, see above) in fixed format:

1 tower # and compaction code (tower 1)

2 cell 1

....

61 cell 60

62 tower #....

....

488 cell 60 (of tower 8)

#### 4.2.5 Numbering/data order

A supermodule contains 7 ROB-s, which are numbered from 0 to 6 with increasing \(|\)z\(|\). A ROB contains 8 TT-s (0...7), which come in four groups of equal \(\phi\), each group ordered with increasing \(|\)eta\(|\). Inside a TT, layers run from 0 to 3, starting at the inner radius: 4 cells (increasing \(|\)eta\(|\)) presampler, 32 cells preshower, etc. Wherever this applies, indices run fast through \(|\)eta\(|\), slower through \(\phi\).

#### 4.2.6 Preprocessing

There is little or no preprocessing needed for fine-grain algorithms in calorimetry (leptons), unless additional calibration is available, or feature extraction algorithms require data reordering or some summing (e.g. longitudinally). For jets, aggregation of information into sums over trigger towers is most likely obligatory, for reasons of bandwidth.

### Electromagnetic liquid Argon endcap

#### 4.3.1 Geometry and segmentation

The two end caps are built from two wheels (outer and inner wheels): the outer wheel for 1.4 \(<\)\(|\)\(\eta\)\(|\)\(<\) 2.4, the inner wheel for 2.4 \(<\)\(|\)\(\eta\)\(|\)\(<\) 3.2. In azimuth, each wheel consists of 8 wedges (supermodules). The calorimeter has 3 layers in depth: front (with high granularity for the outer wheel only), middle and back layers.

[MISSING_PAGE_FAIL:12]

[MISSING_PAGE_FAIL:13]

\begin{tabular}{l l l l} Central S4 & 1.80 - 2.40 & \(\Delta\eta\), \(\Delta\phi\) & 24 & 1 \\ Central total & & & 96 & \\ Inner S1 & 2.40 - 3.20 & \(\Delta\eta\), \(\Delta\phi\) & 32 & 4 \\ Inner S2 & 2.40 - 3.20 & \(\Delta\eta\), \(\Delta\phi\) & 32 & 4 \\ Inner S3 & 2.40 - 3.10 & \(\Delta\eta\), \(\Delta\phi\) & 30 & 2 \\ Inner S4 & 2.40 - 3.10 & \(\Delta\eta\), \(\Delta\phi\) & 30 & 2 \\ Inner total & & & 124 & \\ Grand total & & & 280 & \\ \end{tabular}

The supermodules are the elementary partition of the readout system; each of them maps 40 trigger towers or 280 channels into one ROD or ROB. The total number of channels in the hadronic endcaps is 8960.

#### 4.5.2 Transmission and formats:

Each supermodule is mapped into one ROD/ROB. The format is as for the barrel (see 4.2.4)

#### 4.5.3 Numbering and data order (TBD)

#### 4.6.1 Forward liquid Argon calorimeters

#### 4.6.1 Geometry and segmentation

(TBD)

#### 5.1 Muon chambers, geometry and segmentation

_a) Barrel_

The muon detector consists of MDT (Monitored Drift Tube) and RPC (Resistive Plate Chamber) layers. MDT-s are used for the precise measurement of the muon momentum, RPC-s serve as trigger chambers. They are contained in planes, arranged in cylindrical shells concentric to the beam axis; all modules are sized and arranged so that towers of roughly constant \(\Delta\eta\) x \(\Delta\phi\) are formed naturally over the entire covered region (\(\pm\)1.25 x 2\(\pi\)). In the azimuthal view, the detector has the same eightfold symmetry as the toroidal magnet.

Layers of MDT-s and RPC-s form three muon'stations', labeled BI, BM, BO (for barrel inner, middle and outer station), at different average radius. Each station includes multiple MDT chambers: 3 or 6 along z in a half barrel, and 8 pairs in \(\phi\); each chamber is made of two triple layers of MDT-s, separated by a spacer. Drift tubes are 3 cm in diameter, and oriented perpendicular to the beam axis; they cover a comparatively large \(\Delta\phi\), their readout is precise in one projection (r-z) only.

In the azimuthal direction, MDT chambers form eight identical sectors, where each sector consists of a large and a small chamber. In z direction, the MDT-s are segmented into physical units (maximum size is 2.16 x 5.2m in \(\Delta\)z x r\(\Delta\phi\) for the large BO chambers), all corresponding roughly to regions of constant \(\Delta\eta\sim 0.2\), with the exception of the small BI chambers, of which there are only three, each covering \(\Delta\eta\sim 0.4\).

[MISSING_PAGE_FAIL:15]

Resistive Plate Chambers (RPC) are used as trigger chambers in the barrel, and Thin-Gap wire Chambers (TGC) in the endcap. To reduce the accidental rate to a level lower than the prompt muon rate, the trigger is implemented in two projections, r-z and r-\(\phi\). The trigger detectors thus can be used also to provide to the muon tracking system the missing coordinate \(\phi\).

_a) barrel_

The segmentation of the barrel detector adopted at level 1 is not the same as indicated above; different layers have cells with fine resolution in \(\phi\) or in \(\eta\). The minimum level-1 trigger cell is the intersection region of the coincidences matrices in the two trigger views; the effective level-1 trigger granularity can be defined down to \(\Delta\eta\) x \(\Delta\phi\) = 0.10 x 0.13. This corresponds to a segmentation of 24 x 48 in \(\eta\) x \(\phi\), and gives a total of 1152 possible RoI-s.

_b) endcap_ (TBD)

### Transmission to Rod/ROB

There is a one-to-one equivalence between ROD-s and ROB-s.

_a) Level-1 trigger_

For each bunch crossing, local sector triggers generate one 32-bit word. In the level-1 Muon Processor, for each track 4 coincidence matrices are activated, and for each matrix 45 bits (6 bytes) may be delivered as trigger data. These data are for transmission to the level-3 trigger, and not referred to in level 2.

_b) Trigger chambers_

At the present stage, the readout system of the trigger detectors is not yet defined in detail. In the barrel, each RPC plane is equipped with readout strips: z-strips parallel to the magnetic field of the central toroid, and \(\phi\)-strips parallel to the beam. The RPC-s are segmented into several hundred thousand strips. With a typical area of 800 cm\({}^{2}\) and an average rate of 30 Hz/cm\({}^{2}\), there will be on average 6x10\({}^{-4}\) hits per strip per bunch crossing, viz. less than 1000 strips are hit per event. Data are grouped such that one ROB of trigger chambers covers the full length of same-size MDT chambers (large or small) in a sector/station.

(In the endcaps, the TGC planes have wires parallel to the main component of the magnetic field, and radial strips. The TGC will also be segmented in a large number of strips, and the number of strips hit per event is similar to the corresponding number in the RPC-s. Thus the amount of data to readout is modest. At a maximum level-1 trigger rate of 100 kHz and assuming 1 byte per hit, we expect 50 MBytes/s in \(\phi\) and 20 Mbytes/s in z.)

_c) Precision chambers_

On the frontend boards we have, for each tube, a pre-amplifier, an amplifier, a shaper, and a discriminator, followed by a TDC. Each TDC will have 24 channels (tubes); it contains buffering and trigger matching logic (derandomizer), and requires timing/trigger information. The TDC will put in the data stream only those data items that belong to a certain level-1 trigger, zero-suppressed. Multiple bunch crossings have to be transmitted, as the maximum drift time corresponds to \(\sim\)15 bunch crossings, and local operation allows only a minimum/maximumassociation of MDT hits to a given (triggered) bunch crossing. Taking this into account, the average 'occupation' of MDT-s is 10%.

The readout logic combines TDC data of the two chamber multilayers and of three stations, feeding them into a single ROD (probably over one optical fiber). MDT data from one projective tower (BO, BM and BI) will go into one ROB; to make this possible, the TDC data in the small BI chambers (which cover 2 towers in z) will be split into two groups, to be associated to two towers. The total number of ROBs will be 96 for MDT-s and 6 for RPC-s (half barrel).

### Format into ROD/ROB

_Trigger chamber data_

The format is not defined as yet. The data volume is expected to be 600 bits per ROB.

_Precision chamber data_

The readout logic combines the TDC data of the two multilayers of a chamber in blocklets of a number of wires. The logic adds an identifier for the chamber, and the total number of data items from the TDCs. The latter should be usable as a pointer through the blocks of data in each tower. The average data volume per ROB of MDT-s is estimated to be 4.8 kbits.

### Preprocessing

No major load of preprocessing can be defined at the present moment.

## 6 From ROBs to regions of interest (RoIs)

### Summary of readout parameters

\begin{tabular}{|l|r|r|r|r|r|r|r|} \hline  & \# of channels & channels /ROB & \# of ROBs & datavol /ROB & partition & \# of partitions & datavol /partition \\  & & & & [kbit] & & & [kbit] \\ \hline
**SCT** & & & & & & & \\ \hline full barrel & 3.2 M & 24 576 & 132 & 4 & wafer & 4224 & 0.125 \\ \hline one endcap & 1.5 M & 24 576 & 62 & 4 & wafer & 1976 & 0.125 \\ \hline TOTAL & 6.2 M & & 256 & & & 8176 & \\ \hline
**TRT** & & & & & & \\ \hline half barrel & 52.5 k & 821 & 64 & 6 & module & 3 x 32 & - \\ \hline one endcap & 159.7 k & 832 & 192 & 6 & plane & 224 & - \\ \hline TOTAL & 424.4 k & & 512 & & & & \\ \hline
**Em.Cal** & & & & & & \\ \hline half barrel & 53.8 k & 480 & 112 & 7.7 & T-tower & 896 & 0.96 \\ \hline
1 outer endcap & 35.8 k & 448 & 80 & 7.2 & T-tower & 640 & 0.90 \\ \hline
1 inner endcap & 5.1 k & 320 & 16 & 5.1 & T-tower & 128 & 0.64 \\ \hline TOTAL & 189.4 k & & 416 & & & 3328 & \\ \hline \end{tabular}

Feature extraction processors are served full data from all ROB-s which contribute to a RoI. A finer selection of only those hits that lie inside the RoI, is not foreseen, at least not in the demonstrator programme. The size of an RoI thus varies with a) the precision of the level-1 (or other) indication, b) the extent of the physical object that is to be triggered upon, and c) the granularity of information in the ROB-s. The construction of the detector also plays an important role.

We consider only level-1 triggers for electrons, muons, or jets. The RoI sizes given are minimal, and may be extended if local organization is facilitated by doing so. Possible preprocessing of data (integration over cells in the calorimeters, both laterally or longitudinal) must be discussed in function of the algorithms used. The output formats of RoI collection are 'images' where uncompressed data are concerned (calorimeters); for the SCT, TRT and muon chambers, an address in a global coordinate system is transmitted with each hit.

In the SCT, a lepton (e or \(\mu\)) trigger defines a RoI of.2 x.2 in \(\Delta\eta\) x \(\Delta\phi\), a jet trigger is ignored. An RoI is most often (75%) contained in 4 to 5 ROB-s, and in very rare cases demands access to 8 ROB-s. (These numbers are preliminary, and no information is available as yet for the endcap.)

In the TRT, both barrel and endcap, a \(\Delta\phi\) of 0.2 is used as RoI for a lepton trigger, with no limitation in \(\Delta\eta\). This information is contained in 2 adjacent ROBs in the barrel, and in 6 adjacent ROBs in the endcap. Jet triggers cause no tracking in the TRT.

In the calorimeters, the minimal size of a RoI for a lepton trigger is.3 x.3 in \(\Delta\eta\) x \(\Delta\phi\), and 1.2 x 1.2 for a jet trigger. A lepton RoI in the em. calorimeter is contained in 2 or 4 ROBs. In the case of a jet trigger, the number of necessary ROB-s is much higher, but the data volume is reduced by aggregating information: the granularity of transmitted cells will be that of trigger towers, 0.1 x 0.1 in \(\Delta\eta\) x \(\Delta\phi\).

In the muon chambers, a \(\mu\)-trigger defines a RoI of.2 x.2 in \(\Delta\eta\) x \(\Delta\phi\), other triggers are ignored. In \(\phi\), here is little or no bending and sufficient overlap beween large and small chambers, so that only a single MDT chamber will be transmitted; in \(\mathrm{z}\) (\(\eta\)), due to the bending three adjacent chambers (ROB-s) are needed.

### Summary of ROB / RoI relations

In the following table we combine the available information on ROB-s and ROI-s, mostly in order to allow estimating the control traffic for different level-2 trigger architectures. Only the primary messages to collect fragments of RoI-s are considered;data transmission, decision communication, and any handshaking messages are ignored. The frequencies are given in % of the primary trigger rate for one RoI in the given detector part. The assumption is made that (up to) 16 ROB-s are in a crate, and that arrangements are optimal for the trigger (e.g. identical regions covered by a crate in e.m. and had. calorimeters, an assumption that may not be implementable in this form. The rates are averaged over each detector, an assumption definitely wrong in some cases (see 4.4.2 above). We also assume ROBs spread randomly over crates; the (probably desirable) clustering factor is not taken into account; its effect is to reduce the rate on crates, but increase the number of ROB-s addressed in a message per crate. Hypothetical multi-ROB concentrators inside a crate will have frequencies between those for 'crate' and 'ROB'.

\begin{tabular}{|l|r|r|r|r|r|r|r|r|} \hline  & \multicolumn{2}{|c|}{\# ROBs/} & \multicolumn{2}{|c|}{ROB-s per RoI} & \multicolumn{2}{|c|}{RoI volume} & \multicolumn{2}{|c|}{crates per RoI} & \multicolumn{2}{|c|}{frequency in \%} \\ \cline{3-10}  & \multicolumn{1}{|c|}{\# crates} & \multicolumn{1}{|c|}{(avge)} & \multicolumn{1}{|c|}{min/max} & \multicolumn{1}{|c|}{(kbit, avge)} & \multicolumn{1}{|c|}{(avge)} & \multicolumn{1}{|c|}{(max)} & \multicolumn{1}{|c|}{ROB} & \multicolumn{1}{|c|}{crate} \\ \hline
**SCT** & & & & & & & & & \\ \hline full barrel & 132 / 9 & 4.6 & 3 / 8 & 18.5 & & & 3.5 & 43 \\ \hline one endcap & 62 / 4 & 3.7 & 1 / 6 & 14.8 & & & 6.0 & 73 \\ \hline
**TRT** & & & & & & & & \\ \hline half barrel & 64 / 4 & 2 & 2 / 2 & \multicolumn{1}{|c|}{\(\sim\)12} & 1.06 & 2 & 3.1 & 40 \\ \hline one endcap & 192 / 12 & 6 & 6 / 6 & \multicolumn{1}{|c|}{\(\sim\)36} & 1.3 & 2 & 3.1 & 40 \\ \hline
**Lepton Trigger: Calorimeter (em + had)** & & & & & & & \\ \hline half barrel & 128 / 8 & 4 & 3 / 5 & 23.1 & 1.34 & 4 & 2.7 & 35 \\ \hline one endcap & 112 / 8 & 4 & 3 / 5 & 23.1 & & & 3.1 & 40 \\ \hline
**Jet Trigger: Calorimeter (em + had)** & & & & & & & \\ \hline half barrel & 128 / 8 & 19 & 19 / 19 & \multicolumn{1}{|c|}{\(\sim\)20} & 3.0 & 4 & 16.1 & 94 \\ \hline one endcap & 112 / 8 & 19 & 19 / 19 & \multicolumn{1}{|c|}{\(\sim\)20} & & & & \\ \hline
**Muons** & & & & & & & & \\ \hline full barrel & 112 / 16 & 4 & 4 / 4 & 15 & 1 & 1 & 4.0 & 6 \\ \hline half endcap & & & & & & & & \\ \hline \end{tabular}