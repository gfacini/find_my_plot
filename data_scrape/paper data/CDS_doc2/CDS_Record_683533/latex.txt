ATLAS Internal Note

TILECAL-No-??

April 1996

**H1-inspired analysis of the 1994 combined test**

**of the Liquid Argon and Tilecal calorimeter prototypes**

M.P. Casado, M. Cavalli-Sforza

_Institut de Fisica d'Altes Energies (IFAE),_

_Universitat Autonoma de Barcelona, Edifici Cn,_

_08193 Bellaterra, Spain_

A new analysis of the 1994 combined test of the Liquid Argon and Tile calorimeters is presented, using an algorithm based on the H1 weighting method. A new feature of our approach is that the linearity and resolution of the combined calorimeter are simultaneously optimized. The algorithm makes use of a total of only 8 parameters, plus the beam energy; a very significant improvement of linearity and resolution is obtained. This energy reconstruction algorithm can also be used without assuming prior knowledge of the pion energy, as in a real experimental situation. In this case the _rms_ deviation from linearity is \(\sigma=0.36\) %; the energy resolution is \(\sigma/E=(38.3\ \%/\sqrt{E}+1.62\ \%)\oplus 3.06/E\), which is better than obtained with previous approaches. This method is simple to use, appears suitable to reconstruct energies at different particle angles and energies, and may provide a basis for jet energy reconstruction in ATLAS.

###### Contents

* 1 Introduction
* 2 Data Sample
* 3 Reconstruction of the pion energy
	* 3.1 Obtaining sets of \(\{a_{i}\}\) at each energy
	* 3.2 Parametrizing the \(\{a_{i}\}\)
* 4 Realistic energy reconstruction, assuming no knowledge of the beam energy
* 5 Summary and Conclusions
* 6 Acknowledgements
* A Appendix
* A.1 Cell energy intervals
* A.2 Treatment of the low energy cells of the LAr calorimeter
* A.3 Cryostat correction
* A.4 Explanation of the systematic deviation from linearity when minimizing the resolution
* A.5 The noise cuts

Introduction

The combined response to pions of the Liquid Argon (LAr) and the Tile barrel prototypes was first tested on the H8 beam in late 1994. Several algorithms to reconstruct the energy of incident pions were tried since the data were taken; the results are summarized in ATLAS-TILECAL-NO-67 [1] in which two methods are described in some detail:

1. A "benchmark" algorithm, designed to be as simple as possible. With this algorithm, using altogether 5 energy-independent parameters, the energy resolution was found to be about as good as that of the 1993 "standalone" Tile calorimeter data [2] for pion energies above 50 GeV. With this approach, the _rms_ deviation from a linear response is 1.2 %.
2. A sampling-dependent weighting technique, in which the weights are parametrized as a function of the beam energy. This technique is an extension of the energy-independent weighting method [2] which was applied to the Tilecal 1993 standalone data. This approach gives somewhat better resolutions than the benchmark algorithm; however the linearity at low energy is not as good.

In this note, we report on a different approach to energy reconstruction of the combined data, which is based on the H1 weighting method [3] and on an algorithm to simultaneously optimize resolution and linearity.

A detailed description of the calorimeter prototypes and test setup is given in ATLAS-TILECAL-NO-67 and will not be repeated here. In this note, the cuts on the data sample are briefly described; then we present the new approach. In section 3 the basic concepts of the H1 method are presented; then we describe the algorithm we developed and give results on resolution and linearity. In a subsequent step, the large number of weighting parameters obtained from the data can be replaced by simple functions of the beam energy using only 7 parameters. In section 4 the pion energy is reconstructed ignoring the _a priori_ knowledge of the energy which is available in test beams (but not in an actual experiment). The resolution degrades somewhat, but is still better than with the previously described methods; the linearity of the response remains excellent.

In the conclusions, some possible future directions are discussed. The technical aspects of the method are discussed in the Appendix.

Data Sample

In order to better compare our results with the results of ATLAS-TILECAL-NO-67 the same set of pion runs at 20, 50, 100, 150, 200 and 300 GeV has been used. Cuts were applied to eliminate the beam halo and the events with an interaction before the LAr calorimeter. The position and divergence of the beam spot varied with beam energy, which required to tune the cuts for each energy.

The set of cuts applied is the following:

1. The trigger bit for "physics" events is required.
2. The signal in the S2 beam counter is required to be compatible with that of a single non-interacting particle.
3. The space angle with respect to the beam axis is required to be within about \(\pm 3\sigma\) of the peak of the distribution.
4. A \(\pm 3\sigma\) cut on the \(x\) and \(y\) coordinates measured in beam chambers 1 and 3 is applied.
5. The signal in the preshower is required to be compatible with that of a single non-interacting particle.
6. Finally, a cut on the total energy rejects incoming muons.

The cut to require physics events removes about 30 % of the events in the ntuples. Typically 12 % of the physics events remains after applying the other cuts. The cuts which contribute most to reducing the data sample are the angular cut (cut 3), which typically removes 46 % of the events; the cut on the beam chamber coordinates (cut 4) with \(40-65\) % removal, and the cut on the preshower (cut 5), with 68 % removal. (These percentages give the effect of each cut on all the physics triggers, independently of the other cuts; of course the cuts overlap.). All these cuts are the same as in in Ref. [1], except for a slight difference in the form of the angular cut; however the cut values were independently determined by us. The overall effect of the cuts is seen in Fig. 1 in which the beam spot on the front face of the LAr calorimeter is shown for 300 GeV pions before and after the cuts.

## 3 Reconstruction of the pion energy

The resolution and linearity of the response of a non-compensated calorimeter to hadrons are degraded by the difference in response to the electromagnetic and hadronic components of hadronic showers; the purpose of weighting techniques is to compensate for this difference.

The weighting techniques previously applied to the combined data [1] reduce the effect of the non-compensation correcting downwards the response of the cells with relatively large signals, which are mostly due to local electromagnetic showers from \(\pi^{o}\) decays. This method is suggested by previous experience in other calorimeters [4]; due to the sign of the correction the total corrected energy needs to be recalibrated upwards to obtain the incident hadron energy.

The H1 weighting concept is based instead on correcting upwards the response of cells with relatively small signals, to equalize their response to that of cells with large (typically electromagnetic) deposited energies.

As a preliminary step, the signal in every calorimeter cell (LAr and Tiles) is expressed in GeV, using the signal-to-energy conversion constant obtained from electron runs. For the Tile calorimeter the conversion constant \(\alpha_{em}\)=6.02 pC/GeV is used; it was obtained from electron data taken in summer 1994 [5]. The LAr calorimeter signal is already expressed in GeV in the available n-tuples, using electron data taken in the same test beam.

The energy in each cell \(E_{cell}\) is then corrected multiplying it by a parameter \(a_{i}\)[3] which depends on the energy of the cell:

\[E_{cell}^{cor}=a_{i}\cdot E_{cell} \tag{1}\]

Figure 1: Beam spot on the front face of the LAr calorimeter for 300  GeV pions before (left) and after (right) applying the cuts.

As a first step, a simple minimization technique [6] was used to obtain a set of \(n\) correction parameters \(\{a_{i}\}\)\((i=1,...,n)\) for each beam energy. As a second step, the \(\{a_{i}\}\) were expressed as function of the cell energy and of the beam energy.

For the sake of readability, only the essential steps are described in the next two subsections. Technical details are described in the Appendix.

### Obtaining sets of \(\{a_{i}\}\) at each energy

For each beam energy, the cell energy spectrum is divided into \(n\) intervals (in subsection A.1 of the appendix the technique to define these intervals is given) and a correction parameter \(a_{i}\) is calculated for each interval. Two sets of parameters are calculated for the LAr and Tile calorimeters; to simplify the notation, the next expressions are written in terms of only one set of parameters.

The \(\{a_{i}\}\) are obtained from the data at each energy as follows. We express the corrected energy of event \(k\) as

\[E^{k}_{cor}=a_{1}\cdot\tilde{E^{k}_{1}}+\,...\,+a_{i}\cdot\tilde{E^{k}_{i}}+\,...\,+a_{n}\cdot\tilde{E^{k}_{n}}+E_{cryo}+E_{low\_em} \tag{2}\]

In this expression:

* \(\tilde{E^{k}_{i}}\) is the sum of the energy of all the cells within interval \(i\), i.e. \[\tilde{E^{k}_{i}}=\sum_{cell\,s\,\epsilon\,\,i}E_{cell}\] (3)
* \(E_{cryo}\) is the energy released in the cryostat. We have used the same expression as in Ref. [1] \[E_{cryo}=c\cdot\sqrt{E_{had\,1}\cdot E_{em3}}\] (4) where \(c=0.44\) was chosen, as in Ref. [1] (this choice is discussed further in subsection A.3 of the appendix); \(E_{had1}\) is the uncorrected energy released in the first sampling of the Tile calorimeter and \(E_{em3}\) is the uncorrected energy released in the third sampling of the LAr calorimeter.
* \(E_{low\_em}\) is the sum of the energy of the LAr cells with energy \(<330\) MeV. Subsection A.2 of the appendix gives the reasons for this choice.

The set \(\{a_{i}\}\) of correction parameters can be determined from the data by minimizing the _rms_ spread of the total corrected energy [6] with respect to the \(\{a_{i}\}\):\[N\cdot\sigma^{2}=\sum_{k=1,N}(E^{k}_{\it coor}-E_{\it be\,a\,m})^{2} \tag{5}\]

where \(N\) is the total number of events and \(E_{\it be\,a\,m}\) the nominal beam energy. The minimization gives \(n\) linear equations with \(n\) unknowns, which are solved for the \(\{a_{i}\}\).

The form of eq. 5 is often used in calorimetric analyses to optimize resolution, because the parameters obtained solving the equations give a mean reconstructed energy close to the nominal beam energy. In our case, a systematic deviation from linearity at low energies was found (see Fig. 3 Left ). This deviation has a simple cause which is explained in Ref. [7] and in subsection A.4 of the appendix; understanding this bias would allow to correct it "post factum". However there is a better approach. The general problem of minimizing a quantity under a set of constraints was solved about two hundred years ago by Lagrange; at length we recalled this classical result and determined the \(\{a_{i}\}\) by minimizing the expression

\[N\cdot\sigma^{2}=\sum_{k=1,N}(E^{k}_{\it coor}-E_{\it be\,a\,m})^{2}+\lambda \cdot\sum_{k=1,N}(E^{k}_{\it coor}-E_{\it be\,a\,m}) \tag{6}\]

in which the constraint that the mean reconstructed energy reproduces the nominal energy is introduced by means of a Lagrange multiplier.

The \(\{a_{i}\}\) thus obtained for the Tile and the LAr calorimeter can be seen in Fig. 2; the parameters obtained minimizing instead eq. 5 are very close to those shown. The corrected total energy spectra were fitted with Gaussian distributions over a \(\pm 2\sigma\) range. From the mean values of the fits we obtain plots of the deviation from a linear response. Such "linearity plots", obtained from the solutions of eqs. 5 and 6 are shown in Fig. 3, Left and Right respectively. The improvement from including the "energy conservation" constraint is very clear; with this constraint, the _rms_ deviation from linearity is 0.28 %.

The energy resolutions (\(\sigma/E\,\,vs.\) the beam energy) are given in Fig. 4, where the results of this approach are compared to the results of Ref. [1]; the improvement is very clear. In Fig. 5 the same results are compared to the weighted resolutions of the 1993 Tilecal standalone data; at 100 GeV and above, using the new method, the resolutions are better in the combined data than in the 1993 data analyzed with the simple method of Ref. [2]. The resolution obtained here can be parametrized as \((35.2\,\,\%/\sqrt{E}+1.43\,\,\%)\oplus 2.83/E,\) where \(E\) is in GeV and the \(\oplus\) symbol indicates sum in quadrature.

The results of the fits to the reconstructed pion energies are given in table 1.

Before moving on a few observations are in order:1. The improvement in resolution and linearity with respect to other weighting techniques is not surprising. The two terms of eq. 6 and the large number of parameters practically guarantee this result. However, the good news is that the \(\{a_{i}\}\) vary smoothly with cell energy, and do not vary much with \(E_{beam}\). This simplifies the parametrizations described further in this note.
2. The individual cell energies can be corrected using this method with a variety of similar algorithms: for instance, the \(\{a_{i}\}\) parameters can be defined by a distribution of volume energy density \(E_{cell}/V_{cell}\). Despite its intuitive appeal this latter approach was found to give significantly worse resolutions. Other approaches (such as normalizing the cell energies to the total energy) were tried; the choice of correcting the cell energies as a function only of the cell energy gives the best results and was chosen for this analysis.
3. A great advantage of this method is that after developing the software tools and establishing some rules (such as the noise cuts discussed in subsection A.5 of the appendix and the intervals on which to calculate the parameters) obtaining the results is almost automatic.

### Parametrizing the \(\{a_{i}\}\)

Looking at Fig. 2 we can count how many parameters were used to reconstruct the pion energies: there are \((13+7)\) parameters for the (Tile + LAr) calorimeters at each of the 6 beam energies, i.e. a total of 120 parameters (plus the cryostat constant). To reduce the number of parameters we proceed as follows:

* First, the \(\{a_{i}\}\) are parametrized as a function of cell energy using the function \(y=a+b/E_{cell}\) (with different values \(a\), \(b\) for the Tiles and the LAr). The

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline Energy & \(\mu\) & \(\sigma\) & \(\frac{\sigma}{\mu}\)( \%) \\ \hline
20 GeV & 20.12 \(\pm\) 0.08 & 3.34 \(\pm\) 0.07 & 16.6 \(\pm\) 0.4 \\
50 GeV & 49.98 \(\pm\) 0.09 & 4.44 \(\pm\) 0.08 & 8.89 \(\pm\) 0.17 \\
100 GeV & 99.93 \(\pm\) 0.15 & 5.58 \(\pm\) 0.13 & 5.59 \(\pm\) 0.13 \\
150 GeV & 149.7 \(\pm\) 0.5 & 6.2 \(\pm\) 0.4 & 4.1 \(\pm\) 0.2 \\
200 GeV & 200.23 \(\pm\) 0.18 & 8.27 \(\pm\) 0.17 & 4.13 \(\pm\) 0.08 \\
300 GeV & 300.60 \(\pm\) 0.19 & 10.93 \(\pm\) 0.18 & 3.63 \(\pm\) 0.06 \\ \hline \end{tabular}
\end{table}
Table 1: Mean energy, \(\sigma\) and resolution at various beam energies obtained with the constraint to the beam energy.

Figure 2: On the left \(a_{i}\) for the Tiles (\(ah_{i}\) on the plots) and on the right \(a_{i}\) for the LAr (\(ae_{i}\) on the plots) at various beam energies.

results are shown in Fig. 6 for various beam energies. The errors on the \(\{a_{i}\}\) shown in the figure are the _rms_ values of ten independent sets of \(\{a_{i}\}\) obtained by breaking the data samples at each energy in 10 separate sets and solving the minimization equations for each set. Note that the cell energy function we use has one less parameter than the H1 form, which is \(y=\tilde{a}+\tilde{b}\cdot e^{-\tilde{c}\cdot E_{cell_{x}}}\)[3].
* Next, the parameters \(a\) and \(b\) are expressed as a function of the beam energy using simple one- or two-parameter forms. This is shown in Fig. 7; it can be seen that the \(a\) and \(b\) parameters do not vary much over the range of beam energies; one of the four was taken to be a constant.

Finally the entire set of corrections can be expressed by two sets of simple functions, containing a total of only seven constants, called \(p_{1}\) and \(p_{2}\) in Fig. 7 (plus the cryostat energy constant). We need to check whether the energies reconstructed with 8 rather than 121 parameters are now less precise. The mean, \(\sigma\) and resolution values obtained from this parametrization of the \(\{a_{i}\}\) are given in table 2; the resolution and linearity plots are in Fig. 8 and 9. Comparing to the results previously obtained with \(120\;a_{i}\) (repeated in these two figures) it is seen that despite the dramatic reduction of correction parameters the resolution is negligibly worse and the linearity has not degraded. Quantitatively, the _rms_ deviation from linearity is now \(\sigma=0.33\;\%\) instead of \(0.28\;\%\). The resolution is now parametrized as \(\sigma/E=(41.6\;\%/\sqrt{E}+1.14\;\%)\oplus 2.63/E\).

Figure 3: Left: linearity plot minimizing eq. 5. Right: linearity plot minimizing the functional with the Lagrange multiplier. The points are obtained normalizing the mean reconstructed energy values from the Gaussian fits to the value of 100 GeV.

Figure 4: Resolution plot for the pion data, comparing the results of this approach to the two approaches of ATLA S-TILECAL-N O-67.

Figure 5: Resolution plot comparing the results of this approach to the weighted standalone pion data of Ref. [2].

Figure 6: On the left, fits of the \(a_{i}\) for the Tiles (\(ah_{i}\) on the plots) and, on the right, fits of the \(a_{i}\) for the LAr (\(ae_{i}\) on the plots) at various beam energies. The parameters \(a\) and \(b\) obtained for the Tiles (\(a_{h}\) and \(b_{h}\) on the plots) and for the LAr (\(a_{\epsilon}\) and \(b_{\epsilon}\) on the plots) are also shown on the plots.

Figure 7: The top plots show the parametrization with the beam energy of \(a\) and \(b\) for the Tile calorimeter (\(a_{h}\) and \(b_{h}\) on the plots); the bottom plots show the same for the LAr calorimeter (\(a_{e}\) and \(b_{e}\) on the plots). The values of the parameters from the fits are also presented on the plots.

Figure 8: Resolution before and after the parametrization with the beam energy.

Figure 9: Linearity before and after the parametrization with the beam energy.

## 4 Realistic energy reconstruction, assuming no knowledge of the beam energy

The method just described cannot be used just "as is", because the particle energy - needed to calculate the correction parameters - is unknown in a real experiment. However it can be estimated from the raw data, and this estimate can be used to calculate a corrected energy; the procedure may be iterated until it converges.

We have considered three different algorithms to obtain the initial estimate of the particle energy:

1. A linear function of the sum of the cell energies 1 (plus the cryostat correction).
2. The benchmark approach algorithm.
3. A linear function of the energy reconstructed with the \(\{a_{i}\}\) obtained from the 100 GeV data.

Footnote 1: The linear function is \((E+2.4\,5)/0.88\). The raw signal sum underestimates the particle energy because \(e/\pi>1\), therefore an initial correction is needed.

The first estimate is used to calculate the corrections for each cell, through the parametrizations given above. The corrected total energy (eq. 2) provides the value for the next iteration. We found that after 3 or 4 iterations all 3 algorithms converge practically to the same value of the total energy. We chose the first because it is the simplest.

Next we looked once again at the performance of the calorimeter using this algorithm. The means, \(\sigma\) and resolution on the reconstructed energies are in table 3. In Fig. 10 the linearity given by the "realistic" method is compared with the linearity obtained using the known beam energy; the linearity remains as good as before

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline Energy & \(\mu\) & \(\sigma\) & \(\frac{\sigma}{\mu}\) ( \%) \\ \hline
20 GeV & 19.96 \(\pm\)0.08 & 3.32 \(\pm\)0.08 & 16.6 \(\pm\)0.4 \\
50 GeV & 50.26 \(\pm\)0.09 & 4.49 \(\pm\)0.09 & 8.95 \(\pm\)0.17 \\
100 GeV & 100.43 \(\pm\)0.16 & 5.81 \(\pm\)0.14 & 5.78 \(\pm\)0.14 \\
150 GeV & 150.1 \(\pm\)0.5 & 6.9 \(\pm\)0.5 & 4.6 \(\pm\)0.3 \\
200 GeV & 200.74 \(\pm\)0.19 & 8.67 \(\pm\)0.18 & 4.32 \(\pm\)0.09 \\
300 GeV & 299.27 \(\pm\)0.19 & 10.94 \(\pm\)0.18 & 3.66 \(\pm\)0.06 \\ \hline \end{tabular}
\end{table}
Table 2: Mean energy, \(\sigma\) and resolution after the parametrization over the beam energy range.

(from 0.33 % to 0.36 %). Finally, the linearities obtained with the benchmark and weighting methods of Ref. [1] are compared with this last result in Fig. 11.

Turning to the resolutions obtained with the realistic algorithm, we see in Fig. 12 a slight systematic degradation of the resolution values with respect to the values given in the preceding parametrization that used the nominal beam energy. This result was expected; in fact, it is inevitable due to the event-to-event fluctuations of hadronic showers. When the correction parameters are obtained from each event, the starting total energy value will be distributed around the nominal value due to the intrinsic calorimeter resolution; this necessarily introduces an interpolation error which degrades the performance of the algorithm. The figure shows that the degradation of resolution is more pronounced at low energy, as expected from the energy dependence of \(\sigma/E\).

Despite the fact that no use is made of the beam energy value, this last algorithm is still as good as or better than both previously used weighting methods. This is shown in Fig. 13, in which the fit to the "realistic" resolution is shown; the final result is

\[\frac{\sigma}{E}=\left(\frac{38.3\ \%}{\sqrt{E}}+1.62\ \%\right)\oplus\frac{3.0 6}{E} \tag{7}\]

## 5 Summary and Conclusions

In this note, following the weighting method developed by the H1 collaboration, we have reconstructed the total energy in the LAr and Tile calorimeters by correcting the energy in each cell of either calorimeter by a factor, typically \(\geq 1\), that is a function of the energy in each cell and of the beam energy. Using Lagrange multipliers we found a set of weights that produces a very linear response and significantly improved resolutions over the range \(20\leq E\leq 300\) GeV; these weights can be parametrized by simple functions in which only 7 constants appear.

In order to check the applicability of this method to a real experimental situation, in which no _a priori_ knowledge of the particle energy is available, we proceeded to estimate the particle energy from the raw data and iteratively reconstructed the energy by the previously determined algorithm. The same reconstructed energies are obtained in just a few iterations, independently of the first estimate; hence the linearity of the response is unchanged. As expected, the resolution degrades somewhat when no knowledge of the particle energy is assumed; however it is still better than with previously used energy reconstruction methods.

At low beam energies (below 50 GeV) the resolution deteriorates appreciably, as observed with all reconstruction methods. This confirms that the problem is intrinsic to the data set; it will have to be addressed in future test beams.

The method outlined here could be a starting point for improvements and more general algorithms. Here is a partial list of possible developments:

* The cryostat correction is probably not yet optimized. As shown in subsection A.3 of the appendix, this method is flexible enough to absorb the effect of an incorrect cryostat correction into the weights; consequently it cannot be used to determine the cryostat correction by minimizing the resolution. The issue will have to be solved by MonteCarlo or other methods.
* One may ask whether the energy fractions actually deposited in the LAr and Tile calorimeters are reproduced by the reconstruction algorithm; it would be nice if this were the case, but it is not necessarily so. Comparison to simulations may help in answering this question.
* Some dependence of the correction algorithm on the angle of incidence of the beam must be expected, because of the associated variation of cell volume. When data become available at more than one angle it will be interesting to investigate and further improve this method.
* It would be interesting to see whether the algorithm obtained from a set of beam energies performs well at other energies, within the energy interval used to define the algorithm and outside.
* Finally, in the ATLAS environment, the game will be to develop an effective jet reconstruction algorithm. The method described here may be flexible and powerful enough to suit this purpose.

## 6 Acknowledgements

The H1 weighting method was first applied to the 1993 standalone Tilecal data by Hradchio Hakopian [10]; his promising results stimulated our interest in this approach. During the first steps of this work, Marina Cobal helped us with her experience applying weighting techniques to the 1994 combined test and provided us some papers of the H1 collaboration from which we learned how to calculate the weighting parameters from the data. We also appreciate the help of Ilias Efthymiopoulos who suggested how to deal with a few noisy LAr calorimeter cells and kept us informed on the development of his Monte Carlo for the combined setup. Finally, Peter Loch shared with us his first-hand experience of the H1 weighting method and helped us in understanding the problem of linearity of the response at low energies.

\begin{table}
\begin{tabular}{|c|c|c|c|} \hline Energy & \(\mu\) & \(\sigma\) & \(\frac{\sigma}{\mu}\)( \%) \\ \hline
20 GeV & 19.95 \(\pm\) 0.09 & 3.63 \(\pm\) 0.09 & 18.2 \(\pm\) 0.4 \\
50 GeV & 50.28 \(\pm\) 0.10 & 4.77 \(\pm\) 0.09 & 9.48 \(\pm\) 0.18 \\
100 GeV & 100.47 \(\pm\) 0.16 & 6.17 \(\pm\) 0.15 & 6.15 \(\pm\) 0.15 \\
150 GeV & 150.3 \(\pm\) 0.6 & 7.5 \(\pm\) 0.5 & 5.0 \(\pm\) 0.4 \\
200 GeV & 200.8 \(\pm\) 0.2 & 9.22 \(\pm\) 0.18 & 4.59 \(\pm\) 0.09 \\
300 GeV & 299.2 \(\pm\) 0.2 & 11.9 \(\pm\) 0.2 & 3.98 \(\pm\) 0.07 \\ \hline \end{tabular}
\end{table}
Table 3: Mean energy, \(\sigma\) and resolution assuming no knowledge of the beam energy.

Figure 10: Linearity plot comparing the method which does not use the beam energy with the one which does. The overlap of the points indicates that the mean values of the energy spectra obtained in the two methods are the same.

Figure 11: Linearity plots comparing the algorithm of this note (without using the beam energy) to those previously applied to the combined run data.

Figure 12: Resolution plot comparing the method that does not use the beam energy with the one that does.

Figure 13: Resolution plot comparing the algorithm of this note (without using the beam energy) to those previously applied to the combined run data.

Appendix

We describe here some details of the technical implementation of the algorithm described in this note. They may be useful as a starting point for future applications and improvements of the method.

### Cell energy intervals

In order to define the \(\{a_{i}\}\) correction parameters the distribution of the energy/cell must be divided in an arbitrary number of intervals. To obtain stable results it is useful to have about the same number of entries per interval. Also, in view of the subsequent parametrization of the \(\{a_{i}\}\) it is useful to develop a simple interval definition algorithm that can be applied at all beam energies. The algorithm is based on selecting equal area intervals on an exponential cell energy distribution, as schematically shown for the Tiles and LAr in Fig. 14, Left and Right respectively, for the 20 GeV data 2. The limits of the intervals are chosen from the 20 GeV data and are left unchanged at all other beam energies; hence the number of intervals is invariant, but the mean value of the cell energy in each interval changes somewhat with energy, as can be seen in Fig. 2.

Footnote 2: For the Tile calorimeter, the energy spectrum is plotted for events that did not interact in the LAr; the intervals thus defined were retained to analyze the full set of events.

In Fig. 14 the noise peaks are evident, and are used to define the starting points of the exponential parametrization. A total of (13 + 13) intervals (Tiles + LAr) was defined at first; however it is clear from the figure that several of the LAr cell energy intervals are in the noise peak. As shown in the next subsection, this led to correcting the LAr calorimeter signals only above 330 MeV/cell. The need of noise cuts is also clear from the Figure; these are described in the last subsection.

### Treatment of the low energy cells of the LAr calorimeter

Using the (13 + 13) intervals defined above, we first obtained a set of (13 + 13) correction parameters \(\{a_{i}\}\), which can be seen in Fig. 15 for several beam energies. The \(\{a_{i}\}\) of the Tiles are quite similar to those shown in Fig. 2; however in the LAr calorimeter the \(\{a_{i}\}\) below \(\sim\)300 MeV decrease with cell energy in a rather irregular manner. By comparing to the \(\{a_{i}\}\) obtained for the Tile calorimeter, one would expect a rise of the \(\{a_{i}\}\) at low energy; we think that this does not happen here because below 300 MeV electronic noise significantly contributes to the cell energy distribution. This would explain the reduced weights, because it is reasonable to expect that in minimizing the resolution the cells containing less information will be weighted less.

Based on these considerations we decided to give unit weight to LAr calorimeter signals below 330 MeV; in other words, we applied to signals in this range the initial calibration from electron runs. These signals were included in the corrected energy of each event as shown in eq. 2. A similar procedure was used for low-energy signals by the H1 collaboration [8].

In Figs. 16 and 17 the linearities and resolutions are compared when the number of energy intervals of the LAr is reduced. As expected, better results are obtained when using more correction parameters; nevertheless, the dispersion of linearity only grows from 0.18 % to 0.28 % and the resolution is negligibly worse, as seen in the resolution plot where the dashed line represents the fit to the resolutions with (13 + 13) intervals, and is given by \((36.5\ \%/\sqrt{E}+1.28\ \%)\oplus 2.72/E\).

### Cryostat correction

In section 3, the energy lost in the cryostat is expressed as in eq. 4 with \(c=0.44\). In this subsection we show that when using this weighting method the choice of \(c\) is almost arbitrary.

For different values of \(c\), corresponding sets of \(\{a_{i}\}\) were calculated and we looked at the variation of the resolution \(\sigma/E\) as a function of \(c\), given in Fig. 18 Left for

Figure 14: Left: cell energy spectrum of the Tile calorimeter for 20 GeV pions that did not interact in the LAr. Right: cell energy spectrum of the LAr calorimeter again for the energy of 20 GeV. In either plot two regions are shown with the corresponding number of chosen intervals.

Figure 15: On the left \(a_{i}\) for the Tiles (\(ah_{i}\) on the plots) and on the right \(a_{i}\) for the LAr (\(ae_{i}\) on the plots) when using (13 + 13) energy intervals at various beam energies.

Figure 16: Linearity before and after decreasing the number of energy intervals.

Figure 17: Resolution before and after decreasing the number of energy intervals.

300 GeV pions. Clearly the resolution is very insensitive to the value of \(c\); almost any \(c\) can be used as long as the \(\{a_{i}\}\) are calculated after choosing \(c\), because the \(\{a_{i}\}\) absorb the cryostat energy correction. We conclude that in the context of this weighting method the cryostat energy correction is arbitrary - maybe even unnecesary. We kept it because it has good physical motivation, it seems to be confirmed by MonteCarlo simulations [11], and because failing to correct for the cryostat energy loss would certainly overestimate the energies deposited in the calorimeters. When adding the intercalibrated LAr and Tile calorimeter signals as is done in one of the steps of the "benchmark" approach [1], a resolution minimum (albeit a broad one) is indeed found for \(0.4\leq c\leq 0.6\), as shown in Fig. 18 Right.

### Explanation of the systematic deviation from linearity when minimizing the resolution

The authors of Ref. [7] point out that when calibrating the response of a calorimeter to the beam energy by minimizing an expression like eq. 5 a biased calibration constant is obtained; specifically, the mean calibrated energy \(<E>\) differs from the beam energy by the factor

\[\frac{E_{beam}}{<E>}=1+\left(\frac{\sigma}{<E>}\right)^{2} \tag{8}\]

Figure 18: Left: resolution of the reconstructed energy with the weighting method presented in this note versus different values of the cryostat constant \(c\) for 300 GeV pions. Right: resolution of the benchmark energy versus different values of the cryostat constant \(c\) for 300 GeV pions. The resolutions are normalized to the values for \(c\) = 0.44.

This result is very simple to derive in the case of just one calibration constant; the authors also show that in a case such as ours, involving several intercalibration constants, a similar bias appears. Because \(\sigma/<E>\) increases with decreasing energy, it is clear from the above expression that the bias will be greater at low energies and negligible at high energies, as observed in Fig. 3a. Using this expression it would be easy to parametrize and correct this bias; however the minimization technique using a Lagrange multiplier avoids the problem and saves a correction step.

### The noise cuts

In this analysis a noise cut has been applied to the energy of the cells of the two calorimeters; this helps in parametrizing the \(\{a_{i}\}\) because of the unstable behaviour they show in the noise region. The cut applied is the following:

\[|E_{cells}|\geq E_{thr} \tag{9}\]

This sign-symmetric noise cut [9] has the advantage of statistically cancelling noise signals beyond the cut; the bias introduced on the signal, inevitable with any cut, will in general be smaller than with an asymmetric cut.

The cuts were chosen using the plots in Figs. 19 and 20 (for Tile and LAr) for guidance; the criteria are to avoid significantly decreasing the total signal and degrading the resolution, as shown in the Figures. For the Tile calorimeter, the chosen value of the cell energy cut is 0.34 pC/cell (\(\simeq 56\) MeV/cell), equivalent to \(\simeq 2\sigma\); for the LAr cells, a \(1\sigma\) cut of 55 MeV/cell was chosen.

Figure 19: Normalized mean energy (left) and resolution (right) of 20 GeV pions in the Tile calorimeter, using events with no interaction in LAr, versus the cut applied on the cell energy. Cuts are shown at \(0\cdot\sigma\), \(\frac{1}{2}\cdot\sigma\), \(1\cdot\sigma\),... where \(\sigma\), taken from Ref. [1] as the typical noise of Tile calorimeter cells, is used as a reference.

Figure 20: Normalized mean energy (left) and resolution (right) of 20 GeV pions, using the benchmark energy reconstruction, versus the cut applied to LAr cell energies; cuts are shown at \(0\cdot\sigma\), \(\frac{1}{2}\cdot\sigma\), \(1\cdot\sigma\),... where \(\sigma\) is taken from Ref. [1] as above.

## References

* [1] M. Cobal et al.,_Analysis results of the first combined test of the LArgon and TILECAL barrel calorimter prototypes_, ATLAS Internal Note, TILECAL-No-67 (1995).
* [2] F. Ariztizabal et al., Nucl. Instr. and Meth. **A349** (1994) 384.
* [3] H1 Calorimeter Group, W. Braunschweig et al., _Results from a Test of a Pb Fe Liquid Argon Calorimeter_, DESY internal report, DESY 89-022 (1989).
* [4] H. Abramowicz et al., Nucl. Instr. and Meth. **A180** (1981) 429.
* [5] M. David and A. Amorim, _Electron response_, TILE-TR-024, 22 November 1994.
* [6] A.E. Kiryunin, _Study of the Hadron Energy Resolution of a Liquid Argon Calorimeter by Applying the H1 Weighting Technique_, ATLAS Internal Note, CAL-NO-016 (1993).
* [7] D. Lincoln et al., _A Hidden Bias in a Common Calorimeter Calibration Scheme_, FERMILAB-Pub-93/394 (1993).
* [8] H.P. Wellisch et al., _Hadronic Calibration of the H1 LAr Calorimeter using Software Weighting Techniques_, MPI-PhE/94-03, H1-02/94-346 (1994).
* [9] H1 Calorimeter Group, B. Andrieu et al., _Results from Pion Calibration Runs for the H1 Liquid Argon Calorimeter and Comparisons with Simulations_, DESY internal report, DESY 93-047 (1993).
* [10] H. Hakopian, _Weighting technique_, TILE-TR-014, 28 June 1994.
* [11] I. Efthymiopoulos, _Combined test beam setup simulation program_, TILE-TR-056, 5 March 1996.