# Reconstruction of the time shape of TileCal signals

C. Roda, F. Sarri

Universita of Pisa and I.N.F.N. Pisa

May 30, 2003

###### Abstract

The Hadronic Tile Calorimeter [1] is readout using a dual gain ADC. In this note a method to reconstruct the time shape of signals from a single ADC channel is reported. Both calibration events (CIS) and events generated by beam particles are used. Although the electronic circuit shapes the input signal, some differences are found between calibration and physics events. This discrepancy may be attributed to a difference between the time shape of the signal exiting the photo-multiplier and the one produced by the calibration circuit (CIS). The simulation of the shaper circuit allows to infer the time shape of the signal generated at the output of the photo-multiplier when a beam particle crosses the calorimeter.

## 1 Introduction

The Hadronic Tile Calorimeter is a sampling calorimeter consisting of three "barrels" which allow to cover the range of pseudorapidity \(|\eta|<1.7\). Each barrel is assembled by 64 modules and each module, composed by iron and scintillator material, is divided into cells. A schematic drawing of one module is shown in figure 1. Each signal is readout using two photo-multipliers (PMT) which are coupled to the shaping circuit. The shaped signal is than amplified with two different gains whose ratio is \(1:64\). The two gains, referred to as high and low gain, allow to measure single cell signal ranging from 100 MeV to 1.3 TeV. The signal, shaped and amplified, is sampled nine times at 25 ns intervals with two 10-bit ADCs.

The method described in section 2 of this note allows to reconstruct the time shape of signals with a precision of a few hundredth picoseconds using an ensemble of events. This method is used to reconstruct the signal both for calibration events and for events generated by the crossing of a beam particle through the calorimeter. The difference found between these signals are attributed to a different input signal which generates the two kind of events. This hypothesis is tested in section 3 where the results obtained with the simulation of the shaper circuit are described.

Figure 1: Schematic drawing of a calorimeter module and of the readout chain for a single cell.

## 2 Reconstruction of the signal time shape

The linearity and stability of each electronic channel is monitored using the Charge Injection System (CIS) placed in the 3-in-1 card [2]. The charge injected into the shaper circuit is provided by the discharge process of a capacitor. The possibility to use two capacitor values, 5.1 pf or 100 pf, allows to span the whole dynamic range with a suitable precision for all the values of injected charge. The capacitor is charged by applying a DAC controlled tension ranging from 0 V to 4.096 V.

The time repetition of the sampling of a single event is 25 ns, however it is possible to reconstruct the time shape with a higher resolution using an ensemble of events. For every CIS event it is possible to calculate either the value of injected charge and the time phase between the injection time and the clock of the first sample. The charge value is calculated from the ntuple variables _cispar(7)_ and _cispar(8)_, that indicate respectively the DAC level (0-1023) and the capacitor value, using the following equation:

\[Q_{in\,j}(pC)=\frac{2\cdot 4.096\cdot cispar\,(7)}{1023}\cdot cispar\,(8) \tag{1}\]

The phase is obtained from _cispar(6)_ which gives the time difference between the injection instance and the first sampling clock in 104 ps unit apart from a constant shift. In the data used in this analysis (Test Beam - June 2002) this value ranges from 2 to 233 in steps of 7. The phase ranges from 208 ps to 24.1 ns (almost the whole width of a sample) in steps of 728 ps. For each value of the charge and of _cispar(6)_ there are 8 injections, for a total of 272 events. Then using an ensemble of events recorded at fixed charge, the 3-in-1 output signal is sampled in steps of 728 ps.

The amplitudes of the samples are stored in ntuple variables indicated with SampleN0Lo(i,j) and SampleN0Hi(i,j), where the last two letters "Lo" and "Hi" refer to the low and high gain respectively; i = [1, 9] runs over the nine samples and j = [1, 48] over the channels; N0 indicate the super drawer for module 0 at negative pseudorapidity. Substituting N1, N2, P0, P1 or P2 to N0 the data relative to super drawer of barrel and extended barrel for negative and positive pseudorapidity are accessed.

The amplitude of the forth and fifth samples, for a channel of the extended barrel, as a function of _cispar(6)_ is shown in figure 2. The trend of the plot shows that the zero of _cispar(6)_ does not correspond to an event where the phase is zero. This allows to evaluate the shift. This shift is the same for each sample, in each channel and in each module, so it is possible to reconstruct the signal applying only one correction. For each sample there are 34 subdivisions of the time scale and for each subdivision 8 events are recorded. The mean sample amplitudes pedestal subtracted are calculated and plotted as a function of the time as shown in figure 3(a).

Figure 3: Reconstructed signal for CIS events (a); comparison between reconstructed CIS signals acquired with high gain (continuous line) and with low gain (dashed line) (b).

Figure 2: Trend of the amplitude of the fourth and of the fifth sample for a fixed charge as a function of _cispar(6)_ for channel 12 of the extended barrel placed at negative pseudorapidity.

Signals reconstructed for high gain and low gain are almost identical (figure 3(b)). Comparing CIS signals obtained using the two different capacitors, it can be seen that they are quite similiar (figure 4).

In order to reconstruct the time shape of signals generated by beam particles (physics events) the phase has been defined as the time difference between the trigger signal and clock. This information is stored in a variable indicated as _btdc1(6)_ expressed in ns units. The trend of sample amplitude as function of _btdc1(6)_ is shown in figure 5. The value assumed by the samples shows a periodicity of 25 ns. At the edges of each 25 ns period, for a single phase value, the sample amplitude assumes two extreme ranges of values. Therefore for the reconstruction we consider events in a single interval of 25 ns and we do not consider events at the edge of the interval. Since the energy spread in physics events is much larger than in CIS events in order to use the whole ensemble of events relative to a fixed beam energy each event is normalized to its area. Then the sample amplitudes are plotted as a function of the phase for all the events. In figure 6(a) the signal reconstructed for electrons of momentum equal to 180 GeV/c is shown. The missing parts are reconstructed by linear interpolation. The time shape of signals generated by electrons of momentum equal to 20 GeV/c has also been reconstructed and this has allowed to compare physics events recorded with high gain and low gain (figure 6(b)). Also in this case no difference has been found.

Figure 4: Comparison between CIS signals generated with the two capacitors, solide line 5.1 pf, dashed line 100 pf.

Figure 5: Trend of the fourth and of the fifth sample as a function of _btdc1(6)_ for electrons at 180 GeV in the channel 12 of the negative extended barrel.

Figure 6: Reconstructed signal for electrons of momemtum equal to 180 GeV/c (a); comparison between reconstructed signals for physics events acquired with low gain (continuous line) and with high gain (dashed line) (b).

The signal generated by pions and muons has also been reconstructed (figure 7) and compared to that one obtained for electrons (figure 8). The comparison shows that the shape of signal is indipendent of the type of particle that has generated it.

The comparison between CIS and physics signals (figure 9) shows however that the charge injection system produces a narrower signal.

## 3 Simulation of the shaper circuit

In order to better understand the difference between the time shape of the signals obtained from CIS events and for physics events the shaper circuit has been simulated using MICROAP7 [4]. A schematic of the shaper circuit and of the charge injection system is shown in figure 10. These circuits are both located on the 3-in-1 card, a complete and more detailed schematic of this card can be found in [3].

Figure 7: Reconstructed time shape of signals generated by pions (a) and muons (b).

Figure 8: Comparison between reconstructed signals for electrons (dashed line) and pions (a) and for electrons and muons (b).

Figure 9: Comparison between reconstructed signals for CIS (continuous line) and for electrons (dotted line).

Figure 11: Schematic of the circuit used in the simulation.

Figure 10: Schematic of part of the 3-in-1 card containing the shaping circuit and the charge injection system.

To simulate the shaper response to a CIS signal, the circuit used for the simulation is slightly different from that one shown on figure 11. The capacitor used to inject the charge is substituted by a current pulse representing the discharge process parametrized with the equation :

\[I\left(t\right)=I_{0}[-\exp\left(-t/t_{r}\right)+\exp\left(-t/t_{f}\right)] \tag{2}\]

where \(t_{r}\) indicates the rise time of the signal, \(t_{f}\) the fall time and \(I_{0}\) is a constant current value which allows to define the integral value of the charge of the input signal. In this case \(t_{r}\) is assumed to be equal to 1 ns to simulate the time characteristic of the switch closing. The fall time \(t_{f}\) is equal to the time constant \(RC\), where \(R\) is the impedance of the circuit equal to 224 ohm [2] and \(C\) is the value of the capacitor used to inject the charge. Then \(t_{f}=1.1\) ns (22.4 ns) when the capacitor of 5.1 pf (100 pf) is used. The output signals obtained by the simulation are compared to the reconstructed signals in figure 12. All signals are normalized to their area. On figure 12(a) is shown the comparison of signals obtained using the 100 pf capacitor, while on figure 12(b) the ones relative to the 5.1 pf capacitor. It can be seen that the reconstructed signals are reproduced by the simulation well enough. The differences that are observed may be due to the fact that in these simulations neither tolerances nor non-ideal behavior of circuit components have been considered.

Since the simulated circuits allows to reproduce the time shape of CIS events it is possible to infer the time shape of input signal for physics events using the reconstructed signals. When the signal is generated from the PMT the two capacitors of the CIS are grounded through a low impedance switch (18 _ohm_). The PMT is represented as a current source. The input current signal has been parametrized using equation 2. Varying the values of \(t_{r}\) and \(t_{f}\) it is possible to determine the output signal that matches the reconstructed signal for physics events. The input signal that better reproduce the reconstructed signal for physics events is obtained with \(t_{r}=4\) ns and \(t_{f}=15\) ns. In figure 13 the input current pulse (13(a)) and the output pulse compared to the reconstructed signal (13(b))are shown. It can be seen that the simulated signal in this case is practically indistinguishable from the reconstructed signal. In order to give an idea of the sensitivity of the output signal to the variation of the input signal shape in figure 14 are shown the simulated signals obtained for input signals having a fall time equal to 14, 15, 16 ns.

Figure 12: Comparison between the reconstructed CIS signal (dashed line) and the signal produced by the simulation (continuous line) for the capacitor value of \(100\,pf\) (a) and \(5.1\,pf\) (b).

Figure 13: Input current pulse (a) used to generate the simulated signal; comparison of reconstructed signal for physics events over imposed to the simulated signal (b).

Figure 14: Simulated signals obtained with input signals having fall times equal to 14 ns (dashed),15 ns (solid line) and 16 ns (dotted).

## 4 Conclusions

The shapes of signals for calibration events (CIS) and for events generated by the crossing of a particle through the calorimeter can be reconstructed using data acquired at the testbeam. The reconstructed shapes show that the signal produced by electronics for physics events is independent of the type of particle that generates it and of the gain of electronics. Also the CIS signal shape is independent of electronics gain and the reconstructed signals for the two capacitors of the calibration system are very similar. The comparison between the reconstructed signal for physics events and that one reconstructed for CIS events shows that the CIS signal is narrower with respect to that one of physics. Simulations of the shaper circuit have allowed to reproduce the reconstructed signals both for physics and for CIS events. The very good agreement between the reconstructed signal and the signal produced by simulation for physics events let infer that the signal that has been used as input in the simulation is a good approximation of the actual signal produced by the photo-multiplier.

## 5 Acknowledgments

We would like to thank the ATLAS group of the Enrico Fermi Institute University of Chicago, and in particular Dr. Fukun Tang for giving us very useful information on the readout electronics.

## References

* [1] ATLAS Collaboration, "ATLAS Tile Calorimeter Technical Design Report", CERN/LHCC/96-42, ATLAS TDR 3 (15 December 1996).
* [2]_Front-end Electronics for the ATLAS Tile Calorimeter_, K.Anderson,J.Pilcher, H.Sanders, F.Tang Enrico Fermi Institute, University of Chicago, Illinois, USA. S. Berglund, C. Bohm, S-O. Holmgren, K. Jon-And,Stockholm University, Stockholm, Sweden. G. Blanchot, M. Cavalli-Sforza, Institut de Fisica d'Altes Energies, Universitat Autonoma de Barcelona, Bellaterra, Barcelona, Spain.
* [3][http://hep.uchicago.edu/atlas/electr/3-in-1_prod/production.html](http://hep.uchicago.edu/atlas/electr/3-in-1_prod/production.html)
* [4][http://www.spectrum-soft.com/index.sht](http://www.spectrum-soft.com/index.sht)