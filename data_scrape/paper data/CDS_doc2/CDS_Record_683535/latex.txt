**ATLAS Internal Note**

**TILECAL-NO-077**

**July 31, 1996**

**Identification of b-jets with a low pT muon**

**using ATLAS Tile Calorimeter simulation data**

**and artificial neural networks technique**

A. Astvatsaturov, J. Budagov, V. Shigaev

_Joint Insililwie for Nuclarr Research, 141980, Dvna, Moscow region, Russia_

M. Bosman

_IFAE, Barcelona, Spain_

M. Nessi

_CERN, Geneva, CH-1211, Switzerland_

D. Pantea

_IAP, P.O.Box MG-6, Bucharest, Romania_

**Abstract**

The possibility to enhance the capability of ATLAS Tile Calorimeter to identify low \(p_{T}\) muons (\(2<p_{T}<5\) GeV/c) inside b-jets by the use of artificial neural networks technique is investigated in a systematic way. More than 20 models of neural net discriminators (NND) were applied to separation of gluon jets and b-jets (with a single soft muon inside a b-jet) at jet \(p_{T}=20\) and \(40\) GeV/c in the central region \(0<\eta<0.6\). Characteristics of NND are compared to those of the linear threshold discriminator (LTD) which performs jet classification by applying a cut to the summed energy deposition in the last depth of Tile Calorimeter. It is shown that at b-jet identification efficiencies \(0.80<\varepsilon_{b}<0.90\) the gluon jet rejection factor \(R_{g}\) is \(4\cdot 10\) times higher in NND case compared to LTD.

The results obtained are based on 2000 jets simulated with the use of ATLAS simulation programs.

Introduction

It was shown in [1], [2] that overall efficiency of b-jets tagging can be substantially increased if soft muons with \(p_{T}\) down to 2-3 GeV/c are efficiently identified inside jets. Such muons cannot be reliably registered by ATLAS muon detector because of significant probability to be absorbed in the calorimeter.

A way to increase b-tagging efficiency consists in using response data of ATLAS hadron calorimeter (HC) for identification of soft muons. Due to high penetration ability of muons the signal in the last depth (section or longitudinal sample) of the hadron calorimeters should be greater for jets with muons compared with jets without muons (gluon jets, light quark jets).

The task of separation between gluon jets and b-jets (a single soft muon inside a b-jet) was considered in [2] for jets with \(p_{T}=20\) and 40 GeV/c in the central region \(0<\eta<0.6\). It was shown that by imposing a cut on the deposited energy in the last HC section one can reach the rejection factor for gluon jets \(R_{g}=9\) (at \(p_{T}=20\) GeV/c) and \(R_{g}=4\) (at pT=40 GeV/c) with 95% efficiency of b-jets identification. Anticipation was also expressed that at a loss of 10% of b-jets the rejection factor for gluon jets could be pushed up into the region of 50 - 100 if information from the middle section of HC is used in the form of summed energy value of 2 adjacent cells with maximum deposit from a \(3\times 3\) cell window centered on the position (\(\eta_{m}\), \(\phi_{m}\)) of the cell with the highest deposited energy in the last HC section.

Our aim was to investigate in a systematic way the possibility to enhance the capability of ATLAS Tile Calorimeter to identify low \(p_{T}\) muons inside b-jets by the use of artificial neural networks (ANN) technique.

## 2 Investigation scheme

In what follows the b-jet events (calorimeter response to b-jets) will be refered to as signal events, and the gluon jet events - as background events respectively.

We have included a rather wide set of jet classifiers (discriminators) into our research program. The classifiers were naturally divided into groups, the study of each group constituted a separate step in our investigation scheme. The steps imply investigation of the next groups of discriminators:

**A.** Linear threshold discriminator (LTD) operating on summed energy deposition \(E_{4}\) in the last (4-4) section of HC.

**B.** Neural net discriminators (NND) operating on longitudinal profile of jet energy deposition in HC.

**C.** A series of neural net discriminators that make use of information on the distribution of cell energies inside \(3\times 3\) cell windows in the first and the middle HC sections (all windows centered on the position (\(\eta_{m}\), \(\phi_{m}\)) of the cell with the highest deposited energy in the last HC section).

**D.** A series of neural net discriminators that are extensions of discriminators from Group C. These discriminators make use of additional features related to: 1) joint distribution of the \(3\times 3\) cell window position and the jet axis in (\(\eta\), \(\phi\)) plane, 2) jet radius as estimated using HC response.

**E.** Neural net discriminators that operate on full spectrum of feature types used by discriminators from Groups A,B,C,D.

Assignment of a discriminator to a certain group does not depend on the discriminator architecture or its complexity and is guided solely by the type of event features used as inputs to the discriminator. For example, discriminators within Group C differ in the number of their inputs (see below).

In fact each discriminator in Groups C,D,E is a combined discriminator that performs jet classification in two consecutive stages:

_Stage 1._ An event is classified in LTD mode with the minimum cut threshold (MCT) applied to the summed energy deposition \(E_{4}\) in the last HC section (MCT value is defined by noise level). If \(E_{4}\) of an event is below MCT then the final decision is made at Stage 1: the event is classified as background event (i.e. gluon jet). Otherwise the final decision is made at Stage 2.

_Stage 2._ An event is classified in NND mode by applying a cut to the neural net output signal.

It follows from this two stage classification scheme that the upper bound\(\varepsilon_{b}^{max}\) of b-jet identification efficiency attainable without losing gluon/b-jet separation ability is imposed by characteristics of LTD discriminator. In our case \(\varepsilon_{b}^{max}=0.94\) for jets at \(p_{T}=20\) GeV/\(c\) and \(\varepsilon_{b}^{max}=0.96\) at \(p_{T}=40\) GeV/\(c\). The importance of minimizing additional loss of efficiency \(\varepsilon_{b}\) at Stage 2 becomes evident.

At Stage 2 only subsets of jet events that satisfy the condition \(E_{4}>MCT\) are used for training and testing neural nets. In estimating discriminator characteristics we followed the procedures descibed in details in [3], [4]. The obtained characteristics are later renormalized in regard to the whole sets of events to finally represent characteristics of the combined two stage discriminator.

In the present paper all results obtained with the use of neural nets are given in renormalized form.

## 3 Simulation data

The same data files were used in the present investigation and in [2]. We remind here some simulation conditions.

1. Single jets were generated in DICE with \(p_{T}=20\) and \(40\) GeV/c uniformly in \(\eta\) in the central region \(0<\eta<0.6\).
2. Gluon jets were chosen as background process.
3. For b-jets (signal events) some conditions were imposed at particle level at the moment of generation: a) only events containing one muon (accompanied by its own neutrino) were accepted; b) transverse momentum of the muon must be in the soft region \(2<p_{T}<5\) GeV/c.
4. For simulation, the Technical Proposal layout was used were Tile Barrel Calorimeter consisted of 4 longitudinal depths (sections) = along r axis in cylindrical coordinate system.
5. At each \(p_{T}\) value 500 b-jets and 500 gluon jets were generated.

Because of decision [5] to bring together two central depths of HC, the simulated cell energy depositions in these two HC depths were properly merged.

Distributions of summed energies deposited in each section of ATLAS calorimeter are shown in Fig.1, Fig.2. In comparison with the case of isolated muons and pions [3],[4] the present distributions for the two types of events are much more overlapped in each HC section.

## 4 Discriminators and their performance

Three-layered perceptrons with n input neurons (nodes) in the first layer, \(n_{h}\) neurons in a hidden layer and one output neuron in the third layer were selected for constructing neural net discriminators. Adjacent layers of the perceptrons are fully interconnected. A formula (n, \(n_{h}\), 1) will be used to depict the structure of such perceptrons. Actually throughout the present investigation two structures were used: (n, 4, 1) for jets at \(p_{T}=20\) GeV/\(c\) and (n, 6, 1) at \(p_{T}=40\) GeV/\(c\). The package JETNET [8] was used for training the perceptrons.

Inputs to the first layer of NND may be thought as components of n-dimensional vector that represents an event in n-dimensional feature space. Dimension n and ordering of input components are fixed for a particular NND. For neurons in the hidden and output layers the nonlinear neuron activation function \(g(a)=(1+\exp(-2a))^{-1}\) was chosen; hence the perceptrons perform nonlinear mappings of n-dimensional space into (0, 1) interval. During training phase the target value of the output neuron was put to 1 for b-jets and 0 for gluon jets. Training procedure iteratively adjusts weights of connections between neurons in order to minimize mean fit error MFE, i.e.

mean squared deviation of actual net output values \(O_{NN}(p)\) from the target values t(p) over the whole training set of events:

\[MFE=\frac{1}{2N_{p}}\sum_{p=1}^{N_{p}}(t(p)-O_{NN}(p))^{2}\]

where p denotes events.

One pass over training sample constitutes a step of the training procedure; the step is usually called an "epoch". Using a trained perceptron one gets one-dimensional distributions of net output values for b-jets and gluon jets. By applying variable thresholds to neural net output values one gets estimates of important characteristics of discriminators such as:

* \(\varepsilon_{b}-\)efficiency of signal events recognition, i.e. the probability that a b-jet event be correctly classified,
* \(\alpha_{b}-\)efficiency of signal events recognition, i.e. the probability that a b-jet event be misclassified (\(\alpha_{b}=1-\varepsilon_{b}\)),
* \(\beta_{g}-\)survival probability for background events, i.e the probability that a gluon jet event be misclassified,
* \(R_{g}=1/\beta_{g}-\)rejection factor for gluon jets.

Components of input vector for a neural net are usually called event features. Features are functions of raw data items (data items are cell energies of HC response in our case). Evaluation of feature values is an operation called preprocessing of measurement data (or source data).

In the present investigation the performance of various discriminators is considered here in the order defined by our investigation scheme. Since the total number of discriminators is great, we restrict ourselves to presenting only one characteristics for each discriminator, namely the dependence of \(R_{g}\) on \(\varepsilon_{b}\). This functional dependence will be given in the form of plots (\(R_{g}\), \(\varepsilon_{b}\)) prepared with the use of simulated jets.

**Group A.** This group includes the single discriminator LTD that performs classification by thresholding the summed energy deposition \(E_{4}\) in the last HC section.

Distributions of \(E_{4}\) are presented in Fig.3 for both types of simulated jets at \(p_{T}=20\) and \(40\) GeV/c. Characteristics of LTD are estimated in a simple way by applying a variable cut threshold to these distributions. The corresponding (\(R_{g}\), \(\varepsilon_{b}\)) plots for both \(p_{T}\) values are given in Fig.4.

One can see that at \(p_{T}=20\) (\(40\) GeV/c the maximum efficiency \(\varepsilon_{b}^{m\pi}\) attainable without losing jet separation ability is equal to \(0.94\) (\(0.96\)). At these efficiencies the value of gluon jet rejection factor is \(R_{g}(\varepsilon_{b}^{max})=9(4)\). For LTD discriminator, \(R_{g}\) appears to be slowly decreasing function of the argument \(\varepsilon_{b}\).

**Group B.** We have included 2 models of neural nets discriminators into this group.

The first one, labeled "var 0, inp 3", uses three values of summed energy depositions \(E_{1}\), (\(E_{2}+E_{3}\)), \(E_{4}\) in HC sections. NND(var 0, inp 3) is similar to NND\({}_{1}\) discriminator of the "longitudinal" type applied to solving \(\pi/\mu\) separation task in [3],[4].

The second model, labeled "var 1, inp 3", differs from NND(var 0,inp 3) in that the third entry \(E_{4}\) is substituted by \(\varepsilon_{max}^{(4)}-\)the maximum energy deposit among cells in the last HC section.

Characteristics for both NNDs of Group B are presented in Fig.5 for jet \(p_{T}=20\) and \(40\) GeV/c

**Group C.** For all NND models of this group the event features used as inputs are evaluated as functions of deposited energies in those cells of the first two HC sections that lie inside the 3x3 cell window centered on the position of \(\varepsilon_{max}^{(4)}\) cell in (\(\eta\), \(\phi\) ) plane. The series of NND models are subdivided into 3 subgroups.

Subgroup C1. This subgroup includes one NND model, labeled "var 2, inp 3". The input features for this model are as following.

NND(var 2,inp 3): \(E_{c5}^{(1)}\), \(E_{c9}^{(2+3)}\), \(\varepsilon_{max}^{(4)}\), where \(E^{(1)}_{\varepsilon^{(3)}}\) -the summedenergy deposition in all 9 cells of the \(3\times 3\) cell window in HC section 1, and \(E^{(2+3)}_{\varepsilon^{(2+3)}}\) -the corresponding value for the middle section of HC.

In Fig.6 characteristics are presented for the NND of Subgroup C1 at \(p_{T}=20\) and \(4\,0\) GeV/c.

Subgroup C2. This subgroup indudes 6 NND models:

NND(var k,inp 3), k=3,...,7 and NND(var 8,inp 2).

Along with \(e^{(4)}_{max}\), the input features used by models of this subgroup are evaluated as functions of energy depositions in various subsets of cells inside the \(3\times 3\) cell window. The subsets of cells and the input features are defined as following.

* NND(var 3,inp 3). Inputs: \(E^{(1)}_{\varepsilon^{(1)}}\), \(E^{(2+3)}_{\varepsilon^{(3)}}\), \(e^{(4)}_{max}\) The value \(E_{\varepsilon^{(3)}}\) is equal to the summedenergy deposition in 5 cells whose locations form a cross in the center of the \(3\times 3\) cell window.
* NND(var 4,inp 3). Inputs: \(E^{(1)}_{\varepsilon^{(2)}}\), \(E^{(2+3)}_{\varepsilon^{(2)}}\), \(e^{(4)}_{max}\) \(E_{\varepsilon^{(2)}}\) is evaluated as the maximum summedenergy deposition among pairs of adjacent cells, one cell of a pair being the central cell of the \(3\times 3\) cell window.
* NND(var 5,inp 3). Inputs: \(E^{(1)}_{\varepsilon^{(1)}}\), \(E^{(2+3)}_{\varepsilon^{(1)}}\), \(e^{(4)}_{max}\) The value of \(E_{\varepsilon^{(1)}}\) is equal to energy deposition in the central cell of the \(3\times 3\) cell window.
* NND(var 6,inp 3). Inputs: \(E^{(1)}_{\varepsilon^{(2)}}\), \(E^{(2+3)}_{\varepsilon^{(2)}}\), \(e^{(4)}_{max}\) The value of \(E_{\varepsilon^{(2)}}\) is equal to the maximum summedenergy deposition among pairs of adjacent cells in the \(3\times 3\) cell window.
* NND(var 7,inp 3). Inputs: \(E^{(1)}_{\mathrm{ct}}\), \(E^{(2+3)}_{\mathrm{ct}}\), \(e^{(4)}_{max}\) The value of \(E_{\mathrm{ct}}\) is equal to the maximum summedenergy deposition in a \(2\times 2\) cell square among four such squares inside the 3x3 cell window.
* NND(var 8,inp 2). Inputs: \(E^{(2+3)}_{\varepsilon^{(2)}}\), \(e^{(4)}_{max}\) This model does not use information from HC section 1. It may be considered as truncated version of NND(var 6,inp 3) model.

Characteristics for NNDs of Subgroup C2 at \(p_{T}=20\) and \(4\,0\) GeV/c are presented in Fig.7.

Subgroup C3. This subgroup indudes 6 NND models:

NND(var k,inp 5), k=3,...,7 and NND(var 8,inp 3).

Compared with Subgroup C2, the lengths of input vectors of these models are enlarged by adding information on summed energies \(E_{\varepsilon^{(3)}}\) in the \(3\times 3\) cell windows. The list of input features is as following.

* NND(var 3,inp 5): \(E^{(1)}_{\varepsilon^{(1)}}\), \(E^{(1)}_{\varepsilon^{(2+3)}}\), \(E^{(2+3)}_{\varepsilon^{(2+3)}}\), \(e^{(4)}_{max}\)
* NND(var 4,inp 5): \(E^{(1)}_{\varepsilon^{(2)}}\), \(E^{(1)}_{\varepsilon^{(3)}}\), \(E^{(2+3)}_{\varepsilon^{(2+3)}}\), \(e^{(2+3)}_{\varepsilon^{(3)}}\), \(e^{(4)}_{max}\)
* NND(var 5,inp 5): \(E^{(1)}_{\varepsilon^{(1)}}\), \(E^{(1)}_{\varepsilon^{(3)}}\), \(E^{(2+3)}_{\varepsilon^{(1)}}\), \(E^{(2+3)}_{\varepsilon^{(3)}}\), \(e^{(4)}_{max}\)
* NND(var 6,inp 5): \(E^{(1)}_{\varepsilon^{(2)}}\), \(E^{(1)}_{\varepsilon^{(3)}}\), \(E^{(2+3)}_{\varepsilon^{(2)}}\), \(E^{(2+3)}_{\varepsilon^{(3)}}\), \(e^{(4)}_{max}\)
* NND(var 7,inp 5): \(E^{(1)}_{\varepsilon^{(1)}}\), \(Characteristics for NNDDs of Subgroup C3 are presented in Fig.8.

In total there are 13 NND models in Group C. All the models were trained and tested at jet \(p_{T}=40\) GeV/c. Because of moderate size of event samples available for training NNDs at \(p_{T}=20\) GeV/c, only models with short input vector (Subgroups C1, C2) were investigated at this \(p_{T}\) value.

**Group D.** All discriminators of this group are extensions of NND discriminators of the previous Group C. The total number of NND models in Group D is 13.

To get a NND model of the present group, the input vector of the corresponding model from Group C is extended by adding 4 features that are related with distributions in (\(\eta\), \(\phi\)) plane. The additional inputs are \(\eta_{m}\), \(\delta\eta_{m}\), \(r_{m}\), \(R_{1,J}\), where

(\(\eta_{m}\), \(\phi_{m}\)) - parameters of the cell \(e_{max}^{(4)}\) with the highest energy deposit in the last depth of HC;

(\(\eta_{1,J}\), \(\phi_{1,J}\)) - parameters of the jet axis estimated with the use of active cells in the first HC section,

\(\delta\eta_{m}=(\eta_{m}-\eta_{1,J})\), \(\delta\phi_{m}=(\phi_{m}-\phi_{1,J})\), \(r_{m}=\sqrt{\delta\eta_{m}^{2}+\delta\phi_{m}^{2}}\) -are deviations of the cell \(e_{m\,ar}^{(4)}\) from the jet axis in (\(\eta\), \(\phi\)) plane,

\(R_{1,J}\) - estimation of the jet radius in (\(\eta\), \(\phi\)) plane with the use of energy depositions in cells of the first HC section.

In estimating values of \(\eta_{1,J}\), \(\phi_{1,J}\), \(R_{1,J}\) we followed the procedures proposed in [6], [7] for reconstruction of jet parameters using calorimetric data:

\[\eta_{1,J}=\frac{1}{E_{T,J}}\times\sum_{i}e_{T,i}\eta_{i}\]

\[\phi_{1,J}=\frac{1}{E_{T,J}}\times\sum_{i}e_{T,i}\phi_{i}\]

\[E_{T,J}=\sum_{i}e_{T,i}\]

\[R_{1,J}=\frac{1}{E_{T,J}}\times\sum_{i}r_{i}e_{T,i}\,\]

where \(e_{T,i}\) - transverse energy deposited in i-th cell of HC section 1.

In Fig.9 distributions of \(\eta_{m}\), \(\delta\eta_{m}\), \(r_{m}\) and \(R_{1,J}\) at \(p_{T}=40\) GeV/c are presented for subsets of gluon and b-jets in which the condition \(0.4<e_{m\,ar}^{(4)}<1.2\) GeV is satisfied.

In Fig.10 characteristics are presented for those discriminators of Group D at \(p_{T}=40\) GeV/c which are extensions of NN discriminators from Subgroup C3. It should be noted that in comparison with Subgroup C3 the value of \(R_{g}\) attained by NNDs of Group D is observed at lower efficiencies \(\varepsilon_{b}<0.8\).

**Group E.** All discriminators of this group are extensions of NND discriminators of Group D. The corresponding input vectors used in Group D are extended by adding 2 features: \(E_{1}\) and \((E_{2}+E_{3})\), where \(E_{R}\) is the summed energy deposition in k-th HC section. The input vectors of discriminators in Group E contain values of 11 features.

Though formally the Group E may include many NND models, we have tested only one NND model with full length input vector at \(p_{T}=40\) GeV/c, namely NND (var 6, inp 11). Its characteristics are presented in Fig.11.

Subgroup E1. This subgroup is a truncated version of NNDs from Group E. The following features are used as inputs to the perceptron (6, 4, 1) trained at \(p_{T}=20\) GeV/c : \(E_{c2}\), \(e_{max}^{(4)}\), \(\eta_{m}\), \(\delta\eta_{m}\), \(r_{m}\), \(R_{1,J}\). Characteristics of NND(var 6, inp 6) are presented in Fig.12.

Neural nets were trained using up to \(10^{4}\) epochs in a training session. As an example we present in Fig.13 the dynamics of mean fit errors MFE as functions of the current epoch number in training sessions for several NNDs.

[MISSING_PAGE_FAIL:7]

## 5 Conclusion

1. The use of linear threshold discriminator (LTD) that performs classification of jets by applying a cut on summed energy deposition in the last depth of Tile Calorimeter leads to poor performance: at b-jet identification efficiencies \(0.80<\varepsilon_{b}<0.95\) the gluon jet rejection factor \(R_{g}\) lies in the range 13 - 17 (for \(p_{T}=20\) GeV/c) and in the range 6 - 8 (for \(p_{T}=40\) GeV/c).
2. Results on more than 20 models of neural net discriminators (NND) show appreciably higher performance of NND compared to LTD. At b-jet identification efficiencies \(0.80<\varepsilon_{b}<0.90\) the gluon jet rejection factor \(R_{g}\) is 4 - 6 times higher for NND at \(p_{T}=20\) GeV/c and 5 - 10 times higher at \(p_{T}=40\) GeV/c.
3. To reveal the full potential of ANN approach to solvingjet separation tasks, greater samples of events are needed to allow using neural nets of a size bigger than in the present investigation.
4. Accepting the present results as an estimate of lower bounds of NND performances, one can state that the following inequalities should hold for the gluon jet rejection factor \(R_{g}(\varepsilon_{b})\) attained by NND: (a) at \(p_{T}=20\) GeV/c : \(R_{g}(0.90)\geq 50\), \(R_{g}(0.85)\geq 100\) (b) at \(p_{T}=40\) GeV/c : \(R_{g}(0.90)\geq 30\), \(R_{g}(0.85)\geq 70\)

## References

* [1] J.Budagov, I.Chirikov-Zorin, A.Pantea, D.Pantea, O.Pukhov, M.Bosman, M.Nessi, "B-meson tagging improvement using HCAL information", ATLAS Internal Note, TILECAL-NO-023
* [2] J.Budagov, D.Pantea, M.Bosman, M.Nessi "Low \(p_{T}\) Muons in B-jets in ATLAS Tilecal", ATLAS Int.Note TILECAL-NO-062, (1995)
* [3] A.Astvatsaturov, J.Budagov, I.Chirikov-Zorin, D.Pantea, A.Paplevka, V.Shigaev, S.Sushkov, M.Bosman, M.Nessi "Improvement in \(\pi/\mu\) separation at low \(p_{T}\) in ATLAS Hadron Calorimeter using artificial neural networks technique", ATLAS Int.Note, TILECAL-NO-060 (1995)
* [4] A.Astvatsaturov, J.Budagov, I.Chirikov-Zorin, D.Pantea, A.Paplevka, V.Shigaev, S.Sushkov, M.Bosman, M.Nessi "Improvement in \(\pi/\mu\) separation of isolated muon and pions at low \(p_{T}\) in ATLAS Hadron Calorimeter using artificial neural networks technique", Commun. of JINR, E10-95-476, Dubna, 1995
* [5] ATLAS, "Technical Proposal for a General-Purpose pp Experiment at the Large Hadron Collider at CERN", CERN/LHCC/94-43, LHCC/P2 (1994)
* [6] F.Abe at al. "Measurement of Jet Shapes in p\(\bar{p}\) Collisions at \(\sqrt{s}\) = 1.8 TeV", Phys. Rev. Lett. **70**, 713 (1993)
* [7] S.D.Ellis, Z.Kunszt and D.E.Soper", One-Jet Inclusive Cross Section at Order \(\alpha_{s}^{3}\): Quarks and Gluons", Phys. Rev. Lett **64**, 2121 (1990)
* A versatile Artificial Neural Network Package", _Comp. Phys. Commun._**81** (1994) 185