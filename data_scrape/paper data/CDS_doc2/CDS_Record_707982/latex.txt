**Comparisons of the Electron and Muon Testbeam Response of the ATLAS Liquid Argon Calorimeters with GEANT4 Simulations**

D. Benchekroun\({}^{a}\), J. Collot\({}^{b}\), G. Karapetian\({}^{c}\), A.E. Kiryunin\({}^{d,e}\), J. Kish\({}^{f}\), K. Kordas\({}^{g}\)1, M. Leltchouk\({}^{h}\), P. Loch\({}^{i}\), R. Mazzini\({}^{c}\), S. Negroni\({}^{h}\), G. Parrour\({}^{g}\), D. Salihagic\({}^{d,j}\), W. Seligman\({}^{h}\), A. Soukharev\({}^{k}\), P. Strizenec\({}^{d,f}\), G. Unal\({}^{g}\)

Footnote 1: Now at University of Toronto, Toronto, Canada.

\({}^{a}\)_Universite Hassan II, Casablanca-Maarif, Morocco_

\({}^{b}\)_Laboratoire de Physique Subatomique et de Cosmologie, Grenoble, France_

\({}^{c}\)_Universite de Montreal, Montreal, Quebec, Canada_

\({}^{d}\)_Max-Planck-Institut fur Physik, Werner-Heisenberg-Institut, Munich, Germany_

\({}^{e}\)_Institute for High Energy Physics, Protvino, Russia_

\({}^{f}\)_Institute of Experimental Physics, Kosice, Slovakia_

\({}^{g}\)_Laboratoire de l'Accelerateur Lineaire, Orsay, France_

\({}^{h}\)_Newis Laboratories, Columbia University, Irvington, New York, USA_

\({}^{i}\)_University of Arizona, Tucson, Arizona, USA_

\({}^{j}\)_University of Montenegro, Podgorica, Montenegro, Yugoslavia_

\({}^{k}\)_Budker Institute of Nuclear Physics, Novosibirsk, Russia_

January 27, 2004

GEANT4, a new simulation toolkit, is now in use by the different sub-detectors which are currently being built and tested for the ATLAS experiment. The validation of the GEANT4 electromagnetic physics is done by comparing the response of the various modules of the ATLAS liquid argon calorimeters to electron and muon test beams to the results of GEANT4 simulations. Comparisons to the corresponding GEANT3 predictions has been done as well. This note presents the status of the work on this validation.

Introduction

The ATLAS Collaboration is building a multi-purpose detector for a future experiment at the Large Hadron Collider (LHC) at CERN. Many physics studies at the LHC will necessitate an accurate detector simulation program, with which the detector and physics performance can be evaluated in detail. Needless to say, the simulation played a crucial role in the design phase of the ATLAS detector and more recently in understanding the impact of changes in detector layout on the physics performance. In addition to describing the detector geometry and tracking particles through it, the simulation must provide tools to visualise the detector components, and to simulate and record the response of the sensitive elements of the detector. Previously, ATLAS has heavily used GEANT3 [1], a FORTRAN-based simulation program, for these purposes.

Having in mind that the software is vitally important to the whole experiment's success, and must be maintained for a lifetime of about 20 years, the ATLAS collaboration has decided to optimise quality and assure long-term maintenance by switching from the FORTRAN-based to object-oriented software, implemented in the C++ programming language. In this transformation it has started to use the GEANT4 package [2]. The other important motivation of its use is that GEANT4 is now one of few simulation packages in which physics modeling is still improved.

GEANT4 is a freely distributed simulation toolkit, based on software engineering techniques and object-oriented technology, written in C++. The package was developed in 1990's by a world-wide collaboration, and since 1999 (after the first production releases) it is maintained by the international GEANT4 Collaboration.

The implementation of the ATLAS detector in the GEANT4 framework has been ongoing since the end of 1999. Part of this process is the validation of the physics models in GEANT4, carried out for different ATLAS sub-detectors. This is the joint project of the ATLAS and GEANT4 collaborations, launched in 2000. The validation is based on the comparison of results of GEANT4 based simulations with experimental results, obtained during numerous beam tests of modules of different sub-detectors. The comparison with GEANT3 predictions is also the part of the project.

This note is a status report of the work on the validation of the GEANT4 electromagnetic physics carried out between 1999-2002. The comparisons have been done in three ATLAS Liquid Argon (LAr) calorimeters, namely the electromagnetic barrel calorimeter (EMB), the hadronic end-cap calorimeter (HEC) and the forward calorimeter (FCal). The validation includes comparisons of relevant calorimeter performance parameters like the average response, energy resolution and shower shapes. Results from these comparisons for electron and muon signals in the studied calorimeters are presented in this note. The current status of this work has been regularly reported in several conferences [3].

The outline of the note is as follows: In Section 2, a short description of GEANT4 is given. In Section 3, the ATLAS LAr calorimeters, the testbeam setups and simulation conditions are described. Results of comparisons between simulations and experimental data are shown for electrons in Section 4. In Section 5, the corresponding results for muons are presented. Finally in section 6, conclusions and plans for future investigations are drawn.

The GEANT4 Detector Simulation Toolkit

GEANT4 started out as a new project using a lot of the experience gained in the development of previous simulation programs. At the same time, improvements and more recent data have been incorporated. In this section some differences between GEANT4 and GEANT3, which can influence the simulation of electromagnetic physics in calorimetry, are presented.

### General Differences

The most important difference is the control of particle tracking and production of secondaries. GEANT3 and GEANT4 use different parameter spaces for these purposes. In GEANT4, all particles are tracked to zero kinetic energy, while the production of secondaries is controlled by a minimum range requirement: secondaries with the range below a specified cut are not tracked. The range can be translated into a minimum production energy threshold in a given material. In GEANT3, both tracking and production energy thresholds are implemented.

The physics processes are implemented in GEANT4 in a very open scheme. Importantly, there is no "default" physics in GEANT4. While this allows for easy implementation of new or alternate physics models, it imposes the responsibility on clients to choose the proper set of processes for their tasks.

GEANT4 uses a new Multiple Scattering model, to simulate the multiple scattering of charged particles in matter. This model does not use the Moliere formalism [4] applied in GEANT3, but is based on the more complete Lewis theory [5]. The model simulates the scattering of the particle after a given step, and also computes the path length correction and the lateral displacement.

### Electromagnetic Processes

Most of the electromagnetic physics in GEANT4 has been derived from models of GEANT3, with some improvements and new models added. The energy loss process in GEANT4 contains the sum of ionization and bremsstrahlung, which are not independent as in GEANT3. The bremsstrahlung process in GEANT4 includes also the Landau-Pomeranchuk-Migdal suppression effect and the dielectric suppression of bremsstrahlung [6].

There is an alternate model (Photo-Absorption Ionization model) for energy loss which is more suitable for gases and thin absorbers. New models, based on the latest theoretical cross-sections and not on parameterisations, are used in muon incident direct \(e^{+}e^{-}\) pair production, nuclear interactions and bremsstrahlung processes. The correction due to muon bremsstrahlung on electrons is added in the muon ionization process.

The ATLAS Liquid Argon Calorimeters

The ATLAS detector at the future Large Hadron Collider features a liquid argon calorimeter system housed in three cryostats, one barrel and two end-caps [7, 8, 9]. The view of the ATLAS calorimeter system is shown in Fig.1. In this section, the description of the LAr calorimeter used for the GEANT4 physics validation is presented. Details of test-beam setups and peculiarities of their implementation in the GEANT packages are also discussed. The conditions for simulation are summarised at the end of the section.

### The Electromagnetic Barrel Calorimeter

The Electromagnetic Barrel Calorimeter (EMB) [7] is a sampling calorimeter, with absorber and electrode plates interleaved with LAr gaps. These plates have an accordion shape with 1024 of them arranged in a cylindrical configuration, providing hermetic and uniform azimuthal coverage of the proton-proton interaction region at the center of the ATLAS detector. The thickness of sensitive gaps is constant, that is provided by an

Figure 1: The ATLAS calorimeters.

increasing wave amplitude of the accordion and a varying folding angle.

Absorber plates are lead-stainless-steel converters. The thickness of lead is 1.5 (1.1) mm for pseudorapidity \(|\eta|<0.8\) (\(>0.8\)), but the thickness of the glue material changes in order to achieve a uniform 2.16 mm thickness for the absorber plates for all pseudorapidity values. The lead thickness is smaller for higher \(|\eta|\), so that the amount of material, in number of radiation lengths viewed by the incident electron, does not vary drastically over the pseudorapidity coverage of the EMB calorimeter. This is done to improve the sampling frequency and hence the energy resolution.

Readout electrodes (copper-polyamide multi-layer boards) are centered in gaps between absorber plates by low density honeycomb spacers, leaving two active liquid argon gaps of 2.1 mm on each side. The ionization signals from these two gaps are summed on the readout electrode. The calorimeter is divided into three radial compartments. Fully projective readout cells are defined in pseudorapidity by the electrode structure in each of those compartments. For azimuthal segmentation a number of adjacent electrodes are summed together. In the middle compartment, at a depth between 6 and 24 radiation lengths (\(X_{0}\)), the dimension of the readout cells is \(\Delta\eta\times\Delta\varphi=0.025\times(4\times 2\pi/1024)\approx 0.025 \times 0.025\). The total thickness of the calorimeter is above 24 \(X_{0}\). A presampler in front of the calorimeter is used to correct for the energy loss upstream.

Each half barrel is constructed with 16 modules, each containing 64 accordion plates. A few of these modules have been exposed to test beams from CERN SPS, and their response to electrons and muons has been studied [10].

Since all the parameters of the accordion structure (the length of the straight parts, the radii of curvature for the fold regions, the thickness of the absorber plates and electrode plates, etc.) are known, the construction of the geometry of the calorimeter can be done piece-by-piece. GEANT4, like its predecessor GEANT3, provides a collection of standard volumes, like boxes, cylinders, trapezoids and so on. The approach taken is the construction of the calorimeter geometry with the use of a large number of such elementary volumes, properly placed in space to define the accordion plates. This is the so-called _static_ description of the geometry. Each volume is included in a larger mother volume in a russian-doll configuration.

Due to the use of a large number of elementary volumes, this geometry construction occupies a lot of computer memory. There are means, though, to reduce memory usage for the static geometry significantly. One can optimise the tracking by dividing the geometry into "voxels" and checking in which voxel the track is, instead of in which real volume. Thus a grid of these artificial volumes is constructed and GEANT4 executes the tracking in two steps. It first finds the grid cell the particle is in, and then determines the volume within the grid cell to which the particle belongs. With appropriate optimisation of the size of the grid cell, the memory consumption can be reduced from 35 Megabytes (required by the static geometry) to 10 Megabytes for a test beam setup incurring no penalty in CPU consumption.

Fig.2 shows a part of the EMB testbeam module setup in the GEANT4 description. All known geometrical details are implemented. These include the material for electronics in front of the presampler or the calorimeter (exact cable composition, mother boards, etc.) and the exact description of the readout channel structure. As for GEANT3, the GEANT4 geometry implementation accounts for "sagging" of the absorbers. Finally, to introduce the same level of details in GEANT4 as in GEANT3 simulations, the recorded signals are induced currents, reflecting the electric field variations at the accordion folds, and a realistic electronic readout chain.

A comparison of the simulation time for electromagnetic showers between the two GEANT versions indicates that GEANT4 takes about 1.7 times longer than GEANT3, after some optimisations. This estimate was obtained with GEANT4 version 3.1.

### The Hadronic End-Cap Calorimeter

The Hadronic End-Cap Calorimeter (HEC) [7] is a sampling calorimeter with flat copper absorber plates. The HEC is structured in two wheels (HEC1 and HEC2), each wheel consisting of 32 modules. The overall mechanical structure is maintained by seven stainless steel tie rods in each module. Annular spacers define 8.5 mm gaps between the absorber plates. Each wheel has an outer diameter of about 4 m, and a depth of 0.82 m (HEC1) or 0.96 m (HEC2). The thickness of the copper absorber plates is 25 mm for HEC1 and 50 mm for HEC2. The liquid argon gaps are instrumented with a read-out structure, based on the principle of an electrostatic transformer (EST) [11]. The transverse granularity of the calorimeter is \(\Delta\eta\times\Delta\varphi=0.1\times 2\pi/64\) (\(0.2\times 2\pi/32\)) for \(|\eta|<2.5\) (\(|\eta|>2.5\)). It has four longitudinal compartments and its total thickness is \(\sim\)103 \(X_{0}\) and above 10 absorption lengths (\(\lambda\)).

During the years 2000-2001, the serial calorimeter modules were exposed in test beam as a part of standard quality control procedure during HEC construction. The beam tests have been carried out with the H6 beam line of the CERN SPS, using secondary and

Figure 2: The ATLAS Electromagnetic Barrel Calorimeter in GEANT4. The setup includes the cryostat walls, the presampler, cables and other components of the readout chain, all located at the front face of the module. Right-hand plot: more detailed view of absorber plates.

tertiary beams. The beam line was instrumented with scintillator counters and scintillator walls for trigger building, and four multi-wire proportional chambers for impact position and angle determination. There were more than 2200 runs taken, each run typically consisting of 20,000 triggered events. Used energy ranges were 6-150 GeV for electrons, 10-200 GeV for charged pions and 120, 150, 180 GeV for muons. The collected data were analysed using the standard digital filtering technique and signal reconstruction. All details, as well as data analysis results can be found in Reference [12].

Comparisons of experimental data with detailed Monte Carlo simulations have been performed. A special program [13], based on GEANT3 package, was developed and routinely used. New code [14] was written for the GEANT4 based simulation of the HEC testbeam. The geometry of the testbeam setup described in GEANT4 is identical to GEANT3 which allows for direct comparison of results with least biases due to possible differences in the geometry.

The geometry description is very detailed. The HEC module geometries include not only the copper plates and LAr gaps, but also the polyamide electrodes and copper pads. The cryostat and all beam elements, such as multi-wire proportional chambers and scintillator counters (extended over the distance of 30 m), are included as well. The description also contains virtual leakage detectors, placed laterally and longitudinally around the actual HEC modules to estimate the energy leakage. The usage of these leakage detectors also speeds up the simulation, as all particles entering them are immediately stopped, with their energy deposited on the spot. The GEANT4 based drawing of the HEC modules in the testbeam cryostat is shown in Fig.3.

Figure 3: The view of HEC modules in a testbeam cryostat in GEANT4.

### The Forward Calorimeter

The Forward Calorimeter (FCal) is a high density calorimeter, which is fully integrated into the end-cap cryostat as shown in Fig. 1. It consists of three modules, one electromagnetic (FCal1) and two hadronic modules (FCal2 and FCal3). Each of the modules is a cylinder of about 45 cm depth and 90 cm diameter. All modules feature tubular thin gap electrodes, which in case of FCal1 are a copper tube/rod assembly with a 250 \(\mu\)m gap for the liquid argon, maintained by a PEEK fiber wound around the tube. The electrodes are arranged in a hexagonal pattern in the bulk copper absorber, which is built out of 18 stacked copper plates. The total number of electrodes in FCal1 is 12260, summed in two stages into about 1000 readout channels. The module is about 28 \(X_{0}\) and 2.4 \(\lambda\) deep.

The hadronic modules have tungsten rods in the electrodes, with a liquid argon gap of 350(500) \(\mu\)m in FCal2(3), respectively. The gap is again maintained by PEEK fiber of appropriate thickness. The number of electrodes in FCal2(3) is 10200(8224), summed into 500(250) readout channels. The electrodes are arranged in a similar hexagonal pattern as in FCal1, with the interstitial space between the electrode tubes filled with tungsten slugs of appropriate shape. The hadronic modules are therefore very dense, and each nearly 100 \(X_{0}\) deep for electrons and photons, and about 4 \(\lambda\) for hadrons. More details on the design of the FCal modules can be found in Reference [7, 9].

The design principle of the FCal readout geometry has been tested with several prototypes in testbeam experiments with electrons at CERN [15]. Final prototypes for FCal1 and FCal2, the so-called Module 0's, have been designed and built in 1998 for an extended testbeam experiment in the summer of that year. Mechanically, the FCal Module 0's are full depth, quarter segments of the final devices. For economical reasons, and at no penalty for the signal studies, the instrumented volume of FCal1 Module 0 is actually only 3/16 of the full ATLAS FCal1, while FCal2 Module 0 is completely instrumented (1/4 of the ATLAS FCal2). More details of the modules and experimental results from the electron runs can be found in Reference [16].

The relevant module for studies of the electron signal is FCal1 Module 0, but the hadronic FCal2 Module 0 has been used in the testbeam to select electrons. The testbeam setup in the GEANT4 simulation therefore contains both modules in great detail, including about 2300 FCal1 and about 2500 FCal2 electrodes each individually described and positioned. To avoid biases, the actually measured hardware dimensions, and the hardware readout database, have been used directly in both the GEANT4 and GEANT3 geometry descriptions. Some simplifications have to be made in the geometry descriptions to keep the simulation programs efficient. The most important one is the bulk absorber in FCal2 Module 0. Here the several hundred thousand tungsten slugs filling the space between the electrode tubes have not been described individually2, but rather as a mixture of the slugs and the inactive liquid argon surrounding them.

Footnote 2: The exact position of any of those slugs is not known after assembly.

Relevant external detectors (such as a tail catcher, proportional chambers, veto and muon counters) and inactive materials are also described in some detail in the testbeam simulation. Fig.4 shows the implementation of the FCal testbeam setup in GEANT4.

Figure 4: The FCal testbeam setup around the cryostat in GEANT4.

### Simulation Parameters

As discussed in Section 2.1, GEANT3 and GEANT4 use different variable spaces for termination of a tracked particle and secondaries production in inelastic interactions.

For GEANT3 based simulations of the various studied setups, the tracking thresholds for electrons, positrons and photons are 100 keV for EMB and HEC, and 10 keV for the FCal. The secondary production thresholds are 100 keV for \(e^{\pm}\) in EMB, 1 MeV for \(e^{\pm}\) and \(\gamma\) in the HEC, 10 keV for \(e^{\pm}\) in the FCal, and 10 keV for \(\gamma\) in the EMB and FCal.

In the version of GEANT4 used for current simulations, only one range threshold at a time is specified for all secondary particles and all materials in a given setup. In the EMB, 30 \(\mu\)m is used, which corresponds to an energy threshold of 112 (41) keV for \(e^{\pm}\) and 13 (1.1) keV for \(\gamma\) in lead (argon). The selected minimum range in the HEC is 20 \(\mu\)m, which corresponds to an energy threshold of about 91 (32) keV for \(e^{\pm}\) and 3.1 (0.99) keV for \(\gamma\) in copper (argon). Most of the GEANT4 FCal electron signals have been simulated with 500 \(\mu\)m range threshold, which corresponds to about 764 (216) keV for \(e^{\pm}\) and 17 (4.4) keV for \(\gamma\) in copper (argon).

Results for Electrons

### Electrons in the EMB Calorimeter

Numerous tests with electrons as primary particles have been performed in the EMB. Version 4.1 of GEANT4 has been used for these studies. Reconstruction of the energy of electrons has been done, following the experimental procedure, applied to testbeam data [10], including clustering and longitudinal weighting.

#### 4.1.1 Electromagnetic shower profiles

For comparison between GEANT3 and GEANT4 descriptions, electron shower profiles in the EMB calorimeter have been examined. Features of spatial energy distributions both along and perpendicular to the initial electron track have been studied for this purpose. The Moliere Radius, \(R_{mol}\), can be determined from the lateral shower profile. The expected value is between about 70 mm (LAr alone) and about 11 mm (lead). This value depends on the pseudorapidity in the calorimeter. For example, \(R_{mol}=45.2\) mm at \(\eta=0.350\) and 57.1 mm at \(\eta=1.125\) in GEANT4.

For 10 and 100 GeV electrons, the Moliere Radius in the EMB is found to be about 10 % larger in GEANT3 than in GEANT4. This discrepancy is independent of the direction or energy. The mean depth of the longitudinal deposited energy, as measured from the entry point of the initial electron into the calorimeter, is slightly greater in GEANT3 than in GEANT4 by up to 3 %. Again, this result does not depend on pseudorapidity and energy values. Therefore, electromagnetic showers in the EMB are more compact in both spatial extensions in the GEANT4 simulation than in GEANT3.

Studies of the electromagnetic longitudinal shower profile included comparisons between GEANT predictions and the corresponding data [10]. The relative signal contributions from the three EMB depth compartments S1, S2, and S3, and the presampler (PS) are shown for the experiment, GEANT3 and GEANT4 in Fig.5. The general dependence of the signal ratios on the impact direction in the various compartments of the EMB (except S3) is quite well reproduced by GEANT4.

As an illustration, a sample of results from GEANT4 simulations is given in Table 1. For the back sampling S3, the relative deposited energy is of the order of few percent at most. Moreover one could not exclude some cross-talk signal from the S2 to the S3 compartment, then modifying a bit the experimental apparent energy deposited.

\begin{table}
\begin{tabular}{|l|c|c|c|} \hline \hline EMB & \multicolumn{3}{c|}{Ratios [\%]} \\ \cline{2-4} compartment & GEANT3 & GEANT4 & Exp. \\ \hline \hline Presampler & 0.77 & 0.50 & 0.45 \\ Front S1 & 17 & 15 & 14.5 \\ Middle S2 & 81 & 83 & 83 \\ Back S3 & 1.2 & 1.3 & 1.6 \\ \hline \hline \end{tabular}
\end{table}
Table 1: Ratios of the energies deposited in the various EMB compartments to the total energy for 250 GeV electrons at \(\eta=0.350\). Experimental results are preliminary.

#### 4.1.2 Energy resolution from electromagnetic showers

The relative energy resolution \(\sigma(E)/E\) as a function of the incident electron energy \(E_{BEAM}\), obtained from GEANT3/GEANT4 simulations, are compared to the experimental testbeam results under similar analysis conditions. The dependence of the energy resolution on the beam energy for electrons is usually parametrised (after noise subtraction) by the following two-term formula:

\[\frac{\sigma(E)}{E}=\frac{a}{\sqrt{E_{BEAM}}}\oplus b, \tag{1}\]

Figure 5: Ratios of the energies deposited in the various EMB compartments to the total energy as functions of the pseudorapidity for 250 GeV electrons in experiment (black dots) and with GEANT3 (open circles) and GEANT4 (triangles) simulations.

where \(a\) is the sampling or stochastic term, \(b\) is the constant term. The experimental results yield (see [10] and Fig.6):

\[a=(9.24\pm 0.10)\%\]

for the sampling term of the energy resolution. The corresponding values from the simulations are:

\[a=(9.18\pm 0.13)\% \ \ \ \ (\mbox{GEANT4})\] \[a=(9.09\pm 0.06)\% \ \ \ (\mbox{GEANT3}).\]

Contributions to the energy resolution from absorber sagging, which leads to a relative increase in the sampling term of about 3.5%, and the current in the non-uniform field, can both be simulated in GEANT4 with the same quantitative effect on the signals as in GEANT3.

### Electrons in the HEC Calorimeter

Results from GEANT4 based simulations of electrons in the hadronic end-cap calorimeter have been obtained with version 4.1p01. Electrons of different energies and with different GEANT4 range cuts were simulated. Usual statistics was 5000 events per energy and cut.

#### 4.2.1 Influence of the GEANT4 range cut

To study the influence of the GEANT4 range cut on the main performance parameters, a scan over this cut from 5 \(\mu\)m to 5 mm was done with 100 GeV electrons.

Figure 6: Energy dependence of the energy resolution for electrons reconstructed in 3\(\times\)3 clusters in the EMB.

The sum of the visible energies in the first two longitudinal layers of the HEC, which contain most of the electron signal, is used for energy reconstruction. The resulting energy distributions are fitted by a Gaussian, and the obtained energy resolution is shown in Fig.7 for various GEANT4 range cuts. Very weak increasing of this parameter is observed in the studied interval.

In Fig.8, the average total energy deposits in liquid argon and in copper are shown as functions of the GEANT4 range cut. It can be seen that decreasing the range cut from 5 mm down to 20 \(\mu\)m leads to an increase in the observed visible energy (energy deposited in LAr) by about 3 %. This reflects the increasing number of particles produced in the copper and reaching the liquid argon, thus contributing to the signal. Below 20 \(\mu\)m, the behaviour reverts such that the visible energy in the LAr decreases with decreasing range cut. Energy deposits in copper demonstrate the opposite behaviour, so that the sum of average energies in the absorber and in the sensitive medium stays approximately constant.

A possible explanation for the observed loss in signal is that the relative number of photons produced in GEANT4 decreases when the range cut is below the photon kinetic energy of 990 eV. This energy is the intrinsic boundary for any photon production in GEANT4 [17].

Comparable results from GEANT3 with secondary production thresholds of 1 MeV in liquid argon and copper, corresponding to minimum ranges of 4.5 mm (LAr) and 0.7 mm (copper), are also indicated in Fig.8. GEANT3, with these cuts, predicts slightly more energy (hence larger signal) in liquid argon than GEANT4.

Direct amplitude comparisons of the simulated signals with experimental data are possible once the current yield is known. This is defined by the conversion factor between the visible energy deposited in the liquid argon and the corresponding current measured by the actually used electronics. This conversion factor has been calculated by detailed modeling of the electronic chain [18]. Using this method, it was found that both simulation packages produce a slightly smaller signal than the experiment. For GEANT3 the signal is about 1 % smaller, while for the GEANT4 this difference is 0.5-3.5 %, depending on

Figure 7: Dependence of the relative energy resolution on the GEANT4 range cut for 100 GeV electrons in the HEC.

the range cut, with the best signal estimate obtained at 20 \(\mu\)m, as expected from Fig.8.

#### 4.2.2 Energy response and resolution

Further evaluation of the GEANT4 electromagnetic physics with the HEC involved an energy scan from 6 to 147.8 GeV, for which experimental data, GEANT4 and GEANT3 simulations are available. Following the experimental procedure [12], the reconstruction of the energy was done within a cluster of six cells. The set of cells was fixed for all events and all beam energies.

In Fig.9, the response measured as the ratio of the reconstructed energy \(E_{REC}\) and the beam energy \(E_{BEAM}\) is shown as a function of \(E_{BEAM}\) for the experiment and for GEANT4 and GEANT3 simulations. All dependences demonstrate good linearity, within \(\pm 0.5\) % for simulations and within \(\pm 1\) % for the experiment. The observed differences at low energies between the experiment and both simulation models can be attributed to relatively small systematic effects in the experiment.

The dependence of the energy resolution on the beam energy for electrons can be parametrised by the two-term formula (1). The constant term \(b\) has been found for the HEC to be consistent with zero for experiment and both simulations, thus the only free

Figure 8: Average total energy depositions in LAr (top plot) and in copper (bottom plot) for 100 GeV electrons in the HEC as functions of the GEANT4 range cut (black dots). Open boxes mark the corresponding values, obtained with GEANT3 based simulations.

parameter in the resolution function is the sampling term \(a\):

\[\frac{\sigma(E)}{E}=\frac{a}{\sqrt{E_{BEAM}}}. \tag{2}\]

In Fig.11, the energy resolution as a function of the beam energy is presented for the experiment and for GEANT4 and GEANT3 simulations together with results of the fit to equation (2). The sampling term is measured to be (21.7 \(\pm\) 0.1), (21.1 \(\pm\) 0.1), (20.3 \(\pm\) 0.1) % GeV\({}^{1/2}\) for experimental data, GEANT3 and GEANT4 simulations respectively. It can be seen that all dependences are rather close and that GEANT3 gives a slightly better description of the experimental resolution than GEANT4.

#### 4.2.3 Longitudinal shower profiles

As already mentioned, most of the electron signal is contained in the first two longitudinal layers of HEC modules. Therefore the experimental signals have limited information on the longitudinal shower development for electrons. Nonetheless, it is worthwhile to compare longitudinal energy profiles, as accessibly in GEANT4 and GEANT3 simulations. They have been compared excluding any effects of energy losses in the beam line or other dead material upstream of the calorimeters. For this purpose, the electrons in the simulations have been generated directly in front of the HEC.

The longitudinal energy profiles are shown in Fig.11. These profiles are very similar for both simulations for 6 GeV electrons. They differ significantly for 147.8 GeV electrons, with GEANT4 predicting a later start of the electromagnetic showers in the absorber than GEANT3. In Fig.12, the average positions of electromagnetic showers in the HEC modules and their spread along the direction of beam particles are presented as functions of the electron beam energy. The predictions for the shower parameters for the absorber in GEANT3 and GEANT4 are very similar for electron energies below 80 GeV. At higher beam energies showers are shifted deeper in the calorimeter and their longitudinal size is a bit larger in GEANT4 than in GEANT3.

### Electrons in the Forward Calorimeter

Electron simulations in the FCal cover the experimental energy range from 20 to 193.7 GeV, with typical statistics of 2000 events per beam energy and range cut. Version 2.0-ref-02 of GEANT4 has been used for these simulations.

Fig.13 shows the dependence of the signal for 60 GeV electrons, simulated with GEANT4, on the chosen range cut. Similar to the behaviour already seen for electrons in the HEC (Fig.8), the signal drops for range cuts smaller than 20 \(\mu\)m, while the relative energy resolution and the total deposited energy do not depend on this parameter. This observation is notable, as the HEC and FCal have very different readout geometries, but the same active and absorber material.

The difference between GEANT4 and GEANT3 simulated signals and experimental electron data has been studied in the FCal for various cell level noise cuts. As shown in Fig.14, GEANT4 can describe the signal dependence on this analysis cut within \(\pm\)1 %, while GEANT3 shows up to a 4 % mismatch with the experimental data. For this study, experimental noise has been added event by event, and channel by channel, to both simulations. A better description of the experimental signal loss due to this cell selection by GEANT4 than GEANT3 can indicate a better modeling of the energy sharing between cells (radial shower profile).

Fig.15 shows the relative energy resolution for electrons in the FCal for GEANT3 and GEANT4 simulation with experimental noise added and for testbeam data. The solid line is a fit to the experimental data. At 200 GeV, GEANT4 shows a slightly worse resolution than both GEANT3 and the data. This is important as at this energy, the resolution is determined by shower effects with very little contributions from the electronic noise. The low energy points, especially 20-60 GeV, are dominated by electronic noise and well described by both Monte Carlo predictions.

The compactness of the electromagnetic shower in the electromagnetic FCal, which has only one longitudinal compartment, can be measured by the cell signal significance spectrum, shown in Fig.16. This quantity is given by the signal to electronic noise ratio in each cell. The spectrum clearly shows that both Monte Carlos have less often highly significant signals in one cell, indicating their shower composition is softer than the experimental one. The same figure shows that both Monte Carlo packages predict more signal contribution from smaller signals to the total signal than one can expect from the FCal testbeam.

Figure 13: The sampling fraction (top), the total deposited energy (center) and the relative energy resolution (bottom) as functions of the GEANT4 range cut for 60 GeV electrons in the FCal. The bars indicate the corresponding GEANT3 predictions and their errors.

Figure 14: The relative difference between the GEANT4 (circles) and GEANT3 (triangles) electron signal and experimental data as function of the cell noise cut level for the FCal.

Figure 15: Energy dependence of the relative energy resolution for electrons in the FCal.

Figure 16: Distributions of the cell signal significance (top plot) and signal fraction as a function of the signal significance (bottom plot) for 60 GeV electrons in the FCal.

Results for Muons

### Muons in the EMB Calorimeter

The response of the calorimeter to 100 GeV muons as predicted by GEANT4 (version 2.0-ref-02) is compared to testbeam data and to a sample of GEANT3 simulated muons. Like in the testbeam [10, 19], the muons enter the calorimeter at pseudorapidities \(0.35<\eta<0.375\), with an opening in azimuth of \(0.245<\varphi<0.270\) radians. The transverse beam size is adequate to illuminate a detector spot of size \(\Delta\eta\times\Delta\varphi\) = 0.025\(\times\) 0.025 radians, i.e. the size of one readout cell in the middle radial compartment (see Section 3.1).

Comparing the GEANT4 and GEANT3 energy depositions in the second sampling of the LAr calorimeter, some significant differences can be observed as shown in Fig.17. The spectra show the distribution of the signal, measured as energy deposited in liquid argon, with and without the appropriate electronic noise added. The cumulative bin-by-bin differences reach a maximum of \(\sim\)4 % around 0.4 GeV of deposited energy, at which point GEANT4 starts depositing consistently less energy than GEANT3. Given the high statistics of the simulated muon samples, this difference indicates rather incompatible distributions; a Kolmogorov-Smirnoff test confirms this observation.

The experimental signal is a convolution of the energy deposit in the liquid argon by muons, and electronic noise. Because of the accordion geometry, a traversing muon deposits energy in two adjacent azimuthal cells, thus a cluster of 1\(\times\)2 electronic cells in \(\eta\times\varphi\) is used to reconstruct the energy deposition of muons. The electronic noise in this cluster is about 41 MeV. Randomly sampling the corresponding signal contribution from

Figure 17: The energy deposition of muons traversing the EMB calorimeter at \(\eta\simeq 0.35\). The GEANT4 simulation (black dots) is compared with GEANT3 (histogram) when no noise is added (left-hand top plot) and when 41 MeV of noise is added (right-hand top plot). The corresponding cumulative bin-by-bin differences of the GEANT4 and GEANT3 distributions are given in the bottom plots.

a Gaussian distribution and adding it to the simulated signal allows direct comparison of GEANT4 and GEANT3 visible energies with experimental data. The distributions of these signals, as shown in Fig.17, indicate that the already observed difference between the two simulation models is not affected by the electronic noise.

The comparison of experimental testbeam data (preliminary) with GEANT4 and GEANT3 simulations, with noise added, is shown in Fig.18. In order to compare the shapes of the distributions, the most probable energy deposition in the simulated events is adjusted to agree with data. It is evident that GEANT4 can describe the shape of the experimental signal distribution better. The cumulative bin-by-bin difference between GEANT4 events and the data has a maximum value of about 0.9 %, while the corresponding value for GEANT3 is above 3 %. Most of the differences are in the tail of the distribution, beyond the most probable signal. This may be a reflection of the improved description of \(\delta\)-electron production and multiple scattering in GEANT4.

### Muons in the HEC Calorimeter

Muons in the hadronic end-cap calorimeter have been simulated with various range cuts between 0.2 and 4.0 mm using GEANT4 v2.0rel2. A comparison of the obtained signal spectra with GEANT3 shows significant differences, similar to those observed for the EMB. A Kolmogorov-Smirnoff confirms this observation, which is true for all studied range cuts, by indicating no compatibility between the distributions from the two simulation codes.

In particular the dependence of the tails in the signal spectra on the minimum range requirement for production of secondary particles has been studied. This tail depends on

Figure 18: The signal spectrum of 100 GeV muons in the EMB calorimeter, as observed in a testbeam and simulated by GEANT4 (left-hand top plot) and GEANT3 (right-hand top plot). The corresponding cumulative differences between the simulated and measured distributions are shown in the bottom plots. Experimental results are preliminary.

the modeling of the electromagnetic halo around the muon track, mainly due to \(\delta\)-electron production. Fig.19 shows the development of this halo for GEANT3 and two different range cuts in GEANT4, measured by the energy deposited in the liquid argon gaps as a function of the calorimeter depth. The increase of the signal contribution from the electromagnetic halo for the lower range cut (0.2 mm) in GEANT4 is obvious, and leads to a better comparison with GEANT3.

Direct comparisons of experimental muon spectra [12] and signal spectra for simulated muons indicate that both GEANT3 and GEANT4 can describe the experimental distributions in the HEC quite well, if the electronic noise is added to the simulation signal. A statistical analysis using the Kolmogorov-Smirnoff shows that the experimental data cannot distinguish GEANT3 and GEANT4.

Figure 19: Longitudinal energy profile for 180 GeV muons in the HEC: average visible energy in gaps of LAr. The increase of the signal with calorimeter depth is due to the development of the electromagnetic halo around the muon track.

Conclusions and Outlook

The results obtained so far for GEANT4 electron and muon simulations in the ATLAS liquid argon calorimeters suggest that the available electromagnetic shower and muon energy loss models in this toolkit describe signals in complex detector readout geometries and environments at about the same level as or better than GEANT3.

Remaining open questions and observed discrepancies are under further studies by the corresponding working groups and are under discussion with the GEANT4 collaboration.

## 7 Acknowledgments

We gratefully acknowledge the help and support from the ATLAS testbeam communities, the CERN staff, and the involved funding agencies.

We want to thank the GEANT4 team and especially J. Apostolakis, M. Maire, L. Urban and H.-P. Wellisch for their help.

We thank O. Gaumer, D. Zerwas and L. Kurchaninov, M. Levitsky, A. Minaenko for their help in the analysis of the EMB and HEC testbeam data.

We would like to thank D. Fournier, F. Gianotti and F. Paige for their valuable comments, suggestions and remarks, and A. Dell'Acqua and S. Rajagopalan for their support of our work.

## References

* [1] R. Brun _et al._, _GEANT3_, CERN DD/EE/84-1 (1986).
* [2] S. Agostinelli _et al._, Nucl.Inst.Meth. A506 (2003) 250; [http://geant4.web.cern.ch/geant4/](http://geant4.web.cern.ch/geant4/).
* [3] K. Kordas, G. Parrour, S. Simion, in: Proc. IX Int. Conf. on Calorimetry in High Energy Physics (Annecy 2000), Frascati Physics Series, Vol. XXI, 475-484 (2000); A.E. Kiryunin, D. Salihagic, P. Strizenec, in: Proc. IX Int. Conf. on Calorimetry in High Energy Physics (Annecy 2000), Frascati Physics Series, Vol. XXI, 459-466 (2000); R. Mazini and P. Loch, in: Proc. IX Int. Conf. on Calorimetry in High Energy Physics (Annecy 2000), Frascati Physics Series, Vol. XXI, 485-491 (2000); D. Benchekroun _et al._, in: Proc. CHEP'01: Computing in High-Energy and Nuclear Physics (Beijing 2001), *Beijing 2001, CHEP* 350-352 (2001); D. Benchekroun _et al._, in: Proc. Tenth Int. Conf. on Calorimetry in Particle Physics (Pasadena 2002), World Scientific, 331-338 (2002).
* [4] G. Moliere, Z.Naturforsch. 3a (1948) 78.
* [5] H.W. Lewis, Phys.Rev. 78 (1950) 526.

* [6] V.M. Galitsky and I.I. Gurevich, Nuovo Cimento 32 (1964) 1820; P.L. Anthony _et al._, SLAC-PUB-7413/LBNL-40054 (1997).
* [7] ATLAS Liquid Argon Collaboration, _Liquid Argon Calorimeter Technical Design Report_, CERN/LHCC/96-41 (1996).
* [8] ATLAS Collaboration, _ATLAS Calorimeter Performance Technical Design Report_, CERN/LHCC/96-40 (1996).
* [9] ATLAS Collaboration, _ATLAS Detector and Physics Performance Technical Design Report_, CERN/LHCC/99-14/15 (1999).
* [10] B. Aubert _et al._, Nucl.Inst.Meth. A500 (2003) 202.
* [11] J. Colas, M. Pripstein, W.A. Wenzel, Nucl.Inst.Meth. A294 (1990) 583.
* [12] B. Dowler _et al._, Nucl.Inst.Meth. A482 (2002) 94.
* [13] A.E. Kiryunin, D. Salihagic, _Monte Carlo for the HEC Prototype: Software and Examples of Analysis_, HEC Note-063 (1998).
* [14] A. Kiryunin, D. Salihagic, P. Strizenec, _GEANT4 Simulation of the HEC Test Beam Data (Status Report)_, HEC Note-090 (1999).
* [15] I.A. Ferguson _et al._, Nucl.Inst.Meth. A383 (1996) 399.
* [16] J.C. Armitage _et al._, _Electron Results for the ATLAS Electromagnetic Forward Calorimeter Module 0 Test Beam 1998_, ATLAS Internal Communication ATL-COM-LARG-2002-002 (2002).
* [17] M. Maire, private communication.
* [18] L. Kurchaninov, private communication.
* [19] A. Camard _et al._, _Study of the EM barrel Module 0 with muons_, ATLAS Internal Note ATL-LARG-2001-017 (2001).